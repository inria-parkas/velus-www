
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Kauto</title>
<meta name="description" content="Documentation of Coq module Kauto" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
</head>

<body>
<h1 class="title">Module Kauto</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common.Common</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.html">Cpo</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.Denot.Kenv.html">Kenv</a></span>.<br/>
<br/>
<h1> Définitions des automates du langage </h1>
<div class="doc">on donne aussi la définition des automates
 - à transitions toutes <span class="bracket"><span class="id">continue</span></span>
 - à transitions toutes non-<span class="bracket"><span class="id">continue</span></span>
 cf. soumission aux JFLA 2026
 </div>
<br/>
<span class="id">Local</span> <span class="kwd">Hint</span> <span class="id">Rewrite</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#ford_fcont_shift_simpl">ford_fcont_shift_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#curry_Curry">curry_Curry</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Curry_simpl">Curry_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2_simpl">fcont_comp2_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp3_simpl">fcont_comp3_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_comp4_simpl">fcont_comp4_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND_simpl">SND_simpl</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Snd_simpl">Snd_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST_simpl">FST_simpl</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fst_simpl">Fst_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR_simpl">Dprodi_DISTR_simpl</a></span><br/>
&nbsp;&nbsp;: <span class="id">localdb</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="KAUTO">KAUTO</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id"><a name="KAUTO.ident">ident</a></span> <span class="id"><a name="KAUTO.id_st">id_st</a></span> : <span class="kwd">Type</span> }.<br/>
<span class="kwd">Context</span> { <span class="id"><a name="KAUTO.id_st_dec">id_st_dec</a></span> : <span class="kwd">forall</span> <span class="id">i</span> <span class="id">j</span> : <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>, { <span class="id">i</span> = <span class="id">j</span> } + { ~ <span class="id">i</span> = <span class="id">j</span> } }.<br/>
<span class="kwd">Notation</span> <span class="id"><a name="env">env</a></span> := (@<span class="id"><a href="Velus.Lustre.Denot.Kenv.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.ident">ident</a></span>).<br/>
<span class="kwd">Notation</span> <span class="id"><a name="id_st_eqb">id_st_eqb</a></span> := (@<span class="id"><a href="Velus.Lustre.Denot.Kenv.html#id_st_eqb">id_st_eqb</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st_dec">id_st_dec</a></span>).<br/>
<br/>
<h1> Fonctions de flots utiles pour les automates </h1>
<span class="kwd">Section</span> <span class="id"><a name="KAUTO.OPS">OPS</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id"><a name="KAUTO.OPS.A">A</a></span> <span class="id"><a name="KAUTO.OPS.B">B</a></span> : <span class="kwd">Type</span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="whencf">whencf</a></span> : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>)).<br/>
&nbsp;&nbsp;2:<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>; <span class="id">intro</span> <span class="id">c</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>)).<br/>
&nbsp;&nbsp;2:<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span>.<br/>
&nbsp;&nbsp;- <span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id">x</span> @_ _).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((_ @3_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> _) _ _).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _).<br/>
&nbsp;&nbsp;- <span class="id">refine</span> ((_ @3_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> _) _ _).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="whencf_eq">whencf_eq</a></span> : <span class="kwd">forall</span> <span class="id">F</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">c</span> <span class="id">cs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#whencf">whencf</a></span> <span class="id">F</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">cs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>) ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> (<span class="id">F</span> <span class="id">cs</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id">F</span> <span class="id">cs</span> <span class="id">xs</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#whencf">whencf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span>; <span class="id">now</span> <span class="id">simpl</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="whenc">whenc</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#whencf">whencf</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="whenc_eq">whenc_eq</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">c</span> <span class="id">cs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#whenc">whenc</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">cs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>) ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#whenc">whenc</a></span> <span class="id">cs</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#whenc">whenc</a></span> <span class="id">cs</span> <span class="id">xs</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#whenc">whenc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#whencf_eq">whencf_eq</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="when_not">when_not</a></span> := <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#whenc">whenc</a></span> @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="when_env">when_env</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Kenv.html#ext_env">ext_env</a></span> @2_ _) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#whenc">whenc</a></span> @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="when_env_simpl">when_env_simpl</a></span> : <span class="kwd">forall</span> <span class="id">cs</span> <span class="id">env</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#when_env">when_env</a></span> <span class="id">cs</span> <span class="id">env</span> <span class="id">i</span> = <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#whenc">whenc</a></span> <span class="id">cs</span> (<span class="id">env</span> <span class="id">i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="when_not_env">when_not_env</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Kenv.html#ext_env">ext_env</a></span> @2_ _) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#when_not">when_not</a></span> @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="when_not_env_simpl">when_not_env_simpl</a></span> : <span class="kwd">forall</span> <span class="id">cs</span> <span class="id">env</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#when_not_env">when_not_env</a></span> <span class="id">cs</span> <span class="id">env</span> <span class="id">i</span> = <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#when_not">when_not</a></span> <span class="id">cs</span> (<span class="id">env</span> <span class="id">i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
Qed.</div></details>
<br/>
<div class="doc">when étendu aux <span class="bracket"><span class="id">id_st</span></span>  </div>
<span class="kwd">Definition</span> <span class="id"><a name="wheni">wheni</a></span> (<span class="id">i</span> : <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#whenc">whenc</a></span> @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">j</span> <span class="id">i</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="wheni_env">wheni_env</a></span> (<span class="id">i</span> : <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kenv.html#ext_env">ext_env</a></span> @_ (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#wheni">wheni</a></span> <span class="id">i</span>).<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="mergeif">mergeif</a></span> :<br/>
&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> -<span class="id">C</span>-&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>)) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> -<span class="id">C</span>-&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>)) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>)).<br/>
&nbsp;&nbsp;2:<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>; <span class="id">intro</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP">APP</a></span> _ @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _) _).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @3_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _) _).<br/>
&nbsp;&nbsp;<span class="id">refine</span> (_ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _).<br/>
&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DMAPi">DMAPi</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">i</span> <span class="id">j</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> _)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mergeif_simpl">mergeif_simpl</a></span> : <span class="kwd">forall</span> <span class="id">F</span> <span class="id">i</span> <span class="id">c</span> <span class="id">istr</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergeif">mergeif</a></span> <span class="id">F</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">i</span> <span class="id">c</span>) <span class="id">istr</span> ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id">istr</span> <span class="id">i</span>) (<span class="id">F</span> <span class="id">c</span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">i</span> <span class="id">j</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id">istr</span> <span class="id">j</span>) <span class="kwd">else</span> <span class="id">istr</span> <span class="id">j</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergeif">mergeif</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_stable">fcont_stable</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP">APP</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> (<span class="id">istr</span> <span class="id">i</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">change</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> ?<span class="id">a</span> ?<span class="id">b</span>) <span class="kwd">with</span> (<span class="id">a</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_stable">fcont_stable</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">i</span> <span class="id">j</span>); <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<div class="doc">merge étendu aux <span class="bracket"><span class="id">id_st</span></span> </div>
<span class="kwd">Definition</span> <span class="id"><a name="mergei">mergei</a></span> :  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> -<span class="id">C</span>-&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>)) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergeif">mergeif</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mergei_simpl">mergei_simpl</a></span> : <span class="kwd">forall</span> <span class="id">i</span> <span class="id">c</span> <span class="id">istr</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei">mergei</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">i</span> <span class="id">c</span>) <span class="id">istr</span> ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id">istr</span> <span class="id">i</span>) (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei">mergei</a></span> <span class="id">c</span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">i</span> <span class="id">j</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id">istr</span> <span class="id">j</span>) <span class="kwd">else</span> <span class="id">istr</span> <span class="id">j</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei">mergei</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergeif_simpl">mergeif_simpl</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="mergei_envf">mergei_envf</a></span> :<br/>
&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> -<span class="id">C</span>-&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>)) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> -<span class="id">C</span>-&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>)) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>)).<br/>
&nbsp;&nbsp;2:<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>; <span class="id">intro</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP">APP</a></span> _ @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">x</span> @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _) _).<br/>
&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">x</span> @_ ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @3_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _) _)).<br/>
&nbsp;&nbsp;<span class="id">refine</span> (_ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _).<br/>
&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DMAPi">DMAPi</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">i</span> <span class="id">j</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> _)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mergei_envf_simpl">mergei_envf_simpl</a></span> : <span class="kwd">forall</span> <span class="id">F</span> <span class="id">i</span> <span class="id">c</span> <span class="id">istr</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_envf">mergei_envf</a></span> <span class="id">F</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">i</span> <span class="id">c</span>) <span class="id">istr</span> ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> (<span class="id">istr</span> <span class="id">i</span>) (<span class="id">F</span> <span class="id">c</span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">i</span> <span class="id">j</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> (<span class="id">istr</span> <span class="id">j</span>) <span class="kwd">else</span> <span class="id">istr</span> <span class="id">j</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_envf">mergei_envf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_stable">fcont_stable</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP">APP</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> _)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_elim">Oprodi_eq_elim</a></span> <span class="kwd">with</span> (<span class="id">p</span> := (<span class="id">F</span> <span class="id">c</span> _)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_stable">fcont_stable</a></span> (<span class="id">F</span> <span class="id">c</span>)); <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">i</span> <span class="id">j</span>); <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="mergei_env">mergei_env</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> -<span class="id">C</span>-&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>)) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_envf">mergei_envf</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mergei_env_simpl">mergei_env_simpl</a></span> : <span class="kwd">forall</span> <span class="id">i</span> <span class="id">c</span> <span class="id">istr</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_env">mergei_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">i</span> <span class="id">c</span>) <span class="id">istr</span> ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> (<span class="id">istr</span> <span class="id">i</span>) (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_env">mergei_env</a></span> <span class="id">c</span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">i</span> <span class="id">j</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> (<span class="id">istr</span> <span class="id">j</span>) <span class="kwd">else</span> <span class="id">istr</span> <span class="id">j</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_env">mergei_env</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_envf_simpl">mergei_envf_simpl</a></span>.<br/>
Qed.</div></details>
<br/>
<div class="doc">Switch </div>
<span class="kwd">Definition</span> <span class="id"><a name="switch">switch</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> -<span class="id">C</span>-&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>)) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_env">mergei_env</a></span> @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _) _).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _) _).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#wheni_env">wheni_env</a></span> <span class="id">i</span> @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="switch_simpl">switch_simpl</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">f</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#switch">switch</a></span> <span class="id">c</span> <span class="id">f</span> <span class="id">e</span> = <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_env">mergei_env</a></span> <span class="id">c</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">f</span> <span class="id">i</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#wheni_env">wheni_env</a></span> <span class="id">i</span> <span class="id">c</span> <span class="id">e</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<h1> Automates  </h1>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="rem_unlessf">rem_unlessf</a></span> : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>)).<br/>
&nbsp;&nbsp;2:<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>; <span class="id">intro</span> <span class="id">c</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>)).<br/>
&nbsp;&nbsp;2:<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span>.<br/>
&nbsp;&nbsp;- <span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id">x</span> @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _).<br/>
&nbsp;&nbsp;- <span class="id">refine</span> ((_ @3_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> _) _ _).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_unlessf_eq">rem_unlessf_eq</a></span> : <span class="kwd">forall</span> <span class="id">F</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">c</span> <span class="id">cs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unlessf">rem_unlessf</a></span> <span class="id">F</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">cs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>) ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">c</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span> <span class="kwd">else</span> <span class="id">F</span> <span class="id">cs</span> <span class="id">xs</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unlessf">rem_unlessf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span>; <span class="id">now</span> <span class="id">simpl</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="rem_unless">rem_unless</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unlessf">rem_unlessf</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_unless_eq">rem_unless_eq</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">c</span> <span class="id">cs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unless">rem_unless</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">cs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>) ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">c</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unless">rem_unless</a></span> <span class="id">cs</span> <span class="id">xs</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unless">rem_unless</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unlessf_eq">rem_unlessf_eq</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="rem_unless_env">rem_unless_env</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> := <span class="id"><a href="Velus.Lustre.Denot.Kenv.html#ext_env">ext_env</a></span> @_ <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unless">rem_unless</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_unless_env_simpl">rem_unless_env_simpl</a></span> : <span class="kwd">forall</span> <span class="id">c</span> <span class="id">e</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unless_env">rem_unless_env</a></span> <span class="id">c</span> <span class="id">e</span> <span class="id">i</span> = <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unless">rem_unless</a></span> <span class="id">c</span> (<span class="id">e</span> <span class="id">i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="rem_until">rem_until</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unless">rem_unless</a></span> @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_until_simpl">rem_until_simpl</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cs</span> <span class="id">xs</span>, <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_until">rem_until</a></span> <span class="id">cs</span> <span class="id">xs</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unless">rem_unless</a></span> <span class="id">cs</span> <span class="id">xs</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="rem_until_env">rem_until_env</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kenv.html#ext_env">ext_env</a></span> @_ <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_until">rem_until</a></span>.<br/>
<br/>
<br/>
<div class="doc">le merge_unless de Marc étendu aux <span class="bracket"><span class="id">env</span></span> </div>
<span class="kwd">Definition</span> <span class="id"><a name="merge_unlessf">merge_unlessf</a></span> :<br/>
&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>)).<br/>
&nbsp;&nbsp;2:<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>; <span class="id">intro</span> <span class="id">c</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- _ (_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) _) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">F</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">e1</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">e2</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">x</span> @_ <span class="id">e2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">x</span> @_ _)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> @2_ <span class="id">e1</span>) _).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @4_ <span class="id">F</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> @_ <span class="id">e1</span>) <span class="id">e2</span>).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="merge_unlessf_simpl">merge_unlessf_simpl</a></span> : <span class="kwd">forall</span> <span class="id">F</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">e1</span> <span class="id">e2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_unlessf">merge_unlessf</a></span> <span class="id">F</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">cs</span>) <span class="id">e1</span> <span class="id">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">if</span> <span class="id">c</span> <span class="kwd">then</span> <span class="id">e2</span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">e1</span> (<span class="id">F</span> <span class="id">cs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">e1</span>) <span class="id">e2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_unlessf">merge_unlessf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">localdb</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="merge_unless">merge_unless</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_unlessf">merge_unlessf</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="merge_unless_simpl">merge_unless_simpl</a></span> : <span class="kwd">forall</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">e1</span> <span class="id">e2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_unless">merge_unless</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">cs</span>) <span class="id">e1</span> <span class="id">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">if</span> <span class="id">c</span> <span class="kwd">then</span> <span class="id">e2</span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">e1</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_unless">merge_unless</a></span> <span class="id">cs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">e1</span>) <span class="id">e2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_unless">merge_unless</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_unlessf_simpl">merge_unlessf_simpl</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="merge_until">merge_until</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_unless">merge_unless</a></span> @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="merge_until_simpl">merge_until_simpl</a></span> : <span class="kwd">forall</span> <span class="id">c</span> <span class="id">e1</span> <span class="id">e2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_until">merge_until</a></span> <span class="id">c</span> <span class="id">e1</span> <span class="id">e2</span> = <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_unless">merge_unless</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">c</span>) <span class="id">e1</span> <span class="id">e2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
Qed.</div></details>
<br/>
<div class="doc">le merge_unless de Marc étendu aux indices et aux <span class="bracket"><span class="id">env</span></span> </div>
<span class="kwd">Definition</span> <span class="id"><a name="mergei_unlessf">mergei_unlessf</a></span> :<br/>
&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.B">B</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.B">B</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.B">B</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.B">B</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.B">B</a></span>) <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>)).<br/>
&nbsp;&nbsp;2:<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>; <span class="id">intro</span> <span class="id">c</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- _ (_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) _) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">F</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">e</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">fe</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span> <span class="kwd">as</span> [<span class="id">i</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">x</span> @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @_ <span class="id">fe</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">x</span> @_ _)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> @2_ <span class="id">e</span>) _).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @4_ <span class="id">F</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> @_ <span class="id">e</span>) <span class="id">fe</span>).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mergei_unlessf_simpl">mergei_unlessf_simpl</a></span> : <span class="kwd">forall</span> <span class="id">F</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">e</span> <span class="id">fe</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_unlessf">mergei_unlessf</a></span> <span class="id">F</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">cs</span>) <span class="id">e</span> <span class="id">fe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">match</span> <span class="id">c</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">i</span> =&gt; <span class="id">fe</span> <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">e</span> (<span class="id">F</span> <span class="id">cs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">e</span>) <span class="id">fe</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_unlessf">mergei_unlessf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">localdb</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="mergei_unless">mergei_unless</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.B">B</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.B">B</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_unlessf">mergei_unlessf</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mergei_unless_simpl">mergei_unless_simpl</a></span> : <span class="kwd">forall</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">e</span> <span class="id">fe</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_unless">mergei_unless</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">cs</span>) <span class="id">e</span> <span class="id">fe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">match</span> <span class="id">c</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">i</span> =&gt; <span class="id">fe</span> <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">e</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_unless">mergei_unless</a></span> <span class="id">cs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">e</span>) <span class="id">fe</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_unless">mergei_unless</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_unlessf_simpl">mergei_unlessf_simpl</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="merge_until_env">merge_until_env</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.B">B</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.B">B</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS.A">A</a></span>  :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_unless">mergei_unless</a></span> @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="merge_until_env_simpl">merge_until_env_simpl</a></span> : <span class="kwd">forall</span> <span class="id">c</span> <span class="id">e</span> <span class="id">fe</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_until_env">merge_until_env</a></span> <span class="id">c</span> <span class="id">e</span> <span class="id">fe</span> = <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_unless">mergei_unless</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">c</span>) <span class="id">e</span> <span class="id">fe</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.OPS">OPS</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="KAUTO.AUTO">AUTO</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="KAUTO.AUTO.A">A</a></span> : <span class="kwd">Type</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="is_some">is_some</a></span> {<span class="id">A</span>} (<span class="id">o</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">o</span> <span class="kwd">with</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> _ =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> | _ =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="kwd">end</span>.<br/>
<br/>
<br/>
<h2> Transitions fortes réinitialisées </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="auto_reset_strongf">auto_reset_strongf</a></span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>)) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> =&gt;  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>)) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> =&gt;  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>))).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">init</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- _ (_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) _) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">fs</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ft</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">F</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">e</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">t</span> := <span class="kwd">if</span> <span class="id">init</span> <span class="kwd">then</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @_ <span class="id">ft</span>) <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @_ <span class="id">ft</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> @_ <span class="id">e</span>)).<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">e'</span> := (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @_ <span class="id">fs</span>) <span class="id">e</span>).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_unless">mergei_unless</a></span> @3_ <span class="id">t</span>) <span class="id">e'</span> _).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">re</span> := (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unless_env">rem_unless_env</a></span> @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#is_some">is_some</a></span> @_ <span class="id">t</span>) <span class="id">e</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">fi</span> := (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">j</span> @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> @_ <span class="id">F</span>)).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @2_ <span class="id">fi</span>) <span class="id">re</span>).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="auto_reset_strongf_eq">auto_reset_strongf_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">F</span> <span class="id">init</span> <span class="id">i</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_reset_strongf">auto_reset_strongf</a></span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">F</span> <span class="id">init</span> <span class="id">i</span> <span class="id">e</span> ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">t</span> := <span class="kwd">if</span> <span class="id">init</span> <span class="kwd">then</span> <span class="id">ft</span> <span class="id">i</span> <span class="id">e</span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> (<span class="id">ft</span> <span class="id">i</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">e</span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e'</span> := <span class="id">fs</span> <span class="id">i</span> <span class="id">e</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_unless">mergei_unless</a></span> <span class="id">t</span> <span class="id">e'</span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id">F</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">j</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unless_env">rem_unless_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#is_some">is_some</a></span> <span class="id">t</span>) <span class="id">e</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_reset_strongf">auto_reset_strongf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">localdb</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">init</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="auto_reset_strong">auto_reset_strong</a></span> (<span class="id">i</span> : <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>)) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span>.<br/>
&nbsp;&nbsp;2: <span class="id">refine</span> (((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_reset_strongf">auto_reset_strongf</a></span> @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _)))).<br/>
&nbsp;&nbsp;2: <span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="auto_reset_strong_eq">auto_reset_strong_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_reset_strong">auto_reset_strong</a></span> <span class="id">i</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">e</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_reset_strongf">auto_reset_strongf</a></span> <span class="id">fs</span> <span class="id">ft</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id">i</span> <span class="id">e</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<h2> Transitions faibles réinitialisées </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="auto_reset_weakf">auto_reset_weakf</a></span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>)) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- _ (_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) _) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">fs</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ft</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">F</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">e</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">e'</span> := (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @_ <span class="id">fs</span>) <span class="id">e</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">t</span> := (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @_ <span class="id">ft</span>) <span class="id">e'</span>).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_until_env">merge_until_env</a></span> @3_ <span class="id">t</span>) <span class="id">e'</span> _).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">re</span> := (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_until_env">rem_until_env</a></span> @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#is_some">is_some</a></span> @_ <span class="id">t</span>) <span class="id">e</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">fi</span> := (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">j</span> @_ <span class="id">F</span>)).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @2_ <span class="id">fi</span>) <span class="id">re</span>).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="auto_reset_weakf_eq">auto_reset_weakf_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">F</span> <span class="id">i</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_reset_weakf">auto_reset_weakf</a></span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">F</span> <span class="id">i</span> <span class="id">e</span> ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e'</span> := <span class="id">fs</span> <span class="id">i</span> <span class="id">e</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">t</span> := <span class="id">ft</span> <span class="id">i</span> <span class="id">e'</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_until_env">merge_until_env</a></span> <span class="id">t</span> <span class="id">e'</span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id">F</span> <span class="id">j</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_until_env">rem_until_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#is_some">is_some</a></span> <span class="id">t</span>) <span class="id">e</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_reset_weakf">auto_reset_weakf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">localdb</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="auto_reset_weak">auto_reset_weak</a></span> (<span class="id">i</span> : <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>)) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span>.<br/>
&nbsp;&nbsp;2: <span class="id">refine</span> (((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_reset_weakf">auto_reset_weakf</a></span> @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _)))).<br/>
&nbsp;&nbsp;2: <span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="auto_reset_weak_eq">auto_reset_weak_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_reset_weak">auto_reset_weak</a></span> <span class="id">i</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">e</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_reset_weakf">auto_reset_weakf</a></span> <span class="id">fs</span> <span class="id">ft</span>) <span class="id">i</span> <span class="id">e</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<h2> Transitions fortes avec histoire </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="auto_continue_strongf">auto_continue_strongf</a></span> (<span class="id">i</span> : <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>)) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- _ (_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) _) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ft</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">e</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ft'</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ts</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">_ts</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id">i</span> @_ (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei">mergei</a></span> @2_ <span class="id">ts</span>) <span class="id">ft'</span>).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PAIR">PAIR</a></span> _ _ @2_ _) <span class="id">_ts</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span> <span class="id">j</span>) @_ ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">j</span> @2_ <span class="id">ft</span>) _)).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#wheni_env">wheni_env</a></span> <span class="id">j</span> @2_ <span class="id">ts</span>) <span class="id">e</span>).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="auto_continue_strongf_eq">auto_continue_strongf_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">ft</span> <span class="id">e</span> <span class="id">ft'</span> <span class="id">ts</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_continue_strongf">auto_continue_strongf</a></span> <span class="id">i</span> <span class="id">ft</span> <span class="id">e</span> (<span class="id">ft'</span>,<span class="id">ts</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span> <span class="id">i</span>) (<span class="id">ft</span> <span class="id">i</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#wheni_env">wheni_env</a></span> <span class="id">i</span> <span class="id">ts</span> <span class="id">e</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">i</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei">mergei</a></span> <span class="id">ts</span> <span class="id">ft'</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="auto_continue_strong">auto_continue_strong</a></span> (<span class="id">i</span> : <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>)) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- _ (_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) _) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">fs</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ft</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">e</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">F</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ @_ ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_continue_strongf">auto_continue_strongf</a></span> <span class="id">i</span> @2_ <span class="id">ft</span>) <span class="id">e</span>)).<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ts</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id">F</span>).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_env">mergei_env</a></span> @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ @_ <span class="id">ts</span>) _).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">j</span> @2_ <span class="id">fs</span>) _).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#wheni_env">wheni_env</a></span> <span class="id">j</span> @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ @_ <span class="id">ts</span>) <span class="id">e</span>).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="auto_continue_strong_eq">auto_continue_strong_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_continue_strong">auto_continue_strong</a></span> <span class="id">i</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">e</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(_, <span class="id">ts</span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_continue_strongf">auto_continue_strongf</a></span> <span class="id">i</span> <span class="id">ft</span> <span class="id">e</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_env">mergei_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">ts</span>) (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">fs</span> <span class="id">i</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#wheni_env">wheni_env</a></span> <span class="id">i</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">ts</span>) <span class="id">e</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<h2> Transitions faibles avec histoire </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="auto_continue_weakf">auto_continue_weakf</a></span> (<span class="id">i</span> : <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>)) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>)) (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>)) (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- _ (_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) _) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">fs</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ft</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">e</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ft'</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ts</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">e'</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PAIR">PAIR</a></span> _ _ @2_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PAIR">PAIR</a></span> _ _ @2_ _) _) _).<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span> <span class="id">j</span>) @_ ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">j</span> @2_ <span class="id">ft</span>) _)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#wheni_env">wheni_env</a></span> <span class="id">j</span> @2_ <span class="id">ts</span>) <span class="id">e'</span>).<br/>
&nbsp;&nbsp;- <span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id">i</span> @_ (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei">mergei</a></span> @2_ <span class="id">ts</span>) <span class="id">ft'</span>).<br/>
&nbsp;&nbsp;- <span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_env">mergei_env</a></span> @2_ <span class="id">ts</span>) _).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">j</span> @2_ <span class="id">fs</span>) _).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#wheni_env">wheni_env</a></span> <span class="id">j</span> @2_ <span class="id">ts</span>) <span class="id">e</span>).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="auto_continue_weakf_eq">auto_continue_weakf_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">e</span> <span class="id">ft'</span> <span class="id">ts</span> <span class="id">e'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_continue_weakf">auto_continue_weakf</a></span> <span class="id">i</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">e</span> (<span class="id">ft'</span>,<span class="id">ts</span>,<span class="id">e'</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span> <span class="id">i</span>) (<span class="id">ft</span> <span class="id">i</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#wheni_env">wheni_env</a></span> <span class="id">i</span> <span class="id">ts</span> <span class="id">e'</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">i</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei">mergei</a></span> <span class="id">ts</span> <span class="id">ft'</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_env">mergei_env</a></span> <span class="id">ts</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">fs</span> <span class="id">i</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#wheni_env">wheni_env</a></span> <span class="id">i</span> <span class="id">ts</span> <span class="id">e</span>))).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="auto_continue_weak">auto_continue_weak</a></span> (<span class="id">i</span> : <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>)) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ @_ _).<br/>
&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#uncurry">uncurry</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#uncurry">uncurry</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_continue_weakf">auto_continue_weakf</a></span> <span class="id">i</span>))).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="auto_continue_weak_eq">auto_continue_weak_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_continue_weak">auto_continue_weak</a></span> <span class="id">i</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">e</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(_, _, <span class="id">e'</span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_continue_weakf">auto_continue_weakf</a></span> <span class="id">i</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">e</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">e'</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<h2> Transisions mixtes faibles </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="auto_weakf">auto_weakf</a></span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>))) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> '((<span class="id">i</span>,<span class="id">reset</span>):(<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>*<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>)) =&gt;<br/>
  <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt;<br/>
 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> <span class="id">i</span>:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>)) -<span class="id">C</span>-&gt;<br/>
 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> '((<span class="id">i</span>,<span class="id">A</span>):<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>*<span class="kwd">Type</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>)) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>)<br/>
&nbsp;&nbsp;-<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> '((<span class="id">i</span>,<span class="id">reset</span>):(<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>*<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>)) =&gt;<br/>
  <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt;<br/>
 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> <span class="id">i</span>:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>)) -<span class="id">C</span>-&gt;<br/>
 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> '((<span class="id">i</span>,<span class="id">A</span>):<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>*<span class="kwd">Type</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>)) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intros</span> (<span class="id">i</span>,<span class="id">reset</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- _ (_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) _) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">fs</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ft</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">F</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">e</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">hist</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">trim</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">s</span> := <span class="kwd">if</span> <span class="id">reset</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @2_ <span class="id">fs</span>) <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> (<span class="id"><a href="Velus.Lustre.Denot.Kenv.html#ext_env">ext_env</a></span> @2_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ (<span class="id">i</span>,_) @_ <span class="id">trim</span>)) ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @2_ <span class="id">fs</span>) ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @2_ <span class="id">hist</span>) <span class="id">e</span>))).<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">t</span> := <span class="kwd">if</span> <span class="id">reset</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @2_ <span class="id">ft</span>) <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ (<span class="id">i</span>,_) @2_ <span class="id">trim</span>) ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @2_ <span class="id">ft</span>) ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @2_ <span class="id">hist</span>) <span class="id">e</span>))).<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">t'</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#is_some">is_some</a></span> @_ <span class="id">t</span>).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_until_env">merge_until_env</a></span> @3_ <span class="id">t</span>) <span class="id">s</span> _).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intros</span> (<span class="id">j</span>,<span class="id">r</span>).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ (<span class="id">j</span>,<span class="id">r</span>) @4_ <span class="id">F</span>) ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_until_env">rem_until_env</a></span> @2_ <span class="id">t'</span>) <span class="id">e</span>) _ _).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> (<span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">k</span> <span class="id">i</span> <span class="kwd">then</span> _ <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">k</span> @_ <span class="id">hist</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#chain_AP">chain_AP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @_ <span class="id">hist</span>)  ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_until">merge_until</a></span> @2_ <span class="id">t'</span>) <span class="id">s</span>)).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intros</span> (<span class="id">k</span>,<span class="id">T</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> (<span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">k</span> <span class="id">i</span> <span class="kwd">then</span> _ <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ (<span class="id">k</span>,<span class="id">T</span>) @_ <span class="id">trim</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#chain_AP">chain_AP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_until">rem_until</a></span> @_ <span class="id">t'</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ (<span class="id">i</span>,<span class="id">T</span>) @_ <span class="id">trim</span>)).<br/>
Defined.
<br/>
<br/>
<div class="doc">on utilise un type dépendant dans <span class="bracket"><span class="id">trim</span></span> pour pouvoir l'appliquer à la fois
  * à des <span class="bracket"><span class="id">DS</span> <span class="id">A</span></span> et des <span class="bracket"><span class="id">env</span> <span class="id">A</span></span> </div>
<span class="kwd">Lemma</span> <span class="id"><a name="auto_weakf_eq">auto_weakf_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">F</span> <span class="id">i</span> <span class="id">reset</span> <span class="id">e</span> <span class="id">hist</span> <span class="id">trim</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_weakf">auto_weakf</a></span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">F</span> (<span class="id">i</span>,<span class="id">reset</span>) <span class="id">e</span> <span class="id">hist</span> <span class="id">trim</span> ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">s</span> := <span class="kwd">if</span> <span class="id">reset</span> <span class="kwd">then</span> <span class="id">fs</span> <span class="id">i</span> <span class="id">e</span> <span class="kwd">else</span> (<span class="id"><a href="Velus.Lustre.Denot.Kenv.html#ext_env">ext_env</a></span> (<span class="id">trim</span> (<span class="id">i</span>,_))) (<span class="id">fs</span> <span class="id">i</span> (<span class="id">hist</span> <span class="id">i</span> <span class="id">e</span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">t</span> := <span class="kwd">if</span> <span class="id">reset</span> <span class="kwd">then</span> <span class="id">ft</span> <span class="id">i</span> <span class="id">s</span> <span class="kwd">else</span> <span class="id">trim</span> (<span class="id">i</span>,_) (<span class="id">ft</span> <span class="id">i</span> (<span class="id">hist</span> <span class="id">i</span> <span class="id">e</span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">t'</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#is_some">is_some</a></span> <span class="id">t</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">hist</span> := <span class="kwd">fun</span> <span class="id">k</span> =&gt;      <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">k</span> <span class="id">i</span> <span class="kwd">then</span> <span class="id">hist</span> <span class="id">i</span> @_ <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_until">merge_until</a></span> <span class="id">t'</span> <span class="id">s</span> <span class="kwd">else</span> <span class="id">hist</span> <span class="id">k</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">trim</span> := <span class="kwd">fun</span> '(<span class="id">k</span>,<span class="id">T</span>) =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">k</span> <span class="id">i</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_until">rem_until</a></span> <span class="id">t'</span> @_ <span class="id">trim</span> (<span class="id">i</span>,<span class="id">T</span>) <span class="kwd">else</span> <span class="id">trim</span> (<span class="id">k</span>,<span class="id">T</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_until_env">merge_until_env</a></span> <span class="id">t</span> <span class="id">s</span> (<span class="kwd">fun</span> '(<span class="id">j</span>,<span class="id">r</span>) =&gt; <span class="id">F</span> (<span class="id">j</span>,<span class="id">r</span>) (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_until_env">rem_until_env</a></span> <span class="id">t'</span> <span class="id">e</span>) <span class="id">hist</span> <span class="id">trim</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_weakf">auto_weakf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> ?<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#curry_Curry">curry_Curry</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Curry_simpl">Curry_simpl</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR_simpl">Dprodi_DISTR_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp3_simpl">fcont_comp3_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_stable3">fcont_stable3</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_until_env">merge_until_env</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">reset</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">reset</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intros</span> [].<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR_simpl">Dprodi_DISTR_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_comp4_simpl">fcont_comp4_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_stable3">fcont_stable3</a></span> (<span class="id">F</span> (<span class="id">i0</span>,<span class="id">b</span>))).<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">reset</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR_simpl">Dprodi_DISTR_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> _ _); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> ?<span class="id">a</span> ?<span class="id">b</span>) <span class="kwd">with</span> (<span class="id">a</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">reset</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intros</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR_simpl">Dprodi_DISTR_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> _ _); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">reset</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="auto_weak">auto_weak</a></span> (<span class="id">i</span> : <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>))) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- _ (_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) _) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">fs</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ft</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">e</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">F</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ (<span class="id">i</span>,<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ @_ ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_weakf">auto_weakf</a></span> @2_ <span class="id">fs</span>) <span class="id">ft</span>))).<br/>
&nbsp;&nbsp;<span class="id">cbv</span> <span class="id">beta</span> <span class="id">iota</span> <span class="kwd">in</span> <span class="id">F</span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @4_ <span class="id">F</span>) <span class="id">e</span> _ _).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#CTE">CTE</a></span>; <span class="id">intro</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#CTE">CTE</a></span>; <span class="id">intros</span> []; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="auto_weak_eq">auto_weak_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_weak">auto_weak</a></span> <span class="id">i</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">e</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_weakf">auto_weakf</a></span> <span class="id">fs</span> <span class="id">ft</span>)) (<span class="id">i</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">e</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> _ ) (<span class="kwd">fun</span> '(<span class="id">i</span>,_) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> _).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<h2> Transitions mixtes fortes </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="auto_strongf">auto_strongf</a></span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>))) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> '((<span class="id">i</span>,<span class="id">init</span>,<span class="id">reset</span>):(<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>*<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>*<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>)) =&gt;<br/>
  <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt;<br/>
 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> <span class="id">i</span>:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>)) -<span class="id">C</span>-&gt;<br/>
 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> '((<span class="id">i</span>,<span class="id">A</span>):<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>*<span class="kwd">Type</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>)) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>)<br/>
&nbsp;&nbsp;-<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> '((<span class="id">i</span>,<span class="id">init</span>,<span class="id">reset</span>):(<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>*<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>*<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>)) =&gt;<br/>
  <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt;<br/>
 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> <span class="id">i</span>:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>)) -<span class="id">C</span>-&gt;<br/>
 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> '((<span class="id">i</span>,<span class="id">A</span>):<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>*<span class="kwd">Type</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>)) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intros</span> ((<span class="id">i</span> &amp; <span class="id">init</span>) &amp; <span class="id">reset</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- _ (_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) _) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">fs</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ft</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">F</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">e</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">hist</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">trim</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">t</span> := <span class="kwd">if</span> <span class="id">init</span> <span class="kwd">then</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @2_ <span class="id">ft</span>) <span class="id">e</span> <span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id">reset</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @2_ <span class="id">ft</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> @_ <span class="id">e</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ (<span class="id">i</span>,_) @2_ <span class="id">trim</span>) ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @2_ <span class="id">ft</span>) ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @2_ <span class="id">hist</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> @_ <span class="id">e</span>))))).<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">s</span> := <span class="kwd">if</span> <span class="id">reset</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @2_ <span class="id">fs</span>) <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> (<span class="id"><a href="Velus.Lustre.Denot.Kenv.html#ext_env">ext_env</a></span> @2_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ (<span class="id">i</span>,_) @_ <span class="id">trim</span>)) ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @2_ <span class="id">fs</span>) ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @2_ <span class="id">hist</span>) <span class="id">e</span>))).<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">t'</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#is_some">is_some</a></span> @_ <span class="id">t</span>).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_unless">mergei_unless</a></span> @3_ <span class="id">t</span>) <span class="id">s</span> _).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intros</span> (<span class="id">j</span>,<span class="id">r</span>).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ (<span class="id">j</span>,<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>,<span class="id">r</span>) @4_ <span class="id">F</span>) ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unless_env">rem_unless_env</a></span> @2_ <span class="id">t'</span>) <span class="id">e</span>) _ _).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> (<span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">k</span> <span class="id">i</span> <span class="kwd">then</span> _ <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">k</span> @_ <span class="id">hist</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#chain_AP">chain_AP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">i</span> @_ <span class="id">hist</span>)  ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_unless">merge_unless</a></span> @2_ <span class="id">t'</span>) <span class="id">s</span>)).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intros</span> (<span class="id">k</span>,<span class="id">T</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> (<span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">k</span> <span class="id">i</span> <span class="kwd">then</span> _ <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ (<span class="id">k</span>,<span class="id">T</span>) @_ <span class="id">trim</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#chain_AP">chain_AP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unless">rem_unless</a></span> @_ <span class="id">t'</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ (<span class="id">i</span>,<span class="id">T</span>) @_ <span class="id">trim</span>)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="auto_strongf_eq">auto_strongf_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">F</span> <span class="id">i</span> <span class="id">init</span> <span class="id">reset</span> <span class="id">e</span> <span class="id">hist</span> <span class="id">trim</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_strongf">auto_strongf</a></span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">F</span> (<span class="id">i</span>,<span class="id">init</span>,<span class="id">reset</span>) <span class="id">e</span> <span class="id">hist</span> <span class="id">trim</span> ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">t</span> := <span class="kwd">if</span> <span class="id">init</span> <span class="kwd">then</span> <span class="id">ft</span> <span class="id">i</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="kwd">if</span> <span class="id">reset</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> (<span class="id">ft</span> <span class="id">i</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> (<span class="id">trim</span> (<span class="id">i</span>,_) (<span class="id">ft</span> <span class="id">i</span> (<span class="id">hist</span> <span class="id">i</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">e</span>)))) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">s</span> := <span class="kwd">if</span> <span class="id">reset</span> <span class="kwd">then</span> <span class="id">fs</span> <span class="id">i</span> <span class="id">e</span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Kenv.html#ext_env">ext_env</a></span> (<span class="id">trim</span> (<span class="id">i</span>,_)) (<span class="id">fs</span> <span class="id">i</span> (<span class="id">hist</span> <span class="id">i</span> <span class="id">e</span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">t'</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#is_some">is_some</a></span> <span class="id">t</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">hist</span> := <span class="kwd">fun</span> <span class="id">k</span> =&gt;      <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">k</span> <span class="id">i</span> <span class="kwd">then</span> <span class="id">hist</span> <span class="id">i</span> @_ <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#merge_unless">merge_unless</a></span> <span class="id">t'</span> <span class="id">s</span> <span class="kwd">else</span> <span class="id">hist</span> <span class="id">k</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">trim</span> := <span class="kwd">fun</span> '(<span class="id">k</span>,<span class="id">T</span>) =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> <span class="id">k</span> <span class="id">i</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unless">rem_unless</a></span> <span class="id">t'</span> @_ <span class="id">trim</span> (<span class="id">i</span>,<span class="id">T</span>) <span class="kwd">else</span> <span class="id">trim</span> (<span class="id">k</span>,<span class="id">T</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_unless">mergei_unless</a></span> <span class="id">t</span> <span class="id">s</span> (<span class="kwd">fun</span> '(<span class="id">j</span>,<span class="id">r</span>) =&gt; <span class="id">F</span> (<span class="id">j</span>,<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>,<span class="id">r</span>) (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#rem_unless_env">rem_unless_env</a></span> <span class="id">t'</span> <span class="id">e</span>) <span class="id">hist</span> <span class="id">trim</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_strongf">auto_strongf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> ?<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#curry_Curry">curry_Curry</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Curry_simpl">Curry_simpl</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR_simpl">Dprodi_DISTR_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp3_simpl">fcont_comp3_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_stable3">fcont_stable3</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#mergei_unless">mergei_unless</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">init</span>, <span class="id">reset</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">init</span>, <span class="id">reset</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intros</span> [].<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR_simpl">Dprodi_DISTR_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_comp4_simpl">fcont_comp4_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_stable3">fcont_stable3</a></span> (<span class="id">F</span> (<span class="id">i0</span>,<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>,<span class="id">b</span>))).<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">init</span>, <span class="id">reset</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR_simpl">Dprodi_DISTR_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> _ _); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> ?<span class="id">a</span> ?<span class="id">b</span>) <span class="kwd">with</span> (<span class="id">a</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">init</span>, <span class="id">reset</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intros</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR_simpl">Dprodi_DISTR_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#id_st_eqb">id_st_eqb</a></span> _ _); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">init</span>, <span class="id">reset</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="auto_strong">auto_strong</a></span> (<span class="id">i</span> : <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> _:<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.id_st">id_st</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>))) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO.A">A</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- _ (_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) _) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">fs</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ft</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">e</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">F</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ (<span class="id">i</span>,<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>,<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ @_ ((<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_strongf">auto_strongf</a></span> @2_ <span class="id">fs</span>) <span class="id">ft</span>))).<br/>
&nbsp;&nbsp;<span class="id">cbv</span> <span class="id">beta</span> <span class="id">iota</span> <span class="kwd">in</span> <span class="id">F</span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @4_ <span class="id">F</span>) <span class="id">e</span> _ _).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#CTE">CTE</a></span>; <span class="id">intro</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#CTE">CTE</a></span>; <span class="id">intros</span> []; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="auto_strong_eq">auto_strong_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_strong">auto_strong</a></span> <span class="id">i</span> <span class="id">fs</span> <span class="id">ft</span> <span class="id">e</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ (<span class="id"><a href="Velus.Lustre.Denot.Kauto.html#auto_strongf">auto_strongf</a></span> <span class="id">fs</span> <span class="id">ft</span>)) (<span class="id">i</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">e</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> _ ) (<span class="kwd">fun</span> '(<span class="id">i</span>,_) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> _).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO.AUTO">AUTO</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.Kauto.html#KAUTO">KAUTO</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
