
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module VelusCorrectness</title>
<meta name="description" content="Documentation of Coq module VelusCorrectness" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module VelusCorrectness</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html">common.Errors</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html">common.Events</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Behaviors.html">common.Behaviors</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html">cfrontend.Clight</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.ClightBigstep.html">cfrontend.ClightBigstep</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html">lib.Integers</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html">driver.Compiler</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Ident.html">Ident</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.CoindStreams.html">CoindStreams</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Generation.html">ObcToClight.Generation</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Traces.html">Traces</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.ClightToAsm.html">ClightToAsm</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Correctness.html">ObcToClight.Correctness</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html">Interface</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Instantiator.html">Instantiator</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.LustreElab.html">Lustre.LustreElab</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Velus.html">Velus</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.NLCorrectness.html">NLCorrectness</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.Instantiator.html#Stc.Syn">Stc.Syn</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.Instantiator.html#NL">NL</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.Instantiator.html#L">L</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn">Obc.Syn</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem">Obc.Sem</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ">Obc.Typ</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Equ">Obc.Equ</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def">Obc.Def</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.Obc.Fusion.html">Fusion</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.Instantiator.html#Stc2ObcInvariants">Stc2ObcInvariants</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.Instantiator.html#L.CkCor.IStr">IStr</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#CStr">CStr</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.Instantiator.html#L.Norm.Correct.CIStr">CIStr</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux">OpAux</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op">Op</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#ListNotations">List.ListNotations</a></span>.<br/>
<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">error_monad_scope</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">stream_scope</span>.<br/>
<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="WtStream">WtStream</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">PSyn</span> : <span class="id"><a href="Velus.Instantiator.html#L.Syn.block">block</a></span> -&gt; <span class="kwd">Prop</span>} {<span class="id">prefs</span> : <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span>}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="WtStream.G">G</a></span>: @<span class="id"><a href="Velus.Instantiator.html#L.Syn.global">global</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#WtStream.PSyn">PSyn</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#WtStream.prefs">prefs</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="WtStream.main">main</a></span>: <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="WtStream.ins">ins</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.value">value</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="WtStream.outs">outs</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.value">value</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="wt_ins">wt_ins</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">node</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#L.Syn.find_node">find_node</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#WtStream.main">main</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#WtStream.G">G</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">node</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#wt_streams">NLCorrectness.wt_streams</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#WtStream.ins">ins</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> <span class="id">node</span>.(<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_in">n_in</a></span>))).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="wt_outs">wt_outs</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">node</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#L.Syn.find_node">find_node</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#WtStream.main">main</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#WtStream.G">G</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">node</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#wt_streams">NLCorrectness.wt_streams</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#WtStream.outs">outs</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> <span class="id">node</span>.(<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_out">n_out</a></span>))).<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.VelusCorrectness.html#WtStream">WtStream</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="wc_ins">wc_ins</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Instantiator.html#L.Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">main</span> <span class="id">ins</span> := <span class="id"><a href="Velus.Instantiator.html#L.CkCor.sem_clock_inputs">sem_clock_inputs</a></span> <span class="id">G</span> <span class="id">main</span> <span class="id">ins</span>.<br/>
<br/>
<div class="doc">The trace of a Lustre node </div>
<span class="kwd">Section</span> <span class="id"><a name="LTrace">LTrace</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">PSyn</span> : <span class="id"><a href="Velus.Instantiator.html#L.Syn.block">block</a></span> -&gt; <span class="kwd">Prop</span>} {<span class="id">prefs</span> : <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span>}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="LTrace.node">node</a></span>: @<span class="id"><a href="Velus.Instantiator.html#L.Syn.node">node</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.PSyn">PSyn</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.prefs">prefs</a></span>) (<span class="id"><a name="LTrace.ins">ins</a></span> <span class="id"><a name="LTrace.outs">outs</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.value">value</a></span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LTrace.Spec_in_out">Spec_in_out</a></span> : <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_in">n_in</a></span>) &lt;&gt; [] \/ <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_out">n_out</a></span>) &lt;&gt; [].<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LTrace.Len_ins">Len_ins</a></span>     : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.ins">ins</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_in">n_in</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LTrace.Len_outs">Len_outs</a></span>    : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.outs">outs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_out">n_out</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="trace_node">trace_node</a></span> (<span class="id">n</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>): <span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html#traceinf">traceinf</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Traces.html#mk_trace">mk_trace</a></span> (<span class="id"><a href="Velus.Instantiator.html#L.Norm.Correct.CIStr.CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.ins">ins</a></span>) (<span class="id"><a href="Velus.Instantiator.html#L.Norm.Correct.CIStr.CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.outs">outs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_in">n_in</a></span>))) (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_out">n_out</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof1')">Next Obligation.</span></div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.Spec_in_out">Spec_in_out</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">left</span>; <span class="tactic">intro</span> <span class="id">E</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_eq_nil">map_eq_nil</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_eq_nil">map_eq_nil</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>; <span class="tactic">intro</span> <span class="id">E</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_eq_nil">map_eq_nil</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_eq_nil">map_eq_nil</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof2')">Next Obligation.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Instantiator.html#L.Norm.Correct.CIStr.CIStr.tr_Streams">tr_Streams</a></span>, <span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span>; <span class="tactic">rewrite</span> 3 <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof3')">Next Obligation.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Instantiator.html#L.Norm.Correct.CIStr.CIStr.tr_Streams">tr_Streams</a></span>, <span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span>; <span class="tactic">rewrite</span> 3 <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">Simply link the trace of a Lustre node with the trace of an NLustre node with the same parameters </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="trace_inf_sim_node">trace_inf_sim_node</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">n</span>' <span class="id">Spec_in_out_n</span>' <span class="id">Len_ins_n</span>' <span class="id">Len_outs_n</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">NL.Syn.n_in</a></span> <span class="id">n</span>') = <span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_in">n_in</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.node">node</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">NL.Syn.n_out</a></span> <span class="id">n</span>') = <span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_out">n_out</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.node">node</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html#traceinf_sim">traceinf_sim</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#trace_node">NLCorrectness.trace_node</a></span> <span class="id">n</span>' <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.ins">ins</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.outs">outs</a></span> <span class="id">Spec_in_out_n</span>' <span class="id">Len_ins_n</span>' <span class="id">Len_outs_n</span>' <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.VelusCorrectness.html#trace_node">trace_node</a></span> <span class="id">n</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#trace_node">NLCorrectness.trace_node</a></span>, <span class="id"><a href="Velus.VelusCorrectness.html#trace_node">trace_node</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">traceinf_sim</span>'<span class="id">_sim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">n</span>; <span class="kwd">cofix</span> <span class="id">COFIX</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Traces.html#unfold_mk_trace">unfold_mk_trace</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Traces.html#unfold_mk_trace">unfold_mk_trace</a></span> <span class="kwd">with</span> (<span class="id">xs</span> := <span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_in">n_in</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.node">node</a></span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="Velus.Traces.html#load_events">load_events</a></span> (<span class="id"><a href="Velus.Instantiator.html#L.Norm.Correct.CIStr.CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.ins">ins</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_in">n_in</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.node">node</a></span>))) ** <span class="id"><a href="Velus.Traces.html#store_events">store_events</a></span> (<span class="id"><a href="Velus.Instantiator.html#L.Norm.Correct.CIStr.CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.outs">outs</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_out">n_out</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.node">node</a></span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="Velus.Traces.html#load_events">load_events</a></span> (<span class="id"><a href="Velus.Instantiator.html#L.Norm.Correct.CIStr.CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.ins">ins</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">NL.Syn.n_in</a></span> <span class="id">n</span>')) ** <span class="id"><a href="Velus.Traces.html#store_events">store_events</a></span> (<span class="id"><a href="Velus.Instantiator.html#L.Norm.Correct.CIStr.CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.outs">outs</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">NL.Syn.n_out</a></span> <span class="id">n</span>')));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">E</span>; <span class="tactic">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html#Eapp_E0_inv">Eapp_E0_inv</a></span> <span class="kwd">in</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Instantiator.html#L.Norm.Correct.CIStr.CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.ins">ins</a></span> <span class="id">n</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">NL.Syn.n_in</a></span> <span class="id">n</span>'))) <span class="kwd">as</span> <span class="id">Len_ins_2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Instantiator.html#L.Norm.Correct.CIStr.CIStr.tr_Streams">tr_Streams</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="Velus.Common.Common.html#length_idty">length_idty</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Instantiator.html#L.Norm.Correct.CIStr.CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace.outs">outs</a></span> <span class="id">n</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">NL.Syn.n_out</a></span> <span class="id">n</span>'))) <span class="kwd">as</span> <span class="id">Len_outs_2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Instantiator.html#L.Norm.Correct.CIStr.CIStr.tr_Streams">tr_Streams</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="Velus.Common.Common.html#length_idty">length_idty</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">NL.Syn.n_in</a></span> <span class="id">n</span>') &lt;&gt; [] \/ <span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">NL.Syn.n_out</a></span> <span class="id">n</span>') &lt;&gt; []) <span class="kwd">as</span> <span class="id">Spec_in_out_2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span> - <span class="id">Spec_in_out_n</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Spec_in_out_n</span>'; [<span class="tactic">left</span>|<span class="tactic">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">intro</span> <span class="id">contra</span>; <span class="tactic">eapply</span> <span class="id">H</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_eq_nil">map_eq_nil</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Traces.html#load_store_events_not_E0">load_store_events_not_E0</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Spec_in_out_2</span> <span class="id">Len_ins_2</span> <span class="id">Len_outs_2</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">COFIX</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.VelusCorrectness.html#LTrace">LTrace</a></span>.<br/>
<br/>
<div class="doc">A bisimulation relation between a declared node's trace and a given trace </div>
<span class="kwd">Inductive</span> <span class="id"><a name="bisim_IO">bisim_IO</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Instantiator.html#L.Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) (<span class="id">f</span>: <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id">ins</span> <span class="id">outs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.value">value</a></span>)): <span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html#traceinf">traceinf</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="IOStep">IOStep</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">T</span> <span class="id">node</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Spec_in_out</span> : <span class="id">node</span>.(<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_in">n_in</a></span>) &lt;&gt; [] \/ <span class="id">node</span>.(<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_out">n_out</a></span>) &lt;&gt; [])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Len_ins</span>     : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">ins</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">node</span>.(<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_in">n_in</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Len_outs</span>    : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">outs</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">node</span>.(<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_out">n_out</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#L.Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">node</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html#traceinf_sim">traceinf_sim</a></span> <span class="id">T</span> (<span class="id"><a href="Velus.VelusCorrectness.html#trace_node">trace_node</a></span> <span class="id">node</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">Spec_in_out</span> <span class="id">Len_ins</span> <span class="id">Len_outs</span> 0) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bisim_IO</span> <span class="id">G</span> <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">T</span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_global_Ordered_nodes</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">delast_global_wt</span> <span class="id">delast_global_wc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">switch_global_wt</span> <span class="id">switch_global_wc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inlinelocal_global_wt</span> <span class="id">inlinelocal_global_wc</span> <span class="id">inlinelocal_global_sem</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">normalize_global_normalized_global</span> <span class="id">normalized_global_unnested_global</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Typing.normalize_global_wt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Clocking.normalize_global_wc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">normalize_global_sem</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">check_causality_correct</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Ltac</span> <span class="id">unfold_l_to_nl</span> <span class="id">Hltonl</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Velus.html#l_to_nl">l_to_nl</a></span> <span class="kwd">in</span> <span class="id">Hltonl</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hltonl</span>;<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#print_identity">print_identity</a></span> <span class="kwd">in</span> <span class="id">Hltonl</span>;<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Velus.html#is_causal">is_causal</a></span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hcaus</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hltonl</span>; [|<span class="id">inv</span> <span class="id">Hltonl</span>];<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#print_identity">print_identity</a></span> <span class="kwd">in</span> <span class="id">Hltonl</span>;<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">Hcaus</span>.<br/>
<br/>
<div class="doc">Correctness from Lustre to NLustre </div>
<span class="kwd">Lemma</span> <span class="id"><a name="behavior_l_to_nl">behavior_l_to_nl</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">G</span> <span class="id">G</span>' <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#L.Typ.wt_global">wt_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#L.Clo.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#L.Sem.sem_node">Sem.sem_node</a></span> <span class="id">G</span> <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.VelusCorrectness.html#wc_ins">wc_ins</a></span> <span class="id">G</span> <span class="id">main</span> <span class="id">ins</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Velus.html#l_to_nl">l_to_nl</a></span> <span class="id">G</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">G</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.CoindSem.sem_node">CoindSem.sem_node</a></span> <span class="id">G</span>' <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">G</span> * <span class="id">Hwt</span> <span class="id">Hwc</span> <span class="id">Hsem</span> <span class="id">Hwcins</span> <span class="id">Hltonl</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold_l_to_nl</span> <span class="id">Hltonl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Instantiator.html#TR.Correctness.sem_l_nl">TR.Correctness.sem_l_nl</a></span> <span class="kwd">in</span> <span class="id">Hltonl</span>; <span class="tactic">eauto</span> 12 <span class="kwd">with</span> <span class="id">ltyping</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Instantiator.html#L.Norm.Correct.normalize_global_sem">normalize_global_sem</a></span>, <span class="id"><a href="Velus.Instantiator.html#L.InlineLocal.Correct.inlinelocal_global_sem">inlinelocal_global_sem</a></span>, <span class="id"><a href="Velus.Instantiator.html#L.ClockSwitch.Correct.switch_global_sem">switch_global_sem</a></span>, <span class="id"><a href="Velus.Instantiator.html#L.DeLast.Correct.delast_global_sem">delast_global_sem</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Instantiator.html#L.CkCor.sem_node_sem_node_ck">sem_node_sem_node_ck</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">ltyping</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fact</span> <span class="id">l_to_nl_find_node</span>' : <span class="kwd">forall</span> <span class="id">G</span> <span class="id">G</span>' <span class="id">f</span> <span class="id">n</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Syn.find_node">NL.Syn.find_node</a></span> <span class="id">f</span> <span class="id">G</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Velus.html#l_to_nl">l_to_nl</a></span> <span class="id">G</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">G</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">n</span>, <span class="id"><a href="Velus.Instantiator.html#L.Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">NL.Syn.n_in</a></span> <span class="id">n</span>' = <span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_in">n_in</a></span> <span class="id">n</span>) /\ <span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">NL.Syn.n_out</a></span> <span class="id">n</span>' = <span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_out">n_out</a></span> <span class="id">n</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">G</span> * <span class="id">Hfind</span> <span class="id">Hltonl</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold_l_to_nl</span> <span class="id">Hltonl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">TR.Tr.find_node_global</span>' <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> (<span class="id">n</span>''&amp;<span class="id">Hfind</span>&amp;<span class="id">Htonode</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Instantiator.html#L.Syn.global_iface_eq_find">global_iface_eq_find</a></span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> (<span class="id">n</span>&amp;<span class="id">Hfind</span>&amp;(<span class="id">_</span>&amp;<span class="id">_</span>&amp;<span class="id">Hin</span>&amp;<span class="id">Hout</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;2:{ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Instantiator.html#L.Syn.global_iface_eq_sym">global_iface_eq_sym</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Instantiator.html#L.Syn.global_iface_eq_trans">global_iface_eq_trans</a></span>, <span class="id"><a href="Velus.Instantiator.html#L.Norm.Norm.normalize_global_iface_eq">normalize_global_iface_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Instantiator.html#L.Syn.global_iface_eq_trans">global_iface_eq_trans</a></span>, <span class="id"><a href="Velus.Instantiator.html#L.InlineLocal.IL.inlinelocal_global_iface_eq">inlinelocal_global_iface_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Instantiator.html#L.Syn.global_iface_eq_trans">global_iface_eq_trans</a></span>, <span class="id"><a href="Velus.Instantiator.html#L.ClockSwitch.CS.switch_global_iface_eq">switch_global_iface_eq</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#L.Syn.global_iface_eq_refl">global_iface_eq_refl</a></span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Instantiator.html#L.Syn.global_iface_eq_find">global_iface_eq_find</a></span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;(<span class="id">_</span>&amp;<span class="id">_</span>&amp;<span class="id">Hin</span>''&amp;<span class="id">Hout</span>'')); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;2:<span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#L.Syn.global_iface_eq_sym">global_iface_eq_sym</a></span>, <span class="id"><a href="Velus.Instantiator.html#L.DeLast.DL.delast_global_iface_eq">delast_global_iface_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Instantiator.html#TR.Tr.to_node_in">TR.Tr.to_node_in</a></span> <span class="kwd">in</span> <span class="id">Htonode</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Instantiator.html#TR.Tr.to_node_out">TR.Tr.to_node_out</a></span> <span class="kwd">in</span> <span class="id">Htonode</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">The ultimate lemma states that, if
    - the parsed declarations <span class="bracket"><span class="id">D</span></span> elaborate to a dataflow program <span class="bracket"><span class="id">G</span></span> and
      a proof <span class="bracket"><span class="id">Gp</span></span> that it satisfies <span class="bracket"><span class="id">wt_global</span> <span class="id">G</span></span> and <span class="bracket"><span class="id">wc_global</span> <span class="id">G</span></span>,
    - the values on input streams <span class="bracket"><span class="id">ins</span></span> are well-typed according to the
      interface of the <span class="bracket"><span class="id">main</span></span> node,
    - the inputs of the <span class="bracket"><span class="id">main</span></span> node are all on the base clock
    - the input and output streams are related by the dataflow semantics
      of the node <span class="bracket"><span class="id">main</span></span> in <span class="bracket"><span class="id">G</span></span>, and
    - compilation succeeds in generating an assembler program <span class="bracket"><span class="id">P</span></span>,
    then the assembler program generates an infinite sequence of volatile
    reads and writes that correspond to the successive values on the
    input and output streams. </div>
<span class="kwd">Theorem</span> <span class="id"><a name="behavior_asm">behavior_asm</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">G</span> <span class="id">Gp</span> <span class="id">P</span> <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#elab_declarations">elab_declarations</a></span> <span class="id">D</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">G</span> <span class="id">Gp</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.VelusCorrectness.html#wt_ins">wt_ins</a></span> <span class="id">G</span> <span class="id">main</span> <span class="id">ins</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.VelusCorrectness.html#wc_ins">wc_ins</a></span> <span class="id">G</span> <span class="id">main</span> (<span class="id"><a href="Velus.NLCorrectness.html#pStr">pStr</a></span> <span class="id">ins</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#L.Sem.sem_node">Sem.sem_node</a></span> <span class="id">G</span> <span class="id">main</span> (<span class="id"><a href="Velus.NLCorrectness.html#pStr">pStr</a></span> <span class="id">ins</span>) (<span class="id"><a href="Velus.NLCorrectness.html#pStr">pStr</a></span> <span class="id">outs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Velus.html#compile">compile</a></span> <span class="id">D</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">main</span>) = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">T</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.x86.Asm.html#semantics">Asm.semantics</a></span> <span class="id">P</span>) (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Behaviors.html#Reacts">Reacts</a></span> <span class="id">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.VelusCorrectness.html#bisim_IO">bisim_IO</a></span> <span class="id">G</span> <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">T</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Elab</span> <span class="id">Hwti</span> <span class="id">Hwci</span> <span class="id">Hsem</span> <span class="id">Comp</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Velus.html#compile">compile</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#print">print</a></span> <span class="kwd">in</span> <span class="id">Comp</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Elab</span> <span class="kwd">in</span> <span class="id">Comp</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Comp</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Velus.html#l_to_nl">l_to_nl</a></span> <span class="id">G</span>) <span class="kwd">as</span> [<span class="id">G</span>'|] <span class="id">eqn</span>: <span class="id">Comp</span>'; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Comp</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Velus.html#nl_to_asm">nl_to_asm</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">main</span>) <span class="id">G</span>') <span class="kwd">as</span> [<span class="id">p</span>|] <span class="id">eqn</span>: <span class="id">Comp</span>''; <span class="id">inv</span> <span class="id">Comp</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Gp</span> <span class="kwd">as</span> (<span class="id">Hwc</span>&amp;<span class="id">Hwt</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.NLCorrectness.html#behavior_nl_to_asm">behavior_nl_to_asm</a></span> <span class="kwd">with</span> (<span class="id">ins</span>:=<span class="id">ins</span>) (<span class="id">outs</span>:=<span class="id">outs</span>) <span class="kwd">in</span> <span class="id">Comp</span>'' <span class="kwd">as</span> (<span class="id">T</span>&amp;<span class="id">Hbeh</span>&amp;<span class="id">Hbisim</span>).<br/>
&nbsp;&nbsp;- <span class="tactic">exists</span> <span class="id">T</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hbisim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">l_to_nl_find_node</span>' <span class="kwd">in</span> <span class="id">Comp</span>' <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>'&amp;<span class="id">Hin</span>&amp;<span class="id">Hout</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_in">n_in</a></span> <span class="id">x</span> &lt;&gt; []) <span class="kwd">as</span> <span class="id">Hnnul</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">specialize</span> (<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_ingt0">n_ingt0</a></span> <span class="id">x</span>) <span class="kwd">as</span> <span class="id">Hlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">contra</span>. <span class="tactic">rewrite</span> <span class="id">contra</span> <span class="kwd">in</span> <span class="id">Hlt</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Lt.html#lt_irrefl">Lt.lt_irrefl</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">ins</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> (<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_in">n_in</a></span> <span class="id">x</span>)) <span class="kwd">as</span> <span class="id">Hlenin</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Common.Common.html#length_idty">length_idty</a></span>; <span class="tactic">congruence</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">outs</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> (<span class="id"><a href="Velus.Instantiator.html#L.Syn.n_out">n_out</a></span> <span class="id">x</span>)) <span class="kwd">as</span> <span class="id">Hlenout</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Common.Common.html#length_idty">length_idty</a></span>; <span class="tactic">congruence</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.VelusCorrectness.html#IOStep">IOStep</a></span> <span class="kwd">with</span> (<span class="id">Spec_in_out</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#or_introl">or_introl</a></span> <span class="id">Hnnul</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Len_ins</span>:=<span class="id">Hlenin</span>) (<span class="id">Len_outs</span>:=<span class="id">Hlenout</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html#traceinf_sim_trans">traceinf_sim_trans</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.VelusCorrectness.html#trace_inf_sim_node">trace_inf_sim_node</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">f_equal</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">clear</span> - <span class="id">Hwc</span> <span class="id">Hwt</span> <span class="id">Comp</span>'. <span class="id">unfold_l_to_nl</span> <span class="id">Comp</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Instantiator.html#TR.Clocking.wc_transcription">TR.Clocking.wc_transcription</a></span> <span class="kwd">in</span> <span class="id">Comp</span>'; <span class="tactic">eauto</span> 8.<br/>
&nbsp;&nbsp;- <span class="tactic">clear</span> - <span class="id">Hwc</span> <span class="id">Hwt</span> <span class="id">Comp</span>'. <span class="id">unfold_l_to_nl</span> <span class="id">Comp</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Instantiator.html#TR.Typing.wt_transcription">TR.Typing.wt_transcription</a></span> <span class="kwd">in</span> <span class="id">Comp</span>'; <span class="tactic">eauto</span> 8.<br/>
&nbsp;&nbsp;- <span class="tactic">clear</span> - <span class="id">Hwti</span> <span class="id">Comp</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">l_to_nl_find_node</span>' <span class="kwd">in</span> <span class="id">Comp</span>' <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>'&amp;<span class="id">Hin</span>&amp;<span class="id">_</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hwti</span> <span class="kwd">in</span> <span class="id">Hfind</span>'. <span class="tactic">rewrite</span> <span class="id">Hin</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">clear</span> - <span class="id">Hwt</span> <span class="id">Comp</span>'. <span class="id">unfold_l_to_nl</span> <span class="id">Comp</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Instantiator.html#TR.NormalArgs.to_global_normal_args">TR.NormalArgs.to_global_normal_args</a></span> <span class="kwd">in</span> <span class="id">Comp</span>'; <span class="tactic">eauto</span> 12 <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.VelusCorrectness.html#behavior_l_to_nl">behavior_l_to_nl</a></span> <span class="kwd">in</span> <span class="id">Comp</span>'; <span class="tactic">eauto</span>.<br/>
Qed.</div>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
