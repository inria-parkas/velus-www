
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Fresh</title>
<meta name="description" content="Documentation of Coq module Fresh" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Fresh</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html">Sorting.Permutation</a></span>.<br/>
<span class="kwd">Import</span> <span class="id">List.ListNotations</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html">Classes.RelationClasses</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Setoids.Setoid.html">Setoid</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span>.<br/>
<br/>
<h1> Fresh name generation </h1>
<br/>
<div class="doc">The fresh monad (with memory) : generates new names and keeps
    a record of each name generated along with some information
    The file is structured as such:
    - a signature FRESHKERNEL, which exposes the kernel features of the monad
    - a functor FreshKernel which implements the previous signature,
      and contains some gruesome definitions details that we prefer to hide
    - a functor Fresh that includes FreshKernel and also offers some additional lemmas.
      This module should be instanciated using an IDS module that contains, among other things,
      the gensym function used for name generation
 </div>
<span class="kwd">Module</span> <span class="kwd">Type</span> <span class="id"><a name="FRESHKERNEL">FRESHKERNEL</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ids</span> : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>).<br/>
<br/>
<div class="doc">The Monad manipulates a state, which exposes a list of the identifiers generated
      by the monad, paired with some data </div>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FRESHKERNEL.st">st</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Parameter</span> <span class="id"><a name="FRESHKERNEL.fresh_st">fresh_st</a></span> : <span class="kwd">Type</span> -&gt; <span class="kwd">Type</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Parameter</span> <span class="id"><a name="FRESHKERNEL.st_anns">st_anns</a></span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st.B">B</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st.B">B</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="FRESHKERNEL.st_ids">st_ids</a></span> (<span class="id">st</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st.B">B</a></span>) := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_anns">st_anns</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st">st</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="FRESHKERNEL.Fresh">Fresh</a></span> (<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>) : <span class="kwd">Type</span> := <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#B">B</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#A">A</a></span> * <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#B">B</a></span>.<br/>
<br/>
<div class="doc">The state can be deemed as "valid".
      <span class="bracket"><span class="id">st_valid_after</span> <span class="id">st</span> <span class="id">prefix</span> <span class="id">aft</span></span> means that the state only contains
      identifier prefixed by <span class="bracket"><span class="id">prefix</span></span> and that are distinct from the ones in <span class="bracket"><span class="id">aft</span></span>.
      This properties also ensures that all ids in the state are distinct </div>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FRESHKERNEL.validity">validity</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Parameter</span> <span class="id"><a name="FRESHKERNEL.st_valid_after">st_valid_after</a></span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.validity.B">B</a></span> -&gt; <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> -&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.t">PS.t</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.st_valid_NoDup">st_valid_NoDup</a></span> : <span class="kwd">forall</span> <span class="id">st</span> <span class="id">prefix</span> <span class="id">aft</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefix">prefix</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>++<span class="id"><a href="Velus.Common.CommonPS.html#PSP.to_list">PSP.to_list</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.st_valid_PSeq">st_valid_PSeq</a></span> : <span class="kwd">forall</span> <span class="id">st</span> <span class="id">prefix</span> <span class="id">aft1</span> <span class="id">aft2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.eq">PS.eq</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft1">aft1</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft2">aft2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefix">prefix</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft1">aft1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefix">prefix</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft2">aft2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.st_valid_prefixed">st_valid_prefixed</a></span> : <span class="kwd">forall</span> <span class="id">st</span> <span class="id">prefix</span> <span class="id">aft</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefix">prefix</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="tactic">exists</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> = <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.gensym">gensym</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefix">prefix</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#n">n</a></span>) (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.validity">validity</a></span>.<br/>
<br/>
<div class="doc">Sometimes we need to reuse allready existing identifiers.
      <span class="bracket"><span class="id">st_valid_reuse</span> <span class="id">st</span> <span class="id">prefix</span> <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">reusable</span></span> means that
      the state only contains idents prefixed by either <span class="bracket"><span class="id">prefix</span></span> or <span class="bracket"><span class="id">reprefs</span></span>.
      These idents are distinct from <span class="bracket"><span class="id">aft</span></span> and <span class="bracket"><span class="id">reusable</span></span>, but the ones in
      <span class="bracket"><span class="id">reusable</span></span> can also by reused by the function <span class="bracket"><span class="id">reuse_ident</span></span> (see below)
      while preserving this invariant </div>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FRESHKERNEL.validity_reuse">validity_reuse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Parameter</span> <span class="id"><a name="FRESHKERNEL.st_valid_reuse">st_valid_reuse</a></span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.validity_reuse.B">B</a></span> -&gt; <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> -&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.t">PS.t</a></span> -&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.t">PS.t</a></span> -&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.t">PS.t</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.st_valid_reuse_NoDup">st_valid_reuse_NoDup</a></span> : <span class="kwd">forall</span> <span class="id">st</span> <span class="id">prefix</span> <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">reusable</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefix">prefix</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>++<span class="id"><a href="Velus.Common.CommonPS.html#PSP.to_list">PSP.to_list</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>++<span class="id"><a href="Velus.Common.CommonPS.html#PSP.to_list">PSP.to_list</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.st_valid_reuse_PSeq">st_valid_reuse_PSeq</a></span> : <span class="kwd">forall</span> <span class="id">st</span> <span class="id">prefix</span> <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">re1</span> <span class="id">re2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.eq">PS.eq</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#re1">re1</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#re2">re2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefix">prefix</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#re1">re1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefix">prefix</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#re2">re2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.st_valid_reuse_prefixed">st_valid_reuse_prefixed</a></span> : <span class="kwd">forall</span> <span class="id">st</span> <span class="id">prefix</span> <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">reu</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefix">prefix</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reu">reu</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.AtomOrGensym">AtomOrGensym</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.add">PS.add</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefix">prefix</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span>)) (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.validity_reuse">validity_reuse</a></span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">st_follows</span></span> forms an inclusion relation over the contents of the states.
      We show below that every primimitive Fresh operation produces a new state
      that follows the previous one </div>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FRESHKERNEL.follows">follows</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Parameter</span> <span class="id"><a name="FRESHKERNEL.st_follows">st_follows</a></span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.follows.B">B</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.follows.B">B</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.st_follows_refl">st_follows_refl</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Reflexive">Reflexive</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_follows">st_follows</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.st_follows_trans">st_follows_trans</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Transitive">Transitive</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_follows">st_follows</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.st_follows_incl">st_follows_incl</a></span> : <span class="kwd">forall</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_follows">st_follows</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id">st</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_anns">st_anns</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>) (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_anns">st_anns</a></span> <span class="id">st</span>').<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.follows">follows</a></span>.<br/>
<br/>
<div class="doc">The initial state is empty.
      An empty state is valid under a few assumption :
      - the <span class="bracket"><span class="id">prefix</span></span> used for generating must be different from the ones used previously.
      - in the case of <span class="bracket"><span class="id">st_valid_reuse</span></span>, the reusable and non-reusable idents must be distinct
      When initializing </div>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FRESHKERNEL.init">init</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Parameter</span> <span class="id"><a name="FRESHKERNEL.init_st">init_st</a></span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.init.B">B</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.init_st_anns">init_st_anns</a></span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_anns">st_anns</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.init_st">init_st</a></span> = [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.init_st_valid">init_st_valid</a></span> : <span class="kwd">forall</span> <span class="id">prefix</span> <span class="id">aft</span> <span class="id">aftprefs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefix">prefix</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aftprefs">aftprefs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aftprefs">aftprefs</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.init_st">init_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefix">prefix</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.init_st_valid_reuse">init_st_valid_reuse</a></span> : <span class="kwd">forall</span> <span class="id">prefix</span> <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">reusable</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.to_list">PSP.to_list</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>++<span class="id"><a href="Velus.Common.CommonPS.html#PSP.to_list">PSP.to_list</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefix">prefix</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.init_st">init_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefix">prefix</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.init">init</a></span>.<br/>
<br/>
<div class="doc">The central function for fresh identifier generation,
      <span class="bracket"><span class="id">fresh_ident</span> <span class="id">prefix</span> <span class="id">d</span></span> generates a new identifier prefixed by <span class="bracket"><span class="id">prefix</span></span> and
      associated with data <span class="bracket"><span class="id">d</span></span> in the new state.
      <span class="bracket"><span class="id">fresh_ident</span> <span class="id">prefix</span> <span class="id">d</span></span> preserves validity as long as <span class="bracket"><span class="id">prefix</span></span> is the correct one </div>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FRESHKERNEL.fresh_ident">fresh_ident</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Parameter</span> <span class="id"><a name="FRESHKERNEL.fresh_ident">fresh_ident</a></span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.fresh_ident.B">B</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.Fresh">Fresh</a></span> <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.fresh_ident.B">B</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.fresh_ident_anns">fresh_ident_anns</a></span> : <span class="kwd">forall</span> <span class="id">pref</span> <span class="id">b</span> <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.fresh_ident">fresh_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_anns">st_anns</a></span> <span class="id">st</span>' = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span>)::(<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_anns">st_anns</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.fresh_ident_st_valid">fresh_ident_st_valid</a></span> : <span class="kwd">forall</span> <span class="id">pref</span> <span class="id">b</span> <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">aft</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.fresh_ident">fresh_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_valid_after">st_valid_after</a></span> <span class="id">st</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.fresh_ident_st_valid_reuse">fresh_ident_st_valid_reuse</a></span> : <span class="kwd">forall</span> <span class="id">pref</span> <span class="id">b</span> <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">reusable</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.fresh_ident">fresh_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_valid_reuse">st_valid_reuse</a></span> <span class="id">st</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.fresh_ident_st_follows">fresh_ident_st_follows</a></span> : <span class="kwd">forall</span> <span class="id">pref</span> <span class="id">b</span> <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.fresh_ident">fresh_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_follows">st_follows</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id">st</span>'.<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.fresh_ident">fresh_ident</a></span>.<br/>
<br/>
<div class="doc">As stated above, it is also possible to reuse already existing identifiers,
      that is adding it to the state.
      <span class="bracket"><span class="id">reuse_ident</span> <span class="id">x</span> <span class="id">d</span></span> adds <span class="bracket"><span class="id">x</span></span> into the state, associated with <span class="bracket"><span class="id">d</span></span>.
      If this function is used, only the <span class="bracket"><span class="id">st_valid_reuse</span></span> property can be preserved </div>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FRESHKERNEL.reuse_ident">reuse_ident</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Parameter</span> <span class="id"><a name="FRESHKERNEL.reuse_ident">reuse_ident</a></span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.reuse_ident.B">B</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.Fresh">Fresh</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.reuse_ident.B">B</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.reuse_ident_anns">reuse_ident_anns</a></span> : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.reuse_ident">reuse_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_anns">st_anns</a></span> <span class="id">st</span>' = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span>)::(<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_anns">st_anns</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.reuse_ident_st_valid_reuse">reuse_ident_st_valid_reuse</a></span> : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">pref</span> <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">reusable</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.reuse_ident">reuse_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.add">PS.add</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_valid_reuse">st_valid_reuse</a></span> <span class="id">st</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.reuse_ident_st_follows">reuse_ident_st_follows</a></span> : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.reuse_ident">reuse_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.st_follows">st_follows</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id">st</span>'.<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.reuse_ident">reuse_ident</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FRESHKERNEL.ret">ret</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Parameter</span> <span class="id"><a name="FRESHKERNEL.ret">ret</a></span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.ret.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.Fresh">Fresh</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.ret.A">A</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.ret.B">B</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.ret_spec">ret_spec</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">st</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.ret">ret</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.ret">ret</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FRESHKERNEL.bind">bind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">A</span>' <span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Parameter</span> <span class="id"><a name="FRESHKERNEL.bind">bind</a></span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.Fresh">Fresh</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind.A">A</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind.B">B</a></span> -&gt; (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.Fresh">Fresh</a></span> <span class="id">A</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind.B">B</a></span>) -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.Fresh">Fresh</a></span> <span class="id">A</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind.B">B</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.bind_spec">bind_spec</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.Fresh">Fresh</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind.A">A</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind.B">B</a></span>) (<span class="id">k</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.Fresh">Fresh</a></span> <span class="id">A</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind.B">B</a></span>) <span class="id">st</span> <span class="id">a</span>' <span class="id">st</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind">bind</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#k">k</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id">a</span>', <span class="id">st</span>'') &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">a</span>, <span class="tactic">exists</span> <span class="id">st</span>', (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span>, <span class="id">st</span>') /\ <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#k">k</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id">st</span>' = (<span class="id">a</span>', <span class="id">st</span>'')).<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind">bind</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FRESHKERNEL.bind2">bind2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A1</span> <span class="id">A2</span> <span class="id">A</span>' <span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Parameter</span> <span class="id"><a name="FRESHKERNEL.bind2">bind2</a></span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.Fresh">Fresh</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind2.A1">A1</a></span> * <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind2.A2">A2</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind2.B">B</a></span> -&gt; (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind2.A1">A1</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind2.A2">A2</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.Fresh">Fresh</a></span> <span class="id">A</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind2.B">B</a></span>) -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.Fresh">Fresh</a></span> <span class="id">A</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind2.B">B</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Conjecture</span> <span class="id"><a name="FRESHKERNEL.bind2_spec">bind2_spec</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.Fresh">Fresh</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind2.A1">A1</a></span> * <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind2.A2">A2</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind2.B">B</a></span>) (<span class="id">k</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind2.A1">A1</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind2.A2">A2</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.Fresh">Fresh</a></span> <span class="id">A</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind2.B">B</a></span>) <span class="id">st</span> <span class="id">a</span>' <span class="id">st</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind2">bind2</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#k">k</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id">a</span>', <span class="id">st</span>'') &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">a1</span>, <span class="tactic">exists</span> <span class="id">a2</span>, <span class="tactic">exists</span> <span class="id">st</span>', (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = ((<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1">a1</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a2">a2</a></span>), <span class="id">st</span>') /\ <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#k">k</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1">a1</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a2">a2</a></span> <span class="id">st</span>' = (<span class="id">a</span>', <span class="id">st</span>'')).<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL.bind2">bind2</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL">FRESHKERNEL</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="FreshKernel">FreshKernel</a></span>(<span class="kwd">Import</span> <span class="id">Ids</span> : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>) : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FRESHKERNEL">FRESHKERNEL</a></span>(<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids">Ids</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FreshKernel.st">st</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="FreshKernel.fresh_st">fresh_st</a></span> (<span class="id">B</span> : <span class="kwd">Type</span>) : <span class="kwd">Type</span> := (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#B">B</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="FreshKernel.st_anns">st_anns</a></span> (<span class="id">st</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st.B">B</a></span>) := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="FreshKernel.st_ids">st_ids</a></span> (<span class="id">st</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st.B">B</a></span>) := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_anns">st_anns</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st">st</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="FreshKernel.Fresh">Fresh</a></span> (<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>) : <span class="kwd">Type</span> := <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#B">B</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#A">A</a></span> * <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#B">B</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FreshKernel.ret">ret</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="FreshKernel.ret">ret</a></span> (<span class="id">a</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.ret.A">A</a></span>) : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.Fresh">Fresh</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.ret.A">A</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.ret.B">B</a></span> := <span class="kwd">fun</span> <span class="id">st</span> =&gt; (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.ret_spec">ret_spec</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">st</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.ret">ret</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">a</span> <span class="id">st</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.ret">ret</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FreshKernel.validity">validity</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
<div class="doc">The state is valid if the next ident is greater than all generated idents,
        and if there is no duplicates in generated idents </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="FreshKernel.st_valid_after">st_valid_after</a></span> (<span class="id">st</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.validity.B">B</a></span>) (<span class="id">pref</span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) (<span class="id">aft</span> : <span class="id"><a href="Velus.Common.CommonPS.html#PS.t">PS.t</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">n</span>, <span class="id">l</span>) := <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">l</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">id</span> =&gt; <span class="tactic">exists</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> = <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.gensym">gensym</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt">Pos.lt</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">l</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">prefs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefs">prefs</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefs">prefs</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.AtomOrGensym_gensym_injective">AtomOrGensym_gensym_injective</a></span> : <span class="kwd">forall</span> <span class="id">prefs</span> <span class="id">pref</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefs">prefs</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.gensym">gensym</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#prefs">prefs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * [<span class="id">Hat</span>|(?&amp;?&amp;?&amp;<span class="id">Hgen</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.gensym_not_atom">gensym_not_atom</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.gensym_injective">gensym_injective</a></span> <span class="kwd">in</span> <span class="id">Hgen</span> <span class="kwd">as</span> (?&amp;?); <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.st_valid_NoDup">st_valid_NoDup</a></span> : <span class="kwd">forall</span> <span class="id">st</span> <span class="id">pref</span> <span class="id">aft</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>++<span class="id"><a href="Velus.Common.CommonPS.html#PSP.to_list">PSP.to_list</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">n</span> <span class="id">l</span>] <span class="id">pref</span> <span class="id">aft</span> (<span class="id">Hnd</span>&amp;<span class="id">Hpre</span>&amp;?&amp;<span class="id">Hnpre</span>&amp;<span class="id">Hatg</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">NoDup_app</span>'; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_elements_NoDup">PS_elements_NoDup</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? (?&amp;<span class="id">Hgen</span>&amp;<span class="id">_</span>); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#In_PS_elements">In_PS_elements</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">contra</span>. <span class="tactic">apply</span> <span class="id">Hatg</span> <span class="kwd">in</span> <span class="id">contra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.AtomOrGensym_gensym_injective">AtomOrGensym_gensym_injective</a></span> <span class="kwd">in</span> <span class="id">contra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.st_valid_PSeq">st_valid_PSeq</a></span> : <span class="kwd">forall</span> <span class="id">st</span> <span class="id">pref</span> <span class="id">aft1</span> <span class="id">aft2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.eq">PS.eq</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft1">aft1</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft2">aft2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft1">aft1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft2">aft2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">n</span> <span class="id">l</span>] * <span class="id">Heq</span> (?&amp;?&amp;?&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">constructor</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">x</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.st_valid_prefixed">st_valid_prefixed</a></span> : <span class="kwd">forall</span> <span class="id">st</span> <span class="id">pref</span> <span class="id">aft</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="tactic">exists</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> = <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.gensym">gensym</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#n">n</a></span>) (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (?&amp;?) * (?&amp;?&amp;?); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? (?&amp;<span class="id">Hgen</span>&amp;<span class="id">_</span>); <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.validity">validity</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FreshKernel.validity_reuse">validity_reuse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="FreshKernel.st_valid_reuse">st_valid_reuse</a></span> (<span class="id">st</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.validity_reuse.B">B</a></span>) <span class="id">pref</span> (<span class="id">aft</span> : <span class="id"><a href="Velus.Common.CommonPS.html#PS.t">PS.t</a></span>) <span class="id">reprefs</span> (<span class="id">reusable</span> : <span class="id"><a href="Velus.Common.CommonPS.html#PS.t">PS.t</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">n</span>, <span class="id">l</span>) := <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">l</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.AtomOrGensym">AtomOrGensym</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.add">PS.add</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">l</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">id</span> =&gt; <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> = <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.gensym">gensym</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt">Pos.lt</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">l</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.to_list">PSP.to_list</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>++<span class="id"><a href="Velus.Common.CommonPS.html#PSP.to_list">PSP.to_list</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">id</span> =&gt; ~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">l</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">id</span> =&gt; ~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">l</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.st_valid_reuse_NoDup">st_valid_reuse_NoDup</a></span> : <span class="kwd">forall</span> <span class="id">st</span> <span class="id">pref</span> <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">reusable</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>++<span class="id"><a href="Velus.Common.CommonPS.html#PSP.to_list">PSP.to_list</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>++<span class="id"><a href="Velus.Common.CommonPS.html#PSP.to_list">PSP.to_list</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [? ?] * (?&amp;?&amp;?&amp;?&amp;?&amp;<span class="id">Hn1</span>&amp;?&amp;?&amp;<span class="id">Hn2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">NoDup_app</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hin</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#not_In_app">not_In_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#In_PS_elements">In_PS_elements</a></span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hn1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hn2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.st_valid_reuse_nIn">st_valid_reuse_nIn</a></span> : <span class="kwd">forall</span> <span class="id">st</span> <span class="id">pref</span> <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">reusable</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; ~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>)) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [? ?] * (?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;<span class="id">Hn2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hin1</span> <span class="id">Hin2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hn2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.st_valid_reuse_PSeq">st_valid_reuse_PSeq</a></span> : <span class="kwd">forall</span> <span class="id">st</span> <span class="id">pref</span> <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">re1</span> <span class="id">re2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.eq">PS.eq</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#re1">re1</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#re2">re2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#re1">re1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#re2">re2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">n</span> <span class="id">l</span>] * <span class="id">Heq</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;<span class="id">Hn2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">split</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">rewrite</span> &lt;- <span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="tactic">eapply</span> <span class="id">Hn2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? ?. <span class="tactic">rewrite</span> &lt;- <span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.st_valid_reuse_prefixed">st_valid_reuse_prefixed</a></span> : <span class="kwd">forall</span> <span class="id">st</span> <span class="id">pref</span> <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">reu</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reu">reu</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.AtomOrGensym">AtomOrGensym</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.add">PS.add</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span>)) (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">n</span> <span class="id">l</span>] * (?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.validity_reuse">validity_reuse</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FreshKernel.follows">follows</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="FreshKernel.st_follows">st_follows</a></span> (<span class="id">st</span> <span class="id">st</span>' : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.follows.B">B</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">st</span>').<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.st_follows_refl">st_follows_refl</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Reflexive">Reflexive</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_follows">st_follows</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</div>
<div class="proofscript" id="proof10">
 <span class="tactic">intros</span> <span class="id">st</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_follows">st_follows</a></span>. <span class="tactic">reflexivity</span>. Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.st_follows_trans">st_follows_trans</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Transitive">Transitive</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_follows">st_follows</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Transitive">Transitive</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_follows">st_follows</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.st_follows_incl">st_follows_incl</a></span> : <span class="kwd">forall</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_follows">st_follows</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id">st</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_anns">st_anns</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>) (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_anns">st_anns</a></span> <span class="id">st</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</div>
<div class="proofscript" id="proof12">
 <span class="tactic">intuition</span>. Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.follows">follows</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FreshKernel.init">init</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="FreshKernel.init_st">init_st</a></span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.init.B">B</a></span> := (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span>, []).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.init_st_anns">init_st_anns</a></span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_anns">st_anns</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.init_st">init_st</a></span> = [].<br/>
<div class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</div>
<div class="proofscript" id="proof13">
 <span class="tactic">intros</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.init_st_valid">init_st_valid</a></span> : <span class="kwd">forall</span> <span class="id">pref</span> <span class="id">aft</span> <span class="id">aftprefs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aftprefs">aftprefs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aftprefs">aftprefs</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.init_st">init_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnin</span> <span class="id">Hprefs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.init_st">init_st</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.init_st_valid_reuse">init_st_valid_reuse</a></span> : <span class="kwd">forall</span> <span class="id">pref</span> <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">reusable</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.to_list">PSP.to_list</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>++<span class="id"><a href="Velus.Common.CommonPS.html#PSP.to_list">PSP.to_list</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.init_st">init_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnd</span> <span class="id">Hpre1</span> <span class="id">Hpre2</span> <span class="id">Hpre3</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.init_st">init_st</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.init">init</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FreshKernel.fresh_ident">fresh_ident</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="FreshKernel.fresh_ident">fresh_ident</a></span> <span class="id">pref</span> (<span class="id">b</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_ident.B">B</a></span>) : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.Fresh">Fresh</a></span> <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_ident.B">B</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> '(<span class="id">n</span>, <span class="id">l</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">id</span> := <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.gensym">gensym</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#n">n</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#n">n</a></span>, (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span>)::<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#l">l</a></span>)).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.fresh_ident_anns">fresh_ident_anns</a></span> : <span class="kwd">forall</span> <span class="id">pref</span> <span class="id">b</span> <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_ident">fresh_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_anns">st_anns</a></span> <span class="id">st</span>' = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span>)::(<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_anns">st_anns</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">st</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.fresh_ident_st_valid">fresh_ident_st_valid</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pref</span> (<span class="id">b</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_ident.B">B</a></span>) <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">aft</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_ident">fresh_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_after">st_valid_after</a></span> <span class="id">st</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? ? ? [<span class="id">n</span> <span class="id">l</span>] [<span class="id">n</span>' <span class="id">l</span>'] <span class="id">aft</span> <span class="id">Hfresh</span> (<span class="id">Hv1</span>&amp;<span class="id">Hv2</span>&amp;<span class="id">aftprefs</span>&amp;<span class="id">Hv3</span>&amp;<span class="id">Hv4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfresh</span>; <span class="id">inv</span> <span class="id">Hfresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. 3:<span class="tactic">exists</span> <span class="id">aftprefs</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. 1,2:<span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hin</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hv2</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.gensym_injective">gensym_injective</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">_</span>&amp;?); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_irrefl">Pos.lt_irrefl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">exists</span> <span class="id">n</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_succ_diag_r">Pos.lt_succ_diag_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? (?&amp;?&amp;?); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">x</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_succ_diag_r">Pos.lt_succ_diag_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.fresh_ident_st_valid_reuse">fresh_ident_st_valid_reuse</a></span> : <span class="kwd">forall</span> <span class="id">pref</span> <span class="id">b</span> <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">reusable</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_ident">fresh_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_reuse">st_valid_reuse</a></span> <span class="id">st</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? ? ? [<span class="id">n</span> <span class="id">l</span>] [<span class="id">n</span>' <span class="id">l</span>'] * <span class="id">Hfresh</span> (<span class="id">Hv1</span>&amp;<span class="id">Hv2</span>&amp;<span class="id">Hv3</span>&amp;<span class="id">Hv4</span>&amp;<span class="id">Hv5</span>&amp;<span class="id">Hv6</span>&amp;<span class="id">Hv7</span>&amp;<span class="id">Hv8</span>&amp;<span class="id">Hv9</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfresh</span>; <span class="id">inv</span> <span class="id">Hfresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. 1-5:<span class="tactic">constructor</span>; <span class="tactic">auto</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hin</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hv3</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_irrefl">Pos.lt_irrefl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>. <span class="tactic">exists</span> <span class="id">pref</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSF.add_1">PSF.add_1</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> ? <span class="id">Hgen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.gensym_injective">gensym_injective</a></span> <span class="kwd">in</span> <span class="id">Hgen</span> <span class="kwd">as</span> (<span class="id">_</span>&amp;<span class="id">Heq</span>); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_succ_diag_r">Pos.lt_succ_diag_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="tactic">eapply</span> <span class="id">Hv3</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hgen</span> ? <span class="id">Heq</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hgen</span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_succ_diag_r">Pos.lt_succ_diag_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">contra</span>. <span class="tactic">eapply</span> <span class="id">Hv5</span> <span class="kwd">in</span> <span class="id">contra</span> <span class="kwd">as</span> [?|(?&amp;?&amp;?&amp;<span class="id">Heq</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.gensym_not_atom">gensym_not_atom</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.gensym_injective">gensym_injective</a></span> <span class="kwd">in</span> <span class="id">Heq</span> <span class="kwd">as</span> (?&amp;?); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">contra</span>. <span class="tactic">apply</span> <span class="id">Hv8</span> <span class="kwd">in</span> <span class="id">contra</span> <span class="kwd">as</span> [?|(?&amp;?&amp;?&amp;<span class="id">Heq</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.gensym_not_atom">gensym_not_atom</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.gensym_injective">gensym_injective</a></span> <span class="kwd">in</span> <span class="id">Heq</span> <span class="kwd">as</span> (?&amp;?); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.fresh_ident_st_follows">fresh_ident_st_follows</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pref</span> (<span class="id">b</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_ident.B">B</a></span>) <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_ident">fresh_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_follows">st_follows</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id">st</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ??? [<span class="id">n</span> <span class="id">l</span>] [<span class="id">n</span>' <span class="id">l</span>'] <span class="id">Hfresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">Hfresh</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_follows">st_follows</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl_tl">incl_tl</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.fresh_ident">fresh_ident</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FreshKernel.reuse_ident">reuse_ident</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="FreshKernel.reuse_ident">reuse_ident</a></span> (<span class="id">id</span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) (<span class="id">b</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.reuse_ident.B">B</a></span>) : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.Fresh">Fresh</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.reuse_ident.B">B</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> '(<span class="id">n</span>, <span class="id">l</span>) =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>, (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#n">n</a></span>, (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span>)::<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#l">l</a></span>)).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.reuse_ident_anns">reuse_ident_anns</a></span> : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.reuse_ident">reuse_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_anns">st_anns</a></span> <span class="id">st</span>' = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span>)::(<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_anns">st_anns</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">b</span> <span class="id">id</span> [<span class="id">n</span> <span class="id">l</span>] [<span class="id">n</span>' <span class="id">l</span>'] <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.reuse_ident">reuse_ident</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.reuse_ident_st_valid_reuse">reuse_ident_st_valid_reuse</a></span> : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">pref</span> <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">reusable</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.reuse_ident">reuse_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.add">PS.add</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_valid_reuse">st_valid_reuse</a></span> <span class="id">st</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof21')">Proof with</div>
<div class="proofscript" id="proof21">
 <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?? [<span class="id">n</span> <span class="id">l</span>] [<span class="id">n</span>' <span class="id">l</span>'] ???? <span class="id">Hnin</span> <span class="id">Hreuse</span> (<span class="id">Hv1</span>&amp;<span class="id">Hv2</span>&amp;<span class="id">Hv3</span>&amp;<span class="id">Hv4</span>&amp;<span class="id">Hv5</span>&amp;<span class="id">Hv6</span>&amp;<span class="id">Hv7</span>&amp;<span class="id">Hv8</span>&amp;<span class="id">Hv9</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.reuse_ident">reuse_ident</a></span> <span class="kwd">in</span> <span class="id">Hreuse</span>. <span class="id">inv</span> <span class="id">Hreuse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>... 1,2,3,5,7:<span class="tactic">constructor</span>; <span class="tactic">auto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">contra</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hv9</span>; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hv9</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSF.add_1">PSF.add_1</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_add">PS_For_all_add</a></span> <span class="kwd">in</span> <span class="id">Hv8</span> <span class="kwd">as</span> ([?|(?&amp;?&amp;?)]&amp;<span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">left</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">auto</span>. <span class="tactic">eexists</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSF.add_2">PSF.add_2</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> ? ?; <span class="tactic">subst</span>. <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_add">PS_For_all_add</a></span> <span class="kwd">in</span> <span class="id">Hv8</span> <span class="kwd">as</span> ([?|(?&amp;?&amp;?&amp;?)]&amp;<span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.gensym_not_atom">gensym_not_atom</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids.gensym_injective">gensym_injective</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (?&amp;?); <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_In">NoDup_app_In</a></span> <span class="kwd">in</span> <span class="id">Hv4</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#In_PS_elements">In_PS_elements</a></span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hv4</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PSF.add_1">PSF.add_1</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="tactic">eapply</span> <span class="id">Hv9</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hnin</span>' <span class="id">contra</span>. <span class="tactic">apply</span> <span class="id">Hnin</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSF.add_2">PSF.add_2</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">NoDup_app</span>'<span class="id">_iff</span> <span class="kwd">in</span> *. <span class="tactic">destruct</span> <span class="id">Hv4</span> <span class="kwd">as</span> (?&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_elements_NoDup">PS_elements_NoDup</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hnin</span>' <span class="id">Hin</span>. <span class="tactic">apply</span> <span class="id">Hnin</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#In_PS_elements">In_PS_elements</a></span> <span class="kwd">in</span> *. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSF.add_2">PSF.add_2</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> ? <span class="id">Hin</span>. <span class="tactic">apply</span> <span class="id">Hv8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSF.add_2">PSF.add_2</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="FreshKernel.reuse_ident_st_follows">reuse_ident_st_follows</a></span> : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.reuse_ident">reuse_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_follows">st_follows</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id">st</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">b</span> <span class="id">id</span> [<span class="id">n</span> <span class="id">l</span>] [<span class="id">n</span>' <span class="id">l</span>'] <span class="id">Hreuse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.reuse_ident">reuse_ident</a></span> <span class="kwd">in</span> <span class="id">Hreuse</span>. <span class="id">inv</span> <span class="id">Hreuse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.st_follows">st_follows</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl_tl">incl_tl</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.reuse_ident">reuse_ident</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FreshKernel.bind">bind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">A</span>' <span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="FreshKernel.bind">bind</a></span> (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.Fresh">Fresh</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind.A">A</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind.B">B</a></span>) (<span class="id">k</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.Fresh">Fresh</a></span> <span class="id">A</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind.B">B</a></span>) : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.Fresh">Fresh</a></span> <span class="id">A</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind.B">B</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">st</span> =&gt; <span class="kwd">let</span> '(<span class="id">a</span>, <span class="id">st</span>') := <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="kwd">in</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#k">k</a></span> <span class="id">a</span> <span class="id">st</span>'.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="FreshKernel.bind_spec">bind_spec</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.Fresh">Fresh</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind.A">A</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind.B">B</a></span>) (<span class="id">k</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.Fresh">Fresh</a></span> <span class="id">A</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind.B">B</a></span>) <span class="id">st</span> <span class="id">a</span>' <span class="id">st</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind">bind</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#k">k</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id">a</span>', <span class="id">st</span>'') &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">a</span>, <span class="tactic">exists</span> <span class="id">st</span>', (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span>, <span class="id">st</span>') /\ <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#k">k</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id">st</span>' = (<span class="id">a</span>', <span class="id">st</span>'')).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">k</span> <span class="id">st</span> <span class="id">a</span>' <span class="id">st</span>''. <span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind">bind</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">x</span> <span class="id">st</span>) <span class="kwd">as</span> [<span class="id">a</span> <span class="id">st</span>']. <span class="tactic">exists</span> <span class="id">a</span>. <span class="tactic">exists</span> <span class="id">st</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">a</span> [<span class="id">st</span>' [<span class="id">H1</span> <span class="id">H2</span>]]]. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind">bind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind">bind</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="FreshKernel.bind2">bind2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A1</span> <span class="id">A2</span> <span class="id">A</span>' <span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="FreshKernel.bind2">bind2</a></span> (<span class="id">x</span>: <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.Fresh">Fresh</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2.A1">A1</a></span> * <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2.A2">A2</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2.B">B</a></span>) (<span class="id">k</span>: <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2.A1">A1</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2.A2">A2</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.Fresh">Fresh</a></span> <span class="id">A</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2.B">B</a></span>) : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.Fresh">Fresh</a></span> <span class="id">A</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2.B">B</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="kwd">let</span> '((<span class="id">a1</span>, <span class="id">a2</span>), <span class="id">n</span>') := <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#n">n</a></span> <span class="kwd">in</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#k">k</a></span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">n</span>'.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="FreshKernel.bind2_spec">bind2_spec</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.Fresh">Fresh</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2.A1">A1</a></span> * <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2.A2">A2</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2.B">B</a></span>) (<span class="id">k</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2.A1">A1</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2.A2">A2</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.Fresh">Fresh</a></span> <span class="id">A</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2.B">B</a></span>) <span class="id">st</span> <span class="id">a</span>' <span class="id">st</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2">bind2</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#k">k</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id">a</span>', <span class="id">st</span>'') &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">a1</span>, <span class="tactic">exists</span> <span class="id">a2</span>, <span class="tactic">exists</span> <span class="id">st</span>', (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = ((<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1">a1</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a2">a2</a></span>), <span class="id">st</span>') /\ <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#k">k</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1">a1</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a2">a2</a></span> <span class="id">st</span>' = (<span class="id">a</span>', <span class="id">st</span>'')).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">k</span> <span class="id">st</span> <span class="id">a</span>' <span class="id">st</span>''. <span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2">bind2</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">x</span> <span class="id">st</span>) <span class="kwd">as</span> [[<span class="id">a1</span> <span class="id">a2</span>] <span class="id">st</span>']. <span class="tactic">exists</span> <span class="id">a1</span>. <span class="tactic">exists</span> <span class="id">a2</span>. <span class="tactic">exists</span> <span class="id">st</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">a1</span> [<span class="id">a2</span> [<span class="id">st</span>' [<span class="id">H1</span> <span class="id">H2</span>]]]]. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2">bind2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel.bind2">bind2</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel">FreshKernel</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="Fresh">Fresh</a></span>(<span class="id">Ids</span> : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="id"><a name="Fresh.Ker">Ker</a></span> := <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#FreshKernel">FreshKernel</a></span>(<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Ids">Ids</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Include</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Ker">Ker</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="Fresh.Instances">Instances</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="Fresh.st_follows_Reflexive">st_follows_Reflexive</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Reflexive">Reflexive</a></span> (@<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_follows">st_follows</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Instances.B">B</a></span>) := <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_follows_refl">st_follows_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="Fresh.st_follows_Transitive">st_follows_Transitive</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Transitive">Transitive</a></span> (@<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_follows">st_follows</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Instances.B">B</a></span>) := <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_follows_trans">st_follows_trans</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">st</span> <span class="id">pref</span> <span class="id">aft</span> <span class="id">reprefs</span> : (@<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Instances.B">B</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.Common.CommonPS.html#PS.eq">PS.eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">st_valid_reuse_PSeq_Proper</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_reuse_PSeq">st_valid_reuse_PSeq</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="Fresh.st_valid_after_Proper">st_valid_after_Proper</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (@<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Instances.B">B</a></span>) ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> ==&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.Equal">PS.Equal</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_after">st_valid_after</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? ? ? ? ? ? ? ? <span class="id">Heq</span> <span class="id">Hfresh</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_PSeq">st_valid_PSeq</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Instances">Instances</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="id"><a name="Fresh.Facts">Facts</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="Fresh.Facts.st">st</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.Facts.st_anns_ids_In">st_anns_ids_In</a></span> : <span class="kwd">forall</span> (<span class="id">st</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.st.B">B</a></span>) <span class="id">id</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">b</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span>) (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_anns">st_anns</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>)) &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</div>
<div class="proofscript" id="proof27">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">b</span> <span class="id">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id">id</span>, <span class="id">b</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [[? <span class="id">b</span>] [? <span class="id">H</span>]]; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">b</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.st">st</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="Fresh.Facts.st_valid_after">st_valid_after</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.Facts.st_valid_after_NoDupMembers">st_valid_after_NoDupMembers</a></span> {<span class="id">C</span>} : <span class="kwd">forall</span> (<span class="id">st</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.st_valid_after.B">B</a></span>) <span class="id">pref</span> (<span class="id">vars</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#C">C</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#vars">vars</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.of_list">PSP.of_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#vars">vars</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#vars">vars</a></span> ++ <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hndup</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_NoDup">st_valid_NoDup</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_of_list_ps_to_list_Perm">ps_of_list_ps_to_list_Perm</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>. 2:<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation_app_comm</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.st_valid_after">st_valid_after</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="Fresh.Facts.st_valid_reuse">st_valid_reuse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.Facts.st_valid_reuse_nIn">st_valid_reuse_nIn</a></span> : <span class="kwd">forall</span> (<span class="id">st</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.st_valid_reuse.B">B</a></span>) <span class="id">pref</span> <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">reusable</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; ~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#x">x</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>)) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</div>
<div class="proofscript" id="proof29">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_reuse_NoDup">st_valid_reuse_NoDup</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation_app_comm</a></span>, &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Permutation_swap">Permutation_swap</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_Forall">PS_For_all_Forall</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>. <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_In">NoDup_app_In</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">contra</span>. <span class="tactic">apply</span> <span class="id">Hvalid</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.Facts.st_valid_reuse_NoDupMembers">st_valid_reuse_NoDupMembers</a></span> {<span class="id">C</span>} : <span class="kwd">forall</span> (<span class="id">st</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.st_valid_reuse.B">B</a></span>) <span class="id">pref</span> (<span class="id">vars</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#C">C</a></span>)) <span class="id">reprefs</span> <span class="id">reusable</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#vars">vars</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.of_list">PSP.of_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#vars">vars</a></span>)) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#vars">vars</a></span> ++ <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hndup</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_reuse_NoDup">st_valid_reuse_NoDup</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation_app_comm</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">NoDup_app</span>'<span class="id">_iff</span> <span class="kwd">in</span> *. <span class="tactic">destruct</span> <span class="id">Hvalid</span> <span class="kwd">as</span> (?&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>. <span class="tactic">intros</span> ? ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_of_list_ps_to_list">ps_of_list_ps_to_list</a></span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.st_valid_reuse">st_valid_reuse</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="Fresh.Facts.fresh_ident">fresh_ident</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.Facts.fresh_ident_In">fresh_ident_In</a></span> : <span class="kwd">forall</span> <span class="id">pref</span> (<span class="id">b</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.fresh_ident.B">B</a></span>) <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_ident">fresh_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span>) (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_anns">st_anns</a></span> <span class="id">st</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_ident_anns">fresh_ident_anns</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">constructor</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="Fresh.Facts.fresh_ident_Inids">fresh_ident_Inids</a></span> : <span class="kwd">forall</span> <span class="id">pref</span> (<span class="id">b</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.fresh_ident.B">B</a></span>) <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_ident">fresh_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="id">st</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</div>
<div class="proofscript" id="proof32">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hfresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.fresh_ident_In">fresh_ident_In</a></span> <span class="kwd">in</span> <span class="id">Hfresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id">id</span>, <span class="id">b</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.Facts.fresh_ident_vars_perm">fresh_ident_vars_perm</a></span> : <span class="kwd">forall</span> <span class="id">pref</span> (<span class="id">b</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.fresh_ident.B">B</a></span>) <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_ident">fresh_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>::(<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>)) (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="id">st</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</div>
<div class="proofscript" id="proof33">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_ident_anns">fresh_ident_anns</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.Facts.fresh_ident_nIn">fresh_ident_nIn</a></span> : <span class="kwd">forall</span> <span class="id">pref</span> (<span class="id">b</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.fresh_ident.B">B</a></span>) <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">aft</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_ident">fresh_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">List.In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</div>
<div class="proofscript" id="proof34">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvalid</span> <span class="id">Hfresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_ident_st_valid">fresh_ident_st_valid</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_NoDup">st_valid_NoDup</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_weaken">NoDup_app_weaken</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.fresh_ident_vars_perm">fresh_ident_vars_perm</a></span> <span class="kwd">in</span> <span class="id">Hfresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hfresh</span> <span class="kwd">in</span> <span class="id">Hvalid</span>. <span class="id">inv</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.Facts.fresh_ident_reuse_nIn">fresh_ident_reuse_nIn</a></span> : <span class="kwd">forall</span> <span class="id">pref</span> (<span class="id">b</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.fresh_ident.B">B</a></span>) <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">reusable</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reusable">reusable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_ident">fresh_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">List.In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</div>
<div class="proofscript" id="proof35">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvalid</span> <span class="id">Hfresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_ident_st_valid_reuse">fresh_ident_st_valid_reuse</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_reuse_NoDup">st_valid_reuse_NoDup</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_weaken">NoDup_app_weaken</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.fresh_ident_vars_perm">fresh_ident_vars_perm</a></span> <span class="kwd">in</span> <span class="id">Hfresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hfresh</span> <span class="kwd">in</span> <span class="id">Hvalid</span>. <span class="id">inv</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id">fresh_ident_nIn</span>' : <span class="kwd">forall</span> <span class="id">pref</span> (<span class="id">b</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.fresh_ident.B">B</a></span>) <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">aft</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_ident">fresh_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</div>
<div class="proofscript" id="proof36">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvalid</span> <span class="id">Hfresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_ident_st_valid">fresh_ident_st_valid</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_NoDup">st_valid_NoDup</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.fresh_ident_vars_perm">fresh_ident_vars_perm</a></span> <span class="kwd">in</span> <span class="id">Hfresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hfresh</span> <span class="kwd">in</span> <span class="id">Hvalid</span>. <span class="id">inv</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">contra</span>. <span class="tactic">apply</span> <span class="id">H1</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#or_intror">or_intror</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#In_PS_elements">In_PS_elements</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id">fresh_ident_nIn</span>'' : <span class="kwd">forall</span> <span class="id">pref</span> (<span class="id">b</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.fresh_ident.B">B</a></span>) <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">aft</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.of_list">PSP.of_list</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.fresh_ident">fresh_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> ++ <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</div>
<div class="proofscript" id="proof37">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvalid</span> <span class="id">Hfresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">contra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#in_app">in_app</a></span> <span class="kwd">in</span> <span class="id">contra</span> <span class="kwd">as</span> [<span class="id">contra</span>|<span class="id">contra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">fresh_ident_nIn</span>' <span class="kwd">in</span> <span class="id">Hfresh</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Velus.Common.CommonPS.html#ps_from_list_ps_of_list">ps_from_list_ps_of_list</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#ps_from_list_In">ps_from_list_In</a></span> <span class="kwd">in</span> <span class="id">Hfresh</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.fresh_ident_nIn">fresh_ident_nIn</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.fresh_ident">fresh_ident</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="Fresh.Facts.reuse_ident">reuse_ident</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.Facts.reuse_ident_In">reuse_ident_In</a></span> : <span class="kwd">forall</span> (<span class="id">b</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.reuse_ident.B">B</a></span>) <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.reuse_ident">reuse_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span>) (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_anns">st_anns</a></span> <span class="id">st</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</div>
<div class="proofscript" id="proof38">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.reuse_ident_anns">reuse_ident_anns</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">constructor</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.Facts.reuse_ident_vars_perm">reuse_ident_vars_perm</a></span> : <span class="kwd">forall</span> (<span class="id">b</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.reuse_ident.B">B</a></span>) <span class="id">id</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.reuse_ident">reuse_ident</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#b">b</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#id">id</a></span>::(<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span>)) (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="id">st</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</div>
<div class="proofscript" id="proof39">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.reuse_ident_anns">reuse_ident_anns</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_ids">st_ids</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts.reuse_ident">reuse_ident</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Facts">Facts</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="id"><a name="Fresh.Tactics">Tactics</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">inv_bind</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id">context</span> <span class="id">c</span> [<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.ret">ret</a></span> <span class="id">_</span> <span class="id">_</span>] |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.ret_spec">ret_spec</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) = (<span class="id">_</span>, <span class="id">_</span>) |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.bind">bind</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = (<span class="id">_</span>, <span class="id">_</span>) |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.bind_spec">bind_spec</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [? [? [? ?]]]; <span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.bind2">bind2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = (<span class="id">_</span>, <span class="id">_</span>) |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.bind2_spec">bind2_spec</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [? [? [? [? ?]]]]; <span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span> <span class="id">c</span> [<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.ret">ret</a></span> <span class="id">_</span> <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.ret_spec">ret_spec</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.bind">bind</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = (<span class="id">_</span>, <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.bind_spec">bind_spec</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.bind2">bind2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = (<span class="id">_</span>, <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.bind2_spec">bind2_spec</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Tactics">Tactics</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="id"><a name="Fresh.Notations">Notations</a></span>.<br/>
<div class="doc"><span class="bracket"><span class="tactic">do</span></span> notation, inspired by CompCert's error monad </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Notation</span> "'<span class="tactic">do</span>' <span class="id">X</span> &lt;- <span class="id">A</span> ; <span class="id">B</span>" :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.bind">bind</a></span> <span class="id">A</span> (<span class="kwd">fun</span> <span class="id">X</span> =&gt; <span class="id">B</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">X</span> <span class="id">ident</span>, <span class="id">A</span> <span class="tactic">at</span> <span class="id">level</span> 100, <span class="id">B</span> <span class="tactic">at</span> <span class="id">level</span> 200): <span class="id">fresh_monad_scope</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Notation</span> "'<span class="tactic">do</span>' ( <span class="id">X</span> , <span class="id">Y</span> ) &lt;- <span class="id">A</span> ; <span class="id">B</span>" :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.bind2">bind2</a></span> <span class="id">A</span> (<span class="kwd">fun</span> <span class="id">X</span> <span class="id">Y</span> =&gt; <span class="id">B</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">X</span> <span class="id">ident</span>, <span class="id">Y</span> <span class="id">ident</span>, <span class="id">A</span> <span class="tactic">at</span> <span class="id">level</span> 100, <span class="id">B</span> <span class="tactic">at</span> <span class="id">level</span> 200): <span class="id">fresh_monad_scope</span>.<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Notations">Notations</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="Fresh.map_bind">map_bind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Import</span> <span class="id">Tactics</span> <span class="id">Notations</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">fresh_monad_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">A1</span> <span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="Fresh.map_bind.k">k</a></span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Fresh">Fresh</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind.A1">A1</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind.B">B</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="Fresh.map_bind">map_bind</a></span> <span class="id">a</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">hd</span>::<span class="id">tl</span> =&gt; <span class="tactic">do</span> <span class="id">a1</span> &lt;- <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind.k">k</a></span> <span class="id">hd</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">a1s</span> &lt;- <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#map_bind">map_bind</a></span> <span class="id">tl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1">a1</a></span>::<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1s">a1s</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.map_bind_values">map_bind_values</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">st</span> <span class="id">a1s</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind">map_bind</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1s">a1s</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">a1</span> =&gt; <span class="tactic">exists</span> <span class="id">st</span>'', <span class="tactic">exists</span> <span class="id">st</span>''', <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind.k">k</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id">st</span>'' = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1">a1</a></span>, <span class="id">st</span>''')) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1s">a1s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</div>
<div class="proofscript" id="proof40">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span>; <span class="tactic">intros</span> <span class="id">st</span> <span class="id">a1s</span> <span class="id">st</span>' <span class="id">Hfold</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">repeat</span> <span class="id">inv_bind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">specialize</span> (<span class="id">IHa</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.map_bind_st_valid">map_bind_st_valid</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">a1s</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">pref</span> <span class="id">aft</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind">map_bind</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1s">a1s</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="kwd">forall</span> <span class="id">a1</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind.k">k</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1">a1</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_after">st_valid_after</a></span> <span class="id">st</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_after">st_valid_after</a></span> <span class="id">st</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</div>
<div class="proofscript" id="proof41">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span>; <span class="tactic">intros</span> * <span class="id">Hmap</span> <span class="id">Hforall</span> <span class="id">Hvalid</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">repeat</span> <span class="id">inv_bind</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hforall</span>. <span class="tactic">eapply</span> <span class="id">IHa</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.map_bind_st_follows">map_bind_st_follows</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">a1s</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind">map_bind</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1s">a1s</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="kwd">forall</span> <span class="id">a1</span> <span class="id">st</span> <span class="id">st</span>', <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind.k">k</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1">a1</a></span>, <span class="id">st</span>') -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_follows">st_follows</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id">st</span>') <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_follows">st_follows</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id">st</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</div>
<div class="proofscript" id="proof42">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span>; <span class="tactic">intros</span> * <span class="id">Hmap</span> <span class="id">Hforall</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">repeat</span> <span class="id">inv_bind</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hforall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind">map_bind</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="Fresh.map_bind2">map_bind2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Import</span> <span class="id">Tactics</span> <span class="id">Notations</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">fresh_monad_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="Fresh.map_bind2.k">k</a></span> : <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind2.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.Fresh">Fresh</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind2.A1">A1</a></span> * <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind2.A2">A2</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind2.B">B</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="Fresh.map_bind2">map_bind2</a></span> <span class="id">a</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.ret">ret</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">hd</span>::<span class="id">tl</span> =&gt; <span class="tactic">do</span> (<span class="id">a1</span>, <span class="id">a2</span>) &lt;- <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind2.k">k</a></span> <span class="id">hd</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">a1s</span>, <span class="id">a2s</span>) &lt;- <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#map_bind2">map_bind2</a></span> <span class="id">tl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1">a1</a></span>::<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1s">a1s</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a2">a2</a></span>::<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a2s">a2s</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.map_bind2_values">map_bind2_values</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">st</span> <span class="id">a1s</span> <span class="id">a2s</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind2">map_bind2</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1s">a1s</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a2s">a2s</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#Forall3">Forall3</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">a1</span> <span class="id">a2</span> =&gt; <span class="tactic">exists</span> <span class="id">st</span>'', <span class="tactic">exists</span> <span class="id">st</span>''', <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind2.k">k</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id">st</span>'' = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1">a1</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a2">a2</a></span>, <span class="id">st</span>''')) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1s">a1s</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a2s">a2s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</div>
<div class="proofscript" id="proof43">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span>; <span class="tactic">intros</span> <span class="id">st</span> <span class="id">a1s</span> <span class="id">a2s</span> <span class="id">st</span>' <span class="id">Hfold</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">repeat</span> <span class="id">inv_bind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">specialize</span> (<span class="id">IHa</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.map_bind2_st_valid">map_bind2_st_valid</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">a1s</span> <span class="id">a2s</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">pref</span> <span class="id">aft</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind2">map_bind2</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1s">a1s</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a2s">a2s</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="kwd">forall</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind2.k">k</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1">a1</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a2">a2</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_after">st_valid_after</a></span> <span class="id">st</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_after">st_valid_after</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_after">st_valid_after</a></span> <span class="id">st</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</div>
<div class="proofscript" id="proof44">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span>; <span class="tactic">intros</span> * <span class="id">Hmap</span> <span class="id">Hforall</span> <span class="id">Hvalid</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">repeat</span> <span class="id">inv_bind</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hforall</span>. <span class="tactic">eapply</span> <span class="id">IHa</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.map_bind2_st_valid_reuse">map_bind2_st_valid_reuse</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">a1s</span> <span class="id">a2s</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">pref</span> <span class="id">aft</span> <span class="id">reprefs</span> <span class="id">reu</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind2">map_bind2</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1s">a1s</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a2s">a2s</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="kwd">forall</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind2.k">k</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1">a1</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a2">a2</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reu">reu</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_reuse">st_valid_reuse</a></span> <span class="id">st</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reu">reu</a></span>) <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_reuse">st_valid_reuse</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reu">reu</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_valid_reuse">st_valid_reuse</a></span> <span class="id">st</span>' <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#pref">pref</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#aft">aft</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reprefs">reprefs</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#reu">reu</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</div>
<div class="proofscript" id="proof45">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span>; <span class="tactic">intros</span> * <span class="id">Hmap</span> <span class="id">Hforall</span> <span class="id">Hvalid</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">repeat</span> <span class="id">inv_bind</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hforall</span>. <span class="tactic">eapply</span> <span class="id">IHa</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="Fresh.map_bind2_st_follows">map_bind2_st_follows</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">a1s</span> <span class="id">a2s</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind2">map_bind2</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1s">a1s</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a2s">a2s</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="kwd">forall</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">st</span> <span class="id">st</span>', <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind2.k">k</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> = (<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a1">a1</a></span>, <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a2">a2</a></span>, <span class="id">st</span>') -&gt; <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_follows">st_follows</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id">st</span>') <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#a">a</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.st_follows">st_follows</a></span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#st">st</a></span> <span class="id">st</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</div>
<div class="proofscript" id="proof46">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span>; <span class="tactic">intros</span> <span class="id">a1s</span> <span class="id">a2s</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">Hmap</span> <span class="id">Hforall</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">repeat</span> <span class="id">inv_bind</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hforall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh.map_bind2">map_bind2</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">fresh_ident_st_valid</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">fresh_ident_st_valid_reuse</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">fresh_ident_st_follows</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">reuse_ident_st_valid_reuse</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">reuse_ident_st_follows</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">st_follows_incl</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">map_bind2_st_valid</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">map_bind2_st_follows</span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Normalization.Fresh.html#Fresh">Fresh</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
