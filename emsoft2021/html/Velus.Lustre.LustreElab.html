
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module LustreElab</title>
<meta name="description" content="Documentation of Coq module LustreElab" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module LustreElab</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.omega.Omega.html">Omega</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.CompCertLib.html">Common.CompCertLib</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="id"><a href="Velus.Instantiator.html">Instantiator</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html">Lustre.Parser.LustreAst</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Ident.html">Ident</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Environment.html">Environment</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Operators.html">Operators</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Clocks.html">Clocks</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="kwd">Import</span> <span class="id"><a name="Syn">Syn</a></span> := <span class="id"><a href="Velus.Instantiator.html#L.Syn">Instantiator.L.Syn</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Import</span> <span class="id">Interface.Op</span>.<br/>
<span class="kwd">Import</span> <span class="id">Interface.OpAux</span>.<br/>
<span class="kwd">Import</span> <span class="id">Instantiator.L.Typ</span>.<br/>
<span class="kwd">Import</span> <span class="id">Instantiator.L.Clo</span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Import</span> <span class="id">List.ListNotations</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html">cfrontend.Cop</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cparser.Cabs.html">cparser.Cabs</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html">Permutation</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html">common.Errors</a></span>.<br/>
<br/>
<br/>
<br/>
<h1>)
(*   Lexing and parsing gives a list of LustreAst declarations. Elaboration </h1>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Parameter</span> <span class="id"><a name="elab_const_int">elab_const_int</a></span> : <span class="id"><a href="../../CompCert/doc/html/compcert.cparser.Cabs.html#loc">Cabs.loc</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#string">string</a></span> -&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.constant">constant</a></span>.<br/>
<span class="kwd">Parameter</span> <span class="id"><a name="elab_const_float">elab_const_float</a></span> : <span class="id"><a href="../../CompCert/doc/html/compcert.cparser.Cabs.html#floatInfo">Cabs.floatInfo</a></span> -&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.constant">constant</a></span>.<br/>
<span class="kwd">Parameter</span> <span class="id"><a name="elab_const_char">elab_const_char</a></span> : <span class="id"><a href="../../CompCert/doc/html/compcert.cparser.Cabs.html#loc">Cabs.loc</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#char_code">char_code</a></span> -&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.constant">constant</a></span>.<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Parameter</span> <span class="id"><a name="string_of_astloc">string_of_astloc</a></span> : <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">String.string</a></span>.<br/>
<span class="kwd">Parameter</span> <span class="id"><a name="cabsloc_of_astloc">cabsloc_of_astloc</a></span> : <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span> -&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cparser.Cabs.html#loc">Cabs.loc</a></span>.<br/>
<span class="kwd">Parameter</span> <span class="id"><a name="cabs_floatinfo">cabs_floatinfo</a></span> : <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#floatInfo">floatInfo</a></span> -&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cparser.Cabs.html#floatInfo">Cabs.floatInfo</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Ltac</span> <span class="id">NamedDestructCases</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">progress</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="kwd">match</span> ?<span class="id">e</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Heq</span> := <span class="tactic">fresh</span> "<span class="id">Heq</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span> <span class="id">eqn</span>:<span class="id">Heq</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">_</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">injection</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intro</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="elab_constant">elab_constant</a></span> (<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">c</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#constant">LustreAst.constant</a></span>) : <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.constant">constant</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#c">c</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#CONST_BOOL">CONST_BOOL</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>  =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.Cint">Cint</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Int.zero">Integers.Int.zero</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#IBool">Ctypes.IBool</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Signed">Ctypes.Signed</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#CONST_BOOL">CONST_BOOL</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>   =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.Cint">Cint</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Int.one">Integers.Int.one</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#IBool">Ctypes.IBool</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Signed">Ctypes.Signed</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#CONST_INT">CONST_INT</a></span> <span class="id">s</span>       =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_const_int">elab_const_int</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#cabsloc_of_astloc">cabsloc_of_astloc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span>) <span class="id">s</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#CONST_FLOAT">CONST_FLOAT</a></span> <span class="id">fi</span>    =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_const_float">elab_const_float</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#cabs_floatinfo">cabs_floatinfo</a></span> <span class="id">fi</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#CONST_CHAR">CONST_CHAR</a></span> <span class="id">wide</span> <span class="id">l</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_const_char">elab_const_char</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#cabsloc_of_astloc">cabsloc_of_astloc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span>) <span class="id">wide</span> <span class="id">l</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Is_interface_map">Is_interface_map</a></span> (<span class="id">G</span>: <span class="id"><a href="Velus.Lustre.LustreElab.html#global">global</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">nenv</span>: <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>)))) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">f</span> <span class="id">tcin</span> <span class="id">tcout</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#f">f</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#nenv">nenv</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#tcin">tcin</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#tcout">tcout</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#find_node">find_node</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#f">f</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#n">n</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#n">n</a></span>.(<span class="id"><a href="Velus.Lustre.LustreElab.html#n_in">n_in</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#tcin">tcin</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#n">n</a></span>.(<span class="id"><a href="Velus.Lustre.LustreElab.html#n_out">n_out</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#tcout">tcout</a></span>))<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">f</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#f">f</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#nenv">nenv</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">n</span>=&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#f">f</a></span> &lt;&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#n">n</a></span>.(<span class="id"><a href="Velus.Lustre.LustreElab.html#n_name">n_name</a></span>)) <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Is_interface_map_empty">Is_interface_map_empty</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#Is_interface_map">Is_interface_map</a></span> [] (<span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id">_</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</div>
<div class="proofscript" id="proof1">
<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gempty">Env.gempty</a></span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="msg_of_types">msg_of_types</a></span> (<span class="id">ty</span> <span class="id">ty</span>': <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#errmsg">errmsg</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">expected</span> '" :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.string_of_type">string_of_type</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ty">ty</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "' <span class="id">but</span> <span class="id">got</span> '" :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.string_of_type">string_of_type</a></span> <span class="id">ty</span>') :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "'".<br/>
<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="sident">sident</a></span> :=<br/>
| <span class="id"><a name="Vnm">Vnm</a></span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span><br/>
| <span class="id"><a name="Vidx">Vidx</a></span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="sclock">sclock</a></span> :=<br/>
| <span class="id"><a name="Sbase">Sbase</a></span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span><br/>
| <span class="id"><a name="Svar">Svar</a></span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span><br/>
| <span class="id"><a name="Son">Son</a></span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="sident_eq">sident_eq</a></span> (<span class="id">id1</span> <span class="id">id2</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id1">id1</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#id2">id2</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span> <span class="id">id1</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span> <span class="id">id2</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Vidx">Vidx</a></span> <span class="id">id1</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#Vidx">Vidx</a></span> <span class="id">id2</span> =&gt; <span class="id"><a href="Velus.Common.CommonPS.html#ident_eqb">ident_eqb</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id1">id1</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id2">id2</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sident_eq_spec">sident_eq_spec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id1</span> <span class="id">id2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#sident_eq">sident_eq</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id1">id1</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id2">id2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#id1">id1</a></span> = <span class="id"><a href="Velus.Lustre.LustreElab.html#id2">id2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</div>
<div class="proofscript" id="proof2">
<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> *; <span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">HH</span>; <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">id1</span>, <span class="id">id2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">now</span> <span class="tactic">inversion</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;1,2,3,4:<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#ident_eqb_eq">ident_eqb_eq</a></span> <span class="kwd">in</span> *; <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Instance</span> <span class="id"><a name="sident_EqDec">sident_EqDec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</div>
<div class="proofscript" id="proof3">
<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">id1</span> <span class="id">id2</span>. <span class="tactic">compute</span>.<br/>
&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#sident_eq_spec">sident_eq_spec</a></span> <span class="id">id1</span> <span class="id">id2</span>) <span class="kwd">as</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#sident_eq">sident_eq</a></span> <span class="id">id1</span> <span class="id">id2</span>); [<span class="tactic">left</span>|<span class="tactic">right</span>].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">HH</span>. <span class="tactic">apply</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sident_eqb_eq">sident_eqb_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>: <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span>), <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> ==<span class="id">b</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#y">y</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> = <span class="id"><a href="Velus.Lustre.LustreElab.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</div>
<div class="proofscript" id="proof4">
<br/>
&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="sclock_eq">sclock_eq</a></span> (<span class="id">ck1</span> <span class="id">ck2</span>: <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck1">ck1</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#ck2">ck2</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Sbase">Sbase</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#Sbase">Sbase</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id">id1</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id">id2</span> =&gt; <span class="id"><a href="Velus.Common.CommonPS.html#ident_eqb">ident_eqb</a></span> <span class="id">id1</span> <span class="id">id2</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id">ck1</span>' <span class="id">x1</span> <span class="id">b1</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id">ck2</span>' <span class="id">x2</span> <span class="id">b2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">x1</span> ==<span class="id">b</span> <span class="id">x2</span>) &amp;&amp; (<span class="id">b1</span> ==<span class="id">b</span> <span class="id">b2</span>)) &amp;&amp; <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock_eq">sclock_eq</a></span> <span class="id">ck1</span>' <span class="id">ck2</span>'<br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sclock_eq_spec">sclock_eq_spec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ck1</span> <span class="id">ck2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#sclock_eq">sclock_eq</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck1">ck1</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck2">ck2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ck1">ck1</a></span> = <span class="id"><a href="Velus.Lustre.LustreElab.html#ck2">ck2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</div>
<div class="proofscript" id="proof5">
<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ck1</span>, <span class="id">ck2</span>; <span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">HH</span>; <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">now</span> <span class="tactic">inversion</span> <span class="id">HH</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#ident_eqb_eq">ident_eqb_eq</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">HH</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#ident_eqb_refl">ident_eqb_refl</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">HH</span> <span class="kwd">as</span> [<span class="id">Heq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#andb_prop">andb_prop</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Heq</span> <span class="kwd">as</span> (<span class="id">Heq</span> &amp; <span class="id">Hc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#andb_prop">andb_prop</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Heq</span> <span class="kwd">as</span> (<span class="id">Hi</span> &amp; <span class="id">Hb</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sident_eqb_eq">sident_eqb_eq</a></span> <span class="kwd">in</span> <span class="id">Hi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHck1</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id">Hb</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">HH</span> <span class="kwd">as</span> [<span class="id">Heq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. 2:<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHck1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sident_eqb_eq">sident_eqb_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Instance</span> <span class="id"><a name="sclock_EqDec">sclock_EqDec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</div>
<div class="proofscript" id="proof6">
<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">ck1</span> <span class="id">ck2</span>. <span class="tactic">compute</span>.<br/>
&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#sclock_eq_spec">sclock_eq_spec</a></span> <span class="id">ck1</span> <span class="id">ck2</span>) <span class="kwd">as</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#sclock_eq">sclock_eq</a></span> <span class="id">ck1</span> <span class="id">ck2</span>); [<span class="tactic">left</span>|<span class="tactic">right</span>].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">HH</span>. <span class="tactic">apply</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sclock_eqb_eq">sclock_eqb_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>: <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>), <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> ==<span class="id">b</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#y">y</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> = <span class="id"><a href="Velus.Lustre.LustreElab.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</div>
<div class="proofscript" id="proof7">
<br/>
&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="sclk">sclk</a></span> (<span class="id">ck</span> : <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.ClockDefs.html#Cbase">Cbase</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#Sbase">Sbase</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.ClockDefs.html#Con">Con</a></span> <span class="id">ck</span>' <span class="id">x</span> <span class="id">b</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#sclk">sclk</a></span> <span class="id">ck</span>') (<span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span> <span class="id">x</span>) <span class="id">b</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">sclk</span>' (<span class="id">ck</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) : <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Sbase">Sbase</a></span> | <span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.ClockDefs.html#Cbase">Cbase</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id">ck</span>' (<span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span> <span class="id">x</span>) <span class="id">b</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id">ck</span>' (<span class="id"><a href="Velus.Lustre.LustreElab.html#Vidx">Vidx</a></span> <span class="id">x</span>) <span class="id">b</span> =&gt; <span class="id"><a href="Velus.ClockDefs.html#Con">Con</a></span> (<span class="id">sclk</span>' <span class="id">ck</span>') <span class="id">x</span> <span class="id">b</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="nsclock">nsclock</a></span> := (<span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span>).<br/>
<span class="kwd">Definition</span> <span class="id"><a name="stripname">stripname</a></span> (<span class="id">nck</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span>) := (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#nck">nck</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ann">ann</a></span> : <span class="kwd">Type</span> := (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span>)%<span class="id">type</span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="lann">lann</a></span> : <span class="kwd">Type</span> := (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span>)%<span class="id">type</span>.<br/>
<br/>
<div class="doc">elaboration exp : annotations use sclock </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="eexp">eexp</a></span> : <span class="kwd">Type</span> :=<br/>
<br/>
| <span class="id"><a name="Econst">Econst</a></span> : <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.const">const</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span><br/>
| <span class="id"><a name="Evar">Evar</a></span>   : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ann">ann</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span><br/>
| <span class="id"><a name="Eunop">Eunop</a></span>  : <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.unop">unop</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ann">ann</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span><br/>
| <span class="id"><a name="Ebinop">Ebinop</a></span> : <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.binop">binop</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ann">ann</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span><br/>
<br/>
| <span class="id"><a name="Efby">Efby</a></span>   : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ann">ann</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span><br/>
| <span class="id"><a name="Earrow">Earrow</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ann">ann</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span><br/>
<br/>
| <span class="id"><a name="Ewhen">Ewhen</a></span>  : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> -&gt; <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#lann">lann</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span><br/>
| <span class="id"><a name="Emerge">Emerge</a></span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#lann">lann</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span><br/>
| <span class="id"><a name="Eite">Eite</a></span>   : <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#lann">lann</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span><br/>
<br/>
| <span class="id"><a name="Eapp">Eapp</a></span>   : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ann">ann</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="msg_of_clock">msg_of_clock</a></span> (<span class="id">ck</span>: <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#errmsg">errmsg</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.ClockDefs.html#Cbase">Cbase</a></span>          =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "."<br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.ClockDefs.html#Con">Con</a></span> <span class="id">ck</span> <span class="id">x</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>  =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#msg_of_clock">msg_of_clock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span> ++ <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> " <span class="id">on</span> " :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">x</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.ClockDefs.html#Con">Con</a></span> <span class="id">ck</span> <span class="id">x</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#msg_of_clock">msg_of_clock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span> ++ <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> " <span class="id">onot</span> " :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">x</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="msg_of_sident">msg_of_sident</a></span> (<span class="id">id</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#errmsg">errmsg</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span> <span class="id">x</span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">x</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Vidx">Vidx</a></span> <span class="id">x</span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "?<span class="id">c</span>" :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#POS">POS</a></span> <span class="id">x</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="msg_of_sclock">msg_of_sclock</a></span> (<span class="id">ck</span>: <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#errmsg">errmsg</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Sbase">Sbase</a></span>          =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "."<br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id">x</span>         =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">x</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id">ck</span> <span class="id">id</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>  =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#msg_of_sclock">msg_of_sclock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span> ++ <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> " <span class="id">on</span> " :: <span class="id"><a href="Velus.Lustre.LustreElab.html#msg_of_sident">msg_of_sident</a></span> <span class="id">id</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id">ck</span> <span class="id">id</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#msg_of_sclock">msg_of_sclock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span> ++ <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> " <span class="id">onot</span> " :: <span class="id"><a href="Velus.Lustre.LustreElab.html#msg_of_sident">msg_of_sident</a></span> <span class="id">id</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="msg_ident_list">msg_ident_list</a></span> (<span class="id">xs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xs">xs</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;| [<span class="id">x</span>] =&gt; [<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">x</span>]<br/>
&nbsp;&nbsp;| <span class="id">x</span>::<span class="id">xs</span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">x</span> :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> ", " :: <span class="id"><a href="Velus.Lustre.LustreElab.html#msg_ident_list">msg_ident_list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xs">xs</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="msg_of_clocks">msg_of_clocks</a></span> (<span class="id">ck</span> <span class="id">ck</span>': <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#errmsg">errmsg</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">expected</span> '" :: <span class="id"><a href="Velus.Lustre.LustreElab.html#msg_of_clock">msg_of_clock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "' <span class="id">but</span> <span class="id">got</span> '" :: <span class="id"><a href="Velus.Lustre.LustreElab.html#msg_of_clock">msg_of_clock</a></span> <span class="id">ck</span>' ++ <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "'".<br/>
<br/>
<div class="doc">A completely ad-hoc monad, used only for elaboration :) </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="ElabMonad">ElabMonad</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="elab_state">elab_state</a></span> : <span class="kwd">Type</span> := (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span> * <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="Elab">Elab</a></span> <span class="id">A</span> := <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_state">elab_state</a></span> -&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#res">res</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#A">A</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_state">elab_state</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="init_state">init_state</a></span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_state">elab_state</a></span> := (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span>, <span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id">_</span>, <span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id">_</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="ret">ret</a></span> (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabMonad.A">A</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabMonad.A">A</a></span> := <span class="kwd">fun</span> <span class="id">st</span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#st">st</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bind">bind</a></span> {<span class="id">B</span> : <span class="kwd">Type</span>} (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabMonad.A">A</a></span>) (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabMonad.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#B">B</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#B">B</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">st</span> =&gt; <span class="kwd">match</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st">st</a></span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id">a</span>, <span class="id">st</span>') =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#f">f</a></span> <span class="id">a</span> <span class="id">st</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> <span class="id">err</span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> <span class="id">err</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bind2">bind2</a></span> {<span class="id">A1</span> <span class="id">A2</span> <span class="id">B</span> : <span class="kwd">Type</span>} (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#A1">A1</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#A2">A2</a></span>)) (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#A1">A1</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#A2">A2</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#B">B</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#B">B</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">st</span> =&gt; <span class="kwd">match</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st">st</a></span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> ((<span class="id">a1</span>, <span class="id">a2</span>), <span class="id">st</span>') =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#f">f</a></span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">st</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> <span class="id">err</span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> <span class="id">err</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="error">error</a></span> (<span class="id">msg</span> : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#errmsg">errmsg</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabMonad.A">A</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">st</span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#msg">msg</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="err_loc">err_loc</a></span> (<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">m</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#errmsg">errmsg</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabMonad.A">A</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#error">error</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#string_of_astloc">string_of_astloc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span>) :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> ":" :: <span class="id"><a href="Velus.Lustre.LustreElab.html#m">m</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="fresh_ident">fresh_ident</a></span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> '(<span class="id">n</span>, <span class="id">sub1</span>, <span class="id">sub2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">id</span> := <span class="id"><a href="Velus.Ident.html#Ids.gensym">Ids.gensym</a></span> <span class="id"><a href="Velus.Ident.html#Ids.elab">Ids.elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#n">n</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span>, (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#n">n</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#sub1">sub1</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#sub2">sub2</a></span>)).<br/>
<br/>
<div class="doc">Substitution functions </div>
<br/>
<br/>
<div class="doc">Occur check </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="occurs">occurs</a></span> <span class="id">id</span> <span class="id">sck</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Sbase">Sbase</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id">x</span> =&gt; <span class="id">x</span> ==<span class="id">b</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id">sck</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#occurs">occurs</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="subst_in_sident">subst_in_sident</a></span> (<span class="id">id</span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) (<span class="id">sid1</span> <span class="id">sid2</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sid2">sid2</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#sid2">sid2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Vidx">Vidx</a></span> <span class="id">x</span> =&gt; <span class="kwd">if</span> <span class="id">x</span> ==<span class="id">b</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sid1">sid1</a></span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sid2">sid2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Substitute `ck` to `id` in `sck` </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="subst_in_sclock">subst_in_sclock</a></span> (<span class="id">id</span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) (<span class="id">ck</span> <span class="id">sck</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Sbase">Sbase</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#Sbase">Sbase</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id">x</span> =&gt; <span class="kwd">if</span> <span class="id">x</span> ==<span class="id">b</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id">sck</span> <span class="id">ckid</span> <span class="id">b</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#subst_in_sclock">subst_in_sclock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span>) <span class="id">ckid</span> <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Substitute `sid` to `id` in `sck` </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="subst_ident_in_sclock">subst_ident_in_sclock</a></span> <span class="id">id</span> <span class="id">sid</span> <span class="id">sck</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Sbase">Sbase</a></span> | <span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id">sck</span> <span class="id">x</span> <span class="id">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#subst_ident_in_sclock">subst_ident_in_sclock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sid">sid</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span>) (<span class="id"><a href="Velus.Lustre.LustreElab.html#subst_in_sident">subst_in_sident</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sid">sid</a></span> <span class="id">x</span>) <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="subst_clock">subst_clock</a></span> (<span class="id">id</span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">st</span> =&gt; <span class="kwd">let</span> '(<span class="id">_</span>, <span class="id">sub1</span>, <span class="id">_</span>) := <span class="id"><a href="Velus.Lustre.LustreElab.html#st">st</a></span> <span class="kwd">in</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span> <span class="id">sub1</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#st">st</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="subst_ident">subst_ident</a></span> (<span class="id">id</span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">st</span> =&gt; <span class="kwd">let</span> '(<span class="id">_</span>, <span class="id">_</span>, <span class="id">sub2</span>) := <span class="id"><a href="Velus.Lustre.LustreElab.html#st">st</a></span> <span class="kwd">in</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span> <span class="id">sub2</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#st">st</a></span>).<br/>
<br/>
<div class="doc">Add a new association to the substitution </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="add_to_clock_subst">add_to_clock_subst</a></span> (<span class="id">id</span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) (<span class="id">sck</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> '(<span class="id">nid</span>, <span class="id">sub1</span>, <span class="id">sub2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sub1</span>' := <span class="id"><a href="Velus.Environment.html#Env.map">Env.map</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#subst_in_sclock">subst_in_sclock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#sub1">sub1</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span> <span class="id">sub1</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sck</span>' =&gt; <span class="kwd">if</span> <span class="id">sck</span>' ==<span class="id">b</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span> <span class="kwd">then</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>, (<span class="id"><a href="Velus.Lustre.LustreElab.html#nid">nid</a></span>, <span class="id">sub1</span>', <span class="id"><a href="Velus.Lustre.LustreElab.html#sub2">sub2</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">Imcompatibility</span> <span class="kwd">in</span> <span class="tactic">subst</span> : " :: <span class="id"><a href="Velus.Lustre.LustreElab.html#msg_of_sclock">msg_of_sclock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span> ++ <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> " <span class="id">and</span> "<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="Velus.Lustre.LustreElab.html#msg_of_sclock">msg_of_sclock</a></span> <span class="id">sck</span>' ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>, (<span class="id"><a href="Velus.Lustre.LustreElab.html#nid">nid</a></span>, <span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span> <span class="id">sub1</span>', <span class="id"><a href="Velus.Lustre.LustreElab.html#sub2">sub2</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="add_to_ident_subst">add_to_ident_subst</a></span> (<span class="id">id</span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) (<span class="id">id</span>' : <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> '(<span class="id">nid</span>, <span class="id">sub1</span>, <span class="id">sub2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sub1</span> := <span class="id"><a href="Velus.Environment.html#Env.map">Env.map</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#subst_ident_in_sclock">subst_ident_in_sclock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span> <span class="id">id</span>') <span class="id"><a href="Velus.Lustre.LustreElab.html#sub1">sub1</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sub2</span>' := <span class="id"><a href="Velus.Environment.html#Env.map">Env.map</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#subst_in_sident">subst_in_sident</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span> <span class="id">id</span>') <span class="id"><a href="Velus.Lustre.LustreElab.html#sub2">sub2</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span> <span class="id">sub2</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">id</span>'' =&gt; <span class="kwd">if</span> <span class="id">id</span>'' ==<span class="id">b</span> <span class="id">id</span>' <span class="kwd">then</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>, (<span class="id"><a href="Velus.Lustre.LustreElab.html#nid">nid</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#sub1">sub1</a></span>, <span class="id">sub2</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">Imcompatibility</span> <span class="kwd">in</span> <span class="tactic">subst</span> : " :: <span class="id"><a href="Velus.Lustre.LustreElab.html#msg_of_sident">msg_of_sident</a></span> <span class="id">id</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> " <span class="id">and</span> " :: <span class="id"><a href="Velus.Lustre.LustreElab.html#msg_of_sident">msg_of_sident</a></span> <span class="id">id</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>, (<span class="id"><a href="Velus.Lustre.LustreElab.html#nid">nid</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#sub1">sub1</a></span>, <span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id">id</a></span> <span class="id">id</span>' <span class="id">sub2</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bind_inv">bind_inv</a></span> {<span class="id">B</span>} : <span class="kwd">forall</span> (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabMonad.A">A</a></span>) (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabMonad.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#B">B</a></span>) <span class="id">res</span> <span class="id">st</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.LustreElab.html#bind">bind</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#f">f</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#st">st</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#res">res</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">y</span> <span class="id">st</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st">st</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#y">y</a></span>, <span class="id">st</span>'') /\ <span class="id"><a href="Velus.Lustre.LustreElab.html#f">f</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#y">y</a></span> <span class="id">st</span>'' = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#res">res</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</div>
<div class="proofscript" id="proof8">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hbind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#bind">bind</a></span> <span class="kwd">in</span> <span class="id">Hbind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">x</span> <span class="id">st</span>) <span class="kwd">as</span> [[<span class="id">y</span> <span class="id">st</span>'']|]; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">Hbind</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bind2_inv">bind2_inv</a></span> {<span class="id">A1</span> <span class="id">A2</span> <span class="id">B</span>} : <span class="kwd">forall</span> (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#A1">A1</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#A2">A2</a></span>)) (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#A1">A1</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#A2">A2</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#B">B</a></span>) <span class="id">res</span> <span class="id">st</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.LustreElab.html#bind2">bind2</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#f">f</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#st">st</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#res">res</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">y1</span> <span class="id">y2</span> <span class="id">st</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st">st</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> ((<span class="id"><a href="Velus.Lustre.LustreElab.html#y1">y1</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#y2">y2</a></span>), <span class="id">st</span>'') /\ <span class="id"><a href="Velus.Lustre.LustreElab.html#f">f</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#y1">y1</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#y2">y2</a></span> <span class="id">st</span>'' = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#res">res</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</div>
<div class="proofscript" id="proof9">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hbind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#bind2">bind2</a></span> <span class="kwd">in</span> <span class="id">Hbind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">x</span> <span class="id">st</span>) <span class="kwd">as</span> [[[<span class="id">y1</span> <span class="id">y2</span>] <span class="id">st</span>'']|]; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">Hbind</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabMonad">ElabMonad</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="ElabNotations">ElabNotations</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "'<span class="tactic">do</span>' <span class="id">X</span> &lt;- <span class="id">A</span> ; <span class="id">B</span>" :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.LustreElab.html#bind">bind</a></span> <span class="id">A</span> (<span class="kwd">fun</span> <span class="id">X</span> =&gt; <span class="id">B</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">X</span> <span class="id">ident</span>, <span class="id">A</span> <span class="tactic">at</span> <span class="id">level</span> 100, <span class="id">B</span> <span class="tactic">at</span> <span class="id">level</span> 200).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "'<span class="tactic">do</span>' ( <span class="id">X</span> , <span class="id">Y</span> ) &lt;- <span class="id">A</span> ; <span class="id">B</span>" :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.LustreElab.html#bind2">bind2</a></span> <span class="id">A</span> (<span class="kwd">fun</span> <span class="id">X</span> <span class="id">Y</span> =&gt; <span class="id">B</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">X</span> <span class="id">ident</span>, <span class="id">Y</span> <span class="id">ident</span>, <span class="id">A</span> <span class="tactic">at</span> <span class="id">level</span> 100, <span class="id">B</span> <span class="tactic">at</span> <span class="id">level</span> 200).<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabNotations">ElabNotations</a></span>.<br/>
<br/>
<span class="kwd">Import</span> <span class="id">ElabNotations</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="mmap">mmap</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="mmap.f">f</a></span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap.B">B</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="mmap">mmap</a></span> (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap.A">A</a></span>) {<span class="kwd">struct</span> <span class="id">l</span>} : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap.B">B</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">hd</span> :: <span class="id">tl</span> =&gt; <span class="tactic">do</span> <span class="id">hd</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap.f">f</a></span> <span class="id">hd</span>; <span class="tactic">do</span> <span class="id">tl</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id">tl</span>; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id">hd</span>' :: <span class="id">tl</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="mmap2">mmap2</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">B1</span> <span class="id">B2</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="mmap2.f">f</a></span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap2.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#mmap2.B1">B1</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap2.B2">B2</a></span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="mmap2">mmap2</a></span> (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap2.A">A</a></span>) {<span class="kwd">struct</span> <span class="id">l</span>} : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap2.B1">B1</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap2.B2">B2</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">hd</span> :: <span class="id">tl</span> =&gt; <span class="tactic">do</span> (<span class="id">hd1</span>, <span class="id">hd2</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap2.f">f</a></span> <span class="id">hd</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">tl1</span>, <span class="id">tl2</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap2">mmap2</a></span> <span class="id">tl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> ((<span class="id"><a href="Velus.Lustre.LustreElab.html#hd1">hd1</a></span>::<span class="id"><a href="Velus.Lustre.LustreElab.html#tl1">tl1</a></span>), (<span class="id"><a href="Velus.Lustre.LustreElab.html#hd2">hd2</a></span>::<span class="id"><a href="Velus.Lustre.LustreElab.html#tl2">tl2</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap2">mmap2</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="ElabSclock">ElabSclock</a></span>.<br/>
<br/>
<div class="doc">Apply the current substitution to an ident </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="update_sident">update_sident</a></span> (<span class="id">sid</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sid">sid</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sid">sid</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Vidx">Vidx</a></span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">x</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#subst_ident">subst_ident</a></span> <span class="id">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">x</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sid">sid</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span>' =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id">x</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Apply the current substitution in a clock </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="update_sclock">update_sclock</a></span> (<span class="id">sck</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Sbase">Sbase</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#Sbase">Sbase</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">x</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#subst_clock">subst_clock</a></span> <span class="id">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">x</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sck</span>' =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id">sck</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id">sck</span>' <span class="id">x</span> <span class="id">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">sck</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#update_sclock">update_sclock</a></span> <span class="id">sck</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">x</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#update_sident">update_sident</a></span> <span class="id">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id">sck</span>' <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> <span class="id">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="update_ann">update_ann</a></span> (<span class="id">a</span> : (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span>)) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">ty</span>, (<span class="id">ck</span>, <span class="id">id</span>)) := <span class="id"><a href="Velus.Lustre.LustreElab.html#a">a</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ck</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#update_sclock">update_sclock</a></span> <span class="id">ck</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">id</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id">ty</span>, (<span class="id">ck</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">id</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">id</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#update_sident">update_sident</a></span> <span class="id">id</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id">ty</span>, (<span class="id">ck</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">id</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Unify two sident </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="unify_sident">unify_sident</a></span> <span class="id">loc</span> (<span class="id">sid1</span> <span class="id">sid2</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">sid1</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#update_sident">update_sident</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sid1">sid1</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">sid2</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#update_sident">update_sident</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sid2">sid2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sid1">sid1</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#sid2">sid2</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span> <span class="id">id1</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span> <span class="id">id2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">id1</span> ==<span class="id">b</span> <span class="id">id2</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">Ident</span> <span class="id">unification</span> <span class="id">error</span> : " :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">id1</span> :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> ", " :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">id2</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Vidx">Vidx</a></span> <span class="id">id</span>, <span class="id">sid</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">sid</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#Vidx">Vidx</a></span> <span class="id">id</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#add_to_ident_subst">add_to_ident_subst</a></span> <span class="id">id</span> <span class="id">sid</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Unify two clocks </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="unify_sclock">unify_sclock</a></span> (<span class="id">loc</span> : <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">ck1</span> <span class="id">ck2</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ck1</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#update_sclock">update_sclock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck1">ck1</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ck2</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#update_sclock">update_sclock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck2">ck2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fix</span> <span class="id">aux</span> <span class="id">ck1</span> <span class="id">ck2</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck1">ck1</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#ck2">ck2</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Sbase">Sbase</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#Sbase">Sbase</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id">x</span>, <span class="id">ck</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">ck</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ck</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#update_sclock">update_sclock</a></span> <span class="id">ck</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#add_to_clock_subst">add_to_clock_subst</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id">ck1</span> <span class="id">id1</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id">ck2</span> <span class="id">id2</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id">ck1</span> <span class="id">id1</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id">ck2</span> <span class="id">id2</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#aux">aux</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck1">ck1</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck2">ck2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#unify_sident">unify_sident</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> <span class="id">id1</span> <span class="id">id2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">Clock</span> <span class="id">unification</span> <span class="id">error</span> : " :: <span class="id"><a href="Velus.Lustre.LustreElab.html#msg_of_sclock">msg_of_sclock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck1">ck1</a></span> ++ <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> ", " ::<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#msg_of_sclock">msg_of_sclock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck2">ck2</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#ck1">ck1</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck2">ck2</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="unify_nclock">unify_nclock</a></span> (<span class="id">loc</span> : <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">id1</span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>)  (<span class="id">ck1</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) (<span class="id">nck2</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">ck2</span>, <span class="id">id2</span>) := <span class="id"><a href="Velus.Lustre.LustreElab.html#nck2">nck2</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_sclock">unify_sclock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck1">ck1</a></span> <span class="id">ck2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">id2</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">id2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#unify_sident">unify_sident</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#id1">id1</a></span>) <span class="id">id2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabSclock">ElabSclock</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="ElabExpressions">ElabExpressions</a></span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="ElabExpressions.env">env</a></span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>).<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="ElabExpressions.G">G</a></span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#global">global</a></span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="ElabExpressions.nenv">nenv</a></span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>))).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">nat</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="find_var">find_var</a></span> (<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">x</span>: <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabExpressions.env">env</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> " <span class="kwd">is</span> <span class="id">not</span> <span class="id">declared</span>.")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ty</span>, <span class="id">ck</span>) =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id">ty</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#sclk">sclk</a></span> <span class="id">ck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="assert_id_type">assert_id_type</a></span> (<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">x</span>: <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) (<span class="id">xty</span> <span class="id">ty</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xty">xty</a></span> ==<span class="id">b</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ty">ty</a></span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> ": " :: <span class="id"><a href="Velus.Lustre.LustreElab.html#msg_of_types">msg_of_types</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xty">xty</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ty">ty</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="assert_type">assert_type</a></span> (<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">xty</span> <span class="id">ty</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xty">xty</a></span> ==<span class="id">b</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ty">ty</a></span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#msg_of_types">msg_of_types</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xty">xty</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ty">ty</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="find_node_interface">find_node_interface</a></span> (<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">f</span>: <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>)) * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>))) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#f">f</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabExpressions.nenv">nenv</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">node</span> " :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#f">f</a></span> :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> " <span class="id">not</span> <span class="id">found</span>.")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">tcs</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id">tcs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="elab_unop">elab_unop</a></span> (<span class="id">op</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#unary_operator">unary_operator</a></span>) : <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.unop">unop</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#op">op</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#MINUS">MINUS</a></span> =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.UnaryOp">UnaryOp</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Oneg">Cop.Oneg</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#NOT">NOT</a></span>   =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.UnaryOp">UnaryOp</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Onotint">Cop.Onotint</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#BNOT">BNOT</a></span>  =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.UnaryOp">UnaryOp</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Onotbool">Cop.Onotbool</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="elab_binop">elab_binop</a></span> (<span class="id">op</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#binary_operator">binary_operator</a></span>) : <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.binop">binop</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#op">op</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#ADD">ADD</a></span>  =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Oadd">Cop.Oadd</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#SUB">SUB</a></span>  =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Osub">Cop.Osub</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#MUL">MUL</a></span>  =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Omul">Cop.Omul</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#DIV">DIV</a></span>  =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Odiv">Cop.Odiv</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#MOD">MOD</a></span>  =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Omod">Cop.Omod</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#BAND">BAND</a></span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Oand">Cop.Oand</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#BOR">BOR</a></span>  =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Oor">Cop.Oor</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#LAND">LAND</a></span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Oand">Cop.Oand</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#LOR">LOR</a></span>  =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Oor">Cop.Oor</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#XOR">XOR</a></span>  =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Oxor">Cop.Oxor</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#LSL">LSL</a></span>  =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Oshl">Cop.Oshl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#LSR">LSR</a></span>  =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Oshr">Cop.Oshr</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#EQ">EQ</a></span>   =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Oeq">Cop.Oeq</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#NE">NE</a></span>   =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#One">Cop.One</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#LT">LT</a></span>   =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Olt">Cop.Olt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#GT">GT</a></span>   =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Ogt">Cop.Ogt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#LE">LE</a></span>   =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Ole">Cop.Ole</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#GE">GE</a></span>   =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Cop.html#Oge">Cop.Oge</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="find_type_unop">find_type_unop</a></span> (<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">op</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.unop">unop</a></span>) (<span class="id">ty</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type_unop</span>' <span class="id"><a href="Velus.Lustre.LustreElab.html#op">op</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ty">ty</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">wrong</span> <span class="id">operator</span> <span class="id">argument</span> <span class="id">type</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span>' =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id">ty</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="find_type_binop">find_type_binop</a></span> (<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">op</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.binop">binop</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ty1</span> <span class="id">ty2</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type_binop</span>' <span class="id"><a href="Velus.Lustre.LustreElab.html#op">op</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ty1">ty1</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ty2">ty2</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">wrong</span> <span class="id">operator</span> <span class="id">argument</span> <span class="id">type</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span>' =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id">ty</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="elab_type">elab_type</a></span> (<span class="id">ty</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#type_name">type_name</a></span>) : <span class="id">type</span>' :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ty">ty</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#Tint8">Tint8</a></span>    =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.Tint">Tint</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#I8">Ctypes.I8</a></span>  <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Signed">Ctypes.Signed</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#Tuint8">Tuint8</a></span>   =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.Tint">Tint</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#I8">Ctypes.I8</a></span>  <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Unsigned">Ctypes.Unsigned</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#Tint16">Tint16</a></span>   =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.Tint">Tint</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#I16">Ctypes.I16</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Signed">Ctypes.Signed</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#Tuint16">Tuint16</a></span>  =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.Tint">Tint</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#I16">Ctypes.I16</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Unsigned">Ctypes.Unsigned</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#Tint32">Tint32</a></span>   =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.Tint">Tint</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#I32">Ctypes.I32</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Signed">Ctypes.Signed</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#Tuint32">Tuint32</a></span>  =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.Tint">Tint</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#I32">Ctypes.I32</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Unsigned">Ctypes.Unsigned</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#Tint64">Tint64</a></span>   =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.Tlong">Tlong</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Signed">Ctypes.Signed</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#Tuint64">Tuint64</a></span>  =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.Tlong">Tlong</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Unsigned">Ctypes.Unsigned</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#Tfloat32">Tfloat32</a></span> =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.Tfloat">Tfloat</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#F32">Ctypes.F32</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#Tfloat64">Tfloat64</a></span> =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.Tfloat">Tfloat</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#F64">Ctypes.F64</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#Tbool">Tbool</a></span>    =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.Tint">Tint</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#IBool">Ctypes.IBool</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Signed">Ctypes.Signed</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="err_not_singleton">err_not_singleton</a></span> {<span class="id">A</span>} (<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#A">A</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">singleton</span> <span class="id">argument</span> <span class="id">expected</span>").<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="single_annot">single_annot</a></span> (<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">e</span>: <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Econst">Econst</a></span> <span class="id">c</span> <span class="id">clock</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type_const">type_const</a></span> <span class="id">c</span>, <span class="id">clock</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Eapp">Eapp</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> [(<span class="id">ty</span>, <span class="id">nck</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Evar">Evar</a></span> <span class="id">_</span> (<span class="id">ty</span>, <span class="id">nck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Eunop">Eunop</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id">ty</span>, <span class="id">nck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Ebinop">Ebinop</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">ty</span>, <span class="id">nck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Ewhen">Ewhen</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ([<span class="id">ty</span>], <span class="id">nck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Efby">Efby</a></span> <span class="id">_</span> <span class="id">_</span> [(<span class="id">ty</span>, <span class="id">nck</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Emerge">Emerge</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ([<span class="id">ty</span>], <span class="id">nck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Eite">Eite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ([<span class="id">ty</span>], <span class="id">nck</span>) =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id">ty</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#stripname">stripname</a></span> <span class="id">nck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_not_singleton">err_not_singleton</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="lannot">lannot</a></span> (<span class="id">el</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> ((<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">e</span>, <span class="id">loc</span>) := <span class="id"><a href="Velus.Lustre.LustreElab.html#el">el</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Econst">Econst</a></span> <span class="id">c</span> <span class="id">clock</span> =&gt; [((<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type_const">type_const</a></span> <span class="id">c</span>, <span class="id">clock</span>), <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Evar">Evar</a></span> <span class="id">_</span> (<span class="id">ty</span>, <span class="id">nck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Eunop">Eunop</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id">ty</span>, <span class="id">nck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Ebinop">Ebinop</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">ty</span>, <span class="id">nck</span>) =&gt; [((<span class="id">ty</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#stripname">stripname</a></span> <span class="id">nck</span>), <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Ewhen">Ewhen</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">tys</span>, <span class="id">nck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Emerge">Emerge</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">tys</span>, <span class="id">nck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Eite">Eite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">tys</span>, <span class="id">nck</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ck</span> := <span class="id"><a href="Velus.Lustre.LustreElab.html#stripname">stripname</a></span> <span class="id">nck</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ty</span>=&gt; ((<span class="id"><a href="Velus.Lustre.LustreElab.html#ty">ty</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span>), <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span>)) <span class="id">tys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Efby">Efby</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">anns</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Earrow">Earrow</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">anns</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Eapp">Eapp</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">anns</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">tc</span> =&gt; ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#tc">tc</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#stripname">stripname</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#tc">tc</a></span>)), <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span>)) <span class="id">anns</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="lannots">lannots</a></span> (<span class="id">els</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> ((<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#lannot">lannot</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#els">els</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="lnannot">lnannot</a></span> (<span class="id">el</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> ((<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span>) * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">e</span>, <span class="id">loc</span>) := <span class="id"><a href="Velus.Lustre.LustreElab.html#el">el</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Econst">Econst</a></span> <span class="id">c</span> <span class="id">clock</span> =&gt; [((<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type_const">type_const</a></span> <span class="id">c</span>, (<span class="id">clock</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)), <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Evar">Evar</a></span> <span class="id">_</span> (<span class="id">ty</span>, <span class="id">nck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Eunop">Eunop</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id">ty</span>, <span class="id">nck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Ebinop">Ebinop</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">ty</span>, <span class="id">nck</span>) =&gt; [((<span class="id">ty</span>, <span class="id">nck</span>), <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Ewhen">Ewhen</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">tys</span>, <span class="id">nck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Emerge">Emerge</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">tys</span>, <span class="id">nck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Eite">Eite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">tys</span>, <span class="id">nck</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ty</span>=&gt; ((<span class="id"><a href="Velus.Lustre.LustreElab.html#ty">ty</a></span>, <span class="id">nck</span>), <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span>)) <span class="id">tys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Efby">Efby</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">anns</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Earrow">Earrow</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">anns</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Eapp">Eapp</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">anns</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">tc</span> =&gt; (<span class="id"><a href="Velus.Lustre.LustreElab.html#tc">tc</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span>)) <span class="id">anns</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="lannots_ty">lannots_ty</a></span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">tcl</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> ((<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#A">A</a></span>) * <span class="id"><a href="Velus.Lustre.LustreElab.html#B">B</a></span>)) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">x</span>=&gt;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span>)) <span class="id"><a href="Velus.Lustre.LustreElab.html#tcl">tcl</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="lnannots">lnannots</a></span> (<span class="id">els</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> ((<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span>) * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#lnannot">lnannot</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#els">els</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="hd_sclock">hd_sclock</a></span> (<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">ls</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> ((<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ls">ls</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">empty</span> <span class="id">expression</span> <span class="id">list</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">l</span>::<span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="unify_same_clock">unify_same_clock</a></span> (<span class="id">lck</span>: <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ans</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> ((<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>)) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ans">ans</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">an</span>::<span class="id">ans</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '((<span class="id">ty</span>, <span class="id">ck</span>), <span class="id">loc</span>) := <span class="id">an</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_sclock">unify_sclock</a></span> <span class="id">loc</span> <span class="id">ck</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#lck">lck</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#unify_same_clock">unify_same_clock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#lck">lck</a></span> <span class="id">ans</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="unify_paired_types">unify_paired_types</a></span> (<span class="id">gloc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">ck1</span> <span class="id">ck2</span>: <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ants</span> <span class="id">anfs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> ((<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>)) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ants">ants</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#anfs">anfs</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [], [] =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">ant</span>::<span class="id">ants</span>', <span class="id">anf</span>::<span class="id">anfs</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '((<span class="id">tty</span>, <span class="id">tck</span>), <span class="id">tloc</span>) := <span class="id">ant</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '((<span class="id">fty</span>, <span class="id">fck</span>), <span class="id">floc</span>) := <span class="id">anf</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_sclock">unify_sclock</a></span> <span class="id">tloc</span> <span class="id">tck</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck1">ck1</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_sclock">unify_sclock</a></span> <span class="id">floc</span> <span class="id">fck</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck2">ck2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">tty</span> ==<span class="id">b</span> <span class="id">fty</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_paired_types">unify_paired_types</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#gloc">gloc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck1">ck1</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck2">ck2</a></span> <span class="id">ants</span>' <span class="id">anfs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#gloc">gloc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">expression</span> <span class="tactic">at</span> "<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#string_of_astloc">string_of_astloc</a></span> <span class="id">tloc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> " <span class="id">has</span> <span class="id">type</span> '" :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.string_of_type">string_of_type</a></span> <span class="id">tty</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "' <span class="id">but</span> <span class="id">expression</span> <span class="tactic">at</span> "<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#string_of_astloc">string_of_astloc</a></span> <span class="id">floc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> " <span class="id">has</span> <span class="id">type</span> '" :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.string_of_type">string_of_type</a></span> <span class="id">fty</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "'")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#gloc">gloc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">arguments</span> <span class="id">are</span> <span class="id">of</span> <span class="id">different</span> <span class="id">lengths</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="unify_paired_clock_types">unify_paired_clock_types</a></span> (<span class="id">gloc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ants</span> <span class="id">anfs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> ((<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span>) * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>)) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ants">ants</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#anfs">anfs</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [], [] =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">ant</span>::<span class="id">ants</span>', <span class="id">anf</span>::<span class="id">anfs</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '((<span class="id">tty</span>, (<span class="id">tck</span>, <span class="id">_</span>)), <span class="id">tloc</span>) := <span class="id">ant</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '((<span class="id">fty</span>, (<span class="id">fck</span>, <span class="id">_</span>)), <span class="id">floc</span>) := <span class="id">anf</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_sclock">unify_sclock</a></span> <span class="id">tloc</span> <span class="id">tck</span> <span class="id">fck</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">tty</span> ==<span class="id">b</span> <span class="id">fty</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_paired_clock_types">unify_paired_clock_types</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#gloc">gloc</a></span> <span class="id">ants</span>' <span class="id">anfs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#gloc">gloc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">expression</span> <span class="tactic">at</span> "<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#string_of_astloc">string_of_astloc</a></span> <span class="id">tloc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> " <span class="id">has</span> <span class="id">type</span> '" :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.string_of_type">string_of_type</a></span> <span class="id">tty</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "' <span class="id">but</span> <span class="id">expression</span> <span class="tactic">at</span> "<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#string_of_astloc">string_of_astloc</a></span> <span class="id">floc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> " <span class="id">has</span> <span class="id">type</span> '" :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.string_of_type">string_of_type</a></span> <span class="id">fty</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "'")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#gloc">gloc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">arguments</span> <span class="id">are</span> <span class="id">of</span> <span class="id">different</span> <span class="id">lengths</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="instantiating_subst">instantiating_subst</a></span> (<span class="id">xtc</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>))) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">xs</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">_</span>) =&gt; <span class="tactic">do</span> <span class="id">x</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ident">fresh_ident</a></span>; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span>, <span class="id">x</span>')) <span class="id"><a href="Velus.Lustre.LustreElab.html#xtc">xtc</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xs">xs</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="inst_clock">inst_clock</a></span> (<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">base</span>: <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) (<span class="id">sub</span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) (<span class="id">ck</span>: <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.ClockDefs.html#Cbase">Cbase</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#base">base</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.ClockDefs.html#Con">Con</a></span> <span class="id">ck</span>' <span class="id">x</span> <span class="id">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">sck</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#inst_clock">inst_clock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#base">base</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sub">sub</a></span> <span class="id">ck</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sub">sub</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">The</span> " :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> " <span class="id">argument</span> <span class="id">must</span> <span class="id">be</span> <span class="id">instantiated</span> <span class="kwd">with</span> <span class="id">a</span> <span class="id">variable</span>.")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ni</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id">sck</span>' (<span class="id"><a href="Velus.Lustre.LustreElab.html#Vidx">Vidx</a></span> <span class="id">ni</span>) <span class="id">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="inst_annot">inst_annot</a></span> (<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">base</span>: <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) (<span class="id">sub</span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">anon_cons</span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xtc</span>: <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>)) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ann">ann</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">x</span>, (<span class="id">ty</span>, <span class="id">ck</span>)) := <span class="id"><a href="Velus.Lustre.LustreElab.html#xtc">xtc</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">sck</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#inst_clock">inst_clock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#base">base</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sub">sub</a></span> <span class="id">ck</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sub">sub</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id">ty</span>, (<span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id">ty</span>, (<span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#anon_cons">anon_cons</a></span> <span class="id">x</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">unify_nclock</span>' (<span class="id">loc</span> : <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">nck1</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span>) (<span class="id">nck2</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">ck1</span>, <span class="id">id1</span>) := <span class="id"><a href="Velus.Lustre.LustreElab.html#nck1">nck1</a></span> <span class="kwd">in</span> <span class="kwd">let</span> '(<span class="id">ck2</span>, <span class="id">id2</span>) := <span class="id"><a href="Velus.Lustre.LustreElab.html#nck2">nck2</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_sclock">unify_sclock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> <span class="id">ck1</span> <span class="id">ck2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">id1</span>, <span class="id">id2</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">id1</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">id2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#unify_sident">unify_sident</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> <span class="id">id1</span> <span class="id">id2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="unify_inputs">unify_inputs</a></span> (<span class="id">gloc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">iface</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">args</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> ((<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span>) * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>)) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#iface">iface</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#args">args</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#gloc">gloc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">too</span> <span class="id">many</span> <span class="id">arguments</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#gloc">gloc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">not</span> <span class="id">enough</span> <span class="id">arguments</span>")<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id">ty</span>, <span class="id">nck</span>)::<span class="id">iface</span>', ((<span class="id">ty</span>', <span class="id">nck</span>'), <span class="id">loc</span>)::<span class="id">args</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#assert_type">assert_type</a></span> <span class="id">loc</span> <span class="id">ty</span>' <span class="id">ty</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id">unify_nclock</span>' <span class="id">loc</span> <span class="id">nck</span>' <span class="id">nck</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#unify_inputs">unify_inputs</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#gloc">gloc</a></span> <span class="id">iface</span>' <span class="id">args</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="discardname">discardname</a></span> (<span class="id">ann</span> : (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>)) : (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">ty</span>, (<span class="id">ck</span>, <span class="id">id</span>), <span class="id">_</span>) := <span class="id"><a href="Velus.Lustre.LustreElab.html#ann">ann</a></span> <span class="kwd">in</span> (<span class="id">ty</span>, (<span class="id">ck</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)).<br/>
<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="elab_exp">elab_exp</a></span> (<span class="id">is_top</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">ae</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#expression">expression</a></span>) {<span class="kwd">struct</span> <span class="id">ae</span>} : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">elab_exp</span> := <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ae">ae</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#CONSTANT">CONSTANT</a></span> <span class="id">ac</span> <span class="id">loc</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">x</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ident">fresh_ident</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">c</span> := <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_constant">elab_constant</a></span> <span class="id">loc</span> <span class="id">ac</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ty</span> := <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type_const">type_const</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#c">c</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Econst">Econst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#c">c</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span>), <span class="id">loc</span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#VARIABLE">VARIABLE</a></span> <span class="id">x</span> <span class="id">loc</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">ty</span>, <span class="id">ck</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#find_var">find_var</a></span> <span class="id">loc</span> <span class="id">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Evar">Evar</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#ty">ty</a></span>, (<span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span>, <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#is_top">is_top</a></span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span> <span class="id">x</span>))), <span class="id">loc</span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#UNARY">UNARY</a></span> <span class="id">aop</span> [<span class="id">ae</span>'] <span class="id">loc</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">op</span> := <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_unop">elab_unop</a></span> <span class="id">aop</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">e</span>, <span class="id">loc</span>') &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id">ae</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">ty</span>, <span class="id">sck</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#single_annot">single_annot</a></span> <span class="id">loc</span>' <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ty</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#find_type_unop">find_type_unop</a></span> <span class="id">loc</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#op">op</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ty">ty</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Eunop">Eunop</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#op">op</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span> (<span class="id">ty</span>', (<span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)), <span class="id">loc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#UNARY">UNARY</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">loc</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_not_singleton">err_not_singleton</a></span> <span class="id">loc</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#CAST">CAST</a></span> <span class="id">aty</span>' [<span class="id">ae</span>'] <span class="id">loc</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ty</span>' := <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_type">elab_type</a></span> <span class="id">aty</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">e</span>, <span class="id">loc</span>') &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id">ae</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">_</span>, <span class="id">sck</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#single_annot">single_annot</a></span> <span class="id">loc</span>' <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Eunop">Eunop</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.CastOp">CastOp</a></span> <span class="id">ty</span>') <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span> (<span class="id">ty</span>', (<span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)), <span class="id">loc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#CAST">CAST</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">loc</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_not_singleton">err_not_singleton</a></span> <span class="id">loc</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#BINARY">BINARY</a></span> <span class="id">aop</span> [<span class="id">ae1</span>] [<span class="id">ae2</span>] <span class="id">loc</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">op</span> := <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_binop">elab_binop</a></span> <span class="id">aop</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">e1</span>, <span class="id">loc1</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id">ae1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">ty1</span>, <span class="id">sck1</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#single_annot">single_annot</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc1">loc1</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e1">e1</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">e2</span>, <span class="id">loc2</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id">ae2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">ty2</span>, <span class="id">sck2</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#single_annot">single_annot</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc2">loc2</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e2">e2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ty</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#find_type_binop">find_type_binop</a></span> <span class="id">loc</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#op">op</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ty1">ty1</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ty2">ty2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_sclock">unify_sclock</a></span> <span class="id">loc</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck1">sck1</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck2">sck2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Ebinop">Ebinop</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#op">op</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e1">e1</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e2">e2</a></span> (<span class="id">ty</span>', (<span class="id"><a href="Velus.Lustre.LustreElab.html#sck1">sck1</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)), <span class="id">loc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#BINARY">BINARY</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">loc</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_not_singleton">err_not_singleton</a></span> <span class="id">loc</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#FBY">FBY</a></span> <span class="id">ae0s</span> <span class="id">aes</span> <span class="id">loc</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">e0s</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id">ae0s</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">es</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id">aes</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ans0</span> := <span class="id"><a href="Velus.Lustre.LustreElab.html#lnannots">lnannots</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e0s">e0s</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_paired_clock_types">unify_paired_clock_types</a></span> <span class="id">loc</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ans0">ans0</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#lnannots">lnannots</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#es">es</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ans0</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#update_ann">update_ann</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#discardname">discardname</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ans0">ans0</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Efby">Efby</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e0s">e0s</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#es">es</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#ans0">ans0</a></span>, <span class="id">loc</span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#ARROW">ARROW</a></span> <span class="id">ae0s</span> <span class="id">aes</span> <span class="id">loc</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">e0s</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id">ae0s</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">es</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id">aes</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ans0</span> := <span class="id"><a href="Velus.Lustre.LustreElab.html#lnannots">lnannots</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e0s">e0s</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_paired_clock_types">unify_paired_clock_types</a></span> <span class="id">loc</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ans0">ans0</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#lnannots">lnannots</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#es">es</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ans0</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#update_ann">update_ann</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#discardname">discardname</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ans0">ans0</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Earrow">Earrow</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e0s">e0s</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#es">es</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#ans0">ans0</a></span>, <span class="id">loc</span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#WHEN">WHEN</a></span> <span class="id">aes</span>' <span class="id">x</span> <span class="id">b</span> <span class="id">loc</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">xty</span>, <span class="id">xck</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#find_var">find_var</a></span> <span class="id">loc</span> <span class="id">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#assert_id_type">assert_id_type</a></span> <span class="id">loc</span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xty">xty</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.bool_type">bool_type</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">eas</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id">aes</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ans</span>' := <span class="id"><a href="Velus.Lustre.LustreElab.html#lannots">lannots</a></span> <span class="id">eas</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_same_clock">unify_same_clock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xck">xck</a></span> <span class="id">ans</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Ewhen">Ewhen</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">eas</span>') <span class="id">x</span> <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.LustreElab.html#lannots_ty">lannots_ty</a></span> <span class="id">ans</span>', (<span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xck">xck</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span> <span class="id">x</span>) <span class="id">b</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)), <span class="id">loc</span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#MERGE">MERGE</a></span> <span class="id">x</span> <span class="id">aets</span> <span class="id">aefs</span> <span class="id">loc</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">xty</span>, <span class="id">sck</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#find_var">find_var</a></span> <span class="id">loc</span> <span class="id">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">tck</span> := <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span> <span class="id">x</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">fck</span> := <span class="id"><a href="Velus.Lustre.LustreElab.html#Son">Son</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span> <span class="id">x</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#assert_id_type">assert_id_type</a></span> <span class="id">loc</span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xty">xty</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.bool_type">bool_type</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">eats</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id">aets</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ants</span> := <span class="id"><a href="Velus.Lustre.LustreElab.html#lannots">lannots</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eats">eats</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">eafs</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id">aefs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_paired_types">unify_paired_types</a></span> <span class="id">loc</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#tck">tck</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#fck">fck</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ants">ants</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#lannots">lannots</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eafs">eafs</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Emerge">Emerge</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eats">eats</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eafs">eafs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.LustreElab.html#lannots_ty">lannots_ty</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ants">ants</a></span>, (<span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)), <span class="id">loc</span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#IFTE">IFTE</a></span> [<span class="id">ae</span>] <span class="id">aets</span> <span class="id">aefs</span> <span class="id">loc</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">e</span>, <span class="id">eloc</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ae">ae</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">ety</span>, <span class="id">eck</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#single_annot">single_annot</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eloc">eloc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#assert_type">assert_type</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eloc">eloc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ety">ety</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.bool_type">bool_type</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">eats</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id">aets</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ants</span> := <span class="id"><a href="Velus.Lustre.LustreElab.html#lannots">lannots</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eats">eats</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">eafs</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id">aefs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_paired_types">unify_paired_types</a></span> <span class="id">loc</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eck">eck</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eck">eck</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ants">ants</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#lannots">lannots</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eafs">eafs</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Eite">Eite</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eats">eats</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eafs">eafs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.LustreElab.html#lannots_ty">lannots_ty</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ants">ants</a></span>, (<span class="id"><a href="Velus.Lustre.LustreElab.html#eck">eck</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)), <span class="id">loc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#IFTE">IFTE</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">loc</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_not_singleton">err_not_singleton</a></span> <span class="id">loc</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#APP">APP</a></span> <span class="id">f</span> <span class="id">aes</span> [] <span class="id">loc</span> =&gt;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">tyck_in</span>, <span class="id">tyck_out</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#find_node_interface">find_node_interface</a></span> <span class="id">loc</span> <span class="id">f</span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">eas</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id">aes</span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">anns</span> := <span class="id"><a href="Velus.Lustre.LustreElab.html#lnannots">lnannots</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eas">eas</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">sub</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#instantiating_subst">instantiating_subst</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#tyck_in">tyck_in</a></span>++<span class="id"><a href="Velus.Lustre.LustreElab.html#tyck_out">tyck_out</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">xbase</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ident">fresh_ident</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ianns</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#inst_annot">inst_annot</a></span> <span class="id">loc</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xbase">xbase</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#sub">sub</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#Vidx">Vidx</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#tyck_in">tyck_in</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">oanns</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#inst_annot">inst_annot</a></span> <span class="id">loc</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xbase">xbase</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#sub">sub</a></span> (<span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#is_top">is_top</a></span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#Vidx">Vidx</a></span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span>)) <span class="id"><a href="Velus.Lustre.LustreElab.html#tyck_out">tyck_out</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_inputs">unify_inputs</a></span> <span class="id">loc</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ianns">ianns</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#anns">anns</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Eapp">Eapp</a></span> <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eas">eas</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#oanns">oanns</a></span>, <span class="id">loc</span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#APP">APP</a></span> <span class="id">f</span> <span class="id">aes</span> [<span class="id">aer</span>] <span class="id">loc</span> =&gt;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">tyck_in</span>, <span class="id">tyck_out</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#find_node_interface">find_node_interface</a></span> <span class="id">loc</span> <span class="id">f</span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">eas</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id">aes</span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">er</span>, <span class="id">erloc</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id">aer</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">erty</span>, <span class="id">_</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#single_annot">single_annot</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#erloc">erloc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#er">er</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#assert_type">assert_type</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#erloc">erloc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#erty">erty</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.bool_type">bool_type</a></span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">anns</span> := <span class="id"><a href="Velus.Lustre.LustreElab.html#lnannots">lnannots</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eas">eas</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">sub</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#instantiating_subst">instantiating_subst</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#tyck_in">tyck_in</a></span>++<span class="id"><a href="Velus.Lustre.LustreElab.html#tyck_out">tyck_out</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">xbase</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ident">fresh_ident</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ianns</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#inst_annot">inst_annot</a></span> <span class="id">loc</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xbase">xbase</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#sub">sub</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#Vidx">Vidx</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#tyck_in">tyck_in</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">oanns</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#inst_annot">inst_annot</a></span> <span class="id">loc</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xbase">xbase</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#sub">sub</a></span> (<span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#is_top">is_top</a></span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#Vidx">Vidx</a></span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span>)) <span class="id"><a href="Velus.Lustre.LustreElab.html#tyck_out">tyck_out</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_inputs">unify_inputs</a></span> <span class="id">loc</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ianns">ianns</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#anns">anns</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Eapp">Eapp</a></span> <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eas">eas</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#er">er</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#oanns">oanns</a></span>, <span class="id">loc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#APP">APP</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">loc</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_not_singleton">err_not_singleton</a></span> <span class="id">loc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="freeze_ident">freeze_ident</a></span> (<span class="id">sid</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#sident">sident</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">sid</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#update_sident">update_sident</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sid">sid</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sid">sid</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span> <span class="id">x</span> | <span class="id"><a href="Velus.Lustre.LustreElab.html#Vidx">Vidx</a></span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="freeze_clock">freeze_clock</a></span> (<span class="id">sck</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#sclock">sclock</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">sck</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#update_sclock">update_sclock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id">sclk</span>' <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="freeze_nclock">freeze_nclock</a></span> (<span class="id">nck</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.ClockDefs.html#nclock">nclock</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">sck</span>, <span class="id">x</span>) := <span class="id"><a href="Velus.Lustre.LustreElab.html#nck">nck</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ck</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_clock">freeze_clock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#sck">sck</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">x</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_ident">freeze_ident</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="freeze_ann">freeze_ann</a></span> (<span class="id">tc</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#ann">ann</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ann">Syn.ann</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">ty</span>, <span class="id">nck</span>) := <span class="id"><a href="Velus.Lustre.LustreElab.html#tc">tc</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nck</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_nclock">freeze_nclock</a></span> <span class="id">nck</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id">ty</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#nck">nck</a></span>).<br/>
<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="add_whens">add_whens</a></span> (<span class="id">e</span>: <span class="id"><a href="Velus.Lustre.LustreElab.html#exp">Syn.exp</a></span>) (<span class="id">tys</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span>) (<span class="id">ck</span>: <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#exp">Syn.exp</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.ClockDefs.html#Cbase">Cbase</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.ClockDefs.html#Con">Con</a></span> <span class="id">ck</span>' <span class="id">x</span> <span class="id">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">e</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#add_whens">add_whens</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#tys">tys</a></span> <span class="id">ck</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Environment.html#Env.mem">Env.mem</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabExpressions.env">env</a></span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Ewhen">Syn.Ewhen</a></span> [<span class="id">e</span>'] <span class="id">x</span> <span class="id">b</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#tys">tys</a></span>, (<span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#error">error</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">Clock</span> <span class="id">variable</span> " :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">x</span> :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> " <span class="id">escapes</span> <span class="id">its</span> <span class="id">scope</span>" :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="freeze_exp">freeze_exp</a></span> (<span class="id">e</span> : <span class="id"><a href="Velus.Lustre.LustreElab.html#eexp">eexp</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#exp">Syn.exp</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">freeze_exps</span> := <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exp">freeze_exp</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Econst">Econst</a></span> <span class="id">c</span> <span class="id">ck</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ty</span> := <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type_const">type_const</a></span> <span class="id">c</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ck</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_clock">freeze_clock</a></span> <span class="id">ck</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#add_whens">add_whens</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Econst">Syn.Econst</a></span> <span class="id">c</span>) [<span class="id"><a href="Velus.Lustre.LustreElab.html#ty">ty</a></span>] <span class="id">ck</span>'<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Evar">Evar</a></span> <span class="id">x</span> <span class="id">ann</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ann</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_ann">freeze_ann</a></span> <span class="id">ann</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Evar">Syn.Evar</a></span> <span class="id">x</span> <span class="id">ann</span>')<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Eunop">Eunop</a></span> <span class="id">unop</span> <span class="id">e</span> <span class="id">ann</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">e</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exp">freeze_exp</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ann</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_ann">freeze_ann</a></span> <span class="id">ann</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Eunop">Syn.Eunop</a></span> <span class="id">unop</span> <span class="id">e</span>' <span class="id">ann</span>')<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Ebinop">Ebinop</a></span> <span class="id">binop</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">ann</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">e1</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exp">freeze_exp</a></span> <span class="id">e1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">e2</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exp">freeze_exp</a></span> <span class="id">e2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ann</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_ann">freeze_ann</a></span> <span class="id">ann</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Ebinop">Syn.Ebinop</a></span> <span class="id">binop</span> <span class="id">e1</span>' <span class="id">e2</span>' <span class="id">ann</span>')<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Efby">Efby</a></span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">anns</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">e0s</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exps">freeze_exps</a></span> <span class="id">e0s</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">es</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exps">freeze_exps</a></span> <span class="id">es</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">anns</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_ann">freeze_ann</a></span> <span class="id">anns</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Efby">Syn.Efby</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e0s">e0s</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#es">es</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#anns">anns</a></span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Earrow">Earrow</a></span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">anns</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">e0s</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exps">freeze_exps</a></span> <span class="id">e0s</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">es</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exps">freeze_exps</a></span> <span class="id">es</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">anns</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_ann">freeze_ann</a></span> <span class="id">anns</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Earrow">Syn.Earrow</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e0s">e0s</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#es">es</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#anns">anns</a></span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Ewhen">Ewhen</a></span> <span class="id">es</span> <span class="id">ckid</span> <span class="id">b</span> (<span class="id">tys</span>, <span class="id">nck</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">es</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exps">freeze_exps</a></span> <span class="id">es</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nck</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_nclock">freeze_nclock</a></span> <span class="id">nck</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Ewhen">Syn.Ewhen</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#es">es</a></span> <span class="id">ckid</span> <span class="id">b</span> (<span class="id">tys</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#nck">nck</a></span>))<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Emerge">Emerge</a></span> <span class="id">ckid</span> <span class="id">ets</span> <span class="id">efs</span> (<span class="id">tys</span>, <span class="id">nck</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ets</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exps">freeze_exps</a></span> <span class="id">ets</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">efs</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exps">freeze_exps</a></span> <span class="id">efs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nck</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_nclock">freeze_nclock</a></span> <span class="id">nck</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Emerge">Syn.Emerge</a></span> <span class="id">ckid</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ets">ets</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#efs">efs</a></span> (<span class="id">tys</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#nck">nck</a></span>))<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Eite">Eite</a></span> <span class="id">e</span> <span class="id">ets</span> <span class="id">efs</span> (<span class="id">tys</span>, <span class="id">nck</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">e</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exp">freeze_exp</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ets</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exps">freeze_exps</a></span> <span class="id">ets</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">efs</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exps">freeze_exps</a></span> <span class="id">efs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nck</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_nclock">freeze_nclock</a></span> <span class="id">nck</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Eite">Syn.Eite</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ets">ets</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#efs">efs</a></span> (<span class="id">tys</span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#nck">nck</a></span>))<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Eapp">Eapp</a></span> <span class="id">f</span> <span class="id">es</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">anns</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">es</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exps">freeze_exps</a></span> <span class="id">es</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">anns</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_ann">freeze_ann</a></span> <span class="id">anns</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Eapp">Syn.Eapp</a></span> <span class="id">f</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#es">es</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#anns">anns</a></span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LustreElab.html#Eapp">Eapp</a></span> <span class="id">f</span> <span class="id">es</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">er</span>) <span class="id">anns</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">es</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exps">freeze_exps</a></span> <span class="id">es</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">er</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exp">freeze_exp</a></span> <span class="id">er</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">anns</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_ann">freeze_ann</a></span> <span class="id">anns</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Eapp">Syn.Eapp</a></span> <span class="id">f</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#es">es</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#er">er</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#anns">anns</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="unify_pat">unify_pat</a></span> (<span class="id">gloc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">anns</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> ((<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#nsclock">nsclock</a></span>) * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>)) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xs">xs</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#anns">anns</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">x</span>::<span class="id">xs</span>', ((<span class="id">ty</span>, <span class="id">ck</span>), <span class="id">loc</span>)::<span class="id">anns</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">xty</span>, <span class="id">xck</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#find_var">find_var</a></span> <span class="id">loc</span> <span class="id">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#assert_id_type">assert_id_type</a></span> <span class="id">loc</span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xty">xty</a></span> <span class="id">ty</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_nclock">unify_nclock</a></span> <span class="id">loc</span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xck">xck</a></span> <span class="id">ck</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#unify_pat">unify_pat</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#gloc">gloc</a></span> <span class="id">xs</span>' <span class="id">anns</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#gloc">gloc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">too</span> <span class="id">few</span> <span class="id">variables</span> <span class="id">on</span> <span class="id">lhs</span> <span class="id">of</span> <span class="id">equation</span>.")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#gloc">gloc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">too</span> <span class="id">many</span> <span class="id">variables</span> <span class="id">on</span> <span class="id">lhs</span> <span class="id">of</span> <span class="id">equation</span>.")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="elab_equation">elab_equation</a></span> (<span class="id">aeq</span> : <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#equation">LustreAst.equation</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#equation">Syn.equation</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '((<span class="id">xs</span>, <span class="id">es</span>), <span class="id">loc</span>) := <span class="id"><a href="Velus.Lustre.LustreElab.html#aeq">aeq</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">es</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">es</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#unify_pat">unify_pat</a></span> <span class="id">loc</span> <span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#lnannots">lnannots</a></span> <span class="id">es</span>');<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">es</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exp">freeze_exp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">es</span>');<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id">xs</span>, <span class="id">es</span>').<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabExpressions">ElabExpressions</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="ElabDeclaration">ElabDeclaration</a></span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="ElabDeclaration.nenv">nenv</a></span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>))).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="err_incoherent_clock">err_incoherent_clock</a></span> (<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">x</span>: <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">The</span> <span class="id">declared</span> <span class="id">clock</span> <span class="id">of</span> " :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> " <span class="kwd">is</span> <span class="id">incoherent</span> <span class="kwd">with</span> <span class="id">the</span> <span class="id">other</span> <span class="id">declarations</span>").<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="assert_preclock">assert_preclock</a></span> (<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">x</span>: <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">pck</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#clock">LustreAst.clock</a></span>) (<span class="id">ck</span>: <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#pck">pck</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#ck">ck</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#BASE">BASE</a></span>, <span class="id"><a href="Velus.ClockDefs.html#Cbase">Cbase</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#ON">ON</a></span> <span class="id">pck</span>' <span class="id">py</span> <span class="id">pb</span>, <span class="id"><a href="Velus.ClockDefs.html#Con">Con</a></span> <span class="id">ck</span>' <span class="id">y</span> <span class="id">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">py</span> ==<span class="id">b</span> <span class="id">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="kwd">if</span> <span class="id">pb</span> ==<span class="id">b</span> <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#assert_preclock">assert_preclock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> <span class="id">pck</span>' <span class="id">ck</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#err_incoherent_clock">err_incoherent_clock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#err_incoherent_clock">err_incoherent_clock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_incoherent_clock">err_incoherent_clock</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="elab_var_decls_pass">elab_var_decls_pass</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">acc</span>: <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#type_name">type_name</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#preclock">preclock</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vds</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#type_name">type_name</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#preclock">preclock</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#type_name">type_name</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#preclock">preclock</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>))) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#vds">vds</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#acc">acc</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id">x</span>, (<span class="id">sty</span>, <span class="id">pck</span>, <span class="id">loc</span>)) <span class="kwd">as</span> <span class="id">vd</span> :: <span class="id">vds</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">env</span>, <span class="id">notdone</span>) := <span class="id"><a href="Velus.Lustre.LustreElab.html#acc">acc</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">pck</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#FULLCK">FULLCK</a></span> <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#BASE">BASE</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Environment.html#Env.mem">Env.mem</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#env">env</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id">loc</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">x</span> :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> " <span class="kwd">is</span> <span class="id">declared</span> <span class="id">more</span> <span class="id">than</span> <span class="id">once</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_var_decls_pass">elab_var_decls_pass</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#elab_type">elab_type</a></span> <span class="id">sty</span>, <span class="id"><a href="Velus.ClockDefs.html#Cbase">Cbase</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#env">env</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#notdone">notdone</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#vds">vds</a></span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#FULLCK">FULLCK</a></span> (<span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#ON">ON</a></span> <span class="id">cy</span>' <span class="id">y</span> <span class="id">b</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">y</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#env">env</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_var_decls_pass">elab_var_decls_pass</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#env">env</a></span>, <span class="id">vd</span> :: <span class="id"><a href="Velus.Lustre.LustreElab.html#notdone">notdone</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#vds">vds</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">yt</span>, <span class="id">cy</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Environment.html#Env.mem">Env.mem</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#env">env</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id">loc</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">x</span> :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> " <span class="kwd">is</span> <span class="id">declared</span> <span class="id">more</span> <span class="id">than</span> <span class="id">once</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#assert_id_type">assert_id_type</a></span> <span class="id">loc</span> <span class="id">y</span> <span class="id">yt</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.bool_type">bool_type</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#assert_preclock">assert_preclock</a></span> <span class="id">loc</span> <span class="id">x</span> <span class="id">cy</span>' <span class="id">cy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#elab_var_decls_pass">elab_var_decls_pass</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#elab_type">elab_type</a></span> <span class="id">sty</span>, <span class="id"><a href="Velus.ClockDefs.html#Con">Con</a></span> <span class="id">cy</span> <span class="id">y</span> <span class="id">b</span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#env">env</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#notdone">notdone</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#vds">vds</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#WHENCK">WHENCK</a></span> <span class="id">y</span> <span class="id">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">y</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#env">env</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_var_decls_pass">elab_var_decls_pass</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#env">env</a></span>, <span class="id">vd</span> :: <span class="id"><a href="Velus.Lustre.LustreElab.html#notdone">notdone</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#vds">vds</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">yt</span>, <span class="id">cy</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Environment.html#Env.mem">Env.mem</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#env">env</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id">loc</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">x</span> :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> " <span class="kwd">is</span> <span class="id">declared</span> <span class="id">more</span> <span class="id">than</span> <span class="id">once</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#assert_id_type">assert_id_type</a></span> <span class="id">loc</span> <span class="id">y</span> <span class="id">yt</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.bool_type">bool_type</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#elab_var_decls_pass">elab_var_decls_pass</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#elab_type">elab_type</a></span> <span class="id">sty</span>, <span class="id"><a href="Velus.ClockDefs.html#Con">Con</a></span> <span class="id">cy</span> <span class="id">y</span> <span class="id">b</span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#env">env</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#notdone">notdone</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#vds">vds</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">elab_var_decls</span>' {<span class="id">A</span>: <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">loc</span> : <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fuel</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#A">A</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">env</span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vds</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#type_name">type_name</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#preclock">preclock</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#vds">vds</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#env">env</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#fuel">fuel</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">incoherent</span> <span class="id">or</span> <span class="id">cyclic</span> <span class="id">clocks</span>: "<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id"><a href="Velus.Lustre.LustreElab.html#msg_ident_list">msg_ident_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#vds">vds</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> :: <span class="id">fuel</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">env</span>', <span class="id">notdone</span>) &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_var_decls_pass">elab_var_decls_pass</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#env">env</a></span>, []) <span class="id"><a href="Velus.Lustre.LustreElab.html#vds">vds</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">elab_var_decls</span>' <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> <span class="id">fuel</span>' <span class="id">env</span>' <span class="id"><a href="Velus.Lustre.LustreElab.html#notdone">notdone</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="elab_var_decls">elab_var_decls</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">env</span>: <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vds</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#type_name">type_name</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#preclock">preclock</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">elab_var_decls</span>' <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#vds">vds</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#vds">vds</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="annotate">annotate</a></span> {<span class="id">A</span>: <span class="kwd">Type</span>} (<span class="id">env</span>: <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#A">A</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vd</span>: <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#type_name">type_name</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#preclock">preclock</a></span> * <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>)) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#A">A</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">x</span>, (<span class="id">sty</span>, <span class="id">pck</span>, <span class="id">loc</span>)) := <span class="id"><a href="Velus.Lustre.LustreElab.html#vd">vd</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#env">env</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#error">error</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">internal</span> <span class="id">error</span> (<span class="id">annotate</span>)")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">a</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id">x</span>, <span class="id">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="nameset">nameset</a></span> {<span class="id">A</span>: <span class="kwd">Type</span>} <span class="id">s</span> (<span class="id">xs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#A">A</a></span>)) : <span class="id"><a href="Velus.Common.CommonPS.html#PS.t">PS.t</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">List.fold_left</a></span> (<span class="kwd">fun</span> <span class="id">acc</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.add">PS.add</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#acc">acc</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#xs">xs</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#s">s</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="nameset_spec">nameset_spec</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span>: <span class="kwd">Type</span>} <span class="id">x</span> (<span class="id">xs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#A">A</a></span>)) <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#nameset">nameset</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#s">s</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xs">xs</a></span>) &lt;-&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#s">s</a></span> \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xs">xs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</div>
<div class="proofscript" id="proof10">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xs</span> <span class="kwd">as</span> [|<span class="id">yv</span> <span class="id">xs</span> <span class="id">IH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">yv</span> <span class="kwd">as</span> (<span class="id">y</span> &amp; <span class="id">v</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">IH</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> [<span class="id">HH</span>|]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSP.FM.add_iff">PSP.FM.add_iff</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSP.FM.add_iff">PSP.FM.add_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="check_defined">check_defined</a></span> (<span class="id">loc</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#astloc">astloc</a></span>) (<span class="id">defd</span>: <span class="id"><a href="Velus.Common.CommonPS.html#PS.t">PS.t</a></span>) (<span class="id">eqs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#equation">equation</a></span>) : <span class="id"><a href="Velus.Lustre.LustreElab.html#Elab">Elab</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">defd</span>' := <span class="id"><a href="Velus.Lustre.LustreElab.html#vars_defined">vars_defined</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eqs">eqs</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Common.Common.html#check_nodup">check_nodup</a></span> <span class="id">defd</span>' <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">defd</span>' := <span class="id"><a href="Velus.Common.CommonPS.html#ps_from_list">ps_from_list</a></span> <span class="id">defd</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.equal">PS.equal</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#defd">defd</a></span> <span class="id">defd</span>' <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">Missing</span> <span class="id">or</span> <span class="id">too</span> <span class="id">many</span> <span class="id">variables</span> <span class="id">defined</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">Duplicate</span> <span class="kwd">in</span> <span class="id">vars</span> <span class="id">defined</span>").<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="check_defined_spec">check_defined_spec</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">eqs</span> <span class="id">loc</span> <span class="id">defd</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#check_defined">check_defined</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#defd">defd</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eqs">eqs</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st">st</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#vars_defined">vars_defined</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eqs">eqs</a></span>) &lt;-&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#defd">defd</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#vars_defined">vars_defined</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eqs">eqs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</div>
<div class="proofscript" id="proof11">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#check_defined">check_defined</a></span> <span class="kwd">in</span> <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#check_nodup">check_nodup</a></span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hndup</span>. 2:<span class="id">inv</span> <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#check_nodup_correct">check_nodup_correct</a></span> <span class="kwd">in</span> <span class="id">Hndup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.equal">PS.equal</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hpseq</span>. 2:<span class="id">inv</span> <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSF.equal_2">PSF.equal_2</a></span> <span class="kwd">in</span> <span class="id">Hpseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span>. <span class="tactic">rewrite</span> (<span class="id">Hpseq</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_from_list_In">ps_from_list_In</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="check_nodupanon">check_nodupanon</a></span> <span class="id">loc</span> (<span class="id">xin</span> <span class="id">xvar</span> <span class="id">xout</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>))) (<span class="id">eqs</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#equation">equation</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Common.Common.html#check_nodup">check_nodup</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#idents">Syn.idents</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#xin">xin</a></span>++<span class="id"><a href="Velus.Lustre.LustreElab.html#xvar">xvar</a></span>++<span class="id"><a href="Velus.Lustre.LustreElab.html#xout">xout</a></span>++<span class="id"><a href="Velus.Lustre.LustreElab.html#anon_in_eqs">anon_in_eqs</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eqs">eqs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">Duplicate</span> <span class="kwd">in</span> <span class="id">input</span>, <span class="id">vars</span> <span class="id">and</span> <span class="id">outputs</span> <span class="id">of</span> <span class="id">node</span>").<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="check_nodupanon_spec">check_nodupanon_spec</a></span> : <span class="kwd">forall</span> <span class="id">loc</span> <span class="id">xin</span> <span class="id">xvar</span> <span class="id">xout</span> <span class="id">eqs</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#check_nodupanon">check_nodupanon</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xin">xin</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xvar">xvar</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xout">xout</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eqs">eqs</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st">st</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#xin">xin</a></span> ++ <span class="id"><a href="Velus.Lustre.LustreElab.html#xvar">xvar</a></span> ++ <span class="id"><a href="Velus.Lustre.LustreElab.html#xout">xout</a></span> ++ <span class="id"><a href="Velus.Lustre.LustreElab.html#anon_in_eqs">anon_in_eqs</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eqs">eqs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</div>
<div class="proofscript" id="proof12">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#check_nodupanon">check_nodupanon</a></span> <span class="kwd">in</span> <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#check_nodup">check_nodup</a></span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hndup</span>. 2:<span class="id">inv</span> <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#check_nodup_correct">check_nodup_correct</a></span> <span class="kwd">in</span> <span class="id">Hndup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="check_atom">check_atom</a></span> <span class="id">loc</span> <span class="id">name</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Ident.html#Ids.is_atom">is_atom</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#name">name</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#name">name</a></span> :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> " <span class="id">should</span> <span class="id">be</span> <span class="id">an</span> <span class="id">atom</span>" :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="check_atom_spec">check_atom_spec</a></span> : <span class="kwd">forall</span> <span class="id">loc</span> <span class="id">name</span> <span class="id">st</span> <span class="id">res</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#check_atom">check_atom</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#name">name</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st">st</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#res">res</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Ident.html#Ids.atom">atom</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#name">name</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</div>
<div class="proofscript" id="proof13">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#check_atom">check_atom</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Velus.Ident.html#Ids.is_atom">is_atom</a></span> <span class="id">eqn</span>:<span class="id">Hat</span>; <span class="id">inv</span> <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Ident.html#Ids.is_atom_spec">is_atom_spec</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
<h3> The anons are prefixed by `elab` </h3>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">monadInv</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#err_not_singleton">err_not_singleton</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#error">error</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">_</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> <span class="id">_</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="Velus.Lustre.LustreElab.html#bind">bind</a></span> ?<span class="id">x</span> ?<span class="id">f</span> ?<span class="id">st</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (?<span class="id">res</span>, ?<span class="id">st</span>') |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H1</span> := <span class="tactic">fresh</span> "<span class="id">Hbind</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H2</span> := <span class="tactic">fresh</span> "<span class="id">Hbind</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#bind_inv">bind_inv</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> [? [? [<span class="id">H1</span> <span class="id">H2</span>]]]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="Velus.Lustre.LustreElab.html#bind2">bind2</a></span> ?<span class="id">x</span> ?<span class="id">f</span> ?<span class="id">st</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (?<span class="id">res</span>, ?<span class="id">st</span>') |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H1</span> := <span class="tactic">fresh</span> "<span class="id">Hbind</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H2</span> := <span class="tactic">fresh</span> "<span class="id">Hbind</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#bind2_inv">bind2_inv</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> [? [? [? [<span class="id">H1</span> <span class="id">H2</span>]]]]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Ltac</span> <span class="id">destruct_to_singl</span> <span class="id">l</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>; [|<span class="tactic">destruct</span> <span class="id">l</span>]; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="elab_prefs">elab_prefs</a></span> := <span class="id"><a href="Velus.Common.CommonPS.html#PS.singleton">PS.singleton</a></span> <span class="id"><a href="Velus.Ident.html#Ids.elab">elab</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id">instantiating_subst_AtomOrGensym</span>' : <span class="kwd">forall</span> {<span class="id">typ</span>} (<span class="id">xs</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.LustreElab.html#typ">typ</a></span>)) <span class="id">sub</span> <span class="id">st1</span> <span class="id">st2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">ty</span>) =&gt; <span class="tactic">do</span> <span class="id">x</span>' &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ident">fresh_ident</a></span>; <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span>, <span class="id">x</span>')) <span class="id"><a href="Velus.Lustre.LustreElab.html#xs">xs</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st1">st1</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#sub">sub</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#st2">st2</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">x</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span>, <span class="id">x</span>') <span class="id"><a href="Velus.Lustre.LustreElab.html#sub">sub</a></span> -&gt; <span class="id"><a href="Velus.Ident.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_prefs">elab_prefs</a></span> <span class="id">x</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</div>
<div class="proofscript" id="proof14">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xs</span> <span class="kwd">as</span> [|(?&amp;?) ?]; <span class="tactic">intros</span> * <span class="id">Hmmap</span> * <span class="id">Hin</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>; <span class="id">inv</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ident">fresh_ident</a></span> <span class="kwd">in</span> <span class="id">Hbind0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">st1</span> <span class="kwd">as</span> ((?&amp;?)&amp;?); <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>. <span class="tactic">exists</span> <span class="id"><a href="Velus.Ident.html#Ids.elab">elab</a></span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSF.singleton_2">PSF.singleton_2</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHxs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="instantiating_subst_AtomOrGensym">instantiating_subst_AtomOrGensym</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">sub</span> <span class="id">st1</span> <span class="id">st2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#instantiating_subst">instantiating_subst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xs">xs</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st1">st1</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#sub">sub</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#st2">st2</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">x</span>', <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#x">x</a></span> <span class="id">x</span>' <span class="id"><a href="Velus.Lustre.LustreElab.html#sub">sub</a></span> -&gt; <span class="id"><a href="Velus.Ident.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_prefs">elab_prefs</a></span> <span class="id">x</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</div>
<div class="proofscript" id="proof15">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#instantiating_subst">instantiating_subst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hinst</span> * <span class="id">Hmap</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.from_list_find_In">Env.from_list_find_In</a></span> <span class="kwd">in</span> <span class="id">Hmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">instantiating_subst_AtomOrGensym</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="anon_streams_AtomOrGensym">anon_streams_AtomOrGensym</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">base</span> <span class="id">loc</span> <span class="id">sub</span> <span class="id">anns</span> <span class="id">anns</span>' <span class="id">anns</span>'' <span class="id">st0</span> <span class="id">st0</span>' <span class="id">st1</span> <span class="id">st2</span> <span class="id">st3</span> <span class="id">st4</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#instantiating_subst">instantiating_subst</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xs">xs</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st0">st0</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#sub">sub</a></span>, <span class="id">st0</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#inst_annot">inst_annot</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#Svar">Svar</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#base">base</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#sub">sub</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#Vnm">Vnm</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#anns">anns</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st1">st1</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id">anns</span>', <span class="id"><a href="Velus.Lustre.LustreElab.html#st2">st2</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_ann">freeze_ann</a></span> <span class="id">anns</span>' <span class="id"><a href="Velus.Lustre.LustreElab.html#st3">st3</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id">anns</span>'', <span class="id"><a href="Velus.Lustre.LustreElab.html#st4">st4</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_prefs">elab_prefs</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#anon_streams">Syn.anon_streams</a></span> <span class="id">anns</span>'')).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</div>
<div class="proofscript" id="proof16">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">anns</span>; <span class="tactic">intros</span> * <span class="id">Hsub</span> <span class="id">Hinst</span> <span class="id">Hfreeze</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x2</span> <span class="kwd">as</span> (?&amp;?&amp;[?|]); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">Hbind1</span> <span class="id">Hbind3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hfind</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_ident">freeze_ident</a></span> <span class="kwd">in</span> <span class="id">Hbind</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#instantiating_subst_AtomOrGensym">instantiating_subst_AtomOrGensym</a></span> <span class="kwd">in</span> <span class="id">Hsub</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id">fresh_ins_AtomOrGensym</span>' : <span class="kwd">forall</span> <span class="id">G</span> <span class="id">vars</span> <span class="id">vars</span>' <span class="id">es</span> <span class="id">es</span>' <span class="id">es</span>'' <span class="id">st1</span> <span class="id">st2</span> <span class="id">st3</span> <span class="id">st4</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">forall</span> <span class="id">e</span>' <span class="id">loc</span> <span class="id">e</span>'' <span class="id">st1</span> <span class="id">st2</span> <span class="id">st3</span> <span class="id">st4</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#vars">vars</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st1">st1</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id">e</span>', <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#st2">st2</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exp">freeze_exp</a></span> <span class="id">vars</span>' <span class="id">e</span>' <span class="id"><a href="Velus.Lustre.LustreElab.html#st3">st3</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id">e</span>'', <span class="id"><a href="Velus.Lustre.LustreElab.html#st4">st4</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_prefs">elab_prefs</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_in">fresh_in</a></span> <span class="id">e</span>''))) <span class="id"><a href="Velus.Lustre.LustreElab.html#es">es</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#vars">vars</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#es">es</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st1">st1</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id">es</span>', <span class="id"><a href="Velus.Lustre.LustreElab.html#st2">st2</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exp">freeze_exp</a></span> <span class="id">vars</span>') (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">es</span>') <span class="id"><a href="Velus.Lustre.LustreElab.html#st3">st3</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id">es</span>'', <span class="id"><a href="Velus.Lustre.LustreElab.html#st4">st4</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_prefs">elab_prefs</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ins">fresh_ins</a></span> <span class="id">es</span>'')).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</div>
<div class="proofscript" id="proof17">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">es</span>; <span class="tactic">intros</span> * <span class="id">Hf</span> <span class="id">Helab</span> <span class="id">Hfreeze</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hf</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>; <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ins">fresh_ins</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">x</span>. <span class="tactic">eapply</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHes</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fresh_in_AtomOrGensym">fresh_in_AtomOrGensym</a></span> : <span class="kwd">forall</span> <span class="id">G</span> <span class="id">vars</span> <span class="id">vars</span>' <span class="id">e</span> <span class="id">e</span>' <span class="id">loc</span> <span class="id">e</span>'' <span class="id">st1</span> <span class="id">st2</span> <span class="id">st3</span> <span class="id">st4</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#vars">vars</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st1">st1</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> ((<span class="id">e</span>', <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span>), <span class="id"><a href="Velus.Lustre.LustreElab.html#st2">st2</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exp">freeze_exp</a></span> <span class="id">vars</span>' <span class="id">e</span>' <span class="id"><a href="Velus.Lustre.LustreElab.html#st3">st3</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id">e</span>'', <span class="id"><a href="Velus.Lustre.LustreElab.html#st4">st4</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_prefs">elab_prefs</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_in">fresh_in</a></span> <span class="id">e</span>'')).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</div>
<div class="proofscript" id="proof18">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#expression_ind2">expression_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Helab</span> <span class="id">Hfreeze</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;unop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_to_singl</span> <span class="id">es</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;binop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_to_singl</span> <span class="id">es1</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_to_singl</span> <span class="id">es2</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;ite&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_to_singl</span> <span class="id">es</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>. <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">fresh_ins_AtomOrGensym</span>' <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">fresh_ins_AtomOrGensym</span>' <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;cast&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_to_singl</span> <span class="id">es</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;app&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_to_singl</span> <span class="id">r</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id">fresh_ins_AtomOrGensym</span>' <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#anon_streams_AtomOrGensym">anon_streams_AtomOrGensym</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">fresh_ins_AtomOrGensym</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#anon_streams_AtomOrGensym">anon_streams_AtomOrGensym</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;constant&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hbind1</span>. <span class="id">revert</span> <span class="id">loc</span> <span class="id">e</span>'' <span class="id">x1</span> <span class="id">st4</span> <span class="id">Hbind1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x0</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">repeat</span> <span class="id">monadInv</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Environment.html#Env.mem">Env.mem</a></span> <span class="id">_</span> <span class="id">_</span>); <span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHx0</span> <span class="kwd">in</span> <span class="id">Hbind</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;var&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">monadInv</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;fby&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">fresh_ins_AtomOrGensym</span>' <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">fresh_ins_AtomOrGensym</span>' <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;arrow&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">fresh_ins_AtomOrGensym</span>' <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">fresh_ins_AtomOrGensym</span>' <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;when&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">fresh_ins_AtomOrGensym</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;merge&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">fresh_ins_AtomOrGensym</span>' <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">fresh_ins_AtomOrGensym</span>' <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="fresh_ins_AtomOrGensym">fresh_ins_AtomOrGensym</a></span> : <span class="kwd">forall</span> <span class="id">G</span> <span class="id">vars</span> <span class="id">vars</span>' <span class="id">es</span> <span class="id">es</span>' <span class="id">es</span>'' <span class="id">st1</span> <span class="id">st2</span> <span class="id">st3</span> <span class="id">st4</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#vars">vars</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#es">es</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st1">st1</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id">es</span>', <span class="id"><a href="Velus.Lustre.LustreElab.html#st2">st2</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exp">freeze_exp</a></span> <span class="id">vars</span>') (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">es</span>') <span class="id"><a href="Velus.Lustre.LustreElab.html#st3">st3</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id">es</span>'', <span class="id"><a href="Velus.Lustre.LustreElab.html#st4">st4</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_prefs">elab_prefs</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ins">fresh_ins</a></span> <span class="id">es</span>'')).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</div>
<div class="proofscript" id="proof19">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Helab</span> <span class="id">Hfreeze</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">fresh_ins_AtomOrGensym</span>'; [|<span class="tactic">eauto</span>|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>. <span class="tactic">intros</span> * <span class="id">_</span> * ??.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_in_AtomOrGensym">fresh_in_AtomOrGensym</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">fresh_in_AtomOrGensym</span> <span class="id">fresh_ins_AtomOrGensym</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="anon_in_AtomOrGensym">anon_in_AtomOrGensym</a></span> : <span class="kwd">forall</span> <span class="id">G</span> <span class="id">vars</span> <span class="id">vars</span>' <span class="id">e</span> <span class="id">e</span>' <span class="id">loc</span> <span class="id">e</span>'' <span class="id">st1</span> <span class="id">st2</span> <span class="id">st3</span> <span class="id">st4</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#vars">vars</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#e">e</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st1">st1</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> ((<span class="id">e</span>', <span class="id"><a href="Velus.Lustre.LustreElab.html#loc">loc</a></span>), <span class="id"><a href="Velus.Lustre.LustreElab.html#st2">st2</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exp">freeze_exp</a></span> <span class="id">vars</span>' <span class="id">e</span>' <span class="id"><a href="Velus.Lustre.LustreElab.html#st3">st3</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id">e</span>'', <span class="id"><a href="Velus.Lustre.LustreElab.html#st4">st4</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_prefs">elab_prefs</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#anon_in">anon_in</a></span> <span class="id">e</span>'')).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</div>
<div class="proofscript" id="proof20">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">intros</span> * <span class="id">Helab</span> <span class="id">Hfreeze</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;unop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_to_singl</span> <span class="id">l</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;binop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_to_singl</span> <span class="id">l</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_to_singl</span> <span class="id">l0</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;ite&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_to_singl</span> <span class="id">l</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>. <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ins_AtomOrGensym">fresh_ins_AtomOrGensym</a></span> <span class="kwd">in</span> <span class="id">Hbind7</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ins_AtomOrGensym">fresh_ins_AtomOrGensym</a></span> <span class="kwd">in</span> <span class="id">Hbind6</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;cast&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_to_singl</span> <span class="id">l</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;app&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_to_singl</span> <span class="id">l0</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;constant&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_incl">Forall_incl</a></span>; [|<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#incl_map">incl_map</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#anon_in_fresh_in">anon_in_fresh_in</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hbind1</span>. <span class="id">revert</span> <span class="id">loc</span> <span class="id">e</span>'' <span class="id">x1</span> <span class="id">st4</span> <span class="id">Hbind1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x0</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">repeat</span> <span class="id">monadInv</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Environment.html#Env.mem">Env.mem</a></span> <span class="id">_</span> <span class="id">_</span>); <span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHx0</span> <span class="kwd">in</span> <span class="id">Hbind</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;var&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">monadInv</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;fby&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ins_AtomOrGensym">fresh_ins_AtomOrGensym</a></span> <span class="kwd">in</span> <span class="id">Hbind3</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ins_AtomOrGensym">fresh_ins_AtomOrGensym</a></span> <span class="kwd">in</span> <span class="id">Hbind5</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;arrow&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ins_AtomOrGensym">fresh_ins_AtomOrGensym</a></span> <span class="kwd">in</span> <span class="id">Hbind3</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ins_AtomOrGensym">fresh_ins_AtomOrGensym</a></span> <span class="kwd">in</span> <span class="id">Hbind5</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;when&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ins_AtomOrGensym">fresh_ins_AtomOrGensym</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;merge&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ins_AtomOrGensym">fresh_ins_AtomOrGensym</a></span> <span class="kwd">in</span> <span class="id">Hbind4</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#fresh_ins_AtomOrGensym">fresh_ins_AtomOrGensym</a></span> <span class="kwd">in</span> <span class="id">Hbind6</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="anon_ins_AtomOrGensym">anon_ins_AtomOrGensym</a></span> : <span class="kwd">forall</span> <span class="id">G</span> <span class="id">vars</span> <span class="id">vars</span>' <span class="id">es</span> <span class="id">es</span>' <span class="id">es</span>'' <span class="id">st1</span> <span class="id">st2</span> <span class="id">st3</span> <span class="id">st4</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#elab_exp">elab_exp</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#vars">vars</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#es">es</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st1">st1</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id">es</span>', <span class="id"><a href="Velus.Lustre.LustreElab.html#st2">st2</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#freeze_exp">freeze_exp</a></span> <span class="id">vars</span>') (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">es</span>') <span class="id"><a href="Velus.Lustre.LustreElab.html#st3">st3</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id">es</span>'', <span class="id"><a href="Velus.Lustre.LustreElab.html#st4">st4</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_prefs">elab_prefs</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#anon_ins">anon_ins</a></span> <span class="id">es</span>'')).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</div>
<div class="proofscript" id="proof21">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">es</span>; <span class="tactic">intros</span> * <span class="id">Helab</span> <span class="id">Hfreeze</span>; <span class="tactic">repeat</span> <span class="id">monadInv</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#anon_ins">anon_ins</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">x</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#anon_in_AtomOrGensym">anon_in_AtomOrGensym</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHes</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="anon_in_eq_AtomOrGensym">anon_in_eq_AtomOrGensym</a></span> : <span class="kwd">forall</span> <span class="id">G</span> <span class="id">vars</span> <span class="id">eq</span> <span class="id">st</span> <span class="id">eq</span>' <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#elab_equation">elab_equation</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#vars">vars</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eq">eq</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st">st</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id">eq</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_prefs">elab_prefs</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#anon_in_eq">anon_in_eq</a></span> <span class="id">eq</span>')).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</div>
<div class="proofscript" id="proof22">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?? ((<span class="id">xs</span>&amp;<span class="id">es</span>)&amp;<span class="id">loc</span>) * <span class="id">Helab</span>; <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#anon_in_eq">anon_in_eq</a></span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">monadInv</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#anon_ins_AtomOrGensym">anon_ins_AtomOrGensym</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="anon_in_eqs_AtomOrGensym">anon_in_eqs_AtomOrGensym</a></span> : <span class="kwd">forall</span> <span class="id">G</span> <span class="id">vars</span> <span class="id">eqs</span> <span class="id">st</span> <span class="id">eqs</span>' <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#elab_equation">elab_equation</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#vars">vars</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#eqs">eqs</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#st">st</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id">eqs</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_prefs">elab_prefs</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#anon_in_eqs">anon_in_eqs</a></span> <span class="id">eqs</span>')).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</div>
<div class="proofscript" id="proof23">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">eqs</span>; <span class="tactic">intros</span> * <span class="id">Hmmap</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">repeat</span> <span class="id">monadInv</span>; <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#anon_in_eqs">anon_in_eqs</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#anon_in_eq_AtomOrGensym">anon_in_eq_AtomOrGensym</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHeqs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Obligation</span> <span class="kwd">Tactic</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Tactics.program_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id">_</span> = <span class="id"><a href="Velus.Lustre.LustreElab.html#bind">bind</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">monadInv</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">progress</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:(<span class="kwd">if</span> ?<span class="id">b</span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span>) <span class="id">_</span> = <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Hb</span> := <span class="tactic">fresh</span> "<span class="id">Hb</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span> <span class="id">eqn</span>:<span class="id">Hb</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="elab_declaration">elab_declaration</a></span> (<span class="id">decl</span>: <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#declaration">declaration</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#res">res</a></span> {<span class="id">n</span> | <span class="id"><a href="Velus.Lustre.LustreElab.html#n_prefixes">n_prefixes</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#n">n</a></span> = <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_prefs">elab_prefs</a></span>} :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#decl">decl</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#NODE">NODE</a></span> <span class="id">name</span> <span class="id">hasstate</span> <span class="id">inputs</span> <span class="id">outputs</span> <span class="id">locals</span> <span class="id">equations</span> <span class="id">loc</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="tactic">do</span> <span class="id">env_in</span>  &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_var_decls">elab_var_decls</a></span> <span class="id">loc</span> (<span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id">_</span>) <span class="id">inputs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">env_out</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_var_decls">elab_var_decls</a></span> <span class="id">loc</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#env_in">env_in</a></span> <span class="id">outputs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">env</span>     &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_var_decls">elab_var_decls</a></span> <span class="id">loc</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#env_out">env_out</a></span> <span class="id">locals</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">xin</span>     &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#annotate">annotate</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#env_in">env_in</a></span>) <span class="id">inputs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">xout</span>    &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#annotate">annotate</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#env_out">env_out</a></span>) <span class="id">outputs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">xvar</span>    &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#annotate">annotate</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#env">env</a></span>) <span class="id">locals</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">eqs</span>     &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#elab_equation">elab_equation</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#env">env</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabDeclaration.nenv">nenv</a></span>) <span class="id">equations</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span>       &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#check_nodupanon">check_nodupanon</a></span> <span class="id">loc</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xin">xin</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xvar">xvar</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xout">xout</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#eqs">eqs</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span>       &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#check_defined">check_defined</a></span> <span class="id">loc</span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#nameset">nameset</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#nameset">nameset</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xvar">xvar</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#xout">xout</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#eqs">eqs</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span>       &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#check_atom">check_atom</a></span> <span class="id">loc</span> <span class="id">name</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span>       &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#check_atom">check_atom</a></span> <span class="id">loc</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#xin">xin</a></span> ++ <span class="id"><a href="Velus.Lustre.LustreElab.html#xvar">xvar</a></span> ++ <span class="id"><a href="Velus.Lustre.LustreElab.html#xout">xout</a></span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xin">xin</a></span> ==<span class="id">b</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>) || (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#xout">xout</a></span> ==<span class="id">b</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#err_loc">err_loc</a></span> <span class="id">loc</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">not</span> <span class="id">enough</span> <span class="id">inputs</span> <span class="id">or</span> <span class="id">outputs</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ret">ret</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#xin">xin</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#xout">xout</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#xvar">xvar</a></span>, <span class="id"><a href="Velus.Lustre.LustreElab.html#eqs">eqs</a></span>)) <span class="id"><a href="Velus.Lustre.LustreElab.html#init_state">init_state</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> ((<span class="id">xin</span>, <span class="id">xout</span>, <span class="id">xvar</span>, <span class="id">eqs</span>), ((<span class="id">nfui</span>, <span class="id">_</span>), <span class="id">_</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> {| <span class="id"><a href="Velus.Lustre.LustreElab.html#mk_node">n_name</a></span>     := <span class="id">name</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n_hasstate</span> := <span class="id">hasstate</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n_in</span>       := <span class="id">xin</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n_out</span>      := <span class="id">xout</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n_vars</span>     := <span class="id">xvar</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n_eqs</span>      := <span class="id">eqs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n_prefixes</span> := <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_prefs">elab_prefs</a></span> |} <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof24')">Next Obligation.</div>
<div class="proofscript" id="proof24">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;0&nbsp;&lt;&nbsp;length&nbsp;xin&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_false_iff">Bool.orb_false_iff</a></span> <span class="kwd">in</span> <span class="id">Hb</span>; <span class="tactic">destruct</span> <span class="id">Hb</span> <span class="kwd">as</span> (<span class="id">Hin</span> &amp; <span class="id">Hout</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#not_equiv_decb_equiv">not_equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.neq_0_lt_0">Nat.neq_0_lt_0</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="toggleproof" onclick="toggleDisplay('proof25')">Next Obligation.</div>
<div class="proofscript" id="proof25">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;0&nbsp;&lt;&nbsp;length&nbsp;xout&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_false_iff">Bool.orb_false_iff</a></span> <span class="kwd">in</span> <span class="id">Hb</span>; <span class="tactic">destruct</span> <span class="id">Hb</span> <span class="kwd">as</span> (<span class="id">Hin</span> &amp; <span class="id">Hout</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#not_equiv_decb_equiv">not_equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Hout</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.neq_0_lt_0">Nat.neq_0_lt_0</a></span> <span class="kwd">in</span> <span class="id">Hout</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="toggleproof" onclick="toggleDisplay('proof26')">Next Obligation.</div>
<div class="proofscript" id="proof26">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Permutation&nbsp;(map&nbsp;var_defined&nbsp;eqs)&nbsp;(map&nbsp;fst&nbsp;(xvar&nbsp;++&nbsp;xout))&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#check_nodupanon_spec">check_nodupanon_spec</a></span> <span class="kwd">in</span> <span class="id">Hbind6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#check_defined_spec">check_defined_spec</a></span> <span class="kwd">in</span> <span class="id">Hbind7</span> <span class="kwd">as</span> [<span class="id">Hdefd</span> <span class="id">Hnodup</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#NoDup_Permutation">NoDup_Permutation</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_app_r">NoDupMembers_app_r</a></span> <span class="kwd">in</span> <span class="id">Hbind6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> <span class="id">Hbind6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_app_l">NoDupMembers_app_l</a></span> <span class="kwd">in</span> <span class="id">Hbind6</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> ?. <span class="tactic">rewrite</span> <span class="id">Hdefd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#nameset_spec">nameset_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">intros</span> [[?|?]|?] | <span class="tactic">intros</span> [?|?]]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#not_In_empty">not_In_empty</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="toggleproof" onclick="toggleDisplay('proof27')">Next Obligation.</div>
<div class="proofscript" id="proof27">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;NoDupMembers&nbsp;(xin&nbsp;++&nbsp;xlocal&nbsp;++&nbsp;xout&nbsp;++&nbsp;anon_in_eqs&nbsp;eqs)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#check_nodupanon_spec">check_nodupanon_spec</a></span> <span class="kwd">in</span> <span class="id">Hbind6</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="toggleproof" onclick="toggleDisplay('proof28')">Next Obligation.</div>
<div class="proofscript" id="proof28">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Forall&nbsp;AtomNotReserved&nbsp;(xin&nbsp;++&nbsp;xvar&nbsp;++&nbsp;xout)&nbsp;/\&nbsp;atom&nbsp;name&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id">xin</span> ++ <span class="id">xvar</span> ++ <span class="id">xout</span> ++ <span class="id"><a href="Velus.Lustre.LustreElab.html#anon_in_eqs">anon_in_eqs</a></span> <span class="id">eqs</span>)) <span class="kwd">with</span> ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id">xin</span> ++ <span class="id">xvar</span> ++ <span class="id">xout</span>) ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.LustreElab.html#anon_in_eqs">anon_in_eqs</a></span> <span class="id">eqs</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>. <span class="tactic">repeat</span> <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">clear</span> - <span class="id">Hbind5</span> <span class="id">Hbind9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">nfui</span> <span class="id">wildcard</span>' <span class="id">wildcard</span>'0 <span class="id">x18</span> <span class="id">x19</span> <span class="id">Hbind9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id">xin</span> ++ <span class="id">xvar</span> ++ <span class="id">xout</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">monadInv</span>. <span class="tactic">destruct</span> <span class="id">a</span> <span class="kwd">as</span> (?&amp;?). <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#check_atom_spec">check_atom_spec</a></span> <span class="kwd">in</span> <span class="id">Hbind</span>; <span class="tactic">left</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#anon_in_eqs_AtomOrGensym">anon_in_eqs_AtomOrGensym</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#check_atom_spec">check_atom_spec</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabDeclaration">ElabDeclaration</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="ElabDeclarations">ElabDeclarations</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">error_monad_scope</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">elab_declarations</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">G</span>: <span class="id"><a href="Velus.Lustre.LustreElab.html#global">global</a></span>) (<span class="id">nenv</span>: <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span> * <span class="id"><a href="Velus.ClockDefs.html#clock">clock</a></span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">decls</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#declaration">declaration</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#global">global</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#decls">decls</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [] =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span><br/>
&nbsp;&nbsp;| <span class="id">d</span> :: <span class="id">ds</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">n</span> &lt;- <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_declaration">elab_declaration</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#nenv">nenv</a></span> <span class="id">d</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">n</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#n">n</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">elab_declarations</span>' (<span class="id"><a href="Velus.Lustre.LustreElab.html#n">n</a></span> :: <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span>) (<span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#n">n</a></span>.(<span class="id"><a href="Velus.Lustre.LustreElab.html#n_name">n_name</a></span>) (<span class="id"><a href="Velus.Lustre.LustreElab.html#n">n</a></span>.(<span class="id"><a href="Velus.Lustre.LustreElab.html#n_in">n_in</a></span>), <span class="id"><a href="Velus.Lustre.LustreElab.html#n">n</a></span>.(<span class="id"><a href="Velus.Lustre.LustreElab.html#n_out">n_out</a></span>)) <span class="id"><a href="Velus.Lustre.LustreElab.html#nenv">nenv</a></span>) <span class="id">ds</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id">elab_declarations</span>'<span class="id">_prefixes</span> : <span class="kwd">forall</span> <span class="id">decls</span> <span class="id">accG</span> <span class="id">accE</span> <span class="id">G</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#n_prefixes">n_prefixes</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#n">n</a></span> = <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_prefs">elab_prefs</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#accG">accG</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">elab_declarations</span>' <span class="id"><a href="Velus.Lustre.LustreElab.html#accG">accG</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#accE">accE</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#decls">decls</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="Velus.Lustre.LustreElab.html#n_prefixes">n_prefixes</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#n">n</a></span> = <span class="id"><a href="Velus.Lustre.LustreElab.html#elab_prefs">elab_prefs</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</div>
<div class="proofscript" id="proof29">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">decls</span>; <span class="tactic">intros</span> * <span class="id">Hacc</span> <span class="id">Helab</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">monadInv</span> <span class="id">Helab</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHdecls</span> <span class="kwd">in</span> <span class="id">EQ0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> (<span class="id">n</span>&amp;<span class="id">Hprefs</span>); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Import</span> <span class="id">Instantiator.L</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="elab_declarations">elab_declarations</a></span> (<span class="id">decls</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Parser.LustreAst.html#declaration">declaration</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#res">res</a></span> {<span class="id">G</span> | <span class="id"><a href="Velus.Instantiator.html#L.Typ.wt_global">wt_global</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span> /\ <span class="id"><a href="Velus.Instantiator.html#L.Clo.wc_global">wc_global</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="Velus.Instantiator.html#L.Syn.n_prefixes">n_prefixes</a></span> <span class="id"><a href="Velus.Lustre.LustreElab.html#n">n</a></span> = <span class="id"><a href="Velus.Instantiator.html#L.Norm.Norm.Unnesting.elab_prefs">elab_prefs</a></span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#G">G</a></span>} :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">elab_declarations</span>' [] (<span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id">_</span>) <span class="id"><a href="Velus.Lustre.LustreElab.html#decls">decls</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">G</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Instantiator.html#L.Typ.check_global">Typ.check_global</a></span> <span class="id">G</span>, <span class="id"><a href="Velus.Instantiator.html#L.Clo.check_global">Clo.check_global</a></span> <span class="id">G</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">G</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>, <span class="id">_</span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">Post</span>-<span class="id">elab</span> <span class="id">check</span> <span class="id">failed</span> (<span class="id">typing</span>)")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">Post</span>-<span class="id">elab</span> <span class="id">check</span> <span class="id">failed</span> (<span class="id">clocking</span>)")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> <span class="id">err</span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> <span class="id">err</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof30')">Next Obligation.</div>
<div class="proofscript" id="proof30">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">Heq_anonymous</span> <span class="id">into</span> <span class="id">Hwt</span>. <span class="tactic">rename</span> <span class="id">Heq_anonymous0</span> <span class="id">into</span> <span class="id">Hwc</span>. <span class="tactic">rename</span> <span class="id">Heq_anonymous1</span> <span class="id">into</span> <span class="id">Helab</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">Hwt</span>, <span class="id">Hwc</span>, <span class="id">Helab</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#L.Typ.check_global_correct">Typ.check_global_correct</a></span> <span class="kwd">in</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#L.Clo.check_global_correct">Clo.check_global_correct</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">elab_declarations</span>'<span class="id">_prefixes</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LustreElab.html#ElabDeclarations">ElabDeclarations</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
