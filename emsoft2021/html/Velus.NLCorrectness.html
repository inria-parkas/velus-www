
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module NLCorrectness</title>
<meta name="description" content="Documentation of Coq module NLCorrectness" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module NLCorrectness</h1>
<div class="coq">
<div class="doc">The old correctness lemma, starting from NLustre </div>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Ident.html">Ident</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.CoindStreams.html">CoindStreams</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Generation.html">ObcToClight.Generation</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Traces.html">Traces</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.ClightToAsm.html">ClightToAsm</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html">common.Errors</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html">common.Events</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Behaviors.html">common.Behaviors</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html">cfrontend.Clight</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.ClightBigstep.html">cfrontend.ClightBigstep</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html">lib.Integers</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html">driver.Compiler</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html">Interface</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Instantiator.html">Instantiator</a></span>.<br/>
<span class="kwd">Import</span> <span class="id">Stc.Syn</span>.<br/>
<span class="kwd">Import</span> <span class="id">NL</span>.<br/>
<span class="kwd">Import</span> <span class="id">Obc.Syn</span>.<br/>
<span class="kwd">Import</span> <span class="id">Obc.Sem</span>.<br/>
<span class="kwd">Import</span> <span class="id">Obc.Typ</span>.<br/>
<span class="kwd">Import</span> <span class="id">Obc.Equ</span>.<br/>
<span class="kwd">Import</span> <span class="id">Obc.Def</span>.<br/>
<span class="kwd">Import</span> <span class="id">Fusion</span>.<br/>
<span class="kwd">Import</span> <span class="id">Stc2ObcInvariants</span>.<br/>
<span class="kwd">Import</span> <span class="id">IStr</span>.<br/>
<span class="kwd">Import</span> <span class="id">CStr</span>.<br/>
<span class="kwd">Import</span> <span class="id">CIStr</span>.<br/>
<span class="kwd">Import</span> <span class="id">OpAux</span>.<br/>
<span class="kwd">Import</span> <span class="id">Op</span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Correctness.html">ObcToClight.Correctness</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.LustreElab.html">Lustre.LustreElab</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Import</span> <span class="id">List.ListNotations</span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.omega.Omega.html">Omega</a></span>.<br/>
<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">error_monad_scope</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">stream_scope</span>.<br/>
<br/>
<span class="kwd">Parameter</span> <span class="id"><a name="schedule">schedule</a></span>      : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Instantiator.html#Stc.Syn.trconstr">trconstr</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span>.<br/>
<span class="kwd">Parameter</span> <span class="id"><a name="print_nlustre">print_nlustre</a></span> : <span class="id"><a href="Velus.Instantiator.html#NL.Syn.global">global</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>.<br/>
<span class="kwd">Parameter</span> <span class="id"><a name="print_stc">print_stc</a></span>     : <span class="id"><a href="Velus.Instantiator.html#Stc.Syn.program">Stc.Syn.program</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>.<br/>
<span class="kwd">Parameter</span> <span class="id"><a name="print_sch">print_sch</a></span>     : <span class="id"><a href="Velus.Instantiator.html#Stc.Syn.program">Stc.Syn.program</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>.<br/>
<span class="kwd">Parameter</span> <span class="id"><a name="print_obc">print_obc</a></span>     : <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.program">Obc.Syn.program</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>.<br/>
<span class="kwd">Parameter</span> <span class="id"><a name="do_fusion">do_fusion</a></span>     : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>.<br/>
<span class="kwd">Parameter</span> <span class="id"><a name="do_sync">do_sync</a></span>       : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>.<br/>
<span class="kwd">Parameter</span> <span class="id"><a name="do_expose">do_expose</a></span>     : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="ExternalSchedule">ExternalSchedule</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="ExternalSchedule.schedule">schedule</a></span> := <span class="id"><a href="Velus.NLCorrectness.html#schedule">schedule</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.NLCorrectness.html#ExternalSchedule">ExternalSchedule</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="Scheduler">Scheduler</a></span> := <span class="id"><a href="Velus.Instantiator.html#Stc.Scheduler">Stc.Scheduler</a></span> <span class="id"><a href="Velus.NLCorrectness.html#ExternalSchedule">ExternalSchedule</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="is_well_sch_system">is_well_sch_system</a></span> (<span class="id">r</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span class="id">s</span>: <span class="id"><a href="Velus.Instantiator.html#Stc.Syn.system">system</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.NLCorrectness.html#r">r</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.NLCorrectness.html#s">s</a></span>.(<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.s_in">s_in</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mems</span> := <span class="id"><a href="Velus.Common.CommonPS.html#ps_from_list">ps_from_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.NLCorrectness.html#s">s</a></span>.(<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.s_lasts">s_lasts</a></span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Instantiator.html#Stc.Wdef.well_sch">Stc.Wdef.well_sch</a></span> <span class="id"><a href="Velus.NLCorrectness.html#mems">mems</a></span> <span class="id"><a href="Velus.NLCorrectness.html#args">args</a></span> <span class="id"><a href="Velus.NLCorrectness.html#s">s</a></span>.(<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.s_tcs">s_tcs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">system</span> " :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id"><a href="Velus.NLCorrectness.html#s">s</a></span>.(<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.s_name">s_name</a></span>) :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> " <span class="kwd">is</span> <span class="id">not</span> <span class="id">well</span> <span class="id">scheduled</span>." :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="is_well_sch">is_well_sch</a></span> (<span class="id">P</span>: <span class="id"><a href="Velus.Instantiator.html#Stc.Syn.program">Stc.Syn.program</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="Velus.Instantiator.html#Stc.Syn.program">Stc.Syn.program</a></span> :=<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id"><a href="Velus.NLCorrectness.html#is_well_sch_system">is_well_sch_system</a></span> <span class="id"><a href="Velus.NLCorrectness.html#P">P</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="Velus.NLCorrectness.html#P">P</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_well_sch_error">is_well_sch_error</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">G</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id"><a href="Velus.NLCorrectness.html#is_well_sch_system">is_well_sch_system</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> <span class="id"><a href="Velus.NLCorrectness.html#e">e</a></span>) = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> <span class="id"><a href="Velus.NLCorrectness.html#e">e</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">G</span> <span class="kwd">as</span> [|<span class="id">n</span> <span class="id">G</span>]; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_well_sch_program">is_well_sch_program</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id"><a href="Velus.NLCorrectness.html#is_well_sch_system">is_well_sch_system</a></span> <span class="id"><a href="Velus.NLCorrectness.html#P">P</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#Stc.Wdef.Well_scheduled">Stc.Wdef.Well_scheduled</a></span> <span class="id"><a href="Velus.NLCorrectness.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Instantiator.html#Stc.Wdef.Well_scheduled">Stc.Wdef.Well_scheduled</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">P</span> <span class="kwd">as</span> [|<span class="id">s</span>]; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">Fold</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Instantiator.html#Stc.Wdef.well_sch">Stc.Wdef.well_sch</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#ps_from_list">ps_from_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.s_lasts">Stc.Syn.s_lasts</a></span> <span class="id">s</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.s_in">Stc.Syn.s_in</a></span> <span class="id">s</span>)) (<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.s_tcs">Stc.Syn.s_tcs</a></span> <span class="id">s</span>)) <span class="id">eqn</span>: <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#Stc.Wdef.Is_well_sch_by_refl">Stc.Wdef.Is_well_sch_by_refl</a></span> <span class="kwd">in</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.NLCorrectness.html#is_well_sch_error">is_well_sch_error</a></span> <span class="kwd">in</span> <span class="id">Fold</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="schedule_program">schedule_program</a></span> (<span class="id">P</span>: <span class="id"><a href="Velus.Instantiator.html#Stc.Syn.program">Stc.Syn.program</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="Velus.Instantiator.html#Stc.Syn.program">Stc.Syn.program</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#is_well_sch">is_well_sch</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#schedule">Scheduler.schedule</a></span> <span class="id"><a href="Velus.NLCorrectness.html#P">P</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="nl_to_cl">nl_to_cl</a></span> (<span class="id">main_node</span>: <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) (<span class="id">g</span>: <span class="id"><a href="Velus.Instantiator.html#NL.Syn.global">global</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#program">Clight.program</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="Velus.NLCorrectness.html#g">g</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@ <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#print">print</a></span> <span class="id"><a href="Velus.NLCorrectness.html#print_nlustre">print_nlustre</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@ <span class="id"><a href="Velus.Instantiator.html#NL2Stc.translate">NL2Stc.translate</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@ <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#print">print</a></span> <span class="id"><a href="Velus.NLCorrectness.html#print_stc">print_stc</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@@ <span class="id"><a href="Velus.NLCorrectness.html#schedule_program">schedule_program</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@ <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#print">print</a></span> <span class="id"><a href="Velus.NLCorrectness.html#print_sch">print_sch</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@ <span class="id"><a href="Velus.Instantiator.html#Stc2Obc.translate">Stc2Obc.translate</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@ <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.NLCorrectness.html#do_fusion">do_fusion</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_class">Obc.Fus.fuse_class</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@ <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.add_defaults">add_defaults</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@ <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#print">print</a></span> <span class="id"><a href="Velus.NLCorrectness.html#print_obc">print_obc</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@@ <span class="id"><a href="Velus.ObcToClight.Generation.html#translate">Generation.translate</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#do_sync">do_sync</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) (<span class="id"><a href="Velus.NLCorrectness.html#do_expose">do_expose</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="id"><a href="Velus.NLCorrectness.html#main_node">main_node</a></span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id"><a name="add_builtins">add_builtins</a></span>: <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#program">Clight.program</a></span> -&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#program">Clight.program</a></span>.<br/>
<span class="kwd">Axiom</span> <span class="id"><a name="add_builtins_spec">add_builtins_spec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">B</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="Velus.NLCorrectness.html#B">B</a></span> &lt;&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id"><a href="Velus.NLCorrectness.html#t">t</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#semantics2">semantics2</a></span> <span class="id"><a href="Velus.NLCorrectness.html#p">p</a></span>) <span class="id"><a href="Velus.NLCorrectness.html#B">B</a></span> -&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#semantics2">semantics2</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#add_builtins">add_builtins</a></span> <span class="id"><a href="Velus.NLCorrectness.html#p">p</a></span>)) <span class="id"><a href="Velus.NLCorrectness.html#B">B</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="nl_to_asm">nl_to_asm</a></span> (<span class="id">main_node</span>: <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) (<span class="id">g</span>: <span class="id"><a href="Velus.Instantiator.html#NL.Syn.global">global</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.x86.Asm.html#program">Asm.program</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="Velus.NLCorrectness.html#g">g</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@@ <span class="id"><a href="Velus.NLCorrectness.html#nl_to_cl">nl_to_cl</a></span> <span class="id"><a href="Velus.NLCorrectness.html#main_node">main_node</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@ <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#print">print</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#print_Clight">print_Clight</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@ <span class="id"><a href="Velus.NLCorrectness.html#add_builtins">add_builtins</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@@ <span class="id"><a href="Velus.ClightToAsm.html#transf_clight2_program">transf_clight2_program</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="ForallStr">ForallStr</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span>: <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="ForallStr.P">P</a></span>: <span class="id"><a href="Velus.NLCorrectness.html#ForallStr.A">A</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
&nbsp;&nbsp;<span class="kwd">CoInductive</span> <span class="id"><a name="Forall_Str">Forall_Str</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.NLCorrectness.html#ForallStr.A">A</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="Always">Always</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#ForallStr.P">P</a></span> <span class="id"><a href="Velus.NLCorrectness.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#Forall_Str">Forall_Str</a></span> <span class="id"><a href="Velus.NLCorrectness.html#xs">xs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#Forall_Str">Forall_Str</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#x">x</a></span> ⋅ <span class="id"><a href="Velus.NLCorrectness.html#xs">xs</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Forall_Str_nth">Forall_Str_nth</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#Forall_Str">Forall_Str</a></span> <span class="id"><a href="Velus.NLCorrectness.html#s">s</a></span> &lt;-&gt; (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.NLCorrectness.html#ForallStr.P">P</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#s">s</a></span> # <span class="id"><a href="Velus.NLCorrectness.html#n">n</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">H</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">s</span>; <span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">s</span>; <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">s</span>; <span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="tactic">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">specialize</span> (<span class="id">H</span> 0); <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">n</span>; <span class="tactic">specialize</span> (<span class="id">H</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)); <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<span class="kwd">End</span> <span class="id"><a href="Velus.NLCorrectness.html#ForallStr">ForallStr</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="wt_streams">wt_streams</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.val">val</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span>) -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">xt</span> =&gt; <span class="id"><a href="Velus.NLCorrectness.html#Forall_Str">Forall_Str</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.wt_val">wt_val</a></span> <span class="id"><a href="Velus.NLCorrectness.html#v">v</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="Velus.NLCorrectness.html#xt">xt</a></span>)) <span class="id"><a href="Velus.NLCorrectness.html#s">s</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="wt_streams_spec">wt_streams_spec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vss</span> <span class="id">xts</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#wt_streams">wt_streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#vss">vss</a></span> <span class="id"><a href="Velus.NLCorrectness.html#xts">xts</a></span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.wt_vals">wt_vals</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#vss">vss</a></span> <span class="id"><a href="Velus.NLCorrectness.html#n">n</a></span>) <span class="id"><a href="Velus.NLCorrectness.html#xts">xts</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.wt_vals">wt_vals</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span> * <span class="id">WTs</span> <span class="id">n</span>; <span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">vss</span>; <span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams_hd">tr_Streams_hd</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">WTs</span> <span class="kwd">as</span> [|???? <span class="id">WT</span>]; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WT</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams_tl">tr_Streams_tl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">WTs</span>; <span class="tactic">induction</span> <span class="id">WTs</span> <span class="kwd">as</span> [|???? <span class="id">WT</span>]; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WT</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">WTs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#wt_streams">wt_streams</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">vss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xts</span>, <span class="id">vss</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="id">now</span> (<span class="tactic">specialize</span> (<span class="id">WTs</span> 0); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">WTs</span>; <span class="id">inv</span> <span class="id">WTs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.NLCorrectness.html#Forall_Str_nth">Forall_Str_nth</a></span>; <span class="tactic">intro</span> <span class="id">n</span>; <span class="tactic">specialize</span> (<span class="id">WTs</span> <span class="id">n</span>); <span class="id">inv</span> <span class="id">WTs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHxts</span>; <span class="tactic">intro</span> <span class="id">n</span>; <span class="tactic">specialize</span> (<span class="id">WTs</span> <span class="id">n</span>); <span class="id">inv</span> <span class="id">WTs</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="WtStream">WtStream</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="WtStream.G">G</a></span>: <span class="id"><a href="Velus.Instantiator.html#NL.Syn.global">global</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="WtStream.main">main</a></span>: <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="WtStream.ins">ins</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.val">val</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="WtStream.outs">outs</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.val">val</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="wt_ins">wt_ins</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">node</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Syn.find_node">find_node</a></span> <span class="id"><a href="Velus.NLCorrectness.html#WtStream.main">main</a></span> <span class="id"><a href="Velus.NLCorrectness.html#WtStream.G">G</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.NLCorrectness.html#node">node</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#wt_streams">wt_streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#WtStream.ins">ins</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> <span class="id"><a href="Velus.NLCorrectness.html#node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="wt_outs">wt_outs</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">node</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Syn.find_node">find_node</a></span> <span class="id"><a href="Velus.NLCorrectness.html#WtStream.main">main</a></span> <span class="id"><a href="Velus.NLCorrectness.html#WtStream.G">G</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.NLCorrectness.html#node">node</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#wt_streams">wt_streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#WtStream.outs">outs</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> <span class="id"><a href="Velus.NLCorrectness.html#node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>)).<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.NLCorrectness.html#WtStream">WtStream</a></span>.<br/>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Obc.Fus.fuse_wt_program</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Obc.Fus.fuse_call</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Obc.Fus.fuse_wt_mem</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Obc.Fus.fuse_loop_call</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wt_add_defaults_class</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wt_mem_add_defaults</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">stmt_call_eval_add_defaults</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">loop_call_add_defaults</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ClassFusible_translate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Scheduler.scheduler_wc_program</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">NL2StcClocking.translate_wc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">No_Naked_Vars_add_defaults_class</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Obc.Fus.fuse_No_Overwrites</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">translate_No_Overwrites</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Obc.Fus.fuse_cannot_write_inputs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">translate_cannot_write_inputs</span><br/>
.<br/>
<br/>
<div class="doc">The trace of a NLustre node </div>
<span class="kwd">Section</span> <span class="id"><a name="NLTrace">NLTrace</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="NLTrace.node">node</a></span>: <span class="id"><a href="Velus.Instantiator.html#NL.Syn.node">node</a></span>) (<span class="id"><a name="NLTrace.ins">ins</a></span> <span class="id"><a name="NLTrace.outs">outs</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.val">val</a></span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="NLTrace.Spec_in_out">Spec_in_out</a></span> : <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>) &lt;&gt; [] \/ <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>) &lt;&gt; [].<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="NLTrace.Len_ins">Len_ins</a></span>     : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.ins">ins</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="NLTrace.Len_outs">Len_outs</a></span>    : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.outs">outs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="trace_node">trace_node</a></span> (<span class="id">n</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>): <span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html#traceinf">traceinf</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">traceinf_of_traceinf</span>' (<span class="id"><a href="Velus.Traces.html#mk_trace">mk_trace</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.ins">ins</a></span>) (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.outs">outs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>)) (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="Velus.NLCorrectness.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5')">Next Obligation.</div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.Spec_in_out">Spec_in_out</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">left</span>; <span class="tactic">intro</span> <span class="id">E</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_eq_nil">map_eq_nil</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>; <span class="tactic">intro</span> <span class="id">E</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_eq_nil">map_eq_nil</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6')">Next Obligation.</div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span>, <span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span>; <span class="tactic">rewrite</span> 2 <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof7')">Next Obligation.</div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span>, <span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span>; <span class="tactic">rewrite</span> 2 <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">Simply link the trace of a Lustre node with the trace of an Obc step method with the same parameters </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="trace_inf_sim_step_node">trace_inf_sim_step_node</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">m</span> <span class="id">Spec_in_out_m</span> <span class="id">Len_ins_m</span> <span class="id">Len_outs_m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id"><a href="Velus.NLCorrectness.html#m">m</a></span> = <span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id"><a href="Velus.NLCorrectness.html#m">m</a></span> = <span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html#traceinf_sim">traceinf_sim</a></span> (<span class="id"><a href="Velus.Traces.html#trace_step">trace_step</a></span> <span class="id"><a href="Velus.NLCorrectness.html#m">m</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.ins">ins</a></span>) (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.outs">outs</a></span>) <span class="id"><a href="Velus.NLCorrectness.html#Spec_in_out_m">Spec_in_out_m</a></span> <span class="id"><a href="Velus.NLCorrectness.html#Len_ins_m">Len_ins_m</a></span> <span class="id"><a href="Velus.NLCorrectness.html#Len_outs_m">Len_outs_m</a></span> <span class="id"><a href="Velus.NLCorrectness.html#n">n</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.NLCorrectness.html#trace_node">trace_node</a></span> <span class="id"><a href="Velus.NLCorrectness.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="Velus.Traces.html#trace_step">trace_step</a></span>, <span class="id"><a href="Velus.NLCorrectness.html#trace_node">trace_node</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">traceinf_sim</span>'<span class="id">_sim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">n</span>; <span class="kwd">cofix</span> <span class="id">COFIX</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Traces.html#unfold_mk_trace">unfold_mk_trace</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Traces.html#unfold_mk_trace">unfold_mk_trace</a></span> <span class="kwd">with</span> (<span class="id">xs</span> := <span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="Velus.Traces.html#load_events">load_events</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.ins">ins</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>)) ** <span class="id"><a href="Velus.Traces.html#store_events">store_events</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.outs">outs</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="Velus.Traces.html#load_events">load_events</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.ins">ins</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">m</span>) ** <span class="id"><a href="Velus.Traces.html#store_events">store_events</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.outs">outs</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id">m</span>)); <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">E</span>; <span class="tactic">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html#Eapp_E0_inv">Eapp_E0_inv</a></span> <span class="kwd">in</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Traces.html#load_store_events_not_E0">load_store_events_not_E0</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Spec_in_out_m</span> <span class="id">Len_ins_m</span> <span class="id">Len_outs_m</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">COFIX</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace">NLTrace</a></span>.<br/>
<br/>
<div class="doc">A bisimulation relation between a declared node's trace and a given trace </div>
<span class="kwd">Inductive</span> <span class="id"><a name="bisim_IO">bisim_IO</a></span> (<span class="id">G</span>: <span class="id"><a href="Velus.Instantiator.html#NL.Syn.global">global</a></span>) (<span class="id">f</span>: <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>) (<span class="id">ins</span> <span class="id">outs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.val">val</a></span>)): <span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html#traceinf">traceinf</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="IOStep">IOStep</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">T</span> <span class="id">node</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Spec_in_out</span> : <span class="id"><a href="Velus.NLCorrectness.html#node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>) &lt;&gt; [] \/ <span class="id"><a href="Velus.NLCorrectness.html#node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>) &lt;&gt; [])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Len_ins</span>     : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id"><a href="Velus.NLCorrectness.html#ins">ins</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id"><a href="Velus.NLCorrectness.html#node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Len_outs</span>    : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id"><a href="Velus.NLCorrectness.html#outs">outs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id"><a href="Velus.NLCorrectness.html#node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Syn.find_node">find_node</a></span> <span class="id"><a href="Velus.NLCorrectness.html#f">f</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.NLCorrectness.html#node">node</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html#traceinf_sim">traceinf_sim</a></span> <span class="id"><a href="Velus.NLCorrectness.html#T">T</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#trace_node">trace_node</a></span> <span class="id"><a href="Velus.NLCorrectness.html#node">node</a></span> <span class="id"><a href="Velus.NLCorrectness.html#ins">ins</a></span> <span class="id"><a href="Velus.NLCorrectness.html#outs">outs</a></span> <span class="id"><a href="Velus.NLCorrectness.html#Spec_in_out">Spec_in_out</a></span> <span class="id"><a href="Velus.NLCorrectness.html#Len_ins">Len_ins</a></span> <span class="id"><a href="Velus.NLCorrectness.html#Len_outs">Len_outs</a></span> 0) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#bisim_IO">bisim_IO</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> <span class="id"><a href="Velus.NLCorrectness.html#f">f</a></span> <span class="id"><a href="Velus.NLCorrectness.html#ins">ins</a></span> <span class="id"><a href="Velus.NLCorrectness.html#outs">outs</a></span> <span class="id"><a href="Velus.NLCorrectness.html#T">T</a></span>.<br/>
<br/>
<div class="doc">streams of present values </div>
<span class="kwd">Definition</span> <span class="id"><a name="pstr">pstr</a></span> (<span class="id">xss</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#IStr.stream">stream</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.val">val</a></span>)) : <span class="id"><a href="Velus.ObcToClight.Interface.html#IStr.stream">stream</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.value">value</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#xss">xss</a></span> <span class="id"><a href="Velus.NLCorrectness.html#n">n</a></span>).<br/>
<span class="kwd">Definition</span> <span class="id"><a name="pStr">pStr</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.val">val</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.value">value</a></span>) := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#map">Streams.map</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.present">present</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tr_Streams_pStr">tr_Streams_pStr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xss</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#pStr">pStr</a></span> <span class="id"><a href="Velus.NLCorrectness.html#xss">xss</a></span>) ≈ <span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#xss">xss</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">n</span>; <span class="tactic">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span>, <span class="id"><a href="Velus.NLCorrectness.html#pStr">pStr</a></span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">xss</span>; <span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams_hd">tr_Streams_hd</a></span>, 2 <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>; <span class="tactic">induction</span> <span class="id">xss</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;-2 <span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams_tl">tr_Streams_tl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">IHn</span>, 2 <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="value_to_option_pstr">value_to_option_pstr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Instantiator.html#Stc2ObcCorr.value_to_option">Stc2ObcCorr.value_to_option</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span> <span class="id"><a href="Velus.NLCorrectness.html#xs">xs</a></span> <span class="id"><a href="Velus.NLCorrectness.html#n">n</a></span>)) ≈ (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#xs">xs</a></span> <span class="id"><a href="Velus.NLCorrectness.html#n">n</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="Velus.Instantiator.html#Stc2ObcCorr.value_to_option">Stc2ObcCorr.value_to_option</a></span>, <span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Correctness from NLustre to Clight </div>
<span class="kwd">Lemma</span> <span class="id"><a name="behavior_nl_to_cl">behavior_nl_to_cl</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">G</span> <span class="id">P</span> <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Clo.wc_global">wc_global</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Typ.wt_global">wt_global</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#wt_ins">wt_ins</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> <span class="id"><a href="Velus.NLCorrectness.html#main">main</a></span> <span class="id"><a href="Velus.NLCorrectness.html#ins">ins</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Norm.normal_args">normal_args</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.CoindSem.sem_node">CoindSem.sem_node</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> <span class="id"><a href="Velus.NLCorrectness.html#main">main</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#pStr">pStr</a></span> <span class="id"><a href="Velus.NLCorrectness.html#ins">ins</a></span>) (<span class="id"><a href="Velus.NLCorrectness.html#pStr">pStr</a></span> <span class="id"><a href="Velus.NLCorrectness.html#outs">outs</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#nl_to_cl">nl_to_cl</a></span> <span class="id"><a href="Velus.NLCorrectness.html#main">main</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="Velus.NLCorrectness.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">T</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#semantics2">semantics2</a></span> <span class="id"><a href="Velus.NLCorrectness.html#P">P</a></span>) (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Behaviors.html#Reacts">Reacts</a></span> <span class="id"><a href="Velus.NLCorrectness.html#T">T</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.NLCorrectness.html#bisim_IO">bisim_IO</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> <span class="id"><a href="Velus.NLCorrectness.html#main">main</a></span> <span class="id"><a href="Velus.NLCorrectness.html#ins">ins</a></span> <span class="id"><a href="Velus.NLCorrectness.html#outs">outs</a></span> <span class="id"><a href="Velus.NLCorrectness.html#T">T</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwc</span> <span class="id">Hwt</span> <span class="id">Hwti</span> <span class="id">Hnorm</span> <span class="id">Hsem</span> <span class="id">COMP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#nl_to_cl">nl_to_cl</a></span> <span class="kwd">in</span> <span class="id">COMP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">COMP</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#print_identity">print_identity</a></span> <span class="kwd">in</span> <span class="id">COMP</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;well-scheduled&nbsp;Stc&nbsp;program&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.NLCorrectness.html#schedule_program">schedule_program</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL2Stc.translate">NL2Stc.translate</a></span> <span class="id">G</span>)) <span class="id">eqn</span>: <span class="id">Sch</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">COMP</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#schedule_program">schedule_program</a></span>, <span class="id"><a href="Velus.NLCorrectness.html#is_well_sch">is_well_sch</a></span> <span class="kwd">in</span> <span class="id">Sch</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Sch</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id"><a href="Velus.NLCorrectness.html#is_well_sch_system">is_well_sch_system</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#schedule">Scheduler.schedule</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL2Stc.translate">NL2Stc.translate</a></span> <span class="id">G</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>)) <span class="id">eqn</span>: <span class="id">Wsch</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">destruct</span> <span class="id">u</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Sch</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#is_well_sch_program">is_well_sch_program</a></span> <span class="kwd">in</span> <span class="id">Wsch</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;a&nbsp;main&nbsp;Stc&nbsp;system&nbsp;exists&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#print_identity">print_identity</a></span> <span class="kwd">in</span> <span class="id">COMP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> <span class="id">COMP</span> <span class="kwd">as</span> <span class="id">COMP</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">n</span>, <span class="id"><a href="Velus.Instantiator.html#NL.Syn.find_node">find_node</a></span> <span class="id">main</span> <span class="id">G</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.NLCorrectness.html#n">n</a></span>) <span class="kwd">as</span> (<span class="id">main_node</span> &amp; <span class="id">Find</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="id">inv</span> <span class="id">Hsem</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> <span class="id">Find</span> <span class="kwd">as</span> <span class="id">Find_node</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL2Stc.find_node_translate">NL2Stc.find_node_translate</a></span> <span class="kwd">in</span> <span class="id">Find</span> <span class="kwd">as</span> (<span class="id">bl</span> &amp; <span class="id">P</span>' &amp; <span class="id">Find</span>&amp; ?); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#scheduler_find_system">Scheduler.scheduler_find_system</a></span> <span class="kwd">in</span> <span class="id">Find</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;a&nbsp;main&nbsp;Obc&nbsp;class&nbsp;exists&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#Stc2Obc.find_system_translate">Stc2Obc.find_system_translate</a></span> <span class="kwd">in</span> <span class="id">Find</span> <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Find</span> &amp;?&amp;?); <span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Coinductive&nbsp;NLustre&nbsp;to&nbsp;nat-&gt;values&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Ord.Ordered_nodes">Ordered_nodes</a></span> <span class="id">G</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="Velus.Instantiator.html#NL.Typ.wt_global_Ordered_nodes">wt_global_Ordered_nodes</a></span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL.CoindToIdx.implies">implies</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.NLCorrectness.html#tr_Streams_pStr">tr_Streams_pStr</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">ins</span>' := <span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id">ins</span>) <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">outs</span>' := <span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id">outs</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, 0 &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id">ins</span>' <span class="id"><a href="Velus.NLCorrectness.html#n">n</a></span>)) <span class="kwd">as</span> <span class="id">Length</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">inversion_clear</span> <span class="id">Hsem</span> <span class="kwd">as</span> [???????? <span class="id">Ins</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">k</span>; <span class="tactic">specialize</span> (<span class="id">Ins</span> <span class="id">k</span>); <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">Ins</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span> <span class="kwd">in</span> <span class="id">Ins</span>; <span class="tactic">rewrite</span> 2 <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span> <span class="kwd">in</span> <span class="id">Ins</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Ins</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_ingt0">n_ingt0</a></span>.<br/>
&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;NLustre&nbsp;to&nbsp;Nlustre&nbsp;with&nbsp;memory&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL.MemSem.sem_msem_node">sem_msem_node</a></span> <span class="kwd">in</span> <span class="id">Hsem</span> <span class="kwd">as</span> (<span class="id">M</span> &amp; <span class="id">Hsem</span>); <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;NLustre&nbsp;with&nbsp;memory&nbsp;to&nbsp;Stc&nbsp;loop&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Instantiator.html#Stc.Wdef.Well_defined">Stc.Wdef.Well_defined</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#schedule">Scheduler.schedule</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL2Stc.translate">NL2Stc.translate</a></span> <span class="id">G</span>))).<br/>
&nbsp;&nbsp;{ <span class="tactic">split</span>; [|<span class="tactic">split</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#scheduler_ordered">Scheduler.scheduler_ordered</a></span>, <span class="id"><a href="Velus.Instantiator.html#NL2StcCorr.Ordered_nodes_systems">NL2StcCorr.Ordered_nodes_systems</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#scheduler_normal_args">Scheduler.scheduler_normal_args</a></span>, <span class="id"><a href="Velus.Instantiator.html#NL2StcNormalArgs.translate_normal_args">NL2StcNormalArgs.translate_normal_args</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL2StcCorr.correctness_loop">NL2StcCorr.correctness_loop</a></span> <span class="kwd">in</span> <span class="id">Hsem</span> <span class="kwd">as</span> (?&amp; <span class="id">Hsem</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#scheduler_loop">Scheduler.scheduler_loop</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.Instantiator.html#Stc2ObcCorr.eq_if_present">Stc2ObcCorr.eq_if_present</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span> <span class="id">ins</span>' <span class="id"><a href="Velus.NLCorrectness.html#n">n</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ins</span>' <span class="id"><a href="Velus.NLCorrectness.html#n">n</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span>; <span class="tactic">intros</span>; <span class="tactic">clear</span>; <span class="tactic">induction</span> (<span class="id">ins</span>' <span class="id">n</span>); <span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.NLCorrectness.html#v">v</a></span> &lt;&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span> <span class="id">ins</span>' <span class="id"><a href="Velus.NLCorrectness.html#n">n</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span>; <span class="tactic">intros</span>; <span class="tactic">specialize</span> (<span class="id">Length</span> <span class="id">n</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">ins</span>' <span class="id">n</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">omega</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">discriminate</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Stc&nbsp;loop&nbsp;to&nbsp;Obc&nbsp;loop&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#Stc2ObcCorr.correctness_loop_call">Stc2ObcCorr.correctness_loop_call</a></span> <span class="kwd">with</span> (<span class="id">ins</span> := <span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ins</span>' <span class="id"><a href="Velus.NLCorrectness.html#n">n</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span> <span class="id">Hsem</span> <span class="kwd">as</span> (<span class="id">me0</span> &amp; <span class="id">Rst</span> &amp; <span class="id">Hsem</span> &amp;?); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.NLCorrectness.html#value_to_option_pstr">value_to_option_pstr</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;aliases&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">tr_G</span> := <span class="id"><a href="Velus.Instantiator.html#NL2Stc.translate">NL2Stc.translate</a></span> <span class="id">G</span>) <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">sch_tr_G</span> := <span class="id"><a href="Velus.NLCorrectness.html#schedule">Scheduler.schedule</a></span> <span class="id">tr_G</span>) <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">tr_sch_tr_G</span> := <span class="id"><a href="Velus.Instantiator.html#Stc2Obc.translate">Stc2Obc.translate</a></span> <span class="id">sch_tr_G</span>) <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">tr_main_node</span> := <span class="id"><a href="Velus.Instantiator.html#NL2Stc.translate_node">NL2Stc.translate_node</a></span> <span class="id">main_node</span>) <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">sch_tr_main_node</span> := <span class="id"><a href="Velus.NLCorrectness.html#schedule_system">Scheduler.schedule_system</a></span> <span class="id">tr_main_node</span>) <span class="kwd">in</span> *.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Obc&nbsp;methods&nbsp;step&nbsp;and&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Instantiator.html#Stc2Obc.exists_reset_method">Stc2Obc.exists_reset_method</a></span> <span class="id">sch_tr_main_node</span>) <span class="kwd">as</span> <span class="id">Find_reset</span>.<br/>
&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Instantiator.html#Stc2Obc.exists_step_method">Stc2Obc.exists_step_method</a></span> <span class="id">sch_tr_main_node</span>) <span class="kwd">as</span> <span class="id">Find_step</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">m_step</span> := <span class="id"><a href="Velus.Instantiator.html#Stc2Obc.step_method">Stc2Obc.step_method</a></span> <span class="id">sch_tr_main_node</span>) <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">m_reset</span> := <span class="id"><a href="Velus.Instantiator.html#Stc2Obc.reset_method">Stc2Obc.reset_method</a></span> <span class="id">sch_tr_main_node</span>) <span class="kwd">in</span> *.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;well-typing&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.wt_program">wt_program</a></span> <span class="id">tr_sch_tr_G</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#Stc2ObcTyping.translate_wt">Stc2ObcTyping.translate_wt</a></span>, <span class="id"><a href="Velus.NLCorrectness.html#scheduler_wt_program">Scheduler.scheduler_wt_program</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL2StcTyping.translate_wt">NL2StcTyping.translate_wt</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.wt_mem">wt_mem</a></span> <span class="id">me0</span> (<span class="id"><a href="Velus.Instantiator.html#Stc2Obc.translate">Stc2Obc.translate</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#schedule">Scheduler.schedule</a></span> <span class="id">P</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Instantiator.html#Stc2Obc.translate_system">Stc2Obc.translate_system</a></span> <span class="id">sch_tr_main_node</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.pres_sem_stmt_call">pres_sem_stmt_call</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="id"><a href="Velus.Ident.html#Ids.reset">reset</a></span>) <span class="kwd">in</span> <span class="id">Find</span> <span class="kwd">as</span> (? &amp; ?);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>; <span class="tactic">simpl</span>; <span class="tactic">constructor</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.NLCorrectness.html#wt_outs">wt_outs</a></span> <span class="id">G</span> <span class="id">main</span> <span class="id">outs</span>) <span class="kwd">as</span> <span class="id">Hwto</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#wt_outs">wt_outs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Find_node</span>'; <span class="tactic">rewrite</span> <span class="id">Find_node</span>' <span class="kwd">in</span> <span class="id">Find_node</span>; <span class="id">inv</span> <span class="id">Find_node</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#wt_streams_spec">wt_streams_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.pres_loop_call">pres_loop_call</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">Hwti</span> <span class="kwd">in</span> <span class="id">Find_node</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.NLCorrectness.html#wt_streams_spec">wt_streams_spec</a></span> <span class="kwd">in</span> <span class="id">Find_node</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;IO&nbsp;specs&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span> <span class="id">main_node</span> &lt;&gt; [] \/ <span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span> <span class="id">main_node</span> &lt;&gt; []) <span class="kwd">as</span> <span class="id">Step_in_out_spec</span>'.<br/>
&nbsp;&nbsp;{ <span class="tactic">left</span>. <span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_ingt0">n_ingt0</a></span> <span class="id">main_node</span>) <span class="kwd">as</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">E</span>; <span class="tactic">rewrite</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">m_step</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> \/ <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id">m_step</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="kwd">as</span> <span class="id">Step_in_out_spec</span>.<br/>
&nbsp;&nbsp;{ <span class="id">erewrite</span> <span class="id"><a href="Velus.Instantiator.html#Stc2Obc.find_method_stepm_in">Stc2Obc.find_method_stepm_in</a></span>, <span class="id"><a href="Velus.Instantiator.html#Stc2Obc.find_method_stepm_out">Stc2Obc.find_method_stepm_out</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">destruct</span> <span class="id">Step_in_out_spec</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">left</span>; <span class="tactic">intro</span> <span class="id">E</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_eq_nil">map_eq_nil</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>; <span class="tactic">intro</span> <span class="id">E</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_eq_nil">map_eq_nil</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.wt_vals">wt_vals</a></span> (<span class="id">ins</span>' <span class="id"><a href="Velus.NLCorrectness.html#n">n</a></span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">m_step</span>)) <span class="kwd">as</span> <span class="id">Hwt_in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="id">erewrite</span> <span class="id"><a href="Velus.Instantiator.html#Stc2Obc.find_method_stepm_in">Stc2Obc.find_method_stepm_in</a></span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#wt_streams_spec">wt_streams_spec</a></span>, <span class="id">Hwti</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.wt_vals">wt_vals</a></span> (<span class="id">outs</span>' <span class="id"><a href="Velus.NLCorrectness.html#n">n</a></span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id">m_step</span>)) <span class="kwd">as</span> <span class="id">Hwt_out</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="id">erewrite</span> <span class="id"><a href="Velus.Instantiator.html#Stc2Obc.find_method_stepm_out">Stc2Obc.find_method_stepm_out</a></span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#wt_streams_spec">wt_streams_spec</a></span>, <span class="id">Hwto</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">m_step</span> = <span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> <span class="id">main_node</span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>)) <span class="kwd">as</span> <span class="id">Ein</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id">m_step</span> = <span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> <span class="id">main_node</span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>)) <span class="kwd">as</span> <span class="id">Eout</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">ins</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span> <span class="id">main_node</span>)) <span class="kwd">as</span> <span class="id">Len_ins</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">transitivity</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> <span class="id">main_node</span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>))); <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Ein</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hwt_in</span> 0); <span class="tactic">unfold</span> <span class="id">ins</span>' <span class="kwd">in</span> <span class="id">Hwt_in</span>; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span> <span class="kwd">in</span> <span class="id">Hwt_in</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">outs</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span> <span class="id">main_node</span>)) <span class="kwd">as</span> <span class="id">Len_outs</span>.<br/>
&nbsp;{ <span class="tactic">transitivity</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">idty</a></span> <span class="id">main_node</span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>))); <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Eout</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hwt_out</span> 0); <span class="tactic">unfold</span> <span class="id">outs</span>' <span class="kwd">in</span> <span class="id">Hwt_out</span>; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span> <span class="kwd">in</span> <span class="id">Hwt_out</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;proceed&nbsp;to&nbsp;monadic&nbsp;compilation&nbsp;to&nbsp;Clight&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.ObcToClight.Generation.html#translate">Generation.translate</a></span> <span class="kwd">in</span> <span class="id">COMP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.NLCorrectness.html#do_fusion">do_fusion</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); <span class="tactic">clear</span> <span class="id">COMP</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;activated&nbsp;Fusion&nbsp;optimization&nbsp;*)</span><br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;assert&nbsp;some&nbsp;equalities&nbsp;between&nbsp;classes&nbsp;and&nbsp;methods&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Opaque</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.add_defaults_class">add_defaults_class</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_class">Obc.Fus.fuse_class</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_method">Obc.Fus.fuse_method</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#find_main_class">GenerationProperties.find_main_class</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">COMP</span>') <span class="kwd">as</span> <span class="id">Find</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_find_class">Obc.Fus.fuse_find_class</a></span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.find_class_add_defaults_class">find_class_add_defaults_class</a></span> <span class="kwd">in</span> <span class="id">Find</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Find</span> <span class="kwd">in</span> <span class="id">Find</span>'; <span class="tactic">injection</span> <span class="id">Find</span>'; <span class="tactic">intros</span> <span class="id">Eq_prog</span> <span class="id">Eq_main</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#find_main_step">GenerationProperties.find_main_step</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">COMP</span>') <span class="kwd">as</span> <span class="id">Find_step</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Eq_main</span> <span class="kwd">in</span> <span class="id">Find_step</span>'; <span class="tactic">rewrite</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.add_defaults_class_find_method">add_defaults_class_find_method</a></span> <span class="kwd">in</span> <span class="id">Find_step</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Obc.Fus.fuse_find_method</span>' <span class="kwd">in</span> <span class="id">Find_step</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Find_step</span> <span class="kwd">in</span> <span class="id">Find_step</span>'; <span class="tactic">simpl</span> <span class="id">option_map</span> <span class="kwd">in</span> <span class="id">Find_step</span>'; <span class="tactic">injection</span> <span class="id">Find_step</span>'; <span class="tactic">intros</span> <span class="id">Eq_step</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Find</span> <span class="id">Find</span>' <span class="id">Find_step</span> <span class="id">Find_step</span>'.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_method_in">Obc.Fus.fuse_method_in</a></span>, &lt;-<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.add_defaults_method_m_in">add_defaults_method_m_in</a></span>, <span class="id">Eq_step</span> <span class="kwd">in</span> <span class="id">Step_in_out_spec</span>, <span class="id">Hwt_in</span>, <span class="id">Ein</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_method_out">Obc.Fus.fuse_method_out</a></span>, &lt;-<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.add_defaults_method_m_out">add_defaults_method_m_out</a></span>, <span class="id">Eq_step</span> <span class="kwd">in</span> <span class="id">Step_in_out_spec</span>, <span class="id">Hwt_out</span>, <span class="id">Eout</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.Forall_methods">Forall_methods</a></span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Inv.No_Overwrites">Obc.Inv.No_Overwrites</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_body">m_body</a></span> <span class="id"><a href="Velus.NLCorrectness.html#m">m</a></span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_class">Obc.Fus.fuse_class</a></span> <span class="id">tr_sch_tr_G</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_No_Overwrites">Obc.Fus.fuse_No_Overwrites</a></span>, <span class="id"><a href="Velus.Instantiator.html#Stc2ObcInvariants.translate_No_Overwrites">translate_No_Overwrites</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.Forall_methods">Forall_methods</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; ~ <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Inv.Can_write_in">Obc.Inv.Can_write_in</a></span> <span class="id"><a href="Velus.NLCorrectness.html#x">x</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_body">m_body</a></span> <span class="id"><a href="Velus.NLCorrectness.html#m">m</a></span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id"><a href="Velus.NLCorrectness.html#m">m</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_class">Obc.Fus.fuse_class</a></span> <span class="id">tr_sch_tr_G</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_cannot_write_inputs">Obc.Fus.fuse_cannot_write_inputs</a></span>, <span class="id"><a href="Velus.Instantiator.html#Stc2ObcInvariants.translate_cannot_write_inputs">translate_cannot_write_inputs</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.ClassFusible">Obc.Fus.ClassFusible</a></span> <span class="id">tr_sch_tr_G</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#Stc2ObcInvariants.ClassFusible_translate">ClassFusible_translate</a></span>; <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#scheduler_wc_program">Scheduler.scheduler_wc_program</a></span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL2StcClocking.translate_wc">NL2StcClocking.translate_wc</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.ObcToClight.Correctness.html#correctness">correctness</a></span> <span class="kwd">with</span> (<span class="id">TRANSL</span> := <span class="id">COMP</span>') (<span class="id">me0</span> := <span class="id">me0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTins</span> := <span class="id">Hwt_in</span>) (<span class="id">WTouts</span> := <span class="id">Hwt_out</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Step_in_out_spec</span> := <span class="id">Step_in_out_spec</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> ??????? <span class="id">Call</span>; <span class="tactic">eapply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.stmt_call_eval_add_defaults_class_not_None">stmt_call_eval_add_defaults_class_not_None</a></span> <span class="kwd">with</span> (3 := <span class="id">Call</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">change</span> [] <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.val">val</a></span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> &lt;-<span class="id">Eq_prog</span>, &lt;-<span class="id">Eq_main</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#IOStep">IOStep</a></span> <span class="kwd">with</span> (<span class="id">Spec_in_out</span> := <span class="id">Step_in_out_spec</span>') (<span class="id">Len_ins</span> := <span class="id">Len_ins</span>) (<span class="id">Len_outs</span> := <span class="id">Len_outs</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#trace_inf_sim_step_node">trace_inf_sim_step_node</a></span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;activated&nbsp;Fusion&nbsp;optimization&nbsp;*)</span><br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;assert&nbsp;some&nbsp;equalities&nbsp;between&nbsp;classes&nbsp;and&nbsp;methods&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#find_main_class">GenerationProperties.find_main_class</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">COMP</span>') <span class="kwd">as</span> <span class="id">Find</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.find_class_add_defaults_class">find_class_add_defaults_class</a></span> <span class="kwd">in</span> <span class="id">Find</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Find</span> <span class="kwd">in</span> <span class="id">Find</span>'; <span class="tactic">injection</span> <span class="id">Find</span>'; <span class="tactic">intros</span> <span class="id">Eq_prog</span> <span class="id">Eq_main</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Opaque</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.add_defaults_method">add_defaults_method</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#find_main_step">GenerationProperties.find_main_step</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">COMP</span>') <span class="kwd">as</span> <span class="id">Find_step</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Eq_main</span> <span class="kwd">in</span> <span class="id">Find_step</span>'; <span class="tactic">rewrite</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.add_defaults_class_find_method">add_defaults_class_find_method</a></span> <span class="kwd">in</span> <span class="id">Find_step</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Find_step</span> <span class="kwd">in</span> <span class="id">Find_step</span>'; <span class="tactic">simpl</span> <span class="id">option_map</span> <span class="kwd">in</span> <span class="id">Find_step</span>'; <span class="tactic">injection</span> <span class="id">Find_step</span>'; <span class="tactic">intros</span> <span class="id">Eq_step</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.add_defaults_method_m_in">add_defaults_method_m_in</a></span>, <span class="id">Eq_step</span> <span class="kwd">in</span> <span class="id">Step_in_out_spec</span>, <span class="id">Hwt_in</span>, <span class="id">Ein</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.add_defaults_method_m_out">add_defaults_method_m_out</a></span>, <span class="id">Eq_step</span> <span class="kwd">in</span> <span class="id">Step_in_out_spec</span>, <span class="id">Hwt_out</span>, <span class="id">Eout</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.Forall_methods">Forall_methods</a></span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Inv.No_Overwrites">Obc.Inv.No_Overwrites</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_body">m_body</a></span> <span class="id"><a href="Velus.NLCorrectness.html#m">m</a></span>)) <span class="id">tr_sch_tr_G</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#Stc2ObcInvariants.translate_No_Overwrites">translate_No_Overwrites</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.Forall_methods">Forall_methods</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; ~ <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Inv.Can_write_in">Obc.Inv.Can_write_in</a></span> <span class="id"><a href="Velus.NLCorrectness.html#x">x</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_body">m_body</a></span> <span class="id"><a href="Velus.NLCorrectness.html#m">m</a></span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id"><a href="Velus.NLCorrectness.html#m">m</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_sch_tr_G</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="Velus.Instantiator.html#Stc2ObcInvariants.translate_cannot_write_inputs">translate_cannot_write_inputs</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.ObcToClight.Correctness.html#correctness">correctness</a></span> <span class="kwd">with</span> (<span class="id">TRANSL</span> := <span class="id">COMP</span>') (<span class="id">me0</span> := <span class="id">me0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTins</span> := <span class="id">Hwt_in</span>) (<span class="id">WTouts</span> := <span class="id">Hwt_out</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Step_in_out_spec</span> := <span class="id">Step_in_out_spec</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> ??????? <span class="id">Call</span>; <span class="tactic">eapply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.stmt_call_eval_add_defaults_class_not_None">stmt_call_eval_add_defaults_class_not_None</a></span> <span class="kwd">with</span> (3 := <span class="id">Call</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">change</span> [] <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.val">val</a></span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> &lt;-<span class="id">Eq_prog</span>, &lt;-<span class="id">Eq_main</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#IOStep">IOStep</a></span> <span class="kwd">with</span> (<span class="id">Spec_in_out</span> := <span class="id">Step_in_out_spec</span>') (<span class="id">Len_ins</span> := <span class="id">Len_ins</span>) (<span class="id">Len_outs</span> := <span class="id">Len_outs</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#trace_inf_sim_step_node">trace_inf_sim_step_node</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Correctness from NLustre to ASM  </div>
<span class="kwd">Lemma</span> <span class="id"><a name="behavior_nl_to_asm">behavior_nl_to_asm</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">G</span> <span class="id">P</span> <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Clo.wc_global">wc_global</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Typ.wt_global">wt_global</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#wt_ins">wt_ins</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> <span class="id"><a href="Velus.NLCorrectness.html#main">main</a></span> <span class="id"><a href="Velus.NLCorrectness.html#ins">ins</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Norm.normal_args">normal_args</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.CoindSem.sem_node">CoindSem.sem_node</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> <span class="id"><a href="Velus.NLCorrectness.html#main">main</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#pStr">pStr</a></span> <span class="id"><a href="Velus.NLCorrectness.html#ins">ins</a></span>) (<span class="id"><a href="Velus.NLCorrectness.html#pStr">pStr</a></span> <span class="id"><a href="Velus.NLCorrectness.html#outs">outs</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#nl_to_asm">nl_to_asm</a></span> <span class="id"><a href="Velus.NLCorrectness.html#main">main</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="Velus.NLCorrectness.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">T</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.x86.Asm.html#semantics">Asm.semantics</a></span> <span class="id"><a href="Velus.NLCorrectness.html#P">P</a></span>) (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Behaviors.html#Reacts">Reacts</a></span> <span class="id"><a href="Velus.NLCorrectness.html#T">T</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.NLCorrectness.html#bisim_IO">bisim_IO</a></span> <span class="id"><a href="Velus.NLCorrectness.html#G">G</a></span> <span class="id"><a href="Velus.NLCorrectness.html#main">main</a></span> <span class="id"><a href="Velus.NLCorrectness.html#ins">ins</a></span> <span class="id"><a href="Velus.NLCorrectness.html#outs">outs</a></span> <span class="id"><a href="Velus.NLCorrectness.html#T">T</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#nl_to_asm">nl_to_asm</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> * ????? <span class="id">Comp</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.NLCorrectness.html#nl_to_cl">nl_to_cl</a></span> <span class="id">main</span> <span class="id">G</span>) <span class="kwd">as</span> [<span class="id">p</span>|] <span class="id">eqn</span>: <span class="id">Comp</span>'; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Comp</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span>  <span class="id"><a href="Velus.NLCorrectness.html#behavior_nl_to_cl">behavior_nl_to_cl</a></span> <span class="kwd">in</span> <span class="id">Comp</span>' <span class="kwd">as</span> (<span class="id">T</span> &amp; <span class="id">Beh</span> &amp; <span class="id">Bisim</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.ClightToAsm.html#reacts_trace_preservation">reacts_trace_preservation</a></span> <span class="kwd">in</span> <span class="id">Comp</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#add_builtins_spec">add_builtins_spec</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> ? ?; <span class="tactic">discriminate</span>.<br/>
Qed.</div>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
