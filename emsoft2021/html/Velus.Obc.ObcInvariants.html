
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module ObcInvariants</title>
<meta name="description" content="Documentation of Coq module ObcInvariants" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module ObcInvariants</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Environment.html">Environment</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Operators.html">Operators</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Obc.ObcSyntax.html">Obc.ObcSyntax</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Obc.ObcSemantics.html">Obc.ObcSemantics</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Import</span> <span class="id">List.ListNotations</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="kwd">Type</span> <span class="id"><a name="OBCINVARIANTS">OBCINVARIANTS</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ids</span>   : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Op</span>    : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">SynObc</span>: <span class="id"><a href="Velus.Obc.ObcSyntax.html#OBCSYNTAX">Velus.Obc.ObcSyntax.OBCSYNTAX</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">SemObc</span>: <span class="id"><a href="Velus.Obc.ObcSemantics.html#OBCSEMANTICS">Velus.Obc.ObcSemantics.OBCSEMANTICS</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc">SynObc</a></span>).<br/>
<br/>
<h2> Determine whether an Obc command can modify a variable. </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="OBCINVARIANTS.Can_write_in">Can_write_in</a></span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> -&gt; <span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.stmt">stmt</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.CWIAssign">CWIAssign</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Assign">Assign</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.CWIAssignSt">CWIAssignSt</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.AssignSt">AssignSt</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.CWIIfteTrue">CWIIfteTrue</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">e</span> <span class="id">s1</span> <span class="id">s2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Ifte">Ifte</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.CWIIfteFalse">CWIIfteFalse</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">e</span> <span class="id">s1</span> <span class="id">s2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Ifte">Ifte</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.CWICall_ap">CWICall_ap</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">cls</span> <span class="id">i</span> <span class="id">f</span> <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#xs">xs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Call">Call</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#xs">xs</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#cls">cls</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#i">i</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#f">f</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#es">es</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.CWIComp1">CWIComp1</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">s1</span> <span class="id">s2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Comp">Comp</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.CWIComp2">CWIComp2</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">s1</span> <span class="id">s2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Comp">Comp</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCINVARIANTS.cannot_write_in_Ifte">cannot_write_in_Ifte</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">e</span> <span class="id">s1</span> <span class="id">s2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Ifte">Ifte</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> /\ ~ <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Constructors</span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Can_write_in">Can_write_in</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">intro</span>; <span class="tactic">try</span> (<span class="tactic">intro</span> <span class="id">HH</span>; <span class="tactic">inversion_clear</span> <span class="id">HH</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCINVARIANTS.Can_write_in_Comp">Can_write_in_Comp</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">s1</span> <span class="id">s2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Comp">Comp</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>) &lt;-&gt; (<span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> \/ <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">inversion_clear</span> <span class="id">HH</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">HH</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCINVARIANTS.cannot_write_in_Comp">cannot_write_in_Comp</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">s1</span> <span class="id">s2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Comp">Comp</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> /\ ~ <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Constructors</span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Can_write_in">Can_write_in</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">intro</span>; <span class="tactic">try</span> (<span class="tactic">intro</span> <span class="id">HH</span>; <span class="tactic">inversion_clear</span> <span class="id">HH</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">cannot_write</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">progress</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Is_free_in_exp">Is_free_in_exp</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id">_</span> -&gt; <span class="id">_</span> =&gt; <span class="tactic">intros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Hfw</span>: (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Is_free_in_exp">Is_free_in_exp</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> ?<span class="id">e</span> -&gt; <span class="id">_</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hfree</span>: <span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Is_free_in_exp">Is_free_in_exp</a></span> ?<span class="id">x</span> ?<span class="id">e</span> |- <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="tactic">pose</span> <span class="id">proof</span> (<span class="id">Hfw</span> <span class="id">x</span> <span class="id">Hfree</span>); <span class="tactic">clear</span> <span class="id">Hfw</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">_</span> /\ <span class="id">_</span> =&gt; <span class="tactic">split</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- ~<span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="tactic">intro</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id">_</span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Comp">Comp</a></span> <span class="id">_</span> <span class="id">_</span>) |- <span class="id">_</span> =&gt; <span class="tactic">inversion_clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">now</span> <span class="tactic">intuition</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCINVARIANTS.cannot_write_exp_eval">cannot_write_exp_eval</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">prog</span> <span class="id">s</span> <span class="id">me</span> <span class="id">ve</span> <span class="id">me</span>' <span class="id">ve</span>' <span class="id">e</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Is_free_in_exp">Is_free_in_exp</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span> -&gt; ~ <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s">s</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="Velus.Obc.ObcInvariants.html#SemObc.exp_eval">exp_eval</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#me">me</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#ve">ve</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#v">v</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="Velus.Obc.ObcInvariants.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#prog">prog</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#me">me</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#ve">ve</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s">s</a></span> (<span class="id">me</span>', <span class="id">ve</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="Velus.Obc.ObcInvariants.html#SemObc.exp_eval">exp_eval</a></span> <span class="id">me</span>' <span class="id">ve</span>' <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Constructors</span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Is_free_in_exp">Is_free_in_exp</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#exp_eval">exp_eval</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">intros</span> <span class="id">me</span> <span class="id">ve</span> <span class="id">me</span>' <span class="id">ve</span>' <span class="id">e</span>' <span class="id">v</span> <span class="id">Hfree</span> <span class="id">Hexp</span> <span class="id">Hstmt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hstmt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Obc.ObcInvariants.html#SemObc.exp_eval_extend_venv">exp_eval_extend_venv</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Habs</span>. <span class="tactic">apply</span> (<span class="id">Hfree</span> <span class="id">i</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hstmt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#SemObc.exp_eval_extend_menv">exp_eval_extend_menv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Habs</span>. <span class="tactic">apply</span> (<span class="id">Hfree</span> <span class="id">i</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hstmt</span>. <span class="tactic">destruct</span> <span class="id">b</span>; [<span class="tactic">eapply</span> <span class="id">IHs1</span>|<span class="tactic">eapply</span> <span class="id">IHs2</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">eassumption</span>; <span class="tactic">try</span> <span class="id">now</span> <span class="id">cannot_write</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hstmt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Hs1</span>: <span class="id"><a href="Velus.Obc.ObcInvariants.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">s1</span> <span class="id">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hs2</span>: <span class="id"><a href="Velus.Obc.ObcInvariants.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">s2</span> <span class="id">_</span> |- <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="tactic">apply</span> <span class="id">IHs1</span> <span class="kwd">with</span> (2:=<span class="id">Hexp</span>) <span class="kwd">in</span> <span class="id">Hs1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id">IHs2</span> <span class="kwd">with</span> (2:=<span class="id">Hs1</span>) (3:=<span class="id">Hs2</span>)|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">cannot_write</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hstmt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#SemObc.exp_eval_extend_menv_by_obj">exp_eval_extend_menv_by_obj</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#SemObc.exp_eval_adds_opt_extend_venv">exp_eval_adds_opt_extend_venv</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span> <span class="id">Hfree</span>'. <span class="tactic">apply</span> <span class="id">Hfree</span> <span class="kwd">in</span> <span class="id">Hfree</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">inv</span> <span class="id">Hstmt</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCINVARIANTS.Can_write_in_Ifte">Can_write_in_Ifte</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Ifte">Ifte</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>) &lt;-&gt; (<span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> \/ <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">inversion_clear</span> 1|<span class="tactic">intros</span> [<span class="id">HH</span>|<span class="id">HH</span>]]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> Assert that an Obc command never writes to a variable more than once. </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="OBCINVARIANTS.No_Overwrites">No_Overwrites</a></span> : <span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.stmt">stmt</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.NoOAssign">NoOAssign</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Overwrites">No_Overwrites</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Assign">Assign</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.NoOAssignSt">NoOAssignSt</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Overwrites">No_Overwrites</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.AssignSt">AssignSt</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.NoOIfte">NoOIfte</a></span>: <span class="kwd">forall</span> <span class="id">e</span> <span class="id">s1</span> <span class="id">s2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Overwrites">No_Overwrites</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Overwrites">No_Overwrites</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Overwrites">No_Overwrites</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Ifte">Ifte</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.NoOCall">NoOCall</a></span>: <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">cls</span> <span class="id">i</span> <span class="id">f</span> <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Overwrites">No_Overwrites</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Call">Call</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#xs">xs</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#cls">cls</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#i">i</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#f">f</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#es">es</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.NoOComp">NoOComp</a></span>: <span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> -&gt; ~<span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span> -&gt; ~<span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Overwrites">No_Overwrites</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Overwrites">No_Overwrites</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Overwrites">No_Overwrites</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Comp">Comp</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.NoOSkip">NoOSkip</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Overwrites">No_Overwrites</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Skip">Skip</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Constructors</span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Overwrites">No_Overwrites</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCINVARIANTS.cannot_write_in_No_Overwrites">cannot_write_in_No_Overwrites</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, ~<span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s">s</a></span>) -&gt; <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.No_Overwrites">No_Overwrites</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">auto</span>; <span class="tactic">intro</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.cannot_write_in_Ifte">cannot_write_in_Ifte</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; (<span class="tactic">apply</span> <span class="id">IHs1</span> || <span class="tactic">apply</span> <span class="id">IHs2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span>; <span class="tactic">specialize</span> (<span class="id">HH</span> <span class="id">x</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.cannot_write_in_Comp">cannot_write_in_Comp</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id">IHs1</span> || <span class="tactic">apply</span> <span class="id">IHs2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hcw</span>; <span class="tactic">specialize</span> (<span class="id">HH</span> <span class="id">x</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> Assert that Obc calls never involve undefined variables. </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="OBCINVARIANTS.No_Naked_Vars">No_Naked_Vars</a></span> : <span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.stmt">stmt</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.NNVAssign">NNVAssign</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Naked_Vars">No_Naked_Vars</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Assign">Assign</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.NNVAssignSt">NNVAssignSt</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Naked_Vars">No_Naked_Vars</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.AssignSt">AssignSt</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.NNVIfte">NNVIfte</a></span>: <span class="kwd">forall</span> <span class="id">e</span> <span class="id">s1</span> <span class="id">s2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Naked_Vars">No_Naked_Vars</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Naked_Vars">No_Naked_Vars</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Naked_Vars">No_Naked_Vars</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Ifte">Ifte</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.NNVCall">NNVCall</a></span>: <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">cls</span> <span class="id">i</span> <span class="id">f</span> <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>, <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span> &lt;&gt; <span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Var">Var</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#ty">ty</a></span>) <span class="id"><a href="Velus.Obc.ObcInvariants.html#es">es</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Naked_Vars">No_Naked_Vars</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Call">Call</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#xs">xs</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#cls">cls</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#i">i</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#f">f</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#es">es</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.NNVComp">NNVComp</a></span>: <span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Naked_Vars">No_Naked_Vars</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Naked_Vars">No_Naked_Vars</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Naked_Vars">No_Naked_Vars</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Comp">Comp</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s1">s1</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s2">s2</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="OBCINVARIANTS.NNVSkip">NNVSkip</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Naked_Vars">No_Naked_Vars</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Skip">Skip</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Constructors</span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#No_Naked_Vars">No_Naked_Vars</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">stmt_eval_mono</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ome</span> <span class="id">ome</span>' <span class="id">clsid</span> <span class="id">f</span> <span class="id">vos</span> <span class="id">rvos</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">vo</span> =&gt; <span class="id"><a href="Velus.Obc.ObcInvariants.html#vo">vo</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcInvariants.html#vos">vos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#SemObc.stmt_call_eval">stmt_call_eval</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#p">p</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#ome">ome</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#clsid">clsid</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#f">f</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#vos">vos</a></span> <span class="id">ome</span>' <span class="id"><a href="Velus.Obc.ObcInvariants.html#rvos">rvos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcInvariants.html#rvos">rvos</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">me</span> <span class="id">ve</span> <span class="id">me</span>' <span class="id">ve</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS.No_Naked_Vars">No_Naked_Vars</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s">s</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcInvariants.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#p">p</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#me">me</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#ve">ve</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#s">s</a></span> (<span class="id">me</span>', <span class="id">ve</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#ve">ve</a></span> -&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id">ve</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">p</span> <span class="id">Hcall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">intros</span> * <span class="id">Hnnv</span> <span class="id">Heval</span> <span class="id">x</span> <span class="id">Hin</span>; <span class="id">inv</span> <span class="id">Heval</span>; <span class="id">inv</span> <span class="id">Hnnv</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="Velus.Obc.ObcInvariants.html#SemObc.stmt_call_eval">stmt_call_eval</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">rename</span> <span class="id">H</span> <span class="id">into</span> <span class="id">He</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hcall</span> <span class="kwd">in</span> <span class="id">He</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Environment.html#Env.adds_opt_mono">Env.adds_opt_mono</a></span>, <span class="id"><a href="Velus.Obc.ObcInvariants.html#SemObc.Forall2_exp_eval_not_None">Forall2_exp_eval_not_None</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCINVARIANTS.no_vars_in_args_spec">no_vars_in_args_spec</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">me</span> <span class="id">ve</span> <span class="id">es</span> <span class="id">vos</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Obc.ObcInvariants.html#SemObc.exp_eval">exp_eval</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#me">me</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#ve">ve</a></span>) <span class="id"><a href="Velus.Obc.ObcInvariants.html#es">es</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#vos">vos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>, <span class="id"><a href="Velus.Obc.ObcInvariants.html#e">e</a></span> &lt;&gt; <span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc.Var">Var</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#ty">ty</a></span>) <span class="id"><a href="Velus.Obc.ObcInvariants.html#es">es</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">vo</span> =&gt; <span class="id"><a href="Velus.Obc.ObcInvariants.html#vo">vo</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcInvariants.html#vos">vos</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> 1 <span class="kwd">as</span> [|???? <span class="id">Exp</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> 1 <span class="kwd">as</span> [|?? <span class="id">E</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Exp</span>; <span class="tactic">eapply</span> <span class="id">E</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS">OBCINVARIANTS</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="ObcInvariantsFun">ObcInvariantsFun</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ids</span>  : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Op</span>   : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">OpAux</span>: <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">SynObc</span>: <span class="id"><a href="Velus.Obc.ObcSyntax.html#OBCSYNTAX">Velus.Obc.ObcSyntax.OBCSYNTAX</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">SemObc</span>: <span class="id"><a href="Velus.Obc.ObcSemantics.html#OBCSEMANTICS">Velus.Obc.ObcSemantics.OBCSEMANTICS</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc">SynObc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;: <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS">OBCINVARIANTS</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc">SynObc</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#SemObc">SemObc</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Include</span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS">OBCINVARIANTS</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#SynObc">SynObc</a></span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#SemObc">SemObc</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Obc.ObcInvariants.html#ObcInvariantsFun">ObcInvariantsFun</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
