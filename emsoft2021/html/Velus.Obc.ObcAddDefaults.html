
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module ObcAddDefaults</title>
<meta name="description" content="Documentation of Coq module ObcAddDefaults" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module ObcAddDefaults</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.FSets.FMapPositive.html">FSets.FMapPositive</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.PArith.html">PArith</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Environment.html">Environment</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Operators.html">Operators</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Obc.ObcSyntax.html">Obc.ObcSyntax</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Obc.ObcSemantics.html">Obc.ObcSemantics</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Obc.ObcInvariants.html">Obc.ObcInvariants</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Obc.ObcTyping.html">Obc.ObcTyping</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Obc.Equiv.html">Obc.Equiv</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.VelusMemory.html">VelusMemory</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Import</span> <span class="id">List.ListNotations</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<br/>
<span class="kwd">Import</span> <span class="id">Env.Notations</span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="kwd">Type</span> <span class="id"><a name="OBCADDDEFAULTS">OBCADDDEFAULTS</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ids</span>   : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Op</span>    : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">SynObc</span>: <span class="id"><a href="Velus.Obc.ObcSyntax.html#OBCSYNTAX">Velus.Obc.ObcSyntax.OBCSYNTAX</a></span>         <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">SemObc</span>: <span class="id"><a href="Velus.Obc.ObcSemantics.html#OBCSEMANTICS">Velus.Obc.ObcSemantics.OBCSEMANTICS</a></span>   <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc">SynObc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">InvObc</span>: <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS">Velus.Obc.ObcInvariants.OBCINVARIANTS</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc">SynObc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc">SemObc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">TypObc</span>: <span class="id"><a href="Velus.Obc.ObcTyping.html#OBCTYPING">Velus.Obc.ObcTyping.OBCTYPING</a></span>         <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc">SynObc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc">SemObc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Equ</span>   : <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV">Velus.Obc.Equiv.EQUIV</a></span>                 <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc">SynObc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc">SemObc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc">TypObc</a></span>).<br/>
<br/>
<h2> AddDefault functions </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="OBCADDDEFAULTS.AddDefaults">AddDefaults</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="OBCADDDEFAULTS.AddDefaults.type_of_var">type_of_var</a></span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op.type">type</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="OBCADDDEFAULTS.add_write">add_write</a></span> <span class="id">x</span> <span class="id">s</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaults.type_of_var">type_of_var</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Comp">Comp</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Assign">Assign</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Const">Const</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op.init_type">init_type</a></span> <span class="id">ty</span>))) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id">W</span> <span class="id">s</span> := <span class="id"><a href="Velus.Common.CommonPS.html#PS.fold">PS.fold</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_write">add_write</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#W">W</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="OBCADDDEFAULTS.add_valid">add_valid</a></span> (<span class="id">e</span> : <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.exp">exp</a></span>) (<span class="id">esreq</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.exp">exp</a></span> * <span class="id"><a href="Velus.Common.CommonPS.html#PS.t">PS.t</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Var">Var</a></span> <span class="id">x</span> <span class="id">ty</span> =&gt; (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Valid">Valid</a></span> <span class="id">x</span> <span class="id">ty</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#esreq">esreq</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.add">PS.add</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#esreq">esreq</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#e">e</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#esreq">esreq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#esreq">esreq</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> (<span class="id">required</span>: <span class="id"><a href="Velus.Common.CommonPS.html#PS.t">PS.t</a></span>) (<span class="id">s</span>: <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.stmt">stmt</a></span>) : <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.stmt">stmt</a></span> * <span class="id"><a href="Velus.Common.CommonPS.html#PS.t">PS.t</a></span> * <span class="id"><a href="Velus.Common.CommonPS.html#PS.t">PS.t</a></span> * <span class="id"><a href="Velus.Common.CommonPS.html#PS.t">PS.t</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Skip">Skip</a></span> =&gt; (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#required">required</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Assign">Assign</a></span> <span class="id">x</span> <span class="id">e</span> =&gt; (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.remove">PS.remove</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#required">required</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.singleton">PS.singleton</a></span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.AssignSt">AssignSt</a></span> <span class="id">x</span> <span class="id">e</span> =&gt; (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#required">required</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Call">Call</a></span> <span class="id">xs</span> <span class="id">f</span> <span class="id">o</span> <span class="id">m</span> <span class="id">es</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">es</span>', <span class="id">required</span>') := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_valid">add_valid</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;([], <span class="id"><a href="Velus.Common.CommonPS.html#ps_removes">ps_removes</a></span> <span class="id">xs</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#required">required</a></span>) <span class="id">es</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Call">Call</a></span> <span class="id">xs</span> <span class="id">f</span> <span class="id">o</span> <span class="id">m</span> <span class="id">es</span>', <span class="id">required</span>', <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PSP.of_list">PSP.of_list</a></span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Comp">Comp</a></span> <span class="id">s1</span> <span class="id">s2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">t2</span>, <span class="id">required2</span>, <span class="id">sometimes2</span>, <span class="id">always2</span>) := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#required">required</a></span> <span class="id">s2</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">t1</span>, <span class="id">required1</span>, <span class="id">sometimes1</span>, <span class="id">always1</span>) := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">required2</span> <span class="id">s1</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Comp">Comp</a></span> <span class="id">t1</span> <span class="id">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">required1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> <span class="id">sometimes1</span> <span class="id">always2</span>) (<span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> <span class="id">sometimes2</span> <span class="id">always1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id">always1</span> <span class="id">always2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Ifte">Ifte</a></span> <span class="id">e</span> <span class="id">s1</span> <span class="id">s2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">t1</span>, <span class="id">required1</span>, <span class="id">sometimes1</span>, <span class="id">always1</span>) := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s1</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">t2</span>, <span class="id">required2</span>, <span class="id">sometimes2</span>, <span class="id">always2</span>) := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s2</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">always1_req</span> := <span class="id"><a href="Velus.Common.CommonPS.html#PS.inter">PS.inter</a></span> <span class="id">always1</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#required">required</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">always2_req</span> := <span class="id"><a href="Velus.Common.CommonPS.html#PS.inter">PS.inter</a></span> <span class="id">always2</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#required">required</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">w1</span> := <span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always2_req">always2_req</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always1_req">always1_req</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">w2</span> := <span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always1_req">always1_req</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always2_req">always2_req</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">w</span> := <span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.inter">PS.inter</a></span> <span class="id">sometimes1</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#required">required</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w1">w1</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.inter">PS.inter</a></span> <span class="id">sometimes2</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#required">required</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w2">w2</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">always1</span>' := <span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id">always1</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w1">w1</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">always2</span>' := <span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id">always2</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w2">w2</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sometimes1</span>' := <span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> <span class="id">sometimes1</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w1">w1</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sometimes2</span>' := <span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> <span class="id">sometimes2</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w2">w2</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w">w</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Ifte">Ifte</a></span> <span class="id">e</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w1">w1</a></span> <span class="id">t1</span>) (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w2">w2</a></span> <span class="id">t2</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#required">required</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always1_req">always1_req</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always2_req">always2_req</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">required1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">required2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w">w</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id">sometimes1</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id">sometimes2</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> <span class="id">always1</span>' <span class="id">always2</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> <span class="id">always2</span>' <span class="id">always1</span>')))) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w">w</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.inter">PS.inter</a></span> <span class="id">always1</span>' <span class="id">always2</span>') <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w">w</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaults">AddDefaults</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span> (<span class="id">m</span>: <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.method">method</a></span>): <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.method">method</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.mk_method">mk_method</a></span> <span class="id">name</span> <span class="id">ins</span> <span class="id">vars</span> <span class="id">outs</span> <span class="id">body</span> <span class="id">nodup</span> <span class="id">good</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.mk_method">mk_method</a></span> <span class="id">name</span> <span class="id">ins</span> <span class="id">vars</span> <span class="id">outs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">let</span> <span class="id">tyenv</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Env.adds</span>' <span class="id">outs</span> (<span class="id">Env.adds</span>' <span class="id">vars</span> (<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> <span class="id">ins</span>))) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">body</span>', <span class="id">required</span>, <span class="id">sometimes</span>, <span class="id">always</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#tyenv">tyenv</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.of_list">PSP.of_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">outs</span>)) <span class="id">body</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#tyenv">tyenv</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#ps_removes">ps_removes</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ins</span>) <span class="id">required</span>) <span class="id">body</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nodup</span> <span class="id">good</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_method_m_name">add_defaults_method_m_name</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>).(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_name">m_name</a></span>) = <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_name">m_name</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</div>
<div class="proofscript" id="proof1">
 <span class="id">now</span> <span class="tactic">destruct</span> <span class="id">m</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_method_m_in">add_defaults_method_m_in</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>, (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>).(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_in">m_in</a></span>) = <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_in">m_in</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</div>
<div class="proofscript" id="proof2">
 <span class="id">now</span> <span class="tactic">destruct</span> <span class="id">m</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_method_m_out">add_defaults_method_m_out</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>, (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>).(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_out">m_out</a></span>) = <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_out">m_out</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</div>
<div class="proofscript" id="proof3">
 <span class="id">now</span> <span class="tactic">destruct</span> <span class="id">m</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_method_m_vars">add_defaults_method_m_vars</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>, (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>).(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_vars">m_vars</a></span>) = <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_vars">m_vars</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</div>
<div class="proofscript" id="proof4">
 <span class="id">now</span> <span class="tactic">destruct</span> <span class="id">m</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_class">add_defaults_class</a></span> (<span class="id">c</span>: <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.class">class</a></span>): <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.class">class</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.mk_class">mk_class</a></span> <span class="id">name</span> <span class="id">mems</span> <span class="id">objs</span> <span class="id">methods</span> <span class="id">nodup</span> <span class="id">nodupm</span> <span class="id">cgood</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.mk_class">mk_class</a></span> <span class="id">name</span> <span class="id">mems</span> <span class="id">objs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span> <span class="id">methods</span>) <span class="id">nodup</span> <span class="id">_</span> <span class="id">cgood</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5')">Next Obligation.</div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>. <span class="id">now</span> <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method_m_name">add_defaults_method_m_name</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults">add_defaults</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class">add_defaults_class</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.find_method_add_defaults_method">find_method_add_defaults_method</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">ms</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_method">find_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#n">n</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ms">ms</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_method">find_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#n">n</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ms">ms</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ms</span> <span class="kwd">as</span> [|<span class="id">m</span> <span class="id">ms</span>' <span class="id">IH</span>]. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method_m_name">add_defaults_method_m_name</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#ident_eqb">ident_eqb</a></span> <span class="id">m</span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_name">m_name</a></span>) <span class="id">n</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">inversion_clear</span> 1.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_method_map_add_defaults_method</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">ms</span> <span class="id">fm</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_method">find_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#n">n</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ms">ms</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#fm">fm</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="tactic">exists</span> <span class="id">fm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_method">find_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#n">n</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ms">ms</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fm</span>' /\ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#fm">fm</a></span> = <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span> <span class="id">fm</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ms</span> <span class="kwd">as</span> [|<span class="id">m</span> <span class="id">ms</span>' <span class="id">IH</span>]. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method_m_name">add_defaults_method_m_name</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#ident_eqb">ident_eqb</a></span> <span class="id">m</span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_name">m_name</a></span>) <span class="id">n</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.find_method_map_add_defaults_method">find_method_map_add_defaults_method</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_method">find_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#n">n</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_methods">c_methods</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_method">find_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#n">n</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class">add_defaults_class</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>).(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_methods">c_methods</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</div>
<div class="proofscript" id="proof8">
 <span class="id">now</span> <span class="tactic">destruct</span> <span class="id">c</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_class_c_name">add_defaults_class_c_name</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span>, (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class">add_defaults_class</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>).(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_name">c_name</a></span>) = <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_name">c_name</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</div>
<div class="proofscript" id="proof9">
 <span class="id">now</span> <span class="tactic">destruct</span> <span class="id">c</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_class_c_objs">add_defaults_class_c_objs</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span>, (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class">add_defaults_class</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>).(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_objs">c_objs</a></span>) = <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_objs">c_objs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</div>
<div class="proofscript" id="proof10">
 <span class="id">now</span> <span class="tactic">destruct</span> <span class="id">c</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_class_c_mems">add_defaults_class_c_mems</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span>, (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class">add_defaults_class</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>).(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_mems">c_mems</a></span>) = <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_mems">c_mems</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</div>
<div class="proofscript" id="proof11">
 <span class="id">now</span> <span class="tactic">destruct</span> <span class="id">c</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.find_class_add_defaults_class">find_class_add_defaults_class</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">n</span> <span class="id">c</span> <span class="id">p</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_class">find_class</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#n">n</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>, <span class="id">p</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_class">find_class</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#n">n</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class">add_defaults_class</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span> <span class="id">p</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">p</span> <span class="kwd">as</span> [|<span class="id">c</span> <span class="id">p</span>' <span class="id">IH</span>]. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class_c_name">add_defaults_class_c_name</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">n</span> <span class="id">c</span>' <span class="id">p</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#ident_eqb">ident_eqb</a></span> <span class="id">c</span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_name">c_name</a></span>) <span class="id">n</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">inversion_clear</span> 1.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.find_class_add_defaults_class_not_None">find_class_add_defaults_class_not_None</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_class">find_class</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#n">n</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_class">find_class</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#n">n</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">n</span> <span class="id">p</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#not_None_is_Some">not_None_is_Some</a></span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> ((<span class="id">c</span> &amp; <span class="id">p</span>') &amp; <span class="id">Hfind</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.find_class_add_defaults_class">find_class_add_defaults_class</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">x</span> '∈' <span class="id">y</span>" := (<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="tactic">at</span> <span class="id">level</span> 10).<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">x</span> '∪' <span class="id">y</span>" := (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="tactic">at</span> <span class="id">level</span> 11, <span class="tactic">right</span> <span class="id">associativity</span>).<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">x</span> '∩' <span class="id">y</span>" := (<span class="id"><a href="Velus.Common.CommonPS.html#PS.inter">PS.inter</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="tactic">at</span> <span class="id">level</span> 11, <span class="tactic">right</span> <span class="id">associativity</span>).<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">x</span> '—' <span class="id">y</span>" := (<span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="tactic">at</span> <span class="id">level</span> 11).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">PS_split</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">context</span> [ <span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id">_</span> <span class="id">_</span> ] |- <span class="id">_</span> =&gt; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">context</span> [ ~(<span class="id"><a href="Velus.Common.CommonPS.html#PS.inter">PS.inter</a></span> <span class="id">_</span> <span class="id">_</span>) ] |- <span class="id">_</span> =&gt; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_not_inter">PS_not_inter</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">context</span> [ <span class="id"><a href="Velus.Common.CommonPS.html#PS.inter">PS.inter</a></span> <span class="id">_</span> <span class="id">_</span> ] |- <span class="id">_</span> =&gt; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.inter_spec">PS.inter_spec</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">context</span> [ <span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> <span class="id">_</span> <span class="id">_</span> ] |- <span class="id">_</span> =&gt; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.diff_spec">PS.diff_spec</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">context</span> [ ~(<span class="id">_</span> \/ <span class="id">_</span>) ] |- <span class="id">_</span> =&gt; <span class="tactic">setoid_rewrite</span> <span class="id">not_or</span>' <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">context</span> [ ~~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">_</span> <span class="id">_</span> ] |- <span class="id">_</span> =&gt; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#not_not_in">not_not_in</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id">_</span> /\ <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span> [ <span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id">_</span> <span class="id">_</span> ] =&gt; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span> [ ~(<span class="id"><a href="Velus.Common.CommonPS.html#PS.inter">PS.inter</a></span> <span class="id">_</span> <span class="id">_</span>) ] =&gt; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_not_inter">PS_not_inter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span> [ <span class="id"><a href="Velus.Common.CommonPS.html#PS.inter">PS.inter</a></span> <span class="id">_</span> <span class="id">_</span> ] =&gt; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.inter_spec">PS.inter_spec</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span> [ <span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> <span class="id">_</span> <span class="id">_</span> ] =&gt; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.diff_spec">PS.diff_spec</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span> [ ~(<span class="id">_</span> \/ <span class="id">_</span>) ] =&gt; <span class="tactic">setoid_rewrite</span> <span class="id">not_or</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span> [ ~~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">_</span> <span class="id">_</span> ] =&gt; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#not_not_in">not_not_in</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">PS_negate</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:~(<span class="id">_</span> /\ <span class="id">_</span>) |- <span class="id">_</span> =&gt; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Decidable.html#not_and">Decidable.not_and</a></span> <span class="kwd">in</span> <span class="id">H</span>; [|<span class="id">now</span> <span class="tactic">intuition</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:~~<span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Decidable.html#not_not">Decidable.not_not</a></span> <span class="kwd">in</span> <span class="id">H</span>; [|<span class="id">now</span> <span class="tactic">intuition</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">context</span> [ ~~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">_</span> <span class="id">_</span> ] |- <span class="id">_</span> =&gt; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#not_not_in">not_not_in</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.simplify_write_sets">simplify_write_sets</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">w</span> <span class="id">w1</span> <span class="id">w2</span> <span class="id">al1</span> <span class="id">al2</span> <span class="id">st1</span> <span class="id">st2</span> <span class="id">rq</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w1">w1</a></span> = (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#al2">al2</a></span> ∩ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rq">rq</a></span>) — (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#al1">al1</a></span> ∩ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rq">rq</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w2">w2</a></span> = (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#al1">al1</a></span> ∩ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rq">rq</a></span>) — (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#al2">al2</a></span> ∩ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rq">rq</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w">w</a></span> = ((<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#st1">st1</a></span> ∩ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rq">rq</a></span>) — <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w1">w1</a></span>) ∪ ((<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#st2">st2</a></span> ∩ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rq">rq</a></span>) — <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w2">w2</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.Equal">PS.Equal</a></span> ((((<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#st1">st1</a></span> — <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w1">w1</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∪ (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#st2">st2</a></span> — <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w2">w2</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∪ ((<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#al1">al1</a></span> ∪ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w1">w1</a></span>) — (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#al2">al2</a></span> ∪ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w2">w2</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∪ (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#al2">al2</a></span> ∪ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w2">w2</a></span>) — (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#al1">al1</a></span> ∪ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w1">w1</a></span>)) — <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w">w</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∪ ((<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#al1">al1</a></span> ∪ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w1">w1</a></span>) ∩ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#al2">al2</a></span> ∪ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w2">w2</a></span>) ∪ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w">w</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w">w</a></span> ∪ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w1">w1</a></span> ∪ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w2">w2</a></span> ∪ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#al1">al1</a></span> ∪ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#al2">al2</a></span> ∪ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#st1">st1</a></span> ∪ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#st2">st2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.union_sym">PSP.union_sym</a></span> <span class="id">_</span> <span class="id">w</span>), &lt;-(<span class="id"><a href="Velus.Common.CommonPS.html#PSP.union_assoc">PSP.union_assoc</a></span> <span class="id">_</span> <span class="id">w</span>), <span class="id"><a href="Velus.Common.CommonPS.html#PS_union_diff_same">PS_union_diff_same</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">HH</span>. <span class="id">now</span> <span class="id">PS_split</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.In_dec">PSP.In_dec</a></span> <span class="id">x</span> (<span class="id">al2</span> ∪ <span class="id">w2</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.In_dec">PSP.In_dec</a></span> <span class="id">x</span> (<span class="id">al1</span> ∪ <span class="id">w1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">PS_split</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">PS_split</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">PS_split</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">PS_split</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> Basic lemmas around <span class="bracket"><span class="id">add_defaults_class</span></span> and <span class="bracket"><span class="id">add_defaults_method</span></span>. </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_class_find_method">add_defaults_class_find_method</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_method">find_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#f">f</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class">add_defaults_class</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>).(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_methods">c_methods</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span>) (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_method">find_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#f">f</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_methods">c_methods</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">f</span> <span class="id">c</span>. <span class="tactic">destruct</span> <span class="id">c</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_method_map">find_method_map</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intro</span> <span class="id">m</span>; <span class="tactic">destruct</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.In_snd_fold_right_add_valid">In_snd_fold_right_add_valid</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">es</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_valid">add_valid</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#xs">xs</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#es">es</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">s</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">es</span> <span class="kwd">as</span> [|<span class="id">e</span> <span class="id">es</span> <span class="id">IH</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">xs</span>. <span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_valid">add_valid</a></span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#surjective_pairing">surjective_pairing</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.add_spec">PS.add_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span>); [<span class="id">now</span> <span class="tactic">left</span>; <span class="tactic">eauto</span>|<span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">add_valid</span>' <span class="id">e</span> := <span class="kwd">match</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#e">e</a></span> <span class="kwd">with</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Var">Var</a></span> <span class="id">x</span> <span class="id">ty</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Valid">Valid</a></span> <span class="id">x</span> <span class="id">ty</span> | <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#e">e</a></span> <span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">add_valid_add_valid</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">es</span> <span class="id">S</span> <span class="id">es</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_valid">add_valid</a></span> (<span class="id">es</span>', <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#S">S</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#es">es</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">add_valid</span>' <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#es">es</a></span> ++ <span class="id">es</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">es</span> <span class="kwd">as</span> [|<span class="id">e</span> <span class="id">es</span> <span class="id">IH</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">intros</span> <span class="id">S</span> <span class="id">xs</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">IH</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.Forall2_exp_eval_refines_with_valid">Forall2_exp_eval_refines_with_valid</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">me</span> <span class="id">ve1</span> <span class="id">ve2</span> <span class="id">es</span> <span class="id">vos</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve2">ve2</a></span> ⊑ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve1">ve1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">match</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#e">e</a></span> <span class="kwd">with</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Var">Var</a></span> <span class="id">x</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve1">ve1</a></span> | <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="kwd">end</span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#es">es</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.exp_eval">exp_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve2">ve2</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#es">es</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vos">vos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">vos</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.exp_eval">exp_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve1">ve1</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">add_valid</span>' <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#es">es</a></span>) <span class="id">vos</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">vo</span> <span class="id">vo</span>' =&gt; <span class="kwd">forall</span> <span class="id">v</span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vo">vo</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#v">v</a></span> -&gt; <span class="id">vo</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#v">v</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vos">vos</a></span> <span class="id">vos</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">me</span> <span class="id">ve1</span> <span class="id">ve2</span> <span class="id">es</span> <span class="id">vos</span> <span class="id">Henv</span> <span class="id">Hvar</span> <span class="id">Hvos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hvos</span> <span class="kwd">as</span> [|<span class="id">e</span> <span class="id">vo</span> <span class="id">es</span> <span class="id">vos</span> <span class="id">He</span> <span class="id">Hfa</span> <span class="id">IH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_cons2">Forall_cons2</a></span> <span class="kwd">in</span> <span class="id">Hvar</span> <span class="kwd">as</span> (<span class="id">Hvar</span> &amp; <span class="id">Hvars</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">exp_eval_refines</span>' <span class="kwd">with</span> (1:=<span class="id">Henv</span>) <span class="kwd">in</span> <span class="id">He</span> <span class="kwd">as</span> (<span class="id">vo</span>' &amp; <span class="id">Heval</span> &amp; <span class="id">Hvo</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IH</span> <span class="kwd">as</span> (<span class="id">vos</span>' &amp; <span class="id">Hevals</span> &amp; <span class="id">Hvos</span>'); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2_cons">Forall2_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">v</span>', <span class="id">vo</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>') <span class="kwd">as</span> (<span class="id">v</span>' &amp; <span class="id">Hv</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="id">inv</span> <span class="id">Heval</span>; <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.In_find">Env.In_find</a></span> <span class="kwd">in</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id">vo</span>'::<span class="id">vos</span>'). <span class="tactic">subst</span> <span class="id">vo</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Heval</span>; <span class="tactic">constructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.exp_eval">exp_eval</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="tactic">rewrite</span> <span class="id">it</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.exp_eval">exp_eval</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.stmt_eval_add_writes_split">stmt_eval_add_writes_split</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tyenv</span> <span class="id">p</span> <span class="id">s</span> <span class="id">W</span> <span class="id">me</span> <span class="id">ve</span> <span class="id">me</span>'' <span class="id">ve</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve">ve</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#W">W</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span>) (<span class="id">me</span>'', <span class="id">ve</span>'') &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">me</span>' <span class="id">ve</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve">ve</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#W">W</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Skip">Skip</a></span>) (<span class="id">me</span>', <span class="id">ve</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> <span class="id">me</span>' <span class="id">ve</span>' <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> (<span class="id">me</span>'', <span class="id">ve</span>'')).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSE.MP.fold_spec_right">PSE.MP.fold_spec_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="tactic">until</span> <span class="id">ve</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.elements">PS.elements</a></span> <span class="id">W</span>)) <span class="kwd">as</span> <span class="id">ws</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> &lt;-<span class="id">Heqws</span>; <span class="tactic">clear</span> <span class="id">Heqws</span> <span class="id">W</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">s</span> <span class="id">me</span> <span class="id">ve</span> <span class="id">me</span>'' <span class="id">ve</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ws</span> <span class="kwd">as</span> [|<span class="id">w</span> <span class="id">ws</span> <span class="id">IH</span>]; <span class="tactic">simpl</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> (<span class="id">me</span>' &amp; <span class="id">ve</span>' &amp; <span class="id">Heval1</span> &amp; <span class="id">Heval2</span>). <span class="id">now</span> <span class="id">inv</span> <span class="id">Heval1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_write">add_write</a></span> <span class="tactic">at</span> 1 3. <span class="tactic">intro</span> <span class="id">Heval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">tyenv</span> <span class="id">w</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">inversion_clear</span> <span class="id">Heval</span> <span class="kwd">as</span> [| | |? ? ? ? ? ? ? ? ? <span class="id">Heval1</span> <span class="id">Heval2</span>| |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IH</span> <span class="kwd">in</span> <span class="id">Heval2</span> <span class="kwd">as</span> (<span class="id">me</span>' &amp; <span class="id">ve</span>' &amp; <span class="id">Heval1</span>' &amp; <span class="id">Heval2</span>'). <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IH</span> <span class="kwd">in</span> <span class="id">Heval</span> <span class="kwd">as</span> (<span class="id">me</span>' &amp; <span class="id">ve</span>' &amp; <span class="id">Heval1</span>' &amp; <span class="id">Heval2</span>'). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_write">add_write</a></span> <span class="tactic">at</span> 1 3. <span class="tactic">intros</span> (<span class="id">me</span>' &amp; <span class="id">ve</span>' &amp; <span class="id">Heval1</span> &amp; <span class="id">Heval3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">tyenv</span> <span class="id">w</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">inversion_clear</span> <span class="id">Heval1</span> <span class="kwd">as</span> [| | |? ? ? ? ? ? ? ? ? <span class="id">Heval1</span>' <span class="id">Heval2</span>| |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; [<span class="id">now</span> <span class="tactic">eapply</span> <span class="id">Heval1</span>'|]. <span class="tactic">apply</span> <span class="id">IH</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IH</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.No_Naked_Vars_add_writes">No_Naked_Vars_add_writes</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tyenv</span> <span class="id">W</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.No_Naked_Vars">No_Naked_Vars</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> &lt;-&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.No_Naked_Vars">No_Naked_Vars</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#W">W</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSE.MP.fold_spec_right">PSE.MP.fold_spec_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">tyenv</span> <span class="id">W</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.elements">PS.elements</a></span> <span class="id">W</span>)) <span class="kwd">as</span> <span class="id">ws</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> &lt;-<span class="id">Heqws</span>; <span class="tactic">clear</span> <span class="id">Heqws</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ws</span> <span class="kwd">as</span> [|<span class="id">w</span> <span class="id">ws</span> <span class="id">IH</span>]; <span class="tactic">simpl</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_write">add_write</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IH</span>. <span class="tactic">destruct</span> (<span class="id">tyenv</span> <span class="id">w</span>); <span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">HH</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">HH</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.stmt_eval_add_writes">stmt_eval_add_writes</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ome</span> <span class="id">ome</span>' <span class="id">clsid</span> <span class="id">f</span> <span class="id">vos</span> <span class="id">rvos</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">vo</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vo">vo</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vos">vos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_call_eval">stmt_call_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ome">ome</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#clsid">clsid</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#f">f</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vos">vos</a></span> <span class="id">ome</span>' <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rvos">rvos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rvos">rvos</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tyenv</span> <span class="id">s</span> <span class="id">W</span> <span class="id">me</span> <span class="id">ve</span> <span class="id">me</span>' <span class="id">ve</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#W">W</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.No_Naked_Vars">No_Naked_Vars</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve">ve</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#W">W</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span>) (<span class="id">me</span>', <span class="id">ve</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#W">W</a></span> -&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">ve</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">p</span> <span class="id">Hcall</span> <span class="id">tyenv</span> <span class="id">s</span> <span class="id">W</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.No_Naked_Vars_add_writes">No_Naked_Vars_add_writes</a></span> <span class="id">tyenv</span> <span class="id">W</span> <span class="id">s</span>). <span class="id">revert</span> <span class="id">s</span> <span class="id">W</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSE.MP.fold_spec_right">PSE.MP.fold_spec_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="tactic">until</span> <span class="id">ve</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.elements">PS.elements</a></span> <span class="id">W</span>)) <span class="kwd">as</span> <span class="id">ws</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">W</span> &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">ws</span>) <span class="kwd">as</span> <span class="id">HinW</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intro</span> <span class="id">x</span>; <span class="tactic">subst</span> <span class="id">ws</span>. <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_rev">in_rev</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PSF.elements_iff">PSF.elements_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">HH</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.SetoidList.html#InA_alt">SetoidList.InA_alt</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> (? &amp; ? &amp; ?); <span class="tactic">subst</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_Forall">PS_For_all_Forall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_rev">Permutation.Permutation_rev</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.elements">PS.elements</a></span> <span class="id">W</span>)) <span class="tactic">at</span> 1 4.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> &lt;-<span class="id">Heqws</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Heqws</span> <span class="id">HinW</span> <span class="id">W</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">s</span> <span class="id">me</span> <span class="id">ve</span> <span class="id">me</span>' <span class="id">ve</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ws</span> <span class="kwd">as</span> [|<span class="id">w</span> <span class="id">ws</span> <span class="id">IH</span>]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">intros</span> * <span class="id">Hfa</span> <span class="id">Hnnv</span> <span class="id">Heval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hfa</span> <span class="kwd">as</span> [|? ? <span class="id">Hnn</span> <span class="id">Hws</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_write">add_write</a></span> <span class="kwd">in</span> <span class="id">Heval</span>, <span class="id">Hnnv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#not_None_is_Some">not_None_is_Some</a></span> <span class="kwd">in</span> <span class="id">Hnn</span>; <span class="tactic">destruct</span> <span class="id">Hnn</span> <span class="kwd">as</span> (<span class="id">wv</span> &amp; <span class="id">Hnn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hnn</span> <span class="kwd">in</span> <span class="id">Heval</span>, <span class="id">Hnnv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Heval</span> <span class="kwd">as</span> [| | |? ? ? ? ? ? ? <span class="id">Ha</span> <span class="id">Hb</span> <span class="id">Heval1</span> <span class="id">Heval2</span>| |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hnnv</span> <span class="kwd">as</span> [| | | |? ? <span class="id">Hnnv1</span> <span class="id">Hnnv2</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id">stmt_eval_mono</span>' <span class="id">_</span> <span class="id">Hcall</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hnnv2</span> <span class="id">Heval2</span>) <span class="kwd">as</span> <span class="id">Henv1</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IH</span> <span class="kwd">in</span> <span class="id">Heval2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Henv1</span>'. <span class="id">inv</span> <span class="id">Heval1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.add_in_iff">Env.Props.P.F.add_in_iff</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.stmt_eval_add_writes_Skip_other">stmt_eval_add_writes_Skip_other</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">tyenv</span> <span class="id">W</span> <span class="id">me</span> <span class="id">ve</span> <span class="id">me</span>' <span class="id">ve</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve">ve</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#W">W</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Skip">Skip</a></span>) (<span class="id">me</span>', <span class="id">ve</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, ~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#W">W</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">ve</span>' = <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve">ve</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSE.MP.fold_spec_right">PSE.MP.fold_spec_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="tactic">until</span> <span class="id">ve</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.elements">PS.elements</a></span> <span class="id">W</span>)) <span class="kwd">as</span> <span class="id">ws</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">W</span> &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">ws</span>) <span class="kwd">as</span> <span class="id">HinW</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intro</span> <span class="id">x</span>; <span class="tactic">subst</span> <span class="id">ws</span>. <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_rev">in_rev</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PSF.elements_iff">PSF.elements_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">HH</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.SetoidList.html#InA_alt">SetoidList.InA_alt</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> (? &amp; ? &amp; ?); <span class="tactic">subst</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">HinW</span>. <span class="tactic">setoid_rewrite</span> &lt;-<span class="id">Heqws</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Heqws</span> <span class="id">HinW</span> <span class="id">W</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">me</span> <span class="id">ve</span> <span class="id">me</span>' <span class="id">ve</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ws</span> <span class="kwd">as</span> [|<span class="id">w</span> <span class="id">ws</span> <span class="id">IH</span>]. <span class="id">now</span> <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">intros</span> * <span class="id">Heval</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Decidable.html#not_or">Decidable.not_or</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> (<span class="id">Hnwx</span> &amp; <span class="id">Hnin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_write">add_write</a></span> <span class="kwd">in</span> <span class="id">Heval</span>. <span class="tactic">destruct</span> (<span class="id">tyenv</span> <span class="id">w</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">inversion_clear</span> <span class="id">Heval</span> <span class="kwd">as</span> [| | |? ? ? ? ? ? ? ? ? <span class="id">Heval1</span> <span class="id">Heval2</span>| |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IH</span> <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">Heval2</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">Heval2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Heval1</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gso">Env.gso</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">IH</span> <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">Heval</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_stmt_inv1">add_defaults_stmt_inv1</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tyenv</span> <span class="id">s</span> <span class="id">t</span> <span class="id">req</span> <span class="id">req</span>' <span class="id">stimes</span> <span class="id">always</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#req">req</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> = (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#t">t</a></span>, <span class="id">req</span>', <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#stimes">stimes</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always">always</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.Empty">PS.Empty</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.inter">PS.inter</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#stimes">stimes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always">always</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#req">req</a></span> -&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always">always</a></span> \/ <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">req</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#stimes">stimes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always">always</a></span>) -&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">x</span>, ~<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> -&gt; ~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#stimes">stimes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always">always</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.No_Naked_Vars">No_Naked_Vars</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#t">t</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span> <span class="kwd">as</span> [| | | |<span class="id">ys</span> <span class="id">clsid</span> <span class="id">o</span> <span class="id">f</span> <span class="id">es</span>|]; <span class="tactic">intros</span> <span class="id">t</span> <span class="id">rq</span> <span class="id">rq</span>' <span class="id">st</span> <span class="id">al</span> <span class="id">Hadd</span>; <span class="id">inv</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Assign&nbsp;i&nbsp;e&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="id">now</span> <span class="tactic">intuition</span>|<span class="tactic">repeat</span> <span class="tactic">split</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>. <span class="id">edestruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">He</span>|<span class="id">Hne</span>]; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSF.remove_2">PSF.remove_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">He</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.singleton_spec">PS.singleton_spec</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="tactic">try</span> <span class="id">not_In_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSF.singleton_iff">PSF.singleton_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hnc</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="tactic">try</span> <span class="id">not_In_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSF.singleton_iff">PSF.singleton_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;AssignSt&nbsp;i&nbsp;e&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSF.empty_iff">PSF.empty_iff</a></span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Ifte&nbsp;e&nbsp;s1&nbsp;s2&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">H0</span> <span class="id">into</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs1</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s1</span> = <span class="id">defs1</span>) <span class="kwd">as</span> <span class="id">Hdefs1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs1</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs1</span> <span class="kwd">as</span> [[[<span class="id">t1</span> <span class="id">rq1</span>] <span class="id">st1</span>] <span class="id">al1</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs2</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s2</span> = <span class="id">defs2</span>) <span class="kwd">as</span> <span class="id">Hdefs2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs2</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs2</span> <span class="kwd">as</span> [[[<span class="id">t2</span> <span class="id">rq2</span>] <span class="id">st2</span>] <span class="id">al2</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> ((<span class="id">al2</span> ∩ <span class="id">rq</span>) — (<span class="id">al1</span> ∩ <span class="id">rq</span>)) <span class="kwd">as</span> <span class="id">w1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> ((<span class="id">al1</span> ∩ <span class="id">rq</span>) — (<span class="id">al2</span> ∩ <span class="id">rq</span>)) <span class="kwd">as</span> <span class="id">w2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (((<span class="id">st1</span> ∩ <span class="id">rq</span>) — <span class="id">w1</span>) ∪ ((<span class="id">st2</span> ∩ <span class="id">rq</span>) — <span class="id">w2</span>)) <span class="kwd">as</span> <span class="id">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">w1</span> &lt;-&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">al2</span> /\ <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">rq</span> /\ ~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">al1</span>) <span class="kwd">as</span> <span class="id">Hw1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">subst</span> <span class="id">w1</span>; <span class="tactic">clear</span>; <span class="id">PS_split</span>; <span class="tactic">intuition</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">w2</span> &lt;-&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">al1</span> /\ <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">rq</span> /\ ~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">al2</span>) <span class="kwd">as</span> <span class="id">Hw2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">subst</span> <span class="id">w2</span>; <span class="tactic">clear</span>; <span class="id">PS_split</span>; <span class="tactic">intuition</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">injection</span> <span class="id">Hadd</span>; <span class="tactic">clear</span> <span class="id">Hadd</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">al</span> <span class="id">st</span> <span class="id">rq</span>' <span class="id">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHs1</span> <span class="kwd">in</span> <span class="id">Hdefs1</span> <span class="kwd">as</span> (<span class="id">H1A</span> &amp; <span class="id">H1B</span> &amp; <span class="id">H1C</span> &amp; <span class="id">H1D</span> &amp; <span class="id">H1E</span>); <span class="tactic">clear</span> <span class="id">IHs1</span> <span class="id">H1B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHs2</span> <span class="kwd">in</span> <span class="id">Hdefs2</span> <span class="kwd">as</span> (<span class="id">H2A</span> &amp; <span class="id">H2B</span> &amp; <span class="id">H2C</span> &amp; <span class="id">H2D</span> &amp; <span class="id">H2E</span>); <span class="tactic">clear</span> <span class="id">IHs2</span> <span class="id">H2B</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;PS.Empty&nbsp;(PS.inter&nbsp;st&nbsp;al)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">HH</span>. <span class="id">PS_split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id">_</span> \/ <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">x</span> <span class="id">w</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [[<span class="id">HH1</span> <span class="id">HH2</span>]|<span class="id">HH</span>]; [|<span class="id">contradiction</span>] <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">w</span>. <span class="id">PS_split</span>. <span class="id">PS_negate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>: <span class="id">_</span> \/ <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="id">PS_split</span>; <span class="id">PS_negate</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">contradiction</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="id">now</span> <span class="tactic">eapply</span> <span class="id">H1A</span>; <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.inter_spec">PS.inter_spec</a></span>; <span class="tactic">eauto</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="id">now</span> <span class="tactic">eapply</span> <span class="id">H2A</span>; <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.inter_spec">PS.inter_spec</a></span>; <span class="tactic">eauto</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;forall&nbsp;x,&nbsp;x&nbsp;∈&nbsp;req&nbsp;-&gt;&nbsp;x&nbsp;∈&nbsp;always&nbsp;\/&nbsp;x&nbsp;∈&nbsp;req'&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.In_dec">PSP.In_dec</a></span> <span class="id">x</span> (((<span class="id">al1</span> ∪ <span class="id">w1</span>) ∩ <span class="id">al2</span> ∪ <span class="id">w2</span>) ∪ <span class="id">w</span>)) <span class="kwd">as</span> [<span class="id">HH</span>|<span class="id">HH</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">PS_split</span>; <span class="id">PS_negate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H</span>: <span class="id">_</span> \/ <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:~(<span class="id">_</span> \/ <span class="id">_</span>) |- <span class="id">_</span> =&gt; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Decidable.html#not_or">Decidable.not_or</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">HH1</span> &amp; <span class="id">HH2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:~(<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">x</span> <span class="id">w</span>) |- <span class="id">_</span> =&gt; <span class="tactic">assert</span> (<span class="id">Hnw</span> := <span class="id">H</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqw</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS_not_union">PS_not_union</a></span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">HnxA</span> &amp; <span class="id">HnxB</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_not_diff">PS_not_diff</a></span> <span class="kwd">in</span> <span class="id">HnxA</span> <span class="kwd">as</span> [<span class="id">HnxA</span> | <span class="id">HnxA</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_not_diff">PS_not_diff</a></span> <span class="kwd">in</span> <span class="id">HnxB</span> <span class="kwd">as</span> [<span class="id">HnxB</span> | <span class="id">HnxB</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_not_inter">PS_not_inter</a></span> <span class="kwd">in</span> <span class="id">HnxA</span> <span class="kwd">as</span> [<span class="id">HnxA</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">contradiction</span>]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_not_inter">PS_not_inter</a></span> <span class="kwd">in</span> <span class="id">HnxB</span> <span class="kwd">as</span> [<span class="id">HnxB</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">contradiction</span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">x</span> <span class="id">w1</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hw1</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">PS_negate</span>; <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">H</span>|]; <span class="id">now</span> <span class="tactic">tauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">x</span> <span class="id">w2</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hw2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">PS_negate</span>; <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">H</span>|]; <span class="id">now</span> <span class="tactic">tauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.inter">PS.inter</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.inter">PS.inter</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">_</span>) |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.inter_spec">PS.inter_spec</a></span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> ((<span class="id">HB1</span> &amp; <span class="id">HB2</span>) &amp; <span class="id">HB3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;forall&nbsp;x,&nbsp;PS.In&nbsp;x&nbsp;(PS.union&nbsp;stimes&nbsp;always)&nbsp;-&gt;&nbsp;Can_write_in&nbsp;x&nbsp;s&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id">st1</span> <span class="id">al1</span>) (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id">st2</span> <span class="id">al2</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span>; <span class="tactic">destruct</span> 1 <span class="kwd">as</span> [<span class="id">HH</span>|<span class="id">HH</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">PS_split</span>; <span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>: <span class="id">_</span> \/ <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">_</span> /\ <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">_</span> <span class="id">w1</span> |- <span class="id">_</span> =&gt; <span class="tactic">apply</span> <span class="id">Hw1</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">_</span> <span class="id">w2</span> |- <span class="id">_</span> =&gt; <span class="tactic">apply</span> <span class="id">Hw2</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">w</span>; <span class="id">PS_split</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;forall&nbsp;x,&nbsp;~Can_write_in&nbsp;x&nbsp;s&nbsp;-&gt;&nbsp;~PS.In&nbsp;x&nbsp;(PS.union&nbsp;stimes&nbsp;always)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hncw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id">st1</span> <span class="id">al1</span>) (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id">st2</span> <span class="id">al2</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> <span class="id">HH1</span> <span class="id">HH</span>; <span class="tactic">apply</span> <span class="id">HH1</span>; <span class="tactic">clear</span> <span class="id">HH1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">PS_split</span>; <span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>: <span class="id">_</span> \/ <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">_</span> /\ <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">_</span> <span class="id">w1</span> |- <span class="id">_</span> =&gt; <span class="tactic">apply</span> <span class="id">Hw1</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">_</span> <span class="id">w2</span> |- <span class="id">_</span> =&gt; <span class="tactic">apply</span> <span class="id">Hw2</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">subst</span> <span class="id">w</span>; <span class="id">PS_split</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span>. <span class="tactic">intros</span> [<span class="id">HH</span>|<span class="id">HH</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;No_Naked_Vars&nbsp;t&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.No_Naked_Vars_add_writes">No_Naked_Vars_add_writes</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">constructor</span>; <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.No_Naked_Vars_add_writes">No_Naked_Vars_add_writes</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Comp&nbsp;s1&nbsp;s2&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">H0</span> <span class="id">into</span> <span class="id">Hadd</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs2</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id">rq</span> <span class="id">s2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id">rq</span> <span class="id">s2</span> = <span class="id">defs2</span>) <span class="kwd">as</span> <span class="id">Hdefs2</span> <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs2</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs2</span> <span class="kwd">as</span> [[[<span class="id">t2</span> <span class="id">req2</span>] <span class="id">stimes2</span>] <span class="id">always2</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs1</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id">req2</span> <span class="id">s1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id">req2</span> <span class="id">s1</span> = <span class="id">defs1</span>) <span class="kwd">as</span> <span class="id">Hdefs1</span> <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs1</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs1</span> <span class="kwd">as</span> [[[<span class="id">t1</span> <span class="id">req1</span>] <span class="id">stimes1</span>] <span class="id">always1</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">injection</span> <span class="id">Hadd</span>; <span class="tactic">clear</span> <span class="id">Hadd</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">al</span> <span class="id">st</span> <span class="id">rq</span>' <span class="id">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHs1</span> <span class="kwd">in</span> <span class="id">Hdefs1</span> <span class="kwd">as</span> (<span class="id">H1A</span> &amp; <span class="id">H1B</span> &amp; <span class="id">H1C</span> &amp; <span class="id">H1D</span> &amp; <span class="id">H1E</span>); <span class="tactic">clear</span> <span class="id">IHs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHs2</span> <span class="kwd">in</span> <span class="id">Hdefs2</span> <span class="kwd">as</span> (<span class="id">H2A</span> &amp; <span class="id">H2B</span> &amp; <span class="id">H2C</span> &amp; <span class="id">H2D</span> &amp; <span class="id">H2E</span>); <span class="tactic">clear</span> <span class="id">IHs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intro</span> <span class="id">x</span>. <span class="id">PS_split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> 1 <span class="kwd">as</span> [[[? ?]|[? ?]] [?|?]]; <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">eapply</span> <span class="id">H1A</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.inter_spec">PS.inter_spec</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">eapply</span> <span class="id">H2A</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.inter_spec">PS.inter_spec</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">HH</span>. <span class="tactic">apply</span> <span class="id">H2B</span> <span class="kwd">in</span> <span class="id">HH</span> <span class="kwd">as</span> [<span class="id">HH</span>|<span class="id">HH</span>]; [<span class="id">now</span> <span class="tactic">intuition</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H1B</span> <span class="kwd">in</span> <span class="id">HH</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">repeat</span> <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.diff_spec">PS.diff_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> [[[<span class="id">Hin</span> ?]|[<span class="id">Hin</span> ?]]|[<span class="id">Hin</span>|<span class="id">Hin</span>]]; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">repeat</span> <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.diff_spec">PS.diff_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hncw</span> [[[<span class="id">Hin</span> ?]|[<span class="id">Hin</span> ?]]|[<span class="id">Hin</span>|<span class="id">Hin</span>]]; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Call&nbsp;ys&nbsp;clsid&nbsp;o&nbsp;f&nbsp;es&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">H0</span> <span class="id">into</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#surjective_pairing">surjective_pairing</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)) <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hadd</span>. <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#ident_eq_dec">ident_eq_dec</a></span> <span class="id">x</span> <span class="id">ys</span>) <span class="kwd">as</span> [<span class="id">Hys</span>|<span class="id">Hnys</span>]; [<span class="tactic">left</span>|<span class="tactic">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_of_list_In">ps_of_list_In</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.In_snd_fold_right_add_valid">In_snd_fold_right_add_valid</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#ps_removes_spec">ps_removes_spec</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="tactic">try</span> <span class="id">not_In_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_of_list_In">ps_of_list_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hncw</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="tactic">try</span> <span class="id">not_In_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_of_list_In">ps_of_list_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">constructor</span>. <span class="tactic">rewrite</span> <span class="id">add_valid_add_valid</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_map">Forall_map</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">e</span> <span class="id">Hin</span> <span class="id">y</span> <span class="id">ty</span>. <span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Skip&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSF.empty_iff">PSF.empty_iff</a></span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.Can_write_in_add_writes_mono">Can_write_in_add_writes_mono</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tyenv</span> <span class="id">s</span> <span class="id">W</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#W">W</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">tyenv</span> <span class="id">s</span> <span class="id">W</span> <span class="id">x</span> <span class="id">Hcan</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSE.MP.fold_spec_right">PSE.MP.fold_spec_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.elements">PS.elements</a></span> <span class="id">W</span>)) <span class="kwd">as</span> <span class="id">ws</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> &lt;-<span class="id">Heqws</span>. <span class="tactic">clear</span> <span class="id">Heqws</span> <span class="id">W</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ws</span> <span class="kwd">as</span> [|<span class="id">w</span> <span class="id">ws</span> <span class="id">IH</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_write">add_write</a></span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">tyenv</span> <span class="id">w</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.Can_write_in_add_writes">Can_write_in_add_writes</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tyenv</span> <span class="id">s</span> <span class="id">W</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#W">W</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#W">W</a></span> \/ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">tyenv</span> <span class="id">s</span> <span class="id">W</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSE.MP.fold_spec_right">PSE.MP.fold_spec_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.elements">PS.elements</a></span> <span class="id">W</span>)) <span class="kwd">as</span> <span class="id">ws</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">W</span> &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">ws</span>) <span class="kwd">as</span> <span class="id">HinW</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intro</span> <span class="id">y</span>; <span class="tactic">subst</span> <span class="id">ws</span>. <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_rev">in_rev</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PSF.elements_iff">PSF.elements_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">HH</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.SetoidList.html#InA_alt">SetoidList.InA_alt</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> (? &amp; ? &amp; ?); <span class="tactic">subst</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> &lt;-<span class="id">Heqws</span>; <span class="tactic">rewrite</span> <span class="id">HinW</span>; <span class="tactic">clear</span> <span class="id">Heqws</span> <span class="id">HinW</span> <span class="id">W</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ws</span> <span class="kwd">as</span> [|<span class="id">w</span> <span class="id">ws</span> <span class="id">IH</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_write">add_write</a></span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">tyenv</span> <span class="id">w</span>); [<span class="tactic">intro</span> <span class="id">Hcw</span>|<span class="id">now</span> <span class="tactic">intuition</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hcw</span> <span class="kwd">as</span> [| | | | |? ? ? <span class="id">Hcw</span>'|? ? ? <span class="id">Hcw</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">inversion_clear</span> <span class="id">Hcw</span>'; <span class="tactic">auto</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.Can_write_in_add_defaults_stmt">Can_write_in_add_defaults_stmt</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tyenv</span> <span class="id">s</span> <span class="id">req</span> <span class="id">t</span> <span class="id">req</span>' <span class="id">st</span> <span class="id">al</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#req">req</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> = (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#t">t</a></span>, <span class="id">req</span>', <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#st">st</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#al">al</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> &lt;-&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#t">t</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Assign&nbsp;i&nbsp;e&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">inversion_clear</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;AssignSt&nbsp;i&nbsp;e&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">inversion_clear</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Ifte&nbsp;e&nbsp;s1&nbsp;s2&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span> * <span class="id">Hadd</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs1</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s1</span> = <span class="id">defs1</span>) <span class="kwd">as</span> <span class="id">Hdefs1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs1</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs1</span> <span class="kwd">as</span> [[[<span class="id">t1</span> <span class="id">rq1</span>] <span class="id">st1</span>] <span class="id">al1</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs2</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s2</span> = <span class="id">defs2</span>) <span class="kwd">as</span> <span class="id">Hdefs2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs2</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs2</span> <span class="kwd">as</span> [[[<span class="id">t2</span> <span class="id">rq2</span>] <span class="id">st2</span>] <span class="id">al2</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> ((<span class="id">al2</span> ∩ <span class="id">req</span>) — (<span class="id">al1</span> ∩ <span class="id">req</span>)) <span class="kwd">as</span> <span class="id">w1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> ((<span class="id">al1</span> ∩ <span class="id">req</span>) — (<span class="id">al2</span> ∩ <span class="id">req</span>)) <span class="kwd">as</span> <span class="id">w2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (((<span class="id">st1</span> ∩ <span class="id">req</span>) — <span class="id">w1</span>) ∪ ((<span class="id">st2</span> ∩ <span class="id">req</span>) — <span class="id">w2</span>)) <span class="kwd">as</span> <span class="id">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">IHs1</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">IHs2</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs2</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">Hcan</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.Can_write_in_add_writes_mono">Can_write_in_add_writes_mono</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hcan</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.CWIIfteTrue">CWIIfteTrue</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.Can_write_in_add_writes_mono">Can_write_in_add_writes_mono</a></span>, <span class="id">IHs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.CWIIfteFalse">CWIIfteFalse</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.Can_write_in_add_writes_mono">Can_write_in_add_writes_mono</a></span>, <span class="id">IHs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_inv1">add_defaults_stmt_inv1</a></span> <span class="kwd">in</span> <span class="id">Hdefs1</span> <span class="kwd">as</span> (? &amp; ? &amp; <span class="id">Hcw1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_inv1">add_defaults_stmt_inv1</a></span> <span class="kwd">in</span> <span class="id">Hdefs2</span> <span class="kwd">as</span> (? &amp; ? &amp; <span class="id">Hcw2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.Can_write_in_add_writes">Can_write_in_add_writes</a></span> <span class="kwd">in</span> <span class="id">Hcan</span> <span class="kwd">as</span> [<span class="id">Hcw</span>|<span class="id">Hcw</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">subst</span> <span class="id">w</span>; <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span> <span class="kwd">in</span> <span class="id">Hcw</span> <span class="kwd">as</span> [<span class="id">Hcw</span>|<span class="id">Hcw</span>]; <span class="id">PS_split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hcw</span> <span class="kwd">as</span> [| |? ? ? ? <span class="id">Hcw</span>'|? ? ? ? <span class="id">Hcw</span>'| | |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.Can_write_in_add_writes">Can_write_in_add_writes</a></span> <span class="kwd">in</span> <span class="id">Hcw</span>' <span class="kwd">as</span> [<span class="id">Hcw</span>|<span class="id">Hcw</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">subst</span> <span class="id">w1</span>; <span class="id">PS_split</span>; <span class="tactic">auto</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.CWIIfteTrue">CWIIfteTrue</a></span>, <span class="id">IHs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.Can_write_in_add_writes">Can_write_in_add_writes</a></span> <span class="kwd">in</span> <span class="id">Hcw</span>' <span class="kwd">as</span> [<span class="id">Hcw</span>|<span class="id">Hcw</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">subst</span> <span class="id">w2</span>; <span class="id">PS_split</span>; <span class="tactic">auto</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.CWIIfteFalse">CWIIfteFalse</a></span>, <span class="id">IHs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Comp&nbsp;s1&nbsp;s2&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span> * <span class="id">Hadd</span> <span class="id">x</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs2</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id">req</span> <span class="id">s2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id">req</span> <span class="id">s2</span> = <span class="id">defs2</span>) <span class="kwd">as</span> <span class="id">Hdefs2</span> <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs2</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs2</span> <span class="kwd">as</span> [[[<span class="id">t2</span> <span class="id">req2</span>] <span class="id">stimes2</span>] <span class="id">always2</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs1</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id">req2</span> <span class="id">s1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id">req2</span> <span class="id">s1</span> = <span class="id">defs1</span>) <span class="kwd">as</span> <span class="id">Hdefs1</span> <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs1</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs1</span> <span class="kwd">as</span> [[[<span class="id">t1</span> <span class="id">req1</span>] <span class="id">stimes1</span>] <span class="id">always1</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">injection</span> <span class="id">Hadd</span>; <span class="tactic">clear</span> <span class="id">Hadd</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">al</span> <span class="id">st</span> <span class="id">req</span>' <span class="id">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">IHs1</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs1</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">IHs2</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs2</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">inversion_clear</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">IHs1</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">IHs2</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;-<span class="id">IHs1</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;-<span class="id">IHs2</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Call&nbsp;ys&nbsp;clsid&nbsp;o&nbsp;f&nbsp;es&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span> * <span class="id">Hadd</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#surjective_pairing">surjective_pairing</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)) <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hadd</span>. <span class="tactic">split</span>; <span class="tactic">inversion_clear</span> 1; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Skip&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">inversion_clear</span> 1.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_stmt_no_write">add_defaults_stmt_no_write</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">tyenv</span> <span class="id">s</span> <span class="id">t</span> <span class="id">me</span> <span class="id">me</span>' <span class="id">ve</span> <span class="id">ve</span>' <span class="id">req</span> <span class="id">req</span>' <span class="id">stimes</span> <span class="id">always</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#req">req</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> = (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#t">t</a></span>, <span class="id">req</span>', <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#stimes">stimes</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always">always</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve">ve</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> (<span class="id">me</span>', <span class="id">ve</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, ~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#stimes">stimes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always">always</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">ve</span>' = <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve">ve</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</div>
<div class="proofscript" id="proof27">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span> <span class="kwd">as</span> [| | | |<span class="id">ys</span> <span class="id">clsid</span> <span class="id">o</span> <span class="id">f</span> <span class="id">es</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">t</span> <span class="id">me</span> <span class="id">me</span>' <span class="id">ve</span> <span class="id">ve</span>' <span class="id">rq</span> <span class="id">rq</span>' <span class="id">st</span> <span class="id">al</span> <span class="id">Hadd</span> <span class="id">Heval</span> <span class="id">x</span> <span class="id">Hnin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Assign&nbsp;i&nbsp;e&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hadd</span>. <span class="id">inv</span> <span class="id">Heval</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gso">Env.gso</a></span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;AssignSt&nbsp;i&nbsp;e&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hadd</span>. <span class="id">now</span> <span class="id">inv</span> <span class="id">Heval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Ifte&nbsp;e&nbsp;s1&nbsp;s2&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hadd</span> <span class="kwd">as</span> [<span class="id">Hadd</span>']; <span class="tactic">clear</span> <span class="id">Hadd</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs1</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s1</span> = <span class="id">defs1</span>) <span class="kwd">as</span> <span class="id">Hdefs1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs1</span> <span class="kwd">in</span> <span class="id">Hadd</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs1</span> <span class="kwd">as</span> [[[<span class="id">t1</span> <span class="id">rq1</span>] <span class="id">st1</span>] <span class="id">al1</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs2</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s2</span> = <span class="id">defs2</span>) <span class="kwd">as</span> <span class="id">Hdefs2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs2</span> <span class="kwd">in</span> <span class="id">Hadd</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs2</span> <span class="kwd">as</span> [[[<span class="id">t2</span> <span class="id">rq2</span>] <span class="id">st2</span>] <span class="id">al2</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hadd</span>'. <span class="id">inv</span> <span class="id">Heval</span>. <span class="tactic">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">s1</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHs1</span> <span class="kwd">with</span> (1:=<span class="id">Hdefs1</span>) (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">auto</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">PS_split</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">s2</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHs2</span> <span class="kwd">with</span> (1:=<span class="id">Hdefs2</span>) (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">auto</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">PS_split</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Comp&nbsp;s1&nbsp;s2&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hadd</span> <span class="kwd">as</span> [<span class="id">Hadd</span>']; <span class="tactic">clear</span> <span class="id">Hadd</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs2</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id">rq</span> <span class="id">s2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id">rq</span> <span class="id">s2</span> = <span class="id">defs2</span>) <span class="kwd">as</span> <span class="id">Hdefs2</span> <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs2</span> <span class="kwd">in</span> <span class="id">Hadd</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs2</span> <span class="kwd">as</span> [[[<span class="id">t2</span> <span class="id">rq2</span>] <span class="id">st2</span>] <span class="id">al2</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs1</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id">rq2</span> <span class="id">s1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id">rq2</span> <span class="id">s1</span> = <span class="id">defs1</span>) <span class="kwd">as</span> <span class="id">Hdefs1</span> <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs1</span> <span class="kwd">in</span> <span class="id">Hadd</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs1</span> <span class="kwd">as</span> [[[<span class="id">t1</span> <span class="id">rq1</span>] <span class="id">st1</span>] <span class="id">al1</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hadd</span>'. <span class="id">inv</span> <span class="id">Heval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">s2</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHs2</span> <span class="kwd">with</span> (1:=<span class="id">Hdefs2</span>) (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">H</span>; [<span class="tactic">rewrite</span> <span class="id">H</span>|] <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">s1</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHs1</span> <span class="kwd">with</span> (1:=<span class="id">Hdefs1</span>) (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">H</span>; [<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H</span>|] <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intro</span> <span class="id">Hin</span>; <span class="tactic">apply</span> <span class="id">Hnin</span>; <span class="tactic">clear</span> <span class="id">Hnin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.In_dec">PSP.In_dec</a></span> <span class="id">x</span> <span class="id">al2</span>). <span class="id">now</span> <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intro</span> <span class="id">Hin</span>; <span class="tactic">apply</span> <span class="id">Hnin</span>; <span class="tactic">clear</span> <span class="id">Hnin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.In_dec">PSP.In_dec</a></span> <span class="id">x</span> <span class="id">al1</span>). <span class="id">now</span> <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Call&nbsp;ys&nbsp;clsid&nbsp;o&nbsp;f&nbsp;es&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#surjective_pairing">surjective_pairing</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)) <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hadd</span>. <span class="id">inv</span> <span class="id">Heval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.find_In_gsso_opt">Env.find_In_gsso_opt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hin</span>; <span class="tactic">apply</span> <span class="id">Hnin</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSF.union_3">PSF.union_3</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#ps_of_list_In">ps_of_list_In</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Skip&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">inv</span> <span class="id">Heval</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.wt_method_add_defaults">wt_method_add_defaults</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">insts</span> <span class="id">mem</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_method">wt_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#insts">insts</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#mem">mem</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_method">wt_method</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#insts">insts</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#mem">mem</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_method">wt_method</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.meth_vars">meth_vars</a></span>. <span class="tactic">intros</span> * <span class="id">WTm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">m</span> <span class="kwd">as</span> [<span class="id">n</span> <span class="id">ins</span> <span class="id">vars</span> <span class="id">outs</span> <span class="id">s</span> <span class="id">nodup</span> <span class="id">good</span>]; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="id">inv</span> <span class="id">WTm</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_stmt">wt_stmt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_class">find_class</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.find_class_add_defaults_class">find_class_add_defaults_class</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_method">find_method</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.find_method_add_defaults_method">find_method_add_defaults_method</a></span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.find_method_map_add_defaults_method">find_method_map_add_defaults_method</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method_m_out">add_defaults_method_m_out</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method_m_in">add_defaults_method_m_in</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="OBCADDDEFAULTS.AddDefaultsStmt">AddDefaultsStmt</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variables</span> (<span class="id"><a name="OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.class">class</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="OBCADDDEFAULTS.AddDefaultsStmt.insts">insts</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="OBCADDDEFAULTS.AddDefaultsStmt.mems">mems</a></span>  : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op.type">type</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span>  : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op.type">type</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> : <span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op.type">type</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="OBCADDDEFAULTS.AddDefaultsStmt.wf_vars_tyenv">wf_vars_tyenv</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ty">ty</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span> &lt;-&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ty">ty</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">wf_vars_tyenv</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span> &lt;-&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</div>
<div class="proofscript" id="proof29">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_In">InMembers_In</a></span> <span class="kwd">in</span> <span class="id">HH</span> <span class="kwd">as</span> (<span class="id">ty</span>, <span class="id">HH</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.wf_vars_tyenv">wf_vars_tyenv</a></span> <span class="kwd">in</span> <span class="id">HH</span>. <span class="tactic">rewrite</span> <span class="id">HH</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#not_None_is_Some">not_None_is_Some</a></span> <span class="kwd">in</span> <span class="id">HH</span> <span class="kwd">as</span> (<span class="id">ty</span>, <span class="id">HH</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.wf_vars_tyenv">wf_vars_tyenv</a></span> <span class="kwd">in</span> <span class="id">HH</span>. <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">add_writes_wt</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">W</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_stmt">wt_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.insts">insts</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.mems">mems</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#W">W</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_stmt">wt_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.insts">insts</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.mems">mems</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">W</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.fold_spec">PS.fold_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.elements">PS.elements</a></span> <span class="id">W</span>); <span class="tactic">clear</span> <span class="id">W</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">ws</span>. <span class="tactic">induction</span> <span class="id">ws</span> <span class="kwd">as</span> [|<span class="id">w</span> <span class="id">ws</span> <span class="id">IH</span>]; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s</span> <span class="id">Hwws</span>. <span class="tactic">apply</span> <span class="id">IH</span> <span class="kwd">in</span> <span class="id">Hwws</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_write">add_write</a></span> <span class="kwd">in</span> <span class="id">Hwws</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id">w</span>); <span class="tactic">auto</span>. <span class="id">now</span> <span class="id">inv</span> <span class="id">Hwws</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_writes_wt">add_writes_wt</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">W</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#W">W</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_stmt">wt_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.insts">insts</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.mems">mems</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_stmt">wt_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.insts">insts</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.mems">mems</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#W">W</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">W</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.fold_spec">PS.fold_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_Forall">PS_For_all_Forall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.elements">PS.elements</a></span> <span class="id">W</span>); <span class="tactic">clear</span> <span class="id">W</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">ws</span>. <span class="tactic">induction</span> <span class="id">ws</span> <span class="kwd">as</span> [|<span class="id">w</span> <span class="id">ws</span> <span class="id">IH</span>]; <span class="tactic">simpl</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s</span> <span class="id">Hwws</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hwws</span> <span class="kwd">as</span> [|? ? <span class="id">Hw</span> <span class="id">Hws</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">IH</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#not_None_is_Some">not_None_is_Some</a></span> <span class="kwd">in</span> <span class="id">Hw</span> <span class="kwd">as</span> (<span class="id">ty</span> &amp; <span class="id">Hw</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_write">add_write</a></span>. <span class="tactic">rewrite</span> <span class="id">Hw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.wf_vars_tyenv">wf_vars_tyenv</a></span> <span class="kwd">in</span> <span class="id">Hw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>; <span class="tactic">eauto</span>; <span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_exp">wt_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op.type_init_type">type_init_type</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">inversion</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_stmt_wt">add_defaults_stmt_wt</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">t</span> <span class="id">req</span> <span class="id">req</span>' <span class="id">stimes</span> <span class="id">always</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#req">req</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> = (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#t">t</a></span>, <span class="id">req</span>', <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#stimes">stimes</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always">always</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_stmt">wt_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.insts">insts</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.mems">mems</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_stmt">wt_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.insts">insts</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.mems">mems</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#t">t</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#stimes">stimes</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always">always</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#req">req</a></span> \/ <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span>) <span class="id">req</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</div>
<div class="proofscript" id="proof32">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">intros</span> * <span class="id">Hadd</span> <span class="id">WTs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">injection</span> <span class="id">Hadd</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">always</span> <span class="id">stimes</span> <span class="id">req</span>' <span class="id">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Assign&nbsp;i&nbsp;e&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_empty">PS_For_all_empty</a></span>; <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.singleton_spec">PS.singleton_spec</a></span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTs</span>. <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.remove_spec">PS.remove_spec</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (? &amp; ?); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;AssignSt&nbsp;i&nbsp;e&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_empty">PS_For_all_empty</a></span>. <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Ifte&nbsp;e&nbsp;s1&nbsp;s2&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">WTs</span> <span class="kwd">as</span> [| |? ? ? ? ? <span class="id">Hwt1</span> <span class="id">Hwt2</span>| | |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs1</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s1</span> = <span class="id">defs1</span>) <span class="kwd">as</span> <span class="id">Hdefs1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs1</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs1</span> <span class="kwd">as</span> [[[<span class="id">t1</span> <span class="id">rq1</span>] <span class="id">st1</span>] <span class="id">al1</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs2</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s2</span> = <span class="id">defs2</span>) <span class="kwd">as</span> <span class="id">Hdefs2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs2</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs2</span> <span class="kwd">as</span> [[[<span class="id">t2</span> <span class="id">rq2</span>] <span class="id">st2</span>] <span class="id">al2</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">injection</span> <span class="id">Hadd</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">always</span> <span class="id">stimes</span> <span class="id">req</span>' <span class="id">t</span>; <span class="tactic">clear</span> <span class="id">Hadd</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHs1</span> <span class="kwd">with</span> (2:=<span class="id">Hwt1</span>) <span class="kwd">in</span> <span class="id">Hdefs1</span> <span class="kwd">as</span> (<span class="id">WTt1</span> &amp; <span class="id">Hst1</span> &amp; <span class="id">Hal1</span> &amp; <span class="id">Hrq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHs2</span> <span class="kwd">with</span> (2:=<span class="id">Hwt2</span>) <span class="kwd">in</span> <span class="id">Hdefs2</span> <span class="kwd">as</span> (<span class="id">WTt2</span> &amp; <span class="id">Hst2</span> &amp; <span class="id">Hal2</span> &amp; <span class="id">Hrq2</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">setoid_rewrite</span> <span class="id">wf_vars_tyenv</span>' <span class="kwd">in</span> <span class="id">Hst1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">wf_vars_tyenv</span>' <span class="kwd">in</span> <span class="id">Hst2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">wf_vars_tyenv</span>' <span class="kwd">in</span> <span class="id">Hal1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">wf_vars_tyenv</span>' <span class="kwd">in</span> <span class="id">Hal2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes_wt">add_writes_wt</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_union">PS_For_all_union</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_diff">PS_For_all_diff</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_inter">PS_For_all_inter</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes_wt">add_writes_wt</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_union">PS_For_all_union</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_diff">PS_For_all_diff</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_inter">PS_For_all_inter</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">HH</span>. <span class="id">PS_split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id">_</span> \/ <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="id">PS_split</span> <span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Hi</span>:<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> ?<span class="id">x</span> ?<span class="id">S</span>, <span class="id">Hf</span>:<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> <span class="id">_</span> ?<span class="id">S</span> |- <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> ?<span class="id">x</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_In_Forall">PS_In_Forall</a></span> <span class="kwd">with</span> (1:=<span class="id">Hf</span>); <span class="tactic">auto</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">HH</span>. <span class="id">PS_split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id">_</span> \/ <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="id">PS_split</span> <span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Hi</span>:<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> ?<span class="id">x</span> ?<span class="id">S</span>, <span class="id">Hf</span>:<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> <span class="id">_</span> ?<span class="id">S</span> |- <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> ?<span class="id">x</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_In_Forall">PS_In_Forall</a></span> <span class="kwd">with</span> (1:=<span class="id">Hf</span>); <span class="tactic">auto</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">HH</span>. <span class="id">PS_split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id">_</span> \/ <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="id">PS_split</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Hi</span>:<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> ?<span class="id">x</span> ?<span class="id">S</span>, <span class="id">Hf</span>:<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> <span class="id">_</span> ?<span class="id">S</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_In_Forall">PS_In_Forall</a></span> <span class="kwd">with</span> (1:=<span class="id">Hf</span>) <span class="kwd">in</span> <span class="id">Hi</span> <span class="kwd">as</span> [?|?]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">_</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#not_In_empty">not_In_empty</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Comp&nbsp;s1&nbsp;s2&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">WTs</span> <span class="kwd">as</span> [| | |? ? <span class="id">Hwt1</span> <span class="id">Hwt2</span>| |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs2</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id">req</span> <span class="id">s2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id">req</span> <span class="id">s2</span> = <span class="id">defs2</span>) <span class="kwd">as</span> <span class="id">Hdefs2</span> <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs2</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs2</span> <span class="kwd">as</span> [[[<span class="id">t2</span> <span class="id">rq2</span>] <span class="id">stimes2</span>] <span class="id">always2</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs1</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id">rq2</span> <span class="id">s1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id">rq2</span> <span class="id">s1</span> = <span class="id">defs1</span>) <span class="kwd">as</span> <span class="id">Hdefs1</span> <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs1</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs1</span> <span class="kwd">as</span> [[[<span class="id">t1</span> <span class="id">rq1</span>] <span class="id">stimes1</span>] <span class="id">always1</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">injection</span> <span class="id">Hadd</span>; <span class="tactic">clear</span> <span class="id">Hadd</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">always</span> <span class="id">stimes</span> <span class="id">req</span>' <span class="id">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHs1</span> <span class="kwd">with</span> (2:=<span class="id">Hwt1</span>) <span class="kwd">in</span> <span class="id">Hdefs1</span> <span class="kwd">as</span> (<span class="id">IHt1</span> &amp; <span class="id">Hst1</span> &amp; <span class="id">Hal1</span> &amp; <span class="id">Hrq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHs2</span> <span class="kwd">with</span> (2:=<span class="id">Hwt2</span>) <span class="kwd">in</span> <span class="id">Hdefs2</span> <span class="kwd">as</span> (<span class="id">IHt2</span> &amp; <span class="id">Hst2</span> &amp; <span class="id">Hal2</span> &amp; <span class="id">Hrq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_stmt">wt_stmt</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_union">PS_For_all_union</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_diff">PS_For_all_diff</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_diff">PS_For_all_diff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_In_Forall">PS_In_Forall</a></span> <span class="kwd">with</span> (1:=<span class="id">Hrq1</span>) <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Call&nbsp;ys&nbsp;clsid&nbsp;o&nbsp;f&nbsp;es&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#surjective_pairing">surjective_pairing</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)) <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hadd</span>. <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_empty">PS_For_all_empty</a></span>; <span class="id">inv</span> <span class="id">WTs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>; <span class="tactic">rewrite</span> <span class="id">add_valid_add_valid</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span> <span class="kwd">with</span> (2:=<span class="id">H</span>) <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">e</span> (<span class="id">x</span>, <span class="id">ty</span>) <span class="id">Hin1</span> <span class="id">Hin2</span> <span class="id">Htye</span>; <span class="tactic">rewrite</span> &lt;-<span class="id">Htye</span>. <span class="id">now</span> <span class="tactic">destruct</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_map">Forall_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_impl_In">Forall_impl_In</a></span> <span class="kwd">with</span> (2:=<span class="id">H</span>) <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">e</span> <span class="id">Hin</span> <span class="id">WTe</span>. <span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="id">inv</span> <span class="id">WTe</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_exp">wt_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_of_list_In">ps_of_list_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_in_left">Forall2_in_left</a></span> <span class="kwd">with</span> (1:=<span class="id">H</span>) <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (<span class="id">xty</span> &amp; <span class="id">Hin1</span> &amp; <span class="id">Hin2</span>) <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_exp">wt_exp</a></span> <span class="id">_</span> <span class="id">_</span>) ?<span class="id">xs</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span>; <span class="tactic">clear</span>; <span class="tactic">induction</span> <span class="id">l0</span> <span class="kwd">as</span> [|<span class="id">e</span> <span class="id">es</span> <span class="id">IH</span>] <span class="kwd">end</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">WT</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_removes_spec">ps_removes_spec</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (? &amp; ?); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_cons2">Forall_cons2</a></span> <span class="kwd">in</span> <span class="id">WT</span> <span class="kwd">as</span> (<span class="id">WTe</span> &amp; <span class="id">WTes</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">WTe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.add_spec">PS.add_spec</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="tactic">subst</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Skip&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_empty">PS_For_all_empty</a></span>; <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_stmt_inv2">add_defaults_stmt_inv2</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">t</span> <span class="id">me</span> <span class="id">me</span>' <span class="id">ve</span> <span class="id">ve</span>' <span class="id">req</span> <span class="id">req</span>' <span class="id">stimes</span> <span class="id">always</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#req">req</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> = (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#t">t</a></span>, <span class="id">req</span>', <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#stimes">stimes</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always">always</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve">ve</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#t">t</a></span> (<span class="id">me</span>', <span class="id">ve</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_stmt">wt_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.insts">insts</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.mems">mems</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">req</span>' -&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve">ve</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ome</span> <span class="id">ome</span>' <span class="id">clsid</span> <span class="id">f</span> <span class="id">vos</span> <span class="id">rvos</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">vo</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vo">vo</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vos">vos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_call_eval">stmt_call_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ome">ome</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#clsid">clsid</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#f">f</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vos">vos</a></span> <span class="id">ome</span>' <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rvos">rvos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rvos">rvos</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, ~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#stimes">stimes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always">always</a></span>) -&gt; <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">ve</span>' = <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve">ve</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#always">always</a></span> -&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">ve</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</div>
<div class="proofscript" id="proof33">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hadd</span> <span class="id">Heval</span> <span class="id">Hwt</span> <span class="id">Hre1</span> <span class="id">Hcall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">t</span> <span class="id">me</span> <span class="id">me</span>' <span class="id">ve</span> <span class="id">ve</span>' <span class="id">Heval</span> <span class="id">req</span> <span class="id">req</span>' <span class="id">stimes</span> <span class="id">always</span> <span class="id">Hadd</span> <span class="id">Hre1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span> <span class="kwd">as</span> [| | | |<span class="id">ys</span> <span class="id">clsid</span> <span class="id">o</span> <span class="id">f</span> <span class="id">es</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">t</span> <span class="id">me</span> <span class="id">me</span>' <span class="id">ve</span> <span class="id">ve</span>' <span class="id">Heval</span> <span class="id">rq</span> <span class="id">rq</span>' <span class="id">st</span> <span class="id">al</span> <span class="id">Hadd</span> <span class="id">Hre1</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Assign&nbsp;i&nbsp;e&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hadd</span>. <span class="id">inv</span> <span class="id">Heval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSP.empty_inter_1">PSP.empty_inter_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hnin</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gso">Env.gso</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hnin</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PSF.union_3">PSF.union_3</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.singleton_spec">PS.singleton_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSP.FM.singleton_1">PSP.FM.singleton_1</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.add_in_iff">Env.Props.P.F.add_in_iff</a></span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;AssignSt&nbsp;i&nbsp;e&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hadd</span>. <span class="id">inv</span> <span class="id">Heval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSF.empty_iff">PSF.empty_iff</a></span>; <span class="tactic">intuition</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Ifte&nbsp;e&nbsp;s1&nbsp;s2&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;unfold&nbsp;the&nbsp;two&nbsp;recursive&nbsp;calls&nbsp;to&nbsp;add_defaults_stmt&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hadd</span> <span class="kwd">as</span> [<span class="id">Hadd</span>']; <span class="tactic">clear</span> <span class="id">Hadd</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs1</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s1</span> = <span class="id">defs1</span>) <span class="kwd">as</span> <span class="id">Hdefs1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs1</span> <span class="kwd">in</span> <span class="id">Hadd</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs1</span> <span class="kwd">as</span> [[[<span class="id">t1</span> <span class="id">rq1</span>] <span class="id">st1</span>] <span class="id">al1</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs2</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s2</span> = <span class="id">defs2</span>) <span class="kwd">as</span> <span class="id">Hdefs2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs2</span> <span class="kwd">in</span> <span class="id">Hadd</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs2</span> <span class="kwd">as</span> [[[<span class="id">t2</span> <span class="id">rq2</span>] <span class="id">st2</span>] <span class="id">al2</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">injection</span> <span class="id">Hadd</span>'; <span class="tactic">clear</span> <span class="id">Hadd</span>'. <span class="tactic">intros</span>. <span class="tactic">subst</span> <span class="id">al</span> <span class="id">st</span> <span class="id">rq</span>' <span class="id">t</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;use&nbsp;typing&nbsp;to&nbsp;deduce&nbsp;that&nbsp;added&nbsp;writes&nbsp;are&nbsp;in&nbsp;tyenv&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hwt</span> <span class="kwd">as</span> [| |? ? ? ? ? <span class="id">Hwt1</span> <span class="id">Hwt2</span>| | |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">IHs1</span> <span class="id">Hwt1</span>). <span class="tactic">specialize</span> (<span class="id">IHs2</span> <span class="id">Hwt2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_wt">add_defaults_stmt_wt</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs1</span> <span class="id">Hwt1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">Ht1</span> &amp; <span class="id">HTst1</span> &amp; <span class="id">HTal1</span> &amp; <span class="id">HTreq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_wt">add_defaults_stmt_wt</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs2</span> <span class="id">Hwt2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">Ht2</span> &amp; <span class="id">HTst2</span> &amp; <span class="id">HTal2</span> &amp; <span class="id">HTreq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Ht1</span> <span class="id">Ht2</span> <span class="id">Hwt1</span> <span class="id">Hwt2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">wf_vars_tyenv</span>' <span class="kwd">in</span> <span class="id">HTst1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">wf_vars_tyenv</span>' <span class="kwd">in</span> <span class="id">HTal1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">wf_vars_tyenv</span>' <span class="kwd">in</span> <span class="id">HTst2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">wf_vars_tyenv</span>' <span class="kwd">in</span> <span class="id">HTal2</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes_split">stmt_eval_add_writes_split</a></span> <span class="kwd">in</span> <span class="id">Heval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Heval</span> <span class="kwd">as</span> (<span class="id">meW</span> &amp; <span class="id">veW</span> &amp; <span class="id">HevalW</span> &amp; <span class="id">Heval</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;massage&nbsp;the&nbsp;stmt_evals&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Heval</span> <span class="kwd">as</span> [| | | |? ? ? ? ? ? ? ? ? ? ? ? <span class="id">Heval</span>'|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">meW</span>' <span class="id">veW</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id">meW</span> <span class="id">veW</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id">b</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> ((<span class="id">al2</span> ∩ <span class="id">rq</span>) — (<span class="id">al1</span> ∩ <span class="id">rq</span>)) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Skip">Skip</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> ((<span class="id">al1</span> ∩ <span class="id">rq</span>) — (<span class="id">al2</span> ∩ <span class="id">rq</span>)) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Skip">Skip</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">meW</span>', <span class="id">veW</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id">meW</span>' <span class="id">veW</span>' (<span class="kwd">if</span> <span class="id">b</span> <span class="kwd">then</span> <span class="id">t1</span> <span class="kwd">else</span> <span class="id">t2</span>) (<span class="id">me</span>', <span class="id">ve</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">Heval</span>'' <span class="tactic">by</span> (<span class="tactic">destruct</span> <span class="id">b</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes_split">stmt_eval_add_writes_split</a></span> <span class="kwd">in</span> <span class="id">Heval</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Heval</span>' <span class="kwd">as</span> (<span class="id">meW</span>' &amp; <span class="id">veW</span>' &amp; <span class="id">HevalW</span>' &amp; <span class="id">Heval</span>');<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Heval</span>'. <span class="tactic">destruct</span> <span class="id">Heval</span>'' <span class="kwd">as</span> (<span class="id">meW</span>' &amp; <span class="id">veW</span>' &amp; <span class="id">HevalW</span>' &amp; <span class="id">Heval</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;factor&nbsp;out&nbsp;obligations&nbsp;for&nbsp;inductive&nbsp;hypotheses&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, (<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">rq1</span> \/ <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">rq2</span>) -&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">veW</span>') <span class="kwd">as</span> <span class="id">Hreq</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hrq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">stmt_eval_mono</span>' <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">HevalW</span>'; <span class="tactic">auto</span>; <span class="tactic">clear</span> <span class="id">HevalW</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.No_Naked_Vars_add_writes">No_Naked_Vars_add_writes</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id">_</span> ?<span class="id">W</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Skip">Skip</a></span>) <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.In_dec">PSP.In_dec</a></span> <span class="id">x</span> <span class="id">W</span>) <span class="kwd">as</span> [<span class="id">Hw</span>|<span class="id">Hnw</span>] <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes">stmt_eval_add_writes</a></span> <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">HevalW</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_union">PS_For_all_union</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_diff">PS_For_all_diff</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_inter">PS_For_all_inter</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">stmt_eval_mono</span>' <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">HevalW</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.No_Naked_Vars_add_writes">No_Naked_Vars_add_writes</a></span>; <span class="tactic">auto</span>. <span class="tactic">intuition</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">rq1</span> -&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">veW</span>') <span class="kwd">as</span> <span class="id">Hreq1</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">rq2</span> -&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">veW</span>') <span class="kwd">as</span> <span class="id">Hreq2</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Hreq</span>'.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Put&nbsp;some&nbsp;structure&nbsp;back&nbsp;into&nbsp;the&nbsp;sets&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> ((<span class="id">al2</span> ∩ <span class="id">rq</span>) — (<span class="id">al1</span> ∩ <span class="id">rq</span>)) <span class="kwd">as</span> <span class="id">w1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> ((<span class="id">al1</span> ∩ <span class="id">rq</span>) — (<span class="id">al2</span> ∩ <span class="id">rq</span>)) <span class="kwd">as</span> <span class="id">w2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (((<span class="id">st1</span> ∩ <span class="id">rq</span>) — <span class="id">w1</span>) ∪ ((<span class="id">st2</span> ∩ <span class="id">rq</span>) — <span class="id">w2</span>)) <span class="kwd">as</span> <span class="id">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.simplify_write_sets">simplify_write_sets</a></span> <span class="id">w</span> <span class="id">w1</span> <span class="id">w2</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Heqw1</span> <span class="id">Heqw2</span> <span class="id">Heqw</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;forall&nbsp;x,&nbsp;~x&nbsp;∈&nbsp;(st&nbsp;∪&nbsp;al)&nbsp;-&gt;&nbsp;Env.find&nbsp;x&nbsp;env'&nbsp;=&nbsp;Env.find&nbsp;x&nbsp;env&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_not_union">PS_not_union</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> (<span class="id">Hnw</span> &amp; <span class="id">Hnw1</span> &amp; <span class="id">Hnw2</span> &amp; <span class="id">Hnal1</span> &amp; <span class="id">Hnal2</span> &amp; <span class="id">Hnst1</span> &amp; <span class="id">Hnst2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">clear</span> <span class="id">IHs2</span>; <span class="tactic">specialize</span> (<span class="id">IHs1</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Heval</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs1</span> <span class="id">Hreq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHs1</span> <span class="kwd">as</span> (<span class="id">IH1</span> &amp; <span class="id">IH2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IH1</span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_not_union">PS_not_union</a></span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes_Skip_other">stmt_eval_add_writes_Skip_other</a></span> <span class="kwd">with</span> (1:=<span class="id">HevalW</span>'); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes_Skip_other">stmt_eval_add_writes_Skip_other</a></span> <span class="kwd">with</span> (1:=<span class="id">HevalW</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">clear</span> <span class="id">IHs1</span>; <span class="tactic">specialize</span> (<span class="id">IHs2</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Heval</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs2</span> <span class="id">Hreq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHs2</span> <span class="kwd">as</span> (<span class="id">IH1</span> &amp; <span class="id">IH2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IH1</span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_not_union">PS_not_union</a></span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes_Skip_other">stmt_eval_add_writes_Skip_other</a></span> <span class="kwd">with</span> (1:=<span class="id">HevalW</span>'); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes_Skip_other">stmt_eval_add_writes_Skip_other</a></span> <span class="kwd">with</span> (1:=<span class="id">HevalW</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;forall&nbsp;x,&nbsp;x&nbsp;∈&nbsp;al&nbsp;-&gt;&nbsp;Env.In&nbsp;x&nbsp;env'&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.inter_spec">PS.inter_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_inv1">add_defaults_stmt_inv1</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs1</span>) <span class="kwd">as</span> (<span class="id">H1A</span> &amp; <span class="id">H1B</span> &amp; <span class="id">H1C</span> &amp; <span class="id">H1D</span> &amp; <span class="id">H1E</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_inv1">add_defaults_stmt_inv1</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs2</span>) <span class="kwd">as</span> (<span class="id">H2A</span> &amp; <span class="id">H2B</span> &amp; <span class="id">H2C</span> &amp; <span class="id">H2D</span> &amp; <span class="id">H2E</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> [[[<span class="id">Hal1</span>|<span class="id">Hiw1</span>] [<span class="id">Hal2</span>|<span class="id">Hiw2</span>]]|<span class="id">Hiw</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHs1</span> <span class="kwd">with</span> (2:=<span class="id">Hdefs1</span>) (3:=<span class="id">Hreq1</span>) <span class="kwd">in</span> <span class="id">Heval</span> <span class="kwd">as</span> (? &amp; ?); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHs2</span> <span class="kwd">with</span> (2:=<span class="id">Hdefs2</span>) (3:=<span class="id">Hreq2</span>) <span class="kwd">in</span> <span class="id">Heval</span> <span class="kwd">as</span> (? &amp; ?); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHs1</span> <span class="kwd">with</span> (2:=<span class="id">Hdefs1</span>) (3:=<span class="id">Hreq1</span>) <span class="kwd">in</span> <span class="id">Heval</span> <span class="kwd">as</span> (? &amp; ?); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">stmt_eval_mono</span>' <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">Heval</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes">stmt_eval_add_writes</a></span> <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">HevalW</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_diff">PS_For_all_diff</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_inter">PS_For_all_inter</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHs2</span> <span class="kwd">with</span> (2:=<span class="id">Hdefs2</span>) (3:=<span class="id">Hreq2</span>) <span class="kwd">in</span> <span class="id">Heval</span> <span class="kwd">as</span> (? &amp; ?); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">stmt_eval_mono</span>' <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">Heval</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes">stmt_eval_add_writes</a></span> <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">HevalW</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_diff">PS_For_all_diff</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_inter">PS_For_all_inter</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">stmt_eval_mono</span>' <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">Heval</span>; <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes">stmt_eval_add_writes</a></span> <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">HevalW</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_diff">PS_For_all_diff</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_inter">PS_For_all_inter</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">stmt_eval_mono</span>' <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">Heval</span>; [| |<span class="tactic">destruct</span> <span class="id">b</span>|]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">stmt_eval_mono</span>' <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">HevalW</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.No_Naked_Vars_add_writes">No_Naked_Vars_add_writes</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes">stmt_eval_add_writes</a></span> <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">HevalW</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_union">PS_For_all_union</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_diff">PS_For_all_diff</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_inter">PS_For_all_inter</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Comp&nbsp;s1&nbsp;s2&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_inv1">add_defaults_stmt_inv1</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hadd</span>) <span class="kwd">as</span> (<span class="id">HIc</span> &amp; <span class="id">HId</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hwt</span> <span class="kwd">as</span> [| | |? ? <span class="id">Hwt1</span> <span class="id">Hwt2</span>| |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">IHs1</span> <span class="id">Hwt1</span>). <span class="tactic">specialize</span> (<span class="id">IHs2</span> <span class="id">Hwt2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Hwt1</span> <span class="id">Hwt2</span>. <span class="tactic">inversion</span> <span class="id">Hadd</span> <span class="kwd">as</span> [<span class="id">Hadd</span>']; <span class="tactic">clear</span> <span class="id">Hadd</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;unfold&nbsp;the&nbsp;two&nbsp;recursive&nbsp;calls&nbsp;to&nbsp;add_defaults_stmt&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs2</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id">rq</span> <span class="id">s2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id">rq</span> <span class="id">s2</span> = <span class="id">defs2</span>) <span class="kwd">as</span> <span class="id">Hdefs2</span> <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs2</span> <span class="kwd">in</span> <span class="id">Hadd</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs2</span> <span class="kwd">as</span> [[[<span class="id">t2</span> <span class="id">rq2</span>] <span class="id">st2</span>] <span class="id">al2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_inv1">add_defaults_stmt_inv1</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">HI2c</span> &amp; <span class="id">HI2d</span> &amp; <span class="id">HI2e</span> &amp; <span class="id">HI2f</span> &amp; <span class="id">HI2g</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs1</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id">rq2</span> <span class="id">s1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id">rq2</span> <span class="id">s1</span> = <span class="id">defs1</span>) <span class="kwd">as</span> <span class="id">Hdefs1</span> <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs1</span> <span class="kwd">in</span> <span class="id">Hadd</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs1</span> <span class="kwd">as</span> [[[<span class="id">t1</span> <span class="id">rq1</span>] <span class="id">st1</span>] <span class="id">al1</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_inv1">add_defaults_stmt_inv1</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">HI1c</span> &amp; <span class="id">HI1d</span> &amp; <span class="id">HI1e</span> &amp; <span class="id">HI1f</span> &amp; <span class="id">HI1g</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">injection</span> <span class="id">Hadd</span>'; <span class="tactic">clear</span> <span class="id">Hadd</span>'; <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">al</span> <span class="id">st</span> <span class="id">rq</span>' <span class="id">t</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;massage&nbsp;the&nbsp;stmt_evals&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Heval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H1</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">t1</span> <span class="id">_</span>, <span class="id">H2</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">t2</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">IHs1</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H1</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs1</span> <span class="id">Hre1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">H1</span> <span class="id">into</span> <span class="id">Heval1</span>; <span class="tactic">clear</span> <span class="id">Hdefs1</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHs1</span> <span class="kwd">as</span> (<span class="id">HI1a</span> &amp; <span class="id">HI1b</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;factor&nbsp;out&nbsp;obligations&nbsp;for&nbsp;inductive&nbsp;hypotheses&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">rq2</span> -&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">ve1</span>) <span class="kwd">as</span> <span class="id">Hre2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>. <span class="tactic">apply</span> <span class="id">HI1d</span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [|<span class="id">Hin</span>]; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id">stmt_eval_mono</span>'. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H1</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">t1</span> <span class="id">_</span>, <span class="id">H2</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">t2</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">IHs2</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H2</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs2</span> <span class="id">Hre2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">H2</span> <span class="id">into</span> <span class="id">Heval2</span>; <span class="tactic">clear</span> <span class="id">Hdefs2</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHs2</span> <span class="kwd">as</span> (<span class="id">HI2a</span> &amp; <span class="id">HI2b</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;forall&nbsp;x,&nbsp;~x&nbsp;∈&nbsp;(st&nbsp;∪&nbsp;al)&nbsp;-&gt;&nbsp;Env.find&nbsp;x&nbsp;env'&nbsp;=&nbsp;Env.find&nbsp;x&nbsp;env&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hnin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (~<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id">st1</span> <span class="id">al1</span>) (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id">st2</span> <span class="id">al2</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> <span class="id">Hnin</span>'. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_not_union">PS_not_union</a></span> <span class="kwd">in</span> <span class="id">Hnin</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hnin</span>' <span class="kwd">as</span> [[<span class="id">HH1</span> <span class="id">HH2</span>] [<span class="id">HH3</span> <span class="id">HH4</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HI2a</span>, <span class="id">HI1a</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_not_union">PS_not_union</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_not_union">PS_not_union</a></span> <span class="kwd">in</span> <span class="id">Hnin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hnin</span> <span class="kwd">as</span> [[<span class="id">HH1</span> <span class="id">HH2</span>] [<span class="id">HH3</span> <span class="id">HH4</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.diff_spec">PS.diff_spec</a></span> <span class="kwd">in</span> <span class="id">HH1</span>, <span class="id">HH2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> 1 <span class="kwd">as</span> [[<span class="id">HH</span>|<span class="id">HH</span>]|[<span class="id">HH</span>|<span class="id">HH</span>]]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;forall&nbsp;x,&nbsp;x&nbsp;∈&nbsp;al&nbsp;-&gt;&nbsp;Env.In&nbsp;x&nbsp;env'&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">HH</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">HH</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id">stmt_eval_mono</span>'.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Call&nbsp;ys&nbsp;clsid&nbsp;o&nbsp;f&nbsp;es&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#surjective_pairing">surjective_pairing</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)) <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hadd</span>. <span class="id">inv</span> <span class="id">Heval</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;forall&nbsp;x,&nbsp;~x&nbsp;∈&nbsp;(st&nbsp;∪&nbsp;al)&nbsp;-&gt;&nbsp;Env.find&nbsp;x&nbsp;env'&nbsp;=&nbsp;Env.find&nbsp;x&nbsp;env&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hnin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.find_In_gsso_opt">Env.find_In_gsso_opt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSP.empty_union_1">PSP.empty_union_1</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#ps_of_list_In">ps_of_list_In</a></span> <span class="kwd">in</span> <span class="id">Hnin</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;forall&nbsp;x,&nbsp;x&nbsp;∈&nbsp;al&nbsp;-&gt;&nbsp;Env.In&nbsp;x&nbsp;env'&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">ys</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">rvos</span>) <span class="kwd">as</span> <span class="id">Hlys</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">Hfa</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">_</span> <span class="id">ys</span> <span class="id">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">He</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_call_eval">stmt_call_eval</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">Hfa</span>; <span class="tactic">rename</span> <span class="id">Hfa</span> <span class="id">into</span> <span class="id">Hlen1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">He</span> <span class="kwd">as</span> [? ? ? ? ? ? ? ? ? ? ? ? ? ? ? <span class="id">Hlen2</span>] <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span> <span class="kwd">in</span> <span class="id">Hlen2</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">Hlen2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H1</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_class">find_class</a></span> ?<span class="id">c</span> ?<span class="id">p</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H2</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_class">find_class</a></span> ?<span class="id">c</span> ?<span class="id">p</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H3</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_method">find_method</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H4</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_method">find_method</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">H1</span> <span class="id">into</span> <span class="id">Hf1</span>; <span class="tactic">rename</span> <span class="id">H2</span> <span class="id">into</span> <span class="id">Hf2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">H3</span> <span class="id">into</span> <span class="id">Hm1</span>; <span class="tactic">rename</span> <span class="id">H4</span> <span class="id">into</span> <span class="id">Hm2</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hf1</span> <span class="kwd">in</span> <span class="id">Hf2</span>; <span class="id">inv</span> <span class="id">Hf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hm1</span> <span class="kwd">in</span> <span class="id">Hm2</span>; <span class="id">inv</span> <span class="id">Hm2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Hlen1</span>, <span class="id">Hlen2</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span>) <span class="id">ys</span> <span class="id">rvos</span>) <span class="kwd">as</span> <span class="id">Hlys</span>' <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall">Forall2_forall</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_call_eval">stmt_call_eval</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hcall</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rename</span> <span class="id">H</span> <span class="id">into</span> <span class="id">Hnn</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*{ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hinadds</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_of_list_In">ps_of_list_In</a></span> <span class="kwd">in</span> <span class="id">Hinadds</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hnn</span> <span class="id">Hinadds</span> <span class="id">Hlys</span>'; <span class="tactic">clear</span>; <span class="tactic">intros</span> <span class="id">Hnn</span> <span class="id">Hinadds</span> <span class="id">Hlys</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hlys</span>'; <span class="id">inv</span> <span class="id">Hinadds</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">inversion_clear</span> <span class="id">Hnn</span> <span class="kwd">as</span> [|? ? <span class="id">Hrvo</span> <span class="id">Hrvos</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#not_None_is_Some">not_None_is_Some</a></span> <span class="kwd">in</span> <span class="id">Hrvo</span>. <span class="tactic">destruct</span> <span class="id">Hrvo</span> <span class="kwd">as</span> (<span class="id">rv</span> &amp; <span class="id">Hrvo</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hrvo</span>; <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.add_in_iff">Env.Props.P.F.add_in_iff</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">inversion_clear</span> <span class="id">Hnn</span> <span class="kwd">as</span> [|? ? <span class="id">Hrvo</span> <span class="id">Hrvos</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#not_None_is_Some">not_None_is_Some</a></span> <span class="kwd">in</span> <span class="id">Hrvo</span>. <span class="tactic">destruct</span> <span class="id">Hrvo</span> <span class="kwd">as</span> (<span class="id">rv</span> &amp; <span class="id">Hrvo</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hrvo</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.adds_opt_cons_cons">Env.adds_opt_cons_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.add_in_iff">Env.Props.P.F.add_in_iff</a></span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id">IHHlys</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.exp_eval">exp_eval</a></span> <span class="id">_</span> <span class="id">_</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">_</span>) <span class="id">vos</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">add_valid_add_valid</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rename</span> <span class="id">H</span> <span class="id">into</span> <span class="id">Hvos</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span> <span class="kwd">in</span> <span class="id">Hvos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>. <span class="tactic">intros</span> <span class="id">vo</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_in_right">Forall2_in_right</a></span> <span class="kwd">with</span> (2:=<span class="id">Hin</span>) <span class="kwd">in</span> <span class="id">Hvos</span> <span class="kwd">as</span> (<span class="id">e</span> &amp; <span class="id">Hein</span> &amp; <span class="id">He</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="id">inv</span> <span class="id">He</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;*&nbsp;Skip&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hadd</span>. <span class="id">inv</span> <span class="id">Heval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSF.empty_iff">PSF.empty_iff</a></span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="OBCADDDEFAULTS.in1_notin2">in1_notin2</a></span> <span class="id">xs1</span> <span class="id">xs2</span> (<span class="id">ve1</span> <span class="id">ve2</span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op.val">val</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#xs1">xs1</a></span> -&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve1">ve1</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#xs2">xs2</a></span> -&gt; ~<span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve2">ve2</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Import</span> <span class="id">Basics</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Instance</span> <span class="id"><a name="OBCADDDEFAULTS.in1_notin2_Proper1">in1_notin2_Proper1</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.Equal">PS.Equal</a></span> ==&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.Equal">PS.Equal</a></span> ==&gt; <span class="id"><a href="Velus.Environment.html#Env.refines">Env.refines</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="Velus.Environment.html#Env.refines">Env.refines</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> --&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">impl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2">in1_notin2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</div>
<div class="proofscript" id="proof34">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">S1</span> <span class="id">S2</span> <span class="id">HS12</span> <span class="id">T1</span> <span class="id">T2</span> <span class="id">HT12</span> <span class="id">ve0</span> <span class="id">ve0</span>' <span class="id">Henv0</span> <span class="id">ve1</span> <span class="id">ve1</span>' <span class="id">Henv1</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">HH1</span> &amp; <span class="id">HH2</span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x</span> <span class="id">HS2</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">HS12</span> <span class="kwd">in</span> <span class="id">HS2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">Henv0</span> <span class="kwd">in</span> <span class="id">HH1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x</span> <span class="id">HT2</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">HT12</span> <span class="kwd">in</span> <span class="id">HT2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">Henv1</span>' <span class="kwd">in</span> <span class="id">HH2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Instance</span> <span class="id"><a name="OBCADDDEFAULTS.in1_notin2_Proper2">in1_notin2_Proper2</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.Equal">PS.Equal</a></span> ==&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.Equal">PS.Equal</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2">in1_notin2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</div>
<div class="proofscript" id="proof35">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">S1</span> <span class="id">S2</span> <span class="id">HS12</span> <span class="id">T1</span> <span class="id">T2</span> <span class="id">HT12</span> <span class="id">ve0</span> <span class="id">ve0</span>' <span class="id">Henv0</span> <span class="id">ve1</span> <span class="id">ve1</span>' <span class="id">Henv1</span>'; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> (<span class="id">HH1</span> &amp; <span class="id">HH2</span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x</span> <span class="id">HS2</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">HS12</span> <span class="kwd">in</span> <span class="id">HS2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x</span> <span class="id">HT2</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">HT12</span> <span class="kwd">in</span> <span class="id">HT2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x</span> <span class="id">HS1</span>. <span class="tactic">rewrite</span> <span class="id">HS12</span> <span class="kwd">in</span> <span class="id">HS1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x</span> <span class="id">HT1</span>. <span class="tactic">rewrite</span> <span class="id">HT12</span> <span class="kwd">in</span> <span class="id">HT1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.in1_notin2_add1">in1_notin2_add1</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ve1</span> <span class="id">ve2</span> <span class="id">x</span> <span class="id">S1</span> <span class="id">S2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2">in1_notin2</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.add">PS.add</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#S1">S1</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#S2">S2</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve1">ve1</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve2">ve2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2">in1_notin2</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#S1">S1</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#S2">S2</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve1">ve1</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve2">ve2</a></span> /\ <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve1">ve1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</div>
<div class="proofscript" id="proof36">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> 1 <span class="kwd">as</span> (<span class="id">Hin1</span> &amp; <span class="id">Hout2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intros</span> <span class="id">y</span> <span class="id">Hin</span>; <span class="tactic">apply</span> <span class="id">Hin1</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.add_spec">PS.add_spec</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hin1</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.add_spec">PS.add_spec</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.in1_notin2_Var_In">in1_notin2_Var_In</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ve</span>' <span class="id">ve</span> <span class="id">es</span> <span class="id">acc</span> <span class="id">S</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2">in1_notin2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_valid">add_valid</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#acc">acc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#es">es</a></span>)) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#S">S</a></span> <span class="id">ve</span>' <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve">ve</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">match</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#e">e</a></span> <span class="kwd">with</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Var">Var</a></span> <span class="id">x</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> <span class="id">ve</span>' | <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="kwd">end</span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#es">es</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</div>
<div class="proofscript" id="proof37">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">es</span> <span class="kwd">as</span> [|<span class="id">e</span> <span class="id">es</span> <span class="id">IH</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">acc</span> <span class="id">S</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IH</span> <span class="kwd">in</span> <span class="id">HH</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2_add1">in1_notin2_add1</a></span> <span class="kwd">in</span> <span class="id">HH</span> <span class="kwd">as</span> (<span class="id">HH</span> &amp; <span class="id">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IH</span> <span class="kwd">in</span> <span class="id">HH</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.in1_notin2_Var_Not_In">in1_notin2_Var_Not_In</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ys</span> <span class="id">s1</span> <span class="id">ve</span>' <span class="id">ve</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2">in1_notin2</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s1">s1</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.of_list">PSP.of_list</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ys">ys</a></span>) <span class="id">ve</span>' <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve">ve</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; ~ <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve">ve</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ys">ys</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</div>
<div class="proofscript" id="proof38">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * (?&amp; <span class="id">Hnin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="tactic">intros</span> * <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hnin</span>, <span class="id"><a href="Velus.Common.CommonPS.html#ps_of_list_In">ps_of_list_In</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.in1_notin2_infer">in1_notin2_infer</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ve1</span> <span class="id">ve2</span> <span class="id">S1</span> <span class="id">S2</span> <span class="id">Z1</span> <span class="id">Z2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2">in1_notin2</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#S1">S1</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#S2">S2</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve1">ve1</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve2">ve2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Z1">Z1</a></span> -&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#S1">S1</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Z2">Z2</a></span> -&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#S2">S2</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2">in1_notin2</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Z1">Z1</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Z2">Z2</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve1">ve1</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve2">ve2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</div>
<div class="proofscript" id="proof39">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * (?, ?) ? ?; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.stmt_eval_add_writes_Skip">stmt_eval_add_writes_Skip</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">me</span> <span class="id">w</span> <span class="id">ve0</span>' <span class="id">ve0</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve0">ve0</a></span> ⊑ <span class="id">ve0</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; ~<span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve0">ve0</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w">w</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w">w</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">ve1</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve0">ve0</a></span> ⊑ <span class="id">ve1</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span> <span class="id">ve0</span>' (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w">w</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Skip">Skip</a></span>) (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span>, <span class="id">ve1</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">ve0</span>' -&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">ve1</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">ve1</span>') <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#w">w</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</div>
<div class="proofscript" id="proof40">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">me</span> <span class="id">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes">add_writes</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSP.fold_spec_right">PSP.fold_spec_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_Forall">PS_For_all_Forall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_rev">Permutation.Permutation_rev</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.elements">PS.elements</a></span> <span class="id">w</span>)) <span class="tactic">at</span> -3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.elements">PS.elements</a></span> <span class="id">w</span>)) <span class="kwd">as</span> <span class="id">ws</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> &lt;-<span class="id">Heqws</span>; <span class="tactic">clear</span> <span class="id">Heqws</span> <span class="id">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ws</span> <span class="kwd">as</span> [|<span class="id">w</span> <span class="id">ws</span> <span class="id">IH</span>]; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">ve0</span>' <span class="id">ve0</span> <span class="id">Henv</span> <span class="id">Hni</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hni</span> <span class="kwd">as</span> [|? ? <span class="id">Hniw</span> <span class="id">Hniws</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hm</span> <span class="kwd">as</span> [|? ? <span class="id">Hmw</span> <span class="id">Hmws</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">wf_vars_tyenv</span>', <span class="id"><a href="Velus.Common.Common.html#not_None_is_Some">not_None_is_Some</a></span> <span class="kwd">in</span> <span class="id">Hmw</span> <span class="kwd">as</span> (<span class="id">wty</span> &amp; <span class="id">Hwty</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_write">add_write</a></span> <span class="tactic">at</span> 1. <span class="tactic">rewrite</span> <span class="id">Hwty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="Velus.Environment.html#Env.refines_add_right">Env.refines_add_right</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">w</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op.sem_const">sem_const</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op.init_type">init_type</a></span> <span class="id">wty</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (2:=<span class="id">Hniw</span>) <span class="kwd">in</span> <span class="id">Henv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IH</span> <span class="kwd">with</span> (1:=<span class="id">Henv</span>) (2:=<span class="id">Hniws</span>) <span class="kwd">in</span> <span class="id">Hmws</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">ve1</span>' &amp; <span class="id">Henv</span>'' &amp; <span class="id">Heval</span>' &amp; <span class="id">Hinin</span>' &amp; <span class="id">Hfa</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">ve1</span>'. <span class="tactic">repeat</span> (<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_cons2">Forall_cons2</a></span>; <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">Hinin</span>', <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.add_in_iff">Env.Props.P.F.add_in_iff</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="OBCADDDEFAULTS.all_in1">all_in1</a></span> (<span class="id">xs</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op.type">type</a></span>)) (<span class="id">ve1</span> <span class="id">ve2</span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op.val">val</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#xs">xs</a></span> &lt;-&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve1">ve1</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ve2">ve2</a></span> -&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#xs">xs</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_stmt_correct">add_defaults_stmt_correct</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>' <span class="id">s</span> <span class="id">req</span> <span class="id">t</span> <span class="id">req</span>' <span class="id">st</span> <span class="id">al</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.program_refines">program_refines</a></span> (<span class="kwd">fun</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.all_in1">all_in1</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id">p</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ome</span> <span class="id">ome</span>' <span class="id">clsid</span> <span class="id">f</span> <span class="id">vos</span> <span class="id">rvos</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">vo</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vo">vo</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vos">vos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_call_eval">stmt_call_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ome">ome</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#clsid">clsid</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#f">f</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vos">vos</a></span> <span class="id">ome</span>' <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rvos">rvos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rvos">rvos</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.No_Overwrites">No_Overwrites</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_stmt">wt_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.insts">insts</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.mems">mems</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#req">req</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span> = (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#t">t</a></span>, <span class="id">req</span>', <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#st">st</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#al">al</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.stmt_refines">stmt_refines</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id">p</span>' (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2">in1_notin2</a></span> <span class="id">req</span>' (<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#st">st</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#al">al</a></span>)) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#t">t</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</div>
<div class="proofscript" id="proof41">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">p</span>' <span class="id">s</span> <span class="id">rq</span> <span class="id">t</span> <span class="id">rq</span>' <span class="id">st</span> <span class="id">al</span> <span class="id">Hpr</span> <span class="id">Hcall</span> <span class="id">Hno</span> <span class="id">Hwt</span> <span class="id">Hadd</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">me</span> <span class="id">ve1</span> <span class="id">ve2</span> <span class="id">me</span>' <span class="id">ve2</span>' <span class="id">Hpre</span> <span class="id">Henv</span> <span class="id">Heval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">t</span> <span class="id">rq</span> <span class="id">rq</span>' <span class="id">st</span> <span class="id">al</span> <span class="id">Hadd</span> <span class="id">ve1</span> <span class="id">Henv</span> <span class="id">Hpre</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">me</span>', <span class="id">ve2</span>') <span class="kwd">as</span> <span class="id">rr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">me</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">rr</span> /\ <span class="id">ve2</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">rr</span>) <span class="kwd">as</span> (<span class="id">HR1</span> &amp; <span class="id">HR2</span>) <span class="tactic">by</span> (<span class="tactic">subst</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HR1</span>, <span class="id">HR2</span>; <span class="tactic">clear</span> <span class="id">Heqrr</span> <span class="id">HR1</span> <span class="id">HR2</span> <span class="id">me</span>' <span class="id">ve2</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Heval</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Assign&nbsp;x&nbsp;e&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">t</span> <span class="id">rq</span> <span class="id">rq</span>' <span class="id">st</span> <span class="id">al</span> <span class="id">Hadd</span> <span class="id">ve1</span> <span class="id">Henv</span> <span class="id">Hpre</span>; <span class="id">inv</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id">x</span> <span class="id">v</span> <span class="id">ve1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Environment.html#Env.refines_add_both">Env.refines_add_both</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.exp_eval_refines">exp_eval_refines</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;AssignSt&nbsp;x&nbsp;e&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">t</span> <span class="id">rq</span> <span class="id">rq</span>' <span class="id">st</span> <span class="id">al</span> <span class="id">Hadd</span> <span class="id">ve1</span> <span class="id">Henv</span> <span class="id">Hpre</span>; <span class="id">inv</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.exp_eval_refines">exp_eval_refines</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Call&nbsp;ys&nbsp;clsid&nbsp;o&nbsp;f&nbsp;es&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">t</span> <span class="id">rq</span> <span class="id">rq</span>' <span class="id">st</span> <span class="id">al</span> <span class="id">Hadd</span> <span class="id">ve1</span> <span class="id">Henv</span> <span class="id">Hpre</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#surjective_pairing">surjective_pairing</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">add_valid_add_valid</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.exp_eval">exp_eval</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.Forall2_exp_eval_refines_with_valid">Forall2_exp_eval_refines_with_valid</a></span> <span class="kwd">with</span> (1:=<span class="id">Henv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">vos</span>' &amp; <span class="id">Heval1</span> &amp; <span class="id">Hvos</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2_Var_In">in1_notin2_Var_In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_call_eval">stmt_call_eval</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.program_refines_stmt_call_eval">program_refines_stmt_call_eval</a></span> <span class="kwd">with</span> (1:=<span class="id">Hpr</span>) (4:=<span class="id">Hvos</span>) <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">rvos</span>' &amp; <span class="id">Hcall</span>' &amp; <span class="id">Hrvos</span>') <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id"><a href="Velus.Environment.html#Env.adds_opt">Env.adds_opt</a></span> <span class="id">ys</span> <span class="id">rvos</span>' <span class="id">ve1</span>); <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.refines_adds_opt">Env.refines_adds_opt</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2_Var_Not_In">in1_notin2_Var_Not_In</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">vo</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vo">vo</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id">vos</span>') <span class="kwd">as</span> <span class="id">Hsome</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>. <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_in_right">Forall2_in_right</a></span> <span class="kwd">with</span> (1:=<span class="id">Heval1</span>) <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (<span class="id">e</span> &amp; <span class="id">Hin</span> &amp; <span class="id">Heval</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (<span class="id">e</span>' &amp; <span class="id">Hvalid</span> &amp; <span class="id">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>'; <span class="id">inv</span> <span class="id">Heval</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id">_</span> = <span class="id">add_valid</span>' <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span> <span class="kwd">end</span>; <span class="tactic">discriminate</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hfindc</span> <span class="id">Hfindm</span> <span class="id">Hlvos</span> <span class="id">Hlvos</span>'; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">m</span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_in">m_in</a></span>)) <span class="kwd">in</span> <span class="id">Hlvos</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hsome</span> <span class="id">Hlvos</span>'; <span class="tactic">clear</span>; <span class="id">revert</span> <span class="id">vos</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">m</span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_in">m_in</a></span>)) <span class="kwd">as</span> [|<span class="id">x</span> <span class="id">xs</span> <span class="id">IH</span>]; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.adds_opt">Env.adds_opt</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.vempty">vempty</a></span>; <span class="tactic">simpl</span>; <span class="tactic">split</span>; <span class="tactic">intro</span>; <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.empty_in_iff">Env.Props.P.F.empty_in_iff</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> <span class="id">vos</span>' <span class="id">Hsome</span> <span class="id">Hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">vos</span>'. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_cons2">Forall_cons2</a></span> <span class="kwd">in</span> <span class="id">Hsome</span> <span class="kwd">as</span> (<span class="id">Hvo</span> &amp; <span class="id">Hsome</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#not_None_is_Some">not_None_is_Some</a></span> <span class="kwd">in</span> <span class="id">Hvo</span> <span class="kwd">as</span> (<span class="id">v</span> &amp; <span class="id">Hv</span>); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hlen</span> <span class="kwd">as</span> [<span class="id">Hlen</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> (<span class="id">IH</span> <span class="id">_</span> <span class="id">Hsome</span> <span class="id">Hlen</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.in_find_iff">Env.Props.P.F.in_find_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">y</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.find_gsss_opt">Env.find_gsss_opt</a></span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#ident_eq_dec">ident_eq_dec</a></span> <span class="id">y</span> <span class="id">x</span>); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.find_gsss_opt">Env.find_gsss_opt</a></span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.find_gsso_opt">Env.find_gsso_opt</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#ident_eq_dec">ident_eq_dec</a></span> <span class="id">y</span> <span class="id">x</span>); <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.find_gsso_opt">Env.find_gsso_opt</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>, <span class="id"><a href="Velus.Environment.html#Env.In_adds_opt_In">Env.In_adds_opt_In</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Comp&nbsp;s1&nbsp;s2&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">a1</span> <span class="id">into</span> <span class="id">s1</span>, <span class="id">a2</span> <span class="id">into</span> <span class="id">s2</span>, <span class="id">ve</span> <span class="id">into</span> <span class="id">ve0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">t</span> <span class="id">rq</span> <span class="id">rq</span>' <span class="id">st</span> <span class="id">al</span> <span class="id">Hadd</span> <span class="id">ve0</span>' <span class="id">Henv0</span> <span class="id">Hpre</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hwt</span> <span class="kwd">as</span> [| | |? ? <span class="id">Hwt1</span> <span class="id">Hwt2</span>| |].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs2</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id">rq</span> <span class="id">s2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id">rq</span> <span class="id">s2</span> = <span class="id">defs2</span>) <span class="kwd">as</span> <span class="id">Hdefs2</span> <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs2</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs2</span> <span class="kwd">as</span> [[[<span class="id">t2</span> <span class="id">rq2</span>] <span class="id">stimes2</span>] <span class="id">always2</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs1</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id">rq2</span> <span class="id">s1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id">rq2</span> <span class="id">s1</span> = <span class="id">defs1</span>) <span class="kwd">as</span> <span class="id">Hdefs1</span> <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs1</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs1</span> <span class="kwd">as</span> [[[<span class="id">t1</span> <span class="id">rq1</span>] <span class="id">stimes1</span>] <span class="id">always1</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2">in1_notin2</a></span> <span class="id">rq</span>' (<span class="id">stimes1</span> ∪ <span class="id">always1</span>) <span class="id">ve0</span>' <span class="id">ve0</span>) <span class="kwd">as</span> <span class="id">Hpre</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2_infer">in1_notin2_infer</a></span> <span class="kwd">with</span> (1:=<span class="id">Hpre</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intros</span> <span class="id">x</span> ?; <span class="id">PS_split</span>; <span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.In_dec">PSP.In_dec</a></span> <span class="id">x</span> <span class="id">always2</span>); <span class="tactic">intuition</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hno</span> <span class="kwd">as</span> [| | | |? ? <span class="id">Hwnw1</span> <span class="id">Hwnw2</span> <span class="id">Hno1</span> <span class="id">Hno2</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">IHHeval1</span> <span class="id">Hpr</span> <span class="id">Hno1</span> <span class="id">Hwt1</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs1</span> <span class="id">_</span> <span class="id">Henv0</span> <span class="id">Hpre</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHHeval1</span> <span class="kwd">as</span> (<span class="id">ve1</span>' &amp; <span class="id">Henv1</span>' &amp; <span class="id">Heval1</span>').<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2">in1_notin2</a></span> <span class="id">rq2</span> (<span class="id">stimes2</span> ∪ <span class="id">always2</span>) <span class="id">ve1</span>' <span class="id">ve1</span>) <span class="kwd">as</span> <span class="id">Hpre</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_inv1">add_defaults_stmt_inv1</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs1</span>) <span class="kwd">as</span> (<span class="id">HI1</span> &amp; <span class="id">HI2</span> &amp; <span class="id">HI3</span> &amp; <span class="id">HI4</span> &amp; <span class="id">HI5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_inv2">add_defaults_stmt_inv2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs1</span> <span class="id">Heval1</span>') <span class="kwd">as</span> (<span class="id">HI6</span> &amp; <span class="id">HI8</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intros</span> <span class="id">y</span> <span class="id">Hyin</span>; <span class="tactic">apply</span> <span class="id">Hpre</span> <span class="kwd">in</span> <span class="id">Hyin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span>:=<span class="id">Hpre</span>); <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2_infer">in1_notin2_infer</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">Z1</span>:=<span class="id"><a href="Velus.Common.CommonPS.html#PS.diff">PS.diff</a></span> <span class="id">rq2</span> <span class="id">always1</span>) (<span class="id">Z2</span>:=<span class="id"><a href="Velus.Common.CommonPS.html#PS.union">PS.union</a></span> <span class="id">stimes2</span> <span class="id">always2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">Hpre3</span> &amp; <span class="id">Hpre4</span>); [<span class="tactic">split</span>| |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">HI2</span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">Hpre</span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">stmt_eval_mono</span>' <span class="kwd">with</span> (3:=<span class="id">Heval1</span>'); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_inv1">add_defaults_stmt_inv1</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs2</span>) <span class="kwd">as</span> (<span class="id">H2A</span> &amp; <span class="id">H2B</span> &amp; <span class="id">H2C</span> &amp; <span class="id">H2D</span> &amp; <span class="id">H2E</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">H2C</span> <span class="id">_</span> <span class="id">Hin</span>); <span class="tactic">apply</span> <span class="id">Hwnw2</span>, <span class="id">HI4</span> <span class="kwd">in</span> <span class="id">H2C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hpre4</span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_no_write">add_defaults_stmt_no_write</a></span> <span class="kwd">with</span> (1:=<span class="id">Hdefs1</span>) (3:=<span class="id">H2C</span>) <span class="kwd">in</span> <span class="id">Heval1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.in_find_iff">Env.Props.P.F.in_find_iff</a></span>, <span class="id">Heval1</span>, &lt;-<span class="id"><a href="Velus.Environment.html#Env.Props.P.F.in_find_iff">Env.Props.P.F.in_find_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.diff_spec">PS.diff_spec</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (<span class="id">Hin</span> &amp; <span class="id">Hnin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">HI2</span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="tactic">auto</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.In_dec">PSP.In_dec</a></span> <span class="id">x</span> <span class="id">always1</span>). <span class="id">now</span> <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">PS_split</span>; <span class="tactic">intuition</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">IHHeval2</span> <span class="id">Hpr</span> <span class="id">Hno2</span> <span class="id">Hwt2</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs2</span> <span class="id">_</span> <span class="id">Henv1</span>' <span class="id">Hpre</span>'').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHHeval2</span> <span class="kwd">as</span> (<span class="id">ve2</span>' &amp; <span class="id">Henv2</span>' &amp; <span class="id">Heval2</span>'); <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Ifte&nbsp;c&nbsp;et&nbsp;ef&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">ve</span> <span class="id">into</span> <span class="id">ve0</span>, <span class="id">ve</span>' <span class="id">into</span> <span class="id">ve3</span>, <span class="id">ifTrue</span> <span class="id">into</span> <span class="id">s1</span>, <span class="id">ifFalse</span> <span class="id">into</span> <span class="id">s2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">t</span> <span class="id">rq</span> <span class="id">rq</span>' <span class="id">st</span> <span class="id">al</span> <span class="id">Hadd</span> <span class="id">ve0</span>' <span class="id">Henv0</span>' <span class="id">Hpre</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hwt</span> <span class="kwd">as</span> [| |? ? ? ? ? <span class="id">Hwt1</span> <span class="id">Hwt2</span>| | |].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs1</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s1</span> = <span class="id">defs1</span>) <span class="kwd">as</span> <span class="id">Hdefs1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs1</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs1</span> <span class="kwd">as</span> [[[<span class="id">t1</span> <span class="id">rq1</span>] <span class="id">st1</span>] <span class="id">al1</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs2</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.tyenv">tyenv</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.empty">PS.empty</a></span> <span class="id">s2</span> = <span class="id">defs2</span>) <span class="kwd">as</span> <span class="id">Hdefs2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hdefs2</span> <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs2</span> <span class="kwd">as</span> [[[<span class="id">t2</span> <span class="id">rq2</span>] <span class="id">st2</span>] <span class="id">al2</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_wt">add_defaults_stmt_wt</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs1</span> <span class="id">Hwt1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">Hwt1</span>' &amp; <span class="id">Hvst1</span> &amp; <span class="id">Hval1</span> &amp; <span class="id">Hreq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_wt">add_defaults_stmt_wt</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs2</span> <span class="id">Hwt2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">Hwt2</span>' &amp; <span class="id">Hvst2</span> &amp; <span class="id">Hval2</span> &amp; <span class="id">Hreq2</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hadd</span> <span class="kwd">as</span> [<span class="id">Hadd</span>']; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> ((<span class="id">al2</span> ∩ <span class="id">rq</span>) — (<span class="id">al1</span> ∩ <span class="id">rq</span>)) <span class="kwd">as</span> <span class="id">w1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> ((<span class="id">al1</span> ∩ <span class="id">rq</span>) — (<span class="id">al2</span> ∩ <span class="id">rq</span>)) <span class="kwd">as</span> <span class="id">w2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (((<span class="id">st1</span> ∩ <span class="id">rq</span>) — <span class="id">w1</span>) ∪ ((<span class="id">st2</span> ∩ <span class="id">rq</span>) — <span class="id">w2</span>)) <span class="kwd">as</span> <span class="id">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.simplify_write_sets">simplify_write_sets</a></span> <span class="id">w</span> <span class="id">w1</span> <span class="id">w2</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Heqw1</span> <span class="id">Heqw2</span> <span class="id">Heqw</span>) <span class="kwd">in</span> <span class="id">Hpre</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hno</span> <span class="kwd">as</span> [| |? ? ? <span class="id">Hno1</span> <span class="id">Hno2</span>| | |].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; ~<span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">ve0</span>) <span class="id">w</span>) <span class="kwd">as</span> <span class="id">Hwenv0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>; <span class="tactic">apply</span> <span class="id">Hpre</span>; <span class="tactic">intuition</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span>) <span class="id">w</span>) <span class="kwd">as</span> <span class="id">Hwim</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="id">now</span> <span class="tactic">subst</span> <span class="id">w</span>; <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_union">PS_For_all_union</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_diff">PS_For_all_diff</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_inter">PS_For_all_inter</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes_Skip">stmt_eval_add_writes_Skip</a></span> <span class="id">me</span> <span class="id">w</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Henv0</span>' <span class="id">Hwenv0</span> <span class="id">Hwim</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">ve1</span>' &amp; <span class="id">Henv1</span>' &amp; <span class="id">Heval1</span>' &amp; <span class="id">Hmono1</span> &amp; <span class="id">Hin1</span>').<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; ~<span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">ve0</span>) (<span class="kwd">if</span> <span class="id">b</span> <span class="kwd">then</span> <span class="id">w1</span> <span class="kwd">else</span> <span class="id">w2</span>)) <span class="kwd">as</span> <span class="id">Hwenv1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>; <span class="tactic">apply</span> <span class="id">Hpre</span>; <span class="tactic">intuition</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.vars">vars</a></span>) (<span class="kwd">if</span> <span class="id">b</span> <span class="kwd">then</span> <span class="id">w1</span> <span class="kwd">else</span> <span class="id">w2</span>)) <span class="kwd">as</span> <span class="id">Hwim1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="id">now</span> <span class="tactic">subst</span> <span class="id">w1</span> <span class="id">w2</span>; <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_diff">PS_For_all_diff</a></span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_inter">PS_For_all_inter</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes_Skip">stmt_eval_add_writes_Skip</a></span> <span class="id">me</span> (<span class="kwd">if</span> <span class="id">b</span> <span class="kwd">then</span> <span class="id">w1</span> <span class="kwd">else</span> <span class="id">w2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">_</span> <span class="id">_</span> <span class="id">Henv1</span>' <span class="id">Hwenv1</span> <span class="id">Hwim1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">ve2</span>' &amp; <span class="id">Henv2</span>' &amp; <span class="id">Heval2</span>' &amp; <span class="id">Hmono2</span> &amp; <span class="id">Hin2</span>').<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">ve3</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ve3</span> ⊑ <span class="id">ve3</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt.p">p</a></span> <span class="id">me</span> <span class="id">ve2</span>' (<span class="kwd">if</span> <span class="id">b</span> <span class="kwd">then</span> <span class="id">t1</span> <span class="kwd">else</span> <span class="id">t2</span>) (<span class="id">me</span>', <span class="id">ve3</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">ve3</span>' &amp; <span class="id">Henv3</span>' &amp; <span class="id">Heval3</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id">IHHeval</span> <span class="id">Hpr</span> <span class="id">Hno1</span> <span class="id">Hwt1</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs1</span> <span class="id">_</span> <span class="id">Henv2</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hpre</span> <span class="kwd">as</span> (<span class="id">Hpre1</span> &amp; <span class="id">Hpre2</span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hrq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.In_dec">PSP.In_dec</a></span> <span class="id">x</span> <span class="id">w1</span>) <span class="kwd">as</span> [<span class="id">Hw1</span>|<span class="id">Hnw1</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_In_Forall">PS_In_Forall</a></span> <span class="kwd">with</span> (1:=<span class="id">Hin2</span>') (2:=<span class="id">Hw1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">Hmono2</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.In_dec">PSP.In_dec</a></span> <span class="id">x</span> <span class="id">w</span>) <span class="kwd">as</span> [<span class="id">Hw</span>|<span class="id">Hnw</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_In_Forall">PS_In_Forall</a></span> <span class="kwd">with</span> (1:=<span class="id">Hin1</span>') (2:=<span class="id">Hw</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">Hmono1</span> <span class="id">x</span>). <span class="tactic">apply</span> <span class="id">Hpre1</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>. <span class="tactic">apply</span> <span class="id">Hpre2</span>. <span class="id">PS_split</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id">IHHeval</span> <span class="id">Hpr</span> <span class="id">Hno2</span> <span class="id">Hwt2</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs2</span> <span class="id">_</span> <span class="id">Henv2</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hpre</span> <span class="kwd">as</span> (<span class="id">Hpre1</span> &amp; <span class="id">Hpre2</span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hrq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.In_dec">PSP.In_dec</a></span> <span class="id">x</span> <span class="id">w2</span>) <span class="kwd">as</span> [<span class="id">Hw2</span>|<span class="id">Hnw2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_In_Forall">PS_In_Forall</a></span> <span class="kwd">with</span> (1:=<span class="id">Hin2</span>') (2:=<span class="id">Hw2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">Hmono2</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.In_dec">PSP.In_dec</a></span> <span class="id">x</span> <span class="id">w</span>) <span class="kwd">as</span> [<span class="id">Hw</span>|<span class="id">Hnw</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_In_Forall">PS_In_Forall</a></span> <span class="kwd">with</span> (1:=<span class="id">Hin1</span>') (2:=<span class="id">Hw</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">Hmono1</span> <span class="id">x</span>). <span class="tactic">apply</span> <span class="id">Hpre1</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>. <span class="tactic">apply</span> <span class="id">Hpre2</span>. <span class="id">PS_split</span>; <span class="tactic">tauto</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">ve3</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes_split">stmt_eval_add_writes_split</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">me</span>, <span class="id">ve1</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.exp_eval_refines">exp_eval_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes_split">stmt_eval_add_writes_split</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;skip&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> 1; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_eval">stmt_eval</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.AddDefaultsStmt">AddDefaultsStmt</a></span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.output_or_local_in_typing_env">output_or_local_in_typing_env</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span>} (<span class="id">min</span> <span class="id">mvars</span> <span class="id">mout</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.ClockDefs.html#ident">ident</a></span> * <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#A">A</a></span>)) <span class="id">S</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#min">min</a></span> ++ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#mvars">mvars</a></span> ++ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#mout">mout</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.of_list">PSP.of_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#mout">mout</a></span>)) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#min">min</a></span> ++ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#mvars">mvars</a></span> ++ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#mout">mout</a></span>)) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#S">S</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#min">min</a></span> ++ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#mvars">mvars</a></span> ++ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#mout">mout</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonPS.html#ps_removes">ps_removes</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#min">min</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#S">S</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</div>
<div class="proofscript" id="proof42">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">A</span> <span class="id">min</span> <span class="id">mvars</span> <span class="id">mout</span> <span class="id">S</span> <span class="id">Hmndup</span> <span class="id">HS</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_removes_spec">ps_removes_spec</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (<span class="id">Hnin</span> &amp; <span class="id">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_In_Forall">PS_In_Forall</a></span> <span class="kwd">with</span> (1:=<span class="id">HS</span>) <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_of_list_In">ps_of_list_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> ((<span class="id">y</span> &amp; <span class="id">yty</span>) &amp; <span class="id">Heq</span> &amp; <span class="id">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 (<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#or_intror">or_intror</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#in_app">in_app</a></span> <span class="kwd">in</span> <span class="id">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Env.In_find_adds</span>' <span class="kwd">in</span> <span class="id">Hin</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#not_None_is_Some">not_None_is_Some</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_In">InMembers_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (<span class="id">xty</span> &amp; <span class="id">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Env.In_find_adds</span>' <span class="kwd">in</span> <span class="id">Hin</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#not_None_is_Some">not_None_is_Some</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.stmt_call_eval_add_defaults_class_not_None">stmt_call_eval_add_defaults_class_not_None</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_program">wt_program</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ome</span> <span class="id">ome</span>' <span class="id">clsid</span> <span class="id">f</span> <span class="id">vos</span> <span class="id">rvos</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">vo</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vo">vo</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vos">vos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_call_eval">stmt_call_eval</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ome">ome</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#clsid">clsid</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#f">f</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vos">vos</a></span> <span class="id">ome</span>' <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rvos">rvos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rvos">rvos</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</div>
<div class="proofscript" id="proof43">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">p</span> <span class="kwd">as</span> [|<span class="id">c</span> <span class="id">p</span>' <span class="id">IH</span>]; <span class="tactic">simpl</span>. <span class="id">now</span> <span class="tactic">inversion</span> 3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">WTp</span> <span class="id">ome</span> <span class="id">ome</span>'' <span class="id">clsid</span> <span class="id">f</span> <span class="id">vos</span> <span class="id">rvos</span> <span class="id">Hvos</span> <span class="id">Heval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">WTp</span> <span class="kwd">as</span> [|? ? <span class="id">WTc</span> <span class="id">WTp</span>' <span class="id">Hpnd</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">IH</span> <span class="id">WTp</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#ident_eq_dec">ident_eq_dec</a></span> <span class="id">c</span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_name">c_name</a></span>) <span class="id">clsid</span>) <span class="kwd">as</span> [<span class="id">He</span>|<span class="id">Hne</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">c</span> <span class="kwd">as</span> (<span class="id">name</span>, <span class="id">mems</span>, <span class="id">objs</span>, <span class="id">methods</span>, <span class="id">Hnodup</span>, <span class="id">Hnodupm</span>, <span class="id">Hgood</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Heval</span> <span class="kwd">as</span> [? ? ? ? ? ? ? ? <span class="id">ve</span>'' ? ? <span class="id">Hfindc</span> <span class="id">Hfindm</span> <span class="id">Hlvos</span> <span class="id">Heval</span>' <span class="id">Hrvos</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">name</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfindc</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#ident_eqb_refl">ident_eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Hfindc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfindc</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfindm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">find_method_map_add_defaults_method</span>' <span class="kwd">in</span> <span class="id">Hfindm</span> <span class="kwd">as</span> (<span class="id">fm</span>' &amp; <span class="id">Hfindm</span>' &amp; <span class="id">Hfm</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">fm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">WTc</span> <span class="kwd">as</span> [<span class="id">Hfao</span> <span class="id">WTms</span>]. <span class="tactic">clear</span> <span class="id">Hfao</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">WTms</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">methods</span> <span class="kwd">as</span> [|<span class="id">m</span> <span class="id">methods</span>' <span class="id">IHm</span>]. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_cons2">Forall_cons2</a></span> <span class="kwd">in</span> <span class="id">WTms</span> <span class="kwd">as</span> (<span class="id">WTm</span> &amp; <span class="id">WTms</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">NoDup_cons</span>' <span class="kwd">in</span> <span class="id">Hnodupm</span> <span class="kwd">as</span> (<span class="id">Hnodupm1</span> &amp; <span class="id">Hnodupm2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfindm</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#ident_eqb">ident_eqb</a></span> <span class="id">m</span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_name">m_name</a></span>) <span class="id">f</span>); [<span class="tactic">clear</span> <span class="id">IHm</span>|<span class="tactic">apply</span> <span class="id">IHm</span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Hnodupm1</span> <span class="id">Hnodupm2</span>. <span class="id">inv</span> <span class="id">Hfindm</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">fm</span>' <span class="kwd">as</span> (<span class="id">mname</span>, <span class="id">min</span>, <span class="id">mvars</span>, <span class="id">mout</span>, <span class="id">mbody</span>, <span class="id">Hmndup</span>, <span class="id">Hmgood</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Env.adds</span>' <span class="id">mout</span> (<span class="id">Env.adds</span>' <span class="id">mvars</span> (<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> <span class="id">min</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id">min</span> ++ <span class="id">mvars</span> ++ <span class="id">mout</span>)) <span class="kwd">as</span> <span class="id">Hpmeq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="id">now</span> <span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Env.adds</span>'<span class="id">_app</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hpmeq</span> <span class="kwd">in</span> <span class="id">Heval</span>'; <span class="tactic">clear</span> <span class="id">Hpmeq</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id">min</span> ++ <span class="id">mvars</span> ++ <span class="id">mout</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonPS.html#PSP.of_list">PSP.of_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">mout</span>)) <span class="id">mbody</span>) <span class="kwd">as</span> <span class="id">defs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">Heqdefs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">Heqdefs</span> <span class="kwd">in</span> <span class="id">Heval</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs</span> <span class="kwd">as</span> [[[<span class="id">t</span> <span class="id">req</span>'] <span class="id">stimes</span>] <span class="id">always</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes_split">stmt_eval_add_writes_split</a></span> <span class="kwd">in</span> <span class="id">Heval</span>' <span class="kwd">as</span> (<span class="id">ome</span>' &amp; <span class="id">ve</span>' &amp; <span class="id">Heval</span> &amp; <span class="id">Heval</span>').<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_inv1">add_defaults_stmt_inv1</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Heqdefs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">HH1</span> &amp; <span class="id">Halreq</span>' &amp; <span class="id">HH2</span> &amp; <span class="id">HH3</span> &amp; <span class="id">HH4</span>); <span class="tactic">clear</span> <span class="id">HH1</span> <span class="id">HH2</span> <span class="id">HH3</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ty">ty</a></span>) (<span class="id">min</span> ++ <span class="id">mvars</span> ++ <span class="id">mout</span>) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id">min</span> ++ <span class="id">mvars</span> ++ <span class="id">mout</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ty">ty</a></span>) <span class="kwd">as</span> <span class="id">Hinf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">split</span>; [<span class="tactic">apply</span> <span class="id">Env.In_find_adds</span>'|<span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.from_list_find_In">Env.from_list_find_In</a></span>]; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.wt_method_add_defaults">wt_method_add_defaults</a></span> <span class="kwd">in</span> <span class="id">WTm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_method">wt_method</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.meth_vars">meth_vars</a></span> <span class="kwd">in</span> <span class="id">WTm</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">WTm</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_wt">add_defaults_stmt_wt</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hinf</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Heqdefs</span> <span class="id">WTm</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">WTt</span> &amp; <span class="id">WTst</span> &amp; <span class="id">WTal</span> &amp; <span class="id">Hreq</span>').<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#ps_removes">ps_removes</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">min</span>) <span class="id">req</span>') -&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">ve</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">Hreq</span>'<span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>; <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes">stmt_eval_add_writes</a></span> <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">Heval</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.output_or_local_in_typing_env">output_or_local_in_typing_env</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_inv2">add_defaults_stmt_inv2</a></span> <span class="kwd">in</span> <span class="id">Heqdefs</span> <span class="kwd">as</span> (<span class="id">Hstal</span> &amp; <span class="id">Hal</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_in_right">Forall2_in_right</a></span> <span class="kwd">with</span> (1:=<span class="id">Hrvos</span>) <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (<span class="id">xo</span> &amp; <span class="id">Hin</span> &amp; <span class="id">Hfind</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">xo</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">min</span>)) <span class="kwd">as</span> <span class="id">Hnmin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span> <span class="id">Hin</span>'. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> <span class="id">Hin</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_app_InMembers">NoDupMembers_app_InMembers</a></span> <span class="kwd">with</span> (1:=<span class="id">Hmndup</span>) <span class="kwd">in</span> <span class="id">Hin</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hin</span>', <span class="id"><a href="Velus.Common.CommonList.html#InMembers_app">InMembers_app</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_of_list_In">ps_of_list_In</a></span>, <span class="id">Halreq</span>' <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">Hal</span>, <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.in_find_iff">Env.Props.P.F.in_find_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Hfind</span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">Hnmin</span>), <span class="id"><a href="Velus.Common.CommonPS.html#ps_removes_spec">ps_removes_spec</a></span>, <span class="id">Hreq</span>'<span class="kwd">in</span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">stmt_eval_mono</span>' <span class="kwd">with</span> (3:=<span class="id">Heval</span>') <span class="kwd">in</span> <span class="id">Hin</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.in_find_iff">Env.Props.P.F.in_find_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="tactic">rewrite</span> <span class="id">Hfind</span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#ident_eq_dec">ident_eq_dec</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">min</span>)) <span class="kwd">as</span> [<span class="id">Him</span>|<span class="id">Hnim</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">cut</span> (<span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Environment.html#Env.adds_opt">Env.adds_opt</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">min</span>) <span class="id">vos</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.vempty">vempty</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hii</span>; <span class="tactic">apply</span> <span class="id">stmt_eval_mono</span>' <span class="kwd">with</span> (3:=<span class="id">Heval</span>) <span class="kwd">in</span> <span class="id">Hii</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.No_Naked_Vars_add_writes">No_Naked_Vars_add_writes</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Him</span> <span class="id">Hvos</span> <span class="id">Hlvos</span>; <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span>). <span class="id">revert</span> <span class="id">vos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">min</span>) <span class="kwd">as</span> [|<span class="id">y</span> <span class="id">ys</span> <span class="id">IH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intros</span> <span class="id">vos</span> <span class="id">Him</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_nil">in_nil</a></span> <span class="kwd">in</span> <span class="id">Him</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">vos</span> <span class="id">Him</span> <span class="id">Hvos</span> <span class="id">Hlvos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">vos</span> <span class="kwd">as</span> [|<span class="id">vo</span> <span class="id">vos</span>]. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_cons2">Forall_cons2</a></span> <span class="kwd">in</span> <span class="id">Hvos</span> <span class="kwd">as</span> (<span class="id">Hvo</span> &amp; <span class="id">Hvos</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#not_None_is_Some">not_None_is_Some</a></span> <span class="kwd">in</span> <span class="id">Hvo</span> <span class="kwd">as</span> (<span class="id">v</span> &amp; <span class="id">Hvo</span>); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.in_find_iff">Env.Props.P.F.in_find_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Him</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.find_gsss_opt">Env.find_gsss_opt</a></span>. <span class="id">inv</span> <span class="id">Hlvos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonPS.html#ident_eq_dec">ident_eq_dec</a></span> <span class="id">x</span> <span class="id">y</span>). <span class="id">now</span> <span class="tactic">subst</span>; <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.find_gsss_opt">Env.find_gsss_opt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.find_gsso_opt">Env.find_gsso_opt</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.in_find_iff">Env.Props.P.F.in_find_iff</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">Hnim</span>), <span class="id"><a href="Velus.Common.CommonPS.html#ps_removes_spec">ps_removes_spec</a></span>, <span class="id">Hreq</span>'<span class="kwd">in</span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> ((<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class">add_defaults_class</a></span> <span class="id">c</span>).(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_name">c_name</a></span>) &lt;&gt; <span class="id">clsid</span>) <span class="kwd">as</span> <span class="id">Hne</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">destruct</span> <span class="id">c</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_call_eval_cons">stmt_call_eval_cons</a></span> <span class="kwd">in</span> <span class="id">Heval</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.wt_add_defaults_method">wt_add_defaults_method</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">objs</span> <span class="id">mems</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_method">wt_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#objs">objs</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#mems">mems</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_method">wt_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#objs">objs</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#mems">mems</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</div>
<div class="proofscript" id="proof44">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_method">wt_method</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.meth_vars">meth_vars</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">p</span> <span class="id">objs</span> <span class="id">mems</span> <span class="id">m</span> <span class="id">WTm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method_m_in">add_defaults_method_m_in</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method_m_out">add_defaults_method_m_out</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method_m_vars">add_defaults_method_m_vars</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">m</span> <span class="kwd">as</span> [<span class="id">n</span> <span class="id">min</span> <span class="id">mvars</span> <span class="id">mout</span> <span class="id">s</span> <span class="id">Hnodup</span> <span class="id">Hgood</span>]; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Env.adds</span>' <span class="id">mout</span> (<span class="id">Env.adds</span>' <span class="id">mvars</span> (<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> <span class="id">min</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id">min</span> ++ <span class="id">mvars</span> ++ <span class="id">mout</span>)) <span class="kwd">as</span> <span class="id">Hpmeq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="id">now</span> <span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Env.adds</span>'<span class="id">_app</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hpmeq</span>; <span class="tactic">clear</span> <span class="id">Hpmeq</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id">min</span> ++ <span class="id">mvars</span> ++ <span class="id">mout</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonPS.html#PSP.of_list">PSP.of_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">mout</span>)) <span class="id">s</span>) <span class="kwd">as</span> <span class="id">defs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">Heqdefs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">Heqdefs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs</span> <span class="kwd">as</span> [[[<span class="id">t</span> <span class="id">req</span>'] <span class="id">stimes</span>] <span class="id">always</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ty">ty</a></span>) (<span class="id">min</span> ++ <span class="id">mvars</span> ++ <span class="id">mout</span>) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id">min</span> ++ <span class="id">mvars</span> ++ <span class="id">mout</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ty">ty</a></span>) <span class="kwd">as</span> <span class="id">Hinf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">split</span>; [<span class="tactic">apply</span> <span class="id">Env.In_find_adds</span>'|<span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.from_list_find_In">Env.from_list_find_In</a></span>]; <span class="tactic">auto</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_wt">add_defaults_stmt_wt</a></span> <span class="kwd">with</span> (1:=<span class="id">Hinf</span>) (2:=<span class="id">Heqdefs</span>) <span class="kwd">in</span> <span class="id">WTm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">WTm</span> <span class="kwd">as</span> (<span class="id">WTt</span> &amp; <span class="id">HH1</span> &amp; <span class="id">HH2</span> &amp; <span class="id">Hreq</span>'); <span class="tactic">clear</span> <span class="id">HH1</span> <span class="id">HH2</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_writes_wt">add_writes_wt</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.output_or_local_in_typing_env">output_or_local_in_typing_env</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.wt_mem_add_defaults">wt_mem_add_defaults</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">c</span> <span class="id">me</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_mem">wt_mem</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_mem">wt_mem</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span>) (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class">add_defaults_class</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</div>
<div class="proofscript" id="proof45">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> 1 <span class="kwd">as</span> [???? <span class="id">WTmem_inst</span> <span class="id">IH</span>| |] <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_mem_ind_mult">wt_mem_ind_mult</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">Pinst</span> := <span class="kwd">fun</span> <span class="id">me</span> <span class="id">P</span> <span class="id">oc</span> <span class="id">WT_mem_inst</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_mem_inst">wt_mem_inst</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#P">P</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#oc">oc</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">cl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_objs">c_objs</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class">add_defaults_class</a></span> <span class="id">cl</span>) = <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_objs">c_objs</a></span> <span class="id">cl</span>) <span class="kwd">as</span> <span class="id">E</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">destruct</span> <span class="id">cl</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">E</span>; <span class="tactic">clear</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_objs">c_objs</a></span> <span class="id">cl</span>) <span class="kwd">as</span> [|(<span class="id">o</span>, <span class="id">c</span>)]; <span class="id">inv</span> <span class="id">WTmem_inst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">IH</span> <span class="kwd">as</span> [|?? (?&amp;?)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eright</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.find_class_add_defaults_class">find_class_add_defaults_class</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.wt_add_defaults_class">wt_add_defaults_class</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_program">wt_program</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_program">wt_program</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</div>
<div class="proofscript" id="proof46">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">p</span> <span class="kwd">as</span> [|<span class="id">c</span> <span class="id">p</span>' <span class="id">IH</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> 1 <span class="kwd">as</span> [|? ? <span class="id">WTc</span> <span class="id">WTp</span> <span class="id">Hpnd</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">IH</span> <span class="id">WTp</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">WTc</span> <span class="kwd">as</span> [<span class="id">Hfobs</span> <span class="id">WTms</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class_c_objs">add_defaults_class_c_objs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_impl_In">Forall_impl_In</a></span> <span class="kwd">with</span> (2:=<span class="id">Hfobs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.find_class_add_defaults_class_not_None">find_class_add_defaults_class_not_None</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class_c_mems">add_defaults_class_c_mems</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class_c_objs">add_defaults_class_c_objs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">c</span> <span class="kwd">as</span> (<span class="id">name</span>, <span class="id">mems</span>, <span class="id">objs</span>, <span class="id">methods</span>, <span class="id">Hnodup</span>, <span class="id">Hnodupm</span>, <span class="id">Hgood</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_map">Forall_map</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_impl_In">Forall_impl_In</a></span> <span class="kwd">with</span> (2:=<span class="id">WTms</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">m</span> <span class="id">Him</span> <span class="id">WTm</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.wt_method_add_defaults">wt_method_add_defaults</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.wt_add_defaults_method">wt_add_defaults_method</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_map">Forall_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class_c_name">add_defaults_class_c_name</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_stmt_refines">add_defaults_stmt_refines</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">insts</span> <span class="id">mems</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.program_refines">program_refines</a></span> (<span class="kwd">fun</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.all_in1">all_in1</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p1">p1</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p2">p2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_method">wt_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p2">p2</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#insts">insts</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#mems">mems</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.No_Overwrites">No_Overwrites</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_body">m_body</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; ~<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_body">m_body</a></span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_in">m_in</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ome</span> <span class="id">ome</span>' <span class="id">clsid</span> <span class="id">f</span> <span class="id">vos</span> <span class="id">rvos</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">vo</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vo">vo</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vos">vos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_call_eval">stmt_call_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p1">p1</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ome">ome</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#clsid">clsid</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#f">f</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vos">vos</a></span> <span class="id">ome</span>' <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rvos">rvos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rvos">rvos</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.stmt_refines">stmt_refines</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p1">p1</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p2">p2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2">in1_notin2</a></span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSP.of_list">PSP.of_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_in">m_in</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonPS.html#PSP.of_list">PSP.of_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_out">m_out</a></span>) ++ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_vars">m_vars</a></span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>).(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_body">m_body</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_body">m_body</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</div>
<div class="proofscript" id="proof47">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_method">wt_method</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.meth_vars">meth_vars</a></span>; <span class="tactic">intros</span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">insts</span> <span class="id">mems</span> <span class="id">m</span> <span class="id">Hpr</span> <span class="id">WT</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">m</span> <span class="kwd">as</span> [<span class="id">n</span> <span class="id">ins</span> <span class="id">vars</span> <span class="id">outs</span> <span class="id">s</span> <span class="id">nodup</span> <span class="id">good</span>]; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Env.adds</span>'<span class="id">_app</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">fold</span> (@<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op.type">type</a></span> (<span class="id">outs</span> ++ <span class="id">vars</span> ++ <span class="id">ins</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> |- <span class="id">context</span> [ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> ?<span class="id">tyenv</span> ?<span class="id">W</span> <span class="id">s</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id">W</span> <span class="id">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id">W</span> <span class="id">s</span> = <span class="id">defs</span>) <span class="kwd">as</span> <span class="id">Hdefs</span> <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs</span> <span class="kwd">as</span> [[[<span class="id">t</span> <span class="id">rq</span>'] <span class="id">st</span>] <span class="id">al</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hnoo</span> <span class="id">Hncwin</span> <span class="id">Hcall</span> <span class="id">me</span> <span class="id">ve1</span>' <span class="id">ve1</span> <span class="id">me</span>' <span class="id">ve2</span> <span class="id">Hpre</span> <span class="id">Henv</span> <span class="id">Heval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.wt_stmt_program_refines">wt_stmt_program_refines</a></span> <span class="kwd">with</span> (1:=<span class="id">Hpr</span>) <span class="kwd">in</span> <span class="id">WT</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ty">ty</a></span>) (<span class="id">ins</span> ++ <span class="id">vars</span> ++ <span class="id">outs</span>) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id">Env.adds</span>' (<span class="id">ins</span> ++ <span class="id">vars</span> ++ <span class="id">outs</span>) (<span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id">_</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ty">ty</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">Htyenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Env.In_find_adds</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.from_list_find_In">Env.from_list_find_In</a></span> <span class="kwd">in</span> <span class="id">HH</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">WT</span>':=<span class="id">WT</span>); <span class="tactic">eapply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_wt">add_defaults_stmt_wt</a></span> <span class="kwd">with</span> (1:=<span class="id">Htyenv</span>) (2:=<span class="id">Hdefs</span>) <span class="kwd">in</span> <span class="id">WT</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">WTt</span> &amp; <span class="id">Hvst</span> &amp; <span class="id">Hval</span> &amp; <span class="id">Hrq</span>').<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> (<span class="id">ins</span> ++ <span class="id">vars</span> ++ <span class="id">outs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonPS.html#ps_removes">ps_removes</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ins</span>) <span class="id">rq</span>')) <span class="kwd">as</span> <span class="id">Hrq</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_removes_spec">ps_removes_spec</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (<span class="id">Hnin</span> &amp; <span class="id">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_In_Forall">PS_In_Forall</a></span> <span class="kwd">with</span> (1:=<span class="id">Hrq</span>') <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 (<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_app">InMembers_app</a></span>; <span class="tactic">right</span>). <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_of_list_In">ps_of_list_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="tactic">auto</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hpre</span> <span class="kwd">as</span> (<span class="id">Hpre1</span> &amp; <span class="id">Hpre2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.For_all">PS.For_all</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; ~<span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id">ve1</span>) (<span class="id"><a href="Velus.Common.CommonPS.html#ps_removes">ps_removes</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ins</span>) <span class="id">rq</span>')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_In_Forall">PS_In_Forall</a></span> <span class="kwd">with</span> (2:=<span class="id">Hin</span>) <span class="kwd">in</span> <span class="id">Hrq</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hpre2</span>. <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Common.CommonPS.html#ps_adds_of_list">ps_adds_of_list</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_adds_spec">ps_adds_spec</a></span>; <span class="tactic">left</span>; <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation.Permutation_app_comm</a></span> <span class="id">outs</span> <span class="id">vars</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_app">InMembers_app</a></span> <span class="kwd">in</span> <span class="id">Hrq</span>'' <span class="kwd">as</span> [<span class="id">Hrq</span>''|<span class="id">Hrq</span>'']; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_removes_spec">ps_removes_spec</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (<span class="id">Hnin</span> &amp; <span class="id">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> <span class="id">Hrq</span>''; <span class="id">contradiction</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes_Skip">stmt_eval_add_writes_Skip</a></span> <span class="kwd">with</span> (1:=<span class="id">Htyenv</span>) (<span class="id">p</span>:=<span class="id">p1</span>) (<span class="id">me</span>:=<span class="id">me</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">w</span>:=<span class="id"><a href="Velus.Common.CommonPS.html#ps_removes">ps_removes</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ins</span>) <span class="id">rq</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span> <span class="id">Henv</span> <span class="kwd">as</span> (<span class="id">ve2</span>' &amp; <span class="id">Henv2</span>' &amp; <span class="id">Heval2</span>' &amp; <span class="id">Hmono2</span> &amp; <span class="id">Hin2</span>'); <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hsr</span>:=<span class="id">Hdefs</span>); <span class="tactic">eapply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_correct">add_defaults_stmt_correct</a></span> <span class="kwd">in</span> <span class="id">Hsr</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_inv1">add_defaults_stmt_inv1</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">HI1</span> &amp; <span class="id">HI2</span> &amp; <span class="id">HI3</span> &amp; <span class="id">HI4</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.in1_notin2">in1_notin2</a></span> <span class="id">rq</span>' (<span class="id">st</span> ∪ <span class="id">al</span>) <span class="id">ve2</span>' <span class="id">ve1</span>) <span class="kwd">as</span> <span class="id">Hinout</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="Velus.Common.CommonPS.html#ident_eq_dec">ident_eq_dec</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ins</span>)) <span class="kwd">as</span> [<span class="id">Hiin</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">Hmono2</span>, <span class="id">Hpre1</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PSP.of_list_1">PSP.of_list_1</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.SetoidList.html#InA_alt">SetoidList.InA_alt</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Common.CommonPS.html#ps_removes">ps_removes</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ins</span>) <span class="id">rq</span>')) <span class="kwd">as</span> <span class="id">Hinrq</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#ps_removes_spec">ps_removes_spec</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_In_Forall">PS_In_Forall</a></span> <span class="kwd">with</span> (1:=<span class="id">Hin2</span>') <span class="kwd">in</span> <span class="id">Hinrq</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hpre2</span>, <span class="id"><a href="Velus.Common.CommonPS.html#PSP.of_list_1">PSP.of_list_1</a></span>, <span class="id"><a href="Velus.Environment.html#Env.ME.MO.ListIn_In">Env.ME.MO.ListIn_In</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">HI3</span> <span class="id">_</span> <span class="id">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation.Permutation_app_comm</a></span> <span class="id">outs</span> <span class="id">vars</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS.union_spec">PS.union_spec</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_In_Forall">PS_In_Forall</a></span> <span class="kwd">with</span> (1:=<span class="id">Hvst</span>) <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_app">InMembers_app</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_Forall">InMembers_Forall</a></span> <span class="kwd">with</span> (1:=<span class="id">Hncwin</span>) <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_In_Forall">PS_In_Forall</a></span> <span class="kwd">with</span> (1:=<span class="id">Hval</span>) <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_app">InMembers_app</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_Forall">InMembers_Forall</a></span> <span class="kwd">with</span> (1:=<span class="id">Hncwin</span>) <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hsr</span> <span class="kwd">in</span> <span class="id">Heval</span> <span class="kwd">as</span> (<span class="id">ve3</span>' &amp; <span class="id">Henv3</span>' &amp; <span class="id">Heval3</span>'); <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">ve3</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_eval_add_writes_split">stmt_eval_add_writes_split</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.No_Naked_Vars_add_defaults_method">No_Naked_Vars_add_defaults_method</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.No_Naked_Vars">No_Naked_Vars</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>).(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_body">m_body</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</div>
<div class="proofscript" id="proof48">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">m</span> <span class="kwd">as</span> [<span class="id">n</span> <span class="id">ins</span> <span class="id">vars</span> <span class="id">outs</span> <span class="id">s</span> <span class="id">nodup</span> <span class="id">good</span>]; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> |- <span class="id">context</span> [ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> ?<span class="id">tyenv</span> ?<span class="id">W</span> <span class="id">s</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">defs</span> := <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id">W</span> <span class="id">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt">add_defaults_stmt</a></span> <span class="id">tyenv</span> <span class="id">W</span> <span class="id">s</span> = <span class="id">defs</span>) <span class="kwd">as</span> <span class="id">Hdefs</span> <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">subst</span> <span class="id">defs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">defs</span> <span class="kwd">as</span> [[[<span class="id">t</span> <span class="id">rq</span>'] <span class="id">st</span>] <span class="id">al</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_inv1">add_defaults_stmt_inv1</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdefs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">HI1</span> &amp; <span class="id">HI2</span> &amp; <span class="id">HI3</span> &amp; <span class="id">HI4</span> &amp; <span class="id">HI5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.No_Naked_Vars_add_writes">No_Naked_Vars_add_writes</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_method_refines">add_defaults_method_refines</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">insts</span> <span class="id">mems</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.program_refines">program_refines</a></span> (<span class="kwd">fun</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.all_in1">all_in1</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p1">p1</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p2">p2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_method">wt_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p2">p2</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#insts">insts</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#mems">mems</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.No_Overwrites">No_Overwrites</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_body">m_body</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; ~ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_body">m_body</a></span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_in">m_in</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ome</span> <span class="id">ome</span>' <span class="id">clsid</span> <span class="id">f</span> <span class="id">vos</span> <span class="id">rvos</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">vo</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vo">vo</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vos">vos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_call_eval">stmt_call_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p1">p1</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ome">ome</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#clsid">clsid</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#f">f</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vos">vos</a></span> <span class="id">ome</span>' <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rvos">rvos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rvos">rvos</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.method_refines">method_refines</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p1">p1</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p2">p2</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.all_in1">all_in1</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</div>
<div class="proofscript" id="proof49">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hpr</span> <span class="id">WTm</span> <span class="id">Hnoo</span> <span class="id">Hncwi</span> <span class="id">Hcall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.method_refines">method_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method_m_in">add_defaults_method_m_in</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method_m_out">add_defaults_method_m_out</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_stmt_refines">add_defaults_stmt_refines</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (2:=<span class="id">WTm</span>) (3:=<span class="id">Hnoo</span>) (4:=<span class="id">Hncwi</span>) (5:=<span class="id">Hcall</span>) <span class="kwd">in</span> <span class="id">Hpr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.stmt_refines_strengthen">stmt_refines_strengthen</a></span> <span class="kwd">with</span> (1:=<span class="id">Hpr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">ve1</span> <span class="id">ve2</span> (<span class="id">Hpre1</span> &amp; <span class="id">Hpre2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.Common.html#In_of_list_InMembers">In_of_list_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hpre1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation.Permutation_app_comm</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_app_InMembers">NoDupMembers_app_InMembers</a></span> <span class="kwd">with</span> (<span class="id">ws</span>:=<span class="id">m</span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_in">m_in</a></span>)) <span class="kwd">in</span> <span class="id">Hin</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation.Permutation_app_comm</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_nodupvars">m_nodupvars</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_class_refines">add_defaults_class_refines</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.program_refines">program_refines</a></span> (<span class="kwd">fun</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.all_in1">all_in1</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p1">p1</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p2">p2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_class">wt_class</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p2">p2</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.No_Overwrites">No_Overwrites</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_body">m_body</a></span>)) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_methods">c_methods</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; ~ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_body">m_body</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_in">m_in</a></span>))) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.c_methods">c_methods</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ome</span> <span class="id">ome</span>' <span class="id">clsid</span> <span class="id">f</span> <span class="id">vos</span> <span class="id">rvos</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">vo</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vo">vo</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vos">vos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_call_eval">stmt_call_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p1">p1</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ome">ome</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#clsid">clsid</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#f">f</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vos">vos</a></span> <span class="id">ome</span>' <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rvos">rvos</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rvos">rvos</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.class_refines">class_refines</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p1">p1</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p2">p2</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.all_in1">all_in1</a></span>) (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class">add_defaults_class</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</div>
<div class="proofscript" id="proof50">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">c</span> <span class="id">Hpr</span> <span class="id">WTc</span> <span class="id">Hnoo</span> <span class="id">Hncwm</span> <span class="id">Hcall</span> <span class="id">f</span> <span class="id">fm</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_class_find_method">wt_class_find_method</a></span> <span class="kwd">with</span> (2:=<span class="id">Hfind</span>) <span class="kwd">in</span> <span class="id">WTc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class_find_method">add_defaults_class_find_method</a></span>, <span class="id">Hfind</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.find_method_In">find_method_In</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hfind</span>) <span class="kwd">as</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method">add_defaults_method</a></span> <span class="id">fm</span>). <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">with</span> (2:=<span class="id">Hin</span>) <span class="kwd">in</span> <span class="id">Hnoo</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">with</span> (2:=<span class="id">Hin</span>) <span class="kwd">in</span> <span class="id">Hncwm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_method_refines">add_defaults_method_refines</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.add_defaults_program_refines">add_defaults_program_refines</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_program">wt_program</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Forall_methods">Forall_methods</a></span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.No_Overwrites">No_Overwrites</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_body">m_body</a></span>)) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Forall_methods">Forall_methods</a></span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; ~ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_body">m_body</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_in">m_in</a></span>))) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.program_refines">program_refines</a></span> (<span class="kwd">fun</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.all_in1">all_in1</a></span>) (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</div>
<div class="proofscript" id="proof51">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">p</span> <span class="id">WTp</span> <span class="id">Hnoo</span> <span class="id">Hncw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">c1</span> <span class="id">c2</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c1">c1</a></span> = <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class">add_defaults_class</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c2">c2</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span> <span class="id">p</span>) <span class="id">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_same">Forall2_same</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">program_refines_by_class</span>' <span class="kwd">with</span> (1:=<span class="id">WTp</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#all_In_Forall2">all_In_Forall2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">c1</span> <span class="id">c2</span> <span class="id">Hin</span> <span class="id">p1</span>' <span class="id">p2</span>' <span class="id">WTp</span>' <span class="id">WTc</span> <span class="id">Hpr</span> <span class="id">Hadc</span> <span class="id">Hx</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class_c_name">add_defaults_class_c_name</a></span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_combine_r">in_combine_r</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">with</span> (2:=<span class="id">Hin</span>) <span class="kwd">in</span> <span class="id">Hnoo</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">with</span> (2:=<span class="id">Hin</span>) <span class="kwd">in</span> <span class="id">Hncw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_class_refines">add_defaults_class_refines</a></span> <span class="kwd">with</span> (1:=<span class="id">Hpr</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">p1</span>' = <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span> <span class="id">p2</span>') <span class="kwd">as</span> <span class="id">Hp1</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="id">now</span> <span class="tactic">clear</span> <span class="id">Hpr</span> <span class="id">WTp</span>' <span class="id">WTc</span>; <span class="tactic">induction</span> <span class="id">Hadc</span>; <span class="tactic">auto</span>; <span class="tactic">subst</span>; <span class="tactic">simpl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_call_eval_add_defaults_class_not_None">stmt_call_eval_add_defaults_class_not_None</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="OBCADDDEFAULTS.No_Naked_Vars_add_defaults_class">No_Naked_Vars_add_defaults_class</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Forall_methods">Forall_methods</a></span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.No_Naked_Vars">No_Naked_Vars</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_body">m_body</a></span>)) (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</div>
<div class="proofscript" id="proof52">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="tactic">intros</span> <span class="id">c</span>' <span class="id">Hcin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span> <span class="kwd">in</span> *; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hcin</span> <span class="kwd">as</span> (<span class="id">c</span> &amp; <span class="id">Hc</span>' &amp; <span class="id">Hcin</span>); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="tactic">intros</span> <span class="id">m</span>' <span class="id">Hmin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">c</span> <span class="kwd">as</span> (<span class="id">name</span>, <span class="id">mems</span>, <span class="id">objs</span>, <span class="id">methods</span>, <span class="id">Hnodup</span>, <span class="id">Hnodupm</span>, <span class="id">Hgood</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hmin</span> <span class="kwd">as</span> (<span class="id">m</span> &amp; <span class="id">Hm</span> &amp; <span class="id">Hmin</span>); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.No_Naked_Vars_add_defaults_method">No_Naked_Vars_add_defaults_method</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id"><a name="OBCADDDEFAULTS.stmt_call_eval_add_defaults">stmt_call_eval_add_defaults</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">me</span> <span class="id">f</span> <span class="id">m</span> <span class="id">vs</span> <span class="id">me</span>' <span class="id">rvs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_program">wt_program</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Forall_methods">Forall_methods</a></span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.No_Overwrites">No_Overwrites</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_body">m_body</a></span>)) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Forall_methods">Forall_methods</a></span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; ~ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_body">m_body</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_in">m_in</a></span>))) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_call_eval">stmt_call_eval</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#f">f</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vs">vs</a></span>) <span class="id">me</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rvs">rvs</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.stmt_call_eval">stmt_call_eval</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#f">f</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#vs">vs</a></span>) <span class="id">me</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#rvs">rvs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</div>
<div class="proofscript" id="proof53">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">WTp</span> <span class="id">NOO</span> <span class="id">NCW</span> <span class="id">Call</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ.program_refines_stmt_call_eval">program_refines_stmt_call_eval</a></span> <span class="kwd">in</span> <span class="id">Call</span> <span class="kwd">as</span> (<span class="id">rvos</span> &amp;?&amp; <span class="id">Spec</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults_program_refines">add_defaults_program_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">rvos</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rvs</span>) <span class="kwd">as</span> -&gt;; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span> <span class="kwd">in</span> <span class="id">Spec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Spec</span>; <span class="tactic">induction</span> <span class="id">Spec</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>; <span class="tactic">f_equal</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.adds_opt_is_adds">Env.adds_opt_is_adds</a></span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>, <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_nodupin">m_nodupin</a></span>; <span class="tactic">intro</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.In_adds_spec">Env.In_adds_spec</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>, <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.empty_in_iff">Env.Props.P.F.empty_in_iff</a></span>; <span class="tactic">intuition</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_same">Forall2_same</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="OBCADDDEFAULTS.loop_call_add_defaults">loop_call_add_defaults</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">c</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">p</span> <span class="id">me</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc.wt_program">wt_program</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Forall_methods">Forall_methods</a></span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.No_Overwrites">No_Overwrites</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_body">m_body</a></span>)) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.Forall_methods">Forall_methods</a></span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; ~ <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc.Can_write_in">Can_write_in</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#x">x</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_body">m_body</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#m">m</a></span>.(<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc.m_in">m_in</a></span>))) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.loop_call">loop_call</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#f">f</a></span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ins">ins</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#n">n</a></span>)) (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#outs">outs</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#n">n</a></span>)) 0 <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc.loop_call">loop_call</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.add_defaults">add_defaults</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#p">p</a></span>) <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#c">c</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#f">f</a></span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ins">ins</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#n">n</a></span>)) (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.Obc.ObcAddDefaults.html#outs">outs</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#n">n</a></span>)) 0 <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#me">me</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</div>
<div class="proofscript" id="proof54">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?????; <span class="tactic">generalize</span> 0%<span class="id">nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">COINDHYP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">n</span> <span class="id">me</span> <span class="id">WTp</span> <span class="id">NOO</span> <span class="id">NCW</span> <span class="id">Hdo</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hdo</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS.stmt_call_eval_add_defaults">stmt_call_eval_add_defaults</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS">OBCADDDEFAULTS</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="ObcAddDefaultsFun">ObcAddDefaultsFun</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ids</span>   : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Op</span>    : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">SynObc</span>: <span class="id"><a href="Velus.Obc.ObcSyntax.html#OBCSYNTAX">Velus.Obc.ObcSyntax.OBCSYNTAX</a></span>         <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">SemObc</span>: <span class="id"><a href="Velus.Obc.ObcSemantics.html#OBCSEMANTICS">Velus.Obc.ObcSemantics.OBCSEMANTICS</a></span>   <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc">SynObc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">InvObc</span>: <span class="id"><a href="Velus.Obc.ObcInvariants.html#OBCINVARIANTS">Velus.Obc.ObcInvariants.OBCINVARIANTS</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc">SynObc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc">SemObc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">TypObc</span>: <span class="id"><a href="Velus.Obc.ObcTyping.html#OBCTYPING">Velus.Obc.ObcTyping.OBCTYPING</a></span>         <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc">SynObc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc">SemObc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Equ</span>   : <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV">Velus.Obc.Equiv.EQUIV</a></span>                 <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc">SynObc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc">SemObc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc">TypObc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;: <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS">OBCADDDEFAULTS</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc">SynObc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc">SemObc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc">InvObc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc">TypObc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ">Equ</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Include</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OBCADDDEFAULTS">OBCADDDEFAULTS</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SynObc">SynObc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#SemObc">SemObc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#InvObc">InvObc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#TypObc">TypObc</a></span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#Equ">Equ</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Obc.ObcAddDefaults.html#ObcAddDefaultsFun">ObcAddDefaultsFun</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
