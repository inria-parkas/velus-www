
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module NFCorrectness</title>
<meta name="description" content="Documentation of Coq module NFCorrectness" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
</head>

<body>
<h1 class="title">Module NFCorrectness</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#ListNotations">List.ListNotations</a></span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Setoids.Setoid.html">Setoid</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Operators.html">Operators</a></span> <span class="id"><a href="Velus.FunctionalEnvironment.html">FunctionalEnvironment</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Clocks.html">Clocks</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.CoindStreams.html">CoindStreams</a></span> <span class="id"><a href="Velus.IndexedStreams.html">IndexedStreams</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.CoindIndexed.html">CoindIndexed</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Fresh.html">Fresh</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.StaticEnv.html">Lustre.StaticEnv</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.LSyntax.html">Lustre.LSyntax</a></span> <span class="id"><a href="Velus.Lustre.LOrdered.html">Lustre.LOrdered</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html">Lustre.LClocking</a></span> <span class="id"><a href="Velus.Lustre.LSemantics.html">Lustre.LSemantics</a></span> <span class="id"><a href="Velus.Lustre.LClockedSemantics.html">Lustre.LClockedSemantics</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.NormFby.NormFby.html">Lustre.NormFby.NormFby</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.NormFby.NFClocking.html">Lustre.NormFby.NFClocking</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.SubClock.SCCorrectness.html">Lustre.SubClock.SCCorrectness</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="kwd">Type</span> <span class="id"><a name="NFCORRECTNESS">NFCORRECTNESS</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ids</span> : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Op</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Cks</span> : <span class="id"><a href="Velus.Clocks.html#CLOCKS">CLOCKS</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">CStr</span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS">COINDSTREAMS</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Senv</span> : <span class="id"><a href="Velus.Lustre.StaticEnv.html#STATICENV">STATICENV</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Syn</span> : <span class="id"><a href="Velus.Lustre.LSyntax.html#LSYNTAX">LSYNTAX</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv">Senv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Cl</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING">LCLOCKING</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ord</span> : <span class="id"><a href="Velus.Lustre.LOrdered.html#LORDERED">LORDERED</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Sem</span> : <span class="id"><a href="Velus.Lustre.LSemantics.html#LSEMANTICS">LSEMANTICS</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ord">Ord</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr">CStr</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">LCS</span> : <span class="id"><a href="Velus.Lustre.LClockedSemantics.html#LCLOCKEDSEMANTICS">LCLOCKEDSEMANTICS</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cl">Cl</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ord">Ord</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr">CStr</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem">Sem</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">NF</span>  : <span class="id"><a href="Velus.Lustre.NormFby.NormFby.html#NORMFBY">NORMFBY</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn">Syn</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh">Fresh</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.Tactics">Tactics</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF">NF</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="kwd">Import</span> <span class="id"><a name="NFCORRECTNESS.Clocking">Clocking</a></span> := <span class="id"><a href="Velus.Lustre.NormFby.NFClocking.html#NFClockingFun">NFClockingFun</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cl">Cl</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF">NF</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="kwd">Import</span> <span class="id"><a name="NFCORRECTNESS.SCC">SCC</a></span> := <span class="id"><a href="Velus.Lustre.SubClock.SCCorrectness.html#SCCorrectnessFun">SCCorrectnessFun</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr">CStr</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cl">Cl</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ord">Ord</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem">Sem</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS">LCS</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.SC">SC</a></span>. <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.SC">SC</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="NFCORRECTNESS.normfby_node_sem">normfby_node_sem</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> : @<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.normlast">normlast</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids.last_prefs">last_prefs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="NFCORRECTNESS.normfby_node_sem.G2">G2</a></span> : @<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.normalized">normalized</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids.fby_prefs">fby_prefs</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="NFCORRECTNESS.normfby_node_sem.Hiface">Hiface</a></span> : <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.global_iface_incl">global_iface_incl</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="NFCORRECTNESS.normfby_node_sem.HGref">HGref</a></span> : <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.global_sem_refines">global_sem_refines</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="NFCORRECTNESS.normfby_node_sem.HwcG1">HwcG1</a></span> : <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cl.wc_global">wc_global</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span>.<br/>
<br/>
<h3> Manipulation of initialization streams </h3>
<br/>
<div class="doc">We want to specify the semantics of the init equations created during the normalization
      with idents stored in the env </div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="NFCORRECTNESS.false_val">false_val</a></span> := <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op.Venum">Venum</a></span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="NFCORRECTNESS.true_val">true_val</a></span> := <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op.Venum">Venum</a></span> 1.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="NFCORRECTNESS.sfby_const">sfby_const</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby">sfby</a></span> <span class="id">v</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val">const_val</a></span> <span class="id">bs</span> <span class="id">v</span>) <span class="id">≡</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val">const_val</a></span> <span class="id">bs</span> <span class="id">v</span>).<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">b</span> <span class="id">bs</span>] <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val_Cons">const_val_Cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">b</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby_Cons">sfby_Cons</a></span>; <span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="NFCORRECTNESS.case_false">case_false</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.aligned">aligned</a></span> <span class="id">xs</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.aligned">aligned</a></span> <span class="id">ys</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.case">case</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val">const_val</a></span> <span class="id">bs</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.false_val">false_val</a></span>) [(1, <span class="id">ys</span>); (0, <span class="id">xs</span>)] <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">xs</span>.<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">b</span> <span class="id">bs</span>] <span class="id">xs</span> <span class="id">ys</span> <span class="id">Hsync1</span> <span class="id">Hsync2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val_Cons">const_val_Cons</a></span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.false_val">false_val</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsync1</span>; <span class="id">inv</span> <span class="id">Hsync2</span>; <span class="id">econstructor</span>; <span class="id">simpl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="NFCORRECTNESS.sfby_fby1">sfby_fby1</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">v</span> <span class="id">y</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.aligned">aligned</a></span> <span class="id">ys</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.fby1">fby1</a></span> <span class="id">y</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val">const_val</a></span> <span class="id">bs</span> <span class="id">v</span>) <span class="id">ys</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby">sfby</a></span> <span class="id">y</span> <span class="id">ys</span>).<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof with</summary>
<div class="proofscript">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">sfby_fby1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">b</span> <span class="id">bs</span>] <span class="id">v</span> <span class="id">y</span> <span class="id">ys</span> <span class="id">Hsync</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">sfby_fby1</span> <span class="id">bs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsync</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val_Cons">const_val_Cons</a></span>; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sfby_fby1'</span> : <span class="kwd">forall</span> <span class="id">y</span> <span class="id">y0s</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.fby1">fby1</a></span> <span class="id">y</span> <span class="id">y0s</span> <span class="id">ys</span> <span class="id">zs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">zs</span> <span class="id">≡</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby">sfby</a></span> <span class="id">y</span> <span class="id">ys</span>).<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">y</span> <span class="id">y0s</span> <span class="id">ys</span> <span class="id">zs</span> <span class="id">Hfby1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfby1</span>; <span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="NFCORRECTNESS.sfby_fby">sfby_fby</a></span> : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">v</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.aligned">aligned</a></span> <span class="id">y</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.fby">fby</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val">const_val</a></span> <span class="id">b</span> <span class="id">v</span>) <span class="id">y</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby">sfby</a></span> <span class="id">v</span> <span class="id">y</span>).<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof with</summary>
<div class="proofscript">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">sfby_fby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">b</span> <span class="id">bs</span>] <span class="id">v</span> <span class="id">y</span> <span class="id">Hsync</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val_Cons">const_val_Cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">b</span>; <span class="id">simpl</span>; <span class="id">inv</span> <span class="id">Hsync</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.sfby_fby1">sfby_fby1</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="id">simpl</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="NFCORRECTNESS.init_stream">init_stream</a></span> <span class="id">bs</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby">sfby</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.true_val">true_val</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.enum">enum</a></span> <span class="id">bs</span> 0).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="NFCORRECTNESS.init_stream_Proper">init_stream_Proper</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux.svalue">svalue</a></span>) <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_stream">init_stream</a></span>.<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">bs</span> <span class="id">bs'</span> <span class="id">Heq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_stream">init_stream</a></span>. <span class="id">rewrite</span> <span class="id">Heq1</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="NFCORRECTNESS.fby_case">fby_case</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">v</span> <span class="id">y0s</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.aligned">aligned</a></span> <span class="id">y0s</span> <span class="id">bs</span> \/ <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.aligned">aligned</a></span> <span class="id">ys</span> <span class="id">bs</span> \/ <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.aligned">aligned</a></span> <span class="id">zs</span> <span class="id">bs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.fby">fby</a></span> <span class="id">y0s</span> <span class="id">ys</span> <span class="id">zs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.case">case</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby">sfby</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.true_val">true_val</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val">const_val</a></span> <span class="id">bs</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.false_val">false_val</a></span>)) [(1, <span class="id">y0s</span>);(0, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby">sfby</a></span> <span class="id">v</span> <span class="id">ys</span>)] <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">zs</span>.<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof with</summary>
<div class="proofscript">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">b</span> <span class="id">bs</span>] <span class="id">v</span> <span class="id">y0s</span> <span class="id">ys</span> <span class="id">zs</span> <span class="id">Hsync</span> <span class="id">Hfby1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.fby_aligned">fby_aligned</a></span> <span class="kwd">in</span> <span class="id">Hsync</span> <span class="kwd">as</span> [<span class="id">Hsync1</span> [<span class="id">Hsync2</span> <span class="id">Hsync3</span>]]; [|<span class="id">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">b</span>; <span class="id">inv</span> <span class="id">Hsync1</span>; <span class="id">inv</span> <span class="id">Hsync2</span>; <span class="id">inv</span> <span class="id">Hsync3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val_Cons">const_val_Cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfby1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby_Cons">sfby_Cons</a></span>. <span class="id">econstructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.sfby_const">sfby_const</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">vs1</span> <span class="id">≡</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby">sfby</a></span> <span class="id">v1</span> <span class="id">vs0</span>) <span class="kwd">as</span> <span class="id">Heq</span> <span class="kwd">by</span> (<span class="id">eapply</span> <span class="id">sfby_fby1'</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.case_false">case_false</a></span>... <span class="id">rewrite</span> &lt;-<span class="id">Heq</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">auto</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val_Cons">const_val_Cons</a></span>. <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby_Cons">sfby_Cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfby1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">CoFix</span>; <span class="id">eauto</span>. <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="NFCORRECTNESS.fby_init_stream_case">fby_init_stream_case</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">v</span> <span class="id">y0s</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.aligned">aligned</a></span> <span class="id">y0s</span> <span class="id">bs</span> \/ <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.aligned">aligned</a></span> <span class="id">ys</span> <span class="id">bs</span> \/ <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.aligned">aligned</a></span> <span class="id">zs</span> <span class="id">bs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.fby">fby</a></span> <span class="id">y0s</span> <span class="id">ys</span> <span class="id">zs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.case">case</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_stream">init_stream</a></span> <span class="id">bs</span>) [(1, <span class="id">y0s</span>); (0, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby">sfby</a></span> <span class="id">v</span> <span class="id">ys</span>)] <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">zs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hsync</span> <span class="id">Hfby1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.fby_case">fby_case</a></span> <span class="kwd">in</span> <span class="id">Hfby1</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_stream">init_stream</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val_enum">const_val_enum</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="NFCORRECTNESS.arrow_case">arrow_case</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">y0s</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.aligned">aligned</a></span> <span class="id">y0s</span> <span class="id">bs</span> \/ <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.aligned">aligned</a></span> <span class="id">ys</span> <span class="id">bs</span> \/ <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.aligned">aligned</a></span> <span class="id">zs</span> <span class="id">bs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.arrow">arrow</a></span> <span class="id">y0s</span> <span class="id">ys</span> <span class="id">zs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.case">case</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby">sfby</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.true_val">true_val</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val">const_val</a></span> <span class="id">bs</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.false_val">false_val</a></span>)) [(1,<span class="id">y0s</span>);(0,<span class="id">ys</span>)] <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">zs</span>.<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof with</summary>
<div class="proofscript">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">b</span> <span class="id">bs</span>] <span class="id">y0s</span> <span class="id">ys</span> <span class="id">zs</span> <span class="id">Hsync</span> <span class="id">Harrow</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.arrow_aligned">arrow_aligned</a></span> <span class="kwd">in</span> <span class="id">Hsync</span> <span class="kwd">as</span> [<span class="id">Hsync1</span> [<span class="id">Hsync2</span> <span class="id">Hsync3</span>]]; [|<span class="id">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">b</span>; <span class="id">inv</span> <span class="id">Hsync1</span>; <span class="id">inv</span> <span class="id">Hsync2</span>; <span class="id">inv</span> <span class="id">Hsync3</span>; <span class="id">inv</span> <span class="id">Harrow</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val_Cons">const_val_Cons</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby_Cons">sfby_Cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.sfby_const">sfby_const</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span>. <span class="id">revert</span> <span class="id">bs</span> <span class="id">vs</span> <span class="id">vs0</span> <span class="id">vs1</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>. <span class="id">intros</span> * <span class="id">Hsync1</span> <span class="id">Hsync2</span> <span class="id">Hsync3</span> <span class="id">Harrow</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">bs</span> <span class="kwd">as</span> [[|] <span class="id">bs</span>]; <span class="id">inv</span> <span class="id">Hsync1</span>; <span class="id">inv</span> <span class="id">Hsync2</span>; <span class="id">inv</span> <span class="id">Hsync3</span>; <span class="id">inv</span> <span class="id">Harrow</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val_Cons">const_val_Cons</a></span>; <span class="id">econstructor</span>; <span class="id">simpl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">auto</span>; <span class="id">simpl</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">auto</span>; <span class="id">simpl</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val_Cons">const_val_Cons</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby_Cons">sfby_Cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="NFCORRECTNESS.arrow_init_stream_case">arrow_init_stream_case</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">y0s</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.aligned">aligned</a></span> <span class="id">y0s</span> <span class="id">bs</span> \/ <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.aligned">aligned</a></span> <span class="id">ys</span> <span class="id">bs</span> \/ <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.aligned">aligned</a></span> <span class="id">zs</span> <span class="id">bs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.arrow">arrow</a></span> <span class="id">y0s</span> <span class="id">ys</span> <span class="id">zs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.case">case</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_stream">init_stream</a></span> <span class="id">bs</span>) [(1,<span class="id">y0s</span>);(0,<span class="id">ys</span>)] <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">zs</span>.<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hsync</span> <span class="id">Harrow</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.arrow_case">arrow_case</a></span> <span class="kwd">in</span> <span class="id">Harrow</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_stream">init_stream</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val_enum">const_val_enum</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="NFCORRECTNESS.ac_sfby">ac_sfby</a></span> : <span class="kwd">forall</span> <span class="id">v0</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.abstract_clock">abstract_clock</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby">sfby</a></span> <span class="id">v0</span> <span class="id">xs</span>) <span class="id">≡</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.abstract_clock">abstract_clock</a></span> <span class="id">xs</span>.<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>. <span class="id">intros</span> <span class="id">v0</span> [<span class="id">x</span> <span class="id">xs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby_Cons">sfby_Cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span>; <span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="NFCORRECTNESS.init_stream_ac">init_stream_ac</a></span> : <span class="kwd">forall</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.abstract_clock">abstract_clock</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_stream">init_stream</a></span> <span class="id">bs</span>) <span class="id">≡</span> <span class="id">bs</span>.<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">bs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_stream">init_stream</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.ac_sfby">ac_sfby</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.ac_enum">ac_enum</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="NFCORRECTNESS.normfby_node_sem.normfby_block_sem">normfby_block_sem</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> : <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.static_env">static_env</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="NFCORRECTNESS.normfby_node_sem.normfby_block_sem.Atoms">Atoms</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, _) =&gt; <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids.last_prefs">last_prefs</a></span> <span class="id">x</span>) <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.NormFby.NormFby.html">NormFby</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="NFCORRECTNESS.hist_st">hist_st</a></span> {<span class="id">pref</span>} <span class="id">vars</span> <span class="id">b</span> <span class="id">H</span> (<span class="id">st</span>: <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.fresh_st">fresh_st</a></span> <span class="id">pref</span> _) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.dom">dom</a></span> <span class="id">H</span> (<span class="id">vars</span>++<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="id">st</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sc_vars">LCS.sc_vars</a></span> (<span class="id">vars</span>++<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="id">st</span>) <span class="id">H</span> <span class="id">b</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="NFCORRECTNESS.fresh_ident_refines">fresh_ident_refines</a></span> : <span class="kwd">forall</span> <span class="id">hint</span> <span class="id">H</span> <span class="id">a</span> <span class="id">id</span> (<span class="id">v</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux.svalue">svalue</a></span>) (<span class="id">st</span> <span class="id">st'</span> : <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids.fby_id">Ids.fby_id</a></span> _),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.dom">dom</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span>++<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="id">st</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.fresh_ident">fresh_ident</a></span> <span class="id">hint</span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">id</span>, <span class="id">st'</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) <span class="id">H</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.add">FEnv.add</a></span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">id</span>) <span class="id">v</span> <span class="id">H</span>).<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof with</summary>
<div class="proofscript">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hdom</span> <span class="id">Hfresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.add_refines">FEnv.add_refines</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonStreams.html#EqStrel_Reflexive">EqStrel_Reflexive</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">contra</span>. <span class="id">apply</span> <span class="id">Hdom</span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.IsVar_app">IsVar_app</a></span> <span class="kwd">in</span> <span class="id">contra</span> <span class="kwd">as</span> [<span class="id">contra</span>|<span class="id">contra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.Facts.fresh_ident_In">Facts.fresh_ident_In</a></span> <span class="kwd">in</span> <span class="id">Hfresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">contra</span>. <span class="id">simpl_In</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">id</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.st_ids">st_ids</a></span> <span class="id">st'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.st_ids">st_ids</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.idty">idty</a></span>. <span class="id">solve_In</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.Facts.st_valid_AtomOrGensym_nIn">Facts.st_valid_AtomOrGensym_nIn</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.fby_not_in_last_prefs">fby_not_in_last_prefs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">contra</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.Facts.fresh_ident_nIn">Facts.fresh_ident_nIn</a></span> <span class="kwd">in</span> <span class="id">Hfresh</span>; <span class="id">eauto</span>. <span class="id">eapply</span> <span class="id">Hfresh</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="NFCORRECTNESS.fresh_ident_dom">fresh_ident_dom</a></span> : <span class="kwd">forall</span> <span class="id">pref</span> <span class="id">hint</span> <span class="id">vars</span> <span class="id">H</span> <span class="id">a</span> <span class="id">id</span> <span class="id">v</span> (<span class="id">st</span> <span class="id">st'</span> : <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.fresh_st">fresh_st</a></span> <span class="id">pref</span> _),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.dom">dom</a></span> <span class="id">H</span> (<span class="id">vars</span>++<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="id">st</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.fresh_ident">fresh_ident</a></span> <span class="id">hint</span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">id</span>, <span class="id">st'</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.dom">dom</a></span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.add">FEnv.add</a></span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">id</span>) <span class="id">v</span> <span class="id">H</span>) (<span class="id">vars</span>++<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="id">st'</span>).<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * (<span class="id">D1</span>&amp;<span class="id">D2</span>) <span class="id">Hfresh</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.Ker.fresh_ident_anns">Ker.fresh_ident_anns</a></span> <span class="kwd">in</span> <span class="id">Hfresh</span>. <span class="id">rewrite</span> <span class="id">Hfresh</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intros</span> ?; <span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.add_In">FEnv.add_In</a></span>; [<span class="id">rewrite</span> <span class="id">D1</span>|<span class="id">rewrite</span> <span class="id">D2</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_middle">Permutation.Permutation_middle</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">split</span>; [<span class="id">intros</span> [<span class="id">Eq</span>|]; <span class="id">try</span> <span class="id">inv</span> <span class="id">Eq</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span> <span class="id">datatypes</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">intros</span> <span class="id">Var</span>; <span class="id">inv</span> <span class="id">Var</span>; <span class="id">simpl</span> <span class="kwd">in</span> *]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">take</span> (_ \/ _) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span>; <span class="id">subst</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">take</span> (_ \/ _) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span>; <span class="id">inv_equalities</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="NFCORRECTNESS.fresh_ident_hist_st">fresh_ident_hist_st</a></span> : <span class="kwd">forall</span> <span class="id">hint</span> <span class="id">b</span> <span class="id">ty</span> <span class="id">ck</span> <span class="id">id</span> <span class="id">v</span> <span class="id">H</span> (<span class="id">st</span> <span class="id">st'</span>: <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids.fby_id">Ids.fby_id</a></span> _),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sem_clock">sem_clock</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.var_history">var_history</a></span> <span class="id">H</span>) <span class="id">b</span> <span class="id">ck</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.abstract_clock">abstract_clock</a></span> <span class="id">v</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.fresh_ident">fresh_ident</a></span> <span class="id">hint</span> (<span class="id">ty</span>, <span class="id">ck</span>) <span class="id">st</span> = (<span class="id">id</span>, <span class="id">st'</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">b</span> <span class="id">H</span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">b</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.add">FEnv.add</a></span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">id</span>) <span class="id">v</span> <span class="id">H</span>) <span class="id">st'</span>.<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof with</summary>
<div class="proofscript">
 <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hsem</span> <span class="id">Hfresh</span> [<span class="id">Hdom</span> <span class="id">Hsc</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (~<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">id</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.st_ids">st_ids</a></span> <span class="id">st</span>)) <span class="kwd">as</span> <span class="id">Hnin</span> <span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.Facts.fresh_ident_nIn">Facts.fresh_ident_nIn</a></span> <span class="kwd">in</span> <span class="id">Hfresh</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hfresh'</span>:=<span class="id">Hfresh</span>). <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.fresh_ident_anns">fresh_ident_anns</a></span> <span class="kwd">in</span> <span class="id">Hfresh'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) <span class="id">H</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.add">FEnv.add</a></span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">id</span>) <span class="id">v</span> <span class="id">H</span>)) <span class="kwd">as</span> <span class="id">Href</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.fresh_ident_refines">fresh_ident_refines</a></span> <span class="kwd">in</span> <span class="id">Hfresh</span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hsc</span> <span class="kwd">as</span> (<span class="id">Hsc1</span>&amp;<span class="id">Hsc2</span>). <span class="id">split</span>; [|<span class="id">split</span>]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.fresh_ident_dom">fresh_ident_dom</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hck</span> <span class="id">Hv</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hfresh'</span> <span class="kwd">in</span> <span class="id">Hck</span>. <span class="id">simpl_app</span>. <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">rewrite</span> &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_middle">Permutation.Permutation_middle</a></span> <span class="kwd">in</span> <span class="id">Hck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hck</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H1</span>. <span class="id">inv</span> <span class="id">Hv</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.gss">FEnv.gss</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H2</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.sem_clock_refines">sem_clock_refines</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.var_history_refines">var_history_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.sem_clock_refines">sem_clock_refines</a></span>, <span class="id">Hsc1</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.var_history_refines">var_history_refines</a></span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hv</span>. <span class="id">econstructor</span>; <span class="id">eauto</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.gso">FEnv.gso</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">contra</span>; <span class="id">inv</span> <span class="id">contra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> _ (_ ++ _)) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id">Facts.fresh_ident_nIn'</span> <span class="kwd">with</span> (<span class="id">aft</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.fby_not_in_last_prefs">fby_not_in_last_prefs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Hin</span>. <span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id">Hnin</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.st_ids">st_ids</a></span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hck</span> <span class="id">Hla</span> <span class="id">Hv</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hfresh'</span> <span class="kwd">in</span> <span class="id">Hck</span>, <span class="id">Hla</span>. <span class="id">simpl_app</span>. <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">rewrite</span> &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_middle">Permutation.Permutation_middle</a></span> <span class="kwd">in</span> <span class="id">Hck</span>, <span class="id">Hla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hck</span>. <span class="id">inv</span> <span class="id">Hla</span>. <span class="id">inv</span> <span class="id">H0</span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="id">inv_equalities</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>. <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; [|<span class="id">eapply</span> <span class="id">Hnin</span>; <span class="id">solve_In</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Facts.fresh_ident_nIn'</span> <span class="kwd">with</span> (<span class="id">aft</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.fby_not_in_last_prefs">fby_not_in_last_prefs</a></span>. 2:<span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Hin</span>. <span class="id">simpl_Forall</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.sem_clock_refines">sem_clock_refines</a></span>, <span class="id">Hsc2</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.var_history_refines">var_history_refines</a></span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hv</span>. <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.add">FEnv.add</a></span> <span class="kwd">in</span> *. <span class="id">cases_eqn</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Eq">Eq</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Eq</span>. <span class="id">inv</span> <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.sem_clock_refines">sem_clock_refines</a></span>, <span class="id">Hsc2</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.var_history_refines">var_history_refines</a></span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hv</span>. <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.add">FEnv.add</a></span> <span class="kwd">in</span> *. <span class="id">cases_eqn</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Eq">Eq</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Eq</span>. <span class="id">inv</span> <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="NFCORRECTNESS.init_var_for_clock_sem">init_var_for_clock_sem</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">H</span> <span class="id">ck</span> <span class="id">bs'</span> <span class="id">x</span> <span class="id">eqs'</span> <span class="id">st</span> <span class="id">st'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sem_clock">sem_clock</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.var_history">var_history</a></span> <span class="id">H</span>) <span class="id">bs</span> <span class="id">ck</span> <span class="id">bs'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">bs</span> <span class="id">H</span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.init_var_for_clock">init_var_for_clock</a></span> <span class="id">ck</span> <span class="id">st</span> = (<span class="id">x</span>, <span class="id">eqs'</span>, <span class="id">st'</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">exists</span> <span class="id">H'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) <span class="id">H</span> <span class="id">H'</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">bs</span> <span class="id">H'</span> <span class="id">st'</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sem_var">sem_var</a></span> <span class="id">H'</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_stream">init_stream</a></span> <span class="id">bs'</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_equation_ck">sem_equation_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span> <span class="id">H'</span> <span class="id">bs</span>) <span class="id">eqs'</span>).<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof with</summary>
<div class="proofscript">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hsemc</span> <span class="id">Histst</span> <span class="id">Hinit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.init_var_for_clock">init_var_for_clock</a></span> <span class="kwd">in</span> <span class="id">Hinit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.fresh_ident">fresh_ident</a></span> _ _) <span class="id">eqn</span>:<span class="id">Hident</span>. <span class="id">repeat</span> <span class="id">inv_bind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.add">FEnv.add</a></span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_stream">init_stream</a></span> <span class="id">bs'</span> <span class="comment">(*&nbsp;rs'&nbsp;*)</span>) <span class="id">H</span>) <span class="kwd">as</span> <span class="id">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">H</span> <span class="id">⊑</span> <span class="id">H'</span>) <span class="kwd">as</span> <span class="id">Href1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.fresh_ident_refines">fresh_ident_refines</a></span> <span class="kwd">in</span> <span class="id">Hident</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">destruct</span> <span class="id">Histst</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">bs</span> <span class="id">H'</span> <span class="id">st'</span>) <span class="kwd">as</span> <span class="id">Histst1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.fresh_ident_hist_st">fresh_ident_hist_st</a></span> <span class="kwd">in</span> <span class="id">Hident</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Histst</span> <span class="kwd">as</span> (<span class="id">Hdom</span>&amp;<span class="id">Hsc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_stream_ac">init_stream_ac</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">H'</span>. <span class="id">repeat</span> (<span class="id">split</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">HeqH'</span>. <span class="id">econstructor</span>. 2:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.gss">FEnv.gss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.Seq">Seq</a></span> <span class="kwd">with</span> (<span class="id">ss</span>:=[[(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_stream">init_stream</a></span> <span class="id">bs'</span> <span class="comment">(*&nbsp;rs'&nbsp;*)</span>)]]); <span class="id">simpl</span>; <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">econstructor</span>; <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.add_whens_enum_sem">add_whens_enum_sem</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.sem_clock_refines">sem_clock_refines</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.var_history_refines">var_history_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_stream">init_stream</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val_const">const_val_const</a></span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val_enum">const_val_enum</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.sfby_fby">sfby_fby</a></span>; <span class="id">simpl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val_enum">const_val_enum</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.enum_aligned">enum_aligned</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">econstructor</span>. 2:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HeqH'</span>. <span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.gss">FEnv.gss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Forall3">Forall3</a></span> : <span class="id">datatypes</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="NFCORRECTNESS.fby_iteexp_sem">fby_iteexp_sem</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">H</span> <span class="id">e0</span> <span class="id">e</span> <span class="id">ty</span> <span class="id">nck</span> <span class="id">y0</span> <span class="id">y</span> <span class="id">z</span> <span class="id">e'</span> <span class="id">eqs'</span> <span class="id">st</span> <span class="id">st'</span> ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.normalized_lexp">normalized_lexp</a></span> <span class="id">e0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.clockof">clockof</a></span> <span class="id">e0</span> = [<span class="id">nck</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cl.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span>++<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="id">st</span>) <span class="id">e0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cl.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span>++<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="id">st</span>) <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_exp_ck">sem_exp_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> <span class="id">H</span> <span class="id">bs</span> <span class="id">e0</span> [<span class="id">y0</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_exp_ck">sem_exp_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> <span class="id">H</span> <span class="id">bs</span> <span class="id">e</span> [<span class="id">y</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.fby">fby</a></span> <span class="id">y0</span> <span class="id">y</span> <span class="id">z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">bs</span> <span class="id">H</span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.fby_iteexp">fby_iteexp</a></span> <span class="id">e0</span> <span class="id">e</span> (<span class="id">ty</span>, <span class="id">nck</span>) <span class="id">st</span> = (<span class="id">e'</span>, <span class="id">eqs'</span>, <span class="id">st'</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">exists</span> <span class="id">H'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) <span class="id">H</span> <span class="id">H'</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">bs</span> <span class="id">H'</span> <span class="id">st'</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_exp_ck">sem_exp_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span> <span class="id">H'</span> <span class="id">bs</span> <span class="id">e'</span> [<span class="id">z</span>] /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_equation_ck">sem_equation_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span> <span class="id">H'</span> <span class="id">bs</span>) <span class="id">eqs'</span>).<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof with</summary>
<div class="proofscript">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hnormed</span> <span class="id">Hck</span> <span class="id">Hwc0</span> <span class="id">Hwc</span> <span class="id">Hsem0</span> <span class="id">Hsem</span> <span class="id">Hfby</span> <span class="id">Histst</span> <span class="id">Hiteexp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st'</span>) <span class="kwd">as</span> <span class="id">Hfollows</span> <span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.fby_iteexp_st_follows">fby_iteexp_st_follows</a></span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.fby_iteexp">fby_iteexp</a></span> <span class="kwd">in</span> <span class="id">Hiteexp</span>; <span class="id">repeat</span> <span class="id">inv_bind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hsck</span>:=<span class="id">Hsem0</span>). <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sc_exp">sc_exp</a></span> <span class="kwd">with</span> (<span class="id">Γ</span>:=<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span>++<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="id">st</span>) <span class="kwd">in</span> <span class="id">Hsck</span>... <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hsck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:(<span class="id">destruct</span> <span class="id">Histst</span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hck</span> <span class="kwd">in</span> <span class="id">Hsck</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_singl">Forall2_singl</a></span> <span class="kwd">in</span> <span class="id">Hsck</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_var_for_clock_sem">init_var_for_clock_sem</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">H'</span> [<span class="id">Href1</span> [<span class="id">Histst1</span> [<span class="id">Hsem1</span> <span class="id">Hsem1'</span>]]]]...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.abstract_clock">abstract_clock</a></span> <span class="id">y0</span>) <span class="kwd">as</span> <span class="id">bs'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="kwd">match</span> <span class="id">ty</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op.Tprimitive">Tprimitive</a></span> <span class="id">cty</span> =&gt; <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op.Vscalar">Vscalar</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op.sem_cconst">Op.sem_cconst</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op.init_ctype">Op.init_ctype</a></span> <span class="id">cty</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op.Tenum">Tenum</a></span> _ <span class="id">n</span> =&gt; <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op.Venum">Venum</a></span> 0 <span class="kwd">end</span>) <span class="kwd">as</span> <span class="id">v0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.sfby">sfby</a></span> <span class="id">v0</span> <span class="id">y</span>) <span class="kwd">as</span> <span class="id">y'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.add">FEnv.add</a></span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x2</span>) <span class="id">y'</span> <span class="id">H'</span>) <span class="kwd">as</span> <span class="id">H''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) <span class="id">H'</span> <span class="id">H''</span>) <span class="kwd">by</span> (<span class="id">subst</span>; <span class="id">destruct</span> <span class="id">Histst1</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.fresh_ident_refines">fresh_ident_refines</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">bs</span> <span class="id">H''</span> <span class="id">st'</span>) <span class="kwd">as</span> <span class="id">Histst2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.fresh_ident_hist_st">fresh_ident_hist_st</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.ac_sfby">ac_sfby</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.ac_fby2">ac_fby2</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.ac_fby1">ac_fby1</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.sem_clock_refines">sem_clock_refines</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.var_history_refines">var_history_refines</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">H''</span>. <span class="id">repeat</span> (<span class="id">split</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">fresh</span> <span class="id">norm</span>); <span class="id">try</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">etransitivity</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.ScaseTotal">ScaseTotal</a></span> <span class="kwd">with</span> (<span class="id">s</span>:=(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_stream">init_stream</a></span> <span class="id">bs'</span>)) (<span class="id">vs</span>:=[[(1, <span class="id">y0</span>);(0, <span class="id">y'</span>)]]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econstructor</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.sem_var_refines">sem_var_refines</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econstructor</span>. 2:<span class="id">econstructor</span>. 3:<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">constructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4,5:<span class="id">simpl</span>; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>; <span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_exp_refines">sem_exp_refines</a></span>; [|<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_ref_sem_exp">sem_ref_sem_exp</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">subst</span>. <span class="id">do</span> 2 <span class="id">econstructor</span>; <span class="id">eauto</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.gss">FEnv.gss</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">simpl</span>. <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">datatypes</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.fby_init_stream_case">fby_init_stream_case</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.ac_aligned">ac_aligned</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.Seq">Seq</a></span> <span class="kwd">with</span> (<span class="id">ss</span>:=[[<span class="id">y'</span>]]); <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.Sfby">Sfby</a></span> <span class="kwd">with</span> (<span class="id">s0ss</span>:=[[<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val">const_val</a></span> <span class="id">bs'</span> <span class="id">v0</span>]]) (<span class="id">sss</span>:=[[<span class="id">y</span>]]); <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">destruct</span> <span class="id">ty</span> <span class="kwd">as</span> [|]; <span class="id">simpl</span>; <span class="id">rewrite</span> <span class="id">Heqv0</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_exp_ck_morph">sem_exp_ck_morph</a></span>; <span class="id">eauto</span>. 1,2:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val_const">const_val_const</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.add_whens_const_sem">add_whens_const_sem</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.sem_clock_refines">sem_clock_refines</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.var_history_refines">var_history_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_exp_ck_morph">sem_exp_ck_morph</a></span>; <span class="id">eauto</span>. 1,2:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.const_val_enum">const_val_enum</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.add_whens_enum_sem">add_whens_enum_sem</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.sem_clock_refines">sem_clock_refines</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.var_history_refines">var_history_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_ref_sem_exp">sem_ref_sem_exp</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_exp_refines">sem_exp_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;*&nbsp;eapply&nbsp;bools_ofs_empty.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id">Heqy'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.sfby_fby">sfby_fby</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.fby_aligned">fby_aligned</a></span> <span class="kwd">in</span> <span class="id">Hfby</span> <span class="kwd">as</span> [_ [? _]]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">rewrite</span> <span class="id">Heqbs'</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.ac_aligned">ac_aligned</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HeqH''</span>. <span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.gss">FEnv.gss</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_equation_refines">sem_equation_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="NFCORRECTNESS.arrow_iteexp_sem">arrow_iteexp_sem</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">H</span> <span class="id">e0</span> <span class="id">e</span> <span class="id">ty</span> <span class="id">nck</span> <span class="id">y0</span> <span class="id">y</span> <span class="id">z</span> <span class="id">e'</span> <span class="id">eqs'</span> <span class="id">st</span> <span class="id">st'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.normalized_lexp">normalized_lexp</a></span> <span class="id">e0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.clockof">clockof</a></span> <span class="id">e0</span> = [<span class="id">nck</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cl.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span>++<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="id">st</span>) <span class="id">e0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cl.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span>++<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="id">st</span>) <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_exp_ck">sem_exp_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> <span class="id">H</span> <span class="id">bs</span> <span class="id">e0</span> [<span class="id">y0</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_exp_ck">sem_exp_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> <span class="id">H</span> <span class="id">bs</span> <span class="id">e</span> [<span class="id">y</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.arrow">arrow</a></span> <span class="id">y0</span> <span class="id">y</span> <span class="id">z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">bs</span> <span class="id">H</span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.arrow_iteexp">arrow_iteexp</a></span> <span class="id">e0</span> <span class="id">e</span> (<span class="id">ty</span>, <span class="id">nck</span>) <span class="id">st</span> = (<span class="id">e'</span>, <span class="id">eqs'</span>, <span class="id">st'</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">exists</span> <span class="id">H'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) <span class="id">H</span> <span class="id">H'</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">bs</span> <span class="id">H'</span> <span class="id">st'</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_exp_ck">sem_exp_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span> <span class="id">H'</span> <span class="id">bs</span> <span class="id">e'</span> [<span class="id">z</span>] /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_equation_ck">sem_equation_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span> <span class="id">H'</span> <span class="id">bs</span>) <span class="id">eqs'</span>).<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof with</summary>
<div class="proofscript">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hnormed</span> <span class="id">Hck</span> <span class="id">Hwc0</span> <span class="id">Hwc1</span> <span class="id">Hsem0</span> <span class="id">Hsem</span> <span class="id">Harrow</span> <span class="id">Histst</span> <span class="id">Hiteexp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st'</span>) <span class="kwd">as</span> <span class="id">Hfollows</span> <span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.arrow_iteexp_st_follows">arrow_iteexp_st_follows</a></span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.arrow_iteexp">arrow_iteexp</a></span> <span class="kwd">in</span> <span class="id">Hiteexp</span>. <span class="id">repeat</span> <span class="id">inv_bind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hsck</span>:=<span class="id">Hsem0</span>). <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sc_exp">sc_exp</a></span> <span class="kwd">with</span> (<span class="id">Γ</span>:=<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span>++<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="id">st</span>) <span class="kwd">in</span> <span class="id">Hsck</span>... <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hsck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:(<span class="id">destruct</span> <span class="id">Histst</span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hck</span> <span class="kwd">in</span> <span class="id">Hsck</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_singl">Forall2_singl</a></span> <span class="kwd">in</span> <span class="id">Hsck</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_var_for_clock_sem">init_var_for_clock_sem</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">H'</span> [<span class="id">Href1</span> [<span class="id">Histst1</span> [<span class="id">Hsem1</span> <span class="id">Hsem1'</span>]]]]...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.abstract_clock">abstract_clock</a></span> <span class="id">y0</span>) <span class="kwd">as</span> <span class="id">bs'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">H'</span>. <span class="id">repeat</span> (<span class="id">split</span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.ScaseTotal">ScaseTotal</a></span> <span class="kwd">with</span> (<span class="id">s</span>:=(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.init_stream">init_stream</a></span> <span class="id">bs'</span>)) (<span class="id">vs</span>:=[[(1, <span class="id">y0</span>);(0, <span class="id">y</span>)]]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>. 2:<span class="id">econstructor</span>. 3:<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">constructor</span>; <span class="id">eauto</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_exp_refines">sem_exp_refines</a></span>; [|<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_ref_sem_exp">sem_ref_sem_exp</a></span>]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2,3:<span class="id">simpl</span>; <span class="id">constructor</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl</span>. <span class="id">repeat</span> <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.arrow_init_stream_case">arrow_init_stream_case</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>. <span class="id">left</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.ac_aligned">ac_aligned</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="NFCORRECTNESS.normfby_equation_sem">normfby_equation_sem</a></span> <span class="id">lasts</span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">H</span> <span class="id">to_cut</span> <span class="id">equ</span> <span class="id">eqs'</span> <span class="id">st</span> <span class="id">st'</span> ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.unnested_equation">unnested_equation</a></span> <span class="id">lasts</span> <span class="id">equ</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cl.wc_equation">wc_equation</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span>++<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="id">st</span>) <span class="id">equ</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_equation_ck">sem_equation_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> <span class="id">H</span> <span class="id">bs</span> <span class="id">equ</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">bs</span> <span class="id">H</span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.normfby_equation">normfby_equation</a></span> <span class="id">to_cut</span> <span class="id">equ</span> <span class="id">st</span> = (<span class="id">eqs'</span>, <span class="id">st'</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">exists</span> <span class="id">H'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) <span class="id">H</span> <span class="id">H'</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">bs</span> <span class="id">H'</span> <span class="id">st'</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_equation_ck">sem_equation_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span> <span class="id">H'</span> <span class="id">bs</span>) <span class="id">eqs'</span>).<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof with</summary>
<div class="proofscript">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hun</span> <span class="id">Hwc</span> <span class="id">Hsem</span> <span class="id">Histst</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv_normfby_equation</span> <span class="id">Hfby</span> <span class="id">to_cut</span> <span class="id">equ</span>; <span class="id">try</span> <span class="id">destruct</span> <span class="id">x2</span> <span class="kwd">as</span> (<span class="id">ty</span>&amp;<span class="id">ck</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;constant&nbsp;fby&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="Velus.Common.Common.html#PS.mem">PS.mem</a></span>; <span class="id">repeat</span> <span class="id">inv_bind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">inv</span> <span class="id">H6</span>; <span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> <span class="id">H7</span>. <span class="id">inv</span> <span class="id">H7</span>; <span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hsem'</span>:=<span class="id">H3</span>). <span class="id">inversion_clear</span> <span class="id">H3</span> <span class="kwd">as</span> [| | | | | | |???????? <span class="id">Hsem0</span> <span class="id">Hsem1</span> <span class="id">Hsem</span>| | | | | |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem0</span>; <span class="id">inv</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">Hsem1</span>; <span class="id">inv</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>. <span class="id">inv</span> <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">rename</span> <span class="id">H6</span> <span class="id">into</span> <span class="id">Hwc</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>. <span class="id">assert</span> (<span class="id">Hwc'</span>:=<span class="id">Hwc</span>). <span class="id">inv</span> <span class="id">Hwc'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">simpl_Forall</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.add">FEnv.add</a></span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x2</span>) <span class="id">y0</span> <span class="id">H</span>) <span class="kwd">as</span> <span class="id">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) <span class="id">H</span> <span class="id">H'</span>) <span class="kwd">as</span> <span class="id">Href</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span>. <span class="id">destruct</span> <span class="id">Histst</span> <span class="kwd">as</span> [<span class="id">Hdom</span> _].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.fresh_ident_refines">fresh_ident_refines</a></span> <span class="kwd">in</span> <span class="id">H0</span>... }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">bs</span> <span class="id">H'</span> <span class="id">st'</span>) <span class="kwd">as</span> <span class="id">Histst1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.fresh_ident_hist_st">fresh_ident_hist_st</a></span> <span class="kwd">in</span> <span class="id">H0</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hun</span>. 2:<span class="id">inv</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sc_exp">sc_exp</a></span> <span class="kwd">in</span> <span class="id">H3</span>... 2:<span class="id">destruct</span> <span class="id">Histst</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="id">rewrite</span> &lt;-<span class="id">H7</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.ac_fby1">ac_fby1</a></span> <span class="kwd">in</span> <span class="id">H8</span>. <span class="id">now</span> <span class="id">rewrite</span> &lt;-<span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">H'</span>. <span class="id">repeat</span> (<span class="id">split</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">norm</span> <span class="id">fresh</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.Seq">Seq</a></span> <span class="kwd">with</span> (<span class="id">ss</span>:=[[<span class="id">y0</span>]]); <span class="id">simpl</span>; <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.sem_var_refines">sem_var_refines</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HeqH'</span>. <span class="id">econstructor</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.gss">FEnv.gss</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.Seq">Seq</a></span> <span class="kwd">with</span> (<span class="id">ss</span>:=[[<span class="id">y0</span>]]); <span class="id">simpl</span>; <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_ref_sem_exp">sem_ref_sem_exp</a></span>... <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_exp_refines">sem_exp_refines</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">rewrite</span> <span class="id">HeqH'</span>. <span class="id">econstructor</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.gss">FEnv.gss</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> <span class="id">H</span>. <span class="id">repeat</span> (<span class="id">split</span>; <span class="id">eauto</span>). <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_ref_sem_equation">sem_ref_sem_equation</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;fby&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">rename</span> <span class="id">H3</span> <span class="id">into</span> <span class="id">Hwc</span>. <span class="id">clear</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>. <span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">simpl_Forall</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">simpl_Forall</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">H11</span> <span class="kwd">as</span> [| | | | | | |???????? <span class="id">Hsem0</span> <span class="id">Hsem1</span> <span class="id">Hsem</span>| | | | | |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.fby_iteexp_sem">fby_iteexp_sem</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">H'</span> [<span class="id">Href1</span> [<span class="id">Hhistst1</span> [<span class="id">Hsem'</span> <span class="id">Hsem''</span>]]]]...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">inv</span> <span class="id">Hun</span>; <span class="id">auto</span>. <span class="id">inv</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H1</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">H'</span>. <span class="id">repeat</span> (<span class="id">split</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.Seq">Seq</a></span> <span class="kwd">with</span> (<span class="id">ss</span>:=[[<span class="id">y</span>]]); <span class="id">simpl</span>; <span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.sem_var_refines">sem_var_refines</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;arrow&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">rename</span> <span class="id">H3</span> <span class="id">into</span> <span class="id">Hwc</span>. <span class="id">clear</span> <span class="id">H4</span>. <span class="id">simpl_Forall</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="id">simpl_Forall</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">simpl_Forall</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">H11</span> <span class="kwd">as</span> [| | | | | | | |???????? <span class="id">Hsem0</span> <span class="id">Hsem1</span> <span class="id">Hsem</span>| | | | |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.arrow_iteexp_sem">arrow_iteexp_sem</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">H'</span> [<span class="id">Href1</span> [<span class="id">Hhistst1</span> [<span class="id">Hsem'</span> <span class="id">Hsem''</span>]]]]...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">inv</span> <span class="id">Hun</span>; <span class="id">auto</span>. <span class="id">inv</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H1</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">H'</span>. <span class="id">repeat</span> (<span class="id">split</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.Seq">Seq</a></span> <span class="kwd">with</span> (<span class="id">ss</span>:=[[<span class="id">y</span>]]); <span class="id">simpl</span>; <span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.sem_var_refines">sem_var_refines</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;other&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">H</span>. <span class="id">repeat</span> (<span class="id">split</span>; <span class="id">eauto</span>). <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_ref_sem_equation">sem_ref_sem_equation</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="NFCORRECTNESS.hist_st_mask">hist_st_mask</a></span> {<span class="id">pref</span>} : <span class="kwd">forall</span> <span class="id">vars</span> <span class="id">bs</span> <span class="id">H</span> (<span class="id">st</span>: <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.fresh_st">fresh_st</a></span> <span class="id">pref</span> _) <span class="id">r</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id">vars</span> <span class="id">bs</span> <span class="id">H</span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id">vars</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">bs</span>) (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) <span class="id">st</span>.<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * (?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.dom_map">dom_map</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sc_vars_mask">LCS.sc_vars_mask</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="NFCORRECTNESS.normfby_block_sem">normfby_block_sem</a></span> <span class="id">lasts</span> : <span class="kwd">forall</span> <span class="id">to_cut</span> <span class="id">d</span> <span class="id">blocks'</span> <span class="id">bs</span> <span class="id">H</span> <span class="id">st</span> <span class="id">st'</span> ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.normlast_block">normlast_block</a></span> <span class="id">lasts</span> <span class="id">d</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cl.wc_block">wc_block</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span>++<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="id">st</span>) <span class="id">d</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_block_ck">sem_block_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> <span class="id">H</span> <span class="id">bs</span> <span class="id">d</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">bs</span> <span class="id">H</span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.normfby_block">normfby_block</a></span> <span class="id">to_cut</span> <span class="id">d</span> <span class="id">st</span> = (<span class="id">blocks'</span>, <span class="id">st'</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">exists</span> <span class="id">H'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) <span class="id">H</span> <span class="id">H'</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">bs</span> <span class="id">H'</span> <span class="id">st'</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_block_ck">sem_block_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span> <span class="id">H'</span> <span class="id">bs</span>) <span class="id">blocks'</span>).<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">d</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">Hun</span> <span class="id">Hwc</span> <span class="id">Hsem</span> <span class="id">Hist</span> <span class="id">Hnorm</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hun</span>; <span class="id">inv</span> <span class="id">Hwc</span>; <span class="id">inv</span> <span class="id">Hsem</span>; <span class="id">repeat</span> <span class="id">inv_bind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;eq&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_equation_sem">normfby_equation_sem</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">H'</span>&amp;?&amp;?&amp;?); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">H'</span>. <span class="id">repeat</span> (<span class="id">split</span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;last&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">H</span>. <span class="id">repeat</span> (<span class="id">split</span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> (<span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_ref_sem_exp">sem_ref_sem_exp</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hnorm</span>; <span class="id">cases</span>; <span class="id">repeat</span> <span class="id">inv_bind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">k</span>, <span class="kwd">exists</span> <span class="id">H'k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.mask_hist">CStr.mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H0</span>) (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.mask_hist">CStr.mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H'k</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">bs</span>) (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H'k</span>) <span class="id">st'</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_block_ck">sem_block_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H'k</span>) (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">bs</span>)) <span class="id">x0</span>) <span class="kwd">as</span> <span class="id">Hblocks'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span> <span class="id">k</span>. <span class="id">specialize</span> (<span class="id">H12</span> <span class="id">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H12</span>. <span class="id">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H12</span> <span class="kwd">as</span> (<span class="id">H'k</span>&amp;?&amp;(?&amp;<span class="id">Hsc</span>)&amp;?); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st_mask">hist_st_mask</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.slower_hist">slower_hist</a></span> <span class="id">H'k</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">bs</span>)) <span class="kwd">as</span> <span class="id">Hslow</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sc_vars_slower_hist">sc_vars_slower_hist</a></span> <span class="kwd">in</span> <span class="id">Hsc</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.dom_dom_ub">dom_dom_ub</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.slower_mask_hist">slower_mask_hist</a></span> <span class="kwd">in</span> <span class="id">Hslow</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">H'k</span>. <span class="id">split</span>; [|<span class="id">split</span>; [<span class="id">split</span>|]]; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;-<span class="id">Hslow</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.dom_map">dom_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.mask_hist">mask_hist</a></span>. <span class="id">simpl</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sc_vars_morph">sc_vars_morph</a></span>. 1,3,4:<span class="id">eauto</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Hslow</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl_Forall</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_block_ck_morph">sem_block_ck_morph</a></span>; <span class="id">eauto</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.consolidate_mask_hist">consolidate_mask_hist</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">P</span> := <span class="kwd">fun</span> <span class="id">k</span> <span class="id">H'k</span> =&gt; <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.mask_hist">CStr.mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H0</span>) <span class="id">H'k</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">bs</span>) <span class="id">H'k</span> <span class="id">st'</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_block_ck">sem_block_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span> <span class="id">H'k</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">bs</span>)) <span class="id">x0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span> <span class="id">Hblocks'</span> <span class="kwd">as</span> (<span class="id">H'</span>&amp;<span class="id">HH'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">intros</span> ????? <span class="id">Heq</span> (?&amp;(?&amp;<span class="id">Hsc1</span>)&amp;?); <span class="id">subst</span>. <span class="id">split</span>; [|<span class="id">split</span>; [<span class="id">split</span>|]]; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">split</span>; <span class="id">intros</span> ?. 1-3:<span class="id">rewrite</span> &lt;-<span class="id">Heq</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">eapply</span> <span class="id">H9</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sc_vars_morph">sc_vars_morph</a></span>; <span class="id">eauto</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl_Forall</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_block_ck_morph">sem_block_ck_morph</a></span>; <span class="id">eauto</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">intros</span> ?? (_&amp;(<span class="id">Hdom1</span>&amp;_)&amp;_); <span class="id">simpl</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.dom_fenv_dom">dom_fenv_dom</a></span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) <span class="id">H0</span> <span class="id">H'</span>) <span class="kwd">as</span> <span class="id">Href</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr.refines_unmask">refines_unmask</a></span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">HH'</span> <span class="id">k</span>) <span class="kwd">as</span> (?&amp;_); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [|<span class="id">split</span>; [<span class="id">split</span>|]]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">HH'</span> 0) <span class="kwd">as</span> (_&amp;(<span class="id">Hdom</span>&amp;_)&amp;_); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.dom_map">dom_map</a></span> <span class="kwd">in</span> <span class="id">Hdom</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sc_vars_unmask">sc_vars_unmask</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">k</span>. <span class="id">specialize</span> (<span class="id">HH'</span> <span class="id">k</span>) <span class="kwd">as</span> (_&amp;(_&amp;?)&amp;_); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>. <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_ref_sem_exp">sem_ref_sem_exp</a></span>; <span class="id">eauto</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_exp_refines">sem_exp_refines</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">intros</span> ?. <span class="id">specialize</span> (<span class="id">HH'</span> <span class="id">k</span>) <span class="kwd">as</span> (_&amp;_&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>. <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="NFCORRECTNESS.normfby_blocks_sem">normfby_blocks_sem</a></span> <span class="id">lasts</span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">to_cut</span> <span class="id">blocks</span> <span class="id">blocks'</span> <span class="id">H</span> <span class="id">st</span> <span class="id">st'</span> ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.normlast_block">normlast_block</a></span> <span class="id">lasts</span>) <span class="id">blocks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cl.wc_block">wc_block</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span>++<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span> <span class="id">st</span>)) <span class="id">blocks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_block_ck">sem_block_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> <span class="id">H</span> <span class="id">bs</span>) <span class="id">blocks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">bs</span> <span class="id">H</span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.normfby_blocks">normfby_blocks</a></span> <span class="id">to_cut</span> <span class="id">blocks</span> <span class="id">st</span> = (<span class="id">blocks'</span>, <span class="id">st'</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">exists</span> <span class="id">H'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) <span class="id">H</span> <span class="id">H'</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem.vars">vars</a></span> <span class="id">bs</span> <span class="id">H'</span> <span class="id">st'</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_block_ck">sem_block_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span> <span class="id">H'</span> <span class="id">bs</span>) <span class="id">blocks'</span>).<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof with</summary>
<div class="proofscript">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blocks</span>; <span class="id">intros</span> * <span class="id">Hunt</span> <span class="id">Hwc</span> <span class="id">Hsem</span> <span class="id">Hhistst</span> <span class="id">Hfby</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.normfby_blocks">normfby_blocks</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">repeat</span> <span class="id">inv_bind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="kwd">exists</span> <span class="id">H</span>; <span class="id">simpl</span>; <span class="id">repeat</span> (<span class="id">split</span>; <span class="id">auto</span>). <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.normfby_blocks">normfby_blocks</a></span> <span class="id">to_cut</span> <span class="id">blocks</span> <span class="id">x1</span> = (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">x2</span>, <span class="id">st'</span>)) <span class="kwd">as</span> <span class="id">Hnorm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.normfby_blocks">normfby_blocks</a></span>; <span class="id">repeat</span> <span class="id">inv_bind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">eexists</span>; <span class="id">eauto</span>. <span class="id">repeat</span> <span class="id">inv_bind</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hunt</span>. <span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">inv</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">x1</span>) <span class="kwd">as</span> <span class="id">Hfollows</span> <span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.normfby_block_st_follows">normfby_block_st_follows</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_block_sem">normfby_block_sem</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">H'</span> [<span class="id">Href1</span> [<span class="id">Hhistst1</span> <span class="id">Hsem1</span>]]]. 2-5:<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_block_ck">sem_block_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> <span class="id">H'</span> <span class="id">bs</span>) <span class="id">blocks</span>) <span class="kwd">as</span> <span class="id">Hsem'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">simpl_Forall</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_block_refines">sem_block_refines</a></span>... } <span class="id">clear</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHblocks</span> <span class="kwd">in</span> <span class="id">Hnorm</span> <span class="kwd">as</span> (<span class="id">H''</span>&amp;<span class="id">Href</span>&amp;<span class="id">Hdom</span>&amp;<span class="id">Hsem2</span>). 2-5:<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">simpl_Forall</span>; <span class="id">repeat</span> <span class="id">solve_incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> <span class="id">H''</span>. <span class="id">split</span>;[|<span class="id">split</span>]...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">etransitivity</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">simpl</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="id">split</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_block_refines">sem_block_refines</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.normfby_block_sem">normfby_block_sem</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="NFCORRECTNESS.init_st_hist_st">init_st_hist_st</a></span> : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">H</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.dom">dom</a></span> <span class="id">H</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sc_vars">sc_vars</a></span> <span class="id">xs</span> <span class="id">H</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.hist_st">hist_st</a></span> <span class="id">xs</span> <span class="id">b</span> <span class="id">H</span> (@<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.init_st">init_st</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids.fby_id">Ids.fby_id</a></span> _).<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">b</span> <span class="id">H</span> <span class="id">n</span> <span class="id">Hdom</span> (?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [|<span class="id">split</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1-3:<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.init_st_anns">init_st_anns</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="NFCORRECTNESS.normfby_node_sem">normfby_node_sem</a></span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span> <span class="id">ins</span> <span class="id">outs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cl.wc_global">wc_global</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.Global">Global</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.types">types</a></span>) <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.externs">externs</a></span>) (<span class="id">n</span>::<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.nodes">nodes</a></span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cl.wc_global">wc_global</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ord.Ordered_nodes">Ordered_nodes</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.Global">Global</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.types">types</a></span>) <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.externs">externs</a></span>) (<span class="id">n</span>::<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.nodes">nodes</a></span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ord.Ordered_nodes">Ordered_nodes</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.Global">Global</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.types">types</a></span>) <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.externs">externs</a></span>) ((<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.normfby_node">normfby_node</a></span> <span class="id">n</span>)::<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.nodes">nodes</a></span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_node_ck">sem_node_ck</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.Global">Global</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.types">types</a></span>) <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.externs">externs</a></span>) (<span class="id">n</span>::<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.nodes">nodes</a></span>))) <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_node_ck">sem_node_ck</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.Global">Global</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.types">types</a></span>) <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.externs">externs</a></span>) ((<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.normfby_node">normfby_node</a></span> <span class="id">n</span>)::<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.nodes">nodes</a></span>))) <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span>.<br/>
<details>
&nbsp;&nbsp;&nbsp;&nbsp;<summary class="toggleproof">Proof with</summary>
<div class="proofscript">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">HwcG</span> <span class="id">HwcG'</span> <span class="id">Hord1</span> <span class="id">Hord2</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ord.Ordered_nodes">Ordered_nodes</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.Global">Global</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.types">types</a></span>) <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.externs">externs</a></span>) (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.normfby_node">normfby_node</a></span> <span class="id">n</span> :: <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span>.(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.nodes">nodes</a></span>)))) <span class="kwd">as</span> <span class="id">Hord'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">Hord2</span>. <span class="id">destruct</span> <span class="id">H1</span>. <span class="id">constructor</span>; [<span class="id">split</span>|]... }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>; <span class="id">assert</span> (<span class="id">Hfind</span>:=<span class="id">H0</span>). <span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#ident_eq_dec">ident_eq_dec</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.n_name">n_name</a></span> <span class="id">n</span>) <span class="id">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.find_node_now">find_node_now</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">HwcG</span> <span class="kwd">as</span> [|?? (?&amp;?)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;semantics&nbsp;of&nbsp;equations&nbsp;can&nbsp;be&nbsp;given&nbsp;according&nbsp;to&nbsp;G&nbsp;only&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (~<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ord.Is_node_in_block">Is_node_in_block</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.n_name">n_name</a></span> <span class="id">n0</span>) (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.n_block">n_block</a></span> <span class="id">n0</span>)) <span class="kwd">as</span> <span class="id">Blk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">Hord1</span>. <span class="id">destruct</span> <span class="id">H9</span> <span class="kwd">as</span> (<span class="id">Hisin</span>&amp;_). <span class="id">intro</span> <span class="id">contra</span>. <span class="id">eapply</span> <span class="id">Hisin</span> <span class="kwd">in</span> <span class="id">contra</span> <span class="kwd">as</span> [? _]; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_block_ck_cons1">sem_block_ck_cons1</a></span> <span class="kwd">in</span> <span class="id">Blk</span>; <span class="id">eauto</span>. <span class="id">clear</span> <span class="id">H3</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.normfby_node">normfby_node</a></span> <span class="id">n0</span>) <span class="kwd">as</span> <span class="id">n'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.normfby_node">normfby_node</a></span> <span class="kwd">in</span> <span class="id">Heqn'</span>; <span class="id">inv</span> <span class="id">Heqn'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.n_nodup">n_nodup</a></span> <span class="id">n0</span>) <span class="kwd">as</span> (<span class="id">Hnd1</span>&amp;<span class="id">Hnd2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.n_good">n_good</a></span> <span class="id">n0</span>) <span class="kwd">as</span> (<span class="id">Hgood1</span>&amp;<span class="id">Hgood2</span>&amp;_).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.n_syn">n_syn</a></span> <span class="id">n0</span>) <span class="kwd">as</span> <span class="id">Hsyn</span>. <span class="id">inversion</span> <span class="id">Hsyn</span> <span class="kwd">as</span> [??? _ <span class="id">Hsyn2</span> _].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">H7</span> <span class="kwd">in</span> *. <span class="id">symmetry</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="id">inv</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">Blk</span>. <span class="id">inv_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">H0</span> <span class="kwd">as</span> [? _ _ <span class="id">Hwc</span>]. <span class="id">rewrite</span> &lt;-<span class="id">H7</span> <span class="kwd">in</span> <span class="id">Hwc</span>. <span class="id">inv</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_scope'</span>. <span class="id">subst</span> <span class="id">Γ'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_block_ck">sem_block_ck</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span> (<span class="id">H</span> + <span class="id">Hi'</span>) <span class="id">bs</span>) <span class="id">blks</span>) <span class="kwd">as</span> <span class="id">Hsem</span> <span class="kwd">by</span> (<span class="id">destruct</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span>; <span class="id">auto</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_blocks_sem">normfby_blocks_sem</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">vars</span>:=<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.n_in">n_in</a></span> <span class="id">n0</span>) ++ <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.n_out">n_out</a></span> <span class="id">n0</span>) ++ <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">locs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">to_cut</span> := (<span class="id"><a href="Velus.Common.CommonPS.html#ps_from_list">ps_from_list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.n_out">n_out</a></span> <span class="id">n0</span>)))) (<span class="id">st</span>:=<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.init_st">init_st</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span> <span class="id">Hsem</span> <span class="kwd">as</span> (<span class="id">Hf</span>&amp;<span class="id">Href</span>&amp;(<span class="id">Hdom</span>&amp;<span class="id">Hsc</span>)&amp;<span class="id">Heqs''</span>)... 5:<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#surjective_pairing">surjective_pairing</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">inv</span> <span class="id">Hgood2</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.GoodLocalsScope">GoodLocalsScope</a></span> _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="id">split</span>; <span class="id">simpl_Forall</span>; <span class="id">simpl_In</span>; <span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hgood1</span>; <span class="id">eauto</span>. <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.map_fst_senv_of_ins">map_fst_senv_of_ins</a></span>, &lt;-<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>, &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. <span class="id">solve_In</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">destruct</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.init_st_anns">init_st_anns</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.clocked_node">clocked_node</a></span> _ _ _) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> (<span class="id">Hdom</span>&amp;<span class="id">Hsc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.init_st_anns">init_st_anns</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.local_hist_dom">local_hist_dom</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv">st_senv</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.init_st_anns">init_st_anns</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.local_hist_sc_vars">local_hist_sc_vars</a></span> <span class="kwd">with</span> (<span class="id">H</span>:=<span class="id">H</span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem.dom_dom_ub">dom_dom_ub</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hnd2</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.NoDupScope">NoDupScope</a></span> _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ?? <span class="id">contra</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.IsVar_fst">IsVar_fst</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.map_fst_senv_of_ins">map_fst_senv_of_ins</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span> <span class="kwd">in</span> <span class="id">contra</span>. <span class="id">eapply</span> <span class="id">H15</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Href'</span>:=<span class="id">Href</span>). <span class="id">eapply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_refines_inv">FEnv.union_refines_inv</a></span> <span class="kwd">in</span> <span class="id">Href'</span> <span class="kwd">as</span> (<span class="id">Hi''</span>&amp;<span class="id">Heq</span>&amp;<span class="id">Href'</span>&amp;<span class="id">Hdom'</span>); <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonStreams.html#EqStrel_Reflexive">EqStrel_Reflexive</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">intros</span> * <span class="id">Hin</span> <span class="id">Hin2</span>. <span class="id">destruct</span> <span class="id">x0</span>; <span class="id">apply</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="id">apply</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">Hin2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hnd2</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.NoDupScope">NoDupScope</a></span> _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">locs</span> -&gt; ~ _) <span class="id">and</span> <span class="id">eapply</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.IsVar_senv_of_decls">IsVar_senv_of_decls</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.IsVar_fst">IsVar_fst</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.map_fst_senv_of_ins">map_fst_senv_of_ins</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hnd2</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.NoDupScope">NoDupScope</a></span> _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">locs</span> -&gt; ~ _) <span class="id">and</span> <span class="id">eapply</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.IsLast_senv_of_decls">IsLast_senv_of_decls</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">Hin</span>. <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.map_fst_senv_of_ins">map_fst_senv_of_ins</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>, &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. <span class="id">solve_In</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.Snode">Snode</a></span> <span class="kwd">with</span> (<span class="id">H</span>:=<span class="id">H</span>); <span class="id">simpl</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.find_node_now">find_node_now</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_block_ck_cons2">sem_block_ck_cons2</a></span>; <span class="id">simpl</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ord.find_node_not_Is_node_in">find_node_not_Is_node_in</a></span> <span class="kwd">in</span> <span class="id">Hord2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.find_node_now">find_node_now</a></span>; <span class="id">eauto</span>. <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3:{ <span class="id">destruct</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_block_ck_morph">sem_block_ck_morph</a></span>. 4:<span class="id">eauto</span>. 2,3:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">symmetry</span>. <span class="id">eapply</span> <span class="id">Heq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*{ <span class="id">destruct</span> <span class="id">Hdom</span> <span class="kwd">as</span> (<span class="id">D1</span>&amp;<span class="id">DL1</span>). <span class="id">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> ((<span class="id">D2</span>&amp;<span class="id">DL2</span>)&amp;_).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intros</span> *; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id">Hdom'</span>, <span class="id">D1</span>, <span class="id">D2</span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.senv_of_decls_app">senv_of_decls_app</a></span>. <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv_senv_of_decls">st_senv_senv_of_decls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.IsVar_app">IsVar_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">intros</span> ([[<span class="id">In</span>|[<span class="id">In</span>|<span class="id">In</span>]]|<span class="id">In</span>]&amp;<span class="id">Hnin</span>)|<span class="id">intros</span> [<span class="id">In</span>|<span class="id">In</span>]]; <span class="id">try</span> <span class="id">congruence</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>. <span class="id">eapply</span> <span class="id">Hnin</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>. <span class="id">eapply</span> <span class="id">Hnin</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">split</span>; <span class="id">auto</span>. <span class="id">intros</span> <span class="id">contra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hnd2</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.NoDupScope">NoDupScope</a></span> _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H15</span>; <span class="id">eauto</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.IsVar_senv_of_decls">IsVar_senv_of_decls</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.IsVar_fst">IsVar_fst</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.map_fst_senv_of_ins">map_fst_senv_of_ins</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>, &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">contra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">contra</span>. <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.IsVar_fst">IsVar_fst</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.map_fst_senv_of_ins">map_fst_senv_of_ins</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>, &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">contra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">In</span>. <span class="id">simpl_In</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.Facts.st_valid_AtomOrGensym_nIn">Facts.st_valid_AtomOrGensym_nIn</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.fby_not_in_last_prefs">fby_not_in_last_prefs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.st_ids">st_ids</a></span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id">Hdom'</span>, <span class="id">DL1</span>, <span class="id">DL2</span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.senv_of_decls_app">senv_of_decls_app</a></span>. <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv_senv_of_decls">st_senv_senv_of_decls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.IsLast_app">IsLast_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">intros</span> ([[<span class="id">In</span>|[<span class="id">In</span>|<span class="id">In</span>]]|<span class="id">In</span>]&amp;<span class="id">Hnin</span>)|<span class="id">intros</span> [<span class="id">In</span>|<span class="id">In</span>]]; <span class="id">try</span> <span class="id">congruence</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>. <span class="id">eapply</span> <span class="id">Hnin</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>. <span class="id">eapply</span> <span class="id">Hnin</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">split</span>; <span class="id">auto</span>. <span class="id">intros</span> <span class="id">contra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hnd2</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.NoDupScope">NoDupScope</a></span> _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H15</span>; <span class="id">eauto</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.IsLast_senv_of_decls">IsLast_senv_of_decls</a></span>; <span class="id">eauto</span>. <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.IsLast_app">IsLast_app</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">contra</span>. <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.map_fst_senv_of_ins">map_fst_senv_of_ins</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>, &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">contra</span>. <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.IsLast_app">IsLast_app</a></span> <span class="kwd">in</span> <span class="id">contra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">List.In</a></span> <span class="id">x0</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.n_in">n_in</a></span> <span class="id">n0</span>) ++ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.n_out">n_out</a></span> <span class="id">n0</span>))) <span class="kwd">as</span> <span class="id">InM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">contra</span>. <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.map_fst_senv_of_ins">map_fst_senv_of_ins</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>, &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. <span class="id">solve_In</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.Fresh.Facts.st_valid_AtomOrGensym_nIn">Facts.st_valid_AtomOrGensym_nIn</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.fby_not_in_last_prefs">fby_not_in_last_prefs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">In</span>. <span class="id">simpl_In</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sc_vars_morph">sc_vars_morph</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sc_vars_incl">sc_vars_incl</a></span>; [<span class="id">reflexivity</span>| |<span class="id">reflexivity</span>| |<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">symmetry</span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv.senv_of_decls_app">senv_of_decls_app</a></span>. <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.st_senv_senv_of_decls">st_senv_senv_of_decls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_incl_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>. <span class="id">now</span> <span class="id">subst</span> <span class="id">bs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.find_node_other">find_node_other</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_node_ck_cons2">sem_node_ck_cons2</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G2">G2</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.HGref">HGref</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem.G1">G1</a></span>; <span class="id">econstructor</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_block_ck_cons1">sem_block_ck_cons1</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ord.find_node_later_not_Is_node_in">find_node_later_not_Is_node_in</a></span> <span class="kwd">in</span> <span class="id">Hord1</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem">normfby_node_sem</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">Local</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">wc_global_Ordered_nodes</span> : <span class="id">norm</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="NFCORRECTNESS.normfby_global_refines">normfby_global_refines</a></span> : <span class="kwd">forall</span> <span class="id">G</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cl.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.global_sem_refines">global_sem_refines</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.normfby_global">normfby_global</a></span> <span class="id">G</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof with</summary>
<div class="proofscript">
 <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">norm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">nodes0</span>; <span class="id">intros</span> * <span class="id">Hwc</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.global_sem_ref_nil">global_sem_ref_nil</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.global_sem_ref_cons">global_sem_ref_cons</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.n_name">n_name</a></span> <span class="id">a</span>)...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_global_wc">normfby_global_wc</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.wc_global_Ordered_nodes">wc_global_Ordered_nodes</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.normfby_global">normfby_global</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hwc</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">eapply</span> <span class="id">IHnodes0</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">Hsem</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_node_sem">normfby_node_sem</a></span> <span class="kwd">with</span> (<span class="id">G1</span>:=(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.Global">Global</a></span> <span class="id">types0</span> <span class="id">externs0</span> <span class="id">nodes0</span>)) (<span class="id">G2</span>:=(<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.Global">Global</a></span> _ _ _)) <span class="kwd">in</span> <span class="id">Hsem</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn.iface_eq_iface_incl">iface_eq_iface_incl</a></span>, <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.normfby_global_eq">normfby_global_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">eapply</span> <span class="id">IHnodes0</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">Hwc</span>; <span class="id">simpl</span> <span class="kwd">in</span> *...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_global_wc">normfby_global_wc</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>... <span class="id">inv</span> <span class="id">Hwc</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.wc_global_Ordered_nodes">wc_global_Ordered_nodes</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_global_wc">normfby_global_wc</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>...<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="NFCORRECTNESS.normfby_global_sem">normfby_global_sem</a></span> : <span class="kwd">forall</span> <span class="id">G</span> <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cl.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_node_ck">sem_node_ck</a></span> <span class="id">G</span> <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LCS.sem_node_ck">sem_node_ck</a></span> (<span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF.normfby_global">normfby_global</a></span> <span class="id">G</span>) <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS.normfby_global_refines">normfby_global_refines</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS">NFCORRECTNESS</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="NFCorrectnessFun">NFCorrectnessFun</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Ids</span> : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Op</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Cks</span> : <span class="id"><a href="Velus.Clocks.html#CLOCKS">CLOCKS</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CStr</span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS">COINDSTREAMS</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Senv</span> : <span class="id"><a href="Velus.Lustre.StaticEnv.html#STATICENV">STATICENV</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Syn</span> : <span class="id"><a href="Velus.Lustre.LSyntax.html#LSYNTAX">LSYNTAX</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv">Senv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Clo</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING">LCLOCKING</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Lord</span> : <span class="id"><a href="Velus.Lustre.LOrdered.html#LORDERED">LORDERED</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Sem</span> : <span class="id"><a href="Velus.Lustre.LSemantics.html#LSEMANTICS">LSEMANTICS</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr">CStr</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LClockSem</span> : <span class="id"><a href="Velus.Lustre.LClockedSemantics.html#LCLOCKEDSEMANTICS">LCLOCKEDSEMANTICS</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Clo">Clo</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr">CStr</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem">Sem</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NF</span>  : <span class="id"><a href="Velus.Lustre.NormFby.NormFby.html#NORMFBY">NORMFBY</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;: <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS">NFCORRECTNESS</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr">CStr</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Clo">Clo</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem">Sem</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LClockSem">LClockSem</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF">NF</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Include</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCORRECTNESS">NFCORRECTNESS</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#CStr">CStr</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Clo">Clo</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#Sem">Sem</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#LClockSem">LClockSem</a></span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NF">NF</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.NormFby.NFCorrectness.html#NFCorrectnessFun">NFCorrectnessFun</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
