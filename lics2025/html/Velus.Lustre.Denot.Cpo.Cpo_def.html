
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Cpo_def</title>
<meta name="description" content="Documentation of Coq module Cpo_def" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
</head>

<body>
<h1 class="title">Module Cpo_def</h1>
<div class="coq">
<h1> Ccpo.v: Specification and properties of a cpo </h1>
<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Setoids.Setoid.html">Setoid</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Arith.html">Arith</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.micromega.Lia.html">Lia</a></span>.<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="kwd">Arguments</span>.<br/>
<span class="id">Unset</span> <span class="id">Strict</span> <span class="kwd">Implicit</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">nat_scope</span>.<br/>
<br/>
<br/>
<h2> Ordered type </h2>
<span class="kwd">Record</span> <span class="id"><a name="ord">ord</a></span> : <span class="kwd">Type</span> := <span class="id">mk_ord</span><br/>
&nbsp;&nbsp;{ <span class="id"><a name="tord">tord</a></span>:&gt;<span class="kwd">Type</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Ole">Ole</a></span>           : <span class="id">tord</span>-&gt;<span class="id">tord</span>-&gt;<span class="kwd">Prop</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Ole_refl">Ole_refl</a></span>    : <span class="kwd">forall</span> <span class="id">x</span> :<span class="id">tord</span>, <span class="id">Ole</span> <span class="id">x</span> <span class="id">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Ole_trans">Ole_trans</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>:<span class="id">tord</span>, <span class="id">Ole</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">Ole</span> <span class="id">y</span> <span class="id">z</span> -&gt; <span class="id">Ole</span> <span class="id">x</span> <span class="id">z</span>  }.<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Ole_refl</span> <span class="id">Ole_trans</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Extern</span> 2  (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> ?<span class="id">X1</span> ?<span class="id">X2</span> ?<span class="id">X3</span> ) =&gt; <span class="id">simpl</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Declare</span> <span class="kwd">Scope</span> <span class="id">O_scope</span>.<br/>
<span class="id">Bind</span> <span class="kwd">Scope</span> <span class="id">O_scope</span> <span class="kwd">with</span> <span class="id">tord</span>.<br/>
<span class="id">Delimit</span> <span class="kwd">Scope</span> <span class="id">O_scope</span> <span class="kwd">with</span> <span class="id">tord</span>.<br/>
<br/>
<span class="kwd">Infix</span> <span class="string">"&lt;="</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> : <span class="id">O_scope</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">O_scope</span>.<br/>
<br/>
<h3> Associated equality </h3>
<span class="kwd">Definition</span> <span class="id"><a name="Oeq">Oeq</a></span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x</span> <span class="id">y</span> : <span class="id">O</span>) := <span class="id">x</span> &lt;= <span class="id">y</span> /\ <span class="id">y</span> &lt;= <span class="id">x</span>.<br/>
<br/>
<div class="doc">printing == %\ensuremath{\equiv}% &8801;# </div>
<span class="kwd">Infix</span> <span class="string">"=="</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="kwd">at</span> <span class="id">level</span> 70) : <span class="id">O_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Ole_refl_eq">Ole_refl_eq</a></span> : <span class="kwd">forall</span>  (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x</span> <span class="id">y</span>:<span class="id">O</span>), <span class="id">x</span>=<span class="id">y</span> -&gt; <span class="id">x</span> &lt;= <span class="id">y</span>.<br/>
<span class="id">intros</span> <span class="id">O</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>; <span class="id">rewrite</span> <span class="id">H</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Ole_refl_eq</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Ole_antisym">Ole_antisym</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x</span> <span class="id">y</span>:<span class="id">O</span>), <span class="id">x</span>&lt;=<span class="id">y</span> -&gt; <span class="id">y</span> &lt;=<span class="id">x</span> -&gt; <span class="id">x</span>==<span class="id">y</span>.<br/>
<span class="id">red</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">Ole_antisym</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Oeq_refl">Oeq_refl</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x</span>:<span class="id">O</span>), <span class="id">x</span> == <span class="id">x</span>.<br/>
<span class="id">red</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Oeq_refl</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Oeq_refl_eq">Oeq_refl_eq</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x</span> <span class="id">y</span>:<span class="id">O</span>), <span class="id">x</span>=<span class="id">y</span> -&gt; <span class="id">x</span> == <span class="id">y</span>.<br/>
<span class="id">intros</span> <span class="id">O</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>; <span class="id">rewrite</span> <span class="id">H</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Oeq_refl_eq</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Oeq_sym">Oeq_sym</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x</span> <span class="id">y</span>:<span class="id">O</span>), <span class="id">x</span> == <span class="id">y</span> -&gt; <span class="id">y</span> == <span class="id">x</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span>; <span class="id">intuition</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Oeq_le">Oeq_le</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x</span> <span class="id">y</span>:<span class="id">O</span>), <span class="id">x</span> == <span class="id">y</span> -&gt; <span class="id">x</span> &lt;= <span class="id">y</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span>; <span class="id">intuition</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Oeq_le_sym">Oeq_le_sym</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x</span> <span class="id">y</span>:<span class="id">O</span>), <span class="id">x</span> == <span class="id">y</span> -&gt; <span class="id">y</span> &lt;= <span class="id">x</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span>; <span class="id">intuition</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Oeq_le</span> : <span class="id">core</span>.<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">Oeq_sym</span> <span class="id">Oeq_le_sym</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Oeq_trans">Oeq_trans</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span>:<span class="id">O</span>), <span class="id">x</span> == <span class="id">y</span> -&gt; <span class="id">y</span> == <span class="id">z</span> -&gt; <span class="id">x</span> == <span class="id">z</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span>; <span class="id">split</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">y</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Oeq_trans</span> : <span class="id">core</span>.<br/>
<br/>
<h3> Setoid relations </h3>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Relation</span> (<span class="id">o</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#tord">tord</a></span> <span class="id">o</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">o</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">reflexivity</span> <span class="id">proved</span> <span class="kwd">by</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_refl">Oeq_refl</a></span> (<span class="id">O</span>:=<span class="id">o</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">symmetry</span> <span class="id">proved</span> <span class="kwd">by</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_sym">Oeq_sym</a></span> (<span class="id">O</span>:=<span class="id">o</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">transitivity</span> <span class="id">proved</span> <span class="kwd">by</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> (<span class="id">O</span>:=<span class="id">o</span>)) <span class="kwd">as</span> <span class="id">Oeq_Relation</span>.<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Relation</span> (<span class="id">o</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#tord">tord</a></span> <span class="id">o</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id">o</span>:=<span class="id">o</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">reflexivity</span> <span class="id">proved</span> <span class="kwd">by</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_refl">Ole_refl</a></span> (<span class="id">o</span>:=<span class="id">o</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">transitivity</span> <span class="id">proved</span> <span class="kwd">by</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> (<span class="id">o</span>:=<span class="id">o</span>)) <span class="kwd">as</span> <span class="id">Ole_Relation</span>.<br/>
<br/>
<div class="doc">printing ==&gt; %\ensuremath\Longrightarrow% &8702;# </div>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">o</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id">o</span>:=<span class="id">o</span>))<br/>
&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">o</span>)) ==&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">o</span>)) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span><br/>
&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">Ole_eq_compat_iff</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split</span>; <span class="id">firstorder</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">x</span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">x0</span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">y</span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">y0</span>; <span class="id">trivial</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Ole_eq_compat">Ole_eq_compat</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">O</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x1</span> <span class="id">x2</span> : <span class="id">O</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x1</span> == <span class="id">x2</span> -&gt; <span class="kwd">forall</span> <span class="id">x3</span> <span class="id">x4</span> : <span class="id">O</span>, <span class="id">x3</span> == <span class="id">x4</span> -&gt; <span class="id">x1</span> &lt;= <span class="id">x3</span> -&gt; <span class="id">x2</span> &lt;= <span class="id">x4</span>.<br/>
<span class="id">firstorder</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">x1</span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">x3</span>; <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Ole_eq_right">Ole_eq_right</a></span> : <span class="kwd">forall</span> (<span class="id">O</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span>: <span class="id">O</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> &lt;= <span class="id">y</span> -&gt; <span class="id">y</span> == <span class="id">z</span> -&gt; <span class="id">x</span> &lt;= <span class="id">z</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_eq_compat">Ole_eq_compat</a></span> <span class="kwd">with</span> <span class="id">x</span> <span class="id">y</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Ole_eq_left">Ole_eq_left</a></span> : <span class="kwd">forall</span> (<span class="id">O</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span>: <span class="id">O</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> == <span class="id">y</span> -&gt; <span class="id">y</span> &lt;= <span class="id">z</span> -&gt; <span class="id">x</span> &lt;= <span class="id">z</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_eq_compat">Ole_eq_compat</a></span> <span class="kwd">with</span> <span class="id">y</span> <span class="id">z</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<h3> Dual order </h3>
<br/>
<div class="doc">- Iord x y := y &lt;= x  </div>
<span class="kwd">Definition</span> <span class="id"><a name="Iord">Iord</a></span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>):<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>.<br/>
<span class="kwd">exists</span> <span class="id">O</span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">O</span> =&gt; <span class="id">y</span> &lt;= <span class="id">x</span>); <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">y</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<h3> Order on functions </h3>
<br/>
<div class="doc">- ford f g := forall x, f x &lt;= g x </div>
<span class="kwd">Definition</span> <span class="id"><a name="ford">ford</a></span> (<span class="id">A</span>:<span class="kwd">Type</span>) (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>.<br/>
<span class="kwd">exists</span> (<span class="id">A</span>-&gt;<span class="id">O</span>) (<span class="kwd">fun</span> <span class="id">f</span> <span class="id">g</span>:<span class="id">A</span>-&gt;<span class="id">O</span> =&gt; <span class="kwd">forall</span> <span class="id">x</span>, <span class="id">f</span> <span class="id">x</span> &lt;= <span class="id">g</span> <span class="id">x</span>); <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">y</span> <span class="id">x0</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<div class="doc">printing -o&gt; %\ensuremath{\stackrel{o}{\rightarrow}}% </div>
<span class="kwd">Infix</span> <span class="string">"-o&gt;"</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford">ford</a></span> (<span class="id">right</span> <span class="id">associativity</span>, <span class="kwd">at</span> <span class="id">level</span> 30) : <span class="id">O_scope</span> .<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ford_le_elim">ford_le_elim</a></span> : <span class="kwd">forall</span> <span class="id">A</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id">A</span> -<span class="id">o</span>&gt; <span class="id">O</span>), <span class="id">f</span> &lt;= <span class="id">g</span> -&gt;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">f</span> <span class="id">n</span> &lt;= <span class="id">g</span> <span class="id">n</span>.<br/>
<span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">ford_le_elim</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ford_le_intro">ford_le_intro</a></span> : <span class="kwd">forall</span> <span class="id">A</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id">A</span> -<span class="id">o</span>&gt; <span class="id">O</span>), (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">f</span> <span class="id">n</span> &lt;= <span class="id">g</span> <span class="id">n</span>) -&gt; <span class="id">f</span> &lt;= <span class="id">g</span>.<br/>
<span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">ford_le_intro</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ford_eq_elim">ford_eq_elim</a></span> : <span class="kwd">forall</span> <span class="id">A</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id">A</span> -<span class="id">o</span>&gt; <span class="id">O</span>), <span class="id">f</span> == <span class="id">g</span> -&gt;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">f</span> <span class="id">n</span> == <span class="id">g</span> <span class="id">n</span>.<br/>
<span class="id">firstorder</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">ford_eq_elim</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ford_eq_intro">ford_eq_intro</a></span> : <span class="kwd">forall</span> <span class="id">A</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id">A</span> -<span class="id">o</span>&gt; <span class="id">O</span>), (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">f</span> <span class="id">n</span> == <span class="id">g</span> <span class="id">n</span>) -&gt; <span class="id">f</span> == <span class="id">g</span>.<br/>
<span class="id">red</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">ford_eq_intro</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Extern</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id">o</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford">ford</a></span> ?<span class="id">X1</span> ?<span class="id">X2</span>) ?<span class="id">X3</span> ?<span class="id">X4</span>) =&gt; <span class="id">intro</span> : <span class="id">core</span>.<br/>
<br/>
<h2> Monotonicity </h2>
<br/>
<h3> Definition and properties </h3>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="monotonic">monotonic</a></span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> : <span class="id">O1</span> -&gt; <span class="id">O2</span>) := <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">x</span> &lt;= <span class="id">y</span> -&gt; <span class="id">f</span> <span class="id">x</span> &lt;= <span class="id">f</span> <span class="id">y</span>.<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#monotonic">monotonic</a></span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="stable">stable</a></span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> : <span class="id">O1</span> -&gt; <span class="id">O2</span>) := <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">x</span> == <span class="id">y</span> -&gt; <span class="id">f</span> <span class="id">x</span> == <span class="id">f</span> <span class="id">y</span>.<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#stable">stable</a></span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="monotonic_stable">monotonic_stable</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>:<span class="id">O1</span> -&gt; <span class="id">O2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#monotonic">monotonic</a></span> <span class="id">f</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#stable">stable</a></span> <span class="id">f</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#monotonic">monotonic</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#stable">stable</a></span>; <span class="id">firstorder</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">monotonic_stable</span> : <span class="id">core</span>.<br/>
<br/>
<h3> Type of monotonic functions </h3>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="fmono">fmono</a></span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : <span class="kwd">Type</span> := <span class="id">mk_fmono</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id"><a name="fmonot">fmonot</a></span> :&gt; <span class="id">O1</span> -&gt; <span class="id">O2</span>; <span class="id"><a name="fmonotonic">fmonotonic</a></span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#monotonic">monotonic</a></span> <span class="id">fmonot</span>}.<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fmonotonic</span> : <span class="id">core</span>.<br/>
<br/>
<div class="doc">- fmon O1 O2 (f g : fmono O1 O2) := forall x, f x &lt;= g x </div>
<span class="kwd">Definition</span> <span class="id"><a name="fmon">fmon</a></span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>.<br/>
<span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmono">fmono</a></span> <span class="id">O1</span> <span class="id">O2</span>) (<span class="kwd">fun</span> <span class="id">f</span> <span class="id">g</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmono">fmono</a></span> <span class="id">O1</span> <span class="id">O2</span> =&gt; <span class="kwd">forall</span> <span class="id">x</span>, <span class="id">f</span> <span class="id">x</span> &lt;= <span class="id">g</span> <span class="id">x</span>); <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">y</span> <span class="id">x0</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<div class="doc">printing -m&gt; %\ensuremath{\stackrel{m}{\rightarrow}}%</div>
<span class="kwd">Infix</span> <span class="string">"-m&gt;"</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon">fmon</a></span> (<span class="kwd">at</span> <span class="id">level</span> 30, <span class="id">right</span> <span class="id">associativity</span>) : <span class="id">O_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_stable">fmon_stable</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#stable">stable</a></span> <span class="id">f</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#monotonic_stable">monotonic_stable</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fmon_stable</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_le_elim">fmon_le_elim</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>), <span class="id">f</span> &lt;= <span class="id">g</span> -&gt; <span class="kwd">forall</span> <span class="id">n</span>, <span class="id">f</span> <span class="id">n</span> &lt;= <span class="id">g</span> <span class="id">n</span>.<br/>
<span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">fmon_le_elim</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_le_intro">fmon_le_intro</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>), (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">f</span> <span class="id">n</span> &lt;= <span class="id">g</span> <span class="id">n</span>) -&gt; <span class="id">f</span> &lt;= <span class="id">g</span>.<br/>
<span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fmon_le_intro</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_eq_elim">fmon_eq_elim</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>), <span class="id">f</span> == <span class="id">g</span> -&gt;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">f</span> <span class="id">n</span> == <span class="id">g</span> <span class="id">n</span>.<br/>
<span class="id">firstorder</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">fmon_eq_elim</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_eq_intro">fmon_eq_intro</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>), (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">f</span> <span class="id">n</span> == <span class="id">g</span> <span class="id">n</span>) -&gt; <span class="id">f</span> == <span class="id">g</span>.<br/>
<span class="id">red</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fmon_eq_intro</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Extern</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id">o</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon">fmon</a></span> ?<span class="id">X1</span> ?<span class="id">X2</span>) ?<span class="id">X3</span> ?<span class="id">X4</span>) =&gt; <span class="id">intro</span> : <span class="id">core</span>.<br/>
<br/>
<h3> Monotonicity and dual order </h3>
<br/>
<div class="doc">- <span class="bracket"><span class="id">lmon</span> <span class="id">f</span></span> uses f as monotonic function over the dual order. </div>
<span class="kwd">Definition</span> <span class="id"><a name="Imon">Imon</a></span> : <span class="kwd">forall</span> <span class="id">O1</span> <span class="id">O2</span>, (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iord">Iord</a></span> <span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iord">Iord</a></span> <span class="id">O2</span>.<br/>
<span class="id">intros</span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">f</span>; <span class="kwd">exists</span> (<span class="id">f</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iord">Iord</a></span> <span class="id">O1</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iord">Iord</a></span> <span class="id">O2</span>); <span class="id">red</span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Imon2">Imon2</a></span> : <span class="kwd">forall</span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>, (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iord">Iord</a></span> <span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iord">Iord</a></span> <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iord">Iord</a></span> <span class="id">O3</span>.<br/>
<span class="id">intros</span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span> <span class="id">f</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iord">Iord</a></span> <span class="id">O1</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Imon">Imon</a></span> (<span class="id">f</span> <span class="id">x</span>)); <span class="id">red</span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<h3> Monotonic functions with 2 arguments </h3>
<span class="kwd">Definition</span> <span class="id"><a name="le_compat2_mon">le_compat2_mon</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>)(<span class="id">f</span>:<span class="id">O1</span> -&gt; <span class="id">O2</span> -&gt; <span class="id">O3</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id">O1</span>) (<span class="id">z</span> <span class="id">t</span>:<span class="id">O2</span>), <span class="id">x</span>&lt;=<span class="id">y</span> -&gt; <span class="id">z</span> &lt;= <span class="id">t</span> -&gt; <span class="id">f</span> <span class="id">x</span> <span class="id">z</span> &lt;= <span class="id">f</span> <span class="id">y</span> <span class="id">t</span>) -&gt; (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>).<br/>
<span class="id">intros</span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span> <span class="id">f</span> <span class="id">Hle</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id">O1</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mk_fmono">mk_fmono</a></span> (<span class="kwd">fun</span> <span class="id">z</span> <span class="id">t</span> =&gt; <span class="id">Hle</span> <span class="id">x</span> <span class="id">x</span> <span class="id">z</span> <span class="id">t</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_refl">Ole_refl</a></span> <span class="id">x</span>))).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">intro</span> <span class="id">a</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<h2> Sequences </h2>
<h3> Order on natural numbers </h3>
<br/>
<div class="doc">- natO n m = n &lt;= m </div>
<span class="kwd">Definition</span> <span class="id"><a name="natO">natO</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> (<span class="kwd">fun</span> <span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span> &lt;= <span class="id">m</span>)%<span class="id">nat</span>); <span class="id">intros</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_trans">Nat.le_trans</a></span> <span class="kwd">with</span> <span class="id">y</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fnatO_intro">fnatO_intro</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id">O</span>), (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">f</span> <span class="id">n</span> &lt;= <span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">O</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> <span class="id">f</span>; <span class="id">red</span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">elim</span> <span class="id">H0</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> <span class="id">m</span>); <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fnatO_elim">fnatO_elim</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">O</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id">f</span> <span class="id">n</span> &lt;= <span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fnatO_elim</span> : <span class="id">core</span>.<br/>
<br/>
<br/>
<div class="doc">- (mseq_lift_left f n) k = f (n+k) </div>
<span class="kwd">Definition</span> <span class="id"><a name="mseq_lift_left">mseq_lift_left</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">O</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">O</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; <span class="id">f</span> (<span class="id">n</span>+<span class="id">k</span>)%<span class="id">nat</span>); <span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mseq_lift_left_simpl">mseq_lift_left_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">O</span>) (<span class="id">n</span> <span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_left">mseq_lift_left</a></span> <span class="id">f</span> <span class="id">n</span>  <span class="id">k</span> = <span class="id">f</span> (<span class="id">n</span>+<span class="id">k</span>)%<span class="id">nat</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mseq_lift_left_le_compat">mseq_lift_left_le_compat</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">O</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> &lt;= <span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_left">mseq_lift_left</a></span> <span class="id">f</span> <span class="id">n</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_left">mseq_lift_left</a></span> <span class="id">g</span> <span class="id">n</span>.<br/>
<span class="id">intros</span>; <span class="id">intro</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">mseq_lift_left_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span>  (<span class="id">o</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_left">mseq_lift_left</a></span> (<span class="id">O</span>:=<span class="id">o</span>))<br/>
&nbsp;<span class="kwd">with</span> <span class="id">signature</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span>  (<span class="id">O</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">o</span>)) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (<span class="id">A</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) ==&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">o</span>))<br/>
<span class="kwd">as</span> <span class="id">mseq_lift_left_eq_compat</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">mseq_lift_left_eq_compat</span> : <span class="id">core</span>.<br/>
<br/>
<div class="doc">- (mseq_lift_right f n) k = f (k+n) </div>
<span class="kwd">Definition</span> <span class="id"><a name="mseq_lift_right">mseq_lift_right</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">O</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">O</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; <span class="id">f</span> (<span class="id">k</span>+<span class="id">n</span>)%<span class="id">nat</span>); <span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mseq_lift_right_simpl">mseq_lift_right_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">O</span>) (<span class="id">n</span> <span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_right">mseq_lift_right</a></span> <span class="id">f</span> <span class="id">n</span>  <span class="id">k</span> = <span class="id">f</span> (<span class="id">k</span>+<span class="id">n</span>)%<span class="id">nat</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mseq_lift_right_le_compat">mseq_lift_right_le_compat</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">O</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> &lt;= <span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_right">mseq_lift_right</a></span> <span class="id">f</span> <span class="id">n</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_right">mseq_lift_right</a></span> <span class="id">g</span> <span class="id">n</span>.<br/>
<span class="id">intros</span>; <span class="id">intro</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">mseq_lift_right_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">o</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_right">mseq_lift_right</a></span> (<span class="id">O</span>:=<span class="id">o</span>))<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">o</span>) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (<span class="id">A</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) ==&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">o</span>)<br/>
<span class="kwd">as</span> <span class="id">mseq_lift_right_eq_compat</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mseq_lift_right_left">mseq_lift_right_left</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">O</span>) <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_left">mseq_lift_left</a></span> <span class="id">f</span> <span class="id">n</span>  == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_right">mseq_lift_right</a></span> <span class="id">f</span> <span class="id">n</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_eq_intro">fmon_eq_intro</a></span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_left">mseq_lift_left</a></span>,<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_right">mseq_lift_right</a></span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">replace</span> (<span class="id">n0</span>+<span class="id">n</span>)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id">n</span>+<span class="id">n0</span>)%<span class="id">nat</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Qed.
<br/>
<br/>
<h3> Monotonicity and functions </h3>
<div class="doc">-  (ford_app f x) n = f n x </div>
<span class="kwd">Definition</span> <span class="id"><a name="ford_app">ford_app</a></span> : <span class="kwd">forall</span> (<span class="id">A</span>:<span class="kwd">Type</span>)(<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>)(<span class="id">f</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; (<span class="id">A</span> -<span class="id">o</span>&gt; <span class="id">O2</span>))(<span class="id">x</span>:<span class="id">A</span>), <span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">f</span> <span class="id">n</span> <span class="id">x</span>); <span class="id">intros</span>.<br/>
<span class="id">intro</span> <span class="id">n</span>; <span class="id">intros</span>.<br/>
<span class="id">assert</span> (<span class="id">f</span> <span class="id">n</span> &lt;= <span class="id">f</span> <span class="id">y</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>); <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<div class="doc">printing &lt;o&gt; %\ensuremath{\stackrel{o}{\diamond}}% </div>
<span class="kwd">Infix</span> <span class="string">"&lt;o&gt;"</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_app">ford_app</a></span> (<span class="kwd">at</span> <span class="id">level</span> 30, <span class="id">no</span> <span class="id">associativity</span>) : <span class="id">O_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ford_app_simpl">ford_app_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">A</span>:<span class="kwd">Type</span>)(<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>)  (<span class="id">f</span> : <span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">A</span> -<span class="id">o</span>&gt; <span class="id">O2</span>) (<span class="id">x</span>:<span class="id">A</span>)(<span class="id">y</span>:<span class="id">O1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> &lt;<span class="id">o</span>&gt; <span class="id">x</span>) <span class="id">y</span> = <span class="id">f</span> <span class="id">y</span> <span class="id">x</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ford_app_le_compat">ford_app_le_compat</a></span> : <span class="kwd">forall</span> (<span class="id">A</span>:<span class="kwd">Type</span>)(<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">A</span> -<span class="id">o</span>&gt; <span class="id">O2</span>) (<span class="id">x</span>:<span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> &lt;= <span class="id">g</span> -&gt; <span class="id">f</span> &lt;<span class="id">o</span>&gt; <span class="id">x</span>  &lt;= <span class="id">g</span> &lt;<span class="id">o</span>&gt; <span class="id">x</span>.<br/>
<span class="id">intros</span>; <span class="id">intro</span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> (<span class="id">H</span> <span class="id">x0</span>).<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">ford_app_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">A</span>:<span class="kwd">Type</span>)(<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_app">ford_app</a></span> (<span class="id">A</span>:=<span class="id">A</span>) (<span class="id">O1</span>:=<span class="id">O1</span>) (<span class="id">O2</span>:=<span class="id">O2</span>))<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">O1</span> -<span class="id">m</span>&gt; (<span class="id">A</span> -<span class="id">o</span>&gt; <span class="id">O2</span>)) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (<span class="id">A</span>:=<span class="id">A</span>) ==&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>)<br/>
<span class="kwd">as</span> <span class="id">ford_app_eq_compat</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<div class="doc">- ford_shift f x y == f y x </div>
<span class="kwd">Definition</span> <span class="id"><a name="ford_shift">ford_shift</a></span> : <span class="kwd">forall</span> (<span class="id">A</span>:<span class="kwd">Type</span>)(<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>)(<span class="id">f</span>:<span class="id">A</span> -<span class="id">o</span>&gt; (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>)), <span class="id">O1</span> -<span class="id">m</span>&gt; (<span class="id">A</span> -<span class="id">o</span>&gt; <span class="id">O2</span>).<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id">f</span> <span class="id">y</span> <span class="id">x</span>); <span class="id">intros</span>.<br/>
<span class="id">intros</span> <span class="id">n</span> <span class="id">x</span> <span class="id">H</span> <span class="id">y</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id">f</span> <span class="id">y</span>)); <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ford_shift_le_compat">ford_shift_le_compat</a></span> : <span class="kwd">forall</span> (<span class="id">A</span>:<span class="kwd">Type</span>)(<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> <span class="id">g</span>: <span class="id">A</span> -<span class="id">o</span>&gt; (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> &lt;= <span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_shift">ford_shift</a></span> <span class="id">f</span>  &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_shift">ford_shift</a></span> <span class="id">g</span>.<br/>
<span class="id">intros</span>; <span class="id">intro</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">ford_shift_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">A</span>:<span class="kwd">Type</span>)(<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_shift">ford_shift</a></span> (<span class="id">A</span>:=<span class="id">A</span>) (<span class="id">O1</span>:=<span class="id">O1</span>) (<span class="id">O2</span>:=<span class="id">O2</span>))<br/>
&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">A</span> -<span class="id">o</span>&gt; (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>)) ==&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">O1</span> -<span class="id">m</span>&gt; (<span class="id">A</span> -<span class="id">o</span>&gt; <span class="id">O2</span>))<br/>
<span class="kwd">as</span> <span class="id">ford_shift_eq_compat</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<br/>
<div class="doc"> - (fmon_app f x) n = f n x </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fmon_app">fmon_app</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>)(<span class="id">f</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>)(<span class="id">x</span>:<span class="id">O2</span>), <span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O3</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">f</span> <span class="id">n</span> <span class="id">x</span>); <span class="id">intros</span>.<br/>
<span class="id">intro</span> <span class="id">n</span>; <span class="id">intros</span>.<br/>
<span class="id">assert</span> (<span class="id">f</span> <span class="id">n</span> &lt;= <span class="id">f</span> <span class="id">y</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>); <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<div class="doc">printing &lt;_&gt; %\ensuremath{\leftrightarroweq}%</div>
<span class="kwd">Infix</span> <span class="string">"&lt;_&gt;"</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_app">fmon_app</a></span> (<span class="kwd">at</span> <span class="id">level</span> 35, <span class="id">no</span> <span class="id">associativity</span>) : <span class="id">O_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_app_simpl">fmon_app_simpl</a></span> : <span class="kwd">forall</span>  (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>)(<span class="id">f</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>)(<span class="id">x</span>:<span class="id">O2</span>)(<span class="id">y</span>:<span class="id">O1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> &lt;_&gt; <span class="id">x</span>)  <span class="id">y</span> = <span class="id">f</span> <span class="id">y</span> <span class="id">x</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_app_le_compat">fmon_app_le_compat</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; (<span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>)) (<span class="id">x</span> <span class="id">y</span>:<span class="id">O2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> &lt;= <span class="id">g</span> -&gt; <span class="id">x</span> &lt;= <span class="id">y</span> -&gt; <span class="id">f</span> &lt;_&gt; <span class="id">x</span>  &lt;= <span class="id">g</span> &lt;_&gt; <span class="id">y</span>.<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> <span class="id">x0</span> <span class="id">y</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id">f</span> <span class="id">x0</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fmon_app_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_app">fmon_app</a></span> (<span class="id">O1</span>:=<span class="id">O1</span>) (<span class="id">O2</span>:=<span class="id">O2</span>) (<span class="id">O3</span>:=<span class="id">O3</span>))<br/>
&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>) ==&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">O2</span>) ==&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">O1</span>-<span class="id">m</span>&gt;<span class="id">O3</span>)<br/>
<span class="kwd">as</span> <span class="id">fmon_app_eq_compat</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<div class="doc">- fmon_id c = c </div>
<span class="kwd">Definition</span> <span class="id"><a name="fmon_id">fmon_id</a></span> :  <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>), <span class="id">O</span> -<span class="id">m</span>&gt; <span class="id">O</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>)=&gt;<span class="id">x</span>).<br/>
<span class="id">intro</span> <span class="id">n</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_id_simpl">fmon_id_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x</span>:<span class="id">O</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_id">fmon_id</a></span> <span class="id">O</span> <span class="id">x</span> = <span class="id">x</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<div class="doc"> - (fmon_cte c) n = c </div>
<span class="kwd">Definition</span> <span class="id"><a name="fmon_cte">fmon_cte</a></span> :  <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>)(<span class="id">c</span>:<span class="id">O2</span>), <span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id">O1</span>)=&gt;<span class="id">c</span>).<br/>
<span class="id">intro</span> <span class="id">n</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_cte_simpl">fmon_cte_simpl</a></span> : <span class="kwd">forall</span>  (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>)(<span class="id">c</span>:<span class="id">O2</span>)(<span class="id">c</span>:<span class="id">O2</span>) (<span class="id">x</span>:<span class="id">O1</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="id">O1</span> <span class="id">c</span> <span class="id">x</span> = <span class="id">c</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="mseq_cte">mseq_cte</a></span> : <span class="kwd">forall</span> <span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>, <span class="id">O</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">O</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_cte_le_compat">fmon_cte_le_compat</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">c1</span> <span class="id">c2</span>:<span class="id">O2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c1</span> &lt;= <span class="id">c2</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="id">O1</span> <span class="id">c1</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="id">O1</span> <span class="id">c2</span>.<br/>
<span class="id">intros</span>; <span class="id">intro</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="id">O1</span> (<span class="id">O2</span>:=<span class="id">O2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">O2</span>) ==&gt;  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>)<br/>
<span class="kwd">as</span> <span class="id">fmon_cte_eq_compat</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<div class="doc">- (fmon_diag h) n = h n n </div>
<span class="kwd">Definition</span> <span class="id"><a name="fmon_diag">fmon_diag</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>)(<span class="id">h</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>)), <span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">h</span> <span class="id">n</span> <span class="id">n</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">h</span> <span class="id">x</span> <span class="id">y</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id">h</span> <span class="id">x</span>)); <span class="id">auto</span>.<br/>
<span class="id">assert</span> (<span class="id">h</span> <span class="id">x</span> &lt;= <span class="id">h</span> <span class="id">y</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">h</span>); <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_diag_le_compat">fmon_diag_le_compat</a></span> :  <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> &lt;= <span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_diag">fmon_diag</a></span> <span class="id">f</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_diag">fmon_diag</a></span> <span class="id">g</span>.<br/>
<span class="id">intros</span>; <span class="id">intro</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fmon_diag_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_diag_simpl">fmon_diag_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>)) (<span class="id">x</span>:<span class="id">O1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_diag">fmon_diag</a></span> <span class="id">f</span> <span class="id">x</span> = <span class="id">f</span> <span class="id">x</span> <span class="id">x</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_diag">fmon_diag</a></span> (<span class="id">O1</span>:=<span class="id">O1</span>) (<span class="id">O2</span>:=<span class="id">O2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">O1</span> -<span class="id">m</span>&gt; (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>)) ==&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>)<br/>
<span class="kwd">as</span> <span class="id">fmon_diag_eq_compat</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<div class="doc">- (fmon_shift h) n m = h m n </div>
<span class="kwd">Definition</span> <span class="id"><a name="fmon_shift">fmon_shift</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>)(<span class="id">h</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span> -<span class="id">m</span>&gt;  <span class="id">O3</span>), <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O1</span> -<span class="id">m</span>&gt;  <span class="id">O3</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id">h</span> &lt;_&gt; <span class="id">m</span>).<br/>
<span class="id">intro</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id">h</span> <span class="id">x</span>)); <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_shift_simpl">fmon_shift_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>)(<span class="id">h</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span> -<span class="id">m</span>&gt;  <span class="id">O3</span>) (<span class="id">x</span> : <span class="id">O2</span>) (<span class="id">y</span>:<span class="id">O1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_shift">fmon_shift</a></span> <span class="id">h</span> <span class="id">x</span> <span class="id">y</span> = <span class="id">h</span> <span class="id">y</span> <span class="id">x</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_shift_le_compat">fmon_shift_le_compat</a></span> :  <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id">O1</span> -<span class="id">m</span>&gt;  <span class="id">O2</span> -<span class="id">m</span>&gt;  <span class="id">O3</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> &lt;= <span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_shift">fmon_shift</a></span> <span class="id">f</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_shift">fmon_shift</a></span> <span class="id">g</span>.<br/>
<span class="id">intros</span>; <span class="id">intro</span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">assert</span> (<span class="id">f</span> <span class="id">x0</span> &lt;= <span class="id">g</span> <span class="id">x0</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fmon_shift_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_shift">fmon_shift</a></span> (<span class="id">O1</span>:=<span class="id">O1</span>) (<span class="id">O2</span>:=<span class="id">O2</span>) (<span class="id">O3</span>:=<span class="id">O3</span>))<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span>  (<span class="id">O</span>:=<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span> -<span class="id">m</span>&gt;  <span class="id">O3</span>) ==&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O1</span> -<span class="id">m</span>&gt;  <span class="id">O3</span>)<br/>
<span class="kwd">as</span> <span class="id">fmon_shift_eq_compat</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_shift_shift_eq">fmon_shift_shift_eq</a></span> :  <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">h</span> : <span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span> -<span class="id">m</span>&gt;  <span class="id">O3</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_shift">fmon_shift</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_shift">fmon_shift</a></span> <span class="id">h</span>) == <span class="id">h</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_eq_intro">fmon_eq_intro</a></span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_shift">fmon_shift</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<div class="doc">- (f@g) x = f (g x) </div>
<span class="kwd">Definition</span> <span class="id"><a name="fmon_comp">fmon_comp</a></span> : <span class="kwd">forall</span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>, (<span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>) -&gt; (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>) -&gt; <span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O3</span>.<br/>
<span class="id">intros</span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span> <span class="id">f</span> <span class="id">g</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">f</span> (<span class="id">g</span> <span class="id">n</span>)); <span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">g</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<div class="doc">printing @ %\ensuremath{\stackrel{m}{\circ}}% </div>
<span class="kwd">Infix</span> <span class="string">"@"</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp">fmon_comp</a></span> (<span class="kwd">at</span> <span class="id">level</span> 35) : <span class="id">O_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_comp_simpl">fmon_comp_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span> :<span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>) (<span class="id">g</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>) (<span class="id">x</span>:<span class="id">O1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> @ <span class="id">g</span>) <span class="id">x</span> = <span class="id">f</span> (<span class="id">g</span> <span class="id">x</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<div class="doc">- (f@2 g) h x = f (g x) (h x) </div>
<span class="kwd">Definition</span> <span class="id"><a name="fmon_comp2">fmon_comp2</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span> <span class="id">O4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>, (<span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span> -<span class="id">m</span>&gt; <span class="id">O4</span>) -&gt; (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>) -&gt; (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O3</span>) -&gt; <span class="id">O1</span>-<span class="id">m</span>&gt;<span class="id">O4</span>.<br/>
<span class="id">intros</span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span> <span class="id">O4</span> <span class="id">f</span> <span class="id">g</span> <span class="id">h</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">f</span> (<span class="id">g</span> <span class="id">n</span>) (<span class="id">h</span> <span class="id">n</span>)); <span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> (<span class="id">g</span> <span class="id">x</span>) (<span class="id">h</span> <span class="id">y</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id">f</span> (<span class="id">g</span> <span class="id">x</span>))).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">h</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">g</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<div class="doc">printing @2 %\ensuremath{\stackrel{m}{\circ_2}}% </div>
<span class="kwd">Infix</span> <span class="string">"@2"</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp2">fmon_comp2</a></span> (<span class="kwd">at</span> <span class="id">level</span> 70) : <span class="id">O_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_comp2_simpl">fmon_comp2_simpl</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span> <span class="id">O4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>:<span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span> -<span class="id">m</span>&gt; <span class="id">O4</span>) (<span class="id">g</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>) (<span class="id">h</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O3</span>) (<span class="id">x</span>:<span class="id">O1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> @2 <span class="id">g</span>) <span class="id">h</span> <span class="id">x</span> = <span class="id">f</span> (<span class="id">g</span> <span class="id">x</span>) (<span class="id">h</span> <span class="id">x</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp">fmon_comp</a></span> (<span class="id">O1</span>:=<span class="id">O1</span>) (<span class="id">O2</span>:=<span class="id">O2</span>) (<span class="id">O3</span>:=<span class="id">O3</span>))<br/>
<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id">o</span>:=<span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>) ++&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id">o</span>:=<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>) ++&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id">o</span>:=<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O3</span>)<br/>
<span class="kwd">as</span> <span class="id">fmon_comp_le_compat_morph</span>.<br/>
<span class="id">red</span>; <span class="id">intros</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">H</span> <span class="id">g1</span> <span class="id">g2</span> <span class="id">H1</span> <span class="id">x</span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f2</span> (<span class="id">g1</span> <span class="id">x</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f2</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_comp_le_compat">fmon_comp_le_compat</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f1</span> <span class="id">f2</span>: <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>) (<span class="id">g1</span> <span class="id">g2</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f1</span> &lt;= <span class="id">f2</span> -&gt; <span class="id">g1</span>&lt;= <span class="id">g2</span> -&gt; <span class="id">f1</span> @ <span class="id">g1</span> &lt;= <span class="id">f2</span> @ <span class="id">g2</span>.<br/>
<span class="id">intros</span>; <span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_le_compat_morph">fmon_comp_le_compat_morph</a></span> <span class="id">H</span> <span class="id">H0</span>).<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">fmon_comp_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp">fmon_comp</a></span> (<span class="id">O1</span>:=<span class="id">O1</span>) (<span class="id">O2</span>:=<span class="id">O2</span>) (<span class="id">O3</span>:=<span class="id">O3</span>))<br/>
<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>) ==&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span>  (<span class="id">O</span>:=<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>) ==&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O3</span>)<br/>
<span class="kwd">as</span> <span class="id">fmon_comp_eq_compat</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_le_compat">fmon_comp_le_compat</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">fmon_comp_eq_compat</span> : <span class="id">core</span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_comp_monotonic2">fmon_comp_monotonic2</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>: <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>) (<span class="id">g1</span> <span class="id">g2</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">g1</span>&lt;= <span class="id">g2</span> -&gt; <span class="id">f</span> @ <span class="id">g1</span> &lt;= <span class="id">f</span> @ <span class="id">g2</span>.<br/>
<span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fmon_comp_monotonic2</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_comp_monotonic1">fmon_comp_monotonic1</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f1</span> <span class="id">f2</span>: <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>) (<span class="id">g</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f1</span>&lt;= <span class="id">f2</span> -&gt; <span class="id">f1</span> @ <span class="id">g</span> &lt;= <span class="id">f2</span> @ <span class="id">g</span>.<br/>
<span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fmon_comp_monotonic1</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcomp">fcomp</a></span> : <span class="kwd">forall</span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>,  (<span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>) -<span class="id">m</span>&gt; (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>) -<span class="id">m</span>&gt; (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O3</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">f</span> : <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mk_fmono">mk_fmono</a></span> (<span class="id">fmonot</span>:=<span class="kwd">fun</span> <span class="id">g</span> : <span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp">fmon_comp</a></span> <span class="id">f</span> <span class="id">g</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_monotonic2">fmon_comp_monotonic2</a></span> <span class="id">f</span>)).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id">H</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcomp_simpl">fcomp_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>:<span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>) (<span class="id">g</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcomp">fcomp</a></span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span> <span class="id">f</span> <span class="id">g</span> = <span class="id">f</span> @ <span class="id">g</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcomp2">fcomp2</a></span>  : <span class="kwd">forall</span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span> <span class="id">O4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">O3</span> -<span class="id">m</span>&gt; <span class="id">O4</span>) -<span class="id">m</span>&gt; (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>-<span class="id">m</span>&gt;<span class="id">O3</span>) -<span class="id">m</span>&gt; (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O4</span>).<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">f</span> : <span class="id">O3</span> -<span class="id">m</span>&gt; <span class="id">O4</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcomp">fcomp</a></span> <span class="id">O1</span> (<span class="id">O2</span>-<span class="id">m</span>&gt; <span class="id">O3</span>) (<span class="id">O2</span>-<span class="id">m</span>&gt;<span class="id">O4</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcomp">fcomp</a></span> <span class="id">O2</span> <span class="id">O3</span> <span class="id">O4</span> <span class="id">f</span>)).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id">H</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcomp2_simpl">fcomp2_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span> <span class="id">O4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>:<span class="id">O3</span> -<span class="id">m</span>&gt; <span class="id">O4</span>) (<span class="id">g</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>-<span class="id">m</span>&gt;<span class="id">O3</span>) (<span class="id">x</span>:<span class="id">O1</span>)(<span class="id">y</span>:<span class="id">O2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcomp2">fcomp2</a></span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span> <span class="id">O4</span> <span class="id">f</span> <span class="id">g</span> <span class="id">x</span> <span class="id">y</span> = <span class="id">f</span> (<span class="id">g</span> <span class="id">x</span> <span class="id">y</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_le_compat">fmon_le_compat</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>: <span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>) (<span class="id">x</span> <span class="id">y</span>:<span class="id">O1</span>), <span class="id">x</span>&lt;=<span class="id">y</span> -&gt; <span class="id">f</span> <span class="id">x</span> &lt;= <span class="id">f</span> <span class="id">y</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fmon_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_le_compat2">fmon_le_compat2</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>: <span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>) (<span class="id">x</span> <span class="id">y</span>:<span class="id">O1</span>) (<span class="id">z</span> <span class="id">t</span>:<span class="id">O2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span>&lt;=<span class="id">y</span> -&gt; <span class="id">z</span> &lt;=<span class="id">t</span> -&gt; <span class="id">f</span> <span class="id">x</span> <span class="id">z</span> &lt;= <span class="id">f</span> <span class="id">y</span> <span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> <span class="id">x</span> <span class="id">t</span>).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id">f</span> <span class="id">x</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fmon_le_compat2</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_cte_comp">fmon_cte_comp</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>)(<span class="id">c</span>:<span class="id">O3</span>)(<span class="id">f</span>:<span class="id">O1</span>-<span class="id">m</span>&gt;<span class="id">O2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="id">O2</span> <span class="id">c</span> @ <span class="id">f</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="id">O1</span> <span class="id">c</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_eq_intro">fmon_eq_intro</a></span>; <span class="id">intro</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<h2> Basic operators of omega-cpos </h2>
<div class="doc">- Constant : $0$
     - lub : limit of monotonic sequences
</div>
<br/>
<br/>
<br/>
<h3> Definition of cpos </h3>
<span class="kwd">Record</span> <span class="id"><a name="cpo">cpo</a></span> : <span class="kwd">Type</span> := <span class="id">mk_cpo</span><br/>
&nbsp;&nbsp;{<span class="id"><a name="tcpo">tcpo</a></span>:&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>; <span class="id"><a name="D0">D0</a></span> : <span class="id">tcpo</span>; <span class="id"><a name="lub">lub</a></span>: (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">tcpo</span>) -&gt; <span class="id">tcpo</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a name="Dbot">Dbot</a></span> : <span class="kwd">forall</span> <span class="id">x</span>:<span class="id">tcpo</span>, <span class="id">D0</span> &lt;= <span class="id">x</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a name="le_lub">le_lub</a></span> : <span class="kwd">forall</span> (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">tcpo</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id">f</span> <span class="id">n</span> &lt;= <span class="id">lub</span> <span class="id">f</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a name="lub_le">lub_le</a></span> : <span class="kwd">forall</span> (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">tcpo</span>) (<span class="id">x</span>:<span class="id">tcpo</span>), (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">f</span> <span class="id">n</span> &lt;= <span class="id">x</span>) -&gt; <span class="id">lub</span> <span class="id">f</span> &lt;= <span class="id">x</span>}.<br/>
<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#D0">D0</a></span> {<span class="id">c</span>}.<br/>
<span class="kwd">Notation</span> <span class="string">"0"</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#D0">D0</a></span> : <span class="id">O_scope</span>.<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Dbot</span> <span class="id">le_lub</span> <span class="id">lub_le</span> : <span class="id">core</span>.<br/>
<br/>
<h3> Least upper bounds </h3>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) :  (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">c</span>))<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id">o</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">c</span>) ++&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id">o</span>:=<span class="id">c</span>)<br/>
<span class="kwd">as</span> <span class="id">lub_le_compat_morph</span>.<br/>
<span class="id">intros</span> <span class="id">f</span> <span class="id">g</span> <span class="id">H</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">g</span> <span class="id">n</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">lub_le_compat_morph</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_le_compat">lub_le_compat</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">D</span>), <span class="id">f</span> &lt;= <span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">f</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">g</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">g</span> <span class="id">n</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">lub_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Lub">Lub</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">D</span>) -<span class="id">m</span>&gt; <span class="id">D</span>.<br/>
<span class="id">intro</span> <span class="id">D</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> (<span class="id">f</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id">D</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">f</span>); <span class="id">red</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">c</span>))<br/>
<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">c</span>) ==&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">c</span>)<br/>
<span class="kwd">as</span> <span class="id">lub_eq_compat</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">lub_eq_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_cte">lub_cte</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">c</span>:<span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> <span class="id">c</span>) == <span class="id">c</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#le_lub">le_lub</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> <span class="id">c</span>) (<span class="id">n</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">lub_cte</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_lift_right">lub_lift_right</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">D</span>) <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">f</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_right">mseq_lift_right</a></span> <span class="id">f</span> <span class="id">n</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">intro</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_right">mseq_lift_right</a></span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">lub_lift_right</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_lift_left">lub_lift_left</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">D</span>) <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">f</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_left">mseq_lift_left</a></span> <span class="id">f</span> <span class="id">n</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">intro</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_left">mseq_lift_left</a></span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">lub_lift_left</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_le_lift">lub_le_lift</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">D</span>) (<span class="id">n</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id">n</span> &lt;= <span class="id">k</span> -&gt; <span class="id">f</span> <span class="id">k</span> &lt;= <span class="id">g</span> <span class="id">k</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">f</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">g</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> (<span class="id">n</span>+<span class="id">n0</span>)).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>); <span class="id">simpl</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">g</span> (<span class="id">n</span>+<span class="id">n0</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id">H</span>; <span class="id">simpl</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_eq_lift">lub_eq_lift</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">D</span>) (<span class="id">n</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id">n</span> &lt;= <span class="id">k</span> -&gt; <span class="id">f</span> <span class="id">k</span> == <span class="id">g</span> <span class="id">k</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">f</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">g</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_lift">lub_le_lift</a></span> <span class="kwd">with</span> <span class="id">n</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_le_sym">Oeq_le_sym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<div class="doc">- (lub_fun h) x = lub_n (h n x) </div>
<span class="kwd">Definition</span> <span class="id"><a name="lub_fun">lub_fun</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">h</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">O</span> -<span class="id">m</span>&gt; <span class="id">D</span>), <span class="id">O</span> -<span class="id">m</span>&gt; <span class="id">D</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">h</span> &lt;_&gt; <span class="id">m</span>)).<br/>
<span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id">h</span> <span class="id">x0</span>)); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_fun_eq">lub_fun_eq</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">h</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">O</span> -<span class="id">m</span>&gt; <span class="id">D</span>) (<span class="id">x</span>:<span class="id">O</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_fun">lub_fun</a></span> <span class="id">h</span> <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">h</span> &lt;_&gt; <span class="id">x</span>).<br/>
<span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_fun_shift">lub_fun_shift</a></span> :  <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">h</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt;  <span class="id">D</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_fun">lub_fun</a></span> <span class="id">h</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Lub">Lub</a></span> <span class="id">D</span> @ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_shift">fmon_shift</a></span> <span class="id">h</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_eq_intro">fmon_eq_intro</a></span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_fun">lub_fun</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="double_lub_simpl">double_lub_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">h</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt;  <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Lub">Lub</a></span> <span class="id">D</span> @ <span class="id">h</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_diag">fmon_diag</a></span> <span class="id">h</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>; <span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">h</span> <span class="id">n</span> (<span class="id">n</span>+<span class="id">n0</span>)).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id">h</span> <span class="id">n</span>)); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">h</span> (<span class="id">n</span>+<span class="id">n0</span>) (<span class="id">n</span>+<span class="id">n0</span>)).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">h</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#le_lub">le_lub</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_diag">fmon_diag</a></span> <span class="id">h</span>) (<span class="id">n</span>:=(<span class="id">n</span> + <span class="id">n0</span>)%<span class="id">nat</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_diag">fmon_diag</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_exch_le">lub_exch_le</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">h</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt;  <span class="id">D</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Lub">Lub</a></span> <span class="id">D</span> @ <span class="id">h</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_fun">lub_fun</a></span> <span class="id">h</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>; <span class="id">intros</span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">h</span> <span class="id">n</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">intro</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_fun">lub_fun</a></span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#le_lub">le_lub</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id">h</span> &lt;_&gt; <span class="id">x</span>) (<span class="id">n</span>:=<span class="id">n</span>).<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">lub_exch_le</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_exch_eq">lub_exch_eq</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">h</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt;  <span class="id">D</span>)),<br/>
&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Lub">Lub</a></span> <span class="id">D</span> @ <span class="id">h</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_fun">lub_fun</a></span> <span class="id">h</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">lub_exch_eq</span> : <span class="id">core</span>.<br/>
<br/>
<h3> Functional cpos </h3>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcpo">fcpo</a></span> : <span class="kwd">Type</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>.<br/>
<span class="id">intros</span> <span class="id">A</span> <span class="id">D</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford">ford</a></span> <span class="id">A</span> <span class="id">D</span>)  (<span class="kwd">fun</span> <span class="id">x</span>:<span class="id">A</span> =&gt; (0:<span class="id">D</span>)) (<span class="kwd">fun</span> <span class="id">f</span> (<span class="id">x</span>:<span class="id">A</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span>(<span class="id">c</span>:=<span class="id">D</span>) (<span class="id">f</span> &lt;<span class="id">o</span>&gt; <span class="id">x</span>)); <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">intro</span> <span class="id">x</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> ((<span class="id">f</span> &lt;<span class="id">o</span>&gt; <span class="id">x</span>) <span class="id">n</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<div class="doc">printing -O-&gt; %\ensuremath{\stackrel{O}{\longleftarrow}}% </div>
<span class="kwd">Infix</span> <span class="string">"-O-&gt;"</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcpo">fcpo</a></span> (<span class="id">right</span> <span class="id">associativity</span>, <span class="kwd">at</span> <span class="id">level</span> 30) : <span class="id">O_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcpo_lub_simpl">fcpo_lub_simpl</a></span> : <span class="kwd">forall</span> <span class="id">A</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">h</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt; <span class="id">A</span>-<span class="id">O</span>-&gt;<span class="id">D</span>)(<span class="id">x</span>:<span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span>(<span class="id">c</span>:=<span class="id">D</span>) (<span class="id">h</span> &lt;<span class="id">o</span>&gt; <span class="id">x</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<h2> Continuity </h2>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_comp_le">lub_comp_le</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D1</span> -<span class="id">m</span>&gt; <span class="id">D2</span>) (<span class="id">h</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">D1</span>),  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">f</span> @ <span class="id">h</span>) &lt;= <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">lub_comp_le</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_comp2_le">lub_comp2_le</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">F</span>:<span class="id">D1</span> -<span class="id">m</span>&gt; <span class="id">D2</span>-<span class="id">m</span>&gt;<span class="id">D3</span>) (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">D1</span>) (<span class="id">g</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> ((<span class="id">F</span> @2 <span class="id">f</span>) <span class="id">g</span>) &lt;= <span class="id">F</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">f</span>)  (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">g</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">lub_comp2_le</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="continuous">continuous</a></span> (<span class="id">D1</span> <span class="id">D2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D1</span> -<span class="id">m</span>&gt; <span class="id">D2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">forall</span> <span class="id">h</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">D1</span>,  <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">f</span> @ <span class="id">h</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous_eq_compat">continuous_eq_compat</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id">D1</span> -<span class="id">m</span>&gt; <span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span>==<span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> <span class="id">f</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> <span class="id">g</span>.<br/>
<span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>)).<br/>
<span class="id">assert</span> (<span class="id">g</span> &lt;= <span class="id">f</span>); <span class="id">auto</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id">H</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">D1</span> <span class="id">D2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">D1</span>:=<span class="id">D1</span>) (<span class="id">D2</span>:=<span class="id">D2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">D1</span> -<span class="id">m</span>&gt; <span class="id">D2</span>) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span><br/>
<span class="kwd">as</span> <span class="id">continuous_eq_compat_iff</span>.<br/>
<span class="id">split</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous_eq_compat">continuous_eq_compat</a></span> <span class="kwd">with</span> <span class="id">x</span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous_eq_compat">continuous_eq_compat</a></span> <span class="kwd">with</span> <span class="id">y</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_comp_eq">lub_comp_eq</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D1</span> -<span class="id">m</span>&gt; <span class="id">D2</span>) (<span class="id">h</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">D1</span>),  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> <span class="id">f</span> -&gt; <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">f</span> @ <span class="id">h</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">lub_comp_eq</span> : <span class="id">core</span>.<br/>
<br/>
<br/>
<div class="doc">- mon0 x == 0 </div>
<span class="kwd">Definition</span> <span class="id"><a name="mon0">mon0</a></span> (<span class="id">O1</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">D2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : <span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">D2</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="id">O1</span> (0:<span class="id">D2</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cont0">cont0</a></span> : <span class="kwd">forall</span> {<span class="id">D1</span> <span class="id">D2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>}, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mon0">mon0</a></span> <span class="id">D1</span> <span class="id">D2</span>).<br/>
<span class="id">red</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<div class="doc">- double_app f g n m = f m (g n) </div>
<span class="kwd">Definition</span> <span class="id"><a name="double_app">double_app</a></span> (<span class="id">O1</span> <span class="id">O2</span> <span class="id">O3</span> <span class="id">O4</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">f</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O3</span> -<span class="id">m</span>&gt; <span class="id">O4</span>) (<span class="id">g</span>:<span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">O2</span> -<span class="id">m</span>&gt; (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O4</span>) := (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_shift">fmon_shift</a></span> <span class="id">f</span>) @ <span class="id">g</span>.<br/>
<br/>
<h2> Cpo of monotonic functions </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fmon_cpo">fmon_cpo</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon">fmon</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mon0">mon0</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_fun">lub_fun</a></span> (<span class="id">O</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>) (<span class="id">D</span>:=<span class="id">D</span>)); <span class="id">auto</span>.<br/>
<span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#le_lub">le_lub</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_app">fmon_app</a></span> <span class="id">f</span> <span class="id">x</span>) (<span class="id">n</span>:=<span class="id">n</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<div class="doc">printing -M-&gt; %\ensuremath{\stackrel{M}{\longleftarrow}}% </div>
<span class="kwd">Infix</span> <span class="string">"-M-&gt;"</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cpo">fmon_cpo</a></span> (<span class="kwd">at</span> <span class="id">level</span> 30, <span class="id">right</span> <span class="id">associativity</span>) : <span class="id">O_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fmon_lub_simpl">fmon_lub_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">h</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id">O</span>-<span class="id">M</span>-&gt;<span class="id">D</span>) (<span class="id">x</span>:<span class="id">O</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">h</span> &lt;_&gt; <span class="id">x</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="double_lub_diag">double_lub_diag</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">h</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">M</span>-&gt;<span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_diag">fmon_diag</a></span> <span class="id">h</span>).<br/>
<span class="id">intros</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>; <span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>; <span class="id">intros</span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">h</span> (<span class="id">n</span>+<span class="id">n0</span>) (<span class="id">n</span>+<span class="id">n0</span>)); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#le_lub">le_lub</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_diag">fmon_diag</a></span> <span class="id">h</span>) (<span class="id">n</span>:=(<span class="id">n</span> + <span class="id">n0</span>)%<span class="id">nat</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_diag">fmon_diag</a></span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#le_lub">le_lub</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id">h</span> &lt;_&gt; <span class="id">x</span>) (<span class="id">n</span>:=<span class="id">x</span>).<br/>
Qed.
<br/>
<br/>
<br/>
<br/>
<h3> Continuity </h3>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="continuous2">continuous2</a></span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">F</span>:<span class="id">D1</span> -<span class="id">m</span>&gt; <span class="id">D2</span> -<span class="id">m</span>&gt; <span class="id">D3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">forall</span> (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id">D1</span>) (<span class="id">g</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id">D2</span>), <span class="id">F</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">f</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">g</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> ((<span class="id">F</span> @2 <span class="id">f</span>) <span class="id">g</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous2_app">continuous2_app</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">F</span> : <span class="id">D1</span>-<span class="id">m</span>&gt;<span class="id">D2</span>-<span class="id">m</span>&gt;<span class="id">D3</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2">continuous2</a></span> <span class="id">F</span> -&gt; <span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">F</span> <span class="id">k</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">F</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_cte">mseq_cte</a></span> <span class="id">k</span>))  (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> ((<span class="id">F</span> @2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_cte">mseq_cte</a></span> <span class="id">k</span>)) <span class="id">h</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous2_continuous">continuous2_continuous</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">F</span> : <span class="id">D1</span>-<span class="id">m</span>&gt;<span class="id">D2</span>-<span class="id">M</span>-&gt;<span class="id">D3</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2">continuous2</a></span> <span class="id">F</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> <span class="id">F</span>.<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">intro</span> <span class="id">k</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">F</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_cte">mseq_cte</a></span> <span class="id">k</span>)) ); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> ((<span class="id">F</span> @2 <span class="id">h</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_cte">mseq_cte</a></span> <span class="id">k</span>))); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous2_left">continuous2_left</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">F</span> : <span class="id">D1</span>-<span class="id">m</span>&gt;<span class="id">D2</span>-<span class="id">M</span>-&gt;<span class="id">D3</span>) (<span class="id">h</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id">D1</span>) (<span class="id">x</span>:<span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2">continuous2</a></span> <span class="id">F</span> -&gt; <span class="id">F</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) <span class="id">x</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> ((<span class="id">F</span> &lt;_&gt; <span class="id">x</span>) @<span class="id">h</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2_continuous">continuous2_continuous</a></span> <span class="id">H</span> <span class="id">h</span> <span class="id">x</span>).<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous2_right">continuous2_right</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">F</span> : <span class="id">D1</span>-<span class="id">m</span>&gt;<span class="id">D2</span>-<span class="id">M</span>-&gt;<span class="id">D3</span>) (<span class="id">x</span>:<span class="id">D1</span>)(<span class="id">h</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2">continuous2</a></span> <span class="id">F</span> -&gt; <span class="id">F</span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">F</span> <span class="id">x</span> @<span class="id">h</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2_app">continuous2_app</a></span> <span class="id">H</span> <span class="id">x</span>).<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous_continuous2">continuous_continuous2</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">F</span> : <span class="id">D1</span>-<span class="id">m</span>&gt;<span class="id">D2</span>-<span class="id">M</span>-&gt;<span class="id">D3</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>:<span class="id">D1</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">F</span> <span class="id">k</span>)) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> <span class="id">F</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2">continuous2</a></span> <span class="id">F</span>.<br/>
<span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">F</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">f</span>) @ <span class="id">g</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> ((<span class="id">F</span> &lt;_&gt; (<span class="id">g</span> <span class="id">n</span>))@<span class="id">f</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">D2</span> -<span class="id">M</span>-&gt; <span class="id">D3</span>) (<span class="id">F</span>@<span class="id">f</span>) (<span class="id">g</span> <span class="id">n</span>)); <span class="id">auto</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_lift_right">lub_lift_right</a></span> ((<span class="id">F</span> @2 <span class="id">f</span>) <span class="id">g</span>) <span class="id">n</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">F</span> (<span class="id">f</span> <span class="id">x</span>) (<span class="id">g</span> (<span class="id">x</span>+<span class="id">n</span>))); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">continuous2_app</span> <span class="id">continuous2_continuous</span> <span class="id">continuous_continuous2</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_comp2_eq">lub_comp2_eq</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">F</span> : <span class="id">D1</span> -<span class="id">m</span>&gt; <span class="id">D2</span> -<span class="id">M</span>-&gt; <span class="id">D3</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>:<span class="id">D1</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">F</span> <span class="id">k</span>)) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> <span class="id">F</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id">D1</span>) (<span class="id">g</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">F</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">f</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">g</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> ((<span class="id">F</span>@2 <span class="id">f</span>) <span class="id">g</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous_continuous2">continuous_continuous2</a></span> (<span class="id">F</span>:=<span class="id">F</span>)); <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_cont2_comp2_eq">lub_cont2_comp2_eq</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">F</span> : <span class="id">D1</span> -<span class="id">m</span>&gt; <span class="id">D2</span> -<span class="id">M</span>-&gt; <span class="id">D3</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2">continuous2</a></span> <span class="id">F</span> -&gt; <span class="kwd">forall</span> (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id">D1</span>) (<span class="id">g</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id">D2</span>), <span class="id">F</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">f</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">g</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> ((<span class="id">F</span>@2 <span class="id">f</span>) <span class="id">g</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_comp2_eq">lub_comp2_eq</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous_sym">continuous_sym</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">F</span> : <span class="id">D1</span>-<span class="id">m</span>&gt; <span class="id">D1</span> -<span class="id">M</span>-&gt; <span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">F</span> <span class="id">x</span> <span class="id">y</span> == <span class="id">F</span> <span class="id">y</span> <span class="id">x</span>) -&gt; (<span class="kwd">forall</span> <span class="id">k</span>:<span class="id">D1</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">F</span> <span class="id">k</span>)) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> <span class="id">F</span>.<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">intro</span> <span class="id">k</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">F</span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> ((<span class="id">F</span> <span class="id">k</span>) @ <span class="id">h</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous2_sym">continuous2_sym</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">F</span> : <span class="id">D1</span>-<span class="id">m</span>&gt;<span class="id">D1</span>-<span class="id">m</span>&gt;<span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">F</span> <span class="id">x</span> <span class="id">y</span> == <span class="id">F</span> <span class="id">y</span> <span class="id">x</span>) -&gt; (<span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">F</span> <span class="id">k</span>)) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2">continuous2</a></span> <span class="id">F</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous_continuous2">continuous_continuous2</a></span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous_sym">continuous_sym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">continuous2_sym</span> : <span class="id">core</span>.<br/>
<br/>
<div class="doc">- continuity is preserved by composition </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous_comp">continuous_comp</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D2</span>-<span class="id">m</span>&gt;<span class="id">D3</span>)(<span class="id">g</span>:<span class="id">D1</span>-<span class="id">m</span>&gt;<span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> <span class="id">f</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> <span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">f</span>@<span class="id">g</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_simpl">fmon_comp_simpl</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">g</span>@<span class="id">h</span>))); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">continuous_comp</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous2_comp">continuous2_comp</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D1</span>-<span class="id">m</span>&gt;<span class="id">D2</span>)(<span class="id">g</span>:<span class="id">D2</span>-<span class="id">m</span>&gt;<span class="id">D3</span>-<span class="id">M</span>-&gt;<span class="id">D4</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> <span class="id">f</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2">continuous2</a></span> <span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2">continuous2</a></span> (<span class="id">g</span> @ <span class="id">f</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous_continuous2">continuous_continuous2</a></span>; <span class="id">auto</span>.<br/>
<span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_simpl">fmon_comp_simpl</a></span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2_right">continuous2_right</a></span> (<span class="id">F</span>:=<span class="id">g</span>) (<span class="id">f</span> <span class="id">k</span>) <span class="id">h</span>); <span class="id">trivial</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">continuous2_comp</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous2_comp2">continuous2_comp2</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D3</span>-<span class="id">m</span>&gt;<span class="id">D4</span>)(<span class="id">g</span>:<span class="id">D1</span>-<span class="id">m</span>&gt;<span class="id">D2</span>-<span class="id">M</span>-&gt;<span class="id">D3</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> <span class="id">f</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2">continuous2</a></span> <span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2">continuous2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcomp2">fcomp2</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span> <span class="id">f</span> <span class="id">g</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcomp2_simpl">fcomp2_simpl</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> ((<span class="id">g</span>@2 <span class="id">f0</span>) <span class="id">g0</span>))); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">f</span>@((<span class="id">g</span>@2 <span class="id">f0</span>) <span class="id">g0</span>))); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">continuous2_comp2</span> : <span class="id">core</span>.<br/>
<br/>
<h2> Cpo of continuous functions </h2>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cont_lub">cont_lub</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; (<span class="id">D1</span> -<span class="id">m</span>&gt; <span class="id">D2</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">f</span> <span class="id">n</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span>  (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">D1</span>-<span class="id">M</span>-&gt;<span class="id">D2</span>) <span class="id">f</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">D2</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Lub">Lub</a></span> <span class="id">D2</span> @ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_shift">fmon_shift</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#double_app">double_app</a></span> <span class="id">f</span> <span class="id">h</span>)))).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">intro</span> <span class="id">n</span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> ((<span class="id">f</span> <span class="id">n</span>) @ <span class="id">h</span>)); <span class="id">auto</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_exch_eq">lub_exch_eq</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">intro</span> <span class="id">n</span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">intro</span> <span class="id">m</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="fconti">fconti</a></span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>): <span class="kwd">Type</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">mk_fconti</span> {<span class="id"><a name="fcontit">fcontit</a></span> : <span class="id">D1</span> -<span class="id">m</span>&gt; <span class="id">D2</span>; <span class="id"><a name="fcontinuous">fcontinuous</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> <span class="id">fcontit</span>}.<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fcontinuous</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fconti_fun">fconti_fun</a></span> (<span class="id">D1</span> <span class="id">D2</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fconti">fconti</a></span> <span class="id">D1</span> <span class="id">D2</span>) : <span class="id">D1</span>-&gt; <span class="id">D2</span> :=<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span> <span class="id">x</span>.<br/>
<span class="kwd">Coercion</span> <span class="id">fconti_fun</span> : <span class="id">fconti</span> &gt;-&gt; <span class="id">Funclass</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcont_ord">fcont_ord</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>.<br/>
<span class="id">intros</span> <span class="id">D1</span> <span class="id">D2</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fconti">fconti</a></span> <span class="id">D1</span> <span class="id">D2</span>) (<span class="kwd">fun</span> (<span class="id">f</span> <span class="id">g</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fconti">fconti</a></span> <span class="id">D1</span> <span class="id">D2</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">g</span>); <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">y</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<div class="doc">printing -c-&gt; %\ensuremath{\stackrel{c}{\leftarrow}}% </div>
<span class="kwd">Infix</span> <span class="string">"-c&gt;"</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_ord">fcont_ord</a></span> (<span class="kwd">at</span> <span class="id">level</span> 30, <span class="id">right</span> <span class="id">associativity</span>) : <span class="id">O_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_le_intro">fcont_le_intro</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D2</span>), (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">f</span> <span class="id">x</span> &lt;= <span class="id">g</span> <span class="id">x</span>) -&gt; <span class="id">f</span> &lt;= <span class="id">g</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_le_elim">fcont_le_elim</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D2</span>), <span class="id">f</span> &lt;= <span class="id">g</span> -&gt; <span class="kwd">forall</span> <span class="id">x</span>, <span class="id">f</span> <span class="id">x</span> &lt;= <span class="id">g</span> <span class="id">x</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_eq_intro">fcont_eq_intro</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D2</span>), (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">f</span> <span class="id">x</span> == <span class="id">g</span> <span class="id">x</span>) -&gt; <span class="id">f</span> == <span class="id">g</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_le_intro">fcont_le_intro</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_eq_elim">fcont_eq_elim</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D2</span>), <span class="id">f</span> == <span class="id">g</span> -&gt; <span class="kwd">forall</span> <span class="id">x</span>, <span class="id">f</span> <span class="id">x</span> == <span class="id">g</span> <span class="id">x</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_le_elim">fcont_le_elim</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_monotonic">fcont_monotonic</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> : <span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D2</span>) (<span class="id">x</span> <span class="id">y</span> : <span class="id">D1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> &lt;= <span class="id">y</span> -&gt; <span class="id">f</span> <span class="id">x</span> &lt;= <span class="id">f</span> <span class="id">y</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span>) <span class="id">H</span>).<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fcont_monotonic</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_stable">fcont_stable</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> : <span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D2</span>) (<span class="id">x</span> <span class="id">y</span> : <span class="id">D1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> == <span class="id">y</span> -&gt; <span class="id">f</span> <span class="id">x</span> == <span class="id">f</span> <span class="id">y</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_stable">fmon_stable</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span>) <span class="id">H</span>).<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fcont_monotonic</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcont0">fcont0</a></span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : <span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D2</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mk_fconti">mk_fconti</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cont0">cont0</a></span> <span class="id">D1</span> <span class="id">D2</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Fcontit">Fcontit</a></span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : (<span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D2</span>) -<span class="id">m</span>&gt; <span class="id">D1</span>-<span class="id">m</span>&gt; <span class="id">D2</span>.<br/>
<span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id">D1</span>:=<span class="id">D1</span>) (<span class="id">D2</span>:=<span class="id">D2</span>)); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcont_lub">fcont_lub</a></span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D2</span>) -&gt; <span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D2</span>.<br/>
<span class="id">intro</span> <span class="id">f</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">D1</span>-<span class="id">M</span>-&gt;<span class="id">D2</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D1</span> <span class="id">D2</span> @<span class="id">f</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cont_lub">cont_lub</a></span>; <span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcont_cpo">fcont_cpo</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>.<br/>
<span class="id">intros</span> <span class="id">D1</span> <span class="id">D2</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_ord">fcont_ord</a></span> <span class="id">D1</span> <span class="id">D2</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont0">fcont0</a></span> <span class="id">D1</span> <span class="id">D2</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_lub">fcont_lub</a></span> (<span class="id">D1</span>:=<span class="id">D1</span>) (<span class="id">D2</span>:=<span class="id">D2</span>));<br/>
<span class="id">simpl</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#le_lub">le_lub</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D1</span> <span class="id">D2</span> @ <span class="id">f</span>) &lt;_&gt; <span class="id">x</span>) (<span class="id">n</span>:=<span class="id">n</span>).<br/>
Defined.
<br/>
<div class="doc">printing -C-&gt; %\ensuremath{\stackrel{C}{\longleftarrow}}% </div>
<span class="kwd">Infix</span> <span class="string">"-C-&gt;"</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_cpo">fcont_cpo</a></span> (<span class="kwd">at</span> <span class="id">level</span> 30, <span class="id">right</span> <span class="id">associativity</span>) : <span class="id">O_scope</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcont_app">fcont_app</a></span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>: <span class="id">O</span> -<span class="id">m</span>&gt; <span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>) (<span class="id">x</span>:<span class="id">D1</span>) : <span class="id">O</span> -<span class="id">m</span>&gt; <span class="id">D2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D1</span> <span class="id">D2</span> @ <span class="id">f</span> &lt;_&gt; <span class="id">x</span>.<br/>
<br/>
<div class="doc">printing &lt;__&gt; %\ensuremath{\Longleftrightarrow}%</div>
<span class="kwd">Infix</span> <span class="string">"&lt;__&gt;"</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_app">fcont_app</a></span> (<span class="kwd">at</span> <span class="id">level</span> 70) : <span class="id">O_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_app_simpl">fcont_app_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>: <span class="id">O</span> -<span class="id">m</span>&gt; <span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>) (<span class="id">x</span>:<span class="id">D1</span>)(<span class="id">y</span>:<span class="id">O</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> &lt;<span class="id">__</span>&gt; <span class="id">x</span>) <span class="id">y</span> = <span class="id">f</span> <span class="id">y</span> <span class="id">x</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ford_fcont_shift">ford_fcont_shift</a></span> (<span class="id">A</span>:<span class="kwd">Type</span>) (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>: <span class="id">A</span> -<span class="id">o</span>&gt; (<span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>)) : <span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">A</span> -<span class="id">O</span>-&gt; <span class="id">D2</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_shift">ford_shift</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D1</span> <span class="id">D2</span> (<span class="id">f</span> <span class="id">x</span>))).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
<span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id">f</span> <span class="id">x</span>) @ <span class="id">h</span>)); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fmon_fcont_shift">fmon_fcont_shift</a></span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>: <span class="id">O</span> -<span class="id">m</span>&gt; <span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>) : <span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">O</span> -<span class="id">M</span>-&gt; <span class="id">D2</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_shift">fmon_shift</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D1</span> <span class="id">D2</span>@<span class="id">f</span>)).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
<span class="id">simpl</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontinuous">fcontinuous</a></span> (<span class="id">f</span> <span class="id">x</span>) <span class="id">h</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_app_continuous">fcont_app_continuous</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>: <span class="id">O</span> -<span class="id">m</span>&gt; <span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>) (<span class="id">h</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id">D1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> &lt;<span class="id">__</span>&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">O</span>-<span class="id">M</span>-&gt;<span class="id">D2</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_fcont_shift">fmon_fcont_shift</a></span> <span class="id">f</span>) @ <span class="id">h</span>).<br/>
<span class="id">intros</span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_app_simpl">fcont_app_simpl</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontinuous">fcontinuous</a></span> (<span class="id">f</span> <span class="id">x</span>) <span class="id">h</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_lub_simpl">fcont_lub_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">h</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id">D1</span>-<span class="id">C</span>-&gt;<span class="id">D2</span>)(<span class="id">x</span>:<span class="id">D1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span> <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">h</span> &lt;<span class="id">__</span>&gt; <span class="id">x</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="continuous2_cont_app">continuous2_cont_app</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D1</span>-<span class="id">m</span>&gt; <span class="id">D2</span> -<span class="id">M</span>-&gt; <span class="id">D3</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">f</span> <span class="id">k</span>)) -&gt; <span class="id">D1</span> -<span class="id">m</span>&gt; (<span class="id">D2</span> -<span class="id">C</span>-&gt; <span class="id">D3</span>).<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mk_fconti">mk_fconti</a></span> (<span class="id">H</span> <span class="id">k</span>)); <span class="id">red</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous2_cont_app_simpl">continuous2_cont_app_simpl</a></span> :<br/>
<span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D1</span>-<span class="id">m</span>&gt; <span class="id">D2</span> -<span class="id">M</span>-&gt; <span class="id">D3</span>)(<span class="id">H</span>:<span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">f</span> <span class="id">k</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span>:<span class="id">D1</span>),  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2_cont_app">continuous2_cont_app</a></span> <span class="id">H</span> <span class="id">k</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mk_fconti">mk_fconti</a></span> (<span class="id">H</span> <span class="id">k</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous2_cont">continuous2_cont</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D1</span>-<span class="id">m</span>&gt; <span class="id">D2</span> -<span class="id">M</span>-&gt; <span class="id">D3</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2">continuous2</a></span> <span class="id">f</span> -&gt; <span class="id">D1</span> -<span class="id">c</span>&gt; (<span class="id">D2</span> -<span class="id">C</span>-&gt; <span class="id">D3</span>).<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2_cont_app">continuous2_cont_app</a></span> (<span class="id">f</span>:=<span class="id">f</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2_app">continuous2_app</a></span> <span class="id">H</span>)).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2_cont_app_simpl">continuous2_cont_app_simpl</a></span>; <span class="id">intro</span> <span class="id">k</span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">D2</span>-<span class="id">M</span>-&gt;<span class="id">D3</span>) (<span class="id">f</span>@<span class="id">h</span>) <span class="id">k</span>); <span class="id">auto</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> <span class="id">f</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Fcontit_cont">Fcontit_cont</a></span> : <span class="kwd">forall</span> <span class="id">D1</span> <span class="id">D2</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">D1</span>:=<span class="id">D1</span>-<span class="id">C</span>-&gt;<span class="id">D2</span>) (<span class="id">D2</span>:=<span class="id">D1</span>-<span class="id">M</span>-&gt;<span class="id">D2</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D1</span> <span class="id">D2</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Fcontit_cont</span> : <span class="id">core</span>.<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcont_comp">fcont_comp</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>), (<span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span>) -&gt; (<span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>) -&gt; <span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D3</span>.<br/>
<span class="id">intros</span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">f</span> <span class="id">g</span>.<br/>
<span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span> @ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">g</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Infix</span> <span class="string">"@_"</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp">fcont_comp</a></span> (<span class="kwd">at</span> <span class="id">level</span> 35) : <span class="id">O_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_comp_simpl">fcont_comp_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">f</span>:<span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span>)(<span class="id">g</span>:<span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>) (<span class="id">x</span>:<span class="id">D1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> @_ <span class="id">g</span>) <span class="id">x</span> = <span class="id">f</span> (<span class="id">g</span> <span class="id">x</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcontit_comp_simpl">fcontit_comp_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">f</span>:<span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span>)(<span class="id">g</span>:<span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>) (<span class="id">x</span>:<span class="id">D1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id">f</span> @_ <span class="id">g</span>) = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span> @ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">g</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_comp_le_compat">fcont_comp_le_compat</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span>) (<span class="id">k</span> <span class="id">l</span> :<span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> &lt;= <span class="id">g</span> -&gt; <span class="id">k</span> &lt;= <span class="id">l</span> -&gt; <span class="id">f</span> @_ <span class="id">k</span> &lt;= <span class="id">g</span> @_ <span class="id">l</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_le_intro">fcont_le_intro</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
<span class="id">repeat</span> (<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">g</span> (<span class="id">k</span> <span class="id">x</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fcont_comp_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp">fcont_comp</a></span> (<span class="id">D1</span>:=<span class="id">D1</span>) (<span class="id">D2</span>:=<span class="id">D2</span>) (<span class="id">D3</span>:=<span class="id">D3</span>))<br/>
<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id">o</span>:=<span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span>) ++&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id">o</span>:=<span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>) ++&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id">o</span>:=<span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D3</span>)<br/>
<span class="kwd">as</span> <span class="id">fcont_comp_le_morph</span>.<br/>
<span class="id">intros</span>.<br/>
<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_le_compat">fcont_comp_le_compat</a></span> <span class="id">H</span> <span class="id">H0</span>).<br/>
Qed.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp">fcont_comp</a></span> (<span class="id">D1</span>:=<span class="id">D1</span>) (<span class="id">D2</span>:=<span class="id">D2</span>) (<span class="id">D3</span>:=<span class="id">D3</span>))<br/>
<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span>) ==&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>) ==&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D3</span>)<br/>
<span class="kwd">as</span> <span class="id">fcont_comp_eq_compat</span>.<br/>
<span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcont_Comp">fcont_Comp</a></span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : (<span class="id">D2</span> -<span class="id">C</span>-&gt; <span class="id">D3</span>) -<span class="id">m</span>&gt; (<span class="id">D1</span>-<span class="id">C</span>-&gt; <span class="id">D2</span>) -<span class="id">m</span>&gt; <span class="id">D1</span> -<span class="id">C</span>-&gt; <span class="id">D3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#le_compat2_mon">le_compat2_mon</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_le_compat">fcont_comp_le_compat</a></span> (<span class="id">D1</span>:=<span class="id">D1</span>) (<span class="id">D2</span>:=<span class="id">D2</span>) (<span class="id">D3</span>:=<span class="id">D3</span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_Comp_simpl">fcont_Comp_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span>) (<span class="id">g</span>:<span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_Comp">fcont_Comp</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">f</span> <span class="id">g</span> = <span class="id">f</span> @_ <span class="id">g</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_Comp_continuous2">fcont_Comp_continuous2</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2">continuous2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_Comp">fcont_Comp</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">change</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span>  <span class="id">f</span>) @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">g</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">D1</span> -<span class="id">C</span>-&gt; <span class="id">D3</span>) ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_Comp">fcont_Comp</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> @2 <span class="id">f</span>) <span class="id">g</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_le_intro">fcont_le_intro</a></span>; <span class="id">intro</span> <span class="id">x</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>.<br/>
<span class="id">repeat</span> (<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_lub_simpl">fcont_lub_simpl</a></span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_app_continuous">fcont_app_continuous</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#double_lub_diag">double_lub_diag</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcont_COMP">fcont_COMP</a></span>  (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : (<span class="id">D2</span> -<span class="id">C</span>-&gt; <span class="id">D3</span>) -<span class="id">c</span>&gt; (<span class="id">D1</span>-<span class="id">C</span>-&gt; <span class="id">D2</span>) -<span class="id">C</span>-&gt; <span class="id">D1</span> -<span class="id">C</span>-&gt; <span class="id">D3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2_cont">continuous2_cont</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_Comp_continuous2">fcont_Comp_continuous2</a></span> (<span class="id">D1</span>:=<span class="id">D1</span>) (<span class="id">D2</span>:=<span class="id">D2</span>) (<span class="id">D3</span>:=<span class="id">D3</span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_COMP_simpl">fcont_COMP_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>: <span class="id">D2</span> -<span class="id">C</span>-&gt; <span class="id">D3</span>) (<span class="id">g</span>:<span class="id">D1</span>-<span class="id">C</span>-&gt; <span class="id">D2</span>),<br/>
&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_COMP">fcont_COMP</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">f</span> <span class="id">g</span> = <span class="id">f</span> @_ <span class="id">g</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcont2_COMP">fcont2_COMP</a></span>  (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : (<span class="id">D3</span> -<span class="id">C</span>-&gt; <span class="id">D4</span>) -<span class="id">c</span>&gt; (<span class="id">D1</span>-<span class="id">C</span>-&gt; <span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>) -<span class="id">C</span>-&gt; <span class="id">D1</span> -<span class="id">C</span>-&gt; <span class="id">D2</span> -<span class="id">C</span>-&gt; <span class="id">D4</span> :=<br/>
&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_COMP">fcont_COMP</a></span> <span class="id">D1</span> (<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>) (<span class="id">D2</span> -<span class="id">C</span>-&gt; <span class="id">D4</span>)) @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_COMP">fcont_COMP</a></span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcont2_comp">fcont2_comp</a></span>  (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D3</span> -<span class="id">C</span>-&gt; <span class="id">D4</span>)(<span class="id">F</span>:<span class="id">D1</span>-<span class="id">C</span>-&gt; <span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont2_COMP">fcont2_COMP</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span> <span class="id">f</span> <span class="id">F</span>.<br/>
<br/>
<span class="kwd">Infix</span> <span class="string">"@@_"</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont2_comp">fcont2_comp</a></span> (<span class="kwd">at</span> <span class="id">level</span> 35) : <span class="id">O_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont2_comp_simpl">fcont2_comp_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D3</span> -<span class="id">C</span>-&gt; <span class="id">D4</span>)(<span class="id">F</span>:<span class="id">D1</span>-<span class="id">C</span>-&gt; <span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>)(<span class="id">x</span>:<span class="id">D1</span>)(<span class="id">y</span>:<span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> @@_ <span class="id">F</span>) <span class="id">x</span> <span class="id">y</span> = <span class="id">f</span> (<span class="id">F</span> <span class="id">x</span> <span class="id">y</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_le_compat2">fcont_le_compat2</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> : <span class="id">D1</span>-<span class="id">c</span>&gt;<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span> <span class="id">y</span> : <span class="id">D1</span>) (<span class="id">z</span> <span class="id">t</span> : <span class="id">D2</span>), <span class="id">x</span> &lt;= <span class="id">y</span> -&gt; <span class="id">z</span> &lt;= <span class="id">t</span> -&gt; <span class="id">f</span> <span class="id">x</span> <span class="id">z</span> &lt;= <span class="id">f</span> <span class="id">y</span> <span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> <span class="id">y</span> <span class="id">z</span>); <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fconti_fun">fconti_fun</a></span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_le_elim">fmon_le_elim</a></span>.<br/>
<span class="id">apply</span>  (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D2</span> <span class="id">D3</span>) (<span class="id">x</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span> <span class="id">x</span>) (<span class="id">y</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span> <span class="id">y</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fcont_le_compat2</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_eq_compat2">fcont_eq_compat2</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> : <span class="id">D1</span>-<span class="id">c</span>&gt;<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span> <span class="id">y</span> : <span class="id">D1</span>) (<span class="id">z</span> <span class="id">t</span> : <span class="id">D2</span>), <span class="id">x</span> == <span class="id">y</span> -&gt; <span class="id">z</span> == <span class="id">t</span> -&gt; <span class="id">f</span> <span class="id">x</span> <span class="id">z</span> == <span class="id">f</span> <span class="id">y</span> <span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fcont_eq_compat2</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_continuous">fcont_continuous</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D2</span>)(<span class="id">h</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id">D1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span> @ <span class="id">h</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontinuous">fcontinuous</a></span> <span class="id">f</span> <span class="id">h</span>).<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fcont_continuous</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_continuous2">fcont_continuous2</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D1</span>-<span class="id">c</span>&gt;(<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2">continuous2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D2</span> <span class="id">D3</span> @ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous_continuous2">continuous_continuous2</a></span>; <span class="id">intros</span>.<br/>
<span class="id">change</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id">f</span> <span class="id">k</span>))); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous_comp">continuous_comp</a></span> (<span class="id">D1</span>:=<span class="id">D1</span>) (<span class="id">D2</span>:=<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>) (<span class="id">D3</span>:=<span class="id">D2</span>-<span class="id">M</span>-&gt;<span class="id">D3</span>) (<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D2</span> <span class="id">D3</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fcont_continuous2</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcont_shift">fcont_shift</a></span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D1</span>-<span class="id">c</span>&gt;<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>) : <span class="id">D2</span>-<span class="id">c</span>&gt;<span class="id">D1</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>.<br/>
<span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2_cont">continuous2_cont</a></span> <span class="kwd">with</span> (<span class="id">D1</span>:=<span class="id">D2</span>) (<span class="id">D2</span>:=<span class="id">D1</span>) (<span class="id">D3</span>:=<span class="id">D3</span>)<br/>
&nbsp;&nbsp;(<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_shift">fmon_shift</a></span> (<span class="id">O1</span>:=<span class="id">D1</span>) (<span class="id">O2</span>:=<span class="id">D2</span>) (<span class="id">O3</span>:=<span class="id">D3</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D2</span> <span class="id">D3</span> @ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span>)).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_shift_simpl">fmon_shift_simpl</a></span>.<br/>
<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_simpl">fmon_comp_simpl</a></span>; <span class="id">auto</span>.<br/>
<span class="id">change</span> (<span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">g</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">f0</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_shift">fmon_shift</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D2</span> <span class="id">D3</span> @ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span>) @2 <span class="id">f0</span>) <span class="id">g</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (1:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_continuous2">fcont_continuous2</a></span> <span class="id">f</span> <span class="id">g</span> <span class="id">f0</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">intro</span> <span class="id">n</span>.<br/>
<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_simpl">fmon_comp_simpl</a></span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_shift_simpl">fcont_shift_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D1</span>-<span class="id">c</span>&gt;<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>) (<span class="id">x</span>:<span class="id">D2</span>) (<span class="id">y</span>:<span class="id">D1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_shift">fcont_shift</a></span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span> = <span class="id">f</span> <span class="id">y</span> <span class="id">x</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcont_SEQ">fcont_SEQ</a></span>  (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : (<span class="id">D1</span>-<span class="id">C</span>-&gt; <span class="id">D2</span>) -<span class="id">C</span>-&gt; (<span class="id">D2</span> -<span class="id">C</span>-&gt; <span class="id">D3</span>) -<span class="id">C</span>-&gt; <span class="id">D1</span> -<span class="id">C</span>-&gt; <span class="id">D3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_shift">fcont_shift</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_COMP">fcont_COMP</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_SEQ_simpl">fcont_SEQ_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>: <span class="id">D1</span> -<span class="id">C</span>-&gt; <span class="id">D2</span>) (<span class="id">g</span>:<span class="id">D2</span>-<span class="id">C</span>-&gt; <span class="id">D3</span>),<br/>
&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_SEQ">fcont_SEQ</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">f</span> <span class="id">g</span> = <span class="id">g</span> @_ <span class="id">f</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcont_comp2">fcont_comp2</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span> -<span class="id">C</span>-&gt;<span class="id">D4</span>) -&gt; (<span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>) -&gt; (<span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D3</span>) -&gt; <span class="id">D1</span>-<span class="id">c</span>&gt;<span class="id">D4</span>.<br/>
<span class="id">intros</span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span> <span class="id">f</span> <span class="id">g</span> <span class="id">h</span>.<br/>
<span class="kwd">exists</span> (((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D3</span> <span class="id">D4</span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span>) @2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">g</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">h</span>)).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">simpl</span>.<br/>
<span class="id">change</span> (<span class="id">f</span> (<span class="id">g</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h0</span>)) (<span class="id">h</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h0</span>)) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">D4</span>) ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D3</span> <span class="id">D4</span> @ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span> @2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">g</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">h</span>) @ <span class="id">h0</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">D2</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">g</span> @ <span class="id">h0</span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">D3</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">h</span> @ <span class="id">h0</span>))); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_continuous2">fcont_continuous2</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">g</span> @ <span class="id">h0</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">h</span> @ <span class="id">h0</span>)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Infix</span> <span class="string">"@2_"</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="kwd">at</span> <span class="id">level</span> 35, <span class="id">right</span> <span class="id">associativity</span>) : <span class="id">O_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_comp2_simpl">fcont_comp2_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">F</span>:<span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span> -<span class="id">C</span>-&gt;<span class="id">D4</span>) (<span class="id">f</span>:<span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>) (<span class="id">g</span>:<span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D3</span>) (<span class="id">x</span>:<span class="id">D1</span>), (<span class="id">F</span>@2_ <span class="id">f</span>) <span class="id">g</span> <span class="id">x</span> = <span class="id">F</span> (<span class="id">f</span> <span class="id">x</span>) (<span class="id">g</span> <span class="id">x</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="id">D1</span>:=<span class="id">D1</span>) (<span class="id">D2</span>:=<span class="id">D2</span>) (<span class="id">D3</span>:=<span class="id">D3</span>) (<span class="id">D4</span>:=<span class="id">D4</span>))<br/>
&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id">o</span>:=<span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span> -<span class="id">C</span>-&gt;<span class="id">D4</span>) ++&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id">o</span>:=<span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>) ++&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id">o</span>:=<span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D3</span>) ++&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id">o</span>:=<span class="id">D1</span>-<span class="id">c</span>&gt;<span class="id">D4</span>)<br/>
<span class="kwd">as</span> <span class="id">fcont_comp2_le_morph</span>.<br/>
<span class="id">intros</span> <span class="id">F</span> <span class="id">G</span> <span class="id">HF</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">Hf</span> <span class="id">g1</span> <span class="id">g2</span> <span class="id">Hg</span> <span class="id">x</span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f1</span> <span class="id">x</span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">g1</span> <span class="id">x</span>)).<br/>
<span class="id">apply</span> <span class="id">HF</span>.<br/>
<span class="id">change</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D3</span> <span class="id">D4</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f1</span> <span class="id">x</span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">g1</span> <span class="id">x</span>) &lt;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D3</span> <span class="id">D4</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f2</span> <span class="id">x</span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">g2</span> <span class="id">x</span>)).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_le_compat2">fmon_le_compat2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D3</span> <span class="id">D4</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="id">D1</span>:=<span class="id">D1</span>) (<span class="id">D2</span>:=<span class="id">D2</span>) (<span class="id">D3</span>:=<span class="id">D3</span>) (<span class="id">D4</span>:=<span class="id">D4</span>))<br/>
<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span> -<span class="id">C</span>-&gt;<span class="id">D4</span>) ==&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>) ==&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D3</span>) ==&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">D1</span>-<span class="id">c</span>&gt;<span class="id">D4</span>)<br/>
<span class="kwd">as</span> <span class="id">fcont_comp2_eq_compat</span>.<br/>
<span class="id">intros</span> <span class="id">F</span> <span class="id">G</span> (<span class="id">HF1</span>,<span class="id">HF2</span>) <span class="id">f1</span> <span class="id">f2</span> (<span class="id">Hf1</span>,<span class="id">Hf2</span>) <span class="id">g1</span> <span class="id">g2</span> (<span class="id">Hg1</span>,<span class="id">Hg2</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>.<br/>
<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2_le_morph">fcont_comp2_le_morph</a></span> <span class="id">HF1</span> <span class="id">Hf1</span> <span class="id">Hg1</span>).<br/>
<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2_le_morph">fcont_comp2_le_morph</a></span> <span class="id">HF2</span> <span class="id">Hf2</span> <span class="id">Hg2</span>).<br/>
Qed.
<br/>
<br/>
<br/>
<div class="doc">- Identity function is continuous </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Id">Id</a></span> : <span class="kwd">forall</span> <span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>, <span class="id">O</span>-<span class="id">m</span>&gt;<span class="id">O</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">x</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id">x</span>); <span class="id">red</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ID">ID</a></span> : <span class="kwd">forall</span> <span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>, <span class="id">D</span>-<span class="id">c</span>&gt;<span class="id">D</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Id">Id</a></span> <span class="id">D</span>); <span class="id">red</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Id_simpl">Id_simpl</a></span> : <span class="kwd">forall</span> <span class="id">O</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Id">Id</a></span> <span class="id">O</span> <span class="id">x</span> = <span class="id">x</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ID_simpl">ID_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> <span class="id">D</span> <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Id">Id</a></span> <span class="id">D</span> <span class="id">x</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="AP">AP</a></span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : (<span class="id">D1</span>-<span class="id">C</span>-&gt;<span class="id">D2</span>)-<span class="id">c</span>&gt;<span class="id">D1</span>-<span class="id">C</span>-&gt;<span class="id">D2</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> (<span class="id">D1</span>-<span class="id">C</span>-&gt;<span class="id">D2</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="AP_simpl">AP_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> : <span class="id">D1</span>-<span class="id">C</span>-&gt;<span class="id">D2</span>) (<span class="id">x</span>:<span class="id">D1</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">f</span> <span class="id">x</span> = <span class="id">f</span> <span class="id">x</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fcont_comp3">fcont_comp3</a></span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span> <span class="id">D5</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">F</span>:<span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span> -<span class="id">C</span>-&gt;<span class="id">D4</span>-<span class="id">C</span>-&gt;<span class="id">D5</span>)(<span class="id">f</span>:<span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>)(<span class="id">g</span>:<span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D3</span>)(<span class="id">h</span>:<span class="id">D1</span>-<span class="id">c</span>&gt;<span class="id">D4</span>): <span class="id">D1</span>-<span class="id">c</span>&gt;<span class="id">D5</span><br/>
&nbsp;&nbsp;:= (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> <span class="id">D4</span> <span class="id">D5</span> @2_ ((<span class="id">F</span> @2_ <span class="id">f</span>) <span class="id">g</span>)) <span class="id">h</span>.<br/>
<br/>
<span class="kwd">Infix</span> <span class="string">"@3_"</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp3">fcont_comp3</a></span> (<span class="kwd">at</span> <span class="id">level</span> 35, <span class="id">right</span> <span class="id">associativity</span>) : <span class="id">O_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_comp3_simpl">fcont_comp3_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span> <span class="id">D5</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">F</span>:<span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span> -<span class="id">C</span>-&gt;<span class="id">D4</span>-<span class="id">C</span>-&gt;<span class="id">D5</span>) (<span class="id">f</span>:<span class="id">D1</span>-<span class="id">c</span>&gt; <span class="id">D2</span>) (<span class="id">g</span>:<span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D3</span>) (<span class="id">h</span>:<span class="id">D1</span>-<span class="id">c</span>&gt;<span class="id">D4</span>) (<span class="id">x</span>:<span class="id">D1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">F</span>@3_ <span class="id">f</span>) <span class="id">g</span> <span class="id">h</span> <span class="id">x</span> = <span class="id">F</span> (<span class="id">f</span> <span class="id">x</span>) (<span class="id">g</span> <span class="id">x</span>) (<span class="id">h</span> <span class="id">x</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<h2> Product of two cpos </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Oprod">Oprod</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>.<br/>
<span class="id">intros</span> <span class="id">O1</span> <span class="id">O2</span>; <span class="kwd">exists</span> (<span class="id">O1</span> * <span class="id">O2</span>)%<span class="id">type</span> (<span class="kwd">fun</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id">O1</span>*<span class="id">O2</span>) =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">x</span> &lt;= <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">y</span> /\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span> &lt;= <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">y</span>); <span class="id">intuition</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">a0</span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">b0</span>; <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Fst">Fst</a></span> (<span class="id">O1</span> <span class="id">O2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprod">Oprod</a></span> <span class="id">O1</span> <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O1</span>.<br/>
<span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id">A</span>:=<span class="id">O1</span>) (<span class="id">B</span>:=<span class="id">O2</span>)); <span class="id">red</span>; <span class="id">simpl</span>; <span class="id">intuition</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Snd">Snd</a></span> (<span class="id">O1</span> <span class="id">O2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprod">Oprod</a></span> <span class="id">O1</span> <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id">O2</span>.<br/>
<span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id">A</span>:=<span class="id">O1</span>) (<span class="id">B</span>:=<span class="id">O2</span>)); <span class="id">red</span>; <span class="id">simpl</span>; <span class="id">intuition</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Pairr">Pairr</a></span> (<span class="id">O1</span> <span class="id">O2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : <span class="id">O1</span> -&gt; <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprod">Oprod</a></span> <span class="id">O1</span> <span class="id">O2</span>.<br/>
<span class="id">intro</span> <span class="id">x</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">y</span>:<span class="id">O2</span> =&gt; (<span class="id">x</span>,<span class="id">y</span>)); <span class="id">red</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Pair">Pair</a></span> (<span class="id">O1</span> <span class="id">O2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : <span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprod">Oprod</a></span> <span class="id">O1</span> <span class="id">O2</span>.<br/>
<span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Pairr">Pairr</a></span> (<span class="id">O1</span>:=<span class="id">O1</span>) <span class="id">O2</span>); <span class="id">red</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Fst_simpl">Fst_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">p</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprod">Oprod</a></span> <span class="id">O1</span> <span class="id">O2</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fst">Fst</a></span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">p</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">p</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Snd_simpl">Snd_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">p</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprod">Oprod</a></span> <span class="id">O1</span> <span class="id">O2</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Snd">Snd</a></span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">p</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">p</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Pair_simpl">Pair_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x</span>:<span class="id">O1</span>)(<span class="id">y</span>:<span class="id">O2</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Pair">Pair</a></span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">x</span> <span class="id">y</span> = (<span class="id">x</span>,<span class="id">y</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="prod0">prod0</a></span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprod">Oprod</a></span> <span class="id">D1</span> <span class="id">D2</span> := (0: <span class="id">D1</span>,0: <span class="id">D2</span>).<br/>
<span class="kwd">Definition</span> <span class="id"><a name="prod_lub">prod_lub</a></span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprod">Oprod</a></span> <span class="id">D1</span> <span class="id">D2</span>) := (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fst">Fst</a></span> <span class="id">D1</span> <span class="id">D2</span>@<span class="id">f</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Snd">Snd</a></span> <span class="id">D1</span> <span class="id">D2</span>@<span class="id">f</span>)).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Dprod">Dprod</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>.<br/>
<span class="id">intros</span> <span class="id">D1</span> <span class="id">D2</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprod">Oprod</a></span> <span class="id">D1</span> <span class="id">D2</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#prod0">prod0</a></span> <span class="id">D1</span> <span class="id">D2</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#prod_lub">prod_lub</a></span> (<span class="id">D1</span>:=<span class="id">D1</span>) (<span class="id">D2</span>:=<span class="id">D2</span>)); <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#prod_lub">prod_lub</a></span>; <span class="id">intuition</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonot">fmonot</a></span> <span class="id">f</span> <span class="id">n</span>), <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonot">fmonot</a></span> <span class="id">f</span> <span class="id">n</span>)); <span class="id">simpl</span>; <span class="id">intuition</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#le_lub">le_lub</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fst">Fst</a></span> <span class="id">D1</span> <span class="id">D2</span> @ <span class="id">f</span>) (<span class="id">n</span>:=<span class="id">n</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#le_lub">le_lub</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Snd">Snd</a></span> <span class="id">D1</span> <span class="id">D2</span> @ <span class="id">f</span>) (<span class="id">n</span>:=<span class="id">n</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">x</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span>); <span class="id">simpl</span>; <span class="id">intuition</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> (<span class="id">H</span> <span class="id">n</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> (<span class="id">H</span> <span class="id">n</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Dprod_eq_intro">Dprod_eq_intro</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">p1</span> <span class="id">p2</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">p1</span> == <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">p2</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">p1</span> == <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">p2</span> -&gt; <span class="id">p1</span> == <span class="id">p2</span>.<br/>
<span class="id">split</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Dprod_eq_intro</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Dprod_eq_pair">Dprod_eq_pair</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">x1</span> <span class="id">y1</span>:<span class="id">D1</span>) (<span class="id">x2</span> <span class="id">y2</span>:<span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x1</span>==<span class="id">y1</span> -&gt; <span class="id">x2</span>==<span class="id">y2</span> -&gt; ((<span class="id">x1</span>,<span class="id">x2</span>):<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span>) == (<span class="id">y1</span>,<span class="id">y2</span>).<br/>
<span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Dprod_eq_pair</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Dprod_eq_elim_fst">Dprod_eq_elim_fst</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">p1</span> <span class="id">p2</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">p1</span>==<span class="id">p2</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">p1</span> == <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">p2</span>.<br/>
<span class="id">split</span>; <span class="id">case</span> <span class="id">H</span>; <span class="id">simpl</span>; <span class="id">intuition</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">Dprod_eq_elim_fst</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Dprod_eq_elim_snd">Dprod_eq_elim_snd</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">p1</span> <span class="id">p2</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">p1</span>==<span class="id">p2</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">p1</span> == <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">p2</span>.<br/>
<span class="id">split</span>; <span class="id">case</span> <span class="id">H</span>; <span class="id">simpl</span>; <span class="id">intuition</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">Dprod_eq_elim_snd</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="FST">FST</a></span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D1</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fst">Fst</a></span> <span class="id">D1</span> <span class="id">D2</span>); <span class="id">red</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="SND">SND</a></span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D2</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Snd">Snd</a></span> <span class="id">D1</span> <span class="id">D2</span>); <span class="id">red</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Pair_continuous2">Pair_continuous2</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2">continuous2</a></span> (<span class="id">D3</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Pair">Pair</a></span> <span class="id">D1</span> <span class="id">D2</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PAIR">PAIR</a></span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : <span class="id">D1</span> -<span class="id">c</span>&gt; <span class="id">D2</span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2_cont">continuous2_cont</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Pair_continuous2">Pair_continuous2</a></span> (<span class="id">D1</span>:=<span class="id">D1</span>) (<span class="id">D2</span>:=<span class="id">D2</span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FST_simpl">FST_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">p</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">p</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fst">Fst</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">p</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SND_simpl">SND_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">p</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">p</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Snd">Snd</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">p</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="PAIR_simpl">PAIR_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">p1</span>:<span class="id">D1</span>) (<span class="id">p2</span>:<span class="id">D2</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PAIR">PAIR</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">p1</span> <span class="id">p2</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Pair">Pair</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">p1</span> <span class="id">p2</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FST_PAIR_simpl">FST_PAIR_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">p1</span>:<span class="id">D1</span>) (<span class="id">p2</span>:<span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">D1</span> <span class="id">D2</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PAIR">PAIR</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">p1</span> <span class="id">p2</span>) = <span class="id">p1</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SND_PAIR_simpl">SND_PAIR_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">p1</span>:<span class="id">D1</span>) (<span class="id">p2</span>:<span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">D1</span> <span class="id">D2</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PAIR">PAIR</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">p1</span> <span class="id">p2</span>) = <span class="id">p2</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Prod_map">Prod_map</a></span> :  <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">f</span>:<span class="id">D1</span>-<span class="id">m</span>&gt;<span class="id">D3</span>)(<span class="id">g</span>:<span class="id">D2</span>-<span class="id">m</span>&gt;<span class="id">D4</span>) ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D3</span> <span class="id">D4</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#pair">pair</a></span> (<span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">p</span>)) (<span class="id">g</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">p</span>))); <span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">split</span>; <span class="id">simpl</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span>; <span class="id">simpl</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fst">Fst</a></span> <span class="id">D1</span> <span class="id">D2</span>) <span class="id">H</span>).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Snd">Snd</a></span> <span class="id">D1</span> <span class="id">D2</span>) <span class="id">H</span>).<br/>
Defined.
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Prod_map_simpl">Prod_map_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">f</span>:<span class="id">D1</span>-<span class="id">m</span>&gt;<span class="id">D3</span>)(<span class="id">g</span>:<span class="id">D2</span>-<span class="id">m</span>&gt;<span class="id">D4</span>) (<span class="id">p</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Prod_map">Prod_map</a></span> <span class="id">f</span> <span class="id">g</span> <span class="id">p</span> =  <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#pair">pair</a></span> (<span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">p</span>)) (<span class="id">g</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">p</span>)).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PROD_map">PROD_map</a></span> :  <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">f</span>:<span class="id">D1</span>-<span class="id">c</span>&gt;<span class="id">D3</span>)(<span class="id">g</span>:<span class="id">D2</span>-<span class="id">c</span>&gt;<span class="id">D4</span>) ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D3</span> <span class="id">D4</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Prod_map">Prod_map</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">g</span>)); <span class="id">red</span>; <span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Prod_map_simpl">Prod_map_simpl</a></span>.<br/>
<span class="id">split</span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fst">Fst</a></span> <span class="id">D1</span> <span class="id">D2</span> @ <span class="id">h</span>))); <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">g</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Snd">Snd</a></span> <span class="id">D1</span> <span class="id">D2</span> @ <span class="id">h</span>))); <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="PROD_map_simpl">PROD_map_simpl</a></span> :  <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">f</span>:<span class="id">D1</span>-<span class="id">c</span>&gt;<span class="id">D3</span>)(<span class="id">g</span>:<span class="id">D2</span>-<span class="id">c</span>&gt;<span class="id">D4</span>)(<span class="id">p</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROD_map">PROD_map</a></span> <span class="id">f</span> <span class="id">g</span> <span class="id">p</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#pair">pair</a></span> (<span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">p</span>)) (<span class="id">g</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">p</span>)).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="curry">curry</a></span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span>) : <span class="id">D1</span> -<span class="id">c</span>&gt; (<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>) :=<br/>
<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_COMP">fcont_COMP</a></span> <span class="id">D1</span> (<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span>) (<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_COMP">fcont_COMP</a></span> <span class="id">D2</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span>) <span class="id">D3</span> <span class="id">f</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PAIR">PAIR</a></span> <span class="id">D1</span> <span class="id">D2</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Curry">Curry</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span>) -<span class="id">m</span>&gt; <span class="id">D1</span> -<span class="id">c</span>&gt; (<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span> (<span class="id">D1</span>:=<span class="id">D1</span>)(<span class="id">D2</span>:=<span class="id">D2</span>)(<span class="id">D3</span>:=<span class="id">D3</span>)); <span class="id">red</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Curry_simpl">Curry_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span> -<span class="id">C</span>-&gt; <span class="id">D3</span>) (<span class="id">x</span>:<span class="id">D1</span>) (<span class="id">y</span>:<span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Curry">Curry</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span> = <span class="id">f</span> (<span class="id">x</span>,<span class="id">y</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="CURRY">CURRY</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span> -<span class="id">C</span>-&gt; <span class="id">D3</span>) -<span class="id">c</span>&gt; <span class="id">D1</span> -<span class="id">C</span>-&gt; (<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Curry">Curry</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>); <span class="id">red</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="CURRY_simpl">CURRY_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span> -<span class="id">C</span>-&gt; <span class="id">D3</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#CURRY">CURRY</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">f</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Curry">Curry</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">f</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="uncurry">uncurry</a></span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D1</span> -<span class="id">c</span>&gt; (<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>)) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=  (<span class="id">f</span> @2_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">D1</span> <span class="id">D2</span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">D1</span> <span class="id">D2</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Uncurry">Uncurry</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>), (<span class="id">D1</span> -<span class="id">c</span>&gt; (<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>)) -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span> -<span class="id">c</span>&gt; <span class="id">D3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#uncurry">uncurry</a></span> (<span class="id">D1</span>:=<span class="id">D1</span>)(<span class="id">D2</span>:=<span class="id">D2</span>)(<span class="id">D3</span>:=<span class="id">D3</span>)).<br/>
<span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_le_intro">fcont_le_intro</a></span>; <span class="id">intro</span> <span class="id">z</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#uncurry">uncurry</a></span>.<br/>
<span class="id">repeat</span> (<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2_simpl">fcont_comp2_simpl</a></span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id">H</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">z</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">z</span>)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Uncurry_simpl">Uncurry_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D1</span> -<span class="id">c</span>&gt; (<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>)) (<span class="id">p</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Uncurry">Uncurry</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">f</span> <span class="id">p</span> = <span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">p</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">p</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="UNCURRY">UNCURRY</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>), (<span class="id">D1</span> -<span class="id">C</span>-&gt; (<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>)) -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> <span class="id">D1</span> <span class="id">D2</span> -<span class="id">C</span>-&gt; <span class="id">D3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Uncurry">Uncurry</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>); <span class="id">red</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="UNCURRY_simpl">UNCURRY_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)  (<span class="id">f</span>:<span class="id">D1</span> -<span class="id">c</span>&gt; (<span class="id">D2</span>-<span class="id">C</span>-&gt;<span class="id">D3</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#UNCURRY">UNCURRY</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">f</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Uncurry">Uncurry</a></span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">f</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<h2> Indexed product of cpo's </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Oprodi">Oprodi</a></span> (<span class="id">I</span>:<span class="kwd">Type</span>)(<span class="id">O</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">forall</span> <span class="id">i</span>:<span class="id">I</span>, <span class="id">O</span> <span class="id">i</span>) (<span class="kwd">fun</span> <span class="id">p1</span> <span class="id">p2</span>:<span class="kwd">forall</span> <span class="id">i</span>:<span class="id">I</span>, <span class="id">O</span> <span class="id">i</span> =&gt; <span class="kwd">forall</span> <span class="id">i</span>:<span class="id">I</span>, <span class="id">p1</span> <span class="id">i</span> &lt;= <span class="id">p2</span> <span class="id">i</span>); <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">y</span> <span class="id">i</span>); <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Oprodi_eq_intro">Oprodi_eq_intro</a></span> : <span class="kwd">forall</span> (<span class="id">I</span>:<span class="kwd">Type</span>)(<span class="id">O</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">p</span> <span class="id">q</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi">Oprodi</a></span> <span class="id">O</span>), (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">p</span> <span class="id">i</span> == <span class="id">q</span> <span class="id">i</span>) -&gt; <span class="id">p</span>==<span class="id">q</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">intro</span> <span class="id">i</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Oprodi_eq_elim">Oprodi_eq_elim</a></span> : <span class="kwd">forall</span> (<span class="id">I</span>:<span class="kwd">Type</span>)(<span class="id">O</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">p</span> <span class="id">q</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi">Oprodi</a></span> <span class="id">O</span>), <span class="id">p</span>==<span class="id">q</span> -&gt; <span class="kwd">forall</span> <span class="id">i</span>, <span class="id">p</span> <span class="id">i</span> == <span class="id">q</span> <span class="id">i</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">case</span> <span class="id">H</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Proj">Proj</a></span> (<span class="id">I</span>:<span class="kwd">Type</span>)(<span class="id">O</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">i</span>:<span class="id">I</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi">Oprodi</a></span> <span class="id">O</span> -<span class="id">m</span>&gt; <span class="id">O</span> <span class="id">i</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">x</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi">Oprodi</a></span> <span class="id">O</span>=&gt; <span class="id">x</span> <span class="id">i</span>); <span class="id">red</span>; <span class="id">auto</span> <span class="kwd">with</span> *.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Proj_simpl">Proj_simpl</a></span> : <span class="kwd">forall</span>  (<span class="id">I</span>:<span class="kwd">Type</span>)(<span class="id">O</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">i</span>:<span class="id">I</span>) (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi">Oprodi</a></span> <span class="id">O</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Proj">Proj</a></span> <span class="id">O</span> <span class="id">i</span> <span class="id">x</span> = <span class="id">x</span> <span class="id">i</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Dprodi">Dprodi</a></span> (<span class="id">I</span>:<span class="kwd">Type</span>)(<span class="id">D</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi">Oprodi</a></span> <span class="id">D</span>) (<span class="kwd">fun</span> <span class="id">i</span>=&gt;(0:<span class="id">D</span> <span class="id">i</span>)) (<span class="kwd">fun</span> (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi">Oprodi</a></span> <span class="id">D</span>) (<span class="id">i</span>:<span class="id">I</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Proj">Proj</a></span> <span class="id">D</span> <span class="id">i</span> @ <span class="id">f</span>));<br/>
<span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#le_lub">le_lub</a></span> <span class="kwd">with</span> (<span class="id">f</span>:= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Proj">Proj</a></span> (<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">I</span> =&gt; <span class="id">D</span> <span class="id">x</span>) <span class="id">i</span> @ <span class="id">f</span>) (<span class="id">n</span>:=<span class="id">n</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> (<span class="id">H</span> <span class="id">n</span> <span class="id">i</span>).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Dprodi_lub_simpl">Dprodi_lub_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">I</span>:<span class="kwd">Type</span>)(<span class="id">Di</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">h</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">Di</span>)(<span class="id">i</span>:<span class="id">I</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span> <span class="id">i</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">Di</span> <span class="id">i</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Proj">Proj</a></span> <span class="id">Di</span> <span class="id">i</span> @ <span class="id">h</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Dprodi_continuous">Dprodi_continuous</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">I</span>:<span class="kwd">Type</span>)(<span class="id">Di</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="id">D</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">Di</span>), (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Proj">Proj</a></span> <span class="id">Di</span> <span class="id">i</span> @ <span class="id">f</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> <span class="id">f</span>.<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">intro</span> <span class="id">i</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">Di</span> <span class="id">i</span>) ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Proj">Proj</a></span> <span class="id">Di</span> <span class="id">i</span> @ <span class="id">f</span>) @ <span class="id">h</span>)); <span class="id">auto</span>.<br/>
<span class="id">exact</span> (<span class="id">H</span> <span class="id">i</span> <span class="id">h</span>).<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Dprodi_lift">Dprodi_lift</a></span> : <span class="kwd">forall</span> (<span class="id">I</span> <span class="id">J</span>:<span class="kwd">Type</span>)(<span class="id">Di</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">f</span>:<span class="id">J</span>-&gt;<span class="id">I</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">Di</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id">Di</span> (<span class="id">f</span> <span class="id">j</span>)).<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> (<span class="id">p</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">Di</span>) <span class="id">j</span> =&gt; <span class="id">p</span> (<span class="id">f</span> <span class="id">j</span>)); <span class="id">red</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Dprodi_lift_simpl">Dprodi_lift_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">I</span> <span class="id">J</span>:<span class="kwd">Type</span>)(<span class="id">Di</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">f</span>:<span class="id">J</span>-&gt;<span class="id">I</span>)(<span class="id">p</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">Di</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi_lift">Dprodi_lift</a></span> <span class="id">Di</span> <span class="id">f</span> <span class="id">p</span> = <span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id">p</span> (<span class="id">f</span> <span class="id">j</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Dprodi_lift_cont">Dprodi_lift_cont</a></span> : <span class="kwd">forall</span> (<span class="id">I</span> <span class="id">J</span>:<span class="kwd">Type</span>)(<span class="id">Di</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">f</span>:<span class="id">J</span>-&gt;<span class="id">I</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi_lift">Dprodi_lift</a></span> <span class="id">Di</span> <span class="id">f</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi_continuous">Dprodi_continuous</a></span>; <span class="id">red</span>; <span class="id">simpl</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="DLIFTi">DLIFTi</a></span> (<span class="id">I</span> <span class="id">J</span>:<span class="kwd">Type</span>)(<span class="id">Di</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">f</span>:<span class="id">J</span>-&gt;<span class="id">I</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">Di</span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id">Di</span> (<span class="id">f</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mk_fconti">mk_fconti</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi_lift_cont">Dprodi_lift_cont</a></span> (<span class="id">Di</span>:=<span class="id">Di</span>) <span class="id">f</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Dmapi">Dmapi</a></span> : <span class="kwd">forall</span> (<span class="id">I</span>:<span class="kwd">Type</span>)(<span class="id">Di</span> <span class="id">Dj</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">Di</span> <span class="id">i</span> -<span class="id">m</span>&gt; <span class="id">Dj</span> <span class="id">i</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">Di</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">Dj</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">p</span> <span class="id">i</span> =&gt; <span class="id">f</span> <span class="id">i</span> (<span class="id">p</span> <span class="id">i</span>)); <span class="id">red</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Dmapi_simpl">Dmapi_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">I</span>:<span class="kwd">Type</span>)(<span class="id">Di</span> <span class="id">Dj</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">Di</span> <span class="id">i</span> -<span class="id">m</span>&gt; <span class="id">Dj</span> <span class="id">i</span>) (<span class="id">p</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">Di</span>) (<span class="id">i</span>:<span class="id">I</span>),<br/>
<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dmapi">Dmapi</a></span> <span class="id">f</span> <span class="id">p</span> <span class="id">i</span> = <span class="id">f</span> <span class="id">i</span> (<span class="id">p</span> <span class="id">i</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DMAPi">DMAPi</a></span> : <span class="kwd">forall</span> (<span class="id">I</span>:<span class="kwd">Type</span>)(<span class="id">Di</span> <span class="id">Dj</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">Di</span> <span class="id">i</span> -<span class="id">c</span>&gt; <span class="id">Dj</span> <span class="id">i</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">Di</span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">Dj</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dmapi">Dmapi</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id">f</span> <span class="id">i</span>))).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">intro</span> <span class="id">i</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dmapi_simpl">Dmapi_simpl</a></span>.<br/>
<span class="id">repeat</span> (<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi_lub_simpl">Dprodi_lub_simpl</a></span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">Dj</span> <span class="id">i</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> (<span class="id">Di</span> <span class="id">i</span>) (<span class="id">Dj</span> <span class="id">i</span>) (<span class="id">f</span> <span class="id">i</span>) @ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Proj">Proj</a></span> (<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">I</span> =&gt; <span class="id">Di</span> <span class="id">x</span>) <span class="id">i</span> @ <span class="id">h</span>))); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DMAPi_simpl">DMAPi_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">I</span>:<span class="kwd">Type</span>)(<span class="id">Di</span> <span class="id">Dj</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">Di</span> <span class="id">i</span> -<span class="id">c</span>&gt; <span class="id">Dj</span> <span class="id">i</span>) (<span class="id">p</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">Di</span>) (<span class="id">i</span>:<span class="id">I</span>),<br/>
<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DMAPi">DMAPi</a></span> <span class="id">f</span> <span class="id">p</span> <span class="id">i</span> = <span class="id">f</span> <span class="id">i</span> (<span class="id">p</span> <span class="id">i</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Proj_cont">Proj_cont</a></span> : <span class="kwd">forall</span> (<span class="id">I</span>:<span class="kwd">Type</span>)(<span class="id">Di</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">i</span>:<span class="id">I</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">D1</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">Di</span>) (<span class="id">D2</span>:=<span class="id">Di</span> <span class="id">i</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Proj">Proj</a></span> <span class="id">Di</span> <span class="id">i</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PROJ">PROJ</a></span> (<span class="id">I</span>:<span class="kwd">Type</span>)(<span class="id">Di</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">i</span>:<span class="id">I</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">Di</span> -<span class="id">c</span>&gt; <span class="id">Di</span> <span class="id">i</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mk_fconti">mk_fconti</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Proj_cont">Proj_cont</a></span> (<span class="id">Di</span>:=<span class="id">Di</span>) <span class="id">i</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="PROJ_simpl">PROJ_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">I</span>:<span class="kwd">Type</span>)(<span class="id">Di</span>:<span class="id">I</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">i</span>:<span class="id">I</span>)(<span class="id">d</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">Di</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> <span class="id">Di</span> <span class="id">i</span> <span class="id">d</span> = <span class="id">d</span> <span class="id">i</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<h3> Particular cases with one or two elements </h3>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Product2">Product2</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="I2">I2</a></span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Product2.DI2">DI2</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="DP1">DP1</a></span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="DP2">DP2</a></span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PI1">PI1</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP1">DP1</a></span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="pi1">pi1</a></span> (<span class="id">d</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PI1">PI1</a></span> <span class="id">d</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PI2">PI2</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP2">DP2</a></span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="pi2">pi2</a></span> (<span class="id">d</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PI2">PI2</a></span> <span class="id">d</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="pair2">pair2</a></span> (<span class="id">d1</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP1">DP1</a></span>) (<span class="id">d2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP2">DP2</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool_rect">bool_rect</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span> <span class="id">d1</span> <span class="id">d2</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pair2_le_compat">pair2_le_compat</a></span> : <span class="kwd">forall</span> (<span class="id">d1</span> <span class="id">d'1</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP1">DP1</a></span>) (<span class="id">d2</span> <span class="id">d'2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP2">DP2</a></span>), <span class="id">d1</span> &lt;= <span class="id">d'1</span> -&gt; <span class="id">d2</span> &lt;= <span class="id">d'2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pair2">pair2</a></span> <span class="id">d1</span> <span class="id">d2</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pair2">pair2</a></span> <span class="id">d'1</span> <span class="id">d'2</span>.<br/>
<span class="id">intros</span>; <span class="id">intro</span> <span class="id">b</span>; <span class="id">case</span> <span class="id">b</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Pair2">Pair2</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP1">DP1</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP2">DP2</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#le_compat2_mon">le_compat2_mon</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pair2_le_compat">pair2_le_compat</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PAIR2">PAIR2</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP1">DP1</a></span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP2">DP2</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2_cont">continuous2_cont</a></span> <span class="kwd">with</span> (<span class="id">D1</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP1">DP1</a></span>) (<span class="id">D2</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP2">DP2</a></span>) (<span class="id">D3</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span>) (<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Pair2">Pair2</a></span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">intro</span> <span class="id">b</span>.<br/>
<span class="id">case</span> <span class="id">b</span>; <span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="PAIR2_simpl">PAIR2_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">d1</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP1">DP1</a></span>) (<span class="id">d2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP2">DP2</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PAIR2">PAIR2</a></span> <span class="id">d1</span> <span class="id">d2</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Pair2">Pair2</a></span> <span class="id">d1</span> <span class="id">d2</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Pair2_simpl">Pair2_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">d1</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP1">DP1</a></span>) (<span class="id">d2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP2">DP2</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Pair2">Pair2</a></span> <span class="id">d1</span> <span class="id">d2</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pair2">pair2</a></span> <span class="id">d1</span> <span class="id">d2</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pi1_simpl">pi1_simpl</a></span> : <span class="kwd">forall</span>  (<span class="id">d1</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP1">DP1</a></span>) (<span class="id">d2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP2">DP2</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pi1">pi1</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pair2">pair2</a></span> <span class="id">d1</span> <span class="id">d2</span>) = <span class="id">d1</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pi2_simpl">pi2_simpl</a></span> : <span class="kwd">forall</span>  (<span class="id">d1</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP1">DP1</a></span>) (<span class="id">d2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP2">DP2</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pi2">pi2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pair2">pair2</a></span> <span class="id">d1</span> <span class="id">d2</span>) = <span class="id">d2</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="DI2_map">DI2_map</a></span> (<span class="id">f1</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP1">DP1</a></span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP1">DP1</a></span>) (<span class="id">f2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP2">DP2</a></span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP2">DP2</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DMAPi">DMAPi</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool_rect">bool_rect</a></span> (<span class="kwd">fun</span> <span class="id">b</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span> <span class="id">b</span> -<span class="id">c</span>&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span> <span class="id">b</span>) <span class="id">f1</span> <span class="id">f2</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Dl2_map_eq">Dl2_map_eq</a></span> : <span class="kwd">forall</span> (<span class="id">f1</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP1">DP1</a></span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP1">DP1</a></span>) (<span class="id">f2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP2">DP2</a></span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DP2">DP2</a></span>) (<span class="id">d</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2.DI2">DI2</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DI2_map">DI2_map</a></span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">d</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pair2">pair2</a></span> (<span class="id">f1</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pi1">pi1</a></span> <span class="id">d</span>)) (<span class="id">f2</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pi2">pi2</a></span> <span class="id">d</span>)).<br/>
<span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">b</span>; <span class="id">case</span> <span class="id">b</span>; <span class="id">trivial</span>.<br/>
Qed.
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product2">Product2</a></span>.<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Dl2_map_eq</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Product1">Product1</a></span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="I1">I1</a></span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Product1.D">D</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="DI1">DI1</a></span> (_:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product1.D">D</a></span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PI">PI</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DI1">DI1</a></span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product1.D">D</a></span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DI1">DI1</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="pi">pi</a></span> (<span class="id">d</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DI1">DI1</a></span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PI">PI</a></span> <span class="id">d</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="pair1">pair1</a></span> (<span class="id">d</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product1.D">D</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DI1">DI1</a></span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#unit_rect">unit_rect</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DI1">DI1</a></span> <span class="id">d</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="pair1_simpl">pair1_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">d</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product1.D">D</a></span>) (<span class="id">x</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pair1">pair1</a></span> <span class="id">d</span> <span class="id">x</span> = <span class="id">d</span>.<br/>
<span class="id">destruct</span> <span class="id">x</span>; <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Pair1">Pair1</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product1.D">D</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DI1">DI1</a></span>.<br/>
<span class="kwd">exists</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pair1">pair1</a></span>; <span class="id">red</span>; <span class="id">intros</span>; <span class="id">intro</span> <span class="id">d</span>.<br/>
<span class="id">repeat</span> (<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pair1_simpl">pair1_simpl</a></span>);<span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Pair1_simpl">Pair1_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">d</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product1.D">D</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Pair1">Pair1</a></span> <span class="id">d</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pair1">pair1</a></span> <span class="id">d</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PAIR1">PAIR1</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product1.D">D</a></span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DI1">DI1</a></span>.<br/>
<span class="kwd">exists</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Pair1">Pair1</a></span>; <span class="id">red</span>; <span class="id">intros</span>; <span class="id">repeat</span> (<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Pair1_simpl">Pair1_simpl</a></span>).<br/>
<span class="id">intro</span> <span class="id">d</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pair1_simpl">pair1_simpl</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi_lub_simpl">Dprodi_lub_simpl</a></span> (<span class="id">Di</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DI1">DI1</a></span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">intros</span>.<br/>
<span class="id">intro</span> <span class="id">x</span>; <span class="id">simpl</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pair1_simpl">pair1_simpl</a></span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pi_simpl">pi_simpl</a></span> : <span class="kwd">forall</span>  (<span class="id">d</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product1.D">D</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pi">pi</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pair1">pair1</a></span> <span class="id">d</span>) = <span class="id">d</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="DI1_map">DI1_map</a></span> (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product1.D">D</a></span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product1.D">D</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DI1">DI1</a></span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DI1">DI1</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DMAPi">DMAPi</a></span> (<span class="kwd">fun</span> <span class="id">t</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> =&gt; <span class="id">f</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DI1_map_eq">DI1_map_eq</a></span> : <span class="kwd">forall</span> (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product1.D">D</a></span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product1.D">D</a></span>) (<span class="id">d</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DI1">DI1</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DI1_map">DI1_map</a></span> <span class="id">f</span> <span class="id">d</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pair1">pair1</a></span> (<span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#pi">pi</a></span> <span class="id">d</span>)).<br/>
<span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">b</span>; <span class="id">case</span> <span class="id">b</span>; <span class="id">trivial</span>.<br/>
Qed.
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Product1">Product1</a></span>.<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">DI1_map_eq</span> : <span class="id">core</span>.<br/>
<br/>
<h2> Fixpoints </h2>
<span class="kwd">Section</span> <span class="id"><a name="Fixpoints">Fixpoints</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Fixpoints.D">D</a></span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Fixpoints.f">f</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixpoints.D">D</a></span> -<span class="id">m</span>&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixpoints.D">D</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Fixpoints.fcont">fcont</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixpoints.f">f</a></span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="iter_">iter_</a></span> <span class="id">n</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixpoints.D">D</a></span> := <span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; 0 | <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixpoints.f">f</a></span> (<span class="id">iter_</span> <span class="id">m</span>) <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="iter_incr">iter_incr</a></span> : <span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter_">iter_</a></span> <span class="id">n</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixpoints.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter_">iter_</a></span> <span class="id">n</span>).<br/>
<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">iter_incr</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="iter">iter</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixpoints.D">D</a></span>.<br/>
<span class="kwd">exists</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter_">iter_</a></span>; <span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">induction</span> <span class="id">H</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter_">iter_</a></span> <span class="id">m</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fixp">fixp</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixpoints.D">D</a></span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter">iter</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fixp_le">fixp_le</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixpoints.f">f</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp">fmon_comp</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixpoints.f">f</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter">iter</a></span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fixp_le</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fixp_eq">fixp_eq</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixpoints.f">f</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (1:= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixpoints.fcont">fcont</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter">iter</a></span>).<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_lift_left">lub_lift_left</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter">iter</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fixp_inv">fixp_inv</a></span> : <span class="kwd">forall</span> <span class="id">g</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixpoints.f">f</a></span> <span class="id">g</span> &lt;= <span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span> &lt;= <span class="id">g</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>.<br/>
<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixpoints.f">f</a></span> <span class="id">g</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixpoints">Fixpoints</a></span>.<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fixp_le</span> <span class="id">fixp_eq</span> <span class="id">fixp_inv</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fixp_cte">fixp_cte</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">d</span>:<span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="id">D</span> <span class="id">d</span>) == <span class="id">d</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp_eq">fixp_eq</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="id">D</span> <span class="id">d</span>); <span class="id">red</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="kwd">at</span> 1; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#le_lub">le_lub</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp">fmon_comp</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="id">D</span> (<span class="id">O2</span>:=<span class="id">D</span>) <span class="id">d</span>) <span class="id">h</span>) (<span class="id">n</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>); <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fixp_cte</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fixp_le_compat">fixp_le_compat</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id">D</span>-<span class="id">m</span>&gt;<span class="id">D</span>), <span class="id">f</span>&lt;=<span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span> <span class="id">f</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span> <span class="id">g</span>.<br/>
<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>.<br/>
<span class="id">intro</span> <span class="id">n</span>; <span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">g</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter_">iter_</a></span> (<span class="id">D</span>:=<span class="id">D</span>) <span class="id">f</span> <span class="id">n</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fixp_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span> (<span class="id">D</span>:=<span class="id">D</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">D</span>-<span class="id">m</span>&gt;<span class="id">D</span>) ==&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id">D</span>)<br/>
<span class="kwd">as</span> <span class="id">fixp_eq_compat</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fixp_eq_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Fixp">Fixp</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>), (<span class="id">D</span>-<span class="id">m</span>&gt;<span class="id">D</span>) -<span class="id">m</span>&gt; <span class="id">D</span>.<br/>
<span class="id">intros</span> <span class="id">D</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span> (<span class="id">D</span>:=<span class="id">D</span>)); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Fixp_simpl">Fixp_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D</span>-<span class="id">m</span>&gt;<span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixp">Fixp</a></span> <span class="id">D</span> <span class="id">f</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span> <span class="id">f</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Iter">Iter</a></span> : <span class="kwd">forall</span> <span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>, (<span class="id">D</span>-<span class="id">M</span>-&gt;<span class="id">D</span>) -<span class="id">m</span>&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">M</span>-&gt;<span class="id">D</span>).<br/>
<span class="id">intro</span> <span class="id">D</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> (<span class="id">f</span>:<span class="id">D</span>-<span class="id">M</span>-&gt;<span class="id">D</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter">iter</a></span> (<span class="id">D</span>:=<span class="id">D</span>) <span class="id">f</span>); <span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">intro</span> <span class="id">n</span>; <span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">y</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter_">iter_</a></span> (<span class="id">D</span>:=<span class="id">D</span>) <span class="id">x</span> <span class="id">n</span>)); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="IterS_simpl">IterS_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) <span class="id">f</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iter">Iter</a></span> <span class="id">D</span> <span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) = <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iter">Iter</a></span> <span class="id">D</span> <span class="id">f</span> <span class="id">n</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="iterS_simpl">iterS_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) <span class="id">f</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter">iter</a></span> <span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) = <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter">iter</a></span> (<span class="id">D</span>:=<span class="id">D</span>) <span class="id">f</span> <span class="id">n</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="iter_continuous">iter_continuous</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; (<span class="id">D</span>-<span class="id">M</span>-&gt;<span class="id">D</span>), (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">h</span> <span class="id">n</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter">iter</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iter">Iter</a></span> <span class="id">D</span> @ <span class="id">h</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">intro</span> <span class="id">k</span>.<br/>
<span class="id">induction</span> <span class="id">k</span>; <span class="id">auto</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iterS_simpl">iterS_simpl</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>  (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">M</span>-&gt; <span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iter">Iter</a></span> <span class="id">D</span> @ <span class="id">h</span>) <span class="id">k</span>)); <span class="id">auto</span>.<br/>
<span class="id">repeat</span> (<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_lub_simpl">fmon_lub_simpl</a></span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">M</span>-&gt;<span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#double_app">double_app</a></span> <span class="id">h</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iter">Iter</a></span> <span class="id">D</span> @ <span class="id">h</span>) &lt;_&gt; <span class="id">k</span>)))).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> ((<span class="id">h</span> <span class="id">x</span>)@((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iter">Iter</a></span> <span class="id">D</span> @ <span class="id">h</span>) &lt;_&gt; <span class="id">k</span>))); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span><br/>
&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_diag">fmon_diag</a></span>  (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#double_app">double_app</a></span> <span class="id">h</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iter">Iter</a></span> <span class="id">D</span> @ <span class="id">h</span>) &lt;_&gt; <span class="id">k</span>)))); <span class="id">auto</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#double_lub_diag">double_lub_diag</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#double_app">double_app</a></span> <span class="id">h</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iter">Iter</a></span> <span class="id">D</span> @ <span class="id">h</span>) &lt;_&gt; <span class="id">k</span>))); <span class="id">intros</span> <span class="id">L</span> _.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (1:=<span class="id">L</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">iter_continuous</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="iter_continuous_eq">iter_continuous_eq</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; (<span class="id">D</span>-<span class="id">M</span>-&gt;<span class="id">D</span>), (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">h</span> <span class="id">n</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter">iter</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iter">Iter</a></span> <span class="id">D</span> @ <span class="id">h</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_comp_le">lub_comp_le</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Iter">Iter</a></span> <span class="id">D</span>) <span class="id">h</span>).<br/>
Qed.
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fixp_continuous">fixp_continuous</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">h</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; (<span class="id">D</span>-<span class="id">M</span>-&gt;<span class="id">D</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">h</span> <span class="id">n</span>)) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixp">Fixp</a></span> <span class="id">D</span> @ <span class="id">h</span>).<br/>
<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter_continuous_eq">iter_continuous_eq</a></span> <span class="id">H</span>).<br/>
<span class="id">simpl</span>; <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_exch_eq">lub_exch_eq</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">fixp_continuous</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fixp_continuous_eq">fixp_continuous_eq</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">h</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; (<span class="id">D</span> -<span class="id">M</span>-&gt; <span class="id">D</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">h</span> <span class="id">n</span>)) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixp">Fixp</a></span> <span class="id">D</span> @ <span class="id">h</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_comp_le">lub_comp_le</a></span> (<span class="id">D1</span>:=<span class="id">D</span> -<span class="id">M</span>-&gt; <span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixp">Fixp</a></span> <span class="id">D</span>) <span class="id">h</span>).<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="FIXP">FIXP</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>), (<span class="id">D</span>-<span class="id">C</span>-&gt;<span class="id">D</span>) -<span class="id">c</span>&gt; <span class="id">D</span>.<br/>
<span class="id">intro</span> <span class="id">D</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixp">Fixp</a></span> <span class="id">D</span> @ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D</span> <span class="id">D</span>)).<br/>
<span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_simpl">fmon_comp_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixp_simpl">Fixp_simpl</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span> (<span class="id">D</span>:=<span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">D</span>-<span class="id">M</span>-&gt;<span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D</span> <span class="id">D</span>@<span class="id">h</span>))); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span>  (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixp">Fixp</a></span> <span class="id">D</span> @ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fcontit">Fcontit</a></span> <span class="id">D</span> <span class="id">D</span>@<span class="id">h</span>))); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp_continuous">fixp_continuous</a></span>; <span class="id">intros</span>.<br/>
<span class="id">change</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">D1</span>:=<span class="id">D</span>) (<span class="id">D2</span>:=<span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id">h</span> <span class="id">n</span>))); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FIXP_simpl">FIXP_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D</span>-<span class="id">c</span>&gt;<span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">f</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixp">Fixp</a></span> <span class="id">D</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FIXP_le_compat">FIXP_le_compat</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id">D</span>-<span class="id">C</span>-&gt;<span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> &lt;= <span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">f</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">g</span>.<br/>
<span class="id">intros</span>; <span class="id">repeat</span> (<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_simpl">FIXP_simpl</a></span>); <span class="id">repeat</span> (<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixp_simpl">Fixp_simpl</a></span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp_le_compat">fixp_le_compat</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">FIXP_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FIXP_eq_compat">FIXP_eq_compat</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id">D</span>-<span class="id">C</span>-&gt;<span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> == <span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">f</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">g</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">FIXP_eq_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FIXP_eq">FIXP_eq</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D</span>-<span class="id">c</span>&gt;<span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">f</span> == <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">f</span>).<br/>
<span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_simpl">FIXP_simpl</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixp_simpl">Fixp_simpl</a></span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp_eq">fixp_eq</a></span> (<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">f</span>)).<br/>
<span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">FIXP_eq</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FIXP_inv">FIXP_inv</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D</span>-<span class="id">c</span>&gt;<span class="id">D</span>)(<span class="id">g</span> : <span class="id">D</span>), <span class="id">f</span> <span class="id">g</span> &lt;= <span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">f</span> &lt;= <span class="id">g</span>.<br/>
<span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_simpl">FIXP_simpl</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixp_simpl">Fixp_simpl</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp_inv">fixp_inv</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<h3> Iteration of functional </h3>
<span class="kwd">Lemma</span> <span class="id"><a name="FIXP_comp_com">FIXP_comp_com</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id">D</span>-<span class="id">c</span>&gt;<span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">g</span> @_ <span class="id">f</span> &lt;= <span class="id">f</span> @_ <span class="id">g</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">g</span> &lt;= <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">g</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_inv">FIXP_inv</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> (<span class="id">g</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">g</span>))).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_le_elim">fcont_le_elim</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">g</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_monotonic">fcont_monotonic</a></span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="id">g</span>); <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FIXP_comp">FIXP_comp</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span> <span class="id">g</span>:<span class="id">D</span>-<span class="id">c</span>&gt;<span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">g</span> @_ <span class="id">f</span> &lt;= <span class="id">f</span> @_ <span class="id">g</span> -&gt; <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">g</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> (<span class="id">f</span> @_ <span class="id">g</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">g</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_inv">FIXP_inv</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">g</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_inv">FIXP_inv</a></span>.<br/>
<span class="id">assert</span> (<span class="id">g</span> (<span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> (<span class="id">f</span> @_ <span class="id">g</span>))) &lt;= <span class="id">f</span> (<span class="id">g</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> (<span class="id">f</span> @_ <span class="id">g</span>)))).<br/>
<span class="id">apply</span> (<span class="id">H</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> (<span class="id">f</span> @_ <span class="id">g</span>))).<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> (<span class="id">f</span>@<span class="id">_g</span>)); <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (2:=<span class="id">H3</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (2:=<span class="id">H1</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_monotonic">fcont_monotonic</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_inv">FIXP_inv</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_monotonic">fcont_monotonic</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (1:=<span class="id">H1</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="fcont_compn">fcont_compn</a></span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">f</span>:<span class="id">D</span>-<span class="id">c</span>&gt;<span class="id">D</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) {<span class="id">struct</span> <span class="id">n</span>} : <span class="id">D</span>-<span class="id">c</span>&gt;<span class="id">D</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id">f</span> | <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">p</span> =&gt; <span class="id">fcont_compn</span> <span class="id">f</span> <span class="id">p</span> @_ <span class="id">f</span> <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fcont_compn_com">fcont_compn_com</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">f</span>:<span class="id">D</span>-<span class="id">c</span>&gt;<span class="id">D</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_compn">fcont_compn</a></span> <span class="id">f</span> <span class="id">n</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_compn">fcont_compn</a></span> <span class="id">f</span> <span class="id">n</span> @_ <span class="id">f</span>.<br/>
<span class="id">induction</span> <span class="id">n</span>; <span class="id">auto</span>.<br/>
<span class="id">simpl</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_compn">fcont_compn</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> ((<span class="id">f</span> @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_compn">fcont_compn</a></span> (<span class="id">D</span>:=<span class="id">D</span>) <span class="id">f</span> <span class="id">n</span>) @_ <span class="id">f</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FIXP_compn">FIXP_compn</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D</span>-<span class="id">c</span>&gt;<span class="id">D</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_compn">fcont_compn</a></span> <span class="id">f</span> <span class="id">n</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">f</span>.<br/>
<span class="id">induction</span> <span class="id">n</span>; <span class="id">auto</span>.<br/>
<span class="id">simpl</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_compn">fcont_compn</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_comp">FIXP_comp</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_compn_com">fcont_compn_com</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_compn">fcont_compn</a></span> (<span class="id">D</span>:=<span class="id">D</span>) <span class="id">f</span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_compn">fcont_compn</a></span> (<span class="id">D</span>:=<span class="id">D</span>) <span class="id">f</span> <span class="id">n</span>))); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_compn">fcont_compn</a></span> (<span class="id">D</span>:=<span class="id">D</span>) <span class="id">f</span> <span class="id">n</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fixp_double">fixp_double</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">f</span>:<span class="id">D</span>-<span class="id">c</span>&gt;<span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> (<span class="id">f</span> @_ <span class="id">f</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">D</span> <span class="id">f</span>.<br/>
<span class="id">intros</span>; <span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_compn">FIXP_compn</a></span> <span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>)).<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FIXP_proj">FIXP_proj</a></span> : <span class="kwd">forall</span> (<span class="id">I</span>:<span class="kwd">Type</span>)(<span class="id">DI</span>: <span class="id">I</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">F</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">DI</span> -<span class="id">c</span>&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">DI</span>) (<span class="id">i</span>:<span class="id">I</span>) (<span class="id">fi</span> : <span class="id">DI</span> <span class="id">i</span> -<span class="id">c</span>&gt; <span class="id">DI</span> <span class="id">i</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">X</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">DI</span>, <span class="id">F</span> <span class="id">X</span> <span class="id">i</span> == <span class="id">fi</span> (<span class="id">X</span> <span class="id">i</span>)) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">DI</span>) <span class="id">F</span> <span class="id">i</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> (<span class="id">DI</span> <span class="id">i</span>) <span class="id">fi</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_simpl">FIXP_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fixp_simpl">Fixp_simpl</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi_lub_simpl">Dprodi_lub_simpl</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span> .<br/>
<span class="id">induction</span> <span class="id">n</span>; <span class="id">auto</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_simpl">fmon_comp_simpl</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iterS_simpl">iterS_simpl</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">F</span>)).<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Proj_simpl">Proj_simpl</a></span> (<span class="id">O</span>:=<span class="id">DI</span>) <span class="id">i</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">fi</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter">iter</a></span> (<span class="id">D</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">DI</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">F</span>) <span class="id">n</span> <span class="id">i</span>)).<br/>
<span class="id">case</span> (<span class="id">H</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#iter">iter</a></span> (<span class="id">D</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">DI</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id">F</span>) <span class="id">n</span>)); <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">fi</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> (<span class="id">DI</span> <span class="id">i</span>) <span class="id">fi</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_inv">FIXP_inv</a></span>.<br/>
<span class="id">case</span> (<span class="id">H</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id">DI</span>) <span class="id">F</span>)); <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (1:=<span class="id">H1</span>).<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="id">F</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<h3> Induction principle </h3>
<span class="kwd">Definition</span> <span class="id"><a name="admissible">admissible</a></span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">P</span>:<span class="id">D</span>-&gt;<span class="kwd">Type</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">D</span>, (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">P</span> (<span class="id">f</span> <span class="id">n</span>)) -&gt; <span class="id">P</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">f</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fixp_ind">fixp_ind</a></span> : <span class="kwd">forall</span>  (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">F</span>:<span class="id">D</span> -<span class="id">m</span>&gt; <span class="id">D</span>)(<span class="id">P</span>:<span class="id">D</span>-&gt;<span class="kwd">Type</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#admissible">admissible</a></span> <span class="id">P</span> -&gt; <span class="id">P</span> 0 -&gt; (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">P</span> <span class="id">x</span> -&gt; <span class="id">P</span> (<span class="id">F</span> <span class="id">x</span>)) -&gt; <span class="id">P</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span> <span class="id">F</span>).<br/>
<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp">fixp</a></span>.<br/>
<span class="id">apply</span> <span class="id">X</span>; <span class="id">intros</span>.<br/>
<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<h2> Directed complete partial orders without minimal element </h2>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="dcpo">dcpo</a></span> : <span class="kwd">Type</span> := <span class="id">mk_dcpo</span><br/>
&nbsp;&nbsp;{<span class="id"><a name="tdcpo">tdcpo</a></span>:&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>; <span class="id"><a name="dlub">dlub</a></span>: (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">tdcpo</span>) -&gt; <span class="id">tdcpo</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a name="le_dlub">le_dlub</a></span> : <span class="kwd">forall</span> (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">tdcpo</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id">f</span> <span class="id">n</span> &lt;= <span class="id">dlub</span> <span class="id">f</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a name="dlub_le">dlub_le</a></span> : <span class="kwd">forall</span> (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">tdcpo</span>) (<span class="id">x</span>:<span class="id">tdcpo</span>), (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">f</span> <span class="id">n</span> &lt;= <span class="id">x</span>) -&gt; <span class="id">dlub</span> <span class="id">f</span> &lt;= <span class="id">x</span>}.<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">le_dlub</span> <span class="id">dlub_le</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="dlub_le_compat">dlub_le_compat</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#dcpo">dcpo</a></span>)(<span class="id">f1</span> <span class="id">f2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">D</span>), <span class="id">f1</span> &lt;= <span class="id">f2</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#dlub">dlub</a></span> <span class="id">f1</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#dlub">dlub</a></span> <span class="id">f2</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#dlub_le">dlub_le</a></span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f2</span> <span class="id">n</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">dlub_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="dlub_eq_compat">dlub_eq_compat</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#dcpo">dcpo</a></span>)(<span class="id">f1</span> <span class="id">f2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id">D</span>), <span class="id">f1</span> == <span class="id">f2</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#dlub">dlub</a></span> <span class="id">f1</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#dlub">dlub</a></span> <span class="id">f2</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">dlub_eq_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="dlub_lift_right">dlub_lift_right</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#dcpo">dcpo</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id">D</span>) <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#dlub">dlub</a></span> <span class="id">f</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#dlub">dlub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_right">mseq_lift_right</a></span> <span class="id">f</span> <span class="id">n</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#dlub_le_compat">dlub_le_compat</a></span>; <span class="id">intro</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_right">mseq_lift_right</a></span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">dlub_lift_right</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="dlub_cte">dlub_cte</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#dcpo">dcpo</a></span>) (<span class="id">c</span>:<span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#dlub">dlub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_cte">mseq_cte</a></span> <span class="id">c</span>) == <span class="id">c</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#le_dlub">le_dlub</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> <span class="id">c</span>) (<span class="id">n</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<br/>
<h3> A cpo is a dcpo </h3>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="cpo_dcpo">cpo_dcpo</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#dcpo">dcpo</a></span>.<br/>
<span class="id">intro</span> <span class="id">D</span>; <span class="kwd">exists</span> <span class="id">D</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">D</span>)); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<h2> Setoid type </h2>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="setoid">setoid</a></span> : <span class="kwd">Type</span> := <span class="id">mk_setoid</span><br/>
&nbsp;&nbsp;{<span class="id"><a name="tset">tset</a></span>:&gt;<span class="kwd">Type</span>; <span class="id"><a name="Seq">Seq</a></span>:<span class="id">tset</span>-&gt;<span class="id">tset</span>-&gt;<span class="kwd">Prop</span>; <span class="id"><a name="Seq_refl">Seq_refl</a></span> : <span class="kwd">forall</span> <span class="id">x</span> :<span class="id">tset</span>, <span class="id">Seq</span> <span class="id">x</span> <span class="id">x</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a name="Seq_sym">Seq_sym</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>:<span class="id">tset</span>, <span class="id">Seq</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">Seq</span> <span class="id">y</span> <span class="id">x</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a name="Seq_trans">Seq_trans</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>:<span class="id">tset</span>, <span class="id">Seq</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">Seq</span> <span class="id">y</span> <span class="id">z</span> -&gt; <span class="id">Seq</span> <span class="id">x</span> <span class="id">z</span>}.<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Seq_refl</span> : <span class="id">core</span>.<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">Seq_sym</span> : <span class="id">core</span>.<br/>
<br/>
<h3> A setoid is an ordered set </h3>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="setoid_ord">setoid_ord</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#setoid">setoid</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>.<br/>
<span class="id">intro</span> <span class="id">S</span>; <span class="kwd">exists</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Seq">Seq</a></span> (<span class="id">s</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span>)); <span class="id">auto</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Seq_trans">Seq_trans</a></span> <span class="kwd">with</span> <span class="id">y</span>; <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ord_setoid">ord_setoid</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#setoid">setoid</a></span>.<br/>
<span class="id">intro</span> <span class="id">O</span>; <span class="kwd">exists</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id">O</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>)); <span class="id">auto</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> <span class="id">y</span>; <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<h3> A Type is an ordered set and a setoid with Leibniz equality </h3>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="type_ord">type_ord</a></span> (<span class="id">X</span>:<span class="kwd">Type</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>.<br/>
<span class="kwd">exists</span> <span class="id">X</span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span>:<span class="id">X</span> =&gt; <span class="id">x</span> = <span class="id">y</span>); <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">transitivity</span> <span class="id">y</span>; <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="type_setoid">type_setoid</a></span> (<span class="id">X</span>:<span class="kwd">Type</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#setoid">setoid</a></span>.<br/>
<span class="kwd">exists</span> <span class="id">X</span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span>:<span class="id">X</span> =&gt; <span class="id">x</span> = <span class="id">y</span>); <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">transitivity</span> <span class="id">y</span>; <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<h3> A setoid is a dcpo </h3>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="lub_eq">lub_eq</a></span> (<span class="id">S</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#setoid">setoid</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#setoid_ord">setoid_ord</a></span> <span class="id">S</span>) := <span class="id">f</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_lub_eq">le_lub_eq</a></span>  : <span class="kwd">forall</span> (<span class="id">S</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#setoid">setoid</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#setoid_ord">setoid_ord</a></span> <span class="id">S</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id">f</span> <span class="id">n</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_eq">lub_eq</a></span> <span class="id">f</span>.<br/>
<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_eq">lub_eq</a></span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Seq_sym">Seq_sym</a></span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span>); <span class="id">simpl</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_eq_le">lub_eq_le</a></span>  : <span class="kwd">forall</span> (<span class="id">S</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#setoid">setoid</a></span>) (<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#setoid_ord">setoid_ord</a></span> <span class="id">S</span>)(<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#setoid_ord">setoid_ord</a></span> <span class="id">S</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id">f</span> <span class="id">n</span> &lt;= <span class="id">x</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_eq">lub_eq</a></span> <span class="id">f</span> &lt;= <span class="id">x</span>.<br/>
<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_eq">lub_eq</a></span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">exact</span> (<span class="id">H</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>).<br/>
Qed.
<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">le_lub_eq</span> <span class="id">lub_eq_le</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="setoid_dcpo">setoid_dcpo</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#setoid">setoid</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#dcpo">dcpo</a></span>.<br/>
<span class="id">intro</span> <span class="id">S</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#setoid_ord">setoid_ord</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_eq">lub_eq</a></span> (<span class="id">S</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span>)); <span class="id">intros</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<div class="doc">Cpo of arrays seen as functions from nat to D with a bound n </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="lek">lek</a></span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id">O</span>) := <span class="kwd">forall</span> <span class="id">n</span>, <span class="id">n</span> &lt; <span class="id">k</span> -&gt; <span class="id">f</span> <span class="id">n</span> &lt;= <span class="id">g</span> <span class="id">n</span>.<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lek">lek</a></span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lek_refl">lek_refl</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) <span class="id">k</span> (<span class="id">f</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id">O</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lek">lek</a></span> <span class="id">k</span> <span class="id">f</span> <span class="id">f</span>.<br/>
<span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">lek_refl</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lek_trans">lek_trans</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">f</span> <span class="id">g</span> <span class="id">h</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id">O</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lek">lek</a></span> <span class="id">k</span> <span class="id">f</span> <span class="id">g</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lek">lek</a></span> <span class="id">k</span> <span class="id">g</span> <span class="id">h</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lek">lek</a></span> <span class="id">k</span> <span class="id">f</span> <span class="id">h</span>.<br/>
<span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">g</span> <span class="id">n</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="natk_ord">natk_ord</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>.<br/>
<span class="id">intros</span> <span class="id">O</span> <span class="id">k</span>; <span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="id">O</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lek">lek</a></span> (<span class="id">O</span>:=<span class="id">O</span>) <span class="id">k</span>); <span class="id">auto</span>.<br/>
<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lek_trans">lek_trans</a></span> (<span class="id">O</span>:=<span class="id">O</span>) (<span class="id">k</span>:=<span class="id">k</span>)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="norm">norm</a></span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x</span>:<span class="id">O</span>) (<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">f</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> <span class="id">O</span> <span class="id">k</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> <span class="id">O</span> <span class="id">k</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Compare_dec.html#le_lt_dec">le_lt_dec</a></span> <span class="id">k</span> <span class="id">n</span> <span class="kwd">then</span> <span class="id">x</span> <span class="kwd">else</span> <span class="id">f</span> <span class="id">n</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_simpl_lt">norm_simpl_lt</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x</span>:<span class="id">O</span>) (<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">f</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> <span class="id">O</span> <span class="id">k</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n</span> &lt; <span class="id">k</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#norm">norm</a></span> <span class="id">x</span> <span class="id">f</span> <span class="id">n</span> = <span class="id">f</span> <span class="id">n</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#norm">norm</a></span>; <span class="id">intros</span>; <span class="id">case</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Compare_dec.html#le_lt_dec">le_lt_dec</a></span> <span class="id">k</span> <span class="id">n</span>); <span class="id">auto</span>.<br/>
<span class="id">lia</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_simpl_le">norm_simpl_le</a></span> : <span class="kwd">forall</span> (<span class="id">O</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>) (<span class="id">x</span>:<span class="id">O</span>) (<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">f</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> <span class="id">O</span> <span class="id">k</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> &lt;= <span class="id">n</span>)%<span class="id">nat</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#norm">norm</a></span> <span class="id">x</span> <span class="id">f</span> <span class="id">n</span> = <span class="id">x</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#norm">norm</a></span>; <span class="id">intros</span>; <span class="id">case</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Compare_dec.html#le_lt_dec">le_lt_dec</a></span> <span class="id">k</span> <span class="id">n</span>); <span class="id">auto</span>.<br/>
<span class="id">lia</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="natk_mon_shift">natk_mon_shift</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>)(<span class="id">x</span>:<span class="id">O2</span>) (<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> <span class="id">O2</span> <span class="id">k</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>) <span class="id">k</span>.<br/>
<span class="id">intros</span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">x</span> <span class="id">k</span> <span class="id">f</span> <span class="id">n</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> (<span class="id">y</span>:<span class="id">O1</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#norm">norm</a></span> <span class="id">x</span> (<span class="id">f</span> <span class="id">y</span>) <span class="id">n</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Compare_dec.html#le_lt_dec">le_lt_dec</a></span> <span class="id">k</span> <span class="id">n</span>); <span class="id">intro</span>.<br/>
<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#norm_simpl_le">norm_simpl_le</a></span>; <span class="id">auto</span>.<br/>
<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#norm_simpl_lt">norm_simpl_lt</a></span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">f</span> <span class="id">H</span> <span class="id">n</span>); <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="natk_mon_shift_simpl">natk_mon_shift_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>)(<span class="id">x</span>:<span class="id">O2</span>) (<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)(<span class="id">f</span>:<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> <span class="id">O2</span> <span class="id">k</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">y</span>:<span class="id">O1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_mon_shift">natk_mon_shift</a></span> <span class="id">x</span> <span class="id">f</span> <span class="id">n</span> <span class="id">y</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#norm">norm</a></span> <span class="id">x</span> (<span class="id">f</span> <span class="id">y</span>) <span class="id">n</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="natk_shift_mon">natk_shift_mon</a></span> : <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>)(<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>) <span class="id">k</span>) -&gt; <span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> <span class="id">O2</span> <span class="id">k</span>.<br/>
<span class="id">intros</span> <span class="id">O1</span> <span class="id">O2</span> <span class="id">k</span> <span class="id">f</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> (<span class="id">y</span>:<span class="id">O1</span>) <span class="id">n</span> =&gt; <span class="id">f</span> <span class="id">n</span> <span class="id">y</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">intros</span> <span class="id">n</span> <span class="id">H1</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id">f</span> <span class="id">n</span>)); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="natk_shift_mon_simpl">natk_shift_mon_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">forall</span> (<span class="id">O1</span> <span class="id">O2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span>)(<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)(<span class="id">f</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> (<span class="id">O1</span> -<span class="id">m</span>&gt; <span class="id">O2</span>) <span class="id">k</span>) (<span class="id">x</span>:<span class="id">O1</span>)(<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_shift_mon">natk_shift_mon</a></span> <span class="id">f</span> <span class="id">x</span> <span class="id">n</span> = <span class="id">f</span> <span class="id">n</span> <span class="id">x</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="natk0">natk0</a></span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> <span class="id">D</span> <span class="id">k</span> := <span class="kwd">fun</span> <span class="id">n</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (0:<span class="id">D</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="natklub">natklub</a></span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">h</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> <span class="id">D</span> <span class="id">k</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> <span class="id">D</span> <span class="id">k</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_mon_shift">natk_mon_shift</a></span> (0:<span class="id">D</span>) <span class="id">h</span> <span class="id">n</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="natklub_less">natklub_less</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">h</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> <span class="id">D</span> <span class="id">k</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">h</span> <span class="id">n</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natklub">natklub</a></span> <span class="id">h</span>.<br/>
<span class="id">simpl</span>; <span class="id">red</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natklub">natklub</a></span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_mon_shift">natk_mon_shift</a></span> (<span class="id">O1</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>) (<span class="id">O2</span>:=<span class="id">D</span>) 0 (<span class="id">k</span>:=<span class="id">k</span>) <span class="id">h</span> <span class="id">n0</span> <span class="id">n</span>); <span class="id">auto</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_mon_shift_simpl">natk_mon_shift_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#norm_simpl_lt">norm_simpl_lt</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="natklub_least">natklub_least</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">h</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> <span class="id">D</span> <span class="id">k</span>) (<span class="id">p</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> <span class="id">D</span> <span class="id">k</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>, <span class="id">h</span> <span class="id">n</span> &lt;= <span class="id">p</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natklub">natklub</a></span> <span class="id">h</span> &lt;= <span class="id">p</span>.<br/>
<span class="id">simpl</span>; <span class="id">red</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natklub">natklub</a></span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le">lub_le</a></span>; <span class="id">intros</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_mon_shift_simpl">natk_mon_shift_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#norm_simpl_lt">norm_simpl_lt</a></span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id">H</span> <span class="id">n0</span> <span class="id">n</span> <span class="id">H0</span>).<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Dnatk">Dnatk</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_ord">natk_ord</a></span> <span class="id">D</span> <span class="id">k</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk0">natk0</a></span> <span class="id">D</span> <span class="id">k</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natklub">natklub</a></span> (<span class="id">D</span>:=<span class="id">D</span>) (<span class="id">k</span>:=<span class="id">k</span>)).<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk0">natk0</a></span>; <span class="id">auto</span>.<br/>
<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natklub_less">natklub_less</a></span> (<span class="id">D</span>:=<span class="id">D</span>) (<span class="id">k</span>:=<span class="id">k</span>)).<br/>
<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natklub_least">natklub_least</a></span> (<span class="id">D</span>:=<span class="id">D</span>) (<span class="id">k</span>:=<span class="id">k</span>)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Notation</span> <span class="string">"k --&gt; D"</span> := (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dnatk">Dnatk</a></span> <span class="id">D</span> <span class="id">k</span>) (<span class="kwd">at</span> <span class="id">level</span> 55, <span class="id">right</span> <span class="id">associativity</span>) : <span class="id">O_scope</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="natk_shift_cont">natk_shift_cont</a></span> : <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> --&gt; (<span class="id">D1</span>-<span class="id">C</span>-&gt;<span class="id">D2</span>)) -&gt; <span class="id">D1</span> -<span class="id">c</span>&gt; (<span class="id">k</span> --&gt; <span class="id">D2</span>).<br/>
<span class="id">intros</span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">k</span> <span class="id">f</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_shift_mon">natk_shift_mon</a></span> (<span class="id">k</span>:=<span class="id">k</span>) (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id">f</span> <span class="id">n</span>))).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">intros</span> <span class="id">n</span> <span class="id">H</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_shift_mon_simpl">natk_shift_mon_simpl</a></span> (<span class="id">O1</span>:=<span class="id">D1</span>) (<span class="id">O2</span>:=<span class="id">D2</span>) (<span class="id">k</span>:=<span class="id">k</span>)).<br/>
<span class="id">simpl</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natklub">natklub</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id">f</span> <span class="id">n</span>) @ <span class="id">h</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">intro</span> <span class="id">m</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_simpl">fmon_comp_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_mon_shift_simpl">natk_mon_shift_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#norm_simpl_lt">norm_simpl_lt</a></span>; <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="natk_shift_cont_simpl">natk_shift_cont_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">forall</span> (<span class="id">D1</span> <span class="id">D2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>)(<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)(<span class="id">f</span>:<span class="id">k</span> --&gt; (<span class="id">D1</span>-<span class="id">C</span>-&gt;<span class="id">D2</span>)) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">x</span>:<span class="id">D1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_shift_cont">natk_shift_cont</a></span> <span class="id">f</span> <span class="id">x</span> <span class="id">n</span> = <span class="id">f</span> <span class="id">n</span> <span class="id">x</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="natklub_simpl">natklub_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>) (<span class="id">k</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">h</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; (<span class="id">k</span> --&gt; <span class="id">D</span>)) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span> <span class="id">n</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natk_mon_shift">natk_mon_shift</a></span> (0:<span class="id">D</span>) <span class="id">h</span> <span class="id">n</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
