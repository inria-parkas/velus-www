
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module ResetMask</title>
<meta name="description" content="Documentation of Coq module ResetMask" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
</head>

<body>
<h1 class="title">Module ResetMask</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.CommonTactics.html">Common.CommonTactics</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.html">Cpo</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html">SDfuns</a></span>.<br/>
<br/>
<h1> Facts about resetting and masking </h1>
<br/>
<span class="kwd">Ltac</span> <span class="id">revert_all</span> :=<br/>
&nbsp;&nbsp;<span class="id">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:_ |- _ =&gt; <span class="id">revert</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> <span class="string">"remember_ds"</span> <span class="id">uconstr</span>(<span class="id">s</span>) <span class="string">"as"</span> <span class="id">ident</span>(<span class="id">x</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Hx</span> := <span class="id">fresh</span> <span class="string">"H"</span><span class="id">x</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">remember</span> <span class="id">s</span> <span class="kwd">as</span> <span class="id">x</span> <span class="id">eqn</span>:<span class="id">Hx</span>;<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_refl_eq">Oeq_refl_eq</a></span> <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
<br/>
<h2> Mask de flot en version d√©notationnelle </h2>
<span class="kwd">Section</span> <span class="id"><a name="Smask">Smask</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id"><a name="Smask.A">A</a></span> : <span class="kwd">Type</span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="smaskf">smaskf</a></span> : (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Smask.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Smask.A">A</a></span>)) -<span class="id">C</span>-&gt; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Smask.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Smask.A">A</a></span>)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>. <span class="id">intro</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> _)). 2: <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>. <span class="id">intro</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- _ (_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) _) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">mask'</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_ford_shift">fcont_ford_shift</a></span> _ _ _ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">X</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">R</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">k</span> <span class="kwd">as</span> [|[|<span class="id">k</span>]].<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#CTE">CTE</a></span>, (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP">APP</a></span> _ @2_ <span class="id">X</span>) ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @3_ (<span class="id">mask'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>)) <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ @_ <span class="id">X</span>))).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP">APP</a></span> _ @2_ <span class="id">X</span>) ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @3_ (<span class="id">mask'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>)) <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ @_ <span class="id">X</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) @_ ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @3_ (<span class="id">mask'</span> 1)) <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ @_ <span class="id">X</span>))).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) @_ ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @3_ (<span class="id">mask'</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>))) <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ @_ <span class="id">X</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) @_ ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @3_ (<span class="id">mask'</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>)))) <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ @_ <span class="id">X</span>))).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="smaskf_eq">smaskf_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">k</span> <span class="id">r</span> <span class="id">rs</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Smask.A">A</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smaskf">smaskf</a></span> <span class="id">f</span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">r</span> <span class="id">rs</span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">match</span> <span class="id">k</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="kwd">if</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">xs</span> (<span class="id">f</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; <span class="kwd">if</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">xs</span> (<span class="id">f</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id">f</span> 1 <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> _ <span class="kwd">as</span> <span class="id">k'</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id">f</span> <span class="id">k'</span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id">f</span> <span class="id">k</span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smaskf">smaskf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2_simpl">fcont_comp2_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">k</span> <span class="kwd">as</span> [|[]], <span class="id">r</span>; <span class="id">cbn</span>; <span class="id">now</span> <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="smask">smask</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Smask.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Smask.A">A</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smaskf">smaskf</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="smask_eq">smask_eq</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">r</span> <span class="id">rs</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Smask.A">A</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">r</span> <span class="id">rs</span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">match</span> <span class="id">k</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="kwd">if</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; <span class="kwd">if</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> 1 <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> _ <span class="kwd">as</span> <span class="id">k'</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k'</span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Heq</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smaskf">smaskf</a></span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> <span class="id">Heq</span>) <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smaskf_eq">smaskf_eq</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_smask">is_cons_smask</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">rs</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smaskf">smaskf</a></span>) _) <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_is_cons">DScase_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="smask_inf">smask_inf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">rs</span> (<span class="id">xs</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Smask.A">A</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">rs</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>) <span class="kwd">as</span> <span class="id">sm</span> <span class="id">eqn</span>:<span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_refl_eq">Oeq_refl_eq</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span> * <span class="id">rsi</span> <span class="id">xsi</span> <span class="id">sm</span> <span class="id">Hsm</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">rsi</span> <span class="kwd">as</span> (<span class="id">r</span>&amp;<span class="id">rs'</span>&amp; <span class="id">Hr</span> &amp;?).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">xsi</span> <span class="kwd">as</span> (<span class="id">x</span>&amp;<span class="id">xs'</span>&amp; <span class="id">Hx</span> &amp;?).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr</span>, <span class="id">Hx</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span> <span class="kwd">in</span> <span class="id">Hsm</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">k</span> <span class="kwd">as</span> [|[]], <span class="id">r</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hsm</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_inf">DS_const_inf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>:  <span class="id">constructor</span>; [| <span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">eauto</span> 1 ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hsm</span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_smask_false">take_smask_false</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">R</span> (<span class="id">X</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Smask.A">A</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">R</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">X</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span> * <span class="id">Heq</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)), <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> _ <span class="id">R</span>) <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">R'</span> &amp; <span class="id">Hr</span>).<br/>
&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Heq</span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Heq</span> <span class="kwd">as</span> []; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_app">app_app</a></span>, &lt;- (<span class="id">IHn</span> <span class="id">R'</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">X</span>)), <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_rem_app">app_rem_app</a></span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Smask">Smask</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="bool_of_sbool">bool_of_sbool</a></span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| _ =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bool_of_sbool_pres">bool_of_sbool_pres</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#bool_of_sbool">bool_of_sbool</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">s</span>) == <span class="id">s</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#bool_of_sbool">bool_of_sbool</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">V</span>)); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> * -&gt; ? &lt;-; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span>; <span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> _ <span class="id">V</span>) <span class="kwd">as</span> (<span class="id">v</span> &amp; <span class="id">V'</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>; <span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Hu</span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hv</span>, <span class="id">Hu</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#bool_of_sbool">bool_of_sbool</a></span>; <span class="id">cases</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="AC_smask">AC_smask</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">k</span> <span class="id">rs</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#bool_of_sbool">bool_of_sbool</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span>))).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#bool_of_sbool">bool_of_sbool</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span>)))).<br/>
&nbsp;&nbsp;3: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">k</span> &amp; <span class="id">rs</span> &amp; <span class="id">xs</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> _ <span class="id">rs</span>) <span class="kwd">as</span> (<span class="id">vr</span> &amp; <span class="id">rs'</span> &amp; <span class="id">Hrs</span>).<br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [?%<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>%<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#is_cons_smask">is_cons_smask</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|?%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>%<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#is_cons_smask">is_cons_smask</a></span>]. }<br/>
<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;first&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>, <span class="id">Hrs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#first_AC">first_AC</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_map">first_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span>; <span class="id">cases</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_bot">map_bot</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2: <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_app_first">first_app_first</a></span>, 3 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_map">first_map</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_comp">map_comp</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_ext">DS_ext.map_ext</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> 1; <span class="id">intros</span>; <span class="id">cases</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_bot">map_bot</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;rem&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span> <span class="kwd">in</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span> <span class="kwd">in</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;cas&nbsp;toujours&nbsp;absent&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>, (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> 0), 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 4 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;les&nbsp;autres&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">eexists</span> _, <span class="id">rs'</span>, (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#rem_AC">rem_AC</a></span>, 4 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_map">rem_map</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#rem_AC">rem_AC</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;reste&nbsp;les&nbsp;is_cons&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [<span class="id">Hc</span>%<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">Hc</span>%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>%<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_map">is_cons_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="smask_or_ad_hoc">smask_or_ad_hoc</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">k</span> <span class="id">rs</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>)) <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#orb">orb</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#bool_of_sbool">bool_of_sbool</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">bs</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#bool_of_sbool">bool_of_sbool</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#orb">orb</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span>) <span class="id">bs</span>))).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#orb">orb</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#bool_of_sbool">bool_of_sbool</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">bs</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#bool_of_sbool">bool_of_sbool</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#orb">orb</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span>) <span class="id">bs</span>)))).<br/>
&nbsp;&nbsp;3: <span class="id">eauto</span> 10.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">k</span> &amp; <span class="id">rs</span> &amp; <span class="id">xs</span> &amp; <span class="id">bs</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> _ <span class="id">rs</span>) <span class="kwd">as</span> (<span class="id">vr</span> &amp; <span class="id">rs'</span> &amp; <span class="id">Hrs</span>).<br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [[?%<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>%<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#is_cons_smask">is_cons_smask</a></span>]%<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|?%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>%<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#is_cons_smask">is_cons_smask</a></span>]; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;first&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>, <span class="id">Hrs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_zip">first_zip</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#first_AC">first_AC</a></span>, 3 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_map">first_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 3 <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span>; <span class="id">cases</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_bot">map_bot</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_bot1">zip_bot1</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2: <span class="id">rewrite</span> 3 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_app_first">first_app_first</a></span>, 3 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_map">first_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_zip">first_zip</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_map">first_map</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_comp">map_comp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2: <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_map">zip_map</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_zip">map_zip</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_ext">zip_ext</a></span>; <span class="id">eauto</span> 1; <span class="id">intros</span> [] []; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> 3 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_bot">map_bot</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_bot1">zip_bot1</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;rem&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span> <span class="kwd">in</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span> <span class="kwd">in</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;cas&nbsp;toujours&nbsp;absent&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>, (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> 0), 0, 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 8 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, 3 <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;les&nbsp;autres&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">eexists</span> _, <span class="id">rs'</span>, (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">bs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_zip">rem_zip</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#rem_AC">rem_AC</a></span>, 8 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, 4 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_map">rem_map</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_zip">rem_zip</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#rem_AC">rem_AC</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;reste&nbsp;les&nbsp;is_cons&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [[<span class="id">Hc</span>%<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span> <span class="id">Hr</span>%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>]%<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">Hc</span>%<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>]%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>%<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_map">is_cons_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_zip">is_cons_zip</a></span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Env">Env</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id"><a name="Env.I">I</a></span> <span class="id"><a name="Env.A">A</a></span> : <span class="kwd">Type</span>}.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="SI">SI</a></span> := @<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SDfuns.SI</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.I">I</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.A">A</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Env.Smask_env">Smask_env</a></span>.<br/>
<br/>
<h2> Masque sur les environnements d√©notationnels
    d√©fini ind√©pendamment de <span class="bracket"><span class="id">smask</span></span>, en utilisant plut√¥t
    APP_env, REM_env etc. </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="smask_envf">smask_envf</a></span> : (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>; <span class="id">intro</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- _ (_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) _) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">mask</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_ford_shift">fcont_ford_shift</a></span> _ _ _ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">R</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> _ _ @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">X</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> _ @2_ _) <span class="id">R</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>; <span class="id">intro</span> <span class="id">r</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span> (_ @_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> _ _)).<br/>
<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">k</span> <span class="kwd">as</span> [|[|<span class="id">k</span>]].<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#CTE">CTE</a></span>, (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP">APP</a></span> _ @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">x</span> @_ <span class="id">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">x</span> @_ ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @3_ (<span class="id">mask</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ @_ <span class="id">R</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> @_ <span class="id">X</span>)))).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP">APP</a></span> _ @2_ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">x</span> @_ <span class="id">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">x</span> @_ ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @3_ (<span class="id">mask</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ @_ <span class="id">R</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> @_ <span class="id">X</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">x</span> @_ ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @3_ (<span class="id">mask</span> 1)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ @_ <span class="id">R</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> @_ <span class="id">X</span>)))).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">x</span> @_ ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @3_ (<span class="id">mask</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>))) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ @_ <span class="id">R</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> @_ <span class="id">X</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> @_ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">x</span> @_ ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> _ _ @3_ (<span class="id">mask</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>)))) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ @_ <span class="id">R</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> @_ <span class="id">X</span>)))).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="smask_envf_eq">smask_envf_eq</a></span> : <span class="kwd">forall</span> <span class="id">F</span> <span class="id">k</span> <span class="id">r</span> <span class="id">R</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_envf">smask_envf</a></span> <span class="id">F</span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">r</span> <span class="id">R</span>) <span class="id">X</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">match</span> <span class="id">k</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="kwd">if</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="kwd">fun</span> _ =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> (<span class="id">F</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; <span class="kwd">if</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> (<span class="id">F</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> (<span class="kwd">fun</span> _ =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) (<span class="id">F</span> 1 <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> _ <span class="kwd">as</span> <span class="id">k'</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> (<span class="kwd">fun</span> _ =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) (<span class="id">F</span> <span class="id">k'</span> <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> (<span class="kwd">fun</span> _ =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) (<span class="id">F</span> <span class="id">k</span> <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_envf">smask_envf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2_simpl">fcont_comp2_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">k</span> <span class="kwd">as</span> [|[]], <span class="id">r</span>; <span class="id">cbn</span>; <span class="id">now</span> <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="smask_env">smask_env</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_envf">smask_envf</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="smask_env_eq">smask_env_eq</a></span> : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">r</span> <span class="id">R</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">r</span> <span class="id">R</span>) <span class="id">X</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">match</span> <span class="id">k</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="kwd">if</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="kwd">fun</span> _ =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; <span class="kwd">if</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> (<span class="kwd">fun</span> _ =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> 1 <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> _ <span class="kwd">as</span> <span class="id">k'</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> (<span class="kwd">fun</span> _ =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k'</span> <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> (<span class="kwd">fun</span> _ =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Heq</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_envf">smask_envf</a></span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> <span class="id">Heq</span>) <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_envf_eq">smask_envf_eq</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="smask_env_eq_1">smask_env_eq_1</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rs</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> 1 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id">rs</span>) <span class="id">X</span> == <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">rs</span>) <span class="id">X</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_smask_env">is_cons_smask_env</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">rs</span> <span class="id">X</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">X</span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">rs</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_envf">smask_envf</a></span>) _),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_is_cons">DScase_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="smask_env_all_inf">smask_env_all_inf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">R</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> <span class="id">X</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hr</span> <span class="id">HX</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_ds</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span> <span class="id">x</span>) <span class="kwd">as</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>; <span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Hr</span> <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">R'</span> &amp; <span class="id">Hr</span> &amp;?).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id">Hr</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">HX</span> <span class="id">x</span>) <span class="kwd">as</span> <span class="id">Infx</span>; <span class="id">inv</span> <span class="id">Infx</span>.<br/>
&nbsp;&nbsp;<span class="id">cases</span>.<br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Ht</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_inf">DS_const_inf</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DMAPi_simpl">DMAPi_simpl</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS_simpl">CONS_simpl</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_eq_compat">rem_eq_compat</a></span> <span class="kwd">in</span> <span class="id">Ht</span> <span class="kwd">as</span> <span class="id">Hrt</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP_simpl">APP_simpl</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS_simpl">CONS_simpl</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">Hrt</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_DS_const">is_cons_DS_const</a></span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">constructor</span>; [| <span class="id">eapply</span> <span class="id">Cof</span> <span class="kwd">in</span> <span class="id">Hrt</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_inf">REM_env_inf</a></span>].<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id">Ht</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">try</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>; <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_app">is_cons_app</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="smask_env_inf">smask_env_inf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">k</span> <span class="id">R</span> (<span class="id">X</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">R</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">X</span> <span class="id">l</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span>) <span class="id">l</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hr</span> <span class="id">HX</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_ds</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span> <span class="id">x</span>) <span class="kwd">as</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>; <span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Hr</span> <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">R'</span> &amp; <span class="id">Hr</span> &amp;?).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id">Hr</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">HX</span> <span class="id">x</span> <span class="id">Hin</span>) <span class="kwd">as</span> <span class="id">Infx</span>; <span class="id">inv</span> <span class="id">Infx</span>.<br/>
&nbsp;&nbsp;<span class="id">cases</span>.<br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Ht</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_inf">DS_const_inf</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DMAPi_simpl">DMAPi_simpl</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS_simpl">CONS_simpl</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_eq_compat">rem_eq_compat</a></span> <span class="kwd">in</span> <span class="id">Ht</span> <span class="kwd">as</span> <span class="id">Hrt</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP_simpl">APP_simpl</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS_simpl">CONS_simpl</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">Hrt</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">try</span> (<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_inf">DS_const_inf</a></span>).<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">constructor</span>; [| <span class="id">eapply</span> <span class="id">Cof</span> <span class="kwd">in</span> <span class="id">Hrt</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_inf_dom">REM_env_inf_dom</a></span>].<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id">Ht</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<div class="doc">Lien avec la d√©finition de smask sur les flots individuels </div>
<span class="kwd">Lemma</span> <span class="id"><a name="smask_env_proj_eq">smask_env_proj_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span> <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">R</span> (<span class="id">X</span> <span class="id">x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">R</span> (<span class="id">X</span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;3: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">k</span> &amp; <span class="id">R</span> &amp; <span class="id">X</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> _ <span class="id">R</span>) <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">R'</span> &amp; <span class="id">Hr</span>).<br/>
&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [<span class="id">Hc</span>|<span class="id">Hc</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#is_cons_smask_env">is_cons_smask_env</a></span>; <span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#is_cons_smask">is_cons_smask</a></span>; <span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id">Hr</span> <span class="kwd">in</span> <span class="id">Hu</span>, <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span> <span class="kwd">in</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span> <span class="kwd">in</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;<span class="id">cases</span>.<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;cas&nbsp;toujours&nbsp;absent&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>, (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> 0), 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">try</span> <span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id">X</span> <span class="id">x</span>)) <span class="kwd">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [<span class="id">Hc</span>|<span class="id">Hc</span>]; <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>).<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">split</span>; [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;first&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_app_first">first_app_first</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">auto</span>; <span class="comment">(*&nbsp;puis&nbsp;les&nbsp;autres&nbsp;*)</span> <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|].<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">eexists</span> _, <span class="id">R'</span>, (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>).<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_DS_const">is_cons_DS_const</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_smask_env_false">take_smask_env_false</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">R</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">R</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> <span class="id">X</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span> * <span class="id">Heq</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)), <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> _ <span class="id">R</span>) <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">R'</span> &amp; <span class="id">Hr</span>).<br/>
&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Heq</span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Heq</span> <span class="kwd">as</span> []; <span class="id">subst</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_eq">take_env_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_app_env">app_app_env</a></span>, &lt;- (<span class="id">IHn</span> <span class="id">R'</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>)), <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_rem_take_env">app_rem_take_env</a></span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bss_smask">bss_smask</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">k</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">ins</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">envI</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#bool_of_sbool">bool_of_sbool</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span>))).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ins</span> <span class="kwd">as</span> [|<span class="id">x</span>[|<span class="id">y</span>]]; <span class="id">intros</span> * <span class="id">Hlen</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Hlen</span>.<br/>
&nbsp;&nbsp;- <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_proj_eq">smask_env_proj_eq</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">envI</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="id">x</span> <span class="id">envI</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#AC_smask">AC_smask</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss_cons">bss_cons</a></span> <span class="id">x</span>), <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_proj_eq">smask_env_proj_eq</a></span>, <span class="id">IHins</span>; <span class="id">try</span> (<span class="id">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;apply&nbsp;smask_or_ad_hoc.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> (<span class="id">y</span> :: <span class="id">l</span>) <span class="id">envI</span>); <span class="id">intro</span> <span class="id">bs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id">envI</span> <span class="id">x</span>); <span class="id">intro</span> <span class="id">xs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_or_ad_hoc">smask_or_ad_hoc</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_env">Smask_env</a></span>.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Env.Abs_align">Abs_align</a></span>.<br/>
<br/>
<h2> Liens entre smask_env et sreset </h2>
<br/>
<h3> Entr√©es absentes -&gt; sorties absentes </h3>
<br/>
<div class="doc">Propri√©t√© qui d√©coule de la correction des horloges (cf. wf_align).
    Dans une forme un peu plus faible (absences √† l'infini) mais √ßa
    suffit pour la correction du reset. </div>
<span class="kwd">Definition</span> <span class="id"><a name="abs_align">abs_align</a></span> (<span class="id">X</span> <span class="id">Y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">n</span> <span class="id">X</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">n</span> <span class="id">Y</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="abs_align_abs">abs_align_abs</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_align">abs_align</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> <span class="id">X</span> -&gt; <span class="id">X</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hal</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">Hal</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>); <span class="id">reflexivity</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="abs_align_rem">abs_align_rem</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_align">abs_align</a></span> <span class="id">X</span> <span class="id">Y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_align">abs_align</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">Y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_align">abs_align</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hal</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hal</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_rem_env">nrem_rem_env</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_align">abs_align</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span>) ==&gt; @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span>) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">abs_align_morph</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_align">abs_align</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Eq1</span> * <span class="id">Eq2</span> <span class="id">Habs</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Abs_align">Abs_align</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_bool_dec">take_bool_dec</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">R</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="kwd">exists</span> <span class="id">m</span>, <span class="id">m</span> &lt; <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">m</span> <span class="id">R</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">m</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">m</span> <span class="id">R</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> 0.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span> * <span class="id">Infr</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Infr</span> <span class="kwd">as</span> [<span class="id">Cr</span> <span class="id">Infr'</span>].<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">Cr</span>) <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">R'</span> &amp; <span class="id">Hr</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;true&nbsp;trouv√©&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHn</span> <span class="id">R'</span> <span class="id">Infr'</span>) <span class="kwd">as</span> [<span class="id">Ht</span>|(<span class="id">m</span> &amp; <span class="id">Hlt</span> &amp; <span class="id">Ht</span> &amp; <span class="id">Hf</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Ht</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>; <span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>); <span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)); <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id">Ht</span>, <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Env.Smask_sreset1">Smask_sreset1</a></span>.<br/>
<br/>
<h3> Here we explicit the hypothesis needed to prove the
    <span class="bracket"><span class="id">smask_sreset</span></span> characterization. </h3>
<br/>
<span class="kwd">Variable</span> (<span class="id"><a name="Env.Smask_sreset1.f">f</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Env.Smask_sreset1.InfG">InfG</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">envI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> <span class="id">envI</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> <span class="id">envI</span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Env.Smask_sreset1.AbsG">AbsG</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> <span class="id">X</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> <span class="id">X</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> <span class="id">X</span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Env.Smask_sreset1.Hlp">Hlp</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> <span class="id">X</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> <span class="id">Y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> <span class="id">X</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> <span class="id">Y</span>).<br/>
<br/>
<br/>
<div class="doc">d√©coule de AbsG </div>
<span class="kwd">Lemma</span> <span class="id"><a name="forever_abs">forever_abs</a></span> : <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">AbsG</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#env_eq_Oeq">env_eq_Oeq</a></span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FIXME:&nbsp;un&nbsp;s√©lecteur&nbsp;dans&nbsp;remember_ds&nbsp;??&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">remember</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> <span class="kwd">as</span> <span class="id">X</span> <span class="id">eqn</span>:<span class="id">HX</span> <span class="kwd">in</span> |-*; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_refl_eq">Oeq_refl_eq</a></span> <span class="kwd">in</span> <span class="id">HX</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_ds</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> <span class="id">X</span>) <span class="kwd">as</span> <span class="id">Y</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">HX</span> <span class="id">HY</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">X</span> <span class="id">Y</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_abs_abs">abs_abs_abs</a></span> <span class="kwd">in</span> <span class="id">HX</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HX</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.AbsG">AbsG</a></span> <span class="kwd">in</span> <span class="id">HY</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env_inf">abs_env_inf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">Cof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">HX</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_env">rem_app_env</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#all_cons_abs_env">all_cons_abs_env</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">HY</span>, <span class="id">HX</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_env">rem_app_env</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#all_cons_abs_env">all_cons_abs_env</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> <span class="id">HX</span>, <span class="id">HY</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_app_env">first_app_env</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_abs_abs">abs_abs_abs</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="smask_sreset0">smask_sreset0</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">R</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> <span class="id">X</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_align">abs_align</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>) == <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux">sreset_aux</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> <span class="id">R</span> <span class="id">X</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> <span class="id">X</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">InfG</span> <span class="id">Hlp</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Infx</span> <span class="id">Infr</span> <span class="id">Habs</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_Oeq">take_env_Oeq</a></span>; <span class="id">intro</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#take_bool_dec">take_bool_dec</a></span> <span class="id">n</span> <span class="id">R</span> <span class="id">Infr</span>) <span class="kwd">as</span> [<span class="id">Hr</span> | (<span class="id">m</span> &amp; <span class="id">Hle</span> &amp; <span class="id">Hr</span> &amp; <span class="id">Hf</span>)].<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#take_smask_env_false">take_smask_env_false</a></span>, (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#take_sreset_aux_false">take_sreset_aux_false</a></span> _ <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> _ _), <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.Hlp">Hlp</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#take_smask_env_false">take_smask_env_false</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">pose</span> <span class="id">proof</span> (<span class="id">Ht</span> := <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.Hlp">Hlp</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>) <span class="id">X</span> <span class="id">m</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#take_smask_env_false">take_smask_env_false</a></span> <span class="id">m</span> <span class="id">R</span> <span class="id">X</span> <span class="id">Hr</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.InfG">InfG</a></span> <span class="id">X</span> <span class="id">Infx</span>) <span class="kwd">as</span> <span class="id">Infy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Ht</span> <span class="id">Habs</span> <span class="id">Infy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> <span class="id">X</span>); <span class="id">intros</span> <span class="id">Y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.InfG">InfG</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_all_inf">smask_env_all_inf</a></span> _ _ _ <span class="id">Infr</span> <span class="id">Infx</span>)) <span class="kwd">as</span> <span class="id">Infz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Infz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>)); <span class="id">intros</span> <span class="id">Z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hr</span> <span class="id">Hf</span> <span class="id">Infr</span> <span class="id">Infx</span> <span class="id">Hle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">R</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">Z</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">m</span>; <span class="id">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Infr</span> <span class="kwd">as</span> [<span class="id">Cr</span> <span class="id">InfR</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">Cr</span>) <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">R'</span> &amp; <span class="id">Hr'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr'</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> []; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_align_abs">abs_align_abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite_le_eq">all_infinite_le_eq</a></span> <span class="kwd">in</span> <span class="id">Habs</span> <span class="kwd">as</span> -&gt;; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">n</span>;[<span class="id">lia</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_align_rem">abs_align_rem</a></span> <span class="kwd">in</span> <span class="id">Habs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)), <span class="id">Hr'</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span> <span class="kwd">in</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hr</span> <span class="kwd">as</span> []; <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_eq">take_env_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux_eq">sreset_aux_eq</a></span>, 3 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_app_env">app_app_env</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_env">rem_app_env</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_env_eq_compat">first_env_eq_compat</a></span> <span class="kwd">in</span> <span class="id">Ht</span> <span class="kwd">as</span> <span class="id">Hft</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_env_eq_compat">rem_env_eq_compat</a></span> <span class="kwd">in</span> <span class="id">Ht</span> <span class="kwd">as</span> <span class="id">Hrt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_eq">take_env_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)) <span class="kwd">in</span> <span class="id">Hft</span>, <span class="id">Hrt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_app_env">first_app_env</a></span> <span class="kwd">in</span> <span class="id">Hft</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_env">rem_app_env</a></span> <span class="kwd">in</span> <span class="id">Hrt</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite_all_cons">all_infinite_all_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_app_first_env">app_app_first_env</a></span> <span class="id">Y</span>), &lt;- (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_app_first_env">app_app_first_env</a></span> <span class="id">Z</span>), <span class="id">Hft</span>, <span class="id">IHm</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite_all_cons">all_infinite_all_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_inf">REM_env_inf</a></span>.<br/>
Qed.</div></details>
<br/>
<div class="doc">Caract√©risation fondamentale de la fonction de reset </div>
<span class="kwd">Lemma</span> <span class="id"><a name="smask_sreset">smask_sreset</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> <span class="id">X</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_align">abs_align</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span>) == <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset">sreset</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> <span class="id">R</span> <span class="id">X</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Infr</span> <span class="id">Infx</span> <span class="id">Hal</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_eq">sreset_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;k&nbsp;=&nbsp;0,&nbsp;cas&nbsp;de&nbsp;base&nbsp;*)</span><br/>
&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_sreset0">smask_sreset0</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;va&nbsp;raisonner&nbsp;par&nbsp;co-induction&nbsp;gr√¢ce&nbsp;√†&nbsp;[env_eq]&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">remember_ds</span> <span class="id">X</span> <span class="kwd">as</span> <span class="id">Xn</span>.<br/>
&nbsp;&nbsp;<span class="id">remember</span> (_ <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> <span class="id">Xn</span>) <span class="kwd">as</span> <span class="id">Y</span> <span class="id">eqn</span>:<span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;tout&nbsp;ce&nbsp;qu'on&nbsp;a&nbsp;besoin&nbsp;de&nbsp;savoir&nbsp;sur&nbsp;Xn&nbsp;et&nbsp;Y&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">exists</span> <span class="id">X</span> <span class="id">n</span>, <span class="id">Xn</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">n</span> <span class="id">X</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">Y</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> <span class="id">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> <span class="id">X</span>) <span class="kwd">as</span> <span class="id">Hy</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="kwd">exists</span> <span class="id">X</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>; <span class="id">subst</span>; <span class="id">rewrite</span> <span class="id">HXn</span> <span class="kwd">in</span> *; <span class="id">split</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">HH</span> <span class="id">HXn</span> <span class="id">X</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#env_eq_ok">env_eq_ok</a></span>.<br/>
&nbsp;&nbsp;<span class="id">remember_ds</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.f">f</a></span> _) <span class="kwd">as</span> <span class="id">U</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_ds</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> _ _ (_ _)) <span class="kwd">as</span> <span class="id">V</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">HV</span> <span class="id">HU</span> <span class="id">Infr</span> <span class="id">Infx</span> <span class="id">Hy</span> <span class="id">Hal</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">k</span> <span class="id">R</span> <span class="id">Xn</span> <span class="id">Y</span> <span class="id">U</span> <span class="id">V</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Infr</span> <span class="kwd">as</span> [<span class="id">Cr</span> <span class="id">InfR</span>].<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">Cr</span>) <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">R'</span> &amp; <span class="id">Hr</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr</span> <span class="kwd">in</span> <span class="id">HU</span>, <span class="id">HV</span>, <span class="id">Hal</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">InfR</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hy</span> <span class="kwd">as</span> (<span class="id">X</span> &amp; <span class="id">n</span> &amp; <span class="id">Hxn</span> &amp; <span class="id">Hy</span> &amp; <span class="id">InfX</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hxn</span> <span class="kwd">in</span> <span class="id">HU</span>, <span class="id">HV</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hy</span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux_eq">sreset_aux_eq</a></span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span> <span class="kwd">in</span> <span class="id">HU</span>, <span class="id">HV</span>, <span class="id">Hal</span>.<br/>
&nbsp;&nbsp;<span class="id">cases</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;encore&nbsp;le&nbsp;cas&nbsp;de&nbsp;base...&nbsp;*)</span><br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">HV</span>, <span class="id">HU</span>, <span class="id">Hxn</span> <span class="kwd">in</span> *; <span class="id">clear</span> <span class="id">HU</span> <span class="id">HV</span> <span class="id">Hxn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">Hsm</span> := <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_sreset0">smask_sreset0</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">R'</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">n</span> <span class="id">X</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span> <span class="kwd">in</span> <span class="id">Hsm</span> <span class="kwd">at</span> 3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hsm</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_cons">infinite_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Oeq_env_eq">Oeq_env_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1.AbsG">AbsG</a></span> <span class="kwd">in</span> <span class="id">HU</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_all_inf">smask_env_all_inf</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env_inf">nrem_env_inf</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_inf">REM_env_inf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">constructor</span>; [| <span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_app_env">first_app_env</a></span>; <span class="id">auto</span>].<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_align_rem">abs_align_rem</a></span> <span class="kwd">in</span> <span class="id">Hal</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id">HU</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_env">rem_app_env</a></span>, <span class="id">Hxn</span> <span class="kwd">in</span> <span class="id">Hal</span>; <span class="id">eauto</span> 1 <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#all_cons_abs_env">all_cons_abs_env</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">rewrite</span> ?<span class="id">HU</span>, ?<span class="id">HV</span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_env">rem_app_env</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#all_cons_abs_env">all_cons_abs_env</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env_inf">nrem_env_inf</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite_all_cons">all_infinite_all_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_inf">REM_env_inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">X</span>, (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux_eq">sreset_aux_eq</a></span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">rewrite</span> ?<span class="id">HU</span>, ?<span class="id">HV</span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_env">rem_app_env</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#all_cons_abs_env">all_cons_abs_env</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env_inf">nrem_env_inf</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite_all_cons">all_infinite_all_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_inf">REM_env_inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">n</span> <span class="id">X</span>), 1; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env_inf">nrem_env_inf</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">rewrite</span> ?<span class="id">HU</span>, ?<span class="id">HV</span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_env">rem_app_env</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#all_cons_abs_env">all_cons_abs_env</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env_inf">nrem_env_inf</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite_all_cons">all_infinite_all_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_inf">REM_env_inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">X</span>, (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>); <span class="id">eauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset1">Smask_sreset1</a></span>.<br/>
<br/>
<br/>
<br/>
<div class="doc">Rel√¢chement de abs_align avec une in√©galit√© </div>
<span class="kwd">Section</span> <span class="id"><a name="Env.Abs_alingnLE">Abs_alingnLE</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="abs_alignLE">abs_alignLE</a></span> (<span class="id">X</span> <span class="id">Y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">n</span> <span class="id">X</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">n</span> <span class="id">Y</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="abs_alignLE_rem">abs_alignLE_rem</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE">abs_alignLE</a></span> <span class="id">X</span> <span class="id">Y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE">abs_alignLE</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">Y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE">abs_alignLE</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hal</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hal</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_rem_env">nrem_rem_env</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="abs_alignLE_abs">abs_alignLE_abs</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Y</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE">abs_alignLE</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> <span class="id">Y</span> -&gt; <span class="id">Y</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hal</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">Hal</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>); <span class="id">reflexivity</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE">abs_alignLE</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span>) ==&gt; @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span>) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">abs_alignLE_morph</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE">abs_alignLE</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Eq1</span> ?? <span class="id">Eq2</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="abs_alignLE_le">abs_alignLE_le</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">X'</span> <span class="id">Y</span>, <span class="id">X</span> &lt;= <span class="id">X'</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE">abs_alignLE</a></span> <span class="id">X</span> <span class="id">Y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE">abs_alignLE</a></span> <span class="id">X'</span> <span class="id">Y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE">abs_alignLE</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Le</span> ??.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">Le</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="abs_alignLEx">abs_alignLEx</a></span> (<span class="id">X</span> <span class="id">Y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span>) <span class="id">i</span> : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">n</span> <span class="id">X</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> (<span class="id">Y</span> <span class="id">i</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abss">abss</a></span>.<br/>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLEx">abs_alignLEx</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span>) ==&gt; @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span>) ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.I">I</a></span> ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">abs_alignLEx_morph</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLEx">abs_alignLEx</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Eq1</span> ?? <span class="id">Eq2</span> <span class="id">Hf</span> <span class="id">HH</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="abs_alignLEx_abs">abs_alignLEx_abs</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Y</span> <span class="id">i</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLEx">abs_alignLEx</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> <span class="id">Y</span> <span class="id">i</span> -&gt; <span class="id">Y</span> <span class="id">i</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abss">abss</a></span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hal</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">Hal</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>); <span class="id">reflexivity</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="abs_alignLEx_rem">abs_alignLEx_rem</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">i</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLEx">abs_alignLEx</a></span> <span class="id">X</span> <span class="id">Y</span> <span class="id">i</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLEx">abs_alignLEx</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">Y</span>) <span class="id">i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLEx">abs_alignLEx</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hal</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hal</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_eq">REM_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_rem_env">nrem_rem_env</a></span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="abs_alignLEx_le">abs_alignLEx_le</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">X'</span> <span class="id">Y</span> <span class="id">i</span>, <span class="id">X</span> &lt;= <span class="id">X'</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLEx">abs_alignLEx</a></span> <span class="id">X</span> <span class="id">Y</span> <span class="id">i</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLEx">abs_alignLEx</a></span> <span class="id">X'</span> <span class="id">Y</span> <span class="id">i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLEx">abs_alignLEx</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Le</span> ??.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">Le</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="abs_align_proj">abs_align_proj</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">i</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE">abs_alignLE</a></span> <span class="id">X</span> <span class="id">Y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLEx">abs_alignLEx</a></span> <span class="id">X</span> <span class="id">Y</span> <span class="id">i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE">abs_alignLE</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLEx">abs_alignLEx</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hal</span> <span class="id">n</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hal</span> <span class="id">n</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hal</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env_eq">nrem_env_eq</a></span> <span class="kwd">in</span> <span class="id">Hal</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Abs_alingnLE">Abs_alingnLE</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Env.Smask_sreset2">Smask_sreset2</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> (<span class="id"><a name="Env.Smask_sreset2.f">f</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#SI">SI</a></span>).<br/>
<span class="kwd">Variables</span> (<span class="id"><a name="Env.Smask_sreset2.ins">ins</a></span> <span class="id"><a name="Env.Smask_sreset2.outs">outs</a></span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.I">I</a></span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Env.Smask_sreset2.Hlp">Hlp</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> <span class="id">X</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">X</span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Env.Smask_sreset2.AbsG">AbsG</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> <span class="id">X</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">X</span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Env.Smask_sreset2.InfG">InfG</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">envI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">envI</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.ins">ins</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">envI</span>) <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.outs">outs</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Hlp2">Hlp2</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> <span class="id">X</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> <span class="id">Y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">X</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">Y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.Hlp">Hlp</a></span>, <span class="id">H</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.Hlp">Hlp</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id">smask_sreset0'</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">R</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">X</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.ins">ins</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE">abs_alignLE</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">List.In</a></span> <span class="id">i</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.outs">outs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>) <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux">sreset_aux</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">R</span> <span class="id">X</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">X</span>) <span class="id">i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">R</span> <span class="id">X</span> <span class="id">Infx</span> <span class="id">Infr</span> <span class="id">Habs</span> <span class="id">i</span> <span class="id">Ini</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_Oeq">take_Oeq</a></span>; <span class="id">intro</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#take_bool_dec">take_bool_dec</a></span> <span class="id">n</span> <span class="id">R</span> <span class="id">Infr</span>) <span class="kwd">as</span> [<span class="id">Hr</span> | (<span class="id">m</span> &amp; <span class="id">Hle</span> &amp; <span class="id">Hr</span> &amp; <span class="id">Hf</span>)].<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;si&nbsp;R&nbsp;est&nbsp;faux&nbsp;pour&nbsp;toujours&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#take_smask_false">take_smask_false</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_proj">take_env_proj</a></span> _ _ <span class="id">i</span>), &lt;- 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#take_sreset_aux_false">take_sreset_aux_false</a></span> <span class="id">n</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">R</span> <span class="id">X</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">X</span>)); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Hlp2">Hlp2</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#take_smask_env_false">take_smask_env_false</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;sinon&nbsp;il&nbsp;est&nbsp;vrai&nbsp;au&nbsp;bout&nbsp;de&nbsp;m&nbsp;instants&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;pr√©pare&nbsp;une&nbsp;r√©currence&nbsp;sur&nbsp;m&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">Ht</span> := <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Hlp2">Hlp2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>) <span class="id">X</span> <span class="id">m</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#take_smask_env_false">take_smask_env_false</a></span> <span class="id">m</span> <span class="id">R</span> <span class="id">X</span> <span class="id">Hr</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.InfG">InfG</a></span> <span class="id">X</span> <span class="id">Infx</span>) <span class="kwd">as</span> <span class="id">Infy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_elim">Oprodi_eq_elim</a></span> <span class="kwd">with</span> (<span class="id">i</span> := <span class="id">i</span>) <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Ht</span> <span class="id">Habs</span> <span class="id">Infy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">X</span>); <span class="id">intros</span> <span class="id">Y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.InfG">InfG</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_inf">smask_env_inf</a></span> _ _ _ _ <span class="id">Infr</span> <span class="id">Infx</span>)) <span class="kwd">as</span> <span class="id">Infz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Infz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>)); <span class="id">intros</span> <span class="id">Z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hr</span> <span class="id">Hf</span> <span class="id">Infr</span> <span class="id">Infx</span> <span class="id">Hle</span> <span class="id">Ini</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">R</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">Z</span> <span class="id">n</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">m</span>; <span class="id">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Infr</span> <span class="kwd">as</span> [<span class="id">Cr</span> <span class="id">InfR</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">Cr</span>) <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">R'</span> &amp; <span class="id">Hr'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="id">i</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr'</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> []; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE_abs">abs_alignLE_abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_le_eq">infinite_le_eq</a></span> <span class="kwd">with</span> (<span class="id">s</span> := <span class="id">Z</span> <span class="id">i</span>) <span class="kwd">in</span> <span class="id">Habs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id">Habs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">n</span>;[<span class="id">lia</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr'</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_cons">take_cons</a></span> <span class="kwd">in</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hr</span> <span class="kwd">as</span> [? <span class="id">Hr</span>]; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_S">nrem_S</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux_eq">sreset_aux_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_app">app_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="id">i</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_app">app_app</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_rem_app">app_rem_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;peut&nbsp;faire&nbsp;sauter&nbsp;le&nbsp;[rem(app(Y&nbsp;i))]&nbsp;car&nbsp;il&nbsp;est&nbsp;sous&nbsp;un&nbsp;[Y&nbsp;i]&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-  2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_rem_app">app_rem_app</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;ensuite&nbsp;on&nbsp;montre&nbsp;que&nbsp;[app&nbsp;(Z&nbsp;i)]&nbsp;et&nbsp;[app&nbsp;(Y&nbsp;i)]&nbsp;sont&nbsp;idem&nbsp;:&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_proj">take_env_proj</a></span>, 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)), &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_eq">REM_env_eq</a></span>, &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_proj">take_env_proj</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_eq_compat">first_eq_compat</a></span> <span class="kwd">in</span> <span class="id">Ht</span> <span class="kwd">as</span> <span class="id">Hft</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_app_first">first_app_first</a></span> <span class="kwd">in</span> <span class="id">Hft</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_app_first">app_app_first</a></span> (<span class="id">Z</span> <span class="id">i</span>)), &lt;- (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_app_first">app_app_first</a></span> (<span class="id">Y</span> <span class="id">i</span>)), <span class="id">Hft</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;puis&nbsp;on&nbsp;pr√©pare&nbsp;l'appel&nbsp;√†&nbsp;IHm&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_eq_compat">rem_eq_compat</a></span> <span class="kwd">in</span> <span class="id">Ht</span> <span class="kwd">as</span> <span class="id">Hrt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span> <span class="kwd">in</span> <span class="id">Hrt</span>; [| <span class="id">apply</span> <span class="id">Infy</span> | <span class="id">apply</span> <span class="id">Infz</span> ]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE_rem">abs_alignLE_rem</a></span> <span class="kwd">in</span> <span class="id">Habs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span> <span class="kwd">in</span> <span class="id">Habs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_eq">REM_env_eq</a></span>, <span class="id">IHm</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_inf_dom">REM_env_inf_dom</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE_le">abs_alignLE_le</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_env_le">rem_app_env_le</a></span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id">smask_sreset0''</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">R</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">X</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.ins">ins</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">List.In</a></span> <span class="id">i</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.outs">outs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLEx">abs_alignLEx</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>)) <span class="id">i</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>) <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux">sreset_aux</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">R</span> <span class="id">X</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">X</span>) <span class="id">i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">InfG</span> <span class="id">Hlp</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">R</span> <span class="id">X</span> <span class="id">Infx</span> <span class="id">Infr</span> <span class="id">i</span> <span class="id">Ini</span> <span class="id">Habs</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_Oeq">take_Oeq</a></span>; <span class="id">intro</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#take_bool_dec">take_bool_dec</a></span> <span class="id">n</span> <span class="id">R</span> <span class="id">Infr</span>) <span class="kwd">as</span> [<span class="id">Hr</span> | (<span class="id">m</span> &amp; <span class="id">Hle</span> &amp; <span class="id">Hr</span> &amp; <span class="id">Hf</span>)].<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;si&nbsp;R&nbsp;est&nbsp;faux&nbsp;pour&nbsp;toujours&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#take_smask_false">take_smask_false</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_proj">take_env_proj</a></span> _ _ <span class="id">i</span>), &lt;- 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#take_sreset_aux_false">take_sreset_aux_false</a></span> <span class="id">n</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">R</span> <span class="id">X</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">X</span>)); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Hlp2">Hlp2</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#take_smask_env_false">take_smask_env_false</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;sinon&nbsp;il&nbsp;est&nbsp;vrai&nbsp;au&nbsp;bout&nbsp;de&nbsp;m&nbsp;instants&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;pr√©pare&nbsp;une&nbsp;r√©currence&nbsp;sur&nbsp;m&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">Ht</span> := <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Hlp2">Hlp2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>) <span class="id">X</span> <span class="id">m</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#take_smask_env_false">take_smask_env_false</a></span> <span class="id">m</span> <span class="id">R</span> <span class="id">X</span> <span class="id">Hr</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.InfG">InfG</a></span> <span class="id">X</span> <span class="id">Infx</span>) <span class="kwd">as</span> <span class="id">Infy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_elim">Oprodi_eq_elim</a></span> <span class="kwd">with</span> (<span class="id">i</span> := <span class="id">i</span>) <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Ht</span> <span class="id">Habs</span> <span class="id">Infy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">X</span>); <span class="id">intros</span> <span class="id">Y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.InfG">InfG</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_inf">smask_env_inf</a></span> _ _ _ _ <span class="id">Infr</span> <span class="id">Infx</span>)) <span class="kwd">as</span> <span class="id">Infz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Infz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">R</span> <span class="id">X</span>)); <span class="id">intros</span> <span class="id">Z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hr</span> <span class="id">Hf</span> <span class="id">Infr</span> <span class="id">Infx</span> <span class="id">Hle</span> <span class="id">Ini</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">R</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">Z</span> <span class="id">n</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">m</span>; <span class="id">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Infr</span> <span class="kwd">as</span> [<span class="id">Cr</span> <span class="id">InfR</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">Cr</span>) <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">R'</span> &amp; <span class="id">Hr'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="id">i</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr'</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> []; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLEx_abs">abs_alignLEx_abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_le_eq">infinite_le_eq</a></span> <span class="kwd">with</span> (<span class="id">s</span> := <span class="id">Z</span> <span class="id">i</span>) <span class="kwd">in</span> <span class="id">Habs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id">Habs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">n</span>;[<span class="id">lia</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr'</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_cons">take_cons</a></span> <span class="kwd">in</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hr</span> <span class="kwd">as</span> [? <span class="id">Hr</span>]; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_S">nrem_S</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux_eq">sreset_aux_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_app">app_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="id">i</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_app">app_app</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_rem_app">app_rem_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;peut&nbsp;faire&nbsp;sauter&nbsp;le&nbsp;[rem(app(Y&nbsp;i))]&nbsp;car&nbsp;il&nbsp;est&nbsp;sous&nbsp;un&nbsp;[Y&nbsp;i]&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-  2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_rem_app">app_rem_app</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;ensuite&nbsp;on&nbsp;montre&nbsp;que&nbsp;[app&nbsp;(Z&nbsp;i)]&nbsp;et&nbsp;[app&nbsp;(Y&nbsp;i)]&nbsp;sont&nbsp;idem&nbsp;:&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_proj">take_env_proj</a></span>, 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)), &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_eq">REM_env_eq</a></span>, &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_proj">take_env_proj</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_eq_compat">first_eq_compat</a></span> <span class="kwd">in</span> <span class="id">Ht</span> <span class="kwd">as</span> <span class="id">Hft</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_app_first">first_app_first</a></span> <span class="kwd">in</span> <span class="id">Hft</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_app_first">app_app_first</a></span> (<span class="id">Z</span> <span class="id">i</span>)), &lt;- (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_app_first">app_app_first</a></span> (<span class="id">Y</span> <span class="id">i</span>)), <span class="id">Hft</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;puis&nbsp;on&nbsp;pr√©pare&nbsp;l'appel&nbsp;√†&nbsp;IHm&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_eq_compat">rem_eq_compat</a></span> <span class="kwd">in</span> <span class="id">Ht</span> <span class="kwd">as</span> <span class="id">Hrt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span> <span class="kwd">in</span> <span class="id">Hrt</span>; [| <span class="id">apply</span> <span class="id">Infy</span> | <span class="id">apply</span> <span class="id">Infz</span> ]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLEx_rem">abs_alignLEx_rem</a></span> <span class="kwd">in</span> <span class="id">Habs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span> <span class="kwd">in</span> <span class="id">Habs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_eq">REM_env_eq</a></span>, <span class="id">IHm</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_inf_dom">REM_env_inf_dom</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLEx_le">abs_alignLEx_le</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_env_le">rem_app_env_le</a></span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inf_dom_abs_env">inf_dom_abs_env</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">I</span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">I</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> <span class="id">A</span> <span class="id">I</span>) <span class="id">l</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * ??.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_inf">DS_const_inf</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id">smask_sreset'</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">X</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.ins">ins</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE">abs_alignLE</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">List.In</a></span> <span class="id">i</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.outs">outs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">R</span> <span class="id">X</span>) <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset">sreset</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">R</span> <span class="id">X</span>) <span class="id">i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Infr</span> <span class="id">Infx</span> <span class="id">Hal</span> <span class="id">i</span> <span class="id">Ini</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_proj_eq">smask_env_proj_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="id">i</span>) , <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_eq">sreset_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id">smask_sreset0'</span>; <span class="id">now</span> <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;TEST:&nbsp;*)</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_align_proj">abs_align_proj</a></span> <span class="kwd">with</span> (<span class="id">i</span> := <span class="id">i</span>) <span class="kwd">in</span> <span class="id">Hal</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;va&nbsp;raisonner&nbsp;par&nbsp;co-induction&nbsp;gr√¢ce&nbsp;√†&nbsp;[DS_eq]&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">remember_ds</span> <span class="id">X</span> <span class="kwd">as</span> <span class="id">Xn</span>.<br/>
&nbsp;&nbsp;<span class="id">remember</span> (_ <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">Xn</span>) <span class="kwd">as</span> <span class="id">Y</span> <span class="id">eqn</span>:<span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;tout&nbsp;ce&nbsp;qu'on&nbsp;a&nbsp;besoin&nbsp;de&nbsp;savoir&nbsp;sur&nbsp;Xn&nbsp;et&nbsp;Y&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">exists</span> <span class="id">X</span> <span class="id">n</span>, <span class="id">Xn</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">n</span> <span class="id">X</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">Y</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> <span class="id">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">X</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.ins">ins</a></span>) <span class="kwd">as</span> <span class="id">Hy</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="kwd">exists</span> <span class="id">X</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>; <span class="id">subst</span>; <span class="id">rewrite</span> <span class="id">HXn</span> <span class="kwd">in</span> *; <span class="id">split</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">HH</span> <span class="id">HXn</span> <span class="id">X</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ds_eq_Oeq">ds_eq_Oeq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">remember_ds</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.f">f</a></span> _ <span class="id">i</span>) <span class="kwd">as</span> <span class="id">U</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_ds</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> _ _ (_ _)) <span class="kwd">as</span> <span class="id">V</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">HV</span> <span class="id">HU</span> <span class="id">Infr</span> <span class="id">Infx</span> <span class="id">Hy</span> <span class="id">Hal</span> <span class="id">Ini</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">i</span> <span class="id">k</span> <span class="id">R</span> <span class="id">Xn</span> <span class="id">Y</span> <span class="id">U</span> <span class="id">V</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Infr</span> <span class="kwd">as</span> [<span class="id">Cr</span> <span class="id">InfR</span>].<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">Cr</span>) <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">R'</span> &amp; <span class="id">Hr</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;TEST&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLEx">abs_alignLEx</a></span> <span class="kwd">in</span> <span class="id">Hal</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">HU</span> <span class="kwd">in</span> <span class="id">Hal</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;/TEST&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;unfold&nbsp;abs_alignLEx.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="id">i</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr</span> <span class="kwd">in</span> <span class="id">HU</span>, <span class="id">HV</span><span class="comment">(*&nbsp;,&nbsp;Hal&nbsp;*)</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">InfR</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hy</span> <span class="kwd">as</span> (<span class="id">X</span> &amp; <span class="id">n</span> &amp; <span class="id">Hxn</span> &amp; <span class="id">Hy</span> &amp; <span class="id">InfX</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hxn</span> <span class="kwd">in</span> <span class="id">HU</span>, <span class="id">HV</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hy</span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux_eq">sreset_aux_eq</a></span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span> <span class="kwd">in</span> <span class="id">HU</span><span class="comment">(*&nbsp;,&nbsp;Hal&nbsp;*)</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hr</span> <span class="kwd">in</span> <span class="id">Hal</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span> <span class="kwd">in</span> <span class="id">Hal</span>.<br/>
&nbsp;&nbsp;<span class="id">cases</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;encore&nbsp;le&nbsp;cas&nbsp;de&nbsp;base...&nbsp;*)</span><br/>
&nbsp;&nbsp;{ <span class="id">setoid_rewrite</span> <span class="id">HU</span> <span class="kwd">in</span> <span class="id">Hal</span>; <span class="id">setoid_rewrite</span> <span class="id">Hxn</span> <span class="kwd">in</span> <span class="id">Hal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HV</span>, <span class="id">HU</span>, <span class="id">Hxn</span> <span class="kwd">in</span> *; <span class="id">clear</span> <span class="id">HU</span> <span class="id">HV</span> <span class="id">Hxn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">smask_sreset0''</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">R'</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">n</span> <span class="id">X</span>)) <span class="kwd">in</span> <span class="id">Ini</span> <span class="kwd">as</span> <span class="id">Hsm</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2,3: <span class="id">rewrite</span> ?<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_cons">infinite_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span> <span class="kwd">in</span> <span class="id">Hsm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, &lt;- <span class="id">Hsm</span>, &lt;- 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="id">i</span>), <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_eq">smask_env_eq</a></span>; <span class="id">reflexivity</span>. }<br/>
<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">U</span>) <span class="kwd">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rewrite</span> <span class="id">HU</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.InfG">InfG</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_env_inf_dom">app_env_inf_dom</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#inf_dom_abs_env">inf_dom_abs_env</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_inf">smask_env_inf</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_inf_dom">REM_env_inf_dom</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env_inf_dom">nrem_env_inf_dom</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;a&nbsp;en&nbsp;fait&nbsp;une&nbsp;r√©√©criture&nbsp;de&nbsp;AbsG&nbsp;dans&nbsp;HU&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">destruct</span> <span class="id">HU</span> <span class="kwd">as</span> [<span class="id">HU</span> _]; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.AbsG">AbsG</a></span> <span class="kwd">in</span> <span class="id">HU</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_le_eq">infinite_le_eq</a></span> <span class="kwd">in</span> <span class="id">HU</span>; <span class="id">auto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;simplifie&nbsp;dans&nbsp;HU&nbsp;et&nbsp;HV&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abss">abss</a></span> <span class="kwd">in</span> <span class="id">HU</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span> <span class="kwd">in</span> <span class="id">HU</span>.<br/>
&nbsp;&nbsp;1,3: <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;all:&nbsp;apply&nbsp;abs_alignLE_rem&nbsp;in&nbsp;Hal.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;all:&nbsp;rewrite&nbsp;rem_app_env,&nbsp;Hxn&nbsp;in&nbsp;Hal;&nbsp;eauto&nbsp;1&nbsp;using&nbsp;all_cons_abs_env.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">constructor</span>; <span class="id">intros</span> _; <span class="id">split</span>; <span class="id">cycle</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[| <span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abss">abss</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_app_first">first_app_first</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_DS_const">first_DS_const</a></span> ].<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">rewrite</span> ?<span class="id">HU</span>, ?<span class="id">HV</span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_DS_const">is_cons_DS_const</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env_eq">nrem_env_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_nrem">infinite_nrem</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.InfG">InfG</a></span>; <span class="id">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> &lt;- <span class="id">Hxn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_inf_dom">REM_env_inf_dom</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> <span class="id">X</span>, (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">m</span> <span class="id">Hle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hal</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>( <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> _ _) <span class="kwd">in</span> <span class="id">Hal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_rem_env">nrem_rem_env</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_env">rem_app_env</a></span> <span class="kwd">in</span> <span class="id">Hal</span>; <span class="id">eauto</span> 1 <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#all_cons_abs_env">all_cons_abs_env</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_S">nrem_S</a></span>, <span class="id">HU</span>, <span class="id">Hxn</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span> <span class="kwd">in</span> <span class="id">Hal</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_DS_const">is_cons_DS_const</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">rewrite</span> ?<span class="id">HU</span>, ?<span class="id">HV</span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_DS_const">is_cons_DS_const</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env_eq">nrem_env_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_nrem">infinite_nrem</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.InfG">InfG</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> &lt;- <span class="id">Hxn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_inf_dom">REM_env_inf_dom</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> <span class="id">X</span>, (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">m</span> <span class="id">Hle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hal</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>( <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> _ _) <span class="kwd">in</span> <span class="id">Hal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_rem_env">nrem_rem_env</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_env">rem_app_env</a></span> <span class="kwd">in</span> <span class="id">Hal</span>; <span class="id">eauto</span> 1 <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#all_cons_abs_env">all_cons_abs_env</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_S">nrem_S</a></span>, <span class="id">HU</span>, <span class="id">Hxn</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span> <span class="kwd">in</span> <span class="id">Hal</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_DS_const">is_cons_DS_const</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux_eq">sreset_aux_eq</a></span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">rewrite</span> ?<span class="id">HU</span>, ?<span class="id">HV</span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_DS_const">is_cons_DS_const</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span>; <span class="id">eauto</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2.InfG">InfG</a></span>; <span class="id">rewrite</span> &lt;- ?<span class="id">Hxn</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> &lt;- <span class="id">Hxn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_inf_dom">REM_env_inf_dom</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+  <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">n</span> <span class="id">X</span>), 1; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env_inf_dom">nrem_env_inf_dom</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">m</span> <span class="id">Hle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hal</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>( <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> _ _) <span class="kwd">in</span> <span class="id">Hal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_rem_env">nrem_rem_env</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_env">rem_app_env</a></span> <span class="kwd">in</span> <span class="id">Hal</span>; <span class="id">eauto</span> 1 <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#all_cons_abs_env">all_cons_abs_env</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_S">nrem_S</a></span>, <span class="id">HU</span>, <span class="id">Hxn</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span> <span class="kwd">in</span> <span class="id">Hal</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_DS_const">is_cons_DS_const</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env.Smask_sreset2">Smask_sreset2</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#Env">Env</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
