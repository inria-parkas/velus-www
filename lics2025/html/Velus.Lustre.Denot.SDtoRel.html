
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module SDtoRel</title>
<meta name="description" content="Documentation of Coq module SDtoRel" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
</head>

<body>
<h1 class="title">Module SDtoRel</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.PArith.BinPos.html">BinPos</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html">Permutation</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span> <span class="id"><a href="Velus.Ident.html">Ident</a></span> <span class="id"><a href="Velus.Environment.html">Environment</a></span> <span class="id"><a href="Velus.Operators.html">Operators</a></span> <span class="id"><a href="Velus.Clocks.html">Clocks</a></span> <span class="id"><a href="Velus.CoindStreams.html">CoindStreams</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.StaticEnv.html">Lustre.StaticEnv</a></span> <span class="id"><a href="Velus.Lustre.LSyntax.html">Lustre.LSyntax</a></span> <span class="id"><a href="Velus.Lustre.LOrdered.html">Lustre.LOrdered</a></span> <span class="id"><a href="Velus.Lustre.LSemantics.html">Lustre.LSemantics</a></span> <span class="id"><a href="Velus.Lustre.LTyping.html">Lustre.LTyping</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html">Lustre.LClocking</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html">Lustre.LCausality</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.FunctionalEnvironment.html">FunctionalEnvironment</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.html">Lustre.Denot.Cpo</a></span>.<br/>
<br/>
<span class="kwd">Close</span> <span class="kwd">Scope</span> <span class="id">equiv_scope</span>. <br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html">CommonList2</a></span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html">CommonDS</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html">SDfuns</a></span> <span class="id"><a href="Velus.Lustre.Denot.SD.html">SD</a></span> <span class="id"><a href="Velus.Lustre.Denot.Infty.html">Infty</a></span> <span class="id"><a href="Velus.Lustre.Denot.InftyProof.html">InftyProof</a></span> <span class="id"><a href="Velus.Lustre.Denot.CheckOp.html">CheckOp</a></span> <span class="id"><a href="Velus.Lustre.Denot.OpErr.html">OpErr</a></span> <span class="id"><a href="Velus.Lustre.Denot.Safe.html">Safe</a></span> <span class="id"><a href="Velus.Lustre.Denot.Abs.html">Abs</a></span> <span class="id"><a href="Velus.Lustre.Denot.Lp.html">Lp</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html">ResetMask</a></span> <span class="id"><a href="Velus.Lustre.Denot.Restr.html">Restr</a></span>.<br/>
<br/>
<span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#ListNotations">ListNotations</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="kwd">Type</span> <span class="id"><a name="SDTOREL">SDTOREL</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ids</span>   : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Op</span>    : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Cks</span>   : <span class="id"><a href="Velus.Clocks.html#CLOCKS">CLOCKS</a></span>        <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Senv</span>  : <span class="id"><a href="Velus.Lustre.StaticEnv.html#STATICENV">STATICENV</a></span>     <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Syn</span>   : <span class="id"><a href="Velus.Lustre.LSyntax.html#LSYNTAX">LSYNTAX</a></span>       <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Typ</span>   : <span class="id"><a href="Velus.Lustre.LTyping.html#LTYPING">LTYPING</a></span>       <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Cl</span>    : <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING">LCLOCKING</a></span>     <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Caus</span>  : <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY">LCAUSALITY</a></span>    <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Lord</span>  : <span class="id"><a href="Velus.Lustre.LOrdered.html#LORDERED">LORDERED</a></span>      <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Str</span>   : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS">COINDSTREAMS</a></span>  <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Sem</span>   : <span class="id"><a href="Velus.Lustre.LSemantics.html#LSEMANTICS">LSEMANTICS</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str">Str</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Den</span>   : <span class="id"><a href="Velus.Lustre.Denot.SD.html#SD">SD</a></span>         <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord">Lord</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Restr</span> : <span class="id"><a href="Velus.Lustre.Denot.Restr.html#LRESTR">LRESTR</a></span>     <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Inf</span>   : <span class="id"><a href="Velus.Lustre.Denot.InftyProof.html#LDENOTINF">LDENOTINF</a></span>  <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ">Typ</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Caus">Caus</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr">Restr</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den">Den</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ckop</span>  : <span class="id"><a href="Velus.Lustre.Denot.CheckOp.html#CHECKOP">CHECKOP</a></span>       <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">OpErr</span> : <span class="id"><a href="Velus.Lustre.Denot.OpErr.html#OP_ERR">OP_ERR</a></span>        <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ">Typ</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr">Restr</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den">Den</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ckop">Ckop</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Safe</span>  : <span class="id"><a href="Velus.Lustre.Denot.Safe.html#LDENOTSAFE">LDENOTSAFE</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ">Typ</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr">Restr</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl">Cl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den">Den</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ckop">Ckop</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr">OpErr</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Abs</span>   : <span class="id"><a href="Velus.Lustre.Denot.Abs.html#ABS_INDEP">ABS_INDEP</a></span>  <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ">Typ</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den">Den</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Lp</span>    : <span class="id"><a href="Velus.Lustre.Denot.Lp.html#LP">LP</a></span>         <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ">Typ</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den">Den</a></span>).<br/>
<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Symmetric">Symmetric</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.history_equiv">history_equiv</a></span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">Eq</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">Eq</span> <span class="id">v</span>); <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">symmetry</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="SDTOREL.eq_EqSts">eq_EqSts</a></span> : <span class="kwd">forall</span> <span class="id">A</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#subrelation">subrelation</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>))) (@<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> <span class="id">A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> ????; <span class="id">now</span> <span class="id">subst</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>) : (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.history_equiv">history_equiv</a></span> ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span> ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">sem_exp_iff</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> ?? <span class="id">Eq1</span> ?? <span class="id">Eq2</span> ??? <span class="id">Eq3</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>; <span class="id">rewrite</span> <span class="id">Eq1</span>, <span class="id">Eq2</span>, <span class="id">Eq3</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.sem_var_restrict">sem_var_restrict</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">Γ</span> <span class="id">x</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar">IsVar</a></span> <span class="id">Γ</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.sem_var">sem_var</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x</span>) <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.restrict">restrict</a></span> <span class="id">H</span> <span class="id">Γ</span>) (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x</span>) <span class="id">s</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hv</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_find">FEnv.restrict_find</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.vars_of_senv_Var">vars_of_senv_Var</a></span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.vars_of_senv_app">vars_of_senv_app</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Γ1</span> <span class="id">Γ2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.vars_of_senv">vars_of_senv</a></span> (<span class="id">Γ1</span> ++ <span class="id">Γ2</span>) = <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.vars_of_senv">vars_of_senv</a></span> <span class="id">Γ1</span> ++ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.vars_of_senv">vars_of_senv</a></span> <span class="id">Γ2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.vars_of_senv">vars_of_senv</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map_app">flat_map_app</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.union_restrict">union_restrict</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Γ1</span> <span class="id">Γ2</span> <span class="id">H</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.history_equiv">history_equiv</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.restrict">restrict</a></span> <span class="id">H</span> <span class="id">Γ1</span> + <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.restrict">restrict</a></span> <span class="id">H</span> <span class="id">Γ2</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.restrict">restrict</a></span> <span class="id">H</span> (<span class="id">Γ1</span> ++ <span class="id">Γ2</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.history_equiv">history_equiv</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.restrict">restrict</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict">FEnv.restrict</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union">FEnv.union</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">cases_eqn</span> <span class="id">Hex</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">try</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">try</span> <span class="id">rewrite</span> <span class="id">Hex</span>; <span class="id">try</span> <span class="id">constructor</span>; <span class="id">try</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;reste&nbsp;les&nbsp;contradictions&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">exfalso</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.vars_of_senv_app">vars_of_senv_app</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#existsb_app">existsb_app</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">try</span> <span class="id">take</span> (_ || _ = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#orb_prop">Bool.orb_prop</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">try</span> <span class="id">take</span> (_ || _ = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#orb_false_elim">Bool.orb_false_elim</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">congruence</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.dom_restrict">dom_restrict</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">Γ</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.dom_lb">dom_lb</a></span> <span class="id">H</span> <span class="id">Γ</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.dom">dom</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.restrict">restrict</a></span> <span class="id">H</span> <span class="id">Γ</span>) <span class="id">Γ</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.dom">dom</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.dom_lb">dom_lb</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * [].<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_In">FEnv.restrict_In</a></span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.vars_of_senv_Var">vars_of_senv_Var</a></span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.vars_of_senv_Last">vars_of_senv_Last</a></span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>; <span class="id">split</span>; <span class="id">firstorder</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationPairs.html">RelationPairs</a></span>.<br/>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.merge">merge</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _ ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> * (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _)) ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _ ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">merge_morph1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">cs</span> <span class="id">cs'</span> <span class="id">Ecs</span> <span class="id">lxs</span> <span class="id">lxs'</span> <span class="id">Elxs</span> <span class="id">os</span> <span class="id">os'</span> <span class="id">Eos</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">cs'</span> <span class="kwd">as</span> [[]], <span class="id">os'</span> <span class="kwd">as</span> [[]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hc</span>; <span class="id">inv</span> <span class="id">Ecs</span>; <span class="id">inv</span> <span class="id">Eos</span>; <span class="id">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id">Cofix</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> ((<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> * _)%<span class="id">signature</span> _ _) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [? <span class="id">HH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationPairs.html#RelCompFun">RelCompFun</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_in_right">Forall2_in_right</a></span> <span class="kwd">in</span> <span class="id">Elxs</span> <span class="kwd">as</span> (?&amp;?&amp; [? <span class="id">HH</span>]); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationPairs.html#RelCompFun">RelCompFun</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">rewrite</span> &lt;- <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">take</span> (_ = _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id">Cofix</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> ((<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> * _)%<span class="id">signature</span> _ _) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [? <span class="id">HH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationPairs.html#RelCompFun">RelCompFun</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> _ _) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists_exists">Exists_exists</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> ([] &amp;?&amp;?&amp;?); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_in_left">Forall2_in_left</a></span> <span class="kwd">in</span> <span class="id">Elxs</span> <span class="kwd">as</span> ([] &amp;?&amp; [? <span class="id">HH</span>]); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationPairs.html#RelCompFun">RelCompFun</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_Exists</span>; <span class="id">eauto</span>; <span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_in_right">Forall2_in_right</a></span> <span class="kwd">in</span> <span class="id">Elxs</span> <span class="kwd">as</span> ([] &amp;?&amp; [? <span class="id">HH</span>]); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationPairs.html#RelCompFun">RelCompFun</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">HH</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case">case</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _ ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> * (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _)) ==&gt; <span class="id"><a href="Velus.Common.Common.html#orel">orel</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _ ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">case_morph1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">cs</span> <span class="id">cs'</span> <span class="id">Ecs</span> <span class="id">lxs</span> <span class="id">lxs'</span> <span class="id">Elxs</span> <span class="id">ds</span> <span class="id">ds'</span> <span class="id">Eds</span> <span class="id">os</span> <span class="id">os'</span> <span class="id">Eos</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">cs'</span> <span class="kwd">as</span> [[]], <span class="id">os'</span> <span class="kwd">as</span> [[]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hc</span>; <span class="id">inv</span> <span class="id">Ecs</span>; <span class="id">inv</span> <span class="id">Eos</span>; <span class="id">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id">Cofix</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> ((<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> * _)%<span class="id">signature</span> _ _) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [? <span class="id">HH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationPairs.html#RelCompFun">RelCompFun</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">Eds</span>; <span class="id">constructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.tl_EqSt">tl_EqSt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_in_right">Forall2_in_right</a></span> <span class="kwd">in</span> <span class="id">Elxs</span> <span class="kwd">as</span> (?&amp;?&amp; [? <span class="id">HH</span>]); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationPairs.html#RelCompFun">RelCompFun</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">rewrite</span> &lt;- <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">Eds</span>; <span class="id">simpl</span>; <span class="id">auto</span>; <span class="id">erewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.hd_EqSt">hd_EqSt</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">take</span> (_ = _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id">Cofix</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> ((<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> * _)%<span class="id">signature</span> _ _) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [? <span class="id">HH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationPairs.html#RelCompFun">RelCompFun</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">Eds</span>; <span class="id">constructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.tl_EqSt">tl_EqSt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_in_right">Forall2_in_right</a></span> <span class="kwd">in</span> <span class="id">Elxs</span> <span class="kwd">as</span> (?&amp;?&amp; [? <span class="id">HH</span>]); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationPairs.html#RelCompFun">RelCompFun</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">rewrite</span> &lt;- <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">Eds</span>; <span class="id">simpl</span>; <span class="id">auto</span>; <span class="id">erewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.hd_EqSt">hd_EqSt</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> _ _) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists_exists">Exists_exists</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> ([] &amp;?&amp;?&amp;?); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_in_left">Forall2_in_left</a></span> <span class="kwd">in</span> <span class="id">Elxs</span> <span class="kwd">as</span> ([] &amp;?&amp; [? <span class="id">HH</span>]); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationPairs.html#RelCompFun">RelCompFun</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_Exists</span>; <span class="id">eauto</span>; <span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">HH</span>.<br/>
&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">take</span> (_ = _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Eds</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">sy</span>; <span class="id">take</span> (_ <span class="id">⋅</span> _ <span class="id">≡</span> _) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [<span class="id">HHH</span> <span class="id">Htl</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">HHH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.CasePDef">CasePDef</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id">Cofix</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> ((<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> * _)%<span class="id">signature</span> _ _) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [? <span class="id">HH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationPairs.html#RelCompFun">RelCompFun</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_in_right">Forall2_in_right</a></span> <span class="kwd">in</span> <span class="id">Elxs</span> <span class="kwd">as</span> (?&amp;?&amp; [? <span class="id">HH</span>]); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationPairs.html#RelCompFun">RelCompFun</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">rewrite</span> &lt;- <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_in_right">Forall2_in_right</a></span> <span class="kwd">in</span> <span class="id">Elxs</span> <span class="kwd">as</span> (?&amp;?&amp; [<span class="id">HH</span>]); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationPairs.html#RelCompFun">RelCompFun</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> <span class="string">"remember_sts"</span> <span class="id">constr</span>(<span class="id">s</span>) <span class="string">"as"</span> <span class="id">ident</span>(<span class="id">x</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Hx</span> := <span class="id">fresh</span> <span class="string">"H"</span><span class="id">x</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">remember</span> <span class="id">s</span> <span class="kwd">as</span> <span class="id">x</span> <span class="id">eqn</span>:<span class="id">Hx</span>;<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.eq_EqSts">eq_EqSts</a></span> <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
<br/>
<br/>
<div class="doc">Dans cette section on donne une définition alternative aux règles
    du merge/case (LSemantics.Smerge/ScaseTotal/Scasedefault),
    qui ne manipule plus de Forall2Brs mais plutôt du Forall2t.
    Ça correspond mieux aux définitions de Denot.v, notamment <span class="bracket"><span class="id">denot_expss</span></span>. </div>
<span class="kwd">Section</span> <span class="id"><a name="SDTOREL.Sem_alt">Sem_alt</a></span>.<br/>
<br/>
<div class="doc">Comment obtenir le prédicat Forall2Brs de LSemantics.Smerge sans
      avoir à manipuler de Forall3... </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.Forall2Brs_transp">Forall2Brs_transp</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ess</span> <span class="id">vss</span> <span class="id">d</span> <span class="id">Hk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vss</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> '(<span class="id">t</span>, <span class="id">es</span>) (<span class="id">vs</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">xss</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span>) <span class="id">es</span> <span class="id">xss</span> /\ <span class="id">vs</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#pair">pair</a></span> <span class="id">t</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">xss</span>)) <span class="id">ess</span> <span class="id">vss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.Forall2Brs">Forall2Brs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span>) <span class="id">ess</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> (<span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#transp">transp</a></span> <span class="id">d</span> <span class="id">vss</span> <span class="id">Hk</span>)).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Nnil</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#transp">transp</a></span> <span class="id">d</span> <span class="id">vss</span> <span class="id">Hk</span>) <span class="kwd">as</span> (<span class="id">vsst</span> &amp; <span class="id">HH</span> &amp; <span class="id">Hnm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> [<span class="id">Hlt</span> <span class="id">Hllt</span>]; <span class="id">auto</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hk</span> <span class="kwd">as</span> (<span class="id">k</span> &amp; <span class="id">Hk</span>); <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Nnil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> <span class="id">dependent</span> <span class="id">vsst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">Hf</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="id">destruct</span> <span class="id">x</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">x</span> <span class="kwd">as</span> (<span class="id">t</span>, <span class="id">es</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">xss</span> &amp; <span class="id">Hsem</span> &amp; ?); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> (<span class="id">IHHf</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#tl">tl</a></span> _) <span class="id">vsst</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">simpl_Forall</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">intros</span>; <span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_gt_cases">Nat.le_gt_cases</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">vsst</span>) <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">erewrite</span> <span class="id">map_nth'</span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#tl_nth">tl_nth</a></span>, <span class="id">Hnm</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_overflow">nth_overflow</a></span> <span class="kwd">at</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#nth_nil">nth_nil</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_overflow">nth_overflow</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_in_or_default">nth_in_or_default</a></span> <span class="id">n</span> <span class="id">l'</span> []) <span class="kwd">as</span> [| -&gt;]; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">simpl_Forall</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#tl_length">tl_length</a></span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_map_2">Forall3_map_2</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall3_same_2_3">Forall3_same_2_3</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">IHHf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall2">Forall2_forall2</a></span>; <span class="id">split</span>; <span class="id">intros</span>; <span class="id">subst</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_indep">nth_indep</a></span> <span class="kwd">with</span> (<span class="id">d'</span> := []); <span class="id">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id">n</span> <span class="id">vsst</span> []) <span class="id">vsst</span>) <span class="kwd">as</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_In">nth_In</a></span>; <span class="id">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id">n</span> <span class="id">vsst</span> []) <span class="id">eqn</span>:<span class="id">GG</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hnm</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">GG</span> <span class="kwd">in</span> <span class="id">Hnm</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hnm</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">map_nth'</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
<div class="doc">Cette définition semble plus naturelle : vss correspond exactement
      à la matrice de concaténation de <span class="bracket"><span class="id">sem_exp</span></span> sur ess, l'opérateur
      merge relationnel est appliqué sur les lignes de la matrice
      grâce à Forall2t. </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.Smerge_alt">Smerge_alt</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">b</span> <span class="id">x</span> <span class="id">tx</span> <span class="id">ess</span> <span class="id">lann</span> <span class="id">os</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">d</span> (<span class="id">xs</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>) (<span class="id">vss</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.sem_var">sem_var</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vss</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">l</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">os</span>) <span class="id">vss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> '(<span class="id">t</span>,<span class="id">es</span>) <span class="id">vs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">xss</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span>) <span class="id">es</span> <span class="id">xss</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">vs</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#pair">pair</a></span> <span class="id">t</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">xss</span>)) <span class="id">ess</span> <span class="id">vss</span>  -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t">Forall2t</a></span> <span class="id">d</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.merge">merge</a></span> <span class="id">xs</span>) <span class="id">vss</span> <span class="id">os</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Emerge">Emerge</a></span> (<span class="id">x</span>, <span class="id">tx</span>) <span class="id">ess</span> <span class="id">lann</span>) <span class="id">os</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hx</span> <span class="id">Nnil</span> <span class="id">Hl</span> <span class="id">Hf</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t_Forall2">Forall2t_Forall2</a></span> <span class="kwd">in</span> <span class="id">Ht</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Forall2Brs_transp">Forall2Brs_transp</a></span> <span class="kwd">in</span> <span class="id">Hf</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Ht</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#transp">transp</a></span> <span class="id">d</span> <span class="id">vss</span> _) <span class="kwd">as</span> (<span class="id">vsst</span> &amp; <span class="id">HH</span>); <span class="id">intros</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> ([<span class="id">Hlt</span> <span class="id">Hllt</span>] &amp; <span class="id">Hnm</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.Smerge">Smerge</a></span> <span class="kwd">with</span> <span class="id">xs</span> <span class="id">vsst</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ScaseTotal_alt">ScaseTotal_alt</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">ess</span> <span class="id">tys</span> <span class="id">ck</span> <span class="id">os</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">d</span> (<span class="id">s</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>) (<span class="id">vss</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vss</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tys</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">os</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> [<span class="id">s</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">l</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">os</span>) <span class="id">vss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> '(<span class="id">t</span>,<span class="id">es</span>) <span class="id">vs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">xss</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span>) <span class="id">es</span> <span class="id">xss</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">vs</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#pair">pair</a></span> <span class="id">t</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">xss</span>)) <span class="id">ess</span> <span class="id">vss</span>  -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t">Forall2t</a></span> <span class="id">d</span> (<span class="kwd">fun</span> <span class="id">l</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case">case</a></span> <span class="id">s</span> <span class="id">l</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id">vss</span> <span class="id">os</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Ecase">Ecase</a></span> <span class="id">e</span> <span class="id">ess</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> (<span class="id">tys</span>, <span class="id">ck</span>)) <span class="id">os</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">He</span> <span class="id">Nnil</span> <span class="id">Hl</span> <span class="id">Hl2</span> <span class="id">Hf</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t_Forall2">Forall2t_Forall2</a></span> <span class="kwd">in</span> <span class="id">Ht</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Forall2Brs_transp">Forall2Brs_transp</a></span> <span class="kwd">in</span> <span class="id">Hf</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Ht</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#transp">transp</a></span> <span class="id">d</span> <span class="id">vss</span> _) <span class="kwd">as</span> (<span class="id">vsst</span> &amp; <span class="id">HH</span>); <span class="id">intros</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> ([<span class="id">Hlt</span> <span class="id">Hllt</span>] &amp; <span class="id">Hnm</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.ScaseTotal">ScaseTotal</a></span> <span class="kwd">with</span> <span class="id">s</span> <span class="id">vsst</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ScaseDefault_alt">ScaseDefault_alt</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">ess</span> <span class="id">eds</span> <span class="id">tys</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">d</span> (<span class="id">s</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>) (<span class="id">sds</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>))) (<span class="id">vss</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>))) <span class="id">os</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vss</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> [<span class="id">s</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.wt_streams">wt_streams</a></span> [<span class="id">s</span>] (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typeof">typeof</a></span> <span class="id">e</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span>) <span class="id">eds</span> <span class="id">sds</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">sds</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">os</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">l</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">os</span>) <span class="id">vss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> '(<span class="id">t</span>,<span class="id">es</span>) <span class="id">vs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">xss</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span>) <span class="id">es</span> <span class="id">xss</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">vs</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#pair">pair</a></span> <span class="id">t</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">xss</span>)) <span class="id">ess</span> <span class="id">vss</span>  -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t">Forall2t</a></span> <span class="id">d</span> (<span class="kwd">fun</span> <span class="id">l</span> <span class="id">dos</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case">case</a></span> <span class="id">s</span> <span class="id">l</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">dos</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">dos</span>)) (<span class="id">vss</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">sds</span>) <span class="id">os</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Ecase">Ecase</a></span> <span class="id">e</span> <span class="id">ess</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">eds</span>) (<span class="id">tys</span>, <span class="id">ck</span>)) <span class="id">os</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Nnil</span> <span class="id">He</span> <span class="id">Hwt</span> <span class="id">Heds</span> <span class="id">Hld</span> <span class="id">Hl</span> <span class="id">Hf</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">l</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">sds</span>) <span class="id">os</span>)) <span class="id">vss</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">length_combine'</span>, <span class="id">Hld</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t_Forall2">Forall2t_Forall2</a></span> <span class="kwd">in</span> <span class="id">Ht</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Forall2Brs_transp">Forall2Brs_transp</a></span> <span class="kwd">in</span> <span class="id">Hf</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hf</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#transp">transp</a></span> _ <span class="id">vss</span> _) <span class="kwd">as</span> (<span class="id">vsst</span> &amp; <span class="id">HH</span>); <span class="id">intros</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> ([<span class="id">Hlt</span> <span class="id">Hllt</span>] &amp; <span class="id">Hnm</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.ScaseDefault">ScaseDefault</a></span> <span class="kwd">with</span> <span class="id">s</span> <span class="id">vsst</span> <span class="id">sds</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_map_2">Forall3_map_2</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall3_combine2">Forall3_combine2</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.EqSts_concat_eq">EqSts_concat_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>)) (<span class="id">ss</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> <span class="id">s</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">ss</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">ss'</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> <span class="id">ss'</span> <span class="id">ss</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">s</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">ss'</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> ??; <span class="id">revert</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ss</span>; <span class="id">intros</span> * <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Heq</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_app_inv_r">Forall2_app_inv_r</a></span> <span class="kwd">in</span> <span class="id">Heq</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp; <span class="id">Happ</span> &amp;?); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHss</span> <span class="kwd">in</span> <span class="id">Happ</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="id">subst</span>; <span class="id">eauto</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.Smerge_alt2">Smerge_alt2</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">b</span> <span class="id">x</span> <span class="id">tx</span> <span class="id">ess</span> <span class="id">lann</span> <span class="id">os</span>,<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">d</span> (<span class="id">xs</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>) (<span class="id">vss</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.sem_var">sem_var</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vss</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">l</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">os</span>) <span class="id">vss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> '(_,<span class="id">es</span>) <span class="id">vs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">xss</span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> <span class="id">vs</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">xss</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span>) <span class="id">es</span> <span class="id">xss</span>) <span class="id">ess</span> <span class="id">vss</span>  -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t">Forall2t</a></span> <span class="id">d</span> (<span class="kwd">fun</span> <span class="id">ss</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.merge">merge</a></span> <span class="id">xs</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ess</span>) <span class="id">ss</span>)) <span class="id">vss</span> <span class="id">os</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Emerge">Emerge</a></span> (<span class="id">x</span>, <span class="id">tx</span>) <span class="id">ess</span> <span class="id">lann</span>) <span class="id">os</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hx</span> <span class="id">Nnil</span> <span class="id">Hl</span> <span class="id">Hf</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Smerge_alt">Smerge_alt</a></span>  <span class="kwd">with</span> (<span class="id">d</span> := (56, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)) (<span class="id">xs</span> := <span class="id">xs</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;4: <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t_combine">Forall2t_combine</a></span> <span class="kwd">in</span> <span class="id">Ht</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">vss</span>, <span class="id">ess</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">congruence</span>; <span class="id">inv</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>, <span class="id">Forall2_combine'</span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_ignore1'</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall3_combine'2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_map_2">Forall3_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall3_same_1_2">Forall3_same_1_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.EqSts_concat_eq">EqSts_concat_eq</a></span> <span class="kwd">as</span> (?&amp; <span class="id">Heq</span> &amp;?); <span class="id">eauto</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>; <span class="id">split</span>; <span class="id">auto</span>; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Heq</span>.<br/>
Qed.</div></details>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ScaseTotal_alt2">ScaseTotal_alt2</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">ess</span> <span class="id">tys</span> <span class="id">ck</span> <span class="id">os</span>,<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">d</span> (<span class="id">s</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>) (<span class="id">vss</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> [<span class="id">s</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vss</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tys</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">os</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">l</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">os</span>) <span class="id">vss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> '(_,<span class="id">es</span>) <span class="id">vs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">xss</span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> <span class="id">vs</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">xss</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span>) <span class="id">es</span> <span class="id">xss</span>) <span class="id">ess</span> <span class="id">vss</span>  -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t">Forall2t</a></span> <span class="id">d</span> (<span class="kwd">fun</span> <span class="id">ss</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case">case</a></span> <span class="id">s</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ess</span>) <span class="id">ss</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id">vss</span> <span class="id">os</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Ecase">Ecase</a></span> <span class="id">e</span> <span class="id">ess</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> (<span class="id">tys</span>, <span class="id">ck</span>)) <span class="id">os</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">He</span> <span class="id">Nnil</span> <span class="id">Hl</span> <span class="id">Hl2</span> <span class="id">Hf</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ScaseTotal_alt">ScaseTotal_alt</a></span>  <span class="kwd">with</span> (<span class="id">d</span> := (56, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)) (<span class="id">s</span> := <span class="id">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;4: <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t_combine">Forall2t_combine</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="kwd">fun</span> <span class="id">ts</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case">case</a></span> <span class="id">s</span> <span class="id">ts</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="kwd">in</span> <span class="id">Ht</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">vss</span>, <span class="id">ess</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">congruence</span>; <span class="id">inv</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>, <span class="id">Forall2_combine'</span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_ignore1'</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall3_combine'2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_map_2">Forall3_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall3_same_1_2">Forall3_same_1_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.EqSts_concat_eq">EqSts_concat_eq</a></span> <span class="kwd">as</span> (?&amp; <span class="id">Heq</span> &amp;?); <span class="id">eauto</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>; <span class="id">split</span>; <span class="id">auto</span>; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Heq</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ScaseDefault_alt2">ScaseDefault_alt2</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">ess</span> <span class="id">eds</span> <span class="id">tys</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">d</span> (<span class="id">s</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>) (<span class="id">sds</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>))) (<span class="id">vss</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>))) <span class="id">os</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vss</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> [<span class="id">s</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.wt_streams">wt_streams</a></span> [<span class="id">s</span>] (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typeof">typeof</a></span> <span class="id">e</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span>) <span class="id">eds</span> <span class="id">sds</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">sds</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">os</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">l</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">os</span>) <span class="id">vss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> '(_,<span class="id">es</span>) <span class="id">vs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">xss</span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> <span class="id">vs</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">xss</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span>) <span class="id">es</span> <span class="id">xss</span>) <span class="id">ess</span> <span class="id">vss</span>  -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t">Forall2t</a></span> <span class="id">d</span> (<span class="kwd">fun</span> <span class="id">ss</span> <span class="id">dos</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case">case</a></span> <span class="id">s</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ess</span>) <span class="id">ss</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">dos</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">dos</span>)) <span class="id">vss</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">sds</span>) <span class="id">os</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Ecase">Ecase</a></span> <span class="id">e</span> <span class="id">ess</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">eds</span>) (<span class="id">tys</span>, <span class="id">ck</span>)) <span class="id">os</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Nnil</span> <span class="id">He</span> <span class="id">Hwt</span> <span class="id">Heds</span> <span class="id">Hld</span> <span class="id">Hl</span> <span class="id">Hf</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ScaseDefault_alt">ScaseDefault_alt</a></span>  <span class="kwd">with</span> (<span class="id">d</span> := (56, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)) (<span class="id">s</span> := <span class="id">s</span>) (<span class="id">sds</span> := <span class="id">sds</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;4: <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t_combine">Forall2t_combine</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="kwd">fun</span> <span class="id">ts</span> =&gt; <span class="kwd">fun</span> _ =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case">case</a></span> <span class="id">s</span> <span class="id">ts</span> _ _) <span class="kwd">in</span> <span class="id">Ht</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">vss</span>, <span class="id">ess</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">congruence</span>; <span class="id">inv</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>, <span class="id">Forall2_combine'</span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_ignore1'</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall3_combine'2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_map_2">Forall3_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall3_same_1_2">Forall3_same_1_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.EqSts_concat_eq">EqSts_concat_eq</a></span> <span class="kwd">as</span> (?&amp; <span class="id">Heq</span> &amp;?); <span class="id">eauto</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>; <span class="id">split</span>; <span class="id">auto</span>; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_combine">length_combine</a></span>, <span class="id">Hld</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">lia</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Sem_alt">Sem_alt</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="SDTOREL.FromLClockedSemantics">FromLClockedSemantics</a></span>.<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.clocks_of_false">clocks_of_false</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ss</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.clocks_of">clocks_of</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> _ : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) <span class="id">ss</span>) <span class="id">≡</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> *.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="id">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.clocks_of_nth">clocks_of_nth</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ss</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const_nth">const_nth</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.clocks_of_false2">clocks_of_false2</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.clocks_of">clocks_of</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) <span class="id">n</span>) <span class="id">≡</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="id">intro</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.clocks_of_nth">clocks_of_nth</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const_nth">const_nth</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.fby_absent">fby_absent</a></span> {<span class="id">A</span>}:<br/>
&nbsp;&nbsp;@<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.fby">fby</a></span> <span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#const_Cons">CommonStreams.const_Cons</a></span>. <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<span class="kwd">Corollary</span> <span class="id">sem_node_cons'</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">nd</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.node">node</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">nds</span> <span class="id">types</span> <span class="id">externs</span> <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Ordered_nodes">Ordered_nodes</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Global">Global</a></span> <span class="id">types</span> <span class="id">externs</span> (<span class="id">nd</span>::<span class="id">nds</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node">sem_node</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Global">Global</a></span> <span class="id">types</span> <span class="id">externs</span> <span class="id">nds</span>) <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id">nd</span>.(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_name">n_name</a></span>) &lt;&gt; <span class="id">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node">sem_node</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Global">Global</a></span> <span class="id">types</span> <span class="id">externs</span> (<span class="id">nd</span>::<span class="id">nds</span>)) <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
Admitted.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id">sem_block_cons'</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">nd</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.node">node</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">nds</span> <span class="id">types</span> <span class="id">externs</span> <span class="id">bck</span> <span class="id">Hi</span> <span class="id">bk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Ordered_nodes">Ordered_nodes</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Global">Global</a></span> <span class="id">types</span> <span class="id">externs</span> (<span class="id">nd</span>::<span class="id">nds</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_block">sem_block</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Global">Global</a></span> <span class="id">types</span> <span class="id">externs</span> <span class="id">nds</span>) <span class="id">Hi</span> <span class="id">bk</span> <span class="id">bck</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; ~<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Is_node_in_block">Is_node_in_block</a></span> <span class="id">nd</span>.(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_name">n_name</a></span>) <span class="id">bck</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_block">sem_block</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Global">Global</a></span> <span class="id">types</span> <span class="id">externs</span> (<span class="id">nd</span>::<span class="id">nds</span>)) <span class="id">Hi</span> <span class="id">bk</span> <span class="id">bck</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
Admitted.</div></details>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.FromLClockedSemantics">FromLClockedSemantics</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="SDTOREL.Sem_absent">Sem_absent</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.wt_absent">wt_absent</a></span> : <span class="kwd">forall</span> <span class="id">ty</span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.wt_stream">wt_stream</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) <span class="id">ty</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intro</span>; <span class="kwd">cofix</span> <span class="id">Cof</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> _)); <span class="id">constructor</span>; <span class="id">cbn</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="SDTOREL.sem_global_abs">sem_global_abs</a></span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ss</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">os</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node">sem_node</a></span> <span class="id">G</span> <span class="id">f</span> <span class="id">ss</span> <span class="id">os</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.sem_exp_absent">sem_exp_absent</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Γ</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_global_abs">sem_global_abs</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> <span class="id">G</span> <span class="id">Γ</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="kwd">fun</span> _ =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">e</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">HG</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.exp_ind2">exp_ind2</a></span>; <span class="id">intros</span> <span class="id">Hr</span> <span class="id">Hwt</span> ?; <span class="id">inv</span> <span class="id">Hr</span>; <span class="id">inv</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Econst&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="id">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">const_nth'</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Eenum&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="id">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">enum_nth'</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Evar&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">econstructor</span>; <span class="id">now</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Eunop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typeof">typeof</a></span> <span class="id">e</span> = _) <span class="id">and</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typeof_numstreams">length_typeof_numstreams</a></span>, <span class="id">it</span> <span class="kwd">in</span> <span class="id">IHe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Is_node_in_exp">Is_node_in_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.lift1_spec">lift1_spec</a></span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">split</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Ebinop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typeof">typeof</a></span> <span class="id">e1</span> = _) <span class="id">and</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typeof_numstreams">length_typeof_numstreams</a></span>, <span class="id">it</span> <span class="kwd">in</span> <span class="id">IHe1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typeof">typeof</a></span> <span class="id">e2</span> = _) <span class="id">and</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typeof_numstreams">length_typeof_numstreams</a></span>, <span class="id">it</span> <span class="kwd">in</span> <span class="id">IHe2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Is_node_in_exp">Is_node_in_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.lift2_spec">lift2_spec</a></span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">repeat</span> <span class="id">split</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Efby&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.Sfby">Sfby</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s0ss</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span>)) <span class="id">e0s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sss</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span>)) <span class="id">es</span>); <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">clear</span> <span class="id">H9</span> <span class="id">H10</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">e0s</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">constructor</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H4</span>; <span class="id">inv</span> <span class="id">H7</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">clear</span> <span class="id">H9</span> <span class="id">H10</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">es</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">H0</span>; <span class="id">inv</span> <span class="id">H6</span>; <span class="id">inv</span> <span class="id">H8</span>; <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> &lt;- 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#flat_map_repeat">flat_map_repeat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span>, &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typesof_annots">length_typesof_annots</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typesof">typesof</a></span> <span class="id">es</span> = _) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typesof">typesof</a></span> <span class="id">e0s</span> = _) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall3_repeat">Forall3_repeat</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.fby_absent">fby_absent</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Ewhen&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.Swhen">Swhen</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ss</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span>)) <span class="id">es</span>); <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_same">Forall2_same</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>) <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> _ _) <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econstructor</span>; <span class="id">now</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#flat_map_repeat">flat_map_repeat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typesof_annots">length_typesof_annots</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2_repeat">Forall2_repeat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.when_spec">when_spec</a></span>. <span class="id">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">repeat</span> <span class="id">split</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Emerge&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">vss</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">t</span>,<span class="id">es</span>) =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id">t</span>, @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#list_sum">list_sum</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">es</span>))) <span class="id">es</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hl</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">l</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tys</span>) <span class="id">vss</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span> <span class="id">vss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat_length">repeat_length</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typesof_annots">length_typesof_annots</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Smerge_alt">Smerge_alt</a></span> <span class="kwd">with</span> (<span class="id">d</span> := (46, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)) (<span class="id">vss</span> := <span class="id">vss</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">vss</span>; <span class="id">rewrite</span> ?<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat_length">repeat_length</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#map_eq_nnil">map_eq_nnil</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econstructor</span>; <span class="id">now</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">subst</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span>)) <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat_map">concat_map</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#flat_map_repeat">flat_map_repeat</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_repeat">map_repeat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t_forall2">Forall2t_forall2</a></span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> ?<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat_length">repeat_length</a></span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_repeat">nth_repeat</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.merge_spec">merge_spec</a></span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">repeat</span> <span class="id">split</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#nth_repeat_in">nth_repeat_in</a></span>; <span class="id">simpl</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typesof_annots">length_typesof_annots</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Ecase&nbsp;total&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typeof">typeof</a></span> <span class="id">e</span> = _) <span class="id">and</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typeof_numstreams">length_typeof_numstreams</a></span>, <span class="id">it</span> <span class="kwd">in</span> <span class="id">IHe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">vss</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">t</span>,<span class="id">es</span>) =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id">t</span>, @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#list_sum">list_sum</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">es</span>))) <span class="id">es</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hl</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">l</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tys</span>) <span class="id">vss</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span> <span class="id">vss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat_length">repeat_length</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typesof_annots">length_typesof_annots</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ScaseTotal_alt">ScaseTotal_alt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">d</span> := (46, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)) (<span class="id">vss</span> := <span class="id">vss</span>) (<span class="id">s</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">vss</span>; <span class="id">rewrite</span> ?<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat_length">repeat_length</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#map_eq_nnil">map_eq_nnil</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">subst</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span>)) <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat_map">concat_map</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#flat_map_repeat">flat_map_repeat</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_repeat">map_repeat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t_forall2">Forall2t_forall2</a></span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> ?<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat_length">repeat_length</a></span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_repeat">nth_repeat</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case_spec">case_spec</a></span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">repeat</span> <span class="id">split</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#nth_repeat_in">nth_repeat_in</a></span>; <span class="id">simpl</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typesof_annots">length_typesof_annots</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Ecase&nbsp;défaut&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typeof">typeof</a></span> <span class="id">e</span> = _) <span class="id">and</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typeof_numstreams">length_typeof_numstreams</a></span>, <span class="id">it</span> <span class="kwd">in</span> <span class="id">IHe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">vss</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">t</span>,<span class="id">es</span>) =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id">t</span>, @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#list_sum">list_sum</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">es</span>))) <span class="id">es</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hl</span> : <span class="comment">(*&nbsp;utile&nbsp;dans&nbsp;la&nbsp;suite&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span>)) <span class="id">des</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typesof">typesof</a></span> <span class="id">des</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#concat_length_sum">concat_length_sum</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typesof_annots">length_typesof_annots</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat_length">repeat_length</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ScaseDefault_alt">ScaseDefault_alt</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d</span> := (46, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sds</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span>)) <span class="id">des</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vss</span> := <span class="id">vss</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">vss</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#map_eq_nnil">map_eq_nnil</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;wt_streams&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typeof">typeof</a></span> <span class="id">e</span> = _) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.wt_absent">wt_absent</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;sds&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_same">Forall2_same</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> _ _) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;length&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat_length">repeat_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typesof">typesof</a></span> _ = _) <span class="id">and</span> <span class="id">rewrite</span> &lt;- <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typesof_annots">length_typesof_annots</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;vss&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span>)) <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat_map">concat_map</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#flat_map_repeat">flat_map_repeat</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_repeat">map_repeat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Forall2t&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t_forall2">Forall2t_forall2</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">length_combine'</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat_length">repeat_length</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typesof">typesof</a></span> _ = _) <span class="id">and</span> <span class="id">rewrite</span> &lt;- <span class="id">it</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typesof_annots">length_typesof_annots</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">intros</span> <span class="id">n</span> <span class="id">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#flat_map_repeat">flat_map_repeat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine_nth">combine_nth</a></span>, 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_repeat">nth_repeat</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat_length">repeat_length</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typesof_annots">length_typesof_annots</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case_spec">case_spec</a></span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">repeat</span> <span class="id">split</span>; <span class="id">simpl</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#nth_repeat_in">nth_repeat_in</a></span>; <span class="id">simpl</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">length_combine'</span>, <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#concat_length_sum">concat_length_sum</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span> <span class="kwd">in</span> <span class="id">Hn</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat_length">repeat_length</a></span> <span class="kwd">in</span> <span class="id">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typesof_annots">length_typesof_annots</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typesof">typesof</a></span> _ = _) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typesof_annots">length_typesof_annots</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Eapp&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.Sapp">Sapp</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ss</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span>)) <span class="id">es</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rs</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span>)) <span class="id">er</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">bs</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_same">Forall2_same</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>) <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> _ _) <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_same">Forall2_same</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> _ _) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#flat_map_repeat">flat_map_repeat</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#repeat_map">repeat_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.bools_ofs_absent">bools_ofs_absent</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intro</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#flat_map_repeat">flat_map_repeat</a></span>, 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_repeat">map_repeat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typesof_annots">length_typesof_annots</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node_morph">sem_node_morph</a></span> <span class="kwd">in</span> <span class="id">HG</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;in&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> _ _ (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>)) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">k</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.mask_false_0">mask_false_0</a></span> | <span class="id">now</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.mask_false_S">mask_false_S</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;out&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> _ _ (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">k</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.mask_false_0">mask_false_0</a></span> | <span class="id">now</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.mask_false_S">mask_false_S</a></span>].<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="SDTOREL.abs_hist_of_vars">abs_hist_of_vars</a></span> (<span class="id">vars</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.decl">decl</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.history">history</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Common.Common.html#mem_ident">mem_ident</a></span> <span class="id">x</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">vars</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.FunctionalEnvironment.html#Last">Last</a></span> <span class="id">x</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.abs_hist_of_vars_dom">abs_hist_of_vars_dom</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vars</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(_, (_, _, _, <span class="id">o</span>)) =&gt; <span class="id">o</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.dom">dom</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.abs_hist_of_vars">abs_hist_of_vars</a></span> <span class="id">vars</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">vars</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intro</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.abs_hist_of_vars">abs_hist_of_vars</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_decls">senv_of_decls</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.dom">dom</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.In">FEnv.In</a></span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intro</span> <span class="id">x</span>; (<span class="id">split</span>; [<span class="id">intros</span> (<span class="id">s</span> &amp; <span class="id">Hs</span>)|<span class="id">intros</span> <span class="id">Hf</span>]); <span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#mem_ident_spec">mem_ident_spec</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#mem_ident_false">mem_ident_false</a></span> <span class="kwd">in</span> <span class="id">HH</span>; <span class="id">contradict</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;- <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ((?&amp;((?&amp;?)&amp;?)&amp;?)&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">simpl_Forall</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.sem_global_absent">sem_global_absent</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_global">restr_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global">wt_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_global_abs">sem_global_abs</a></span> <span class="id">G</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> ?? [<span class="id">tys</span> <span class="id">exts</span> <span class="id">nds</span>] <span class="id">Hr</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">nds</span> <span class="kwd">as</span> [| <span class="id">n'</span> <span class="id">nds</span>]; <span class="id">intros</span> <span class="id">f</span> <span class="id">n</span> <span class="id">Hfind</span> ??. <span class="id">inv</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global_wl_global">wt_global_wl_global</a></span> <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hord</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.wl_global_Ordered_nodes">wl_global_Ordered_nodes</a></span> <span class="kwd">in</span> <span class="id">Hord</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#ident_eq_dec">ident_eq_dec</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_name">n_name</a></span> <span class="id">n'</span>)); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="id">auto</span>; <span class="id">inv</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;FIXME:&nbsp;en&nbsp;extraire&nbsp;un&nbsp;lemme,&nbsp;mais&nbsp;comment&nbsp;?&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">ss</span> <span class="id">os</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.Snode">Snode</a></span> <span class="kwd">with</span> (<span class="id">H</span> := <span class="kwd">fun</span> _ =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;ins&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall2">Forall2_forall2</a></span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.idents">idents</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat_length">repeat_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intros</span>; <span class="id">subst</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#nth_repeat_in">nth_repeat_in</a></span>; <span class="id">now</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;outs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall2">Forall2_forall2</a></span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.idents">idents</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat_length">repeat_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intros</span>; <span class="id">subst</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#nth_repeat_in">nth_repeat_in</a></span>; <span class="id">now</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;bloc&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sem_block_cons'</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_not_Is_node_in">find_node_not_Is_node_in</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hr</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_node">restr_node</a></span> _) <span class="id">and</span> <span class="id">inversion_clear</span> <span class="id">it</span> <span class="kwd">as</span> [?? <span class="id">Hr</span> (?&amp;?&amp;?)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Hr</span> <span class="kwd">as</span> [ <span class="id">vars</span> ??? <span class="id">Hn</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global_cons">wt_global_cons</a></span> <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hwt'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global_uncons">wt_global_uncons</a></span> <span class="kwd">in</span> <span class="id">Hwt</span>. <span class="id">inversion_clear</span> <span class="id">Hwt</span> <span class="kwd">as</span> [????? <span class="id">Hwt''</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">Hn</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwt''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_scope">wt_scope</a></span> _ _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;scope&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.Sscope">Sscope</a></span> <span class="kwd">with</span> (<span class="id">Hi'</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.abs_hist_of_vars">abs_hist_of_vars</a></span> <span class="id">vars</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.abs_hist_of_vars_dom">abs_hist_of_vars_dom</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_block_refines">sem_block_refines</a></span> <span class="kwd">with</span> (<span class="id">H</span> := <span class="kwd">fun</span> _ =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span> ?? <span class="id">Eq</span>. <span class="id">inv</span> <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.abs_hist_of_vars">abs_hist_of_vars</a></span> <span class="id">vars</span> <span class="id">x1</span>) <span class="id">eqn</span>:<span class="id">Find2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union1">FEnv.union1</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.abs_hist_of_vars">abs_hist_of_vars</a></span> <span class="kwd">in</span> *. <span class="id">cases</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union2">FEnv.union2</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_block">restr_block</a></span> _) <span class="id">and</span>  <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_block">wt_block</a></span> _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_equation">wt_equation</a></span> _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;equation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.Seq">Seq</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ss</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#repeat">repeat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span>)) <span class="id">es</span>); <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;expressions&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.clocks_of_false2">clocks_of_false2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> _ ?<span class="id">Γ</span>) _ |- _=&gt; <span class="id">revert</span> <span class="id">H</span>; <span class="id">generalize</span> <span class="id">Γ</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">clear</span> <span class="id">dependent</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">dependent</span> <span class="id">blks</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">es</span>; <span class="id">simpl_Forall</span>; <span class="id">constructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_exp_absent">sem_exp_absent</a></span>; <span class="id">now</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;variables&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">xs</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#list_sum">list_sum</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">es</span>)) <span class="kwd">as</span> <span class="id">Hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typesof_annots">length_typesof_annots</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_length">Forall2_length</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">Hl</span>. <span class="id">generalize</span> <span class="id">dependent</span> <span class="id">xs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">es</span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">destruct</span> <span class="id">xs</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#length_app_decomp">length_app_decomp</a></span> <span class="kwd">in</span> <span class="id">Hl</span> <span class="kwd">as</span> (<span class="id">xs1</span> &amp; <span class="id">xs2</span> &amp; ? &amp; <span class="id">Hl1</span> &amp; <span class="id">Hl2</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_app">Forall2_app</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">Hl1</span>; <span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">xs1</span>; <span class="id">simpl</span>; <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_other">find_node_other</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hr</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global_cons">wt_global_cons</a></span> <span class="kwd">in</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_global_abs">sem_global_abs</a></span> <span class="kwd">in</span> <span class="id">IHnds</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sem_node_cons'</span>; <span class="id">eauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Sem_absent">Sem_absent</a></span>.<br/>
<br/>
<br/>
<h2> Translation of <span class="bracket"><span class="id">DS</span> (<span class="id">sampl</span> <span class="id">value</span>)</span> to <span class="bracket"><span class="id">Stream</span> <span class="id">svalue</span></span>  </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="SDTOREL.sval_of_sampl">sval_of_sampl</a></span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.present">present</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="SDTOREL.S_of_DSv">S_of_DSv</a></span> := <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sval_of_sampl">sval_of_sampl</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.S_of_DSv_eq">S_of_DSv_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)) <span class="id">Hs</span> <span class="id">t</span> (<span class="id">Heq</span> : <span class="id">s</span> == <span class="id">t</span>),<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">Ht</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">s</span> <span class="id">Hs</span> <span class="id">≡</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">t</span> <span class="id">Ht</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">esplit</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#__S_of_DS_eq">__S_of_DS_eq</a></span> _ _ <span class="id">Hs</span> _ <span class="id">Heq</span>).<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.tl_rem">tl_rem</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">Inf</span> <span class="id">Inf'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">s</span> <span class="id">Inf</span>) <span class="id">≡</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ <span class="id">s</span>) <span class="id">Inf'</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Inf</span> <span class="kwd">as</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> (<span class="id">h</span> &amp; <span class="id">t</span> &amp; <span class="id">Hs</span> &amp; <span class="id">Inf3</span>).<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv_eq">S_of_DSv_eq</a></span>) <span class="kwd">as</span> [? -&gt;]; [ <span class="id">apply</span> <span class="id">Hs</span> |].<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv_eq">S_of_DSv_eq</a></span>) <span class="kwd">as</span> [? <span class="id">Eq2</span>].<br/>
&nbsp;&nbsp;2: <span class="id">setoid_rewrite</span> <span class="id">Eq2</span> <span class="kwd">at</span> 2.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM_simpl">REM_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_cons">S_of_DS_cons</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
Qed.</div></details>
<br/>
<h3> lift S_of_DSv on lists of streams </h3>
<span class="kwd">Definition</span> <span class="id"><a name="SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> {<span class="id">n</span>} (<span class="id">np</span> : @<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)) <span class="id">n</span>)<br/>
&nbsp;&nbsp;(<span class="id">Hinf</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> _) <span class="id">np</span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>).<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;- <span class="id">exact</span> [].<br/>
&nbsp;&nbsp;- <span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd">nprod_hd</a></span> <span class="id">np</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_hd">forall_nprod_hd</a></span> _ _ <span class="id">Hinf</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id">IHn</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_tl">nprod_tl</a></span> <span class="id">np</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_tl">forall_nprod_tl</a></span> _ _ <span class="id">Hinf</span>)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.Ss_of_nprod_length">Ss_of_nprod_length</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">np</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">n</span>) <span class="id">infn</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">infn</span>) = <span class="id">n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">eauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">np</span> <span class="id">np'</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">n</span>) <span class="id">Hinf</span> <span class="id">Hinf'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">np</span> == <span class="id">np'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">Hinf</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np'</span> <span class="id">Hinf'</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span> * <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>; <span class="id">rewrite</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">apply</span> <span class="id">IHn</span>; <span class="id">rewrite</span> <span class="id">Heq</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="SDTOREL.Ss_of_nprod_eq">Ss_of_nprod_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">n</span>} (<span class="id">np</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">n</span>) <span class="id">Hinf</span> <span class="id">np'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">np</span> == <span class="id">np'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">Hinf'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">Hinf</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np'</span> <span class="id">Hinf'</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> _) <span class="id">np'</span>) <span class="kwd">as</span> <span class="id">H</span> <span class="kwd">by</span> <span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">H</span>. <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.Ss_of_nprod_nth">Ss_of_nprod_nth</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">np</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">n</span>) <span class="id">Inf</span> <span class="id">k</span> <span class="id">d</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">Inf2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">Inf</span>) <span class="id">s</span> <span class="id">≡</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#get_nth">get_nth</a></span> <span class="id">k</span> <span class="id">d</span> <span class="id">np</span>) <span class="id">Inf2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hk</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_k">forall_nprod_k</a></span> _ _ <span class="id">Inf</span> <span class="id">k</span> <span class="id">d</span> <span class="id">Hk</span>).<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hk</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">k</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">unshelve</span> <span class="id">erewrite</span> <span class="id">IHn</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL._Ss_app">_Ss_app</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">m</span> (<span class="id">np</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">n</span>) (<span class="id">mp</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">m</span>) <span class="id">Hnm</span> <span class="id">Hn</span> <span class="id">Hm</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_app">nprod_app</a></span> <span class="id">np</span> <span class="id">mp</span>) <span class="id">Hnm</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">Hn</span>) ++ (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">mp</span> <span class="id">Hm</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd_app">nprod_hd_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">destruct</span> <span class="id">m</span>; <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">setoid_rewrite</span> &lt;- <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_app">forall_nprod_app</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_tl">forall_nprod_tl</a></span> <span class="kwd">in</span> <span class="id">Hn</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="SDTOREL.Ss_app">Ss_app</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">n</span> <span class="id">m</span>} (<span class="id">np</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">n</span>) (<span class="id">mp</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">m</span>) <span class="id">Hnm</span>,<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">Hn</span> <span class="id">Hm</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_app">nprod_app</a></span> <span class="id">np</span> <span class="id">mp</span>) <span class="id">Hnm</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">Hn</span>) ++ (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">mp</span> <span class="id">Hm</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#app_forall_nprod">app_forall_nprod</a></span> _ _ _ <span class="id">Hnm</span>) <span class="kwd">as</span> [<span class="id">Hn</span> <span class="id">Hm</span>].<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">Hn</span>,<span class="id">Hm</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_app">_Ss_app</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.Ss_map">Ss_map</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> (<span class="id">g</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">Inf</span> <span class="id">Inf'</span>, <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">x</span> <span class="id">Inf</span>) <span class="id">≡</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> (<span class="id">g</span> <span class="id">x</span>) <span class="id">Inf'</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">np</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">n</span>) <span class="id">Inf</span> <span class="id">Inf'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">Inf</span>)) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift">lift</a></span> <span class="id">g</span> <span class="id">np</span>) <span class="id">Inf'</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hfg</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id">Hfg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_hd">lift_hd</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_tl">lift_tl</a></span>; <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_hd">forall_nprod_hd</a></span> <span class="kwd">in</span> <span class="id">Inf'</span>; <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_hd">lift_hd</a></span> <span class="kwd">in</span> <span class="id">Inf'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_lift">forall_nprod_lift</a></span> <span class="kwd">in</span> <span class="id">Inf'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_lift">forall_nprod_lift</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_tl">forall_nprod_tl</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.Ss_of_nprod_hds">Ss_of_nprod_hds</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">np</span> : @<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)) <span class="id">n</span>) <span class="id">npc</span> <span class="id">npi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sval_of_sampl">sval_of_sampl</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hds">nprod_hds</a></span> <span class="id">np</span> <span class="id">npc</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">Streams.hd</a></span> _) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">npi</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hds">nprod_hds</a></span> _ _).<br/>
&nbsp;&nbsp;<span class="id">simpl</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> _ _).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#uncons">uncons</a></span> _) <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hd</span>).<br/>
&nbsp;&nbsp;<span class="id">simpl</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sval_of_sampl">sval_of_sampl</a></span> _).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp_eqCon">decomp_eqCon</a></span> <span class="kwd">in</span> <span class="id">Hd</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv_eq">S_of_DSv_eq</a></span>) <span class="kwd">as</span> [<span class="id">Inf</span> -&gt;]; [<span class="id">apply</span> <span class="id">Hd</span>|].<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_cons">S_of_DS_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">f_equal</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<div class="doc">comment passer de denot_exps à (concat denot_exp) </div>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.Ss_exps">Ss_exps</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ins</span> <span class="id">envG</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">es</span> <span class="id">Hinf</span> <span class="id">Infe</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exps">denot_exps</a></span> <span class="id">G</span> <span class="id">ins</span> <span class="id">es</span> <span class="id">envG</span> <span class="id">envI</span> <span class="id">env</span>) <span class="id">Hinf</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp">denot_exp</a></span> <span class="id">G</span> <span class="id">ins</span> <span class="id">e</span> <span class="id">envG</span> <span class="id">envI</span> <span class="id">env</span>) (<span class="id">Infe</span> <span class="id">e</span>)) <span class="id">es</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">es</span>; <span class="id">intros</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_eq">Ss_of_nprod_eq</a></span> _ <span class="id">Hinf</span>) <span class="kwd">as</span> [<span class="id">Inf'</span> -&gt;].<br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exps_eq">denot_exps_eq</a></span>; <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ex_proj2">ex_proj2</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ex_proj2">ex_proj2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_app">Ss_app</a></span> _ _ _))).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.app_EqSts">app_EqSts</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>.<br/>
Qed.</div></details>
<br/>
<br/>
<h3> lift Ss_of_nprod on matrix of streams </h3>
<span class="kwd">Fixpoint</span> <span class="id"><a name="SDTOREL.Ss_of_nprods">Ss_of_nprods</a></span> {<span class="id">n</span> <span class="id">m</span>} (<span class="id">nmp</span> : @<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)) <span class="id">m</span>) <span class="id">n</span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> _)) <span class="id">nmp</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>)) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">return</span> <span class="kwd">forall</span> (<span class="id">nmp</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">n</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> _)) <span class="id">nmp</span>) -&gt; _ <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="kwd">fun</span> _ _ =&gt; []<br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt; <span class="kwd">fun</span> <span class="id">nmp</span> <span class="id">Inf</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd">nprod_hd</a></span> <span class="id">nmp</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_hd">forall_nprod_hd</a></span> _ _ <span class="id">Inf</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id">Ss_of_nprods</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_tl">nprod_tl</a></span> <span class="id">nmp</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_tl">forall_nprod_tl</a></span> _ _ <span class="id">Inf</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span> <span class="id">nmp</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL._Ss_of_nprods_eq">_Ss_of_nprods_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">m</span> (<span class="id">np1</span> <span class="id">np2</span> : @<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)) <span class="id">m</span>) <span class="id">n</span>) <span class="id">Inf1</span> <span class="id">Inf2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">np1</span> == <span class="id">np2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprods">Ss_of_nprods</a></span> <span class="id">np1</span> <span class="id">Inf1</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprods">Ss_of_nprods</a></span> <span class="id">np2</span> <span class="id">Inf2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span> * <span class="id">Heq</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">Heq</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.Ss_of_nprods_hd">Ss_of_nprods_hd</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">d</span> <span class="id">n</span> <span class="id">m</span> (<span class="id">vss</span> : @<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)) <span class="id">n</span>) <span class="id">Inf1</span> <span class="id">Inf2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#hd">hd</a></span> <span class="id">d</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprods">Ss_of_nprods</a></span> <span class="id">vss</span> <span class="id">Inf1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift">lift</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd">nprod_hd</a></span> <span class="id">vss</span>) <span class="id">Inf2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_hd">lift_hd</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">unshelve</span> <span class="id">rewrite</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_lift">forall_nprod_lift</a></span> <span class="kwd">in</span> <span class="id">Inf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_lift">forall_nprod_lift</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_tl">forall_nprod_tl</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_tl">lift_tl</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.Ss_of_nprods_tl">Ss_of_nprods_tl</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">m</span> (<span class="id">vss</span> : @<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)) <span class="id">n</span>) <span class="id">Inf1</span> <span class="id">Inf2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#tl">tl</a></span> _) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprods">Ss_of_nprods</a></span> <span class="id">vss</span> <span class="id">Inf1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprods">Ss_of_nprods</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift">lift</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_tl">nprod_tl</a></span> <span class="id">vss</span>) <span class="id">Inf2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_hd">lift_hd</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">unshelve</span> <span class="id">rewrite</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_lift">forall_nprod_lift</a></span> <span class="kwd">in</span> <span class="id">Inf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_lift">forall_nprod_lift</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_tl">forall_nprod_tl</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprods_eq">_Ss_of_nprods_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_tl">lift_tl</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="id">Generalizable</span> <span class="id">All</span> <span class="kwd">Variables</span>.<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.Forall2t_lift_nprod">Forall2t_lift_nprod</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;`{ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _ ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>) <span class="id">P</span>)%<span class="id">signature</span> },<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">F</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">n</span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">Q</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>) -&gt; <span class="kwd">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">np</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">n</span>) <span class="id">Inf1</span> <span class="id">Inf2</span>, <span class="id">Q</span> (<span class="id">F</span> <span class="id">np</span>) -&gt; <span class="id">P</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">Inf1</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> (<span class="id">F</span> <span class="id">np</span>) <span class="id">Inf2</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">d</span> <span class="id">m</span> (<span class="id">vss</span> : @<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)) <span class="id">m</span>) <span class="id">n</span>) <span class="id">Inf1</span> <span class="id">Inf2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> <span class="id">Q</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_nprod">lift_nprod</a></span> <span class="id">F</span> <span class="id">vss</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t">Forall2t</a></span> <span class="id">d</span> <span class="id">P</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprods">Ss_of_nprods</a></span> <span class="id">vss</span> <span class="id">Inf1</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_nprod">lift_nprod</a></span> <span class="id">F</span> <span class="id">vss</span>) <span class="id">Inf2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> ?? * <span class="id">QP</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">m</span>; <span class="id">intros</span> * <span class="id">Hq</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span>; <span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv_eq">S_of_DSv_eq</a></span>) <span class="kwd">as</span> [<span class="id">Inf3</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#hd_lift_nprod">hd_lift_nprod</a></span>; <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprods_hd">Ss_of_nprods_hd</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_lift">forall_nprod_lift</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_impl">forall_nprod_impl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_hd">forall_nprod_hd</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_hd">forall_nprod_hd</a></span> <span class="kwd">in</span> <span class="id">Hq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#hd_lift_nprod">hd_lift_nprod</a></span> <span class="kwd">in</span> <span class="id">Hq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">QP</span> _ _ _ <span class="id">Hq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_eq">Ss_of_nprod_eq</a></span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_tl">nprod_tl</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_nprod">lift_nprod</a></span> <span class="id">F</span> <span class="id">vss</span>)))) <span class="kwd">as</span> [<span class="id">Inf3</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#tl_lift_nprod">tl_lift_nprod</a></span>; <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprods_tl">Ss_of_nprods_tl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_lift">forall_nprod_lift</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_impl">forall_nprod_impl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_tl">forall_nprod_tl</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHm</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#tl_lift_nprod">tl_lift_nprod</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_tl">forall_nprod_tl</a></span>.<br/>
Qed.</div></details>
<br/>
<div class="doc">comment passer de denot_expss à (map _ (concat denot_exp)) </div>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.Ss_expss">Ss_expss</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ins</span> <span class="id">envG</span> <span class="id">envI</span> <span class="id">env</span> (<span class="id">ess</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.enumtag">enumtag</a></span> * (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.exp">exp</a></span>))) <span class="id">n</span> <span class="id">Infe</span> <span class="id">Inf</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#list_sum">list_sum</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>)) = <span class="id">n</span>) <span class="id">ess</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp">denot_exp</a></span> <span class="id">G</span> <span class="id">ins</span> <span class="id">e</span> <span class="id">envG</span> <span class="id">envI</span> <span class="id">env</span>) (<span class="id">Infe</span> <span class="id">e</span>))) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">ess</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprods">Ss_of_nprods</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_expss">denot_expss</a></span> <span class="id">G</span> <span class="id">ins</span> <span class="id">ess</span> <span class="id">n</span> <span class="id">envG</span> <span class="id">envI</span> <span class="id">env</span>) <span class="id">Inf</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ess</span> <span class="kwd">as</span> [| (<span class="id">i</span>,<span class="id">es</span>) <span class="id">ess</span>]; <span class="id">intros</span> * <span class="id">Hl</span>. { <span class="id">constructor</span>. }<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Inf</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span> [ ?<span class="id">f1</span> (?<span class="id">f2</span> (?<span class="id">f3</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_expss">denot_expss</a></span> ?<span class="id">e1</span> ?<span class="id">e2</span> ?<span class="id">e3</span> ?<span class="id">e4</span>) ?<span class="id">e5</span>) ?<span class="id">e6</span>) ?<span class="id">e7</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">f1</span> (<span class="id">f2</span> (<span class="id">f3</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_expss">denot_expss</a></span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">e3</span> <span class="id">e4</span>) <span class="id">e5</span>) <span class="id">e6</span>) <span class="id">e7</span>) <span class="kwd">as</span> <span class="id">t</span> <span class="id">eqn</span>:<span class="id">Ht</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_expss_eq">denot_expss_eq</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">cases</span>; <span class="id">try</span> (<span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">congruence</span>).<br/>
&nbsp;&nbsp;<span class="id">subst</span>; <span class="id">intros</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">unshelve</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_exps">Ss_exps</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_cons_iff">forall_nprod_cons_iff</a></span> <span class="kwd">in</span> <span class="id">Inf</span> <span class="kwd">as</span> []. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd_cons">nprod_hd_cons</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;pour&nbsp;réécrire&nbsp;[nprod_tl_app_1]&nbsp;et&nbsp;utiliser&nbsp;IHess,&nbsp;il&nbsp;faut&nbsp;que&nbsp;le<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;membre&nbsp;droit&nbsp;du&nbsp;nprod_app&nbsp;soit&nbsp;de&nbsp;taille&nbsp;&gt;&nbsp;0.&nbsp;On&nbsp;doit&nbsp;donc&nbsp;détruire<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ess&nbsp;une&nbsp;fois&nbsp;de&nbsp;plus.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ess</span> <span class="kwd">as</span> [|(<span class="id">j</span>,<span class="id">es2</span>) <span class="id">ess</span>]. { <span class="id">now</span> <span class="id">constructor</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">IHess</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">reflexivity</span>.<br/>
Qed.</div></details>
<br/>
<h2> Correspondence of semantic predicate for streams functions </h2>
<br/>
<div class="doc">In the lext lemmas we use the method of coinduction loading from
    "Circular coinduction in Coq using bisimulation-up-to techniques" by
    Endrullis, Hendriks and Bodin.
    Their idea is to push computation/rewriting in the arguments of the
    coinductive predicate instead of performing it at top-level, which
    would breaks Coq guardedness condition. Thus, instead of proving
      forall xs ys, P xs ys
    we prove
      forall xs ys, forall xs' ys', xs ≡ xs' -&gt; ys ≡ ys' -&gt; P xs' ys'
 </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_const">ok_const</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">bs</span> <span class="id">Hinf</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst">sconst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.Vscalar">Vscalar</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.sem_cconst">sem_cconst</a></span> <span class="id">c</span>)) (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DS_of_S">DS_of_S</a></span> <span class="id">bs</span>)) <span class="id">Hinf</span> <span class="id">≡</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const">const</a></span> <span class="id">bs</span> <span class="id">c</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> _ <span class="id">Hinf</span>) <span class="kwd">as</span> <span class="id">xs</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const">const</a></span> <span class="id">bs</span> <span class="id">c</span>) <span class="kwd">as</span> <span class="id">ys</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span> * <span class="id">Eqx</span> ? <span class="id">Eqy</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">xs</span> <span class="kwd">as</span> [<span class="id">vx</span> <span class="id">xs</span>], <span class="id">ys</span> <span class="kwd">as</span> [<span class="id">vy</span> <span class="id">ys</span>], <span class="id">bs</span> <span class="kwd">as</span> [<span class="id">b</span> <span class="id">bs</span>].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqx</span> <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">tx</span> &amp; <span class="id">Hxs</span> &amp; <span class="id">Hxvx</span> &amp; <span class="id">itx</span> &amp; <span class="id">Eqx</span>).<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> <span class="kwd">in</span> <span class="id">Eqy</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_inv">DS_inv</a></span> <span class="kwd">in</span> <span class="id">Hxs</span> <span class="kwd">at</span> 2; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst">sconst</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">Cpo_streams_type.map_eq_cons</a></span> <span class="kwd">in</span> <span class="id">Hxs</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hxs</span> <span class="kwd">as</span> [? <span class="id">Heq</span>]; <span class="id">subst</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Eqy</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">cases</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ex_proj2">ex_proj2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_eq">S_of_DS_eq</a></span> _ _ _ _ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span> <span class="id">Heq</span>))) <span class="kwd">in</span> <span class="id">Eqx</span>; <span class="id">eauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_enum">ok_enum</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">bs</span> <span class="id">Hinf</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst">sconst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.Venum">Venum</a></span> <span class="id">c</span>) (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DS_of_S">DS_of_S</a></span> <span class="id">bs</span>)) <span class="id">Hinf</span> <span class="id">≡</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.enum">enum</a></span> <span class="id">bs</span> <span class="id">c</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> _ <span class="id">Hinf</span>) <span class="kwd">as</span> <span class="id">xs</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.enum">enum</a></span> <span class="id">bs</span> <span class="id">c</span>) <span class="kwd">as</span> <span class="id">ys</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span> * <span class="id">Eqx</span> ? <span class="id">Eqy</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">xs</span> <span class="kwd">as</span> [<span class="id">vx</span> <span class="id">xs</span>], <span class="id">ys</span> <span class="kwd">as</span> [<span class="id">vy</span> <span class="id">ys</span>], <span class="id">bs</span> <span class="kwd">as</span> [<span class="id">b</span> <span class="id">bs</span>].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqx</span> <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">tx</span> &amp; <span class="id">Hxs</span> &amp; <span class="id">Hxvx</span> &amp; <span class="id">itx</span> &amp; <span class="id">Eqx</span>).<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> <span class="kwd">in</span> <span class="id">Eqy</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_inv">DS_inv</a></span> <span class="kwd">in</span> <span class="id">Hxs</span> <span class="kwd">at</span> 2; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst">sconst</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">Cpo_streams_type.map_eq_cons</a></span> <span class="kwd">in</span> <span class="id">Hxs</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hxs</span> <span class="kwd">as</span> [? <span class="id">Heq</span>]; <span class="id">subst</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Eqy</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">cases</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ex_proj2">ex_proj2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_eq">S_of_DS_eq</a></span> _ _ _ _ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span> <span class="id">Heq</span>))) <span class="kwd">in</span> <span class="id">Eqx</span>; <span class="id">eauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_unop">ok_unop</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">op</span> <span class="id">ty</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sunop">sunop</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.sem_unop">sem_unop</a></span> <span class="id">op</span> <span class="id">v</span> <span class="id">ty</span>) <span class="id">xs</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">xsi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rsi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">rs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.lift1">lift1</a></span> <span class="id">op</span> <span class="id">ty</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">xs</span> <span class="id">xsi</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">rs</span> <span class="id">rsi</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">xs</span> <span class="id">xsi</span>) <span class="kwd">as</span> <span class="id">xs'</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">rs</span> <span class="id">rsi</span>) <span class="kwd">as</span> <span class="id">rs'</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span> * <span class="id">Sr</span> ? <span class="id">Eqx</span> ? <span class="id">Eqr</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">xs'</span> <span class="kwd">as</span> [<span class="id">vx</span> <span class="id">xs'</span>], <span class="id">rs'</span> <span class="kwd">as</span> [<span class="id">vr</span> <span class="id">rs'</span>].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqx</span> <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">tx</span> &amp; <span class="id">Hxs</span> &amp; <span class="id">Hxvx</span> &amp; <span class="id">itx</span> &amp; <span class="id">Eqx</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqr</span> <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">tr</span> &amp; <span class="id">Hrs</span> &amp; <span class="id">Hrvr</span> &amp; <span class="id">itr</span> &amp; <span class="id">Eqr</span>).<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hxs</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sunop_eq">sunop_eq</a></span> <span class="kwd">in</span> <span class="id">Hrs</span>, <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">simpl</span>; <span class="id">try</span> <span class="id">now</span> <span class="id">inv</span> <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hrs</span> <span class="kwd">as</span> [? <span class="id">Heq</span>]; <span class="id">subst</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">constructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_tl">DSForall_tl</a></span> <span class="kwd">in</span> <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ex_proj2">ex_proj2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_eq">S_of_DS_eq</a></span> _ _ _ _ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span> <span class="id">Heq</span>))) <span class="kwd">in</span> <span class="id">Eqr</span>; <span class="id">eauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_binop">ok_binop</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">op</span> <span class="id">ty1</span> <span class="id">ty2</span> (<span class="id">xs</span> <span class="id">ys</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop">sbinop</a></span> (<span class="kwd">fun</span> <span class="id">v1</span> <span class="id">v2</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.sem_binop">sem_binop</a></span> <span class="id">op</span> <span class="id">v1</span> <span class="id">ty1</span> <span class="id">v2</span> <span class="id">ty2</span>) <span class="id">xs</span> <span class="id">ys</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">xsi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ysi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rsi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">rs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.lift2">lift2</a></span> <span class="id">op</span> <span class="id">ty1</span> <span class="id">ty2</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">xs</span> <span class="id">xsi</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">ys</span> <span class="id">ysi</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">rs</span> <span class="id">rsi</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">xs</span> <span class="id">xsi</span>) <span class="kwd">as</span> <span class="id">xs'</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">ys</span> <span class="id">ysi</span>) <span class="kwd">as</span> <span class="id">ys'</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">rs</span> <span class="id">rsi</span>) <span class="kwd">as</span> <span class="id">rs'</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span> * <span class="id">Sr</span> ? <span class="id">Eqx</span> ? <span class="id">Eqy</span> ? <span class="id">Eqr</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">xs'</span> <span class="kwd">as</span> [<span class="id">vx</span> <span class="id">xs'</span>], <span class="id">ys'</span> <span class="kwd">as</span> [<span class="id">vy</span> <span class="id">ys'</span>], <span class="id">rs'</span> <span class="kwd">as</span> [<span class="id">vr</span> <span class="id">rs'</span>].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqx</span> <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">tx</span> &amp; <span class="id">Hxs</span> &amp; <span class="id">Hxvx</span> &amp; <span class="id">itx</span> &amp; <span class="id">Eqx</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqy</span> <span class="kwd">as</span> (<span class="id">y</span> &amp; <span class="id">ty</span> &amp; <span class="id">Hys</span> &amp; <span class="id">Hyvy</span> &amp; <span class="id">ity</span> &amp; <span class="id">Eqy</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqr</span> <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">tr</span> &amp; <span class="id">Hrs</span> &amp; <span class="id">Hrvr</span> &amp; <span class="id">itr</span> &amp; <span class="id">Eqr</span>).<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hxs</span>, <span class="id">Hys</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span> <span class="kwd">in</span> <span class="id">Hrs</span>, <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">simpl</span>; <span class="id">try</span> <span class="id">now</span> <span class="id">inv</span> <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hrs</span> <span class="kwd">as</span> [? <span class="id">Heq</span>]; <span class="id">subst</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">constructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_tl">DSForall_tl</a></span> <span class="kwd">in</span> <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ex_proj2">ex_proj2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_eq">S_of_DS_eq</a></span> _ _ _ _ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span> <span class="id">Heq</span>))) <span class="kwd">in</span> <span class="id">Eqr</span>; <span class="id">eauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_fby1">ok_fby1</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span> (<span class="id">xs</span> <span class="id">ys</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1">SDfuns.fby1</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>) <span class="id">xs</span> <span class="id">ys</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">xsi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ysi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rsi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">rs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.fby1">fby1</a></span> <span class="id">v</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">xs</span> <span class="id">xsi</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">ys</span> <span class="id">ysi</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">rs</span> <span class="id">rsi</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">xs</span> <span class="id">xsi</span>) <span class="kwd">as</span> <span class="id">xs'</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">ys</span> <span class="id">ysi</span>) <span class="kwd">as</span> <span class="id">ys'</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">rs</span> <span class="id">rsi</span>) <span class="kwd">as</span> <span class="id">rs'</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span> * <span class="id">Sr</span> ? <span class="id">Eqx</span> ? <span class="id">Eqy</span> ? <span class="id">Eqr</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">xs'</span> <span class="kwd">as</span> [<span class="id">vx</span> <span class="id">xs'</span>], <span class="id">ys'</span> <span class="kwd">as</span> [<span class="id">vy</span> <span class="id">ys'</span>], <span class="id">rs'</span> <span class="kwd">as</span> [<span class="id">vr</span> <span class="id">rs'</span>].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqx</span> <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">tx</span> &amp; <span class="id">Hxs</span> &amp; <span class="id">Hxvx</span> &amp; <span class="id">itx</span> &amp; <span class="id">Eqx</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqy</span> <span class="kwd">as</span> (<span class="id">y</span> &amp; <span class="id">ty</span> &amp; <span class="id">Hys</span> &amp; <span class="id">Hyvy</span> &amp; <span class="id">ity</span> &amp; <span class="id">Eqy</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqr</span> <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">tr</span> &amp; <span class="id">Hrs</span> &amp; <span class="id">Hrvr</span> &amp; <span class="id">itr</span> &amp; <span class="id">Eqr</span>).<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hxs</span>, <span class="id">Hys</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1_eq">fby1_eq</a></span> <span class="kwd">in</span> <span class="id">Hrs</span>, <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span>, <span class="id">y</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>; <span class="id">inversion_clear</span> <span class="id">Sr</span> <span class="kwd">as</span> [|??? <span class="id">Sr'</span>]; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hrs</span> <span class="kwd">as</span> [? <span class="id">Heq</span>]; <span class="id">subst</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP_eq">fby1AP_eq</a></span> <span class="kwd">in</span> <span class="id">Heq</span>, <span class="id">Sr'</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;pour&nbsp;les&nbsp;cas&nbsp;d'erreur,&nbsp;il&nbsp;faut&nbsp;un&nbsp;con&nbsp;de&nbsp;plus&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">try</span> (<span class="id">clear</span> - <span class="id">Sr'</span> <span class="id">itx</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">itx</span> <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Htx</span> &amp;?);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Htx</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">Cpo_streams_type.map_eq_cons</a></span> <span class="kwd">in</span> <span class="id">Sr'</span>; <span class="id">now</span> <span class="id">inv</span> <span class="id">Sr'</span>).<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ex_proj2">ex_proj2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_eq">S_of_DS_eq</a></span> _ _ _ _ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span> <span class="id">Heq</span>))) <span class="kwd">in</span> <span class="id">Eqr</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">constructor</span>; <span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">eauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_fby">ok_fby</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">xs</span> <span class="id">ys</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby">SDfuns.fby</a></span> <span class="id">xs</span> <span class="id">ys</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">xsi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ysi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rsi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">rs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.fby">fby</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">xs</span> <span class="id">xsi</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">ys</span> <span class="id">ysi</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">rs</span> <span class="id">rsi</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">xs</span> <span class="id">xsi</span>) <span class="kwd">as</span> <span class="id">xs'</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">ys</span> <span class="id">ysi</span>) <span class="kwd">as</span> <span class="id">ys'</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">rs</span> <span class="id">rsi</span>) <span class="kwd">as</span> <span class="id">rs'</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span> * <span class="id">Sr</span> ? <span class="id">Eqx</span> ? <span class="id">Eqy</span> ? <span class="id">Eqr</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">xs'</span> <span class="kwd">as</span> [<span class="id">vx</span> <span class="id">xs'</span>], <span class="id">ys'</span> <span class="kwd">as</span> [<span class="id">vy</span> <span class="id">ys'</span>], <span class="id">rs'</span> <span class="kwd">as</span> [<span class="id">vr</span> <span class="id">rs'</span>].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqx</span> <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">tx</span> &amp; <span class="id">Hxs</span> &amp; <span class="id">Hxvx</span> &amp; <span class="id">itx</span> &amp; <span class="id">Eqx</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqy</span> <span class="kwd">as</span> (<span class="id">y</span> &amp; <span class="id">ty</span> &amp; <span class="id">Hys</span> &amp; <span class="id">Hyvy</span> &amp; <span class="id">ity</span> &amp; <span class="id">Eqy</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqr</span> <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">tr</span> &amp; <span class="id">Hrs</span> &amp; <span class="id">Hrvr</span> &amp; <span class="id">itr</span> &amp; <span class="id">Eqr</span>).<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hxs</span>, <span class="id">Hys</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby_eq">fby_eq</a></span> <span class="kwd">in</span> <span class="id">Hrs</span>, <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span>, <span class="id">y</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>; <span class="id">inversion_clear</span> <span class="id">Sr</span> <span class="kwd">as</span> [|??? <span class="id">Sr'</span>]; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hrs</span> <span class="kwd">as</span> [? <span class="id">Heq</span>]; <span class="id">subst</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> ?<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbyA_eq">fbyA_eq</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP_eq">fby1AP_eq</a></span> <span class="kwd">in</span> <span class="id">Heq</span>, <span class="id">Sr'</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;pour&nbsp;les&nbsp;cas&nbsp;d'erreur,&nbsp;il&nbsp;faut&nbsp;un&nbsp;con&nbsp;de&nbsp;plus&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">try</span> (<span class="id">clear</span> - <span class="id">Sr'</span> <span class="id">itx</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">itx</span> <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Htx</span> &amp;?);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Htx</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">Cpo_streams_type.map_eq_cons</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1_eq">fby1_eq</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby_eq">fby_eq</a></span> <span class="kwd">in</span> <span class="id">Sr'</span>; <span class="id">now</span> <span class="id">inv</span> <span class="id">Sr'</span>).<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ex_proj2">ex_proj2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_eq">S_of_DS_eq</a></span> _ _ _ _ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span> <span class="id">Heq</span>))) <span class="kwd">in</span> <span class="id">Eqr</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">constructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">Eqr</span>, &lt;- <span class="id">Eqx</span>, &lt;- <span class="id">Eqy</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_fby1">ok_fby1</a></span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_when">ok_when</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> (<span class="id">xs</span> <span class="id">cs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.swhenv">swhenv</a></span> <span class="id">k</span> <span class="id">xs</span> <span class="id">cs</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">xsi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">csi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">cs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rsi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">rs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.when">when</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">xs</span> <span class="id">xsi</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">cs</span> <span class="id">csi</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">rs</span> <span class="id">rsi</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">xs</span> <span class="id">xsi</span>) <span class="kwd">as</span> <span class="id">xs'</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">cs</span> <span class="id">csi</span>) <span class="kwd">as</span> <span class="id">cs'</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">rs</span> <span class="id">rsi</span>) <span class="kwd">as</span> <span class="id">rs'</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span> * <span class="id">Sr</span> ? <span class="id">Eqx</span> ? <span class="id">Eqc</span> ? <span class="id">Eqr</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">xs'</span> <span class="kwd">as</span> [<span class="id">vx</span> <span class="id">xs'</span>], <span class="id">cs'</span> <span class="kwd">as</span> [<span class="id">vc</span> <span class="id">cs'</span>], <span class="id">rs'</span> <span class="kwd">as</span> [<span class="id">vr</span> <span class="id">rs'</span>].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqx</span> <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">tx</span> &amp; <span class="id">Hxs</span> &amp; <span class="id">Hxvx</span> &amp; <span class="id">itx</span> &amp; <span class="id">Eqx</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqc</span> <span class="kwd">as</span> (<span class="id">c</span> &amp; <span class="id">tc</span> &amp; <span class="id">Hcs</span> &amp; <span class="id">Hcvc</span> &amp; <span class="id">itc</span> &amp; <span class="id">Eqc</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqr</span> <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">tr</span> &amp; <span class="id">Hrs</span> &amp; <span class="id">Hrvr</span> &amp; <span class="id">itr</span> &amp; <span class="id">Eqr</span>).<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.swhenv">swhenv</a></span> <span class="kwd">in</span> *; <span class="id">rewrite</span> <span class="id">Hxs</span>, <span class="id">Hcs</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#swhen_eq">swhen_eq</a></span> <span class="kwd">in</span> <span class="id">Hrs</span>.<br/>
&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>; <span class="id">try</span> <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> _ = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">try</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hrs</span> <span class="kwd">as</span> [? <span class="id">Heq</span>]; <span class="id">subst</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id">Hxs</span>, <span class="id">Hcs</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#swhen_eq">swhen_eq</a></span> <span class="kwd">in</span> <span class="id">Sr</span>, <span class="id">rsi</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;error&nbsp;cases&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">try</span> (<span class="id">inv</span> <span class="id">Sr</span>; <span class="id">tauto</span>).<br/>
&nbsp;&nbsp;2: <span class="id">assert</span> (<span class="id">k</span> = <span class="id">e</span>) <span class="kwd">by</span> (<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;4: <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq">Nat.eqb_neq</a></span> <span class="kwd">in</span> <span class="id">HH2</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ex_proj2">ex_proj2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_eq">S_of_DS_eq</a></span> _ _ _ _ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span> <span class="id">Heq</span>))) <span class="kwd">in</span> <span class="id">Eqr</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">cases</span>; <span class="id">try</span> <span class="id">easy</span>; <span class="id">inv</span> <span class="id">Sr</span>; <span class="id">eauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_merge">ok_merge</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> (<span class="id">cs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)) (<span class="id">np</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.smergev">smergev</a></span> <span class="id">l</span> <span class="id">cs</span> <span class="id">np</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">npi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> _) <span class="id">np</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">csi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">cs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rsi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">rs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.merge">merge</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">cs</span> <span class="id">csi</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">npi</span>)) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">rs</span> <span class="id">rsi</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">cs</span> <span class="id">csi</span>) <span class="kwd">as</span> <span class="id">cs'</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">rs</span> <span class="id">rsi</span>) <span class="kwd">as</span> <span class="id">rs'</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_sts</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">npi</span>) <span class="kwd">as</span> <span class="id">np'</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>; <span class="id">intro</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span> * <span class="id">Sr</span> ? <span class="id">Eqc</span> ? <span class="id">Eqr</span> ? <span class="id">Eqnp</span>. <span class="comment">(*&nbsp;?&nbsp;Eqx.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">cs'</span> <span class="kwd">as</span> [<span class="id">vc</span> <span class="id">cs'</span>], <span class="id">rs'</span> <span class="kwd">as</span> [<span class="id">vr</span> <span class="id">rs'</span>].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqc</span> <span class="kwd">as</span> (<span class="id">c</span> &amp; <span class="id">tc</span> &amp; <span class="id">Hcs</span> &amp; <span class="id">Hcvc</span> &amp; <span class="id">itc</span> &amp; <span class="id">Eqc</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqr</span> <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">tr</span> &amp; <span class="id">Hrs</span> &amp; <span class="id">Hrvr</span> &amp; <span class="id">itr</span> &amp; <span class="id">Eqr</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;fait&nbsp;tout&nbsp;de&nbsp;suite&nbsp;le&nbsp;cas&nbsp;de&nbsp;récurrence&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.merge">merge</a></span> <span class="id">cs'</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; (<span class="id">i</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">es</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">np'</span>)) <span class="id">rs'</span>).<br/>
&nbsp;&nbsp;{ <span class="id">replace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span>  _ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">np'</span>)) <span class="kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> _) <span class="id">np'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#combine_map_snd">combine_map_snd</a></span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>; <span class="id">now</span> <span class="id">intros</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_impl">forall_nprod_impl</a></span> <span class="kwd">with</span> (<span class="id">Q</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span> <span class="id">npi</span> <span class="kwd">as</span> <span class="id">np'i</span>; [|<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_infinite">rem_infinite</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_lift">forall_nprod_lift</a></span> <span class="kwd">in</span> <span class="id">np'i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_rem">DSForall_rem</a></span> <span class="kwd">in</span> <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_eq_compat">rem_eq_compat</a></span> <span class="kwd">in</span> <span class="id">Hcs</span>, <span class="id">Hrs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.smergev">smergev</a></span> <span class="kwd">in</span> <span class="id">rs</span>; <span class="id">subst</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#rem_smerge">rem_smerge</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id">Cof</span> <span class="kwd">with</span> (<span class="id">cs</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">cs</span>) (<span class="id">np</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift">lift</a></span> _ _);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_infinite">rem_infinite</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Infty.html#smerge_inf">smerge_inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;- <span class="id">Eqc</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;- <span class="id">Eqr</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;- <span class="id">Eqnp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_map">Ss_map</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.tl_rem">tl_rem</a></span>; <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.smergev">smergev</a></span> <span class="kwd">in</span> <span class="id">Hrs</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> _) <span class="id">np</span>) <span class="kwd">as</span> <span class="id">npc</span>.<br/>
&nbsp;&nbsp;{ <span class="id">clear</span> - <span class="id">npi</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_impl">forall_nprod_impl</a></span> <span class="kwd">in</span> <span class="id">npi</span>; <span class="id">eauto</span>. <span class="id">now</span> <span class="id">inversion</span> 1. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span>, (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#smerge_cons">smerge_cons</a></span> _ _ _ _ _ _ _ <span class="id">npc</span>) <span class="kwd">in</span> <span class="id">Hrs</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hrs</span> <span class="kwd">as</span> [<span class="id">Hr</span> <span class="id">Heq</span>].<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">r</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;absent&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge_abs">fmerge_abs</a></span> <span class="kwd">in</span> <span class="id">Hr</span> <span class="kwd">as</span> [? <span class="id">Hf</span>]; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_combine''</span> <span class="kwd">in</span> <span class="id">Hf</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#hds_length">hds_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_combine'</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span> (<span class="kwd">fun</span> _ <span class="id">x</span> =&gt; <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">Streams.hd</a></span> _)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">Eqnp</span>, &lt;- (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_hds">Ss_of_nprod_hds</a></span> _ _ <span class="id">npc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">subst</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;present&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge_pres">fmerge_pres</a></span> <span class="kwd">in</span> <span class="id">Hr</span> <span class="kwd">as</span> ([] &amp;?&amp;? &amp; <span class="id">Hx</span> &amp; <span class="id">Hex</span> &amp; <span class="id">Hf</span>); <span class="id">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Hx</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Exists&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">Eqnp</span> <span class="id">Hex</span> <span class="id">npc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists_impl">Exists_impl</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists_map">Exists_map</a></span> (<span class="kwd">fun</span> '(<span class="id">t</span>,<span class="id">s</span>) =&gt; (<span class="id">t</span>, @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">Streams.hd</a></span> _ <span class="id">s</span>)) (<span class="kwd">fun</span> '(<span class="id">i</span>,<span class="id">es</span>) =&gt; <span class="id">i</span> = <span class="id">x</span> /\ <span class="id">es</span> = <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.present">present</a></span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> []; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span> <span class="kwd">with</span> (<span class="id">g</span> := <span class="kwd">fun</span> <span class="id">c</span> =&gt; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">c</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">Streams.hd</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">c</span>))), &lt;- <span class="id"><a href="Velus.Common.CommonList.html#combine_map_snd">combine_map_snd</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">intros</span> []; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_hds">Ss_of_nprod_hds</a></span> _ _ <span class="id">npc</span> <span class="id">npi</span>) <span class="kwd">as</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Eqnp</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#combine_map_snd">combine_map_snd</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists_map">Exists_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists_impl">Exists_impl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sval_of_sampl">sval_of_sampl</a></span>; <span class="id">now</span> <span class="id">intros</span> [] []; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Forall&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_combine''</span> <span class="kwd">in</span> <span class="id">Hf</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#hds_length">hds_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_combine'</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span> (<span class="kwd">fun</span> _ <span class="id">x</span> =&gt; _ -&gt; <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">Streams.hd</a></span> _)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">Eqnp</span>, &lt;- (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_hds">Ss_of_nprod_hds</a></span> _ _ <span class="id">npc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sval_of_sampl">sval_of_sampl</a></span>; <span class="id">cases</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">H4</span> <span class="id">H5</span>; <span class="id">firstorder</span> <span class="id">congruence</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_case">ok_case</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>, <span class="id">l</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">cs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)) (<span class="id">np</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.scasev">scasev</a></span> <span class="id">l</span> <span class="id">cs</span> <span class="id">np</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">npi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> _) <span class="id">np</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">csi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">cs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rsi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">rs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case">case</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">cs</span> <span class="id">csi</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">npi</span>)) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">rs</span> <span class="id">rsi</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">cs</span> <span class="id">csi</span>) <span class="kwd">as</span> <span class="id">cs'</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">rs</span> <span class="id">rsi</span>) <span class="kwd">as</span> <span class="id">rs'</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_sts</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">npi</span>) <span class="kwd">as</span> <span class="id">np'</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>; <span class="id">intros</span> <span class="id">l</span> <span class="id">Nnil</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span> * <span class="id">Sr</span> ? <span class="id">Eqc</span> ? <span class="id">Eqr</span> ? <span class="id">Eqnp</span>. <span class="comment">(*&nbsp;?&nbsp;Eqx.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">cs'</span> <span class="kwd">as</span> [<span class="id">vc</span> <span class="id">cs'</span>], <span class="id">rs'</span> <span class="kwd">as</span> [<span class="id">vr</span> <span class="id">rs'</span>].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqc</span> <span class="kwd">as</span> (<span class="id">c</span> &amp; <span class="id">tc</span> &amp; <span class="id">Hcs</span> &amp; <span class="id">Hcvc</span> &amp; <span class="id">itc</span> &amp; <span class="id">Eqc</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqr</span> <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">tr</span> &amp; <span class="id">Hrs</span> &amp; <span class="id">Hrvr</span> &amp; <span class="id">itr</span> &amp; <span class="id">Eqr</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;fait&nbsp;tout&nbsp;de&nbsp;suite&nbsp;le&nbsp;cas&nbsp;de&nbsp;récurrence&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case">case</a></span> <span class="id">cs'</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; (<span class="id">i</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">es</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">np'</span>)) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">rs'</span>).<br/>
&nbsp;&nbsp;{ <span class="id">replace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span>  _ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">np'</span>)) <span class="kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> _) <span class="id">np'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#combine_map_snd">combine_map_snd</a></span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>; <span class="id">now</span> <span class="id">intros</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_impl">forall_nprod_impl</a></span> <span class="kwd">with</span> (<span class="id">Q</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span> <span class="id">npi</span> <span class="kwd">as</span> <span class="id">np'i</span>; [|<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_infinite">rem_infinite</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_lift">forall_nprod_lift</a></span> <span class="kwd">in</span> <span class="id">np'i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_rem">DSForall_rem</a></span> <span class="kwd">in</span> <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_eq_compat">rem_eq_compat</a></span> <span class="kwd">in</span> <span class="id">Hcs</span>, <span class="id">Hrs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.scasev">scasev</a></span> <span class="kwd">in</span> <span class="id">rs</span>; <span class="id">subst</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#rem_scase">rem_scase</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id">Cof</span> <span class="kwd">with</span> (<span class="id">cs</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">cs</span>) (<span class="id">np</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift">lift</a></span> _ _);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_infinite">rem_infinite</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Infty.html#scase_inf">scase_inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;- <span class="id">Eqc</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;- <span class="id">Eqr</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;- <span class="id">Eqnp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_map">Ss_map</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.tl_rem">tl_rem</a></span>; <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.scasev">scasev</a></span> <span class="kwd">in</span> <span class="id">Hrs</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> _) <span class="id">np</span>) <span class="kwd">as</span> <span class="id">npc</span>.<br/>
&nbsp;&nbsp;{ <span class="id">clear</span> - <span class="id">npi</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_impl">forall_nprod_impl</a></span> <span class="kwd">in</span> <span class="id">npi</span>; <span class="id">eauto</span>. <span class="id">now</span> <span class="id">inversion</span> 1. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span>, (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_cons">scase_cons</a></span> _ _ _ _ _ _ _ <span class="id">npc</span>) <span class="kwd">in</span> <span class="id">Hrs</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hrs</span> <span class="kwd">as</span> [<span class="id">Hr</span> <span class="id">Heq</span>].<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">r</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;absent&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase_abs">fcase_abs</a></span> <span class="kwd">in</span> <span class="id">Hr</span> <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hf</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">clear</span> <span class="id">Cof</span> <span class="id">H</span>; <span class="id">destruct</span> <span class="id">l</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_combine''</span> <span class="kwd">in</span> <span class="id">Hf</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#hds_length">hds_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_combine'</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span> (<span class="kwd">fun</span> _ <span class="id">x</span> =&gt; <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">Streams.hd</a></span> _)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">Eqnp</span>, &lt;- (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_hds">Ss_of_nprod_hds</a></span> _ _ <span class="id">npc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">subst</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;present&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase_pres">fcase_pres</a></span> <span class="kwd">in</span> <span class="id">Hr</span> <span class="kwd">as</span> ([] &amp;?&amp;? &amp; <span class="id">Hx</span> &amp; <span class="id">Hex</span> &amp; <span class="id">Hf</span>); <span class="id">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Hx</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Forall&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_combine''</span>, <span class="id">Forall2_ignore1''</span> <span class="kwd">in</span> <span class="id">Hf</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#hds_length">hds_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_combine'</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_ignore1'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Eqnp</span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_length">Ss_of_nprod_length</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span> _ (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span> &lt;&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">Eqnp</span>, &lt;- (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_hds">Ss_of_nprod_hds</a></span> _ _ <span class="id">npc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sval_of_sampl">sval_of_sampl</a></span>; <span class="id">cases</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Exists&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">Eqnp</span> <span class="id">Hex</span> <span class="id">npc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists_impl">Exists_impl</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists_map">Exists_map</a></span> (<span class="kwd">fun</span> '(<span class="id">t</span>,<span class="id">s</span>) =&gt; (<span class="id">t</span>, @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">Streams.hd</a></span> _ <span class="id">s</span>)) (<span class="kwd">fun</span> '(<span class="id">i</span>,<span class="id">es</span>) =&gt; <span class="id">i</span> = <span class="id">x</span> /\ <span class="id">es</span> = <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.present">present</a></span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> []; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span> <span class="kwd">with</span> (<span class="id">g</span> := <span class="kwd">fun</span> <span class="id">c</span> =&gt; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">c</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">Streams.hd</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">c</span>))), &lt;- <span class="id"><a href="Velus.Common.CommonList.html#combine_map_snd">combine_map_snd</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">intros</span> []; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_hds">Ss_of_nprod_hds</a></span> _ _ <span class="id">npc</span> <span class="id">npi</span>) <span class="kwd">as</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Eqnp</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#combine_map_snd">combine_map_snd</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists_map">Exists_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists_impl">Exists_impl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sval_of_sampl">sval_of_sampl</a></span>; <span class="id">now</span> <span class="id">intros</span> [] []; <span class="id">subst</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_case_def">ok_case_def</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>, <span class="id">l</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">cs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)) (<span class="id">dnp</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.scase_defv">scase_defv</a></span> <span class="id">l</span> <span class="id">cs</span> <span class="id">dnp</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ds</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd">nprod_hd</a></span> <span class="id">dnp</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">np</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_tl">nprod_tl</a></span> <span class="id">dnp</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">npi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> _) <span class="id">np</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">csi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">cs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">dsi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">ds</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rsi</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">rs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case">case</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">cs</span> <span class="id">csi</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">npi</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">ds</span> <span class="id">dsi</span>)) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">rs</span> <span class="id">rsi</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">l</span> <span class="id">Nnil</span> <span class="id">cs</span> <span class="id">dnp</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;d'abord,&nbsp;mettons&nbsp;[rs]&nbsp;sous&nbsp;la&nbsp;forme&nbsp;[scase_def_&nbsp;l&nbsp;cs&nbsp;ds&nbsp;np]&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd_tl">nprod_hd_tl</a></span> <span class="id">dnp</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd_cons">nprod_hd_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">rs</span> <span class="id">ds'</span> <span class="id">np'</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">np'</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_tl">nprod_tl</a></span> <span class="id">dnp</span>) <span class="kwd">as</span> <span class="id">Hnp</span>.<br/>
&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">l</span>; <span class="id">try</span> <span class="id">congruence</span>; <span class="id">subst</span> <span class="id">np'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_tl_cons">nprod_tl_cons</a></span> <span class="kwd">with</span> (<span class="id">np</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_tl">nprod_tl</a></span> <span class="id">dnp</span>). }<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">Hnp</span>; <span class="id">clear</span> <span class="id">Hnp</span>; <span class="id">fold</span> <span class="id">ds'</span>.<br/>
&nbsp;&nbsp;<span class="id">generalize</span> <span class="id">np'</span> <span class="kwd">as</span> <span class="id">np</span>, <span class="id">ds'</span> <span class="kwd">as</span> <span class="id">ds</span>; <span class="id">clear</span> - <span class="id">Nnil</span>; <span class="id">intros</span> ???.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.scase_defv">scase_defv</a></span> <span class="kwd">in</span> <span class="id">rs</span>; <span class="id">revert</span> <span class="id">rs</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def_eq">scase_def_eq</a></span>; <span class="id">intro</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;c'est&nbsp;bon&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">cs</span> <span class="id">csi</span>) <span class="kwd">as</span> <span class="id">cs'</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">ds</span> <span class="id">dsi</span>) <span class="kwd">as</span> <span class="id">ds'</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">rs</span> <span class="id">rsi</span>) <span class="kwd">as</span> <span class="id">rs'</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_sts</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">npi</span>) <span class="kwd">as</span> <span class="id">np'</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>; <span class="id">intros</span> <span class="id">l</span> <span class="id">Nnil</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span> * <span class="id">Sr</span> ? <span class="id">Eqc</span> ? <span class="id">Eqd</span> ? <span class="id">Eqr</span> ? <span class="id">Eqnp</span>. <span class="comment">(*&nbsp;?&nbsp;Eqx.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">cs'</span> <span class="kwd">as</span> [<span class="id">vc</span> <span class="id">cs'</span>], <span class="id">ds'</span> <span class="kwd">as</span> [<span class="id">vd</span> <span class="id">ds'</span>], <span class="id">rs'</span> <span class="kwd">as</span> [<span class="id">vr</span> <span class="id">rs'</span>].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqc</span> <span class="kwd">as</span> (<span class="id">c</span> &amp; <span class="id">tc</span> &amp; <span class="id">Hcs</span> &amp; <span class="id">Hcvc</span> &amp; <span class="id">itc</span> &amp; <span class="id">Eqc</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqd</span> <span class="kwd">as</span> (<span class="id">d</span> &amp; <span class="id">td</span> &amp; <span class="id">Hds</span> &amp; <span class="id">Hdvd</span> &amp; <span class="id">itd</span> &amp; <span class="id">Eqd</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Eqr</span> <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">tr</span> &amp; <span class="id">Hrs</span> &amp; <span class="id">Hrvr</span> &amp; <span class="id">itr</span> &amp; <span class="id">Eqr</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;fait&nbsp;tout&nbsp;de&nbsp;suite&nbsp;le&nbsp;cas&nbsp;de&nbsp;récurrence&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case">case</a></span> <span class="id">cs'</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; (<span class="id">i</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">es</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">np'</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ds'</span>) <span class="id">rs'</span>).<br/>
&nbsp;&nbsp;{ <span class="id">replace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span>  _ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">np'</span>)) <span class="kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> _) <span class="id">np'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#combine_map_snd">combine_map_snd</a></span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>; <span class="id">now</span> <span class="id">intros</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_impl">forall_nprod_impl</a></span> <span class="kwd">with</span> (<span class="id">Q</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> _ <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span> <span class="id">npi</span> <span class="kwd">as</span> <span class="id">np'i</span>; [|<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_infinite">rem_infinite</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_lift">forall_nprod_lift</a></span> <span class="kwd">in</span> <span class="id">np'i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_rem">DSForall_rem</a></span> <span class="kwd">in</span> <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_eq_compat">rem_eq_compat</a></span> <span class="kwd">in</span> <span class="id">Hcs</span>, <span class="id">Hrs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#rem_scase_def_">rem_scase_def_</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id">Cof</span> <span class="kwd">with</span> (<span class="id">cs</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">cs</span>) (<span class="id">ds</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">ds</span>) (<span class="id">np</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift">lift</a></span> _ _);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_infinite">rem_infinite</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Infty.html#scase_def__inf">scase_def__inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;- <span class="id">Eqc</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;- <span class="id">Eqd</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;- <span class="id">Eqr</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;- <span class="id">Eqnp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_map">Ss_map</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.tl_rem">tl_rem</a></span>; <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> _) <span class="id">np</span>) <span class="kwd">as</span> <span class="id">npc</span>.<br/>
&nbsp;&nbsp;{ <span class="id">clear</span> - <span class="id">npi</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_impl">forall_nprod_impl</a></span> <span class="kwd">in</span> <span class="id">npi</span>; <span class="id">eauto</span>. <span class="id">now</span> <span class="id">inversion</span> 1. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id">Hds</span>, (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def__cons">scase_def__cons</a></span> _ _ _ _ _ _ _ _ _ <span class="id">npc</span>) <span class="kwd">in</span> <span class="id">Hrs</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hrs</span> <span class="kwd">as</span> [<span class="id">Hr</span> <span class="id">Heq</span>].<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">r</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;absent&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase_abs">fcase_abs</a></span> <span class="kwd">in</span> <span class="id">Hr</span> <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hf</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">clear</span> <span class="id">Cof</span> <span class="id">H</span>; <span class="id">destruct</span> <span class="id">l</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">Forall2_combine''</span> <span class="kwd">in</span> <span class="id">Hf</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#hds_length">hds_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_combine'</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span> (<span class="kwd">fun</span> _ <span class="id">x</span> =&gt; <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">Streams.hd</a></span> _)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">Eqnp</span>, &lt;- (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_hds">Ss_of_nprod_hds</a></span> _ _ <span class="id">npc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">subst</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">cases</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;present&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase_pres2">fcase_pres2</a></span> <span class="kwd">in</span> <span class="id">Hr</span> <span class="kwd">as</span> ([] &amp;?&amp;? &amp; <span class="id">Hx</span> &amp; <span class="id">HH</span> &amp; <span class="id">Hd</span> &amp; <span class="id">Hf</span> &amp; <span class="id">FE</span>); <span class="id">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">clear</span> <span class="id">Cof</span> <span class="id">H</span>; <span class="id">destruct</span> <span class="id">l</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;utile&nbsp;dans&nbsp;les&nbsp;deux&nbsp;cas&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">Streams.hd</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>) &lt;&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">np'</span>)) <span class="kwd">as</span> <span class="id">Hfh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id">Forall2_combine''</span>, <span class="id">Forall2_ignore1''</span> <span class="kwd">in</span> <span class="id">Hf</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#hds_length">hds_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_combine'</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_ignore1'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Eqnp</span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_length">Ss_of_nprod_length</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span> _ (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span> &lt;&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">Eqnp</span>, &lt;- (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_hds">Ss_of_nprod_hds</a></span> _ _ <span class="id">npc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sval_of_sampl">sval_of_sampl</a></span>; <span class="id">cases</span>; <span class="id">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">FE</span> <span class="kwd">as</span> [<span class="id">Hex</span> | [<span class="id">Hfn</span> <span class="id">Hd</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;la&nbsp;branche&nbsp;est&nbsp;trouvée&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.CaseP">CaseP</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">Eqnp</span> <span class="id">Hex</span> <span class="id">npc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists_impl">Exists_impl</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists_map">Exists_map</a></span> (<span class="kwd">fun</span> '(<span class="id">t</span>,<span class="id">s</span>) =&gt; (<span class="id">t</span>, @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">Streams.hd</a></span> _ <span class="id">s</span>)) (<span class="kwd">fun</span> '(<span class="id">i</span>,<span class="id">es</span>) =&gt; <span class="id">i</span> = <span class="id">x0</span> /\ <span class="id">es</span> = <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.present">present</a></span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> []; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span> <span class="kwd">with</span> (<span class="id">g</span> := <span class="kwd">fun</span> <span class="id">c</span> =&gt; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">c</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">Streams.hd</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">c</span>))), &lt;- <span class="id"><a href="Velus.Common.CommonList.html#combine_map_snd">combine_map_snd</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">intros</span> []; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_hds">Ss_of_nprod_hds</a></span> _ _ <span class="id">npc</span> <span class="id">npi</span>) <span class="kwd">as</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Eqnp</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#combine_map_snd">combine_map_snd</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists_map">Exists_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists_impl">Exists_impl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sval_of_sampl">sval_of_sampl</a></span>; <span class="id">now</span> <span class="id">intros</span> [] []; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;on&nbsp;utilise&nbsp;la&nbsp;branche&nbsp;par&nbsp;défaut&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.CasePDef">CasePDef</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_combine''</span> <span class="kwd">in</span> <span class="id">Hfn</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#hds_length">hds_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_swap_args">Forall2_swap_args</a></span>, <span class="id">Forall2_ignore1''</span> <span class="kwd">in</span> <span class="id">Hfn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_combine'</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Forall2_ignore2'</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Eqnp</span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_length">Ss_of_nprod_length</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="SDTOREL.BOOLS_OFS">BOOLS_OFS</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.disj_str_orb">disj_str_orb</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">bs</span> <span class="id">bss</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.disj_str">disj_str</a></span> [<span class="id">bs</span>; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.disj_str">disj_str</a></span> <span class="id">bss</span>] <span class="id">≡</span> <span class="id"><a href="Velus.Common.CommonStreams.html#map2">map2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#orb">orb</a></span> <span class="id">bs</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.disj_str">disj_str</a></span> <span class="id">bss</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="id">intro</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.disj_str_spec">disj_str_spec</a></span>, <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_map2">Str_nth_map2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#orb_false_r">Bool.orb_false_r</a></span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.bools_ofs_cons">bools_ofs_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">ss</span> <span class="id">b</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.bools_ofs">bools_ofs</a></span> <span class="id">ss</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.bools_of">bools_of</a></span> <span class="id">s</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.bools_ofs">bools_ofs</a></span> (<span class="id">s</span> :: <span class="id">ss</span>) (<span class="id"><a href="Velus.Common.CommonStreams.html#map2">map2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#orb">orb</a></span> <span class="id">b</span> <span class="id">bs</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.bools_ofs">bools_ofs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * (<span class="id">rss</span> &amp; <span class="id">Hf</span> &amp; <span class="id">Hbs</span>) <span class="id">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">b</span> :: <span class="id">rss</span>); <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.disj_str_cons">disj_str_cons</a></span>, <span class="id">Hbs</span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.disj_str_orb">disj_str_orb</a></span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.bools_of_sbool_of">bools_of_sbool_of</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">Inf1</span> <span class="id">Inf2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.ty_DS">ty_DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.bool_velus_type">bool_velus_type</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.bools_of">bools_of</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">s</span> <span class="id">Inf1</span>) (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.sbool_of">sbool_of</a></span> <span class="id">s</span>) <span class="id">Inf2</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.ty_DS">ty_DS</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.sbool_of">sbool_of</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">s</span> <span class="id">Inf1</span>) <span class="kwd">as</span> <span class="id">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> _ <span class="id">Inf2</span>) <span class="kwd">as</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert_all</span>; <span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">u</span> <span class="kwd">as</span> [<span class="id">u</span> <span class="id">us</span>], <span class="id">v</span> <span class="kwd">as</span> [<span class="id">v</span> <span class="id">vs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Hu</span> <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hs</span> &amp;?&amp;?&amp; <span class="id">Hus</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Hv</span> <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hbs</span> &amp;?&amp;?&amp; <span class="id">Hvs</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">Cpo_streams_type.map_eq_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hbs</span> <span class="kwd">as</span> [? <span class="id">Hm</span>]; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_eq">S_of_DS_eq</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> _ <span class="id">x4</span> _ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span> <span class="id">Hm</span>)) <span class="kwd">as</span> [<span class="id">Inf3</span> <span class="id">HH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HH</span> <span class="kwd">in</span> <span class="id">Hvs</span>; <span class="id">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases</span>; <span class="id">try</span> <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.wt_value">wt_value</a></span> _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">constructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.zip_map2_">zip_map2_</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span>} (<span class="id">op</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span>) <span class="id">s</span> <span class="id">t</span> <span class="id">Inf1</span> <span class="id">Inf2</span> <span class="id">Inf3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">op</span> <span class="id">s</span> <span class="id">t</span>) <span class="id">Inf3</span> <span class="id">≡</span> <span class="id"><a href="Velus.Common.CommonStreams.html#map2">map2</a></span> <span class="id">op</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">s</span> <span class="id">Inf1</span>) (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">t</span> <span class="id">Inf2</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">op</span> <span class="id">s</span> <span class="id">t</span>) <span class="id">Inf3</span>) <span class="kwd">as</span> <span class="id">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Common.CommonStreams.html#map2">map2</a></span> <span class="id">op</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">s</span> <span class="id">Inf1</span>) (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">t</span> <span class="id">Inf2</span>)) <span class="kwd">as</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert_all</span>; <span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">u</span> <span class="kwd">as</span> [<span class="id">u</span> <span class="id">us</span>], <span class="id">v</span> <span class="kwd">as</span> [<span class="id">v</span> <span class="id">vs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Hu</span> <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hz</span> &amp; ? &amp; <span class="id">Infz</span> &amp; <span class="id">Hus</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_uncons">zip_uncons</a></span> <span class="kwd">in</span> <span class="id">Hz</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp;?&amp; <span class="id">Hs</span> &amp; <span class="id">Ht</span> &amp; <span class="id">Hz</span> &amp;?); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_eq">S_of_DS_eq</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> _ <span class="id">Inf1</span> _ <span class="id">Hs</span>) <span class="kwd">as</span> [<span class="id">Inf4</span> <span class="id">HHs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_eq">S_of_DS_eq</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> _ <span class="id">Inf2</span> _ <span class="id">Ht</span>) <span class="kwd">as</span> [<span class="id">Inf5</span> <span class="id">HHt</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HHs</span>, <span class="id">HHt</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_cons">S_of_DS_cons</a></span> <span class="kwd">in</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_eq">S_of_DS_eq</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> _ <span class="id">Infz</span> _ <span class="id">Hz</span>) <span class="kwd">as</span> [<span class="id">Inf6</span> <span class="id">HHz</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HHz</span> <span class="kwd">in</span> <span class="id">Hus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hv</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.zip_map2">zip_map2</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span>} (<span class="id">op</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span>) <span class="id">s</span> <span class="id">t</span> <span class="id">Inf3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">Inf1</span> <span class="id">Inf2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">op</span> <span class="id">s</span> <span class="id">t</span>) <span class="id">Inf3</span> <span class="id">≡</span> <span class="id"><a href="Velus.Common.CommonStreams.html#map2">map2</a></span> <span class="id">op</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">s</span> <span class="id">Inf1</span>) (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">t</span> <span class="id">Inf2</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#inf_zip">inf_zip</a></span> <span class="kwd">in</span> <span class="id">Inf3</span> <span class="kwd">as</span> <span class="id">HH</span>; <span class="id">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> [<span class="id">Infs</span> <span class="id">Inft</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">Infs</span>, <span class="id">Inft</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.zip_map2_">zip_map2_</a></span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.bools_ofs_sbools_of">bools_ofs_sbools_of</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">np</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">n</span>) <span class="id">Inf1</span> <span class="id">Inf2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.ty_DS">ty_DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.bool_velus_type">bool_velus_type</a></span>) <span class="id">np</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.bools_ofs">bools_ofs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">Inf1</span>) (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.sbools_of">sbools_of</a></span> <span class="id">np</span>) <span class="id">Inf2</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_eq">S_of_DS_eq</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> _ <span class="id">Inf2</span>) <span class="kwd">as</span> [<span class="id">Inf3</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.sbools_of">sbools_of</a></span>. <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>. <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_eq">S_of_DS_eq</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> _ <span class="id">Inf3</span>) <span class="kwd">as</span> [<span class="id">Inf4</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">simpl</span>; <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>; <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#const_DS_const">const_DS_const</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.bools_ofs_empty">bools_ofs_empty</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_eq">S_of_DS_eq</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> _ <span class="id">Inf3</span>) <span class="kwd">as</span> [<span class="id">Inf4</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Fold_eq">Fold_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_tl">lift_tl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_hd">lift_hd</a></span>. <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_inv">forall_nprod_inv</a></span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> [], <span class="id">Inf1</span> <span class="kwd">as</span> <span class="id">HH</span>; <span class="id">destruct</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.zip_map2">zip_map2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#orb">orb</a></span> _ _ <span class="id">Inf4</span>) <span class="kwd">as</span> (<span class="id">Inf5</span> &amp; <span class="id">Inf6</span> &amp; -&gt;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.bools_ofs_cons">bools_ofs_cons</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.bools_of_sbool_of">bools_of_sbool_of</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.sbools_ofs_inf">sbools_ofs_inf</a></span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.BOOLS_OFS">BOOLS_OFS</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="SDTOREL.OLD_MASK">OLD_MASK</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html">Streams</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">CoFixpoint</span> <span class="id"><a name="SDTOREL.mask">mask</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">absent</span>: <span class="id">A</span>) (<span class="id">k</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">rs</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">xs</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mask'</span> <span class="id">k'</span> := <span class="id">mask</span> <span class="id">absent</span> <span class="id">k'</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">rs</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">xs</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">k</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">rs</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>    =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id">absent</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>   =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">xs</span>  <span class="id">⋅</span> <span class="id">mask'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>    =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">xs</span>  <span class="id">⋅</span> <span class="id">mask'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k'</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> =&gt; <span class="id">absent</span> <span class="id">⋅</span> <span class="id">mask'</span> <span class="id">k'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> _, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> =&gt; <span class="id">absent</span> <span class="id">⋅</span> <span class="id">mask'</span> <span class="id">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="SDTOREL.maskv">maskv</a></span> := @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.mask">mask</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">mask'_abs</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">absent</span> : <span class="id">A</span>) <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> &lt; <span class="id">k</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mask'</span> <span class="id">absent</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span> <span class="id">≡</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">const</a></span> <span class="id">absent</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">rs</span> <span class="kwd">as</span> [[]], <span class="id">xs</span>; <span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span> <span class="kwd">in</span> <span class="id">HH</span>; <span class="id">subst</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.mask_retro_compat">mask_retro_compat</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.maskv">maskv</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span> <span class="id">≡</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.maskv">Str.maskv</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.maskv">maskv</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.maskv">Str.maskv</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.mask">Str.mask</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> |- _ <span class="id">≡</span> ?<span class="id">aa</span> =&gt; <span class="id">remember_st</span> <span class="id">aa</span> <span class="kwd">as</span> <span class="id">v</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert_all</span>; <span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.mask">mask</a></span> _ _ _ _)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> (<span class="id">mask'</span> _ _ _ _ _)) <span class="kwd">in</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">rs</span> <span class="kwd">as</span> [<span class="id">r</span> <span class="id">rs</span>], <span class="id">xs</span> <span class="kwd">as</span> [<span class="id">x</span> <span class="id">xs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;true&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">Hv</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Cof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mask'_S</span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> &lt;- <span class="id">HH1</span>, &lt;- <span class="id">Hv</span>, <span class="id">mask'_abs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">Hv</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Cof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mask'_S</span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;false&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hv</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">k</span> <span class="kwd">as</span> [|[]]; <span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.mask_nth">mask_nth</a></span> {<span class="id">A</span>} (<span class="id">absent</span>: <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.mask">mask</a></span> <span class="id">absent</span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>) # <span class="id">n</span> = <span class="kwd">if</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.count">count</a></span> <span class="id">rs</span>) # <span class="id">n</span>  =? <span class="id">k</span> <span class="kwd">then</span> <span class="id">xs</span> # <span class="id">n</span> <span class="kwd">else</span> <span class="id">absent</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth">Str_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>, <span class="id">k</span> <span class="kwd">as</span> [|[|<span class="id">k</span>]]; <span class="id">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">rs</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.count_acc_grow">count_acc_grow</a></span> 1 <span class="id">rs</span>) <span class="kwd">as</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#ForAll_Str_nth_tl">ForAll_Str_nth_tl</a></span> <span class="id">n</span>) <span class="kwd">in</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_tl">Str_nth_tl</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.count_acc">count_acc</a></span> 1 <span class="id">rs</span>)) &lt;&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>) <span class="kwd">as</span> <span class="id">E</span> <span class="kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq">Nat.eqb_neq</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="id">rewrite</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.const_nth">const_nth</a></span> <span class="id">n</span> <span class="id">absent</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id">IHn</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.count">count</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_tl">Str_nth_tl</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.count_acc">count_acc</a></span> 1 <span class="id">rs</span>)) =? 1) <span class="id">eqn</span>: <span class="id">E</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.count_S_nth">count_S_nth</a></span> <span class="kwd">in</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Peano.html#eq_add_S">eq_add_S</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span> <span class="kwd">in</span> <span class="id">E</span> <span class="kwd">as</span> -&gt;; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq">Nat.eqb_neq</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.succ_inj_wd_neg">Nat.succ_inj_wd_neg</a></span>, &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq">Nat.eqb_neq</a></span> <span class="kwd">in</span> <span class="id">E</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">E</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id">IHn</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.count">count</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_tl">Str_nth_tl</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.count_acc">count_acc</a></span> 1 <span class="id">rs</span>)) =? <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>)) <span class="id">eqn</span>: <span class="id">E</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.count_S_nth">count_S_nth</a></span> <span class="kwd">in</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Peano.html#eq_add_S">eq_add_S</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="id">rewrite</span> <span class="id">E</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq">Nat.eqb_neq</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.succ_inj_wd_neg">Nat.succ_inj_wd_neg</a></span>, &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq">Nat.eqb_neq</a></span> <span class="kwd">in</span> <span class="id">E</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">E</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> {<span class="id">A</span>} (<span class="id">absent</span>: <span class="id">A</span>) <span class="id">k</span> : (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.mask">mask</a></span> <span class="id">absent</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _ ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _ ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">mask_morph</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">rs</span> <span class="id">rs'</span> <span class="id">Ers</span> <span class="id">xs</span> <span class="id">xs'</span> <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="id">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.mask_nth">mask_nth</a></span>, <span class="id">Exs</span>, <span class="id">Ers</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">k</span> : (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.maskv">maskv</a></span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _ ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _ ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">maskv_morph</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">rs</span> <span class="id">rs'</span> <span class="id">Ers</span> <span class="id">xs</span> <span class="id">xs'</span> <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.mask_morph">mask_morph</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.Sapp_retro_compat">Sapp_retro_compat</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">H</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.history">history</a></span>) (<span class="id">b</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">f</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id">es</span> <span class="id">er</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.exp">exp</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">lann</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.ann">ann</a></span>) (<span class="id">ss</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>))) (<span class="id">os</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rs</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>))) (<span class="id">bs</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span>) <span class="id">es</span> <span class="id">ss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span>) <span class="id">er</span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.bools_ofs">bools_ofs</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">rs</span>) <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node">sem_node</a></span> <span class="id">G</span> <span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.maskv">maskv</a></span> <span class="id">k</span> <span class="id">bs</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">ss</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.maskv">maskv</a></span> <span class="id">k</span> <span class="id">bs</span>) <span class="id">os</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Eapp">Eapp</a></span> <span class="id">f</span> <span class="id">es</span> <span class="id">er</span> <span class="id">lann</span>) <span class="id">os</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * ??? <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node_morph">sem_node_morph</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.mask_retro_compat">mask_retro_compat</a></span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.OLD_MASK">OLD_MASK</a></span>.<br/>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.smask_maskv">smask_maskv</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">R</span> <span class="id">U</span> <span class="id">Ri</span> <span class="id">Ui</span> <span class="id">Mi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">R</span> <span class="id">U</span>) <span class="id">Mi</span> <span class="id">≡</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.maskv">maskv</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">R</span> <span class="id">Ri</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">U</span> <span class="id">Ui</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">R</span> <span class="id">U</span>) <span class="id">Mi</span>) <span class="kwd">as</span> <span class="id">sl</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.maskv">maskv</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">R</span> <span class="id">Ri</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">U</span> <span class="id">Ui</span>)) <span class="kwd">as</span> <span class="id">sr</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>; <span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_ds</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask">smask</a></span> <span class="id">k</span> <span class="id">R</span> <span class="id">U</span>) <span class="kwd">as</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Ri</span> <span class="kwd">as</span> <span class="id">HH</span>; <span class="id">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">R'</span> &amp; <span class="id">Hr</span> &amp; <span class="id">ri'</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_eq">smask_eq</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Ui</span> <span class="kwd">as</span> <span class="id">HH</span>; <span class="id">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> (<span class="id">vx</span> &amp; <span class="id">s'</span> &amp; <span class="id">Hs'</span> &amp; <span class="id">si'</span>).<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_eq">S_of_DS_eq</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> _ <span class="id">Ri</span> _ <span class="id">Hr</span>) <span class="kwd">as</span> [<span class="id">Inf3</span> <span class="id">HH</span>]; <span class="id">rewrite</span> <span class="id">HH</span> <span class="kwd">in</span> <span class="id">Hsr</span>; <span class="id">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv_eq">S_of_DSv_eq</a></span> _ <span class="id">Ui</span> _ <span class="id">Hs'</span>) <span class="kwd">as</span> [<span class="id">Inf4</span> <span class="id">HH</span>]; <span class="id">rewrite</span> <span class="id">HH</span> <span class="kwd">in</span> <span class="id">Hsr</span>; <span class="id">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">cases</span>.<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;DS_const&nbsp;abs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">Hsl</span>, &lt;- <span class="id">Hsr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv_eq">S_of_DSv_eq</a></span> _ <span class="id">Mi</span> _ <span class="id">Ht</span>) <span class="kwd">as</span> [<span class="id">Inf2</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span>; <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_cons">S_of_DS_cons</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#const_DS_const">const_DS_const</a></span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> &lt;- ?<span class="id">Hs</span>, ?<span class="id">Hs'</span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP_simpl">APP_simpl</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv_eq">S_of_DSv_eq</a></span> _ <span class="id">Mi</span> _ <span class="id">Ht</span>) <span class="kwd">as</span> [<span class="id">Inf2</span> <span class="id">HH</span>]; <span class="id">rewrite</span> <span class="id">HH</span> <span class="kwd">in</span> <span class="id">Hsl</span>; <span class="id">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="kwd">in</span> *; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_cons">S_of_DS_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">constructor</span>; [<span class="id">rewrite</span> &lt;- <span class="id">Hsl</span>, &lt;- <span class="id">Hsr</span>; <span class="id">auto</span> |]. <span class="comment">(*&nbsp;hd&nbsp;ok,&nbsp;reste&nbsp;tl&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">rewrite</span> &lt;- ?<span class="id">Hsl</span>, &lt;- ?<span class="id">Hsr</span>; <span class="id">simpl</span>; [<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>|].<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.maskv_morph">maskv_morph</a></span>; <span class="id">try</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#cons_infinite">cons_infinite</a></span>; <span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Ht</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.map_mask_">map_mask_</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">rs</span> <span class="id">Infr</span> <span class="id">l</span> (<span class="id">ss</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)) <span class="id">InfI</span> <span class="id">InfM</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.maskv">maskv</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">rs</span> <span class="id">Infr</span>)) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">ss</span> <span class="id">InfI</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> <span class="id">l</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.env_of_np">env_of_np</a></span> <span class="id">l</span> <span class="id">ss</span>))) <span class="id">InfM</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hl</span> <span class="id">Nd</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_map">Ss_map</a></span>.<br/>
&nbsp;&nbsp;2: <span class="id">intros</span>; <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.smask_maskv">smask_maskv</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">l</span> <span class="kwd">as</span> [|<span class="id">x</span> <span class="id">l</span>]; <span class="id">try</span> (<span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_eq">nprod_eq</a></span>; <span class="id">intros</span> <span class="id">n</span> <span class="id">d</span> <span class="id">Hn</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nth_lift">nth_lift</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.nth_np_of_env">nth_np_of_env</a></span> <span class="id">x</span> <span class="id">d</span> (<span class="id">x</span> :: <span class="id">l</span>)); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_proj_eq">smask_env_proj_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.env_of_np_nth">env_of_np_nth</a></span>; <span class="id">eauto</span> 2 <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#mem_nth_nth">mem_nth_nth</a></span>.<br/>
&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_lift">forall_nprod_lift</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_impl">forall_nprod_impl</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_inf">smask_inf</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="SDTOREL.map_mask">map_mask</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">rs</span> <span class="id">Infr</span> <span class="id">l</span> (<span class="id">ss</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)) <span class="id">InfI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">InfM</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.maskv">maskv</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">rs</span> <span class="id">Infr</span>)) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">ss</span> <span class="id">InfI</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> <span class="id">l</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env">smask_env</a></span> <span class="id">k</span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.env_of_np">env_of_np</a></span> <span class="id">l</span> <span class="id">ss</span>))) <span class="id">InfM</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unshelve</span> (<span class="id">esplit</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.map_mask_">map_mask_</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FIXME&nbsp;:&nbsp;forall_np_of_env&nbsp;est&nbsp;trop&nbsp;faible&nbsp;en&nbsp;général&nbsp;??&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">forall_np_of_env'</span>; <span class="id">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_proj_eq">smask_env_proj_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_inf">smask_inf</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.inf_dom_env_of_np">inf_dom_env_of_np</a></span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<div class="doc">Correspondance clocks_of/bss </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ac_AC">ac_AC</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">Inf</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.abstract_clock">abstract_clock</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">s</span> <span class="id">Inf</span>) <span class="id">≡</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">s</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_inf">map_inf</a></span> _ _ _ _ <span class="id">Inf</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- ?<span class="id">tt</span> <span class="id">≡</span> ?<span class="id">uu</span> =&gt; <span class="id">remember_st</span> <span class="id">tt</span> <span class="kwd">as</span> <span class="id">t</span>; <span class="id">remember_st</span> <span class="id">uu</span> <span class="kwd">as</span> <span class="id">u</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span> <span class="id">s</span> <span class="id">Inf</span> <span class="id">t</span> <span class="id">Ht</span> <span class="id">u</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">t</span>, <span class="id">u</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Inf</span> <span class="kwd">as</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">s'</span> &amp; <span class="id">Hs</span> &amp; <span class="id">Inf2</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv_eq">S_of_DSv_eq</a></span> _ <span class="id">Inf</span> _ <span class="id">Hs</span>) <span class="kwd">as</span> [<span class="id">Inf3</span> <span class="id">HH</span>].<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HH</span> <span class="kwd">in</span> <span class="id">Ht</span>; <span class="id">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_cons">S_of_DS_cons</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_eq">S_of_DS_eq</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">s</span>)) <span class="kwd">as</span> [<span class="id">Inf4</span> <span class="id">HH</span>]. { <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hs</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HH</span> <span class="kwd">in</span> <span class="id">Hu</span>; <span class="id">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">cases</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_cons">S_of_DS_cons</a></span> <span class="kwd">in</span> <span class="id">Hu</span>; <span class="id">inv</span> <span class="id">Hu</span>; <span class="id">inv</span> <span class="id">Ht</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">eauto</span>; <span class="id">rewrite</span> &lt;- <span class="id">H0</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.zip_zipWith">zip_zipWith</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Infx</span> <span class="id">Infy</span> <span class="id">Infr</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#zipWith">zipWith</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">x</span> <span class="id">Infx</span>) (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">y</span> <span class="id">Infy</span>) <span class="id">≡</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>) <span class="id">Infr</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">x</span> <span class="id">Infx</span>) <span class="kwd">as</span> <span class="id">xs</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">y</span> <span class="id">Infy</span>) <span class="kwd">as</span> <span class="id">ys</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> _ <span class="id">Infr</span>) <span class="kwd">as</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>; <span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">xs</span> <span class="kwd">as</span> [<span class="id">vx</span> <span class="id">xs</span>], <span class="id">ys</span> <span class="kwd">as</span> [<span class="id">vy</span> <span class="id">ys</span>], <span class="id">rs</span> <span class="kwd">as</span> [<span class="id">vr</span> <span class="id">rs</span>].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Hxs</span> <span class="kwd">as</span> (<span class="id">vx'</span> &amp; <span class="id">xs'</span> &amp; <span class="id">Hx</span> &amp; <span class="id">Hvx</span> &amp; <span class="id">Infx'</span> &amp; <span class="id">Hxs</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Hys</span> <span class="kwd">as</span> (<span class="id">vy'</span> &amp; <span class="id">ys'</span> &amp; <span class="id">Hy</span> &amp; <span class="id">Hvy</span> &amp; <span class="id">Infy'</span> &amp; <span class="id">Hys</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Hrs</span> <span class="kwd">as</span> (<span class="id">vr'</span> &amp; <span class="id">rs'</span> &amp; <span class="id">Hr</span> &amp; <span class="id">Hvr</span> &amp; <span class="id">Infr'</span> &amp; <span class="id">Hrs</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>, <span class="id">Hy</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span> <span class="kwd">in</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hr</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id">subst</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">unshelve</span> <span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite_morph">infinite_morph</a></span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">Hrs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL._clocks_of_bss">_clocks_of_bss</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">l</span> <span class="id">Inf</span> <span class="id">Infb</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.clocks_of">clocks_of</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> <span class="id">l</span> <span class="id">env</span>) <span class="id">Inf</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">≡</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">l</span> <span class="id">env</span>) <span class="id">Infb</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="kwd">as</span> [| <span class="id">x</span> [| <span class="id">y</span> <span class="id">l</span>]]; <span class="id">intros</span> * <span class="id">ND</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.clocks_of_nil">clocks_of_nil</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#const_DS_const">const_DS_const</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.clocks_of_ac">clocks_of_ac</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ac_AC">ac_AC</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">ND</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.clocks_of_cons">clocks_of_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">IHl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ac_AC">ac_AC</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.zip_zipWith">zip_zipWith</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss_cons">bss_cons</a></span> <span class="kwd">in</span> <span class="id">Infb</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#inf_zip">inf_zip</a></span> <span class="kwd">in</span> <span class="id">Infb</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.bss_env_inf">bss_env_inf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> _) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> <span class="id">l</span> <span class="id">env</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">l</span> <span class="id">env</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span>; <span class="id">intros</span> * <span class="id">Hinf</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_inf">DS_const_inf</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss_cons">bss_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_inv">forall_nprod_inv</a></span> <span class="kwd">in</span> <span class="id">Hinf</span> <span class="kwd">as</span> [<span class="id">Infh</span> <span class="id">Inft</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd_cons">nprod_hd_cons</a></span> <span class="kwd">in</span> <span class="id">Infh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_inf">zip_inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_inf">map_inf</a></span>, <span class="id">Infh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;ça&nbsp;fait&nbsp;quand&nbsp;même&nbsp;chier&nbsp;de&nbsp;devoir&nbsp;détruire&nbsp;l&nbsp;ici&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHl</span>; <span class="id">destruct</span> <span class="id">l</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="SDTOREL.clocks_of_bss">clocks_of_bss</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">l</span> <span class="id">Inf</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">Infb</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.clocks_of">clocks_of</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> <span class="id">l</span> <span class="id">env</span>) <span class="id">Inf</span>) <span class="id">≡</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">l</span> <span class="id">env</span>) <span class="id">Infb</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">Infb</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.bss_env_inf">bss_env_inf</a></span> _ _ <span class="id">Inf</span>).<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">Infb</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._clocks_of_bss">_clocks_of_bss</a></span> _ _ _ <span class="id">Infb</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="SDTOREL.Inf_Dom">Inf_Dom</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="SDTOREL.inf_dom">inf_dom</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar">IsVar</a></span> <span class="id">Γ</span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_var">denot_var</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">x</span>).<br/>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">Γ</span> <span class="id">ins</span> : (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.inf_dom">inf_dom</a></span> <span class="id">Γ</span> <span class="id">ins</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.SI">SI</a></span>) ==&gt; @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.SI">SI</a></span>) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">inf_dom_morph</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.inf_dom">inf_dom</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> ?? <span class="id">Eq1</span> ?? <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;<span class="id">tauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> : (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.inf_dom">inf_dom</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.SI">SI</a></span>) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">inf_dom_morph2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intros</span> <span class="id">Hinf</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.inf_dom_morph">inf_dom_morph</a></span> <span class="kwd">in</span> <span class="id">Hinf</span>; <span class="id">eauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.infinite_dom_app_l">infinite_dom_app_l</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">env</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.SI">SI</a></span>) <span class="id">l1</span> <span class="id">l2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">env</span> (<span class="id">l1</span> ++ <span class="id">l2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">env</span> <span class="id">l1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">H</span> ??; <span class="id">apply</span> <span class="id">H</span>; <span class="id">tauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.infinite_dom_np">infinite_dom_np</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> _) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> <span class="id">l</span> <span class="id">env</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">env</span> <span class="id">l</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span>; <span class="id">intros</span> <span class="id">Hf</span> <span class="id">x</span> <span class="id">Hin</span>; <span class="id">inv</span> <span class="id">Hin</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_inv">forall_nprod_inv</a></span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> [<span class="id">Inf1</span> <span class="id">Inf2</span>]; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd_cons">nprod_hd_cons</a></span> <span class="kwd">in</span> <span class="id">Inf1</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">IHl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">l</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.inf_dom_decomp">inf_dom_decomp</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">envI</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">envI</span> <span class="id">ins</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">env</span> <span class="id">outs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">Γ</span> = <span class="id">ins</span> ++ <span class="id">outs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.inf_dom">inf_dom</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.inf_dom">inf_dom</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_var">denot_var</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hi</span> <span class="id">Ho</span> <span class="id">Heq</span> <span class="id">x</span> <span class="id">Isv</span>%<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar_In">IsVar_In</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Heq</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">Isv</span>.<br/>
&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">Hmem</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#mem_ident_spec">mem_ident_spec</a></span> <span class="kwd">in</span> <span class="id">Hmem</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#mem_ident_false">mem_ident_false</a></span> <span class="kwd">in</span> <span class="id">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Isv</span>; [ <span class="id">contradiction</span> | <span class="id">auto</span> ].<br/>
Qed.</div></details>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Inf_Dom">Inf_Dom</a></span>.<br/>
<br/>
<br/>
<h2> Fonctions pour passer d'un <span class="bracket"><span class="id">DS_prod</span> <span class="id">SI</span></span> à un Str.history </h2>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.IsVar_dec">IsVar_dec</a></span> : <span class="kwd">forall</span> <span class="id">Γ</span> <span class="id">x</span>, { <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar">IsVar</a></span> <span class="id">Γ</span> <span class="id">x</span> } + { ~ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar">IsVar</a></span> <span class="id">Γ</span> <span class="id">x</span> }.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.ListDec.html#In_dec">ListDec.In_dec</a></span> <span class="id"><a href="Velus.Common.Common.html#ident_eq_dec">ident_eq_dec</a></span> <span class="id">x</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">Γ</span>)) <span class="kwd">as</span> [|<span class="id">HH</span>].<br/>
&nbsp;&nbsp;- <span class="id">left</span>; <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar_fst">IsVar_fst</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">right</span>; <span class="id">contradict</span> <span class="id">HH</span>; <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar_fst">IsVar_fst</a></span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="SDTOREL.hist_of_envs">hist_of_envs</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> (<span class="id">InfΓ</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.inf_dom">inf_dom</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span>) : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.history">history</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">lx</span> =&gt; <span class="kwd">match</span> <span class="id">lx</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.IsVar_dec">IsVar_dec</a></span> <span class="id">Γ</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#left">left</a></span> <span class="id">isv</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_var">denot_var</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">x</span>) (<span class="id">InfΓ</span> <span class="id">x</span> <span class="id">isv</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| _ =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| _ =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.sem_hist_of_envs">sem_hist_of_envs</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">InfΓ</span> <span class="id">x</span> <span class="id">Infx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar">IsVar</a></span> <span class="id">Γ</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.hist_of_envs">hist_of_envs</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">InfΓ</span>) (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_var">denot_var</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">x</span>) <span class="id">Infx</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.hist_of_envs">hist_of_envs</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.IsVar_dec">IsVar_dec</a></span> <span class="id">Γ</span> <span class="id">x</span>) <span class="id">eqn</span>:<span class="id">Hdec</span>; [| <span class="id">contradiction</span>].<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hdec</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.sem_var_nins">sem_var_nins</a></span> : <span class="kwd">forall</span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">InfΓ</span> <span class="id">x</span> <span class="id">s</span> <span class="id">Inf</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar">IsVar</a></span> <span class="id">Γ</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">ins</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> == <span class="id">env</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.hist_of_envs">hist_of_envs</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">InfΓ</span>) (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">s</span> <span class="id">Inf</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hvar</span> <span class="id">Hnin</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_var_EqSt">sem_var_EqSt</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_hist_of_envs">sem_hist_of_envs</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">reflexivity</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_var">denot_var</a></span>; <span class="id">cases_eqn</span> <span class="id">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#mem_ident_spec">mem_ident_spec</a></span> <span class="kwd">in</span> <span class="id">Hmem</span>; <span class="id">contradiction</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id">sem_hist_of_envs'</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">InfΓ</span> <span class="id">x</span> <span class="id">s</span> <span class="id">Inf</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar">IsVar</a></span> <span class="id">Γ</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> == <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_var">denot_var</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.hist_of_envs">hist_of_envs</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">InfΓ</span>) (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">s</span> <span class="id">Inf</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.hist_of_envs">hist_of_envs</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.IsVar_dec">IsVar_dec</a></span> <span class="id">Γ</span> <span class="id">x</span>) <span class="id">eqn</span>:<span class="id">Hdec</span>; [| <span class="id">contradiction</span>].<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hdec</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.sem_var_ins">sem_var_ins</a></span> : <span class="kwd">forall</span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">InfΓ</span> <span class="id">x</span> <span class="id">s</span> <span class="id">Inf</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar">IsVar</a></span> <span class="id">Γ</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">ins</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> == <span class="id">envI</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.hist_of_envs">hist_of_envs</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">InfΓ</span>) (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">s</span> <span class="id">Inf</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Isv</span> <span class="id">Hin</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sem_hist_of_envs'</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_var">denot_var</a></span>; <span class="id">cases_eqn</span> <span class="id">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#mem_ident_false">mem_ident_false</a></span> <span class="kwd">in</span> <span class="id">Hmem</span>; <span class="id">contradiction</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<br/>
<div class="doc">Hypothèse sur les entrées d'un nœud : elles doivent être bien typées
    et respecter leurs annotations d'horloge. </div>
<span class="kwd">Definition</span> <span class="id"><a name="SDTOREL.wf_ins">wf_ins</a></span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">n</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.node">node</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>) <span class="id">envI</span> <span class="id">bs</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ins</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Γ</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env">wf_env</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bs</span> 0.<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="SDTOREL.Ok_node">Ok_node</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id"><a name="SDTOREL.Ok_node.PSyn">PSyn</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.decl">decl</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.block">block</a></span> -&gt; <span class="kwd">Prop</span>}.<br/>
<span class="kwd">Context</span> {<span class="id"><a name="SDTOREL.Ok_node.Prefs">Prefs</a></span> : <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span>}.<br/>
<br/>
<span class="kwd">Variables</span><br/>
&nbsp;&nbsp;(<span class="id"><a name="SDTOREL.Ok_node.G">G</a></span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.PSyn">PSyn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.Prefs">Prefs</a></span>)<br/>
&nbsp;&nbsp;(<span class="id"><a name="SDTOREL.Ok_node.envG">envG</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprodi">Dprodi</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.FI">FI</a></span>).<br/>
<br/>
<div class="doc">Toutes les hypothèses de section sur G et envG seront obtenues par
    récurrence dans ok_global. </div>
<br/>
<span class="kwd">Hypothesis</span> (<span class="id"><a name="SDTOREL.Ok_node.Wtg">Wtg</a></span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global">wt_global</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span>).<br/>
<span class="kwd">Hypothesis</span> (<span class="id"><a name="SDTOREL.Ok_node.Wcg">Wcg</a></span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_global">wc_global</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span>).<br/>
<span class="kwd">Hypothesis</span> (<span class="id"><a name="SDTOREL.Ok_node.Hrg">Hrg</a></span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_global">restr_global</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="SDTOREL.Ok_node.InfG">InfG</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">nd</span> <span class="id">envI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">nd</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">envI</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">nd</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">f</span> <span class="id">envI</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">nd</span>)).<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="SDTOREL.Ok_node.AbsG">AbsG</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> <span class="id">X</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">f</span> <span class="id">X</span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="SDTOREL.Ok_node.Hlp">Hlp</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">X</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> <span class="id">X</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">f</span> <span class="id">X</span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="SDTOREL.Ok_node.Wfg">Wfg</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span> <span class="id">envI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ins</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Γ</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.get_locals">get_locals</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_block">n_block</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">bs</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span> &lt;= <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env">wf_env</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bs</span> 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env">wf_env</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bs</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">f</span> <span class="id">envI</span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="SDTOREL.Ok_node.Halign">Halign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ins</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Γ</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.get_locals">get_locals</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_block">n_block</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">envI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env">wf_env</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">f</span> <span class="id">envI</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#abs_alignLE">abs_alignLE</a></span> <span class="id">envI</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">f</span> <span class="id">envI</span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="SDTOREL.Ok_node.Hnode">Hnode</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span> <span class="id">envI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ins</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">outs</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">os</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> <span class="id">outs</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">f</span> <span class="id">envI</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.wf_ins">wf_ins</a></span> <span class="id">n</span> <span class="id">envI</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Infi</span> <span class="id">Info</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node">sem_node</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">xs</span> <span class="id">Infi</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">os</span> <span class="id">Info</span>).<br/>
<br/>
<br/>
<div class="doc">On le laisse ici car il dépend des hypothèses de section </div>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_reset">ok_reset</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">nf</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">f</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">nin</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">nout</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rs</span> (<span class="id">ss</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">nin</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">os</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> <span class="id">nout</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset">sreset</a></span> <span class="id">nf</span> <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.env_of_np">env_of_np</a></span> <span class="id">nin</span> <span class="id">ss</span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.wf_ins">wf_ins</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.env_of_np">env_of_np</a></span> <span class="id">nin</span> <span class="id">ss</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">nin</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.env_of_np">env_of_np</a></span> <span class="id">nin</span> <span class="id">ss</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">InfI</span> <span class="id">InfO</span> <span class="id">Infr</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node">sem_node</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.maskv">maskv</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">rs</span> <span class="id">Infr</span>)) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">ss</span> <span class="id">InfI</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.maskv">maskv</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">rs</span> <span class="id">Infr</span>)) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">os</span> <span class="id">InfO</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hfind</span> * <span class="id">Hwf</span> *.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_nodup">n_nodup</a></span> <span class="id">n</span>) <span class="kwd">as</span> [<span class="id">Ndio</span> _].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span> <span class="kwd">in</span> <span class="id">Ndio</span> <span class="kwd">as</span> <span class="id">Ndi</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_r">NoDup_app_r</a></span> <span class="kwd">in</span> <span class="id">Ndio</span> <span class="kwd">as</span> <span class="id">Ndo</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_ingt0">n_ingt0</a></span> <span class="id">n</span>) <span class="kwd">as</span> <span class="id">Innil</span>; <span class="id">rewrite</span> &lt;- (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span>) <span class="kwd">in</span> <span class="id">Innil</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_outgt0">n_outgt0</a></span> <span class="id">n</span>) <span class="kwd">as</span> <span class="id">Onnil</span>; <span class="id">setoid_rewrite</span> &lt;- (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span>) <span class="kwd">in</span> <span class="id">Onnil</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_find_node">wc_find_node</a></span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> <span class="id">HH</span>; <span class="id">auto</span>; <span class="id">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> (<span class="id">G'</span> &amp; <span class="id">Wcn</span>).<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.map_mask">map_mask</a></span> <span class="kwd">as</span> [<span class="id">Inf3</span> -&gt;]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.map_mask">map_mask</a></span> <span class="kwd">as</span> [<span class="id">Inf4</span> -&gt;]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;prépare&nbsp;wf_ins&nbsp;pour&nbsp;la&nbsp;suite&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_smask0">wf_env_smask0</a></span> _ _ _ _ <span class="id">k</span> <span class="id">rs</span>) <span class="kwd">in</span> <span class="id">Hwf</span> <span class="kwd">as</span> <span class="id">Hwf</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.clock_ins_stable">clock_ins_stable</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#bss_smask">bss_smask</a></span> <span class="kwd">in</span> <span class="id">Hwf</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node_morph">sem_node_morph</a></span> <span class="kwd">with</span> (<span class="id">x</span> := <span class="id">f</span>), <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.Hnode">Hnode</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id">n</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;input&nbsp;ok&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;output&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">os</span> <span class="id">nf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold</span> <span class="id">nout</span> <span class="kwd">in</span> <span class="id">Onnil</span>, <span class="id">Ndo</span> |- *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env_ext">np_of_env_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">i</span> <span class="id">Ini</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">smask_sreset'</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">f</span>)); <span class="id">eauto</span> 2 <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.inf_dom_env_of_np">inf_dom_env_of_np</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_proj_eq">smask_env_proj_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.env_of_np_of_env_proj">env_of_np_of_env_proj</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.Halign">Halign</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.Wfg">Wfg</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_0_ext">wf_env_0_ext</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">forall_np_of_env'</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.InfG">InfG</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.ResetMask.html#smask_env_inf">smask_env_inf</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.inf_dom_env_of_np">inf_dom_env_of_np</a></span>.<br/>
Qed.</div></details>
<br/>
<br/>
<div class="doc">Deux tactiques bien pratiques pour la suite </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">gen_infinite_exp</span> :=<br/>
&nbsp;&nbsp;<span class="id">repeat</span> (<br/>
&nbsp;&nbsp;<span class="id">simpl</span>; <br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">f</span> := <span class="id">fresh</span> <span class="string">"Inf"</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span> [ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_exp">infinite_exp</a></span> ?<span class="id">H1</span> ?<span class="id">H2</span> ?<span class="id">H3</span> ?<span class="id">H4</span> ?<span class="id">H5</span> ?<span class="id">H6</span> ?<span class="id">H7</span> ?<span class="id">H8</span> ?<span class="id">H9</span> ?<span class="id">H10</span> ?<span class="id">H11</span> ?<span class="id">H12</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_exp">infinite_exp</a></span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span> <span class="id">H4</span> <span class="id">H5</span> <span class="id">H6</span> <span class="id">H7</span> <span class="id">H8</span> <span class="id">H9</span> <span class="id">H10</span> <span class="id">H11</span> <span class="id">H12</span>) <span class="kwd">as</span> <span class="id">f</span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span> [ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_exps">infinite_exps</a></span> ?<span class="id">H1</span> ?<span class="id">H2</span> ?<span class="id">H3</span> ?<span class="id">H4</span> ?<span class="id">H5</span> ?<span class="id">H6</span> ?<span class="id">H7</span> ?<span class="id">H8</span> ?<span class="id">H9</span> ?<span class="id">H10</span> ?<span class="id">H11</span> ?<span class="id">H12</span> ?<span class="id">H13</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_exps">infinite_exps</a></span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span> <span class="id">H4</span> <span class="id">H5</span> <span class="id">H6</span> <span class="id">H7</span> <span class="id">H8</span> <span class="id">H9</span> <span class="id">H10</span> <span class="id">H11</span> <span class="id">H12</span> <span class="id">H13</span>) <span class="kwd">as</span> <span class="id">f</span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span> [ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_expss">infinite_expss</a></span> ?<span class="id">H1</span> ?<span class="id">H2</span> ?<span class="id">H3</span> ?<span class="id">H4</span> ?<span class="id">H5</span> ?<span class="id">H6</span> ?<span class="id">H7</span> ?<span class="id">H8</span> ?<span class="id">H9</span> ?<span class="id">H10</span> ?<span class="id">H11</span> ?<span class="id">H12</span> ?<span class="id">H13</span> ?<span class="id">H14</span> ?<span class="id">H15</span> ?<span class="id">H16</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_expss">infinite_expss</a></span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span> <span class="id">H4</span> <span class="id">H5</span> <span class="id">H6</span> <span class="id">H7</span> <span class="id">H8</span> <span class="id">H9</span> <span class="id">H10</span> <span class="id">H11</span> <span class="id">H12</span> <span class="id">H13</span> <span class="id">H14</span> <span class="id">H15</span> <span class="id">H16</span>) <span class="kwd">as</span> <span class="id">f</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">save_denot_exp</span> <span class="id">se</span> <span class="id">Hse</span> :=<br/>
&nbsp;&nbsp;<span class="id">gen_infinite_exp</span>;<br/>
&nbsp;&nbsp;<span class="id">simpl</span>; <br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span> [ ?<span class="id">f1</span> (?<span class="id">f2</span> (?<span class="id">f3</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp">denot_exp</a></span> ?<span class="id">e1</span> ?<span class="id">e2</span> ?<span class="id">e3</span>) ?<span class="id">e4</span>) ?<span class="id">e5</span>) ?<span class="id">e6</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">f1</span> (<span class="id">f2</span> (<span class="id">f3</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp">denot_exp</a></span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">e3</span>) <span class="id">e4</span>) <span class="id">e5</span>) <span class="id">e6</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">se</span> <span class="id">eqn</span>:<span class="id">Hse</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">gen_inf_sub_exps</span> :=<br/>
&nbsp;&nbsp;<span class="id">gen_infinite_exp</span>;<br/>
&nbsp;&nbsp;<span class="id">gen_sub_exps</span>. <br/>
<br/>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">k</span> <span class="id">bs</span> : (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.maskv">maskv</a></span> <span class="id">k</span> <span class="id">bs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _ ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">maskv_morph2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.maskv_morph">maskv_morph</a></span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.sem_sub_exps">sem_sub_exps</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ins</span> <span class="id">H</span> <span class="id">envI</span> <span class="id">envG</span> <span class="id">bs</span> <span class="id">bsi</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">es</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.exp">exp</a></span>) <span class="id">Infes</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">forall</span> <span class="id">Infe</span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">bs</span> <span class="id">bsi</span>) <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp">denot_exp</a></span> <span class="id">G</span> <span class="id">ins</span> <span class="id">e</span> <span class="id">envG</span> <span class="id">envI</span> <span class="id">env</span>) <span class="id">Infe</span>)) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">sss</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">sss</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exps">denot_exps</a></span> <span class="id">G</span> <span class="id">ins</span> <span class="id">es</span> <span class="id">envG</span> <span class="id">envI</span> <span class="id">env</span>) <span class="id">Infes</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">bs</span> <span class="id">bsi</span>)) <span class="id">es</span> <span class="id">sss</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">es</span> <span class="kwd">as</span> [| <span class="id">e1</span> <span class="id">es</span>]; <span class="id">intros</span> * <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">exists</span> []; <span class="id">split</span>; <span class="id">now</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_eq">Ss_of_nprod_eq</a></span> _ <span class="id">Infes</span>) <span class="kwd">as</span> [<span class="id">Inf1</span> <span class="id">Eq1</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exps_eq">denot_exps_eq</a></span>. <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_app">Ss_app</a></span> _ _ <span class="id">Inf1</span>) <span class="kwd">as</span> (<span class="id">Inf2</span> &amp; <span class="id">Inf3</span> &amp; <span class="id">Eq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHes</span> <span class="id">Inf3</span>) <span class="kwd">as</span> (<span class="id">sss</span> &amp; <span class="id">Heq</span> &amp; <span class="id">Hsem</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> (_ :: <span class="id">sss</span>); <span class="id">split</span>; <span class="id">unshelve</span> <span class="id">eauto</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_app">Forall2_app</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.sem_sub_expss">sem_sub_expss</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ins</span> <span class="id">H</span> <span class="id">envI</span> <span class="id">envG</span> <span class="id">bs</span> <span class="id">bsi</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">ess</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.exp">exp</a></span>)) <span class="id">n</span> <span class="id">Infes</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots">annots</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>)) = <span class="id">n</span>) <span class="id">ess</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">forall</span> <span class="id">Infe</span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">bs</span> <span class="id">bsi</span>) <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp">denot_exp</a></span> <span class="id">G</span> <span class="id">ins</span> <span class="id">e</span> <span class="id">envG</span> <span class="id">envI</span> <span class="id">env</span>) <span class="id">Infe</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">ess</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> '(_, <span class="id">es</span>) <span class="id">ss</span> =&gt; <span class="kwd">exists</span> <span class="id">sss</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> <span class="id">ss</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">sss</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id">G</span> <span class="id">H</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">bs</span> <span class="id">bsi</span>)) <span class="id">es</span> <span class="id">sss</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ess</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprods">Ss_of_nprods</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_expss">denot_expss</a></span> <span class="id">G</span> <span class="id">ins</span> <span class="id">ess</span> <span class="id">n</span> <span class="id">envG</span> <span class="id">envI</span> <span class="id">env</span>) <span class="id">Infes</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> *.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ess</span> <span class="kwd">as</span> [|[<span class="id">t</span> <span class="id">es</span>] <span class="id">ess</span>]; <span class="id">intros</span> * <span class="id">Hl</span> <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">Hl</span>; <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">now</span> <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;es&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#list_sum">list_sum</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">es</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots">annots</a></span> <span class="id">es</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">Heq</span>|<span class="id">Hneq</span>] <span class="id">eqn</span>:<span class="id">Hdec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">clear</span> <span class="id">Hdec</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span> <span class="kwd">in</span> <span class="id">Hneq</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_hd">forall_nprod_hd</a></span> _ _ _) <span class="kwd">as</span> <span class="id">Inf1</span> <span class="id">eqn</span>:<span class="id">HH</span>; <span class="id">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Inf</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> _) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exps">denot_exps</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id">es</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">simpl</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> _) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_expss_eq">denot_expss_eq</a></span>, <span class="id">Hdec</span> <span class="kwd">in</span> <span class="id">Infes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#app_forall_nprod">app_forall_nprod</a></span> _ _ 1) <span class="kwd">in</span> <span class="id">Infes</span> <span class="kwd">as</span> [<span class="id">Inf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span> <span class="kwd">in</span> <span class="id">Inf</span>; <span class="id">cases</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> _ <span class="id">es</span>) <span class="id">and</span> <span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_sub_exps">sem_sub_exps</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (<span class="id">sss</span> &amp; <span class="id">Hsss</span> &amp; <span class="id">Hsem</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">sss</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hsss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_eq">Ss_of_nprod_eq</a></span> _ <span class="id">Inf1</span>) <span class="kwd">as</span> [<span class="id">Inf2</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">simpl</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> _).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_expss_eq">denot_expss_eq</a></span>, <span class="id">Hdec</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd_cons">nprod_hd_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span>; <span class="id">revert</span> <span class="id">Inf2</span> <span class="id">Inf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">gen_sub_exps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Heq</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;tail&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ess</span> <span class="kwd">as</span> [|<span class="id">es2</span> <span class="id">ess</span>]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> (<span class="id"><a href="Velus.Common.CommonList.html#Forall2_morph">Forall2_morph</a></span> _ _ _ _ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span>) <span class="kwd">in</span> <span class="id">IHess</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;morphisme&nbsp;à&nbsp;la&nbsp;con&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span>; <span class="id">intros</span> [] [] <span class="id">HH</span> <span class="id">x</span> ?? (?&amp;?&amp;?); <span class="id">inv</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplit</span>; <span class="id">split</span>; <span class="id">eauto</span>; <span class="id">now</span> <span class="id">transitivity</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>; [<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span> | <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprods_eq">_Ss_of_nprods_eq</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_expss_eq">denot_expss_eq</a></span> <span class="kwd">in</span> *; <span class="id">cases</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">contradict</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span>.<br/>
Qed.</div></details>
<br/>
<br/>
<div class="doc">On traite à part le cas des appels de nœuds car il apparaît à la fois
    dans une expression Eapp et dans une équation de type xs=<span class="bracket"><span class="id">Eapp</span></span>.
    Dand les deux cas seules les hypothèses du lemme suivant sont
    nécessaires. En particulier, rien à dire sur la dépendance entre les
    horloges de l'équation et de l'application. </div>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_sem_Eapp">ok_sem_Eapp</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">env</span> <span class="id">envI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">bs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">bsi</span> (<span class="id">InfΓ</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.inf_dom">inf_dom</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env">wf_env</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bs</span> <span class="id">env</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.hist_of_envs">hist_of_envs</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">InfΓ</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span> <span class="id">es</span> <span class="id">er</span> <span class="id">anns</span> <span class="id">bck</span> <span class="id">sub</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> (<span class="id">et</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.type">type</a></span>) '(_, (<span class="id">t</span>, _, _)) =&gt; <span class="id">et</span> = <span class="id">t</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typesof">typesof</a></span> <span class="id">es</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span> <span class="id">sub</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (_, <span class="id">ck</span>, _)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>)) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.nclocksof">nclocksof</a></span> <span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.exp">exp</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span> = 1) <span class="id">er</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks.wc_env">wc_env</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (_, <span class="id">ck</span>, _)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id">anns</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">Γ</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">Γ</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_exp">no_rte_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">forall</span> <span class="id">Infe</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">bs</span> <span class="id">bsi</span>) <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp">denot_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id">e</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span>) <span class="id">Infe</span>)) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span> <span class="id">er</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">Γ</span>) <span class="id">er</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typeof">typeof</a></span> <span class="id">e</span> = [<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.bool_velus_type">bool_velus_type</a></span>]) <span class="id">er</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">Γ</span>) <span class="id">er</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_exp">no_rte_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span>) <span class="id">er</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">forall</span> <span class="id">Infe</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">bs</span> <span class="id">bsi</span>) <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp">denot_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id">e</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span>) <span class="id">Infe</span>)) <span class="id">er</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">os</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp">denot_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Eapp">Eapp</a></span> <span class="id">f</span> <span class="id">es</span> <span class="id">er</span> <span class="id">anns</span>) <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">infO</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">bs</span> <span class="id">bsi</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Eapp">Eapp</a></span> <span class="id">f</span> <span class="id">es</span> <span class="id">er</span> <span class="id">anns</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">os</span> <span class="id">infO</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> ?? <span class="id">env</span> * <span class="id">Hc</span> * <span class="id">WTi</span> <span class="id">WIi</span> <span class="id">Nr1</span> <span class="id">WCi</span> <span class="id">Hfind</span> <span class="id">Hlo</span> <span class="id">Hr</span> <span class="id">Hwt</span> <span class="id">Hwc</span> <span class="id">Hoc</span> <span class="id">Hsem</span> <span class="id">Hrr</span> <span class="id">Hwtr</span> <span class="id">Hwtr'</span> <span class="id">Hwcr</span> <span class="id">Hocr</span> <span class="id">Hsemr</span> ??.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">WTi</span> <span class="kwd">as</span> <span class="id">Hli</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typesof_annots">length_typesof_annots</a></span> <span class="kwd">in</span> <span class="id">Hli</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span> _ (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wx_exp">wt_exp_wx_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">Γ</span>)) <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hwx</span>, <span class="id">Hwtr</span> <span class="kwd">as</span> <span class="id">Hwxr</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span> _ (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wl_exp">wt_exp_wl_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">Γ</span>)) <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hwl</span>, <span class="id">Hwtr</span> <span class="kwd">as</span> <span class="id">Hwlr</span>.<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">ss</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exps">denot_exps</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id">es</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">rs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exps">denot_exps</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id">er</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;utile&nbsp;pour&nbsp;après&nbsp;ou&nbsp;pas&nbsp;?&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hins</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.wf_ins">wf_ins</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.env_of_np">env_of_np</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.idents">idents</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>)) <span class="id">ss</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.idents">idents</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>)) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.env_of_np">env_of_np</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.idents">idents</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>)) <span class="id">ss</span>))).<br/>
&nbsp;&nbsp;{ <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.wf_ins">wf_ins</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span> <span class="kwd">in</span> <span class="id">Hli</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.nclocksof_sem">nclocksof_sem</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">es</span>) <span class="kwd">as</span> <span class="id">Ncs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.safe_exps_">safe_exps_</a></span> <span class="kwd">with</span> (<span class="id">es</span> := <span class="id">es</span>) <span class="kwd">as</span> (<span class="id">sTy</span> &amp; <span class="id">sCl</span> &amp; <span class="id">sEf</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_loc">wf_env_loc</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_0_ext">wf_env_0_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.clocksof_nclocksof">clocksof_nclocksof</a></span> <span class="kwd">in</span> <span class="id">sCl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.safe_inst_in">safe_inst_in</a></span> <span class="kwd">with</span> (<span class="id">ss</span> := <span class="id">ss</span>) <span class="kwd">in</span> <span class="id">Hli</span> <span class="kwd">as</span> <span class="id">Hec</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_morph">wf_env_morph</a></span> <span class="kwd">in</span> <span class="id">Hec</span>; <span class="id">eauto</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;équivalence&nbsp;des&nbsp;horloges&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_decompose">wf_env_decompose</a></span> <span class="kwd">in</span> <span class="id">Hec</span> <span class="kwd">as</span> (?&amp; <span class="id">Hcl</span> &amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.bss_le_bs">bss_le_bs</a></span> <span class="kwd">in</span> <span class="id">Hcl</span> <span class="kwd">as</span> <span class="id">Hbs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_le_eq">infinite_le_eq</a></span> <span class="kwd">in</span> <span class="id">Hbs</span> <span class="kwd">as</span> -&gt;; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss_inf_dom">bss_inf_dom</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.inf_dom_env_of_np">inf_dom_env_of_np</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_exps">infinite_exps</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_sub_exps">sem_sub_exps</a></span> <span class="kwd">with</span> (<span class="id">es</span> := <span class="id">es</span>) <span class="kwd">as</span> (<span class="id">sss</span> &amp; <span class="id">Heqs</span> &amp; <span class="id">Hsss</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_sub_exps">sem_sub_exps</a></span> <span class="kwd">with</span> (<span class="id">es</span> := <span class="id">er</span>) <span class="kwd">as</span> (<span class="id">rss</span> &amp; <span class="id">Heqr</span> &amp; <span class="id">Hrss</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Hsem</span> <span class="id">Hsemr</span>.<br/>
&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;2,3: <span class="id">now</span> <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_exps">infinite_exps</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Sapp_retro_compat">Sapp_retro_compat</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;bools_ofs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Heqr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.safe_exps_">safe_exps_</a></span> <span class="kwd">in</span> <span class="id">Hwtr</span> <span class="kwd">as</span> (<span class="id">rTy</span> &amp; _ &amp; _);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_loc">wf_env_loc</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_0_ext">wf_env_0_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.typeof_same">typeof_same</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2_Forall_eq">Forall2_Forall_eq</a></span> <span class="kwd">with</span> (2:= <span class="id">rTy</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Forall_forall_nprod">Forall_forall_nprod</a></span> <span class="kwd">in</span> <span class="id">Hwtr'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.bools_ofs_sbools_of">bools_ofs_sbools_of</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.sbools_ofs_inf">sbools_ofs_inf</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_exp">infinite_exp</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_exps">infinite_exps</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;sem_node&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Heqs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">ss</span> <span class="id">rs</span>; <span class="id">revert</span> <span class="id">infO</span> <span class="id">Hins</span>; <span class="id">revert</span> <span class="id">os</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">save_denot_exp</span> <span class="id">se</span> <span class="id">Hse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp_eq">denot_exp_eq</a></span> <span class="kwd">in</span> <span class="id">Hse</span>; <span class="id">revert</span> <span class="id">Hse</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">gen_sub_exps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hfind</span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span>, <span class="id">Hli</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.decl">decl</a></span> <span class="kwd">in</span> <span class="id">Hlo</span>; <span class="id">rewrite</span> &lt;- (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span>) <span class="kwd">in</span> <span class="id">Hlo</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.idents">idents</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases</span>; <span class="id">intros</span>; <span class="id">subst</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_reset">ok_reset</a></span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<div class="doc">Morphismes rencontrés dans la preuve de <span class="bracket"><span class="id">ok_sem_exp</span></span>.
    La plupart sont ad hoc, donc on les laisse ici. </div>
<br/>
<span class="id">Local</span> <span class="kwd">Instance</span> : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> ((@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) ==&gt; (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> _) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">s</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.when">when</a></span> <span class="id">k</span> <span class="id">s</span> <span class="id">t</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">solve_proper</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">Local</span> <span class="kwd">Instance</span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> (<span class="id">A</span>:=<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">ss</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.merge">merge</a></span> <span class="id">s</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">ss</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span>.<br/>
&nbsp;&nbsp;<span class="id">solve_proper</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">Local</span> <span class="kwd">Instance</span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> (<span class="id">A</span>:=<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">ss</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case">case</a></span> <span class="id">s</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">ss</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span>.<br/>
&nbsp;&nbsp;<span class="id">solve_proper</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">Local</span> <span class="kwd">Instance</span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> ==&gt; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> (<span class="id">A</span>:=<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>) * <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> (<span class="id">A</span>:=<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>)) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">ss</span> <span class="id">dos</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case">case</a></span> <span class="id">s</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">ss</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">dos</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">dos</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span>.<br/>
&nbsp;&nbsp;<span class="id">solve_proper</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">Local</span> <span class="kwd">Instance</span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">l</span> <span class="id">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> (<span class="id">A</span>:=<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.svalue">svalue</a></span>) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">ss</span> <span class="id">b</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case">case</a></span> <span class="id">s</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#tl">tl</a></span> <span class="id">ss</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#hd">hd</a></span> <span class="id">d</span> <span class="id">ss</span>)) <span class="id">b</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span>.<br/>
&nbsp;&nbsp;<span class="id">solve_proper</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ty_DS_wt_stream">ty_DS_wt_stream</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span> <span class="id">s</span> <span class="id">si</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.ty_DS">ty_DS</a></span> <span class="id">ty</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.wt_stream">wt_stream</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">s</span> <span class="id">si</span>) <span class="id">ty</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.ty_DS">ty_DS</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hty</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_st</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv">S_of_DSv</a></span> <span class="id">s</span> <span class="id">si</span>) <span class="kwd">as</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>; <span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS_Cons">S_of_DS_Cons</a></span> <span class="kwd">in</span> <span class="id">Ht</span> <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hs</span> &amp;?&amp;?&amp;?).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hs</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hty</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">cases</span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">eauto</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<div class="doc">On redéfinit <span class="bracket"><span class="id">Safe.safe_exp</span></span>, qui a une hypothèse de <span class="bracket"><span class="id">wf_env</span></span> un peu
    différente que <span class="bracket"><span class="id">Wfg</span></span> présente dans cette section : son Γ n'inclut
    pas <span class="bracket"><span class="id">get_locals</span> (<span class="id">n_block</span> <span class="id">n</span>)</span>.
 </div>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.safe_exp">safe_exp</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bs</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env">wf_env</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bs</span> <span class="id">env</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span> &lt;= <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">e</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.exp">exp</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">Γ</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">Γ</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_exp">no_rte_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ss</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp">denot_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id">e</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.safe_DS">safe_DS</a></span> <span class="id">ss</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.safe_exp">safe_exp</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_0_ext">wf_env_0_ext</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_loc">wf_env_loc</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_sem_exp">ok_sem_exp</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">env</span> <span class="id">envI</span> <span class="id">InfΓ</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">bs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">bsi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env">wf_env</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bs</span> <span class="id">env</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.hist_of_envs">hist_of_envs</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">InfΓ</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">e</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.exp">exp</a></span>) (<span class="id">Hwt</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">Γ</span> <span class="id">e</span>) (<span class="id">Hwc</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">Γ</span> <span class="id">e</span>) (<span class="id">Hr</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span> <span class="id">e</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_exp">no_rte_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ss</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp">denot_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id">e</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Infe</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">bs</span> <span class="id">bsi</span>) <span class="id">e</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">ss</span> <span class="id">Infe</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> ?? <span class="id">env</span> * <span class="id">Hc</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.exp_ind2">exp_ind2</a></span>; <span class="id">intros</span> * ??? <span class="id">Hoc</span> <span class="id">ss</span> <span class="id">Infe</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">inv</span> <span class="id">Hr</span>; <span class="id">subst</span> <span class="id">ss</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Econst&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv_eq">S_of_DSv_eq</a></span> <span class="kwd">as</span> [<span class="id">Infe'</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp_eq">denot_exp_eq</a></span>. <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_const">ok_const</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Infty.html#sconst_inf">sconst_inf</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DS_of_S_inf">DS_of_S_inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DS_of_S_of_DS">DS_of_S_of_DS</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Eenum&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv_eq">S_of_DSv_eq</a></span> <span class="kwd">as</span> [<span class="id">Infe'</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp_eq">denot_exp_eq</a></span>. <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_enum">ok_enum</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Infty.html#sconst_inf">sconst_inf</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DS_of_S_inf">DS_of_S_inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#_S_of_DS_eq">_S_of_DS_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DS_of_S_of_DS">DS_of_S_of_DS</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Evar&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wx_exp">wt_exp_wx_exp</a></span> <span class="kwd">in</span> <span class="id">Hwt</span>; <span class="id">inv</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv_eq">S_of_DSv_eq</a></span> <span class="kwd">as</span> [<span class="id">Infe'</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp_eq">denot_exp_eq</a></span>. <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_hist_of_envs">sem_hist_of_envs</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Eunop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.safe_exp">safe_exp</a></span> <span class="kwd">in</span> <span class="id">Hoc</span> <span class="kwd">as</span> <span class="id">Hs</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wl_exp">wt_exp_wl_exp</a></span> <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hwl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwt</span>. <span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">inv</span> <span class="id">Hoc</span>. <span class="id">inv</span> <span class="id">Hwl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_eq">Ss_of_nprod_eq</a></span> _ <span class="id">Infe</span>) <span class="kwd">as</span> [<span class="id">Hinf0</span> <span class="id">HH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp_eq">denot_exp_eq</a></span>. <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HH</span>; <span class="id">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp_eq">denot_exp_eq</a></span> <span class="kwd">in</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hinf0</span> <span class="id">IHe</span> <span class="id">Hs</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">gen_inf_sub_exps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span> = 1) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typeof">typeof</a></span> <span class="id">e</span> = _) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHe</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_unop">ok_unop</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sunop">sunop</a></span> <span class="kwd">in</span> <span class="id">Hinf0</span>; <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#inf_map">inf_map</a></span> <span class="kwd">in</span> <span class="id">Hinf0</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Ebinop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.safe_exp">safe_exp</a></span> <span class="kwd">in</span> <span class="id">Hoc</span> <span class="kwd">as</span> <span class="id">Hs</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wl_exp">wt_exp_wl_exp</a></span> <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hwl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwt</span>. <span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">inv</span> <span class="id">Hoc</span>. <span class="id">inv</span> <span class="id">Hwl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_eq">Ss_of_nprod_eq</a></span> _ <span class="id">Infe</span>) <span class="kwd">as</span> [<span class="id">Hinf0</span> <span class="id">HH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp_eq">denot_exp_eq</a></span>. <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HH</span>; <span class="id">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp_eq">denot_exp_eq</a></span> <span class="kwd">in</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hinf0</span> <span class="id">IHe1</span> <span class="id">IHe2</span> <span class="id">Hs</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">gen_inf_sub_exps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">e1</span> = 1) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">e2</span> = 1) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typeof">typeof</a></span> <span class="id">e1</span> = _) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typeof">typeof</a></span> <span class="id">e2</span> = _) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHe1</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHe2</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_binop">ok_binop</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Infty.html#inf_sbinop">inf_sbinop</a></span> <span class="kwd">in</span> <span class="id">Hinf0</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Efby&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.safe_exp">safe_exp</a></span> <span class="kwd">in</span> <span class="id">Hoc</span> <span class="kwd">as</span> <span class="id">Hs</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wl_exp">wt_exp_wl_exp</a></span> <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hwl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wx_exp">wt_exp_wx_exp</a></span> <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hwx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwt</span>. <span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">inv</span> <span class="id">Hoc</span>. <span class="id">inv</span> <span class="id">Hwl</span>. <span class="id">inv</span> <span class="id">Hwx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> _ _) <span class="kwd">in</span> <span class="id">H0</span>, <span class="id">H1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_exp">wc_exp</a></span> _ _) <span class="kwd">in</span> <span class="id">H0</span>, <span class="id">H1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>) <span class="kwd">in</span> <span class="id">H0</span>, <span class="id">H1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_exp">no_rte_exp</a></span> _ _ _ _ _) <span class="kwd">in</span> <span class="id">H0</span>, <span class="id">H1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_sub_exps">sem_sub_exps</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">s0ss</span> &amp; <span class="id">Eq0</span> &amp; <span class="id">Sem0</span>), <span class="id">H1</span> <span class="kwd">as</span> (<span class="id">sss</span> &amp; <span class="id">Eq1</span> &amp; <span class="id">Sem</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_exps">infinite_exps</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Eq0</span>, <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Infe</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">save_denot_exp</span> <span class="id">se</span> <span class="id">Hse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp_eq">denot_exp_eq</a></span> <span class="kwd">in</span> <span class="id">Hse</span>; <span class="id">revert</span> <span class="id">Hse</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">gen_sub_exps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span>; <span class="id">cases</span>; <span class="id">intros</span>; <span class="id">subst</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#list_sum">list_sum</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">es</span>)); <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv_eq">S_of_DSv_eq</a></span>) <span class="kwd">as</span> [<span class="id">Inf3</span> <span class="id">HH</span>]. 2: <span class="id">setoid_rewrite</span> <span class="id">HH</span> <span class="kwd">at</span> 3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift2_hd">lift2_hd</a></span>. <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_hd">forall_nprod_hd</a></span> <span class="kwd">in</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift2_hd">lift2_hd</a></span> <span class="kwd">in</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_fby">ok_fby</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">edestruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_eq">Ss_of_nprod_eq</a></span> <span class="id">n</span>) <span class="kwd">as</span> [<span class="id">Inf3</span> <span class="id">HH</span>]. 2: <span class="id">setoid_rewrite</span> <span class="id">HH</span> <span class="kwd">at</span> 3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift2_tl">lift2_tl</a></span>. <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_tl">forall_nprod_tl</a></span> <span class="kwd">in</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift2_tl">lift2_tl</a></span> <span class="kwd">in</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHn</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_tl">forall_nprod_tl</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Ewhen&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span> <span class="kwd">as</span> [<span class="id">x</span> <span class="id">ty</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.safe_exp">safe_exp</a></span> <span class="kwd">in</span> <span class="id">Hoc</span> <span class="kwd">as</span> <span class="id">Hs</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wl_exp">wt_exp_wl_exp</a></span> <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hwl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wx_exp">wt_exp_wx_exp</a></span> <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hwx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwt</span>. <span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">inv</span> <span class="id">Hoc</span>. <span class="id">inv</span> <span class="id">Hwl</span>. <span class="id">inv</span> <span class="id">Hwx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> _ _) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_exp">wc_exp</a></span> _ _) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_exp">no_rte_exp</a></span> _ _ _ _ _) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_sub_exps">sem_sub_exps</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">s0ss</span> &amp; <span class="id">Eq0</span> &amp; <span class="id">Sem0</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_exps">infinite_exps</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">simpl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">unshelve</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_hist_of_envs">sem_hist_of_envs</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_var_inf">denot_var_inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Eq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Infe</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">save_denot_exp</span> <span class="id">se</span> <span class="id">Hse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp_eq">denot_exp_eq</a></span> <span class="kwd">in</span> <span class="id">Hse</span>; <span class="id">revert</span> <span class="id">Hse</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">gen_inf_sub_exps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span>; <span class="id">cases</span>; <span class="id">intros</span>; <span class="id">subst</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#list_sum">list_sum</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.numstreams">numstreams</a></span> <span class="id">es</span>)); <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.S_of_DSv_eq">S_of_DSv_eq</a></span>) <span class="kwd">as</span> [<span class="id">Inf3</span> <span class="id">HH</span>]. 2: <span class="id">setoid_rewrite</span> <span class="id">HH</span> <span class="kwd">at</span> 3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#llift_hd">llift_hd</a></span>. <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_hd">forall_nprod_hd</a></span> <span class="kwd">in</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#llift_hd">llift_hd</a></span> <span class="kwd">in</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_when">ok_when</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">edestruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_eq">Ss_of_nprod_eq</a></span> <span class="id">n</span>) <span class="kwd">as</span> [<span class="id">Inf3</span> <span class="id">HH</span>]. 2: <span class="id">setoid_rewrite</span> <span class="id">HH</span> <span class="kwd">at</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#llift_tl">llift_tl</a></span>. <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_tl">forall_nprod_tl</a></span> <span class="kwd">in</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#llift_tl">llift_tl</a></span> <span class="kwd">in</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHn</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Merge&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span> <span class="kwd">as</span> [<span class="id">x</span> <span class="id">ty</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.safe_exp">safe_exp</a></span> <span class="kwd">in</span> <span class="id">Hoc</span> <span class="kwd">as</span> <span class="id">Hs</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wl_exp">wt_exp_wl_exp</a></span> <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hwl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wx_exp">wt_exp_wx_exp</a></span> <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hwx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwt</span>. <span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">inv</span> <span class="id">Hoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>, &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_concat">Forall_concat</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwl</span>. <span class="id">inv</span> <span class="id">Hwx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> _ _) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_exp">wc_exp</a></span> _ _) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span> _) <span class="id">and</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_concat">Forall_concat</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_exp">no_rte_exp</a></span> _ _ _ _ _) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_concat">Forall_concat</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_sub_expss">sem_sub_expss</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_expss">infinite_expss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Smerge_alt2">Smerge_alt2</a></span> <span class="kwd">with</span> (<span class="id">d</span>:= (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">simpl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">unshelve</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_hist_of_envs">sem_hist_of_envs</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_var_inf">denot_var_inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">es</span>; <span class="id">simpl</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">clear</span>; <span class="id">gen_inf_sub_exps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">es</span>); <span class="id">constructor</span>; <span class="id">auto</span>; <span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_length">Ss_of_nprod_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">revert</span> <span class="id">Infe</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">save_denot_exp</span> <span class="id">se</span> <span class="id">Hse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp_eq">denot_exp_eq</a></span> <span class="kwd">in</span> <span class="id">Hse</span>; <span class="id">revert</span> <span class="id">Hse</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">gen_sub_exps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect_r">eq_rect_r</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_sym">eq_sym</a></span>; <span class="id">cases</span>; <span class="id">intros</span>; <span class="id">subst</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Forall2t_lift_nprod">Forall2t_lift_nprod</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_merge">ok_merge</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Ecase&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.safe_exp">safe_exp</a></span> <span class="kwd">in</span> <span class="id">Hoc</span> <span class="kwd">as</span> <span class="id">Hs</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wl_exp">wt_exp_wl_exp</a></span> <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hwl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wx_exp">wt_exp_wx_exp</a></span> <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hwx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwt</span>. <span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">inv</span> <span class="id">Hoc</span>. <span class="comment">(*&nbsp;inv&nbsp;Hwl.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>, &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_concat">Forall_concat</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwl</span>. <span class="id">inv</span> <span class="id">Hwx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span> <span class="id">e</span>) <span class="id">and</span> <span class="id">unshelve</span> <span class="id">eapply</span> <span class="id">IHe</span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> <span class="id">He</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_exp">infinite_exp</a></span>; <span class="id">clear</span> <span class="id">IHe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> _ _) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_exp">wc_exp</a></span> _ _) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span> _) <span class="id">and</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_concat">Forall_concat</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_exp">no_rte_exp</a></span> _ _ _ _ _) <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_concat">Forall_concat</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_sub_expss">sem_sub_expss</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_expss">infinite_expss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Infe</span> <span class="comment">(*&nbsp;He&nbsp;*)</span> <span class="id">Hs</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">save_denot_exp</span> <span class="id">se</span> <span class="id">Hse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">He</span>; <span class="id">gen_infinite_exp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp_eq">denot_exp_eq</a></span> <span class="kwd">in</span> <span class="id">Hse</span>; <span class="id">revert</span> <span class="id">Hse</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">gen_sub_exps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect_r">eq_rect_r</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_sym">eq_sym</a></span>; <span class="id">cases</span>; <span class="id">intros</span>; <span class="id">subst</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ScaseTotal_alt2">ScaseTotal_alt2</a></span> <span class="kwd">with</span> (<span class="id">d</span>:= (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)) <span class="kwd">in</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_length">Ss_of_nprod_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">es</span>; <span class="id">simpl</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">clear</span>; <span class="id">revert</span> <span class="id">Inf0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_length">Ss_of_nprod_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> <span class="id">t0</span>; <span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">es</span>)); <span class="id">constructor</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_length">Ss_of_nprod_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Forall2t_lift_nprod">Forall2t_lift_nprod</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_case">ok_case</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#map_eq_nnil">map_eq_nnil</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Ecase&nbsp;défaut&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.safe_exp">safe_exp</a></span> <span class="kwd">in</span> <span class="id">Hoc</span> <span class="kwd">as</span> <span class="id">Hs</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wl_exp">wt_exp_wl_exp</a></span> <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hwl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wx_exp">wt_exp_wx_exp</a></span> <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hwx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwt</span>. <span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">inv</span> <span class="id">Hoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwl</span>. <span class="id">inv</span> <span class="id">Hwx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> _ _ <span class="id">e</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.safe_exp_">safe_exp_</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> <span class="id">HH</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_0_ext">wf_env_0_ext</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_loc">wf_env_loc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> (<span class="id">Tye</span> &amp; _&amp;_). <span class="comment">(*&nbsp;on&nbsp;en&nbsp;aura&nbsp;besoin&nbsp;pour&nbsp;prouver&nbsp;wt_streams&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span> <span class="id">e</span>) <span class="id">and</span> <span class="id">unshelve</span> <span class="id">eapply</span> <span class="id">IHe</span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> <span class="id">He</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_exp">infinite_exp</a></span>; <span class="id">clear</span> <span class="id">IHe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>, &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_concat">Forall_concat</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_id">map_id</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> _ _) <span class="kwd">in</span> <span class="id">H0</span>, <span class="id">H1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_exp">wc_exp</a></span> _ _) <span class="kwd">in</span> <span class="id">H0</span>, <span class="id">H1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>) <span class="kwd">in</span> <span class="id">H0</span>, <span class="id">H1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_exp">no_rte_exp</a></span> _ _ _ _ _) <span class="kwd">in</span> <span class="id">H0</span>, <span class="id">H1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_concat">Forall_concat</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span> <span class="kwd">in</span> <span class="id">H36</span>, <span class="id">H40</span>. <span class="comment">(*&nbsp;pour&nbsp;Forall&nbsp;wl&nbsp;&amp;&nbsp;wx...&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_concat">Forall_concat</a></span> <span class="kwd">in</span> <span class="id">H7</span>. <span class="comment">(*&nbsp;Forall&nbsp;(Forall&nbsp;restr))&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_concat">Forall_concat</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_sub_expss">sem_sub_expss</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_expss">infinite_expss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_sub_exps">sem_sub_exps</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> (<span class="id">vd</span> &amp; <span class="id">Eqvd</span> &amp; <span class="id">Semd</span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_exps">infinite_exps</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Infe</span> <span class="id">Hs</span> <span class="id">Tye</span> <span class="id">H0</span> <span class="id">Semd</span> <span class="id">Eqvd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">save_denot_exp</span> <span class="id">se</span> <span class="id">Hse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp_eq">denot_exp_eq</a></span> <span class="kwd">in</span> <span class="id">Hse</span>; <span class="id">revert</span> <span class="id">Hse</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">He</span>; <span class="id">gen_infinite_exp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">gen_sub_exps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect_r">eq_rect_r</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_sym">eq_sym</a></span>; <span class="id">cases</span>; <span class="id">try</span> <span class="id">congruence</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.length_typesof_annots">length_typesof_annots</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.annots_numstreams">annots_numstreams</a></span> <span class="kwd">in</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ScaseDefault_alt2">ScaseDefault_alt2</a></span> <span class="kwd">with</span> (<span class="id">d</span>:= (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux.absent">absent</a></span>)) <span class="kwd">in</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_length">Ss_of_nprod_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">es</span>; <span class="id">simpl</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;wt_streams&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.typeof">typeof</a></span> <span class="id">e</span> = _) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">Tye</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ty_DS_wt_stream">ty_DS_wt_stream</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;ça&nbsp;va&nbsp;virer&nbsp;un&nbsp;jour&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">Eqvd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_length">Ss_of_nprod_length</a></span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">clear</span>; <span class="id">revert</span> <span class="id">Inf0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_length">Ss_of_nprod_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> <span class="id">t0</span>; <span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">es</span>)); <span class="id">constructor</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_length">Ss_of_nprod_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span> <span class="kwd">in</span> <span class="id">Eqvd</span>. <span class="comment">(*&nbsp;pas&nbsp;normal...&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Eqvd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;ici&nbsp;on&nbsp;veut&nbsp;à&nbsp;tout&nbsp;prix&nbsp;utiliser&nbsp;Forall2t_lift_nprod,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;il&nbsp;faut&nbsp;arranger&nbsp;un&nbsp;peu&nbsp;le&nbsp;but&nbsp;pour&nbsp;qu'il&nbsp;ait&nbsp;la&nbsp;bonne&nbsp;forme&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall2t_more_col">Forall2t_more_col</a></span> _ _ (<span class="kwd">fun</span> <span class="id">ss</span> <span class="id">ds</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.case">case</a></span> _ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> _ <span class="id">ss</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ds</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_length">Ss_of_nprod_length</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FIXME:&nbsp;c'est&nbsp;horrible&nbsp;de&nbsp;devoir&nbsp;écrire&nbsp;ça&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">exists</span> <span class="id">Inf</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.EqSts">EqSts</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">t0</span> <span class="id">Inf1</span> :: <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprods">Ss_of_nprods</a></span> <span class="id">t1</span> <span class="id">Inf0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprods">Ss_of_nprods</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_cons">nprod_cons</a></span> <span class="id">t0</span> <span class="id">t1</span>) <span class="id">Inf</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="kwd">as</span> [? -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_cons">forall_nprod_cons</a></span> _ _ _ _ _ <span class="id">Inf1</span> <span class="id">Inf0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert_all</span>; <span class="id">intros</span> ??.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">es</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">cbn</span>; <span class="id">constructor</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;pourquoi&nbsp;deux&nbsp;fois&nbsp;?&nbsp;j'aimerais&nbsp;savoir&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 (<span class="id">constructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprods_eq">_Ss_of_nprods_eq</a></span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Forall2t_lift_nprod">Forall2t_lift_nprod</a></span> _ (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.scase_defv">scase_defv</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">es</span>) <span class="id">t</span>)) <span class="kwd">in</span> <span class="id">Hs</span>; <span class="id">intros</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_case_def">ok_case_def</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#map_eq_nnil">map_eq_nnil</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Eapp&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.safe_exp">safe_exp</a></span> <span class="kwd">in</span> <span class="id">Hoc</span> <span class="kwd">as</span> <span class="id">Hs</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wl_exp">wt_exp_wl_exp</a></span> <span class="kwd">in</span> <span class="id">Hwt</span> <span class="kwd">as</span> <span class="id">Hwl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwt</span>. <span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">inv</span> <span class="id">Hoc</span>. <span class="id">inv</span> <span class="id">Hwl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> _ _ = _) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> _ = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> _ _) <span class="kwd">in</span> <span class="id">H0</span>,<span class="id">H1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_exp">wc_exp</a></span> _ _) <span class="kwd">in</span> <span class="id">H0</span>,<span class="id">H1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span>) <span class="kwd">in</span> <span class="id">H0</span>,<span class="id">H1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonList2.html#Forall_impl_inside">Forall_impl_inside</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_exp">no_rte_exp</a></span> _ _ _ _ _) <span class="kwd">in</span> <span class="id">H0</span>,<span class="id">H1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_sem_Eapp">ok_sem_Eapp</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wc_env_in">wc_env_in</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="SDTOREL.ok_sem_exps">ok_sem_exps</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">env</span> <span class="id">envI</span> <span class="id">InfΓ</span> <span class="id">bsi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">bs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env">wf_env</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bs</span> <span class="id">env</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.hist_of_envs">hist_of_envs</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">InfΓ</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">Γ</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">Γ</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_exp">no_rte_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">forall</span> <span class="id">Infe</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_exp">sem_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">bs</span> <span class="id">bsi</span>) <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exp">denot_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id">e</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span>) <span class="id">Infe</span>)) <span class="id">es</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_sem_exp">ok_sem_exp</a></span>.<br/>
Qed.</div></details>
<br/>
<br/>
<div class="doc">Node semantics  </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_vars_equation">ok_vars_equation</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Γ</span> <span class="id">ins</span> (<span class="id">envI</span> <span class="id">env</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.SI">SI</a></span>) <span class="id">InfΓ</span> <span class="id">n</span> (<span class="id">np</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">n</span>) <span class="id">xs</span> <span class="id">tys</span> <span class="id">Inf</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id">ins</span> ++ <span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.HasType">HasType</a></span> <span class="id">Γ</span>) <span class="id">xs</span> <span class="id">tys</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> (<span class="id">x</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_fam">DS_fam</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.SI">SI</a></span>) <span class="id">x</span> <span class="id">env</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#list_of_nprod">list_of_nprod</a></span> <span class="id">np</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.hist_of_envs">hist_of_envs</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">InfΓ</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">np</span> <span class="id">Inf</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span> * <span class="id">Nd</span> <span class="id">Hty</span> <span class="id">Hf</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hf</span>; <span class="id">inv</span> <span class="id">Hty</span>; <span class="id">constructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup_remove_1">NoDup_remove_1</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_var_nins">sem_var_nins</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.HasType_IsVar">HasType_IsVar</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup_remove_2">NoDup_remove_2</a></span> <span class="kwd">in</span> <span class="id">Nd</span>; <span class="id">contradict</span> <span class="id">Nd</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#in_app_weak">in_app_weak</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_sem_equation">ok_sem_equation</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Γ</span> <span class="id">xs</span> <span class="id">es</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bsi</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">bs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_equation">wc_equation</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">Γ</span> (<span class="id">xs</span>,<span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_equation">wt_equation</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">Γ</span> (<span class="id">xs</span>,<span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id">ins</span> ++ <span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env">wf_env</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bs</span> <span class="id">env</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_exp">no_rte_exp</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">x</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op.value">value</a></span>)) =&gt; <span class="id">s</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> _ <span class="id">x</span> <span class="id">env</span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#list_of_nprod">list_of_nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exps">denot_exps</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id">es</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">InfΓ</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_equation">sem_equation</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.hist_of_envs">hist_of_envs</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">InfΓ</span>) (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">bs</span> <span class="id">bsi</span>) (<span class="id">xs</span>,<span class="id">es</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hr</span> <span class="id">Hwc</span> <span class="id">Hwt</span> <span class="id">Nd</span> <span class="id">Hwf</span> <span class="id">Hop</span> <span class="id">Hxs</span> ?.<br/>
&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_equation">wt_equation</a></span> _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_equation">wc_equation</a></span> _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;cas&nbsp;d'un&nbsp;appel&nbsp;dépendant&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> _ [_]) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp">wt_exp</a></span> _ _ _) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wl_exp">wt_exp_wl_exp</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> <span class="id">Hwl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">it</span>. <span class="id">inv</span> <span class="id">Hwl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_exp">no_rte_exp</a></span> _ _ _ _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_exp">restr_exp</a></span> _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> _ _ = _) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> _ = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_sem_Eapp">ok_sem_Eapp</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wc_env_in">wc_env_in</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_sem_exps">ok_sem_exps</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_length">Forall2_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;maintenant,&nbsp;les&nbsp;variables&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exps_eq">denot_exps_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_exps_nil">denot_exps_nil</a></span> <span class="kwd">in</span> <span class="id">Hxs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#list_of_nprod_app">list_of_nprod_app</a></span> <span class="kwd">in</span> <span class="id">Hxs</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hxs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_vars_equation">ok_vars_equation</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;cas&nbsp;normal&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_sem_exps">ok_sem_exps</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_sub_exps">sem_sub_exps</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">sss</span> &amp; <span class="id">Heqs</span> &amp; <span class="id">Hsem</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.Seq">Seq</a></span> <span class="kwd">with</span> <span class="id">sss</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;maintenant,&nbsp;les&nbsp;variables&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id">Heqs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_vars_equation">ok_vars_equation</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_exp">infinite_exp</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wx_exp">wt_exp_wx_exp</a></span>; <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_exp_wl_exp">wt_exp_wl_exp</a></span>; <span class="id">econstructor</span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.infinite_exps">infinite_exps</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_exp_wx_exp">wc_exp_wx_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_exp_wl_exp">wc_exp_wl_exp</a></span>. }<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_sem_blocks">ok_sem_blocks</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Γ</span> <span class="id">ins</span> (<span class="id">env</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.SI">SI</a></span>) <span class="id">envI</span> <span class="id">bsi</span> <span class="id">blks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">bs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env</span> == <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_blocks">denot_blocks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id">blks</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env">wf_env</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bs</span> <span class="id">env</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_block">restr_block</a></span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.get_defined">get_defined</a></span> <span class="id">blks</span> ++ <span class="id">ins</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_block">wt_block</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">Γ</span>) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_block">wc_block</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">Γ</span>) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_block">no_rte_block</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span>) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">InfΓ</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_block">sem_block</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.hist_of_envs">hist_of_envs</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">InfΓ</span>) (<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#S_of_DS">S_of_DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">bs</span> <span class="id">bsi</span>)) <span class="id">blks</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">env</span> <span class="id">envI</span> <span class="id">bsi</span> <span class="id">blks</span> <span class="id">bs</span> <span class="id">Henv</span> <span class="id">Hco</span> <span class="id">Hr</span> <span class="id">Ndi</span> <span class="id">Hwt</span> <span class="id">Hwc</span> <span class="id">Hoc</span> <span class="id">Inf</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.wl_block">wl_block</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span>) <span class="id">blks</span>) <span class="kwd">as</span> <span class="id">Hwl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_block_wl_block">wt_block_wl_block</a></span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.get_defined">get_defined</a></span> <span class="id">blks</span>)) <span class="kwd">as</span> <span class="id">Nd</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_weaken">NoDup_app_weaken</a></span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.denot_blocks_equs">denot_blocks_equs</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span> <span class="id">blks</span> <span class="id">Hwl</span> <span class="id">Nd</span>) <span class="kwd">as</span> <span class="id">Hb</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Hwl</span> <span class="id">Nd</span>.<br/>
&nbsp;&nbsp;<span class="id">generalize</span> <span class="id">dependent</span> <span class="id">env</span>; <span class="id">intro</span> <span class="id">env</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_blocks">denot_blocks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id">blks</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">env'</span> <span class="id">Henv</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blks</span> <span class="kwd">as</span> [| <span class="id">blk</span> <span class="id">blks</span>]; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_block">restr_block</a></span> <span class="id">blk</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_block">wc_block</a></span> _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_block">wt_block</a></span> _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_sem_equation">ok_sem_equation</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation_app_comm</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> <span class="id">Ndi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_weaken">NoDup_app_weaken</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; <span class="id">eauto</span> 1; <span class="id">simpl</span>; <span class="id">intros</span> * ?? -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">Henv</span>.<br/>
&nbsp;&nbsp;- <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Ndi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> <span class="id">Ndi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_r">NoDup_app_r</a></span> <span class="kwd">in</span> <span class="id">Ndi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHblks</span>; <span class="id">auto</span>; <span class="id">now</span> <span class="id">simpl_Forall</span>.<br/>
Qed.</div></details>
<br/>
<div class="doc">Pour pouvoir utiliser InfG, Wfg, Hnode, on considère
 * l'ajout d'un nœud en tête de G.(nodes). </div>
<span class="kwd">Lemma</span> <span class="id"><a name="SDTOREL.ok_sem_node">ok_sem_node</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.node">node</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Global">Global</a></span> <span class="id">tys</span> <span class="id">exts</span> <span class="id">nds</span>) := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Ordered_nodes">Ordered_nodes</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Global">Global</a></span> <span class="id">tys</span> <span class="id">exts</span> (<span class="id">n</span> :: <span class="id">nds</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_node">restr_node</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_node">wc_node</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_node">wt_node</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">f</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_name">n_name</a></span> <span class="id">n</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Γ</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.get_locals">get_locals</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_block">n_block</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ins</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">envI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">bs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">envn</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_node">denot_node</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">n</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ss</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">os</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) <span class="id">envn</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env">wf_env</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bs</span> <span class="id">envn</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_node">no_rte_node</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="id">ins</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.envG">envG</a></span> <span class="id">envI</span> <span class="id">envn</span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.inf_dom">inf_dom</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">envn</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">infI</span> <span class="id">infO</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node">sem_node</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.Global">Global</a></span> <span class="id">tys</span> <span class="id">exts</span> (<span class="id">n</span> :: <span class="id">nds</span>)) <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">ss</span> <span class="id">infI</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">os</span> <span class="id">infO</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;pose&nbsp;ok_sem_blocks&nbsp;car&nbsp;une&nbsp;fois&nbsp;G&nbsp;détruit,&nbsp;c'est&nbsp;impossible&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_sem_blocks">ok_sem_blocks</a></span> <span class="kwd">as</span> <span class="id">ok_sem_blocks</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node.G">G</a></span> <span class="kwd">as</span> [<span class="id">tys</span> <span class="id">exts</span> <span class="id">nds</span>].<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">n</span> <span class="id">Hord</span> <span class="id">Hr</span> <span class="id">Wc</span> <span class="id">Wt</span> ???????? <span class="id">Hco</span> <span class="id">Hoc</span> <span class="id">InfΓ</span> ??.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">Hn</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.hist_of_envs">hist_of_envs</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">envn</span> <span class="id">InfΓ</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;masque&nbsp;les&nbsp;variables&nbsp;locales&nbsp;pour&nbsp;mieux&nbsp;les&nbsp;exposer&nbsp;dans&nbsp;sem_scope&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">H</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.restrict">restrict</a></span> <span class="id">Hn</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>))).<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.Snode">Snode</a></span> <span class="kwd">with</span> (<span class="id">H</span> := <span class="id">H</span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;sem_var&nbsp;in&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">H</span> <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall2">Forall2_forall2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. { <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_length">Ss_of_nprod_length</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ?? <span class="id">k</span> ?? <span class="id">Hk</span> **; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hk'</span> : <span class="id">k</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>)) <span class="kwd">by</span> (<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span> <span class="kwd">in</span> <span class="id">Hk</span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_var_restrict">sem_var_restrict</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar_app">IsVar_app</a></span>; <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVarC">IsVarC</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.map_fst_senv_of_ins">map_fst_senv_of_ins</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_In">nth_In</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">edestruct</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_nth">Ss_of_nprod_nth</a></span> <span class="kwd">as</span> [<span class="id">Inf2</span> -&gt;]; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.errTy">errTy</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_var_ins">sem_var_ins</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_In">nth_In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar_app">IsVar_app</a></span>; <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVarC">IsVarC</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.map_fst_senv_of_ins">map_fst_senv_of_ins</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_In">nth_In</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.nth_np_of_env">nth_np_of_env</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;sem_var&nbsp;out&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">H</span> <span class="id">os</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall2">Forall2_forall2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. { <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_length">Ss_of_nprod_length</a></span>. <span class="id">now</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ?? <span class="id">k</span> ?? <span class="id">Hk</span> **; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hk'</span> : <span class="id">k</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) <span class="kwd">by</span> (<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span> <span class="kwd">in</span> <span class="id">Hk</span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_var_restrict">sem_var_restrict</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar_app">IsVar_app</a></span>; <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVarC">IsVarC</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_In">nth_In</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">edestruct</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_nth">Ss_of_nprod_nth</a></span> <span class="kwd">as</span> [<span class="id">Inf2</span> -&gt;]; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.errTy">errTy</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.sem_var_nins">sem_var_nins</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar_app">IsVar_app</a></span>; <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar_app">IsVar_app</a></span>; <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVarC">IsVarC</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_In">nth_In</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intro</span>; <span class="id">eapply</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.not_in_out">not_in_out</a></span> <span class="id">n</span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_In">nth_In</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.nth_np_of_env">nth_np_of_env</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;sem_block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sem_block_cons'</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_not_Is_node_in">find_node_not_Is_node_in</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Wc</span>. <span class="id">inv</span> <span class="id">Wt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Hr</span> <span class="kwd">as</span> [?? <span class="id">Hrtb</span> (? &amp; <span class="id">Vdc</span> &amp; <span class="id">Perm</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hrtb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_node">no_rte_node</a></span> <span class="kwd">in</span> <span class="id">Hoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_nodup">n_nodup</a></span> <span class="id">n</span>) <span class="kwd">as</span> [<span class="id">Nd</span> <span class="id">Ndl</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (_ = <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_block">n_block</a></span> <span class="id">n</span>) <span class="id">and</span> <span class="id">rewrite</span> &lt;- <span class="id">it</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_block">wt_block</a></span> _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_scope">wt_scope</a></span> _ _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_block">wc_block</a></span> _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_scope">wc_scope</a></span> _ _ _ _) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Vdc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.VarsDefinedCompScope">VarsDefinedCompScope</a></span> _ _ _) <span class="id">and</span> <span class="id">inversion_clear</span> <span class="id">it</span> <span class="kwd">as</span> [??? (?&amp; <span class="id">Vd</span> &amp; <span class="id">Perm2</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Ndl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.NoDupScope">NoDupScope</a></span> _ _ _) <span class="id">and</span> <span class="id">inversion_clear</span> <span class="id">it</span> <span class="kwd">as</span> [??????].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hdom</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.dom_lb">dom_lb</a></span> <span class="id">Hn</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">locs</span>)). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intros</span> <span class="id">y</span> <span class="id">Hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar">IsVar</a></span> <span class="id">Γ</span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">unfold</span> <span class="id">Γ</span>; <span class="id">rewrite</span> &lt;- <span class="id">it</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.IsVar_app">IsVar_app</a></span>; <span class="id">simpl</span>; <span class="id">tauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_var_In">sem_var_In</a></span>, <span class="id">sem_hist_of_envs'</span>; <span class="id">try</span> <span class="id">reflexivity</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="id">inv</span> <span class="id">Hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (_,_) _) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (?&amp; <span class="id">Hinv</span> &amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hinv</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;extrait&nbsp;les&nbsp;variables&nbsp;locales&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.Sscope">Sscope</a></span> <span class="kwd">with</span> (<span class="id">Hi'</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.restrict">restrict</a></span> <span class="id">Hn</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">locs</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;dom&nbsp;*)</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.dom_restrict">dom_restrict</a></span>, <span class="id">Hdom</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.union_restrict">union_restrict</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;vire&nbsp;péniblement&nbsp;le&nbsp;restrict&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_impl_In">Forall_impl_In</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_block">sem_block</a></span> _ <span class="id">Hn</span> _).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span> <span class="id">b</span> <span class="id">Hin</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_in_left">Forall2_in_left</a></span> <span class="kwd">in</span> <span class="id">Vd</span> <span class="kwd">as</span> (?&amp; <span class="id">Hin2</span> &amp;?); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_block_restrict">sem_block_restrict</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_block_wx_block">wt_block_wx_block</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#incl_concat">incl_concat</a></span> <span class="kwd">in</span> <span class="id">Hin2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Perm2</span>, <span class="id">Perm</span> <span class="kwd">in</span> <span class="id">Hin2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_incl_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.clocks_of_bss">clocks_of_bss</a></span> <span class="kwd">as</span> [<span class="id">Inf</span> -&gt;]; <span class="id">eauto</span> 2 <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">Γ</span> <span class="id">Γ'</span> <span class="id">Γ0</span> <span class="id">Γ'0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;simplifie&nbsp;get_locals&nbsp;partout&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> <span class="id">dependent</span> <span class="id">InfΓ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (_ = <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_block">n_block</a></span> <span class="id">n</span>) <span class="id">and</span> <span class="id">rewrite</span> &lt;- <span class="id">it</span>, &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.get_locals">get_locals</a></span> _) <span class="kwd">in</span> *; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;maintenant&nbsp;c'est&nbsp;ok&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">ok_sem_blocks</span> <span class="kwd">in</span> <span class="id">Hco</span>; <span class="id">eauto</span> 2 <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.NoDup_get_defined">NoDup_get_defined</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">envn</span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_node_eq">denot_node_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_top_block_eq">denot_top_block_eq</a></span>, &lt;- <span class="id">it</span> <span class="kwd">at</span> 1.<br/>
Qed.</div></details>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ok_node">Ok_node</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="SDTOREL._ok_global">_ok_global</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">HasCausInj</span> : <span class="kwd">forall</span> (<span class="id">Γ</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.static_env">static_env</a></span>) (<span class="id">x</span> <span class="id">cx</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>), <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.HasCaus">HasCaus</a></span> <span class="id">Γ</span> <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id">cx</span> = <span class="id">x</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_global">restr_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global">wt_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_global">no_rte_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Caus.node_causal">node_causal</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.nodes">nodes</a></span> <span class="id">G</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span> <span class="id">envI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ins</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">outs</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">os</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> <span class="id">outs</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_global">denot_global</a></span> <span class="id">G</span> <span class="id">f</span> <span class="id">envI</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.wf_ins">wf_ins</a></span> <span class="id">n</span> <span class="id">envI</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">envI</span> <span class="id">ins</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">InfI</span> <span class="id">InfO</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node">sem_node</a></span> <span class="id">G</span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">xs</span> <span class="id">InfI</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">os</span> <span class="id">InfO</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> ???? <span class="id">Rg</span> <span class="id">Wtg</span> <span class="id">Wcg</span> <span class="id">Ocg</span> <span class="id">Causg</span> ??? <span class="id">Hfind</span> ???? <span class="id">Hins</span> <span class="id">InfI</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_global">no_rte_global</a></span> <span class="kwd">in</span> <span class="id">Ocg</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Ordered_nodes">Ordered_nodes</a></span> <span class="id">G</span>) <span class="kwd">as</span> <span class="id">Hord</span>.<br/>
&nbsp;&nbsp;{ <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.wl_global_Ordered_nodes">wl_global_Ordered_nodes</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global_wl_global">wt_global_wl_global</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">SafeG</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.noerrors_prog">noerrors_prog</a></span> <span class="id">G</span> <span class="id">Wtg</span> <span class="id">Wcg</span> <span class="id">Ocg</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">Halign</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_alignLE">wf_alignLE</a></span> <span class="id">G</span> <span class="id">Rg</span>).<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_global">denot_global</a></span> <span class="id">G</span>) <span class="kwd">as</span> <span class="id">envG</span> <span class="id">eqn</span>:<span class="id">HG</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">InfG</span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">nd</span> <span class="id">envI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">nd</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">envI</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">nd</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> (<span class="id">envG</span> <span class="id">f</span> <span class="id">envI</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">nd</span>) ++ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.get_locals">get_locals</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_block">n_block</a></span> <span class="id">nd</span>)))).<br/>
&nbsp;&nbsp;{ <span class="id">subst</span> <span class="id">envG</span>. <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.denot_inf">denot_inf</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">AbsG</span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">envI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">envG</span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> <span class="id">envI</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> (<span class="id">envG</span> <span class="id">f</span> <span class="id">envI</span>)).<br/>
&nbsp;&nbsp;{ <span class="id">intros</span>; <span class="id">subst</span>;  <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Abs.abs_indep_global">abs_indep_global</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hlp</span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">X</span> <span class="id">n</span>, <span class="id">envG</span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> <span class="id">X</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> (<span class="id">envG</span> <span class="id">f</span> <span class="id">X</span>)).<br/>
&nbsp;&nbsp;{ <span class="id">intros</span>; <span class="id">subst</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lp.lp_global">lp_global</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">HenvG</span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">nd</span> <span class="id">envI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">nd</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">envG</span> <span class="id">f</span> <span class="id">envI</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_node">denot_node</a></span> <span class="id">G</span> <span class="id">nd</span> <span class="id">envG</span> <span class="id">envI</span>)).<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> * <span class="id">Hf</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_global">denot_global</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_global_eq">denot_global_eq</a></span>, <span class="id">Hf</span> <span class="kwd">at</span> 1. }<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;HenvG&nbsp;est&nbsp;tout&nbsp;ce&nbsp;qu'il&nbsp;faut&nbsp;savoir&nbsp;sur&nbsp;la&nbsp;définition&nbsp;de&nbsp;envG&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">HG</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">InfG</span> _ _ _ <span class="id">Hfind</span> <span class="id">InfI</span>) <span class="kwd">as</span> <span class="id">Infol</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.infinite_dom_app_l">infinite_dom_app_l</a></span> <span class="kwd">in</span> <span class="id">Infol</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.inf_dom_np_of_env">inf_dom_np_of_env</a></span> _ _ <span class="id">InfI</span>), (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.inf_dom_np_of_env">inf_dom_np_of_env</a></span> _ _ <span class="id">Infol</span>).<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.inf_dom_np_of_env">inf_dom_np_of_env</a></span> _ _ _) <span class="kwd">as</span> <span class="id">Infi</span> <span class="id">eqn</span>:<span class="id">HH</span>; <span class="id">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.inf_dom_np_of_env">inf_dom_np_of_env</a></span> _ _ _) <span class="kwd">as</span> <span class="id">Info</span> <span class="id">eqn</span>:<span class="id">HH</span>; <span class="id">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id">xs</span> <span class="id">os</span> <span class="kwd">in</span> <span class="id">Info</span>, <span class="id">Infi</span>.<br/>
&nbsp;&nbsp;<span class="id">generalize</span> <span class="id">dependent</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">generalize</span> <span class="id">dependent</span> <span class="id">envI</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">f</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">G</span> <span class="kwd">as</span> [<span class="id">tys</span> <span class="id">exts</span> <span class="id">nds</span>].<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">nds</span> <span class="kwd">as</span> [|<span class="id">a</span> <span class="id">nds</span>]; <span class="id">intros</span>. { <span class="id">inv</span> <span class="id">Hfind</span>. }<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#ident_eq_dec">ident_eq_dec</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_name">n_name</a></span> <span class="id">a</span>) <span class="id">f</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;cas&nbsp;du&nbsp;nœud&nbsp;courant&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="id">auto</span>; <span class="id">inv</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">os</span> <span class="id">outs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_eq">Ss_of_nprod_eq</a></span> _ <span class="id">Info</span>) <span class="kwd">as</span> [<span class="id">Inf3</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">HenvG</span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_node_cons">denot_node_cons</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_not_Is_node_in">find_node_not_Is_node_in</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global_uncons">wt_global_uncons</a></span> <span class="kwd">in</span> <span class="id">Wtg</span> <span class="kwd">as</span> <span class="id">Wtn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global_cons">wt_global_cons</a></span> <span class="kwd">in</span> <span class="id">Wtg</span> <span class="kwd">as</span> <span class="id">Wtg'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_global_uncons">wc_global_uncons</a></span> <span class="kwd">in</span> <span class="id">Wcg</span> <span class="kwd">as</span> <span class="id">Wcn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Rg</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Wcg</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Wtg</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_sem_node">ok_sem_node</a></span> <span class="kwd">in</span> <span class="id">Wtg'</span> <span class="kwd">as</span> <span class="id">Hsem</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_loc">wf_env_loc</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_0_ext">wf_env_0_ext</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.infinite_dom_app_l">infinite_dom_app_l</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id">Hsem</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_node_cons">denot_node_cons</a></span> _ <span class="id">n</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_not_Is_node_in">find_node_not_Is_node_in</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> &lt;- <span class="id">HenvG</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_loc">wf_env_loc</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_0_ext">wf_env_0_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;no_rte&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Ocg</span>. <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_node_cons">no_rte_node_cons</a></span> <span class="id">n</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_not_Is_node_in">find_node_not_Is_node_in</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;inf_dom&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.inf_dom_decomp">inf_dom_decomp</a></span> <span class="kwd">in</span> <span class="id">InfG</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.map_fst_senv_of_ins">map_fst_senv_of_ins</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;plus&nbsp;qu'à&nbsp;utiliser&nbsp;IHnds&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Causg</span>. <span class="id">inversion</span> <span class="id">Hord</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">apply</span> <span class="id">IHnds</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">clear</span> - <span class="id">Ocg</span> <span class="id">Hord</span>. <span class="id">inv</span> <span class="id">Ocg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_impl_In">Forall_impl_In</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hin</span> <span class="id">HH</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_node_cons">no_rte_node_cons</a></span> <span class="kwd">in</span> <span class="id">HH</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Ordered_nodes_nin">Ordered_nodes_nin</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">f'</span> <span class="id">ndf'</span> <span class="id">envI'</span> <span class="id">Hfind'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span> <span class="kwd">with</span> (<span class="id">nd</span> := <span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hfind'</span> <span class="kwd">as</span> ?; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HenvG</span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_node_cons">denot_node_cons</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_later_not_Is_node_in">find_node_later_not_Is_node_in</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.infinite_dom_np">infinite_dom_np</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.infinite_dom_np">infinite_dom_np</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;cas&nbsp;de&nbsp;récurrence&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_other">find_node_other</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sem_node_cons'</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHnds</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">inv</span> <span class="id">Rg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global_cons">wt_global_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_global_cons">wc_global_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">clear</span> - <span class="id">Ocg</span> <span class="id">Hord</span>. <span class="id">inv</span> <span class="id">Ocg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_impl_In">Forall_impl_In</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hin</span> <span class="id">HH</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_node_cons">no_rte_node_cons</a></span> <span class="kwd">in</span> <span class="id">HH</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Ordered_nodes_nin">Ordered_nodes_nin</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">inv</span> <span class="id">Causg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Ordered_nodes_cons">Ordered_nodes_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">f'</span> <span class="id">ndf'</span> <span class="id">envI'</span> <span class="id">Hfind'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span> <span class="kwd">with</span> (<span class="id">nd</span> := <span class="id">a</span>) <span class="kwd">in</span> <span class="id">Hfind'</span> <span class="kwd">as</span> ?; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">f'</span> <span class="id">ndf'</span> <span class="id">Hfind'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span> <span class="kwd">with</span> (<span class="id">nd</span> := <span class="id">a</span>) <span class="kwd">in</span> <span class="id">Hfind'</span> <span class="kwd">as</span> ?; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">f'</span> <span class="id">ndf'</span> <span class="id">envI'</span> <span class="id">Hfind'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span> <span class="kwd">with</span> (<span class="id">nd</span> := <span class="id">a</span>) <span class="kwd">in</span> <span class="id">Hfind'</span> <span class="kwd">as</span> ?; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">f'</span> <span class="id">ndf'</span> <span class="id">envI'</span> <span class="id">Hfind'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span> <span class="kwd">with</span> (<span class="id">nd</span> := <span class="id">a</span>) <span class="kwd">in</span> <span class="id">Hfind'</span> <span class="kwd">as</span> ?; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HenvG</span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_node_cons">denot_node_cons</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_later_not_Is_node_in">find_node_later_not_Is_node_in</a></span>.<br/>
Qed.</div></details>
<br/>
<div class="doc">Autre formulation, en fournissant un nprod plutôt qu'un environnement en entrée </div>
<span class="kwd">Corollary</span> <span class="id"><a name="SDTOREL._ok_global2">_ok_global2</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">HasCausInj</span> : <span class="kwd">forall</span> (<span class="id">Γ</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.static_env">static_env</a></span>) (<span class="id">x</span> <span class="id">cx</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>), <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.HasCaus">HasCaus</a></span> <span class="id">Γ</span> <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id">cx</span> = <span class="id">x</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_global">restr_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global">wt_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_global">no_rte_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Caus.node_causal">node_causal</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.nodes">nodes</a></span> <span class="id">G</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span> (<span class="id">ss</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ins</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.idents">idents</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">envI</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.env_of_np">env_of_np</a></span> <span class="id">ins</span> <span class="id">ss</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">os</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_global">denot_global</a></span> <span class="id">G</span> <span class="id">f</span> <span class="id">envI</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">bs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.wf_ins">wf_ins</a></span> <span class="id">n</span> <span class="id">envI</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">InfSs</span> <span class="id">InfO</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node">sem_node</a></span> <span class="id">G</span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">ss</span> <span class="id">InfSs</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">os</span> <span class="id">InfO</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> ???? <span class="id">Rg</span> <span class="id">Wtg</span> <span class="id">Wcg</span> <span class="id">Ocg</span> <span class="id">Causg</span> ??? <span class="id">Hfind</span> ???? <span class="id">Hins</span> ??.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._ok_global">_ok_global</a></span> <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hsem</span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.inf_dom_env_of_np">inf_dom_env_of_np</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node_morph">sem_node_morph</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">envI</span> <span class="id">os</span> <span class="id">ins</span>; <span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">generalize</span> <span class="id">dependent</span> <span class="id">ss</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span>).<br/>
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env_of_np">np_of_env_of_np</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_ingt0">n_ingt0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_nodup">n_nodup</a></span> <span class="id">n</span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_weaken">NoDup_app_weaken</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="SDTOREL.wf_inputs">wf_inputs</a></span><br/>
&nbsp;&nbsp;{<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">n</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.node">node</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>) {<span class="id">m</span>} (<span class="id">ss</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">m</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ins</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.idents">idents</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">envI</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.env_of_np">env_of_np</a></span> <span class="id">ins</span> <span class="id">ss</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">bs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Γ</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">m</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;/\  <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env">wf_env</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bs</span> 0.<br/>
<br/>
<div class="doc">Witness of the relational semantics </div>
<span class="kwd">Theorem</span> <span class="id"><a name="SDTOREL.ok_global">ok_global</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">HasCausInj</span> : <span class="kwd">forall</span> (<span class="id">Γ</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.static_env">static_env</a></span>) (<span class="id">x</span> <span class="id">cx</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>), <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.HasCaus">HasCaus</a></span> <span class="id">Γ</span> <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id">cx</span> = <span class="id">x</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_global">restr_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global">wt_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ckop.check_global">check_global</a></span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Caus.node_causal">node_causal</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.nodes">nodes</a></span> <span class="id">G</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">m</span>) <span class="id">InfXs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.wf_inputs">wf_inputs</a></span> <span class="id">n</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">os</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> ((<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)))) <span class="id">InfO</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node">sem_node</a></span> <span class="id">G</span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">xs</span> <span class="id">InfXs</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">os</span> <span class="id">InfO</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> ???? <span class="id">Hr</span> <span class="id">Hwt</span> <span class="id">Hwc</span> <span class="id">Hoc</span> <span class="id">Hcaus</span> <span class="id">Hfind</span> ????? <span class="id">Hins</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.check_global_ok">check_global_ok</a></span> <span class="kwd">in</span> <span class="id">Hoc</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hins</span> <span class="kwd">as</span> [? <span class="id">Hwf</span>]; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._ok_global2">_ok_global2</a></span> <span class="kwd">with</span> (<span class="id">InfSs</span> := <span class="id">InfXs</span>) <span class="kwd">in</span> <span class="id">Hwf</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.inf_dom_np_of_env">inf_dom_np_of_env</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.infinite_dom_app_l">infinite_dom_app_l</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.denot_inf">denot_inf</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.inf_dom_env_of_np">inf_dom_env_of_np</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.decl">decl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)); <span class="id">eauto</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<h2> the same theorems but with the weaker <span class="bracket"><span class="id">no_rte_node_main</span></span> hypothesis </h2>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="SDTOREL._ok_global_main">_ok_global_main</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">HasCausInj</span> : <span class="kwd">forall</span> (<span class="id">Γ</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.static_env">static_env</a></span>) (<span class="id">x</span> <span class="id">cx</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>), <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.HasCaus">HasCaus</a></span> <span class="id">Γ</span> <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id">cx</span> = <span class="id">x</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_global">restr_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global">wt_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Caus.node_causal">node_causal</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.nodes">nodes</a></span> <span class="id">G</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span> <span class="id">envI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_global_main">no_rte_global_main</a></span> <span class="id">G</span> <span class="id">f</span> <span class="id">envI</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ins</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">outs</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">os</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> <span class="id">outs</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_global">denot_global</a></span> <span class="id">G</span> <span class="id">f</span> <span class="id">envI</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.wf_ins">wf_ins</a></span> <span class="id">n</span> <span class="id">envI</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">envI</span> <span class="id">ins</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">InfI</span> <span class="id">InfO</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node">sem_node</a></span> <span class="id">G</span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">xs</span> <span class="id">InfI</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">os</span> <span class="id">InfO</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> ???? <span class="id">Rg</span> <span class="id">Wtg</span> <span class="id">Wcg</span> <span class="id">Causg</span> ??? <span class="id">Norte</span> <span class="id">Hfind</span> ???? <span class="id">Hins</span> <span class="id">InfI</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Ordered_nodes">Ordered_nodes</a></span> <span class="id">G</span>) <span class="kwd">as</span> <span class="id">Hord</span>.<br/>
&nbsp;&nbsp;{ <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.wl_global_Ordered_nodes">wl_global_Ordered_nodes</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global_wl_global">wt_global_wl_global</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_global_main">no_rte_global_main</a></span> <span class="kwd">in</span> <span class="id">Norte</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">Halign</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_alignLE">wf_alignLE</a></span> <span class="id">G</span> <span class="id">Rg</span>).<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_global">denot_global</a></span> <span class="id">G</span>) <span class="kwd">as</span> <span class="id">envG</span> <span class="id">eqn</span>:<span class="id">HG</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">InfG</span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">nd</span> <span class="id">envI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">nd</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">envI</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">nd</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> (<span class="id">envG</span> <span class="id">f</span> <span class="id">envI</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">nd</span>) ++ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.get_locals">get_locals</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_block">n_block</a></span> <span class="id">nd</span>)))).<br/>
&nbsp;&nbsp;{ <span class="id">subst</span> <span class="id">envG</span>. <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.denot_inf">denot_inf</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">AbsG</span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">envI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">envG</span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> <span class="id">envI</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> (<span class="id">envG</span> <span class="id">f</span> <span class="id">envI</span>)).<br/>
&nbsp;&nbsp;{ <span class="id">intros</span>; <span class="id">subst</span>;  <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Abs.abs_indep_global">abs_indep_global</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hlp</span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">X</span> <span class="id">n</span>, <span class="id">envG</span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> <span class="id">X</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> (<span class="id">envG</span> <span class="id">f</span> <span class="id">X</span>)).<br/>
&nbsp;&nbsp;{ <span class="id">intros</span>; <span class="id">subst</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lp.lp_global">lp_global</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">HenvG</span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">nd</span> <span class="id">envI</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">nd</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">envG</span> <span class="id">f</span> <span class="id">envI</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> _ (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_node">denot_node</a></span> <span class="id">G</span> <span class="id">nd</span> <span class="id">envG</span> <span class="id">envI</span>)).<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> * <span class="id">Hf</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_global">denot_global</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_global_eq">denot_global_eq</a></span>, <span class="id">Hf</span> <span class="kwd">at</span> 1. }<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;HenvG&nbsp;est&nbsp;tout&nbsp;ce&nbsp;qu'il&nbsp;faut&nbsp;savoir&nbsp;sur&nbsp;la&nbsp;définition&nbsp;de&nbsp;envG&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">HG</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">InfG</span> _ _ _ <span class="id">Hfind</span> <span class="id">InfI</span>) <span class="kwd">as</span> <span class="id">Infol</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.infinite_dom_app_l">infinite_dom_app_l</a></span> <span class="kwd">in</span> <span class="id">Infol</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.inf_dom_np_of_env">inf_dom_np_of_env</a></span> _ _ <span class="id">InfI</span>), (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.inf_dom_np_of_env">inf_dom_np_of_env</a></span> _ _ <span class="id">Infol</span>).<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.inf_dom_np_of_env">inf_dom_np_of_env</a></span> _ _ _) <span class="kwd">as</span> <span class="id">Infi</span> <span class="id">eqn</span>:<span class="id">HH</span>; <span class="id">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.inf_dom_np_of_env">inf_dom_np_of_env</a></span> _ _ _) <span class="kwd">as</span> <span class="id">Info</span> <span class="id">eqn</span>:<span class="id">HH</span>; <span class="id">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id">xs</span> <span class="id">os</span> <span class="kwd">in</span> <span class="id">Info</span>, <span class="id">Infi</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;renforce&nbsp;le&nbsp;but&nbsp;en&nbsp;prouvant&nbsp;conjointement&nbsp;safe&nbsp;&amp;&nbsp;sem_node&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;c'est&nbsp;la&nbsp;seule&nbsp;façon&nbsp;que&nbsp;j'ai&nbsp;trouvée.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Impossible&nbsp;d'utiliser&nbsp;[noerrors_prog_main]...&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hins</span> <span class="id">InfI</span> <span class="id">Infol</span> <span class="id">Infi</span> <span class="id">Info</span>. <span class="id">revert</span> <span class="id">xs</span> <span class="id">os</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">B</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Γ</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.get_locals">get_locals</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_block">n_block</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span> &lt;= <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env">wf_env</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bs</span> 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env">wf_env</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bs</span> (<span class="id">envG</span> <span class="id">f</span> <span class="id">envI</span>))).<br/>
&nbsp;&nbsp;<span class="id">generalize</span> <span class="id">dependent</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">generalize</span> <span class="id">dependent</span> <span class="id">envI</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">f</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">G</span> <span class="kwd">as</span> [<span class="id">tys</span> <span class="id">exts</span> <span class="id">nds</span>].<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">nds</span> <span class="kwd">as</span> [|<span class="id">a</span> <span class="id">nds</span>]; <span class="id">intros</span>. { <span class="id">inv</span> <span class="id">Hfind</span>. }<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#ident_eq_dec">ident_eq_dec</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_name">n_name</a></span> <span class="id">a</span>) <span class="id">f</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;cas&nbsp;du&nbsp;nœud&nbsp;courant&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="id">auto</span>; <span class="id">inv</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hsafe</span>:<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">bs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Γ</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.get_locals">get_locals</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_block">n_block</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span> &lt;= <span class="id">bs</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env">wf_env</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bs</span> 0 -&gt; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env">wf_env</a></span> <span class="id">Γ</span> <span class="id">ins</span> <span class="id">envI</span> <span class="id">bs</span> (<span class="id">envG</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_name">n_name</a></span> <span class="id">n</span>) <span class="id">envI</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;wf_env&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global_uncons">wt_global_uncons</a></span> <span class="kwd">in</span> <span class="id">Wtg</span> <span class="kwd">as</span> <span class="id">Wtn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global_cons">wt_global_cons</a></span> <span class="kwd">in</span> <span class="id">Wtg</span> <span class="kwd">as</span> <span class="id">Wtg'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_global_uncons">wc_global_uncons</a></span> <span class="kwd">in</span> <span class="id">Wcg</span> <span class="kwd">as</span> <span class="id">Wcn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Rg</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Wcg</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Wtg</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">bs</span> <span class="id">Γ</span> <span class="id">Hbs</span> <span class="id">Hins_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;même&nbsp;preuve&nbsp;que&nbsp;noerrors_prog_main&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Norte</span> <span class="kwd">as</span> [|?? <span class="id">Hoc</span> <span class="id">Hocs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#ident_eqb_refl">ident_eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Hoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hoc</span>. <span class="id">fold</span> <span class="id">ins</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HenvG</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_node_cons">denot_node_cons</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_not_Is_node_in">find_node_not_Is_node_in</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#FIXP_fixp">FIXP_fixp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">Hoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_node_cons">no_rte_node_cons</a></span> <span class="kwd">in</span> <span class="id">Hoc</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_not_Is_node_in">find_node_not_Is_node_in</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.fixp_inv2_le">fixp_inv2_le</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Q</span> := <span class="kwd">fun</span> <span class="id">env</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_node">no_rte_node</a></span> {| <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.types">types</a></span> := <span class="id">tys</span>; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.externs">externs</a></span> := <span class="id">exts</span>; <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.nodes">nodes</a></span> := <span class="id">nds</span> |} <span class="id">ins</span> <span class="id">envG</span> <span class="id">envI</span> <span class="id">env</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_admissible">wf_env_admissible</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.oc_node_admissible_rev">oc_node_admissible_rev</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_0_ext">wf_env_0_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">env</span> <span class="id">Hsafe</span> <span class="id">Hl</span> <span class="id">Hoc2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Ordered_nodes_cons">Ordered_nodes_cons</a></span> <span class="kwd">in</span> <span class="id">Hord</span> <span class="kwd">as</span> <span class="id">Hord'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;apply&nbsp;wt_global_cons&nbsp;in&nbsp;Wtg&nbsp;as&nbsp;Wtg'.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Wtg</span> <span class="kwd">as</span> [? <span class="id">Wtp</span>] <span class="id">eqn</span>:<span class="id">HH</span>; <span class="id">clear</span> <span class="id">HH</span>. <span class="comment">(*&nbsp;trouver&nbsp;un&nbsp;autre&nbsp;moyen&nbsp;de&nbsp;garder&nbsp;Wtg&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Wcg</span>. <span class="id">inv</span> <span class="id">Wtp</span>. <span class="id">inv</span> <span class="id">Rg</span>. <span class="id">inv</span> <span class="id">Causg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.safe_node">safe_node</a></span>; <span class="id">auto</span>; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;reste&nbsp;l'hypothèse&nbsp;de&nbsp;récurrence&nbsp;sur&nbsp;les&nbsp;nœuds&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">f2</span> <span class="id">n2</span> <span class="id">Hfind</span> ?? <span class="id">bs2</span> <span class="id">envI2</span> <span class="id">Hbs2</span> <span class="id">Hins2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_loc">wf_env_loc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHnds</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_0_ext">wf_env_0_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Halign</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">InfG</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;montrons&nbsp;que&nbsp;HenvG&nbsp;tient&nbsp;toujours&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">f'</span> <span class="id">ndf'</span> <span class="id">envI'</span> <span class="id">Hfind'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span> <span class="kwd">with</span> (<span class="id">nd</span> := <span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hfind'</span> <span class="kwd">as</span> ?; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HenvG</span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_node_cons">denot_node_cons</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_later_not_Is_node_in">find_node_later_not_Is_node_in</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;montrons&nbsp;que&nbsp;no_rte&nbsp;tient&nbsp;toujours&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.nodes">nodes</a></span> _).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_node">wc_node</a></span> _ _ /\ _) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [? <span class="id">Hnn</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">Hocs</span> <span class="id">Hnn</span> <span class="id">Hord</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#ident_eqb_neq">ident_eqb_neq</a></span>, <span class="id"><a href="Velus.Common.Common.html#ident_eqb_sym">ident_eqb_sym</a></span> <span class="kwd">in</span> <span class="id">Hnn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hnn</span> <span class="kwd">in</span> <span class="id">Hocs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">intros</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_node_cons">no_rte_node_cons</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Ordered_nodes_nin">Ordered_nodes_nin</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;sem_node&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">os</span> <span class="id">outs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod_eq">Ss_of_nprod_eq</a></span> _ <span class="id">Info</span>) <span class="kwd">as</span> [<span class="id">Inf3</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">HenvG</span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_node_cons">denot_node_cons</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_not_Is_node_in">find_node_not_Is_node_in</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global_uncons">wt_global_uncons</a></span> <span class="kwd">in</span> <span class="id">Wtg</span> <span class="kwd">as</span> <span class="id">Wtn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global_cons">wt_global_cons</a></span> <span class="kwd">in</span> <span class="id">Wtg</span> <span class="kwd">as</span> <span class="id">Wtg'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_global_uncons">wc_global_uncons</a></span> <span class="kwd">in</span> <span class="id">Wcg</span> <span class="kwd">as</span> <span class="id">Wcn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Rg</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Wcg</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Wtg</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_node">wc_node</a></span> _ _ /\ _) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [? <span class="id">Hnname</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.ok_sem_node">ok_sem_node</a></span> <span class="kwd">in</span> <span class="id">Wtg'</span> <span class="kwd">as</span> <span class="id">Hsem</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_loc">wf_env_loc</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_0_ext">wf_env_0_ext</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.infinite_dom_app_l">infinite_dom_app_l</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id">Hsem</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_node_cons">denot_node_cons</a></span> _ <span class="id">n</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_not_Is_node_in">find_node_not_Is_node_in</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> &lt;- <span class="id">HenvG</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;wf_env&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.wf_ins">wf_ins</a></span> <span class="kwd">in</span> <span class="id">Hins</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Hsafe</span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe.wf_env_0_ext">wf_env_0_ext</a></span>, <span class="id">Hins</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;no_rte&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Norte</span> <span class="kwd">as</span> [|?? <span class="id">Nort</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#ident_eqb_refl">ident_eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Nort</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_node_cons">no_rte_node_cons</a></span> <span class="id">n</span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_not_Is_node_in">find_node_not_Is_node_in</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;inf_dom&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.inf_dom_decomp">inf_dom_decomp</a></span> <span class="kwd">in</span> <span class="id">InfG</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_now">find_node_now</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.map_fst_senv_of_ins">map_fst_senv_of_ins</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;wf_env&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Causg</span>. <span class="id">inversion</span> <span class="id">Hord</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">f'</span> <span class="id">n'</span> <span class="id">envI'</span> <span class="id">Hfind'</span> <span class="id">ins'</span> <span class="id">Γ'</span> <span class="id">bs'</span> <span class="id">Hbs'</span> <span class="id">Hins'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHnds</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">f''</span> <span class="id">ndf''</span> <span class="id">envI''</span> <span class="id">Hfind''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span> <span class="kwd">with</span> (<span class="id">nd</span> := <span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hfind''</span> <span class="kwd">as</span> ?; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HenvG</span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_node_cons">denot_node_cons</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_later_not_Is_node_in">find_node_later_not_Is_node_in</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inversion_clear</span> <span class="id">Norte</span> <span class="kwd">as</span> [|?? <span class="id">Hoc</span> <span class="id">Hocs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">Hocs</span> <span class="id">Hnname</span> <span class="id">Hord</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#ident_eqb_neq">ident_eqb_neq</a></span>, <span class="id"><a href="Velus.Common.Common.html#ident_eqb_sym">ident_eqb_sym</a></span> <span class="kwd">in</span> <span class="id">Hnname</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hnname</span> <span class="kwd">in</span> <span class="id">Hocs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">intros</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_node_cons">no_rte_node_cons</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Ordered_nodes_nin">Ordered_nodes_nin</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;plus&nbsp;qu'à&nbsp;utiliser&nbsp;IHnds&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Causg</span>. <span class="id">inversion</span> <span class="id">Hord</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">apply</span> <span class="id">IHnds</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">f'</span> <span class="id">ndf'</span> <span class="id">envI'</span> <span class="id">Hfind'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span> <span class="kwd">with</span> (<span class="id">nd</span> := <span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hfind'</span> <span class="kwd">as</span> ?; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HenvG</span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_node_cons">denot_node_cons</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_later_not_Is_node_in">find_node_later_not_Is_node_in</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inversion_clear</span> <span class="id">Norte</span> <span class="kwd">as</span> [|?? <span class="id">Hoc</span> <span class="id">Hocs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">Hocs</span> <span class="id">Hnname</span> <span class="id">Hord</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#ident_eqb_neq">ident_eqb_neq</a></span>, <span class="id"><a href="Velus.Common.Common.html#ident_eqb_sym">ident_eqb_sym</a></span> <span class="kwd">in</span> <span class="id">Hnname</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hnname</span> <span class="kwd">in</span> <span class="id">Hocs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">intros</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_node_cons">no_rte_node_cons</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Ordered_nodes_nin">Ordered_nodes_nin</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.infinite_dom_np">infinite_dom_np</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.infinite_dom_np">infinite_dom_np</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;cas&nbsp;de&nbsp;récurrence&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node_other">find_node_other</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;sem_node&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sem_node_cons'</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHnds</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">inv</span> <span class="id">Rg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global_cons">wt_global_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_global_cons">wc_global_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">inv</span> <span class="id">Causg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Ordered_nodes_cons">Ordered_nodes_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">f'</span> <span class="id">ndf'</span> <span class="id">Hfind'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span> <span class="kwd">with</span> (<span class="id">nd</span> := <span class="id">a</span>) <span class="kwd">in</span> <span class="id">Hfind'</span> <span class="kwd">as</span> ?; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">f'</span> <span class="id">ndf'</span> <span class="id">envI'</span> <span class="id">Hfind'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span> <span class="kwd">with</span> (<span class="id">nd</span> := <span class="id">a</span>) <span class="kwd">in</span> <span class="id">Hfind'</span> <span class="kwd">as</span> ?; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">f'</span> <span class="id">ndf'</span> <span class="id">envI'</span> <span class="id">Hfind'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span> <span class="kwd">with</span> (<span class="id">nd</span> := <span class="id">a</span>) <span class="kwd">in</span> <span class="id">Hfind'</span> <span class="kwd">as</span> ?; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HenvG</span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_node_cons">denot_node_cons</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_later_not_Is_node_in">find_node_later_not_Is_node_in</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">clear</span> - <span class="id">Norte</span> <span class="id">Hord</span>. <span class="id">inv</span> <span class="id">Norte</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_impl_In">Forall_impl_In</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">Hin</span> <span class="id">HH</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">intros</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_node_cons">no_rte_node_cons</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Ordered_nodes_nin">Ordered_nodes_nin</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;wf_env&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHnds</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">inv</span> <span class="id">Rg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global_cons">wt_global_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_global_cons">wc_global_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">inv</span> <span class="id">Causg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Ordered_nodes_cons">Ordered_nodes_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">f'</span> <span class="id">ndf'</span> <span class="id">Hfind'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span> <span class="kwd">with</span> (<span class="id">nd</span> := <span class="id">a</span>) <span class="kwd">in</span> <span class="id">Hfind'</span> <span class="kwd">as</span> ?; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">f'</span> <span class="id">ndf'</span> <span class="id">envI'</span> <span class="id">Hfind'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span> <span class="kwd">with</span> (<span class="id">nd</span> := <span class="id">a</span>) <span class="kwd">in</span> <span class="id">Hfind'</span> <span class="kwd">as</span> ?; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">f'</span> <span class="id">ndf'</span> <span class="id">envI'</span> <span class="id">Hfind'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_uncons">find_node_uncons</a></span> <span class="kwd">with</span> (<span class="id">nd</span> := <span class="id">a</span>) <span class="kwd">in</span> <span class="id">Hfind'</span> <span class="kwd">as</span> ?; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HenvG</span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_node_cons">denot_node_cons</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.find_node_later_not_Is_node_in">find_node_later_not_Is_node_in</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">clear</span> - <span class="id">Norte</span> <span class="id">Hord</span>. <span class="id">inv</span> <span class="id">Norte</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_impl_In">Forall_impl_In</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">Hin</span> <span class="id">HH</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">intros</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_node_cons">no_rte_node_cons</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord.Ordered_nodes_nin">Ordered_nodes_nin</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
Qed.</div></details>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="SDTOREL._ok_global_main2">_ok_global_main2</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">HasCausInj</span> : <span class="kwd">forall</span> (<span class="id">Γ</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.static_env">static_env</a></span>) (<span class="id">x</span> <span class="id">cx</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>), <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.HasCaus">HasCaus</a></span> <span class="id">Γ</span> <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id">cx</span> = <span class="id">x</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_global">restr_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global">wt_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Caus.node_causal">node_causal</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.nodes">nodes</a></span> <span class="id">G</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span> (<span class="id">ss</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ins</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.idents">idents</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_global_main">no_rte_global_main</a></span> <span class="id">G</span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.env_of_np">env_of_np</a></span> <span class="id">ins</span> <span class="id">ss</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">envI</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.env_of_np">env_of_np</a></span> <span class="id">ins</span> <span class="id">ss</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">os</span> := <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env">np_of_env</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.denot_global">denot_global</a></span> <span class="id">G</span> <span class="id">f</span> <span class="id">envI</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">bs</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">ins</span> <span class="id">envI</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.wf_ins">wf_ins</a></span> <span class="id">n</span> <span class="id">envI</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">InfSs</span> <span class="id">InfO</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node">sem_node</a></span> <span class="id">G</span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">ss</span> <span class="id">InfSs</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">os</span> <span class="id">InfO</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> ???? <span class="id">Rg</span> <span class="id">Wtg</span> <span class="id">Wcg</span> <span class="id">Causg</span> ???? <span class="id">Norte</span> <span class="id">Hfind</span> ??? <span class="id">Hins</span> ??.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._ok_global_main">_ok_global_main</a></span> <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hsem</span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.inf_dom_env_of_np">inf_dom_env_of_np</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node_morph">sem_node_morph</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">envI</span> <span class="id">os</span> <span class="id">ins</span>; <span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">generalize</span> <span class="id">dependent</span> <span class="id">ss</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span>).<br/>
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._Ss_of_nprod_eq">_Ss_of_nprod_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.np_of_env_of_np">np_of_env_of_np</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_ingt0">n_ingt0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_nodup">n_nodup</a></span> <span class="id">n</span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_weaken">NoDup_app_weaken</a></span>.<br/>
Qed.</div></details>
<br/>
<br/>
<div class="doc">Witness of the relational semantics </div>
<span class="kwd">Theorem</span> <span class="id"><a name="SDTOREL.ok_global_main">ok_global_main</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">HasCausInj</span> : <span class="kwd">forall</span> (<span class="id">Γ</span> : <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.static_env">static_env</a></span>) (<span class="id">x</span> <span class="id">cx</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>), <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv.HasCaus">HasCaus</a></span> <span class="id">Γ</span> <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id">cx</span> = <span class="id">x</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">PSyn</span> <span class="id">Prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">Prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr.restr_global">restr_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ.wt_global">wt_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Caus.node_causal">node_causal</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.nodes">nodes</a></span> <span class="id">G</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> <span class="id">m</span>) <span class="id">InfXs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr.no_rte_global_main">no_rte_global_main</a></span> <span class="id">G</span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.env_of_np">env_of_np</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_in">n_in</a></span> <span class="id">n</span>)) <span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.wf_inputs">wf_inputs</a></span> <span class="id">n</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">os</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> ((<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)))) <span class="id">InfO</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem.sem_node">sem_node</a></span> <span class="id">G</span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">xs</span> <span class="id">InfXs</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.Ss_of_nprod">Ss_of_nprod</a></span> <span class="id">os</span> <span class="id">InfO</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> ???? <span class="id">Hr</span> <span class="id">Hwt</span> <span class="id">Hwc</span> <span class="id">Hcaus</span> <span class="id">Hfind</span> ????? <span class="id">Hoc</span> <span class="id">Hins</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hins</span> <span class="kwd">as</span> [? <span class="id">Hwf</span>]; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">unshelve</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL._ok_global_main2">_ok_global_main2</a></span> <span class="kwd">with</span> (<span class="id">InfSs</span> := <span class="id">InfXs</span>) <span class="kwd">in</span> <span class="id">Hwf</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den.inf_dom_np_of_env">inf_dom_np_of_env</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL.infinite_dom_app_l">infinite_dom_app_l</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.denot_inf">denot_inf</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf.inf_dom_env_of_np">inf_dom_env_of_np</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.decl">decl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)); <span class="id">eauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL">SDTOREL</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="SdtorelFun">SdtorelFun</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Ids</span>   : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Op</span>    : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Cks</span>   : <span class="id"><a href="Velus.Clocks.html#CLOCKS">CLOCKS</a></span>        <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Senv</span>  : <span class="id"><a href="Velus.Lustre.StaticEnv.html#STATICENV">STATICENV</a></span>     <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Syn</span>   : <span class="id"><a href="Velus.Lustre.LSyntax.html#LSYNTAX">LSYNTAX</a></span>       <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Typ</span>   : <span class="id"><a href="Velus.Lustre.LTyping.html#LTYPING">LTYPING</a></span>       <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Cl</span>    : <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING">LCLOCKING</a></span>     <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Caus</span>  : <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY">LCAUSALITY</a></span>    <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Lord</span>  : <span class="id"><a href="Velus.Lustre.LOrdered.html#LORDERED">LORDERED</a></span>      <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Str</span>   : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS">COINDSTREAMS</a></span>  <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Sem</span>   : <span class="id"><a href="Velus.Lustre.LSemantics.html#LSEMANTICS">LSEMANTICS</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str">Str</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Den</span>   : <span class="id"><a href="Velus.Lustre.Denot.SD.html#SD">SD</a></span>         <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord">Lord</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Restr</span> : <span class="id"><a href="Velus.Lustre.Denot.Restr.html#LRESTR">LRESTR</a></span>     <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Inf</span>   : <span class="id"><a href="Velus.Lustre.Denot.InftyProof.html#LDENOTINF">LDENOTINF</a></span>  <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ">Typ</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Caus">Caus</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr">Restr</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den">Den</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Ckop</span>  : <span class="id"><a href="Velus.Lustre.Denot.CheckOp.html#CHECKOP">CHECKOP</a></span>       <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">OpErr</span> : <span class="id"><a href="Velus.Lustre.Denot.OpErr.html#OP_ERR">OP_ERR</a></span>        <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ">Typ</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr">Restr</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den">Den</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ckop">Ckop</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Safe</span>  : <span class="id"><a href="Velus.Lustre.Denot.Safe.html#LDENOTSAFE">LDENOTSAFE</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ">Typ</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr">Restr</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl">Cl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den">Den</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ckop">Ckop</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr">OpErr</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Abs</span>   : <span class="id"><a href="Velus.Lustre.Denot.Abs.html#ABS_INDEP">ABS_INDEP</a></span>  <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ">Typ</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den">Den</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Lp</span>    : <span class="id"><a href="Velus.Lustre.Denot.Lp.html#LP">LP</a></span>         <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ">Typ</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den">Den</a></span>)<br/>
&lt;: <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL">SDTOREL</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ">Typ</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl">Cl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Caus">Caus</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str">Str</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem">Sem</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den">Den</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr">Restr</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf">Inf</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ckop">Ckop</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr">OpErr</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe">Safe</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Abs">Abs</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lp">Lp</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Include</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SDTOREL">SDTOREL</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Typ">Typ</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Cl">Cl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Caus">Caus</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Str">Str</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Sem">Sem</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Den">Den</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Restr">Restr</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Inf">Inf</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Ckop">Ckop</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#OpErr">OpErr</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Safe">Safe</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Abs">Abs</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#Lp">Lp</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDtoRel.html#SdtorelFun">SdtorelFun</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
