
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module NLCorrectness</title>
<meta name="description" content="Documentation of Coq module NLCorrectness" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
</head>

<body>
<h1 class="title">Module NLCorrectness</h1>
<div class="coq">
<div class="doc">The old correctness lemma, starting from NLustre </div>
<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html">common.Errors</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html">common.Events</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Behaviors.html">common.Behaviors</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html">cfrontend.Clight</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.ClightBigstep.html">cfrontend.ClightBigstep</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html">lib.Integers</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html">driver.Compiler</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.CommonTyping.html">CommonTyping</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Ident.html">Ident</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.CoindStreams.html">CoindStreams</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Generation.html">ObcToClight.Generation</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Traces.html">Traces</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.ClightToAsm.html">ClightToAsm</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Correctness.html">ObcToClight.Correctness</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html">ObcToClight.Interface</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Instantiator.html">Instantiator</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Velus.html">Velus</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.Instantiator.html#Stc.Syn">Stc.Syn</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.Instantiator.html#NL">NL</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn">Obc.Syn</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem">Obc.Sem</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ">Obc.Typ</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Equ">Obc.Equ</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def">Obc.Def</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus">Obc.Fus</a></span> <span class="id"><a href="Velus.Obc.Fusion.html">Fusion</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.SwN">Obc.SwN</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.DCE">Obc.DCE</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.Instantiator.html#Stc2ObcInvariants">Stc2ObcInvariants</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#IStr">IStr</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#CStr">CStr</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.Instantiator.html#CIStr">CIStr</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux">OpAux</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op">Op</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Strings.String.html">String</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#ListNotations">List.ListNotations</a></span>.<br/>
<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">error_monad_scope</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">stream_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_well_sch_error">is_well_sch_error</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">G</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id"><a href="Velus.Velus.html#is_well_sch_system">is_well_sch_system</a></span> <span class="id">G</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> <span class="id">e</span>) = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> <span class="id">e</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">G</span> <span class="kwd">as</span> [|<span class="id">n</span> <span class="id">G</span>]; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_well_sch_program">is_well_sch_program</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id"><a href="Velus.Velus.html#is_well_sch_system">is_well_sch_system</a></span> <span class="id">P</span>.(<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.systems">Stc.Syn.systems</a></span>) (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#Stc.Wdef.Well_scheduled">Stc.Wdef.Well_scheduled</a></span> <span class="id">P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Instantiator.html#Stc.Wdef.Well_scheduled">Stc.Wdef.Well_scheduled</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intro</span>; <span class="id">induction</span> (<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.systems">Stc.Syn.systems</a></span> <span class="id">P</span>) <span class="kwd">as</span> [|<span class="id">s</span>]; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">intro</span> <span class="id">Fold</span>.<br/>
&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Instantiator.html#Stc.SchV.Is_well_sch_by_refl">Stc.SchV.Is_well_sch_by_refl</a></span> <span class="kwd">in</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.NLCorrectness.html#is_well_sch_error">is_well_sch_error</a></span> <span class="kwd">in</span> <span class="id">Fold</span>; <span class="id">discriminate</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="wt_streams">wt_streams</a></span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.value">value</a></span>) -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span>) -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">xt</span> =&gt; <span class="id"><a href="Velus.Common.CommonStreams.html#SForall">SForall</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.wt_value">wt_value</a></span> <span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">xt</span>)) <span class="id">s</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="wt_streams_spec">wt_streams_spec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vss</span> <span class="id">xts</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#wt_streams">wt_streams</a></span> <span class="id">vss</span> <span class="id">xts</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.wt_values">wt_values</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id">vss</span> <span class="id">n</span>) <span class="id">xts</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.wt_values">wt_values</a></span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">WTs</span> <span class="id">n</span>; <span class="id">generalize</span> <span class="id">dependent</span> <span class="id">vss</span>; <span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams_hd">tr_Streams_hd</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">WTs</span> <span class="kwd">as</span> [|???? <span class="id">WT</span>]; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WT</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams_tl">tr_Streams_tl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">WTs</span>; <span class="id">induction</span> <span class="id">WTs</span> <span class="kwd">as</span> [|???? <span class="id">WT</span>]; <span class="id">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WT</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span> <span class="id">WTs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#wt_streams">wt_streams</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> <span class="id">dependent</span> <span class="id">vss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">xts</span>, <span class="id">vss</span>; <span class="id">intros</span>; <span class="id">try</span> <span class="id">now</span> (<span class="id">specialize</span> (<span class="id">WTs</span> 0); <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">WTs</span>; <span class="id">inv</span> <span class="id">WTs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span>; <span class="id">intro</span> <span class="id">n</span>; <span class="id">specialize</span> (<span class="id">WTs</span> <span class="id">n</span>); <span class="id">inv</span> <span class="id">WTs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">IHxts</span>; <span class="id">intro</span> <span class="id">n</span>; <span class="id">specialize</span> (<span class="id">WTs</span> <span class="id">n</span>); <span class="id">inv</span> <span class="id">WTs</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="WtStream">WtStream</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="WtStream.G">G</a></span>: <span class="id"><a href="Velus.Instantiator.html#NL.Syn.global">global</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="WtStream.main">main</a></span>: <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="WtStream.ins">ins</a></span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.value">value</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="WtStream.outs">outs</a></span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.value">value</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="wt_ins">wt_ins</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">node</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Syn.find_node">find_node</a></span> <span class="id"><a href="Velus.NLCorrectness.html#WtStream.main">main</a></span> <span class="id"><a href="Velus.NLCorrectness.html#WtStream.G">G</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">node</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#wt_streams">wt_streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#WtStream.ins">ins</a></span> (<span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span> <span class="id">node</span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="wt_outs">wt_outs</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">node</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Syn.find_node">find_node</a></span> <span class="id"><a href="Velus.NLCorrectness.html#WtStream.main">main</a></span> <span class="id"><a href="Velus.NLCorrectness.html#WtStream.G">G</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">node</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#wt_streams">wt_streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#WtStream.outs">outs</a></span> (<span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span> <span class="id">node</span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>)).<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.NLCorrectness.html#WtStream">WtStream</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="node_in_out_not_nil">node_in_out_not_nil</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n</span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>) &lt;&gt; [] \/ <span class="id">n</span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>) &lt;&gt; [].<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intro</span>; <span class="id">left</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL.Syn.node_in_not_nil">node_in_not_nil</a></span>.<br/>
Qed.</div></details>
<br/>
<span class="id">Local</span> <span class="kwd">Hint</span> <span class="id">Resolve</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fuse_call</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">normalize_switches_call</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">deadcode_call</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">stmt_call_eval_add_defaults</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fuse_loop_call</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">normalize_switches_loop_call</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">deadcode_loop_call</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">loop_call_add_defaults</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fuse_wt_program</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">normalize_switches_wt_program</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">deadcode_program_wt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fuse_wt_memory</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">normalize_switches_wt_memory</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">deadcode_program_wt_memory</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wt_add_defaults_class</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wt_memory_add_defaults</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ProgramFusible_translate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">CutCycles.CCTyp.cut_cycles_wt_program</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">CutCycles.CCClo.cut_cycles_wc_program</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Scheduler.scheduler_wc_program</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Scheduler.scheduler_wt_program</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">NL2StcClocking.translate_wc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">NL2StcTyping.translate_wt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Stc2ObcTyping.translate_wt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">No_Naked_Vars_add_defaults_class</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">translate_No_Overwrites</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fuse_No_Overwrites</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">normalize_switches_No_Overwrites</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">deadcode_program_No_Overwrites</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">translate_cannot_write_inputs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fuse_cannot_write_inputs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">normalize_switches_cannot_write_inputs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">deadcode_program_cannot_write_inputs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wt_add_defaults_class</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wt_memory_add_defaults</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">stmt_call_eval_add_defaults</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">node_in_out_not_nil</span> : <span class="id">core</span>.<br/>
<br/>
<div class="doc">The trace of a NLustre node </div>
<span class="kwd">Section</span> <span class="id"><a name="NLTrace">NLTrace</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="NLTrace.node">node</a></span>: <span class="id"><a href="Velus.Instantiator.html#NL.Syn.node">node</a></span>) (<span class="id"><a name="NLTrace.ins">ins</a></span> <span class="id"><a name="NLTrace.outs">outs</a></span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.value">value</a></span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="NLTrace.Spec_in_out">Spec_in_out</a></span> : <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>) &lt;&gt; [] \/ <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>) &lt;&gt; [].<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="NLTrace.Len_ins">Len_ins</a></span>     : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.ins">ins</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="NLTrace.Len_outs">Len_outs</a></span>    : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.outs">outs</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="id">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="trace_node">trace_node</a></span> (<span class="id">n</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>): <span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html#traceinf">traceinf</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Traces.html#mk_trace">mk_trace</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.ins">ins</a></span>) (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.outs">outs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>)) (<span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ _ _ <span class="id">n</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Next Obligation.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.Spec_in_out">Spec_in_out</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>; <span class="id">intro</span> <span class="id">E</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_eq_nil">map_eq_nil</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>; <span class="id">intro</span> <span class="id">E</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_eq_nil">map_eq_nil</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Defined.</div></details>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Next Obligation.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span>, <span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span>; <span class="id">rewrite</span> 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Defined.</div></details>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Next Obligation.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span>, <span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span>; <span class="id">rewrite</span> 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Defined.</div></details>
<br/>
<div class="doc">Simply link the trace of a Lustre node with the trace of an Obc step method with the same parameters </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="trace_inf_sim_step_node">trace_inf_sim_step_node</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">m</span> <span class="id">Spec_in_out_m</span> <span class="id">Len_ins_m</span> <span class="id">Len_outs_m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">m</span> = <span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id">m</span> = <span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html#traceinf_sim">traceinf_sim</a></span> (<span class="id"><a href="Velus.Traces.html#trace_step">trace_step</a></span> <span class="id">m</span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.ins">ins</a></span>) (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.outs">outs</a></span>) <span class="id">Spec_in_out_m</span> <span class="id">Len_ins_m</span> <span class="id">Len_outs_m</span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.NLCorrectness.html#trace_node">trace_node</a></span> <span class="id">n</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Traces.html#trace_step">trace_step</a></span>, <span class="id"><a href="Velus.NLCorrectness.html#trace_node">trace_node</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">traceinf_sim'_sim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">n</span>; <span class="kwd">cofix</span> <span class="id">COFIX</span>; <span class="id">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Traces.html#unfold_mk_trace">unfold_mk_trace</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Traces.html#unfold_mk_trace">unfold_mk_trace</a></span> <span class="kwd">with</span> (<span class="id">xs</span> := <span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="Velus.Traces.html#load_events">load_events</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.ins">ins</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>)) ** <span class="id"><a href="Velus.Traces.html#store_events">store_events</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.outs">outs</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.node">node</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="Velus.Traces.html#load_events">load_events</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.ins">ins</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">m</span>) ** <span class="id"><a href="Velus.Traces.html#store_events">store_events</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace.outs">outs</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id">m</span>)); <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intro</span> <span class="id">E</span>; <span class="id">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html#Eapp_E0_inv">Eapp_E0_inv</a></span> <span class="kwd">in</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Traces.html#load_store_events_not_E0">load_store_events_not_E0</a></span> _ _ _ _ <span class="id">Spec_in_out_m</span> <span class="id">Len_ins_m</span> <span class="id">Len_outs_m</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">COFIX</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.NLCorrectness.html#NLTrace">NLTrace</a></span>.<br/>
<br/>
<div class="doc">A bisimulation relation between a declared node's trace and a given trace </div>
<span class="kwd">Inductive</span> <span class="id"><a name="bisim_IO">bisim_IO</a></span> (<span class="id">G</span>: <span class="id"><a href="Velus.Instantiator.html#NL.Syn.global">global</a></span>) (<span class="id">f</span>: <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id">ins</span> <span class="id">outs</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.value">value</a></span>)): <span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html#traceinf">traceinf</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="IOStep">IOStep</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">T</span> <span class="id">node</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Spec_in_out</span> : <span class="id">node</span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>) &lt;&gt; [] \/ <span class="id">node</span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>) &lt;&gt; [])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Len_ins</span>     : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">ins</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">node</span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Len_outs</span>    : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">outs</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">node</span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">node</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Events.html#traceinf_sim">traceinf_sim</a></span> <span class="id">T</span> (<span class="id"><a href="Velus.NLCorrectness.html#trace_node">trace_node</a></span> <span class="id">node</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">Spec_in_out</span> <span class="id">Len_ins</span> <span class="id">Len_outs</span> 0) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bisim_IO</span> <span class="id">G</span> <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">T</span>.<br/>
<br/>
<div class="doc">streams of present values </div>
<span class="kwd">Definition</span> <span class="id"><a name="pstr">pstr</a></span> (<span class="id">xss</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#IStr.stream">stream</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.value">value</a></span>)) : <span class="id"><a href="Velus.ObcToClight.Interface.html#IStr.stream">stream</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.svalue">svalue</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.present">present</a></span> (<span class="id">xss</span> <span class="id">n</span>).<br/>
<span class="kwd">Definition</span> <span class="id"><a name="pStr">pStr</a></span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.value">value</a></span>) -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.svalue">svalue</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#map">Streams.map</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.present">present</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tr_Streams_pStr">tr_Streams_pStr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xss</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#pStr">pStr</a></span> <span class="id">xss</span>) <span class="id">≈</span> <span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id">xss</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> ? <span class="id">n</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span>, <span class="id"><a href="Velus.NLCorrectness.html#pStr">pStr</a></span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">xss</span>; <span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams_hd">tr_Streams_hd</a></span>, 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>; <span class="id">induction</span> <span class="id">xss</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;-2 <span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams_tl">tr_Streams_tl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">IHn</span>, 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="value_to_option_pstr">value_to_option_pstr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Instantiator.html#Stc2ObcCorr.value_to_option">Stc2ObcCorr.value_to_option</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span> <span class="id">xs</span> <span class="id">n</span>)) <span class="id">≈</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">xs</span> <span class="id">n</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Instantiator.html#Stc2ObcCorr.value_to_option">Stc2ObcCorr.value_to_option</a></span>, <span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span>; <span class="id">intro</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_node_find_system">find_node_find_system</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">G</span> <span class="id">f</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.find_system">Stc.Syn.find_system</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Instantiator.html#NL2Stc.translate">NL2Stc.translate</a></span> <span class="id">G</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL2Stc.translate_node">NL2Stc.translate_node</a></span> <span class="id">n</span>, <span class="id">P</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Find</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Instantiator.html#NL.Syn.find_node">find_node</a></span> <span class="kwd">in</span> <span class="id">Find</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonTactics.html#option_map_inv">option_map_inv</a></span> <span class="kwd">in</span> <span class="id">Find</span> <span class="kwd">as</span> ((<span class="id">node</span>, ?)&amp; <span class="id">Find</span> &amp; <span class="id">E</span>).<br/>
&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">E</span>; <span class="id">subst</span> <span class="id">node</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonProgram.html#find_unit_transform_units_forward">find_unit_transform_units_forward</a></span> <span class="kwd">in</span> <span class="id">Find</span>; <span class="id">eauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_system_find_class">find_system_find_class</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">P</span> <span class="id">f</span> <span class="id">s</span> <span class="id">P'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.find_system">Stc.Syn.find_system</a></span> <span class="id">f</span> <span class="id">P</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">s</span>, <span class="id">P'</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">Obc.Syn.find_class</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Instantiator.html#Stc2Obc.translate">Stc2Obc.translate</a></span> <span class="id">P</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.Instantiator.html#Stc2Obc.translate_system">Stc2Obc.translate_system</a></span> <span class="id">s</span>, <span class="id"><a href="Velus.Instantiator.html#Stc2Obc.translate">Stc2Obc.translate</a></span> <span class="id">P'</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Find</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonProgram.html#find_unit_transform_units_forward">find_unit_transform_units_forward</a></span> <span class="kwd">in</span> <span class="id">Find</span>; <span class="id">auto</span>.<br/>
Qed.</div></details>
<br/>
<div class="doc">Correctness from NLustre to Clight </div>
<span class="kwd">Lemma</span> <span class="id"><a name="behavior_nl_to_cl">behavior_nl_to_cl</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">G</span> <span class="id">P</span> <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Clo.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Typ.wt_global">wt_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#wt_ins">wt_ins</a></span> <span class="id">G</span> <span class="id">main</span> <span class="id">ins</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Norm.normal_args">normal_args</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.CoindSem.sem_node">CoindSem.sem_node</a></span> <span class="id">G</span> <span class="id">main</span> (<span class="id"><a href="Velus.NLCorrectness.html#pStr">pStr</a></span> <span class="id">ins</span>) (<span class="id"><a href="Velus.NLCorrectness.html#pStr">pStr</a></span> <span class="id">outs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Velus.html#nl_to_cl">nl_to_cl</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">main</span>) <span class="id">G</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">T</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#semantics2">semantics2</a></span> <span class="id">P</span>) (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Behaviors.html#Reacts">Reacts</a></span> <span class="id">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.NLCorrectness.html#bisim_IO">bisim_IO</a></span> <span class="id">G</span> <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hwc</span> <span class="id">Hwt</span> <span class="id">Hwti</span> <span class="id">Hnorm</span> <span class="id">Hsem</span> <span class="id">COMP</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Velus.html#nl_to_cl">nl_to_cl</a></span>, <span class="id"><a href="Velus.Velus.html#schedule_program">schedule_program</a></span> <span class="kwd">in</span> <span class="id">COMP</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">COMP</span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#print_identity">print_identity</a></span> <span class="kwd">in</span> <span class="id">COMP</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Coinductive&nbsp;NLustre&nbsp;to&nbsp;nat-&gt;values&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Ord.Ordered_nodes">Ordered_nodes</a></span> <span class="id">G</span>) <span class="kwd">as</span> <span class="id">Hord</span> <span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#NL.Typ.wt_global_Ordered_nodes">wt_global_Ordered_nodes</a></span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL.CoindToIdx.implies">implies</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.NLCorrectness.html#tr_Streams_pStr">tr_Streams_pStr</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;expression&nbsp;inlining&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_exp_inlining">do_exp_inlining</a></span> <span class="id"><a href="Velus.Instantiator.html#NL.EI.EI.exp_inlining">exp_inlining</a></span> <span class="id">G</span>) <span class="kwd">as</span> <span class="id">G'</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Typ.wt_global">wt_global</a></span> <span class="id">G'</span>) <span class="kwd">as</span> <span class="id">Hwt'</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_exp_inlining">do_exp_inlining</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL.EI.EITyp.exp_inlining_wt">exp_inlining_wt</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.NLCorrectness.html#wt_ins">wt_ins</a></span> <span class="id">G'</span> <span class="id">main</span> <span class="id">ins</span>) <span class="kwd">as</span> <span class="id">Hwti'</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_exp_inlining">do_exp_inlining</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">Hwti</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#wt_ins">wt_ins</a></span> <span class="kwd">in</span> *; <span class="id">intros</span> <span class="id">n</span> <span class="id">Hnode</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#NL.EI.EI.find_node_exp_inlining_backward">find_node_exp_inlining_backward</a></span> <span class="kwd">in</span> <span class="id">Hnode</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hnode</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">eapply</span> <span class="id">Hwti</span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Clo.wc_global">wc_global</a></span> <span class="id">G'</span>) <span class="kwd">as</span> <span class="id">Hwc'</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_exp_inlining">do_exp_inlining</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#NL.EI.EIClo.exp_inlining_wc">exp_inlining_wc</a></span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Norm.normal_args">normal_args</a></span> <span class="id">G'</span>) <span class="kwd">as</span> <span class="id">Hnorm'</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>. <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_exp_inlining">do_exp_inlining</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL.EI.EINorm.exp_inlining_normal_args">exp_inlining_normal_args</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Sem.sem_node">sem_node</a></span> <span class="id">G'</span> <span class="id">main</span> (<span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id">ins</span>)) (<span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id">outs</span>))) <span class="kwd">as</span> <span class="id">Hsem'</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>. <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_exp_inlining">do_exp_inlining</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL.EI.EICor.exp_inlining_sem">exp_inlining_sem</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">T</span>, <span class="id"><a href="Velus.NLCorrectness.html#bisim_IO">bisim_IO</a></span> <span class="id">G</span> <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">T</span> &lt;-&gt; <span class="id"><a href="Velus.NLCorrectness.html#bisim_IO">bisim_IO</a></span> <span class="id">G'</span> <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">T</span>) <span class="kwd">as</span> <span class="id">Hbisim</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_exp_inlining">do_exp_inlining</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>). 2:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">G</span>. <span class="id">split</span>; <span class="id">intros</span> * <span class="id">Hbis</span>; <span class="id">inv</span> <span class="id">Hbis</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#NL.EI.EI.find_node_exp_inlining_forward">find_node_exp_inlining_forward</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#NL.EI.EI.find_node_exp_inlining_backward">find_node_exp_inlining_backward</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;?); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hbisim</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Hord</span> <span class="id">Hwc</span> <span class="id">Hwt</span> <span class="id">Hwti</span> <span class="id">Hnorm</span> <span class="id">Hsem</span> <span class="id">Hbisim</span> <span class="id">HeqG'</span> <span class="id">G</span>.<br/>
&nbsp;&nbsp;<span class="id">rename</span> <span class="id">G'</span> <span class="id">into</span> <span class="id">G</span>, <span class="id">Hwti'</span> <span class="id">into</span> <span class="id">Hwti</span>, <span class="id">Hwt'</span> <span class="id">into</span> <span class="id">Hwt</span>, <span class="id">Hwc'</span> <span class="id">into</span> <span class="id">Hwc</span>, <span class="id">Hnorm'</span> <span class="id">into</span> <span class="id">Hnorm</span>, <span class="id">Hsem'</span> <span class="id">into</span> <span class="id">Hsem</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;dead&nbsp;code&nbsp;elimination&nbsp;optimization&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_dce">do_dce</a></span> <span class="id"><a href="Velus.Instantiator.html#NL.DCE.DCE.dce_global">dce_global</a></span> <span class="id">G</span>) <span class="kwd">as</span> <span class="id">G'</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Typ.wt_global">wt_global</a></span> <span class="id">G'</span>) <span class="kwd">as</span> <span class="id">Hwt'</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_dce">do_dce</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL.DCE.DCETyp.dce_wt">dce_wt</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.NLCorrectness.html#wt_ins">wt_ins</a></span> <span class="id">G'</span> <span class="id">main</span> <span class="id">ins</span>) <span class="kwd">as</span> <span class="id">Hwti'</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_dce">do_dce</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">Hwti</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#wt_ins">wt_ins</a></span> <span class="kwd">in</span> *; <span class="id">intros</span> <span class="id">n</span> <span class="id">Hnode</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#NL.DCE.DCE.find_node_dce_backward">find_node_dce_backward</a></span> <span class="kwd">in</span> <span class="id">Hnode</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hnode</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">eapply</span> <span class="id">Hwti</span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Clo.wc_global">wc_global</a></span> <span class="id">G'</span>) <span class="kwd">as</span> <span class="id">Hwc'</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_dce">do_dce</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#NL.DCE.DCEClo.dce_wc">dce_wc</a></span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Norm.normal_args">normal_args</a></span> <span class="id">G'</span>) <span class="kwd">as</span> <span class="id">Hnorm'</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>. <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_dce">do_dce</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL.DCE.DCENorm.dce_normal_args">dce_normal_args</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Sem.sem_node">sem_node</a></span> <span class="id">G'</span> <span class="id">main</span> (<span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id">ins</span>)) (<span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id">outs</span>))) <span class="kwd">as</span> <span class="id">Hsem'</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>. <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_dce">do_dce</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL.DCE.DCECor.dce_global_sem">dce_global_sem</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Instantiator.html#NL.Typ.wt_global_Ordered_nodes">wt_global_Ordered_nodes</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">T</span>, <span class="id"><a href="Velus.NLCorrectness.html#bisim_IO">bisim_IO</a></span> <span class="id">G</span> <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">T</span> &lt;-&gt; <span class="id"><a href="Velus.NLCorrectness.html#bisim_IO">bisim_IO</a></span> <span class="id">G'</span> <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">T</span>) <span class="kwd">as</span> <span class="id">Hbisim</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_dce">do_dce</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>). 2:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">G</span>. <span class="id">split</span>; <span class="id">intros</span> * <span class="id">Hbis</span>; <span class="id">inv</span> <span class="id">Hbis</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#NL.DCE.DCE.find_node_dce_forward">find_node_dce_forward</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#NL.DCE.DCE.find_node_dce_backward">find_node_dce_backward</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;?); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hbisim</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Hwc</span> <span class="id">Hwt</span> <span class="id">Hwti</span> <span class="id">Hnorm</span> <span class="id">Hsem</span> <span class="id">Hbisim</span> <span class="id">HeqG'</span> <span class="id">G</span>.<br/>
&nbsp;&nbsp;<span class="id">rename</span> <span class="id">G'</span> <span class="id">into</span> <span class="id">G</span>, <span class="id">Hwti'</span> <span class="id">into</span> <span class="id">Hwti</span>, <span class="id">Hwt'</span> <span class="id">into</span> <span class="id">Hwt</span>, <span class="id">Hwc'</span> <span class="id">into</span> <span class="id">Hwc</span>, <span class="id">Hnorm'</span> <span class="id">into</span> <span class="id">Hnorm</span>, <span class="id">Hsem'</span> <span class="id">into</span> <span class="id">Hsem</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;remove&nbsp;duplicate&nbsp;registers&nbsp;optimization&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_dupregrem">do_dupregrem</a></span> <span class="id"><a href="Velus.Instantiator.html#NL.DRR.DRR.remove_dup_regs">remove_dup_regs</a></span> <span class="id">G</span>) <span class="kwd">as</span> <span class="id">G'</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Typ.wt_global">wt_global</a></span> <span class="id">G'</span>) <span class="kwd">as</span> <span class="id">Hwt'</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_dupregrem">do_dupregrem</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#NL.DRR.DRRTyp.remove_dup_regs_wt">remove_dup_regs_wt</a></span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.NLCorrectness.html#wt_ins">wt_ins</a></span> <span class="id">G'</span> <span class="id">main</span> <span class="id">ins</span>) <span class="kwd">as</span> <span class="id">Hwti'</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_dupregrem">do_dupregrem</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">Hwti</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#wt_ins">wt_ins</a></span> <span class="kwd">in</span> *; <span class="id">intros</span> <span class="id">n</span> <span class="id">Hnode</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#NL.DRR.DRR.find_node_remove_dup_regs_backward">find_node_remove_dup_regs_backward</a></span> <span class="kwd">in</span> <span class="id">Hnode</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hnode</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">eapply</span> <span class="id">Hwti</span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Clo.wc_global">wc_global</a></span> <span class="id">G'</span>) <span class="kwd">as</span> <span class="id">Hwc'</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_dupregrem">do_dupregrem</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#NL.DRR.DRRClo.remove_dup_regs_wc">remove_dup_regs_wc</a></span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Norm.normal_args">normal_args</a></span> <span class="id">G'</span>) <span class="kwd">as</span> <span class="id">Hnorm'</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>. <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_dupregrem">do_dupregrem</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL.DRR.DRRNorm.remove_dup_regs_normal_args">remove_dup_regs_normal_args</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Sem.sem_node">sem_node</a></span> <span class="id">G'</span> <span class="id">main</span> (<span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id">ins</span>)) (<span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span> (<span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id">outs</span>))) <span class="kwd">as</span> <span class="id">Hsem'</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>. <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_dupregrem">do_dupregrem</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL.DRR.DRRCor.remove_dup_regs_sem">remove_dup_regs_sem</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Instantiator.html#NL.Typ.wt_global_Ordered_nodes">wt_global_Ordered_nodes</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">T</span>, <span class="id"><a href="Velus.NLCorrectness.html#bisim_IO">bisim_IO</a></span> <span class="id">G</span> <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">T</span> &lt;-&gt; <span class="id"><a href="Velus.NLCorrectness.html#bisim_IO">bisim_IO</a></span> <span class="id">G'</span> <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">T</span>) <span class="kwd">as</span> <span class="id">Hbisim</span>.<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_dupregrem">do_dupregrem</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>). 2:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">G</span>. <span class="id">split</span>; <span class="id">intros</span> * <span class="id">Hbis</span>; <span class="id">inv</span> <span class="id">Hbis</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#NL.DRR.DRR.find_node_remove_dup_regs_forward">find_node_remove_dup_regs_forward</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#NL.DRR.DRR.find_node_remove_dup_regs_backward">find_node_remove_dup_regs_backward</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;?); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hbisim</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Hwc</span> <span class="id">Hwt</span> <span class="id">Hwti</span> <span class="id">Hnorm</span> <span class="id">Hsem</span> <span class="id">Hbisim</span> <span class="id">HeqG'</span> <span class="id">G</span>.<br/>
&nbsp;&nbsp;<span class="id">rename</span> <span class="id">G'</span> <span class="id">into</span> <span class="id">G</span>, <span class="id">Hwti'</span> <span class="id">into</span> <span class="id">Hwti</span>, <span class="id">Hsem'</span> <span class="id">into</span> <span class="id">Hsem</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;well-scheduled&nbsp;Stc&nbsp;program&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#is_well_sch">is_well_sch</a></span> (<span class="id"><a href="Velus.Velus.html#Scheduler.schedule">Scheduler.schedule</a></span> (<span class="id"><a href="Velus.Velus.html#CutCycles.CC.cut_cycles">CutCycles.CC.cut_cycles</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL2Stc.translate">NL2Stc.translate</a></span> <span class="id">G</span>)))) <span class="id">eqn</span>: <span class="id">Sch</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Sch</span> <span class="kwd">in</span> <span class="id">COMP</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">COMP</span>; <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Velus.html#is_well_sch">is_well_sch</a></span> <span class="kwd">in</span> <span class="id">Sch</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id"><a href="Velus.Velus.html#is_well_sch_system">is_well_sch_system</a></span> (<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.systems">Stc.Syn.systems</a></span> (<span class="id"><a href="Velus.Velus.html#Scheduler.schedule">Scheduler.schedule</a></span> (<span class="id"><a href="Velus.Velus.html#CutCycles.CC.cut_cycles">CutCycles.CC.cut_cycles</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL2Stc.translate">NL2Stc.translate</a></span> <span class="id">G</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>)) <span class="id">eqn</span>: <span class="id">Wsch</span>; <span class="id">try</span> <span class="id">discriminate</span>; <span class="id">destruct</span> <span class="id">u</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Sch</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#is_well_sch_program">is_well_sch_program</a></span> <span class="kwd">in</span> <span class="id">Wsch</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;a&nbsp;main&nbsp;Stc&nbsp;system&nbsp;exists&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#print_identity">print_identity</a></span> <span class="kwd">in</span> <span class="id">COMP</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;pose&nbsp;proof&nbsp;COMP&nbsp;as&nbsp;COMP'.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">exists</span> <span class="id">n</span>, <span class="id"><a href="Velus.Instantiator.html#NL.Syn.find_node">find_node</a></span> <span class="id">main</span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span>) <span class="kwd">as</span> (<span class="id">main_node</span> &amp; <span class="id">Find</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">inv</span> <span class="id">Hsem</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">Find</span> <span class="kwd">as</span> <span class="id">Find_node</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#find_node_find_system">find_node_find_system</a></span> <span class="kwd">in</span> <span class="id">Find</span> <span class="kwd">as</span> (<span class="id">P'</span> &amp; <span class="id">Find</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Velus.html#CutCycles.CC.cut_cycles_find_system">CutCycles.CC.cut_cycles_find_system</a></span> <span class="kwd">in</span> <span class="id">Find</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Velus.html#Scheduler.scheduler_find_system">Scheduler.scheduler_find_system</a></span> <span class="kwd">in</span> <span class="id">Find</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">Find</span> <span class="kwd">as</span> <span class="id">Find_system</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;a&nbsp;main&nbsp;Obc&nbsp;class&nbsp;exists&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#find_system_find_class">find_system_find_class</a></span> <span class="kwd">in</span> <span class="id">Find</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">ins'</span> := <span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id">ins</span>) <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">set</span> (<span class="id">outs'</span> := <span class="id"><a href="Velus.Instantiator.html#CIStr.tr_Streams">tr_Streams</a></span> <span class="id">outs</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, 0 &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id">ins'</span> <span class="id">n</span>)) <span class="kwd">as</span> <span class="id">Length</span>.<br/>
&nbsp;&nbsp;{ <span class="id">inversion_clear</span> <span class="id">Hsem</span> <span class="kwd">as</span> [???????? <span class="id">Ins</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">k</span>; <span class="id">specialize</span> (<span class="id">Ins</span> <span class="id">k</span>); <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">Ins</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span> <span class="kwd">in</span> <span class="id">Ins</span>; <span class="id">rewrite</span> 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span> <span class="kwd">in</span> <span class="id">Ins</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">Ins</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_ingt0">n_ingt0</a></span>.<br/>
&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;NLustre&nbsp;to&nbsp;Nlustre&nbsp;with&nbsp;memory&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Ord.Ordered_nodes">Ordered_nodes</a></span> <span class="id">G</span>) <span class="kwd">as</span> <span class="id">Hord</span> <span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#NL.Typ.wt_global_Ordered_nodes">wt_global_Ordered_nodes</a></span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL.MemSem.sem_msem_node">sem_msem_node</a></span> <span class="kwd">in</span> <span class="id">Hsem</span> <span class="kwd">as</span> (<span class="id">M</span> &amp; <span class="id">Hsem</span>); <span class="id">auto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;NLustre&nbsp;with&nbsp;memory&nbsp;to&nbsp;Stc&nbsp;loop&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#Stc.Wdef.Well_defined">Stc.Wdef.Well_defined</a></span> (<span class="id"><a href="Velus.Velus.html#Scheduler.schedule">Scheduler.schedule</a></span> (<span class="id"><a href="Velus.Velus.html#CutCycles.CC.cut_cycles">CutCycles.CC.cut_cycles</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL2Stc.translate">NL2Stc.translate</a></span> <span class="id">G</span>)))).<br/>
&nbsp;&nbsp;{ <span class="id">split</span>; [|<span class="id">split</span>]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Velus.html#Scheduler.scheduler_ordered">Scheduler.scheduler_ordered</a></span>, <span class="id"><a href="Velus.Velus.html#CutCycles.CCCor.cut_cycles_ordered">CutCycles.CCCor.cut_cycles_ordered</a></span>, <span class="id"><a href="Velus.Instantiator.html#NL2StcCorr.Ordered_nodes_systems">NL2StcCorr.Ordered_nodes_systems</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Velus.html#Scheduler.scheduler_normal_args">Scheduler.scheduler_normal_args</a></span>, <span class="id"><a href="Velus.Velus.html#CutCycles.CCNorm.cut_cycles_normal_args">CutCycles.CCNorm.cut_cycles_normal_args</a></span>, <span class="id"><a href="Velus.Instantiator.html#NL2StcNormalArgs.translate_normal_args">NL2StcNormalArgs.translate_normal_args</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Instantiator.html#NL2StcCorr.correctness_loop">NL2StcCorr.correctness_loop</a></span> <span class="kwd">in</span> <span class="id">Hsem</span> <span class="kwd">as</span> (?&amp; <span class="id">Hsem</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Velus.html#CutCycles.CCCor.cut_cycles_loop">CutCycles.CCCor.cut_cycles_loop</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Velus.html#Scheduler.scheduler_loop">Scheduler.scheduler_loop</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">auto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.Instantiator.html#Stc2ObcCorr.eq_if_present">Stc2ObcCorr.eq_if_present</a></span> (<span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span> <span class="id">ins'</span> <span class="id">n</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ins'</span> <span class="id">n</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span>; <span class="id">intros</span>; <span class="id">clear</span>; <span class="id">induction</span> (<span class="id">ins'</span> <span class="id">n</span>); <span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">obcsem</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="id">v</span> &lt;&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span> <span class="id">ins'</span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#pstr">pstr</a></span>; <span class="id">intros</span>; <span class="id">specialize</span> (<span class="id">Length</span> <span class="id">n</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">ins'</span> <span class="id">n</span>); <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">lia</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">discriminate</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Velus.html#Scheduler.schedule_system">Scheduler.schedule_system</a></span> (<span class="id"><a href="Velus.Velus.html#CutCycles.CC.cut_cycles_system">CutCycles.CC.cut_cycles_system</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL2Stc.translate_node">NL2Stc.translate_node</a></span> <span class="id">main_node</span>))) <span class="kwd">as</span> <span class="id">sys</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#ComTyp.wt_memory">ComTyp.wt_memory</a></span> (<span class="id">M</span> 0) (<span class="id"><a href="Velus.Velus.html#Scheduler.schedule">Scheduler.schedule</a></span> (<span class="id"><a href="Velus.Velus.html#CutCycles.CC.cut_cycles">CutCycles.CC.cut_cycles</a></span> <span class="id">P'</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.mems_of_states">Stc.Syn.mems_of_states</a></span> (<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.s_lasts">Stc.Syn.s_lasts</a></span> <span class="id">sys</span>++<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.s_nexts">Stc.Syn.s_nexts</a></span> <span class="id">sys</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.s_subs">Stc.Syn.s_subs</a></span> (<span class="id"><a href="Velus.Velus.html#Scheduler.schedule_system">Scheduler.schedule_system</a></span> (<span class="id"><a href="Velus.Velus.html#CutCycles.CC.cut_cycles_system">CutCycles.CC.cut_cycles_system</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL2Stc.translate_node">NL2Stc.translate_node</a></span> <span class="id">main_node</span>))))).<br/>
&nbsp;&nbsp;{ <span class="id">subst</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Instantiator.html#Stc.Sem.initial_state">Stc.Sem.initial_state</a></span> _ _ _) <span class="id">and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Velus.html#CutCycles.CCCor.cut_cycles_initial_state">CutCycles.CCCor.cut_cycles_initial_state</a></span>, <span class="id"><a href="Velus.Velus.html#Scheduler.scheduler_initial_state">Scheduler.scheduler_initial_state</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#Stc.TypSem.initial_state_wt_memory">Stc.TypSem.initial_state_wt_memory</a></span> <span class="kwd">with</span> (2 := <span class="id">it</span>); <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">xt</span> <span class="id">vo</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.wt_option_value">wt_option_value</a></span> <span class="id">vo</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">xt</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Instantiator.html#Stc.Syn.s_in">Stc.Syn.s_in</a></span> <span class="id">sys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ins'</span> <span class="id">n</span>))).<br/>
&nbsp;&nbsp;{ <span class="id">subst</span> <span class="id">sys</span> <span class="id">ins'</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Hwti</span> <span class="kwd">in</span> <span class="id">Find_node</span>; <span class="id">clear</span> - <span class="id">Find_node</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.NLCorrectness.html#wt_streams_spec">wt_streams_spec</a></span> <span class="kwd">in</span> <span class="id">Find_node</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">n</span>; <span class="id">specialize</span> (<span class="id">Find_node</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span> <span class="kwd">in</span> <span class="id">Find_node</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">Find_node</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;} <span class="id">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Stc&nbsp;loop&nbsp;to&nbsp;Obc&nbsp;loop&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Instantiator.html#Stc2ObcCorr.correctness_loop_call">Stc2ObcCorr.correctness_loop_call</a></span> <span class="kwd">with</span> (<span class="id">ins</span> := <span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ins'</span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span> <span class="id">Hsem</span> <span class="kwd">as</span> (<span class="id">me0</span> &amp; <span class="id">Rst</span> &amp; <span class="id">Hsem</span> &amp;?); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">stcsem</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.NLCorrectness.html#value_to_option_pstr">value_to_option_pstr</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;aliases&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">tr_G</span> := <span class="id"><a href="Velus.Instantiator.html#NL2Stc.translate">NL2Stc.translate</a></span> <span class="id">G</span>) <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">set</span> (<span class="id">cut_tr_G</span> := <span class="id"><a href="Velus.Velus.html#CutCycles.CC.cut_cycles">CutCycles.CC.cut_cycles</a></span> <span class="id">tr_G</span>) <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">set</span> (<span class="id">sch_tr_G</span> := <span class="id"><a href="Velus.Velus.html#Scheduler.schedule">Scheduler.schedule</a></span> <span class="id">cut_tr_G</span>) <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">set</span> (<span class="id">tr_sch_tr_G</span> := <span class="id"><a href="Velus.Instantiator.html#Stc2Obc.translate">Stc2Obc.translate</a></span> <span class="id">sch_tr_G</span>) <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">set</span> (<span class="id">tr_main_node</span> := <span class="id"><a href="Velus.Instantiator.html#NL2Stc.translate_node">NL2Stc.translate_node</a></span> <span class="id">main_node</span>) <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">set</span> (<span class="id">cut_tr_main_node</span> := <span class="id"><a href="Velus.Velus.html#CutCycles.CC.cut_cycles_system">CutCycles.CC.cut_cycles_system</a></span> <span class="id">tr_main_node</span>) <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">set</span> (<span class="id">sch_tr_main_node</span> := <span class="id"><a href="Velus.Velus.html#Scheduler.schedule_system">Scheduler.schedule_system</a></span> <span class="id">cut_tr_main_node</span>) <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">set</span> (<span class="id">main_class</span> := <span class="id"><a href="Velus.Instantiator.html#Stc2Obc.translate_system">Stc2Obc.translate_system</a></span> <span class="id">sch_tr_main_node</span>) <span class="kwd">in</span> *.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Obc&nbsp;methods&nbsp;step&nbsp;and&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Instantiator.html#Stc2Obc.exists_reset_method">Stc2Obc.exists_reset_method</a></span> <span class="id">sch_tr_main_node</span>) <span class="kwd">as</span> <span class="id">Find_reset</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Instantiator.html#Stc2Obc.exists_step_method">Stc2Obc.exists_step_method</a></span> <span class="id">sch_tr_main_node</span>) <span class="kwd">as</span> <span class="id">Find_step</span>.<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">m_step</span> := <span class="id"><a href="Velus.Instantiator.html#Stc2Obc.step_method">Stc2Obc.step_method</a></span> <span class="id">sch_tr_main_node</span>) <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">set</span> (<span class="id">m_reset</span> := <span class="id"><a href="Velus.Instantiator.html#Stc2Obc.reset_method">Stc2Obc.reset_method</a></span> <span class="id">sch_tr_main_node</span>) <span class="kwd">in</span> *.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;well-typing&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#Stc.Typ.wt_program">Stc.Typ.wt_program</a></span> <span class="id">sch_tr_G</span>) <span class="kwd">by</span> (<span class="id">subst</span> <span class="id">sch_tr_G</span> <span class="id">cut_tr_G</span> <span class="id">tr_G</span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.wt_program">wt_program</a></span> <span class="id">tr_sch_tr_G</span>) <span class="kwd">by</span> (<span class="id">subst</span> <span class="id">tr_sch_tr_G</span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#ComTyp.wt_memory">ComTyp.wt_memory</a></span> <span class="id">me0</span> (<span class="id"><a href="Velus.Instantiator.html#Stc2Obc.translate">Stc2Obc.translate</a></span> (<span class="id"><a href="Velus.Velus.html#Scheduler.schedule">Scheduler.schedule</a></span> (<span class="id"><a href="Velus.Velus.html#CutCycles.CC.cut_cycles">CutCycles.CC.cut_cycles</a></span> <span class="id">P'</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_mems">c_mems</a></span> <span class="id">main_class</span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_objs">c_objs</a></span> <span class="id">main_class</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.pres_sem_stmt_call">pres_sem_stmt_call</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="id"><a href="Velus.Ident.html#Ids.reset">Ids.reset</a></span>) <span class="kwd">in</span> <span class="id">Find</span> <span class="kwd">as</span> (? &amp; ?); <span class="id">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">typing</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.NLCorrectness.html#wt_outs">wt_outs</a></span> <span class="id">G</span> <span class="id">main</span> <span class="id">outs</span>) <span class="kwd">as</span> <span class="id">Hwto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">unfold</span> <span class="id"><a href="Velus.NLCorrectness.html#wt_outs">wt_outs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Find_node'</span>; <span class="id">rewrite</span> <span class="id">Find_node'</span> <span class="kwd">in</span> <span class="id">Find_node</span>; <span class="id">inv</span> <span class="id">Find_node</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#wt_streams_spec">wt_streams_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.pres_loop_call">pres_loop_call</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">Hwti</span> <span class="kwd">in</span> <span class="id">Find_node'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.NLCorrectness.html#wt_streams_spec">wt_streams_spec</a></span> <span class="kwd">in</span> <span class="id">Find_node'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;IO&nbsp;specs&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;and&nbsp;assert&nbsp;some&nbsp;equalities&nbsp;between&nbsp;classes&nbsp;and&nbsp;methods&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.wt_values">wt_values</a></span> (<span class="id">ins'</span> <span class="id">n</span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">m_step</span>)) <span class="kwd">as</span> <span class="id">Hwt_in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">erewrite</span> <span class="id"><a href="Velus.Instantiator.html#Stc2Obc.find_method_stepm_in">Stc2Obc.find_method_stepm_in</a></span>; <span class="id">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#wt_streams_spec">wt_streams_spec</a></span>, <span class="id">Hwti</span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.wt_values">wt_values</a></span> (<span class="id">outs'</span> <span class="id">n</span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id">m_step</span>)) <span class="kwd">as</span> <span class="id">Hwt_out</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">erewrite</span> <span class="id"><a href="Velus.Instantiator.html#Stc2Obc.find_method_stepm_out">Stc2Obc.find_method_stepm_out</a></span>; <span class="id">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#wt_streams_spec">wt_streams_spec</a></span>, <span class="id">Hwto</span>; <span class="id">auto</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">obc_p</span> := <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.add_defaults">add_defaults</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_obc_dce">do_obc_dce</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.DCE.deadcode_program">deadcode_program</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_norm_switches">do_norm_switches</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.SwN.normalize_switches">normalize_switches</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_fusion">do_fusion</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_program">fuse_program</a></span> <span class="id">tr_sch_tr_G</span>)))) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">obc_p'</span> := <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.add_defaults">add_defaults</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_obc_dce">do_obc_dce</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.DCE.deadcode_program">deadcode_program</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_norm_switches">do_norm_switches</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.SwN.normalize_switches">normalize_switches</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_fusion">do_fusion</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_program">fuse_program</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Instantiator.html#Stc2Obc.translate">Stc2Obc.translate</a></span> (<span class="id"><a href="Velus.Velus.html#Scheduler.schedule">Scheduler.schedule</a></span> (<span class="id"><a href="Velus.Velus.html#CutCycles.CC.cut_cycles">CutCycles.CC.cut_cycles</a></span> <span class="id">P'</span>))))))) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">main_class'</span> := <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#c_main">GenerationProperties.c_main</a></span> <span class="id">main</span> <span class="id">obc_p</span> <span class="id">P</span> (<span class="id"><a href="Velus.Velus.html#do_sync">do_sync</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) (<span class="id"><a href="Velus.Velus.html#do_expose">do_expose</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="id">COMP</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">main_step'</span> := <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#main_step">GenerationProperties.main_step</a></span> <span class="id">main</span> <span class="id">obc_p</span> <span class="id">P</span> (<span class="id"><a href="Velus.Velus.html#do_sync">do_sync</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) (<span class="id"><a href="Velus.Velus.html#do_expose">do_expose</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="id">COMP</span>) <span class="kwd">in</span> *.<br/>
<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">obc_p'</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#prog_main">GenerationProperties.prog_main</a></span> <span class="id">main</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.add_defaults">add_defaults</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_obc_dce">do_obc_dce</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.DCE.deadcode_program">deadcode_program</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_norm_switches">do_norm_switches</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.SwN.normalize_switches">normalize_switches</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_fusion">do_fusion</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_program">fuse_program</a></span> <span class="id">tr_sch_tr_G</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="Velus.Velus.html#do_sync">do_sync</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) (<span class="id"><a href="Velus.Velus.html#do_expose">do_expose</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="id">COMP</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">main_class'</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.add_defaults_class">add_defaults_class</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_obc_dce">do_obc_dce</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.DCE.deadcode_class">deadcode_class</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_norm_switches">do_norm_switches</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.SwN.normalize_class">normalize_class</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_fusion">do_fusion</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_class">fuse_class</a></span> <span class="id">main_class</span>)))) <span class="kwd">as</span> [<span class="id">Eq_prog</span> <span class="id">Eq_main</span>].<br/>
&nbsp;&nbsp;{ <span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#find_main_class">GenerationProperties.find_main_class</a></span> _ _ _ _ _ <span class="id">COMP</span>) <span class="kwd">as</span> <span class="id">Find'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">obc_p</span> <span class="id">main_class'</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_fusion">do_fusion</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); [<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_find_class">fuse_find_class</a></span> <span class="kwd">in</span> <span class="id">Find</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_norm_switches">do_norm_switches</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); [<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.SwN.normalize_switches_find_class">normalize_switches_find_class</a></span> <span class="kwd">in</span> <span class="id">Find</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_obc_dce">do_obc_dce</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); [<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.DCE.deadcode_find_class">deadcode_find_class</a></span> <span class="kwd">in</span> <span class="id">Find</span>|]));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.find_class_add_defaults_class">find_class_add_defaults_class</a></span> <span class="kwd">in</span> <span class="id">Find</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">tr_sch_tr_G</span> <span class="id">sch_tr_G</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Find'</span> <span class="kwd">in</span> <span class="id">Find</span>; <span class="id">inv</span> <span class="id">Find</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">main_step'</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.add_defaults_method">add_defaults_method</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_obc_dce">do_obc_dce</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.DCE.deadcode_method">deadcode_method</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_norm_switches">do_norm_switches</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.SwN.normalize_method">normalize_method</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_fusion">do_fusion</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_method">fuse_method</a></span> <span class="id">m_step</span>)))) <span class="kwd">as</span> <span class="id">Eq_step</span>.<br/>
&nbsp;&nbsp;{ <span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#find_main_step">GenerationProperties.find_main_step</a></span> _ _ _ _ _ <span class="id">COMP</span>) <span class="kwd">as</span> <span class="id">Find_step'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">obc_p</span> <span class="id">main_class</span> <span class="id">main_class'</span> <span class="id">main_step'</span> <span class="id">tr_sch_tr_G</span> <span class="id">sch_tr_G</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Eq_main</span> <span class="kwd">in</span> <span class="id">Find_step'</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.add_defaults_class_find_method">add_defaults_class_find_method</a></span> <span class="kwd">in</span> <span class="id">Find_step'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonTactics.html#option_map_inv">option_map_inv</a></span> <span class="kwd">in</span> <span class="id">Find_step'</span> <span class="kwd">as</span> (?&amp; <span class="id">Find_step'</span> &amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_fusion">do_fusion</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); [<span class="id">apply</span> <span class="id">fuse_find_method'</span> <span class="kwd">in</span> <span class="id">Find_step</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_norm_switches">do_norm_switches</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); [<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.SwN.normalize_switches_find_method">normalize_switches_find_method</a></span> <span class="kwd">in</span> <span class="id">Find_step</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#do_obc_dce">do_obc_dce</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>); [<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.DCE.deadcode_find_method">deadcode_find_method</a></span> <span class="kwd">in</span> <span class="id">Find_step</span>|]));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Find_step'</span> <span class="kwd">in</span> <span class="id">Find_step</span>; <span class="id">inv</span> <span class="id">Find_step</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.wt_values">wt_values</a></span> (<span class="id">ins'</span> <span class="id">n</span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">main_step'</span>)) <span class="kwd">as</span> <span class="id">WTins</span>.<br/>
&nbsp;&nbsp;{ <span class="id">intro</span>; <span class="id">specialize</span> (<span class="id">Hwt_in</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">main_step'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Eq_step</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">cases</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux.wt_values">wt_values</a></span> (<span class="id">outs'</span> <span class="id">n</span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id">main_step'</span>)) <span class="kwd">as</span> <span class="id">WTouts</span>.<br/>
&nbsp;&nbsp;{ <span class="id">intro</span>; <span class="id">specialize</span> (<span class="id">Hwt_out</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">main_step'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Eq_step</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">cases</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span> <span class="id">main_node</span> &lt;&gt; [] \/ <span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span> <span class="id">main_node</span> &lt;&gt; []) <span class="kwd">as</span> <span class="id">Node_in_out_spec</span> <span class="kwd">by</span> <span class="id">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#node_in_out_not_nil">node_in_out_not_nil</a></span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">main_step'</span> &lt;&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> \/ <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id">main_step'</span> &lt;&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="kwd">as</span> <span class="id">Step_in_out_spec</span>.<br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Eq_step</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span> <span class="id">main_node</span>) &lt;&gt; [] \/ <span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span> <span class="id">main_node</span>) &lt;&gt; [])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">destruct</span> <span class="id">Node_in_out_spec</span> <span class="kwd">as</span> [<span class="id">Neq</span>|<span class="id">Neq</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">now</span> <span class="id">left</span>; <span class="id">intro</span>; <span class="id">eapply</span> <span class="id">Neq</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_eq_nil">map_eq_nil</a></span>; <span class="id">eauto</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| (<span class="id">right</span>; <span class="id">intro</span>; <span class="id">eapply</span> <span class="id">Neq</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_eq_nil">map_eq_nil</a></span>; <span class="id">eauto</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">cases</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.wt_program">wt_program</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_obc_dce">do_obc_dce</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.DCE.deadcode_program">deadcode_program</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_norm_switches">do_norm_switches</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.SwN.normalize_switches">normalize_switches</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span> <span class="id"><a href="Velus.Velus.html#do_fusion">do_fusion</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Fus.fuse_program">fuse_program</a></span> <span class="id">tr_sch_tr_G</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">cases</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="id">eexists</span>; <span class="id">split</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.ObcToClight.Correctness.html#correctness">correctness</a></span> <span class="kwd">with</span> (<span class="id">TRANSL</span> := <span class="id">COMP</span>) (<span class="id">me0</span> := <span class="id">me0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTins</span> := <span class="id">WTins</span>) (<span class="id">WTouts</span> := <span class="id">WTouts</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Step_in_out_spec</span> := <span class="id">Step_in_out_spec</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">obc_p</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> ??????? <span class="id">Call</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.stmt_call_eval_add_defaults_class_not_None">stmt_call_eval_add_defaults_class_not_None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (3 := <span class="id">Call</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">change</span> [] <span class="kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.value">value</a></span>)); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.stmt_call_eval_add_defaults">stmt_call_eval_add_defaults</a></span>; <span class="id">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">tr_sch_tr_G</span> <span class="id">sch_tr_G</span> <span class="id">cut_tr_G</span> <span class="id">tr_G</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">cases</span>; <span class="id">eauto</span> 8.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.loop_call_add_defaults">loop_call_add_defaults</a></span>; <span class="id">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">tr_sch_tr_G</span> <span class="id">sch_tr_G</span> <span class="id">cut_tr_G</span> <span class="id">tr_G</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">cases</span>; <span class="id">eauto</span> 8.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">subst</span> <span class="id">main_class'</span> <span class="id">obc_p'</span> <span class="id">tr_sch_tr_G</span> <span class="id">sch_tr_G</span>. <span class="id">setoid_rewrite</span> <span class="id">Eq_main</span>. <span class="id">setoid_rewrite</span> &lt;-<span class="id">Eq_prog</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Def.wt_memory_add_defaults">wt_memory_add_defaults</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">cases</span>; <span class="id">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="id">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">m_step</span> = <span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span> <span class="id">main_node</span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>)) <span class="kwd">as</span> <span class="id">Ein</span> <span class="kwd">by</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id">m_step</span> = <span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span> <span class="id">main_node</span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>)) <span class="kwd">as</span> <span class="id">Eout</span> <span class="kwd">by</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">ins</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span> <span class="id">main_node</span>)) <span class="kwd">as</span> <span class="id">Len_ins</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">transitivity</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span> <span class="id">main_node</span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_in">n_in</a></span>))); <span class="id">try</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">Ein</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hwt_in</span> 0); <span class="id">unfold</span> <span class="id">ins'</span> <span class="kwd">in</span> <span class="id">Hwt_in</span>; <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span> <span class="kwd">in</span> <span class="id">Hwt_in</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_length">Forall2_length</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">outs</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span> <span class="id">main_node</span>)) <span class="kwd">as</span> <span class="id">Len_outs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">transitivity</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Common.Common.html#idfst">idfst</a></span> <span class="id">main_node</span>.(<span class="id"><a href="Velus.Instantiator.html#NL.Syn.n_out">n_out</a></span>))); <span class="id">try</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length_map">length_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">Eout</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hwt_out</span> 0); <span class="id">unfold</span> <span class="id">outs'</span> <span class="kwd">in</span> <span class="id">Hwt_out</span>; <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span> <span class="kwd">in</span> <span class="id">Hwt_out</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_length">Forall2_length</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.NLCorrectness.html#IOStep">IOStep</a></span> <span class="kwd">with</span> (<span class="id">Len_ins</span> := <span class="id">Len_ins</span>) (<span class="id">Len_outs</span> := <span class="id">Len_outs</span>) (<span class="id">Spec_in_out</span> := <span class="id">Node_in_out_spec</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.NLCorrectness.html#trace_inf_sim_step_node">trace_inf_sim_step_node</a></span>; <span class="id">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">obc_p</span> <span class="id">main_step'</span> <span class="id">tr_sch_tr_G</span> <span class="id">sch_tr_G</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">setoid_rewrite</span> <span class="id">Eq_step</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.driver.Compiler.html#total_if">total_if</a></span>; <span class="id">cases</span>.<br/>
Qed.</div></details>
<br/>
<div class="doc">Correctness from NLustre to ASM  </div>
<span class="kwd">Lemma</span> <span class="id"><a name="behavior_nl_to_asm">behavior_nl_to_asm</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">G</span> <span class="id">P</span> <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Clo.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Typ.wt_global">wt_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.NLCorrectness.html#wt_ins">wt_ins</a></span> <span class="id">G</span> <span class="id">main</span> <span class="id">ins</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.Norm.normal_args">normal_args</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Instantiator.html#NL.CoindSem.sem_node">CoindSem.sem_node</a></span> <span class="id">G</span> <span class="id">main</span> (<span class="id"><a href="Velus.NLCorrectness.html#pStr">pStr</a></span> <span class="id">ins</span>) (<span class="id"><a href="Velus.NLCorrectness.html#pStr">pStr</a></span> <span class="id">outs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Velus.html#nl_to_asm">nl_to_asm</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">main</span>) <span class="id">G</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">T</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.x86.Asm.html#semantics">Asm.semantics</a></span> <span class="id">P</span>) (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Behaviors.html#Reacts">Reacts</a></span> <span class="id">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.NLCorrectness.html#bisim_IO">bisim_IO</a></span> <span class="id">G</span> <span class="id">main</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Velus.html#nl_to_asm">nl_to_asm</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * ????? <span class="id">Comp</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Velus.html#nl_to_cl">nl_to_cl</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">main</span>) <span class="id">G</span>) <span class="kwd">as</span> [<span class="id">p</span>|] <span class="id">eqn</span>: <span class="id">Comp'</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Comp</span>; <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span>  <span class="id"><a href="Velus.NLCorrectness.html#behavior_nl_to_cl">behavior_nl_to_cl</a></span> <span class="kwd">in</span> <span class="id">Comp'</span> <span class="kwd">as</span> (<span class="id">T</span> &amp; <span class="id">Beh</span> &amp; <span class="id">Bisim</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.ClightToAsm.html#reacts_trace_preservation">reacts_trace_preservation</a></span> <span class="kwd">in</span> <span class="id">Comp</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Velus.html#add_builtins_spec">add_builtins_spec</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> ? ?; <span class="id">discriminate</span>.<br/>
Qed.</div></details>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
