
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module CoindStreams</title>
<meta name="description" content="Documentation of Coq module CoindStreams" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module CoindStreams</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#ListNotations">List.ListNotations</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html">Lists.Streams</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Setoids.Setoid.html">Setoid</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.EqNat.html">Arith.EqNat</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Operators.html">Operators</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.FunctionalEnvironment.html">FunctionalEnvironment</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Clocks.html">Clocks</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.IndefiniteDescription.html">Logic.IndefiniteDescription</a></span>.<br/>
<br/>
<span class="kwd">Infix</span> "⊑" := (@<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> <span class="id">_</span> <span class="id">_</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>)) (<span class="tactic">at</span> <span class="id">level</span> 70, <span class="id">no</span> <span class="id">associativity</span>) : <span class="id">fenv_scope</span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="kwd">Type</span> <span class="id"><a name="COINDSTREAMS">COINDSTREAMS</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ids</span> : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Op</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.CoindStreams.html#Ids">Ids</a></span> <span class="id"><a href="Velus.CoindStreams.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Clocks</span> : <span class="id"><a href="Velus.Clocks.html#CLOCKS">CLOCKS</a></span> <span class="id"><a href="Velus.CoindStreams.html#Ids">Ids</a></span> <span class="id"><a href="Velus.CoindStreams.html#Op">Op</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux">OpAux</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">stream_scope</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.const_nth">const_nth</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">n</span> (<span class="id">c</span>: <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id">c</span>) # <span class="id">n</span> = <span class="id">c</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">unfold_Stv</span> <span class="id">xs</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> <span class="id">xs</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">xs</span> <span class="kwd">as</span> [[|]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">unfold_St</span> <span class="id">xs</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> <span class="id">xs</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">xs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.eq_EqSt">eq_EqSt</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span>}, <span class="id"><a href="http://coq.inria.fr/library/Coq.Relations.Relation_Definitions.html#inclusion">inclusion</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">A</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">xs</span> <span class="id">xs</span>' <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">A</span> : (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Cons">Cons</a></span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">A</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">Cons_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">A</span> : (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">A</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">hd_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">xs</span>, <span class="id">xs</span>'; <span class="id">inv</span> <span class="id">Exs</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">A</span> : (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">A</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">tl_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">xs</span>, <span class="id">xs</span>'; <span class="id">inv</span> <span class="id">Exs</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">A</span> (<span class="id">n</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth">Str_nth</a></span> <span class="id">A</span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">A</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">Str_nth_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="COINDSTREAMS.EqSts">EqSts</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span>: <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.EqSts">EqSts</a></span> (<span class="id">xss</span> <span class="id">yss</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts.A">A</a></span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts.A">A</a></span>) <span class="id">xss</span> <span class="id">yss</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id"><a name="COINDSTREAMS.EqSts_reflex">EqSts_reflex</a></span>: <span class="kwd">forall</span> <span class="id">xss</span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">xss</span> <span class="id">xss</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xss</span>; <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id"><a name="COINDSTREAMS.EqSts_sym">EqSts_sym</a></span>: <span class="kwd">forall</span> <span class="id">xss</span> <span class="id">yss</span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">xss</span> <span class="id">yss</span> -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">yss</span> <span class="id">xss</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xss</span>, <span class="id">yss</span>; <span class="tactic">intros</span> * <span class="id">H</span>; <span class="tactic">auto</span>; <span class="tactic">try</span> <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHxss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id"><a name="COINDSTREAMS.EqSts_trans">EqSts_trans</a></span>: <span class="kwd">forall</span> <span class="id">xss</span> <span class="id">yss</span> <span class="id">zss</span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">xss</span> <span class="id">yss</span> -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">yss</span> <span class="id">zss</span> -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">xss</span> <span class="id">zss</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xss</span>, <span class="id">yss</span>, <span class="id">zss</span>; <span class="tactic">intros</span> * <span class="id">Hx</span> <span class="id">Hy</span>; <span class="tactic">auto</span>; <span class="tactic">try</span> <span class="id">inv</span> <span class="id">Hx</span>; <span class="tactic">try</span> <span class="id">inv</span> <span class="id">Hy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">transitivity</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHxss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Relation</span> <span class="id">A</span> : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>)) (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span> <span class="id">proved</span> <span class="tactic">by</span> (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts_reflex">EqSts_reflex</a></span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="id">proved</span> <span class="tactic">by</span> (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts_sym">EqSts_sym</a></span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">transitivity</span> <span class="id">proved</span> <span class="tactic">by</span> (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts_trans">EqSts_trans</a></span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">EqStsrel</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">A</span> : (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#cons">List.cons</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">A</span> ==&gt; @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">A</span> ==&gt; @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">cons_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
 <span class="tactic">constructor</span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">A</span> : (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app">List.app</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">A</span> ==&gt; @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">A</span> ==&gt; @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">app_EqSts</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">xss</span> <span class="id">xss</span>' <span class="id">Exss</span> <span class="id">yss</span> <span class="id">yss</span>' <span class="id">Eyss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">yss</span>; <span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">xss</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xss</span>; <span class="tactic">induction</span> <span class="id">yss</span>; <span class="tactic">intros</span>; <span class="id">inv</span> <span class="id">Exss</span>; <span class="id">inv</span> <span class="id">Eyss</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">rewrite</span> 2 <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">IHxss</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> <span class="id">B</span> (<span class="id">P</span>: <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P_compat</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">B</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>) <span class="id">P</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">B</span>) <span class="id">P</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">B</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">Forall2_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">ys</span> <span class="id">ys</span>' <span class="id">Eys</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">ys</span>' <span class="id">Eys</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xs</span>, <span class="id">ys</span>; <span class="tactic">intros</span> ** <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">Eys</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">P_compat</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHxs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> <span class="id">B</span> (<span class="id">P</span>: <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P_compat</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">B</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span>) <span class="id">P</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">B</span>) <span class="id">P</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">B</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">Forall2_EqSt_iff</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">ys</span> <span class="id">ys</span>' <span class="id">Eys</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">revert</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">ys</span>' <span class="id">Eys</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xs</span>, <span class="id">ys</span>; <span class="tactic">intros</span> * <span class="id">Eys</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">Eys</span>; <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">take</span> (<span class="id">_</span> ≡ <span class="id">_</span>) <span class="id">and</span> <span class="tactic">rewrite</span> &lt;- <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">take</span> (<span class="id">_</span> ≡ <span class="id">_</span>) <span class="id">and</span> <span class="tactic">rewrite</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> <span class="id">B</span> (<span class="id">P</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P_compat</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">A</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>) <span class="id">P</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>) <span class="id">B</span> <span class="id">P</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">A</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">Forall2_EqSt</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">ys</span> <span class="id">ys</span>' <span class="id">Eys</span> <span class="id">xs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">ys</span>' <span class="id">Eys</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xs</span>, <span class="id">ys</span>; <span class="tactic">intros</span> ** <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">Eys</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">P_compat</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHxs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> <span class="id">B</span> (<span class="id">P</span>: <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P_compat</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">B</span> ==&gt;  <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#flip">Basics.flip</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>) <span class="id">P</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">B</span>) <span class="id">P</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">B</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#flip">Basics.flip</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">Forall2_EqSt_flip</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">ys</span> <span class="id">ys</span>' <span class="id">Eys</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">ys</span>' <span class="id">Eys</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xs</span>, <span class="id">ys</span>; <span class="tactic">intros</span> ** <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">Eys</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">P_compat</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHxs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> (<span class="id">P</span>: <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">C</span> -&gt; <span class="kwd">Prop</span>) <span class="id">xs</span> <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P_compat</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">C</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>) <span class="id">P</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (@<span class="id"><a href="Velus.Common.CommonList.html#Forall3">Forall3</a></span> <span class="id">A</span> <span class="id">B</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">C</span>) <span class="id">P</span> <span class="id">xs</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">C</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">Forall3_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Exy</span> <span class="id">Hxy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Exy</span> <span class="id">Hxy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xs</span>, <span class="id">ys</span>; <span class="tactic">intros</span> * <span class="id">Exy</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">Exy</span>; <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">take</span> (<span class="id">_</span> ≡ <span class="id">_</span>) <span class="id">and</span> <span class="tactic">rewrite</span> &lt;- <span class="id">it</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> <span class="id">B</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">B</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> (<span class="kwd">fun</span> (<span class="id">f</span> <span class="id">f</span>': <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">B</span>) =&gt; <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">xs</span>', <span class="id">xs</span> ≡ <span class="id">xs</span>' -&gt; <span class="id">f</span> <span class="id">xs</span> ≡ <span class="id">f</span>' <span class="id">xs</span>') ==&gt; @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">A</span> ==&gt; @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">B</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">map_st_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">f</span> <span class="id">f</span>' <span class="id">Ef</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Exs</span>; <span class="tactic">induction</span> <span class="id">xs</span>, <span class="id">xs</span>'; <span class="tactic">intros</span> * <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Ef</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHxs</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> <span class="id">B</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>) <span class="id">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> (<span class="kwd">fun</span> (<span class="id">f</span> <span class="id">f</span>': <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span> -&gt; <span class="id">B</span>) =&gt; <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">xs</span>', <span class="id">xs</span> ≡ <span class="id">xs</span>' -&gt; <span class="id">f</span> <span class="id">xs</span> = <span class="id">f</span>' <span class="id">xs</span>') ==&gt; @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">A</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">map_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">f</span> <span class="id">f</span>' <span class="id">Ef</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Exs</span>; <span class="tactic">induction</span> <span class="id">xs</span>, <span class="id">xs</span>'; <span class="tactic">intros</span> * <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Ef</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHxs</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> <span class="id">P</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P_compat</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">A</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>) <span class="id">P</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>) <span class="id">P</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">A</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">Forall_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x</span>; <span class="tactic">intros</span> * <span class="id">E</span> <span class="id">H</span>; <span class="tactic">inversion</span> <span class="id">E</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">P_compat</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">IHx</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">A</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">length_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x</span>; <span class="tactic">inversion_clear</span> 1; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.map_nth_error_orel">map_nth_error_orel</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>)) (<span class="id">f</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">B</span>) <span class="id">n</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">x</span> ≡ <span class="id">y</span> -&gt; <span class="id">f</span> <span class="id">x</span> ≡ <span class="id">f</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#orel">orel</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id">l</span> <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#orel">orel</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id">f</span> <span class="id">l</span>) <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">f</span> <span class="id">x</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> * ? <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#nth_error_nil">nth_error_nil</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="id">inv</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">E</span>; <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">map_nth_error_orel</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>)) (<span class="id">f</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">B</span>) <span class="id">n</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#orel">orel</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id">f</span> <span class="id">l</span>) <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#orel">orel</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id">l</span> <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">x</span> ≡ <span class="id">f</span> <span class="id">y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> * <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#nth_error_nil">nth_error_nil</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="id">inv</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">E</span>; <span class="tactic">exists</span> <span class="id">a</span>; <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">List.nth_error</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">A</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="Velus.Common.Common.html#orel">orel</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">nth_error_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x</span>; <span class="tactic">inversion_clear</span> 1; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#nth_error_nil">nth_error_nil</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">y1</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.EqSts_nil">EqSts_nil</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span>} (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">l</span> [] &lt;-&gt; <span class="id">l</span> = [].<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">split</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">inversion_clear</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="COINDSTREAMS.EqStN">EqStN</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="COINDSTREAMS.EqStN">EqStN</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN.A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN.A">A</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.EqSt0">EqSt0</a></span> : <span class="kwd">forall</span> <span class="id">xs1</span> <span class="id">xs2</span>, <span class="id">EqStN</span> 0 <span class="id">xs1</span> <span class="id">xs2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.EqStS">EqStS</a></span> : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">x1</span> <span class="id">xs1</span> <span class="id">x2</span> <span class="id">xs2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x1</span> = <span class="id">x2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">EqStN</span> <span class="id">n</span> <span class="id">xs1</span> <span class="id">xs2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">EqStN</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id">x1</span> ⋅ <span class="id">xs1</span>) (<span class="id">x2</span> ⋅ <span class="id">xs2</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.EqStN_spec">EqStN_spec</a></span> : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">xs1</span> <span class="id">xs2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">n</span> <span class="id">xs1</span> <span class="id">xs2</span>) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id">k</span> &lt; <span class="id">n</span> -&gt; <span class="id">xs1</span> # <span class="id">k</span> = <span class="id">xs2</span> # <span class="id">k</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">k</span> <span class="id">Hlt</span>. <span class="id">revert</span> <span class="id">xs1</span> <span class="id">xs2</span> <span class="id">n</span> <span class="id">Heq</span> <span class="id">Hlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">k</span>; <span class="tactic">intros</span> ?? [|] <span class="id">Heq</span> <span class="id">Hlt</span>; <span class="tactic">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">inv</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>. <span class="id">inv</span> <span class="id">Heq</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHk</span>; <span class="tactic">eauto</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">xs1</span> <span class="id">xs2</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_St</span> <span class="id">xs1</span>. <span class="id">unfold_St</span> <span class="id">xs2</span>. <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">specialize</span> (<span class="id">Heq</span> 0). <span class="tactic">apply</span> <span class="id">Heq</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHn</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">Heq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>)); <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.EqStN_EqSt">EqStN_EqSt</a></span> : <span class="kwd">forall</span> <span class="id">xs1</span> <span class="id">xs2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">n</span> <span class="id">xs1</span> <span class="id">xs2</span>) &lt;-&gt; <span class="id">xs1</span> ≡ <span class="id">xs2</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN_spec">EqStN_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> ?? <span class="id">Hk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.EqStN_EqSts">EqStN_EqSts</a></span> : <span class="kwd">forall</span> <span class="id">xs1</span> <span class="id">xs2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">n</span>) <span class="id">xs1</span> <span class="id">xs2</span>) &lt;-&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id">xs1</span> <span class="id">xs2</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> * <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall2">Forall2_forall2</a></span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">specialize</span> (<span class="id">Heq</span> 0). <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> * <span class="id">Hlen</span> ??; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN_EqSt">EqStN_EqSt</a></span>; <span class="tactic">intros</span> <span class="id">n0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Heq</span> <span class="id">n0</span>). <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall2">Forall2_forall2</a></span> <span class="kwd">in</span> <span class="id">Heq</span> <span class="kwd">as</span> (<span class="id">_</span>&amp;<span class="id">Heq</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span> ?? <span class="id">_</span> <span class="id">_</span> <span class="id">Heq</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN_EqSt">EqStN_EqSt</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.EqStN_weaken">EqStN_weaken</a></span> : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">n</span> <span class="id">xs1</span> <span class="id">xs2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">n</span> <span class="id">xs1</span> <span class="id">xs2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">k</span> <span class="id">xs1</span> <span class="id">xs2</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hlt</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN_spec">EqStN_spec</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN_spec">EqStN_spec</a></span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="tactic">eauto</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.EqStN_weaken_S">EqStN_weaken_S</a></span> : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">xs1</span> <span class="id">xs2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">xs1</span> <span class="id">xs2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">n</span> <span class="id">xs1</span> <span class="id">xs2</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN_weaken">EqStN_weaken</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Hint</span> <span class="kwd">Constructors</span> <span class="id"><a href="Velus.CoindStreams.html#EqStN">EqStN</a></span> : <span class="id">coindstreams</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="COINDSTREAMS.EqStN_refl">EqStN_refl</a></span> {<span class="id">A</span>} <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Reflexive">Reflexive</a></span> (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">A</span> <span class="id">n</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?. <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN_EqSt">EqStN_EqSt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="COINDSTREAMS.EqStN_sym">EqStN_sym</a></span> {<span class="id">A</span>} <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Symmetric">Symmetric</a></span> (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">A</span> <span class="id">n</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> ?? <span class="id">Heq</span>; <span class="id">inv</span> <span class="id">Heq</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coindstreams</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="COINDSTREAMS.EqStN_trans">EqStN_trans</a></span> {<span class="id">A</span>} <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Transitive">Transitive</a></span> (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">A</span> <span class="id">n</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> ??? <span class="id">Heq1</span> <span class="id">Heq2</span>; <span class="id">inv</span> <span class="id">Heq1</span>; <span class="id">inv</span> <span class="id">Heq2</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coindstreams</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">A</span> <span class="id">n</span> : (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">A</span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">EqStN_morph</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> (?&amp;?) (?&amp;?) <span class="id">Heq1</span> (?&amp;?) (?&amp;?) <span class="id">Heq2</span> <span class="id">Heq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Heq1</span>; <span class="id">inv</span> <span class="id">Heq2</span>; <span class="id">inv</span> <span class="id">Heq</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">constructor</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) <span class="id">n</span> : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#map">map</a></span> <span class="id">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">_</span> <span class="id">n</span> ==&gt; @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">_</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">map_EqStN</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN_spec">EqStN_spec</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN_spec">EqStN_spec</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> 2 <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>, <span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">A generic function to build a coinductive Stream. </div>
&nbsp;&nbsp;<span class="kwd">CoFixpoint</span> <span class="id"><a name="COINDSTREAMS.init_from">init_from</a></span> {<span class="id">A</span>} (<span class="id">n</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">f</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id">A</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">n</span> ⋅ <span class="id">init_from</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">f</span>.<br/>
<br/>
<div class="doc">A basic definition-rewriting lemma.  </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.init_from_n">init_from_n</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span>} (<span class="id">f</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id">A</span>) <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.init_from">init_from</a></span> <span class="id">n</span> <span class="id">f</span> = <span class="id">f</span> <span class="id">n</span> ⋅ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.init_from">init_from</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">f</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">The <span class="bracket"><span class="id">m</span></span>th element of the built stream, starting from <span class="bracket"><span class="id">n</span></span>,
        is the result of the application of <span class="bracket"><span class="id">f</span></span> at <span class="bracket">(<span class="id">m</span>+<span class="id">n</span>)</span>. </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.init_from_nth">init_from_nth</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">m</span> <span class="id">n</span> (<span class="id">f</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.init_from">init_from</a></span> <span class="id">n</span> <span class="id">f</span>) # <span class="id">m</span> = <span class="id">f</span> (<span class="id">m</span> + <span class="id">n</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth">Str_nth</a></span>; <span class="tactic">induction</span> <span class="id">m</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">IHm</span>, &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#plus_n_Sm">plus_n_Sm</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">Taking the tail of a built Stream from <span class="bracket"><span class="id">n</span></span> is building it from <span class="bracket"><span class="id">S</span> <span class="id">n</span></span>. </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.init_from_tl">init_from_tl</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">n</span> (<span class="id">f</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.init_from">init_from</a></span> <span class="id">n</span> <span class="id">f</span>) = <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.init_from">init_from</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">f</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.init_from_n">init_from_n</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">A generalization for multiple tails. </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.init_from_nth_tl">init_from_nth_tl</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">n</span> <span class="id">m</span> (<span class="id">f</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_tl">Str_nth_tl</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.init_from">init_from</a></span> <span class="id">m</span> <span class="id">f</span>) = <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.init_from">init_from</a></span> (<span class="id">n</span> + <span class="id">m</span>) <span class="id">f</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">IHn</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.add_succ_r">Nat.add_succ_r</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> Typing of streams </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.wt_stream">wt_stream</a></span> (<span class="id">sv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>) (<span class="id">ty</span> : <span class="id"><a href="Velus.CoindStreams.html#Op.type">type</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonStreams.html#SForall">SForall</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.CoindStreams.html#OpAux.wt_svalue">wt_svalue</a></span> <span class="id">v</span> <span class="id">ty</span>) <span class="id">sv</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.wt_streams">wt_streams</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.CoindStreams.html#Op.type">type</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.wt_stream">wt_stream</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.wt_stream_enum">wt_stream_enum</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">tx</span> <span class="id">tn</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.wt_stream">wt_stream</a></span> <span class="id">xs</span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Tenum">Tenum</a></span> <span class="id">tx</span> <span class="id">tn</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonStreams.html#SForall">SForall</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Vscalar">Vscalar</a></span> <span class="id">_</span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span>; <span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">Hxs</span>. <span class="tactic">setoid_rewrite</span> <span class="id">Hxs</span> <span class="kwd">in</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
<h2> Synchronous operators </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">CoFixpoint</span> <span class="id"><a name="COINDSTREAMS.const">const</a></span> (<span class="id">b</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">c</span>: <span class="id"><a href="Velus.CoindStreams.html#Op.cconst">cconst</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">b</span> <span class="kwd">then</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Vscalar">Vscalar</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.sem_cconst">sem_cconst</a></span> <span class="id">c</span>)) <span class="kwd">else</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) ⋅ <span class="id">const</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">b</span>) <span class="id">c</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">CoFixpoint</span> <span class="id"><a name="COINDSTREAMS.enum">enum</a></span> (<span class="id">b</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">c</span>: <span class="id"><a href="Velus.CoindStreams.html#Op.enumtag">enumtag</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">b</span> <span class="kwd">then</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">c</span>) <span class="kwd">else</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) ⋅ <span class="id">enum</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">b</span>) <span class="id">c</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">CoInductive</span> <span class="id"><a name="COINDSTREAMS.lift1">lift1</a></span> (<span class="id">op</span>: <span class="id"><a href="Velus.CoindStreams.html#Op.unop">unop</a></span>) (<span class="id">ty</span>: <span class="id"><a href="Velus.CoindStreams.html#Op.type">type</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.Lift1A">Lift1A</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift1</span> <span class="id">op</span> <span class="id">ty</span> <span class="id">xs</span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift1</span> <span class="id">op</span> <span class="id">ty</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">xs</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">rs</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.Lift1P">Lift1P</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">r</span> <span class="id">xs</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#Op.sem_unop">sem_unop</a></span> <span class="id">op</span> <span class="id">x</span> <span class="id">ty</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift1</span> <span class="id">op</span> <span class="id">ty</span> <span class="id">xs</span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift1</span> <span class="id">op</span> <span class="id">ty</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">x</span> ⋅ <span class="id">xs</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">r</span> ⋅ <span class="id">rs</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">CoInductive</span> <span class="id"><a name="COINDSTREAMS.lift2">lift2</a></span> (<span class="id">op</span>: <span class="id"><a href="Velus.CoindStreams.html#Op.binop">binop</a></span>) (<span class="id">ty1</span> <span class="id">ty2</span>: <span class="id"><a href="Velus.CoindStreams.html#Op.type">type</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.Lift2A">Lift2A</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift2</span> <span class="id">op</span> <span class="id">ty1</span> <span class="id">ty2</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift2</span> <span class="id">op</span> <span class="id">ty1</span> <span class="id">ty2</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">xs</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">ys</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">rs</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.Lift2ScalarP">Lift2ScalarP</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">r</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#Op.sem_binop">sem_binop</a></span> <span class="id">op</span> <span class="id">x</span> <span class="id">ty1</span> <span class="id">y</span> <span class="id">ty2</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift2</span> <span class="id">op</span> <span class="id">ty1</span> <span class="id">ty2</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift2</span> <span class="id">op</span> <span class="id">ty1</span> <span class="id">ty2</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">x</span> ⋅ <span class="id">xs</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">y</span> ⋅ <span class="id">ys</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">r</span> ⋅ <span class="id">rs</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">CoInductive</span> <span class="id"><a name="COINDSTREAMS.liftn">liftn</a></span> (<span class="id">sem_extern</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.CoindStreams.html#Op.cvalue">cvalue</a></span> -&gt; <span class="id"><a href="Velus.CoindStreams.html#Op.cvalue">cvalue</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.LiftNA">LiftNA</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xss</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">xs</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">xs</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">xss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">liftn</span> <span class="id">sem_extern</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">_</span>) <span class="id">xss</span>) <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">liftn</span> <span class="id">sem_extern</span> <span class="id">xss</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">ys</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.LiftNScalarP">LiftNScalarP</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">xss</span> <span class="id">y</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">xs</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">xs</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Vscalar">Vscalar</a></span> <span class="id">x</span>)) <span class="id">xss</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sem_extern</span> <span class="id">xs</span> <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">liftn</span> <span class="id">sem_extern</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">_</span>) <span class="id">xss</span>) <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">liftn</span> <span class="id">sem_extern</span> <span class="id">xss</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Vscalar">Vscalar</a></span> <span class="id">y</span>) ⋅ <span class="id">ys</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">CoInductive</span> <span class="id"><a name="COINDSTREAMS.when">when</a></span> (<span class="id">c</span>: <span class="id"><a href="Velus.CoindStreams.html#Op.enumtag">enumtag</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.WhenA">WhenA</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">cs</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">when</span> <span class="id">c</span> <span class="id">xs</span> <span class="id">cs</span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">when</span> <span class="id">c</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">xs</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">cs</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">rs</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.WhenPA">WhenPA</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">c</span>' <span class="id">xs</span> <span class="id">cs</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">when</span> <span class="id">c</span> <span class="id">xs</span> <span class="id">cs</span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span> &lt;&gt; <span class="id">c</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">when</span> <span class="id">c</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">x</span> ⋅ <span class="id">xs</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">c</span>') ⋅ <span class="id">cs</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">rs</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.WhenPP">WhenPP</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">cs</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">when</span> <span class="id">c</span> <span class="id">xs</span> <span class="id">cs</span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">when</span> <span class="id">c</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">x</span> ⋅ <span class="id">xs</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">c</span>) ⋅ <span class="id">cs</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">x</span> ⋅ <span class="id">rs</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">CoInductive</span> <span class="id"><a name="COINDSTREAMS.merge">merge</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.MergeA">MergeA</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ess</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">merge</span> <span class="id">xs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; (<span class="id">i</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">es</span>)) <span class="id">ess</span>) <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>) = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">ess</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">merge</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">xs</span>) <span class="id">ess</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">rs</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.MergeP">MergeP</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">xs</span> <span class="id">ess</span> <span class="id">rs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">merge</span> <span class="id">xs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; (<span class="id">i</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">es</span>)) <span class="id">ess</span>) <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">List.Exists</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; <span class="id">i</span> = <span class="id">c</span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">es</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span>) <span class="id">ess</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; <span class="id">i</span> &lt;&gt; <span class="id">c</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">es</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">ess</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">merge</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">c</span>) ⋅ <span class="id">xs</span>) <span class="id">ess</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span> ⋅ <span class="id">rs</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">CoInductive</span> <span class="tactic">case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.CaseA">CaseA</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ess</span> <span class="id">d</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> <span class="id">xs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; (<span class="id">i</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">es</span>)) <span class="id">ess</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">_</span>) <span class="id">d</span>) <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>) = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">ess</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#LiftO">LiftO</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> (<span class="kwd">fun</span> <span class="id">d</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">d</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">d</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">xs</span>) <span class="id">ess</span> <span class="id">d</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">rs</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.CaseP">CaseP</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">xs</span> <span class="id">ess</span> <span class="id">d</span> <span class="id">rs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> <span class="id">xs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; (<span class="id">i</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">es</span>)) <span class="id">ess</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">_</span>) <span class="id">d</span>) <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>) &lt;&gt; <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">ess</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#LiftO">LiftO</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> (<span class="kwd">fun</span> <span class="id">d</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">d</span> &lt;&gt; <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">d</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">List.Exists</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; <span class="id">i</span> = <span class="id">c</span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">es</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span>) <span class="id">ess</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">c</span>) ⋅ <span class="id">xs</span>) <span class="id">ess</span> <span class="id">d</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span> ⋅ <span class="id">rs</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.CasePDef">CasePDef</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">xs</span> <span class="id">ess</span> <span class="id">d</span> <span class="id">rs</span> <span class="id">vd</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> <span class="id">xs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; (<span class="id">i</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">es</span>)) <span class="id">ess</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d</span>) <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>) &lt;&gt; <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">ess</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">es</span>) &lt;&gt; <span class="id">c</span>) <span class="id">ess</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">c</span>) ⋅ <span class="id">xs</span>) <span class="id">ess</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">vd</span> ⋅ <span class="id">d</span>)) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">vd</span> ⋅ <span class="id">rs</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">op</span> <span class="id">t</span> : (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.lift1">lift1</a></span> <span class="id">op</span> <span class="id">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">lift1_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">es</span> <span class="id">es</span>' <span class="id">Ees</span> <span class="id">ys</span> <span class="id">ys</span>' <span class="id">Eys</span> <span class="id">Lift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">es</span>' <span class="kwd">as</span> [[]], <span class="id">ys</span>' <span class="kwd">as</span> [[]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Lift</span>; <span class="id">inv</span> <span class="id">Eys</span>; <span class="id">inv</span> <span class="id">Ees</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>; <span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">inv</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">op</span> <span class="id">t1</span> <span class="id">t2</span> : (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.lift2">lift2</a></span> <span class="id">op</span> <span class="id">t1</span> <span class="id">t2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">lift2_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">e1s</span> <span class="id">e1s</span>' <span class="id">Ee1s</span> <span class="id">e2s</span> <span class="id">e2s</span>' <span class="id">Ee2s</span> <span class="id">ys</span> <span class="id">ys</span>' <span class="id">Eys</span> <span class="id">Lift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e1s</span>' <span class="kwd">as</span> [[]], <span class="id">e2s</span>' <span class="kwd">as</span> [[]], <span class="id">ys</span>' <span class="kwd">as</span> [[]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Lift</span>; <span class="id">inv</span> <span class="id">Eys</span>; <span class="id">inv</span> <span class="id">Ee1s</span>; <span class="id">inv</span> <span class="id">Ee2s</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>; <span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">inv</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H3</span>; <span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.merge">merge</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">merge_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">cs</span> <span class="id">cs</span>' <span class="id">Ecs</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">ys</span>' <span class="id">Eys</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">cs</span>' <span class="kwd">as</span> [[]], <span class="id">ys</span>' <span class="kwd">as</span> [[]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">Ecs</span>; <span class="id">inv</span> <span class="id">Eys</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="id">take</span> (<span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="tactic">case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">case_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">cs</span> <span class="id">cs</span>' <span class="id">Ecs</span> <span class="id">xs</span> <span class="id">d</span> <span class="id">ys</span> <span class="id">ys</span>' <span class="id">Eys</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">cs</span>' <span class="kwd">as</span> [[]], <span class="id">ys</span>' <span class="kwd">as</span> [[]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">Ecs</span>; <span class="id">inv</span> <span class="id">Eys</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="id">take</span> (<span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="id">take</span> (<span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.CasePDef">CasePDef</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="tactic">case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">xs1</span> <span class="id">xs2</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">xs1</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">xs2</span>) /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">xs1</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">xs2</span>)) ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">case_EqStS</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">cs</span> <span class="id">xs1</span> <span class="id">xs2</span> <span class="id">Exs</span> <span class="id">d</span> <span class="id">ys</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (?&amp;?&amp;?) (?&amp;?&amp;?) <span class="id">_</span> <span class="id">_</span> (?&amp;?&amp;?); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">clear</span> - <span class="id">Exs</span> <span class="id">H1</span>. <span class="tactic">induction</span> <span class="id">Exs</span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> (?&amp;?&amp;?), <span class="id">y</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (?&amp;?&amp;?) (?&amp;?&amp;?) <span class="id">_</span> <span class="id">_</span> (?&amp;?&amp;?); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">clear</span> - <span class="id">Exs</span> <span class="id">H1</span>. <span class="tactic">induction</span> <span class="id">Exs</span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> (?&amp;?&amp;?), <span class="id">y</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">clear</span> - <span class="id">Exs</span> <span class="id">H3</span>. <span class="tactic">induction</span> <span class="id">Exs</span>; <span class="id">inv</span> <span class="id">H3</span>; <span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> (?&amp;?&amp;?), <span class="id">y</span> <span class="kwd">as</span> (?&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;?&amp;?), <span class="id">H1</span> <span class="kwd">as</span> (?&amp;?); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>; <span class="tactic">auto</span>. <span class="tactic">right</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.CasePDef">CasePDef</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (?&amp;?&amp;?) (?&amp;?&amp;?) <span class="id">_</span> <span class="id">_</span> (?&amp;?&amp;?); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">clear</span> - <span class="id">Exs</span> <span class="id">H1</span>. <span class="tactic">induction</span> <span class="id">Exs</span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> (?&amp;?&amp;?), <span class="id">y</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">clear</span> - <span class="id">Exs</span> <span class="id">H2</span>. <span class="tactic">induction</span> <span class="id">Exs</span>; <span class="id">inv</span> <span class="id">H2</span>; <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> (?&amp;?&amp;?), <span class="id">y</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> exp level synchronous operators specifications
        To ease the use of coinductive hypotheses to prove non-coinductive
        goals, we give for each coinductive predicate an indexed specification,
        reflecting the shapes of the involved streams pointwise speaking.
        In general this specification is a disjunction with a factor for each
        case of the predicate.
        The corresponding lemmas simply go by induction on <span class="bracket"><span class="id">n</span></span> and by inversion
        of the coinductive hypothesis for the direct direction, and by coinduction
        on the converse.
   </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.const_spec">const_spec</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">c</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> <span class="id">b</span> <span class="id">c</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">xs</span> # <span class="id">n</span> = <span class="kwd">if</span> <span class="id">b</span> # <span class="id">n</span> <span class="kwd">then</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Vscalar">Vscalar</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.sem_cconst">sem_cconst</a></span> <span class="id">c</span>)) <span class="kwd">else</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">E</span> <span class="id">n</span>; <span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">xs</span>; <span class="id">revert</span> <span class="id">c</span> <span class="id">b</span>; <span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">b</span>; <span class="id">unfold_Stv</span> <span class="id">xs</span>; <span class="id">inv</span> <span class="id">E</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">discriminate</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">xs</span> <span class="id">c</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">COFIX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">b</span>; <span class="id">unfold_Stv</span> <span class="id">xs</span>; <span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">specialize</span> (<span class="id">E</span> 0); <span class="id">now</span> <span class="id">inv</span> <span class="id">E</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">COFIX</span>; <span class="tactic">intro</span> <span class="id">n</span>; <span class="tactic">specialize</span> (<span class="id">E</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)); <span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.const_true">const_true</a></span>: <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">c</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bs</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> <span class="id">bs</span> <span class="id">c</span>) # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Vscalar">Vscalar</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.sem_cconst">sem_cconst</a></span> <span class="id">c</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt_reflex">EqSt_reflex</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> <span class="id">bs</span> <span class="id">c</span>)) <span class="kwd">as</span> <span class="id">Hconst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_spec">const_spec</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hconst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hconst</span>, <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.const_false">const_false</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">c</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bs</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> <span class="id">bs</span> <span class="id">c</span>) # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt_reflex">EqSt_reflex</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> <span class="id">bs</span> <span class="id">c</span>)) <span class="kwd">as</span> <span class="id">Hconst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_spec">const_spec</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hconst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hconst</span>, <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id">const_nth</span>' : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">c</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> <span class="id">bs</span> <span class="id">c</span>) # <span class="id">n</span> = <span class="kwd">if</span> (<span class="id">bs</span> # <span class="id">n</span>) <span class="kwd">then</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Vscalar">Vscalar</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.sem_cconst">sem_cconst</a></span> <span class="id">c</span>)) <span class="kwd">else</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">bs</span> <span class="id">c</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">bs</span> # <span class="id">n</span>) <span class="id">eqn</span>:<span class="id">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_true">const_true</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_false">const_false</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.const_inv1">const_inv1</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">b</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> <span class="id">b</span> <span class="id">c</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">b</span>', <span class="id">s</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> <span class="id">b</span>' <span class="id">c</span> /\ <span class="id">b</span> ≡ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> ⋅ <span class="id">b</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">b</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">b</span>. <span class="tactic">split</span>; <span class="tactic">symmetry</span>; <span class="tactic">auto</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.const_inv2">const_inv2</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">c</span>' <span class="id">b</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> <span class="id">b</span> <span class="id">c</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">c</span>' ⋅ <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">b</span>', <span class="id">s</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> <span class="id">b</span>' <span class="id">c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">b</span> ≡ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> ⋅ <span class="id">b</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">c</span>' = <span class="id"><a href="Velus.CoindStreams.html#Op.Vscalar">Vscalar</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.sem_cconst">sem_cconst</a></span> <span class="id">c</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">b</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">b</span>. <span class="tactic">split</span>. <span class="tactic">symmetry</span>. <span class="tactic">assumption</span>. <span class="tactic">split</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.const_tl">const_tl</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">b</span> <span class="id">v</span> <span class="id">tl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> <span class="id">b</span> <span class="id">c</span> ≡ <span class="id">v</span> ⋅ <span class="id">tl</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">b</span>) <span class="id">c</span> ≡ <span class="id">tl</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">b</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.const_Cons">const_Cons</a></span> : <span class="kwd">forall</span> <span class="id">c</span> <span class="id">b</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> (<span class="id">b</span> ⋅ <span class="id">bs</span>) <span class="id">c</span> ≡<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id">b</span> <span class="kwd">then</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Vscalar">Vscalar</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.sem_cconst">sem_cconst</a></span> <span class="id">c</span>)) <span class="kwd">else</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) ⋅ (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> <span class="id">bs</span> <span class="id">c</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> <span class="tactic">at</span> 1; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.enum_spec">enum_spec</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">c</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.enum">enum</a></span> <span class="id">b</span> <span class="id">c</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">xs</span> # <span class="id">n</span> = <span class="kwd">if</span> <span class="id">b</span> # <span class="id">n</span> <span class="kwd">then</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">c</span>) <span class="kwd">else</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">E</span> <span class="id">n</span>; <span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">xs</span>; <span class="id">revert</span> <span class="id">c</span> <span class="id">b</span>; <span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">b</span>; <span class="id">unfold_Stv</span> <span class="id">xs</span>; <span class="id">inv</span> <span class="id">E</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">discriminate</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">xs</span> <span class="id">c</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">COFIX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">b</span>; <span class="id">unfold_Stv</span> <span class="id">xs</span>; <span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">specialize</span> (<span class="id">E</span> 0); <span class="id">now</span> <span class="id">inv</span> <span class="id">E</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">COFIX</span>; <span class="tactic">intro</span> <span class="id">n</span>; <span class="tactic">specialize</span> (<span class="id">E</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)); <span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.enum_true">enum_true</a></span>: <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">c</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bs</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.enum">enum</a></span> <span class="id">bs</span> <span class="id">c</span>) # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">c</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt_reflex">EqSt_reflex</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.enum">enum</a></span> <span class="id">bs</span> <span class="id">c</span>)) <span class="kwd">as</span> <span class="id">Henum</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.enum_spec">enum_spec</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Henum</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Henum</span>, <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.enum_false">enum_false</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">c</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bs</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.enum">enum</a></span> <span class="id">bs</span> <span class="id">c</span>) # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt_reflex">EqSt_reflex</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.enum">enum</a></span> <span class="id">bs</span> <span class="id">c</span>)) <span class="kwd">as</span> <span class="id">Henum</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.enum_spec">enum_spec</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Henum</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Henum</span>, <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id">enum_nth</span>' : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">c</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.enum">enum</a></span> <span class="id">bs</span> <span class="id">c</span>) # <span class="id">n</span> = <span class="kwd">if</span> (<span class="id">bs</span> # <span class="id">n</span>) <span class="kwd">then</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">c</span>) <span class="kwd">else</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">bs</span> <span class="id">c</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">bs</span> # <span class="id">n</span>) <span class="id">eqn</span>:<span class="id">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.enum_true">enum_true</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.enum_false">enum_false</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">n</span> := <span class="tactic">fresh</span> "<span class="id">n</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">CoFix</span>; <span class="tactic">intro</span> <span class="id">n</span>; <span class="tactic">specialize</span> (<span class="id">H</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.when_spec">when_spec</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">xs</span> <span class="id">cs</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when">when</a></span> <span class="id">c</span> <span class="id">xs</span> <span class="id">cs</span> <span class="id">rs</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">cs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">rs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">x</span> <span class="id">c</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">cs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">c</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">c</span> &lt;&gt; <span class="id">c</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">rs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">cs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">rs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">x</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">H</span> <span class="id">n</span>; <span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">xs</span>; <span class="id">revert</span> <span class="id">cs</span> <span class="id">rs</span> <span class="id">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">right</span>; <span class="tactic">left</span>. <span class="tactic">do</span> 2 <span class="tactic">eexists</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">right</span>; <span class="tactic">right</span>. <span class="tactic">do</span> 2 <span class="tactic">eexists</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">xs</span> <span class="id">cs</span> <span class="id">rs</span> <span class="id">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="tactic">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">xs</span>; <span class="id">unfold_Stv</span> <span class="id">cs</span>; <span class="id">unfold_Stv</span> <span class="id">rs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">specialize</span> (<span class="id">H</span> 0); <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?)]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">constructor</span>; <span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">v0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="tactic">try</span> (<span class="tactic">specialize</span> (<span class="id">H</span> 0); <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?)]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">specialize</span> (<span class="id">H</span> 0); <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?)]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">H</span> 0) <span class="kwd">as</span> [(?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?&amp;?)|(?&amp; <span class="id">E</span> &amp; <span class="id">E</span>' &amp; <span class="id">E</span>'')]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span> <span class="kwd">in</span> <span class="id">E</span>, <span class="id">E</span>', <span class="id">E</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">E</span>, <span class="id">E</span>', <span class="id">E</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.lift1_spec">lift1_spec</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">op</span> <span class="id">ty</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.lift1">lift1</a></span> <span class="id">op</span> <span class="id">ty</span> <span class="id">xs</span> <span class="id">ys</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> /\ <span class="id">ys</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.CoindStreams.html#Op.sem_unop">sem_unop</a></span> <span class="id">op</span> <span class="id">x</span> <span class="id">ty</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">ys</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">y</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</span></div>
<div class="proofscript" id="proof58">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">H</span> <span class="id">n</span>; <span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">xs</span>; <span class="id">revert</span> <span class="id">ys</span> <span class="id">ty</span> <span class="id">op</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>. <span class="tactic">do</span> 2 <span class="tactic">eexists</span>; <span class="tactic">intuition</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">ty</span> <span class="id">op</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="tactic">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">xs</span>; <span class="id">unfold_Stv</span> <span class="id">ys</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">specialize</span> (<span class="id">H</span> 0); <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?)]; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">constructor</span>; <span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">H</span> 0) <span class="kwd">as</span> [(?&amp;?)|(?&amp;?&amp; <span class="id">E</span> &amp;?&amp; <span class="id">E</span>')]; <span class="tactic">try</span> <span class="tactic">discriminate</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span> <span class="kwd">in</span> <span class="id">E</span>, <span class="id">E</span>'; <span class="id">inv</span> <span class="id">E</span>; <span class="id">inv</span> <span class="id">E</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.lift2_spec">lift2_spec</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">op</span> <span class="id">ty1</span> <span class="id">ty2</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.lift2">lift2</a></span> <span class="id">op</span> <span class="id">ty1</span> <span class="id">ty2</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">ys</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">zs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">ys</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.CoindStreams.html#Op.sem_binop">sem_binop</a></span> <span class="id">op</span> <span class="id">x</span> <span class="id">ty1</span> <span class="id">y</span> <span class="id">ty2</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">zs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">z</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof59')">Proof.</span></div>
<div class="proofscript" id="proof59">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">H</span> <span class="id">n</span>; <span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">xs</span>; <span class="id">revert</span> <span class="id">ys</span> <span class="id">zs</span> <span class="id">ty1</span> <span class="id">ty2</span> <span class="id">op</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>. <span class="tactic">do</span> 3 <span class="tactic">eexists</span>; <span class="tactic">intuition</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span> <span class="id">ty1</span> <span class="id">ty2</span> <span class="id">op</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="tactic">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">xs</span>; <span class="id">unfold_Stv</span> <span class="id">ys</span>; <span class="id">unfold_Stv</span> <span class="id">zs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">specialize</span> (<span class="id">H</span> 0); <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)]; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">constructor</span>; <span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">H</span> 0) <span class="kwd">as</span> [(?&amp;?&amp;?)|(?&amp;?&amp;?&amp; <span class="id">E</span> &amp; <span class="id">E</span>' &amp;?&amp; <span class="id">E</span>'')]; <span class="tactic">try</span> <span class="tactic">discriminate</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span> <span class="kwd">in</span> <span class="id">E</span>, <span class="id">E</span>', <span class="id">E</span>''; <span class="id">inv</span> <span class="id">E</span>; <span class="id">inv</span> <span class="id">E</span>'; <span class="id">inv</span> <span class="id">E</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.liftn_spec">liftn_spec</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sem_extern</span> <span class="id">xss</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.liftn">liftn</a></span> <span class="id">sem_extern</span> <span class="id">xss</span> <span class="id">ys</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">xs</span> =&gt; <span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">xss</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">ys</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">xs</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">xs</span> <span class="id">x</span> =&gt; <span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Vscalar">Vscalar</a></span> <span class="id">x</span>)) <span class="id">xss</span> <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">sem_extern</span> <span class="id">xs</span> <span class="id">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">ys</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Vscalar">Vscalar</a></span> <span class="id">y</span>))).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof60')">Proof.</span></div>
<div class="proofscript" id="proof60">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">H</span> <span class="id">n</span>; <span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">xss</span>; <span class="id">revert</span> <span class="id">ys</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>. <span class="tactic">do</span> 3 <span class="tactic">eexists</span>; <span class="tactic">intuition</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">edestruct</span> <span class="id">IHn</span> <span class="kwd">as</span> [(?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?)]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3:<span class="tactic">left</span>; <span class="tactic">split</span>; <span class="id">simpl_Forall</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">right</span>; <span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">eauto</span>; <span class="id">simpl_Forall</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">xss</span> <span class="id">ys</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="tactic">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">ys</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">specialize</span> (<span class="id">H</span> 0); <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?)]; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> (<span class="id">H</span> 0) <span class="kwd">as</span> [(?&amp;?)|(?&amp;?&amp;?&amp; <span class="id">E</span> &amp; <span class="id">E</span>')]; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?)]; [<span class="tactic">left</span>|<span class="tactic">right</span>]; <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">H</span> 0) <span class="kwd">as</span> [(?&amp;?)|(?&amp;?&amp;?&amp; <span class="id">E</span> &amp; <span class="id">E</span>')]; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">E</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?)]; [<span class="tactic">left</span>|<span class="tactic">right</span>]; <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">sem_extern</span> : (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.liftn">liftn</a></span> <span class="id">sem_extern</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">liftn_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof61')">Proof.</span></div>
<div class="proofscript" id="proof61">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Heq1</span> * <span class="id">Heq2</span> <span class="id">Hlift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.liftn_spec">liftn_spec</a></span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.liftn_spec">liftn_spec</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hlift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Heq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hlift</span> <span class="kwd">as</span> [(?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?)]; [<span class="tactic">left</span>|<span class="tactic">right</span>]; <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore1">Forall2_ignore1</a></span> <span class="kwd">in</span> <span class="id">Heq1</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id">_</span> ≡ <span class="id">_</span>) <span class="id">and</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">it</span>; <span class="tactic">setoid_rewrite</span> &lt;-<span class="id">it</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_swap_args">Forall2_swap_args</a></span> <span class="kwd">in</span> <span class="id">Heq1</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_trans_ex">Forall2_trans_ex</a></span> <span class="kwd">in</span> <span class="id">H</span>; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id">_</span> ≡ <span class="id">_</span>) <span class="id">and</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">it</span>; <span class="tactic">setoid_rewrite</span> &lt;-<span class="id">it</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> cexp level synchronous operators specifications </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.merge_spec">merge_spec</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ess</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.merge">merge</a></span> <span class="id">xs</span> <span class="id">ess</span> <span class="id">rs</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>) # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">ess</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">rs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">c</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">List.Exists</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; <span class="id">i</span> = <span class="id">c</span> /\ <span class="id">es</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span>) <span class="id">ess</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; <span class="id">i</span> &lt;&gt; <span class="id">c</span> -&gt; <span class="id">es</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">ess</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">rs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof62')">Proof.</span></div>
<div class="proofscript" id="proof62">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> * <span class="id">H</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">xs</span>; <span class="id">revert</span> <span class="id">ess</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">do</span> 2 <span class="tactic">eexists</span>; <span class="tactic">intuition</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">take</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.merge">merge</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">apply</span> <span class="id">IHn</span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> [(?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">left</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">right</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">take</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.merge">merge</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">apply</span> <span class="id">IHn</span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> [(?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">left</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">right</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">clear</span> <span class="id">H1</span>. <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">xs</span> <span class="id">ess</span> <span class="id">rs</span>; <span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="tactic">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">xs</span>; <span class="id">unfold_Stv</span> <span class="id">rs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">specialize</span> (<span class="id">H</span> 0); <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?)];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">left</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">subst</span>; <span class="tactic">right</span>; <span class="tactic">do</span> 2 <span class="tactic">eexists</span>. <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> (<span class="id">H</span> 0) <span class="kwd">as</span> [(?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?)]; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">H</span> 0) <span class="kwd">as</span> [(?&amp;?&amp;?)|(?&amp;?&amp; <span class="id">Hc</span> &amp; <span class="id">E</span> &amp; <span class="id">E</span>' &amp; <span class="id">Hr</span>)]; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hc</span>. <span class="id">inv</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">left</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">right</span>; <span class="tactic">do</span> 2 <span class="tactic">eexists</span>. <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">clear</span> <span class="id">E</span>. <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.case_spec">case_spec</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ess</span> <span class="id">d</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> <span class="id">xs</span> <span class="id">ess</span> <span class="id">d</span> <span class="id">rs</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>) # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">ess</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Common.CommonList.html#LiftO">LiftO</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> (<span class="kwd">fun</span> <span class="id">d</span> =&gt; <span class="id">d</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">rs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">c</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>) # <span class="id">n</span> &lt;&gt; <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">ess</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">List.Exists</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; <span class="id">i</span> = <span class="id">c</span> /\ <span class="id">es</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span>) <span class="id">ess</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Common.CommonList.html#LiftO">LiftO</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> (<span class="kwd">fun</span> <span class="id">d</span> =&gt; <span class="id">d</span> # <span class="id">n</span> &lt;&gt; <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">rs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">c</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>) # <span class="id">n</span> &lt;&gt; <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">ess</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">es</span>) &lt;&gt; <span class="id">c</span>) <span class="id">ess</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Common.CommonList.html#LiftO">LiftO</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span> (<span class="kwd">fun</span> <span class="id">d</span> =&gt; <span class="id">d</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span>) <span class="id">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">rs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof63')">Proof.</span></div>
<div class="proofscript" id="proof63">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> * <span class="id">H</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">xs</span>; <span class="id">revert</span> <span class="id">ess</span> <span class="id">d</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">right</span>; <span class="tactic">left</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">right</span>; <span class="tactic">right</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">take</span> (<span class="tactic">case</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">apply</span> <span class="id">IHn</span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> [(?&amp;?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">left</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">right</span>; <span class="tactic">left</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">right</span>; <span class="tactic">right</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">take</span> (<span class="tactic">case</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">apply</span> <span class="id">IHn</span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> [(?&amp;?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">left</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">right</span>; <span class="tactic">left</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">clear</span> <span class="id">H3</span>. <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">right</span>; <span class="tactic">right</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">take</span> (<span class="tactic">case</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">apply</span> <span class="id">IHn</span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> [(?&amp;?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">left</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">right</span>; <span class="tactic">left</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">right</span>; <span class="tactic">right</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">xs</span> <span class="id">ess</span> <span class="id">d</span> <span class="id">rs</span>; <span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="tactic">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">xs</span>; <span class="id">unfold_Stv</span> <span class="id">rs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">specialize</span> (<span class="id">H</span> 0); <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">left</span>; <span class="tactic">intuition</span>; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">subst</span>; <span class="tactic">right</span>; <span class="tactic">left</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">subst</span>; <span class="tactic">right</span>; <span class="tactic">right</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">simpl_Forall</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_map">Forall_map</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="tactic">eapply</span> <span class="id">H1</span>]; <span class="tactic">intros</span> (?&amp;?) ?; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> (<span class="id">H</span> 0) <span class="kwd">as</span> [(?&amp;?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)]]; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> (<span class="id">H</span> 0) <span class="kwd">as</span> [(?&amp;?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)]]; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">H</span> 0) <span class="kwd">as</span> [(?&amp;?&amp;?&amp;?)|[(?&amp;?&amp;<span class="id">Hc</span>&amp;?&amp;?&amp;?&amp;<span class="id">Hr</span>)|(?&amp;?&amp;<span class="id">Hc</span>&amp;?&amp;?&amp;<span class="id">Hd</span>&amp;<span class="id">Hr</span>)]]; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">inv</span> <span class="id">Hc</span>; <span class="id">inv</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">left</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_map">Forall_map</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="tactic">eapply</span> <span class="id">H3</span>]; <span class="tactic">intros</span> (?&amp;?) ?; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">subst</span>; <span class="tactic">right</span>; <span class="tactic">left</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">clear</span> <span class="id">H1</span>. <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">subst</span>; <span class="tactic">right</span>; <span class="tactic">right</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_map">Forall_map</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="tactic">eapply</span> <span class="id">H4</span>]; <span class="tactic">intros</span> (?&amp;?) ?; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> <span class="id">d</span> <span class="kwd">as</span> [(?&amp;?)|]; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">Hd</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">Hd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.CasePDef">CasePDef</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">left</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">subst</span>; <span class="tactic">right</span>; <span class="tactic">left</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">subst</span>; <span class="tactic">right</span>; <span class="tactic">right</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_map">Forall_map</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="tactic">eapply</span> <span class="id">H3</span>]; <span class="tactic">intros</span> (?&amp;?) ?; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">CoFixpoint</span> <span class="id"><a name="COINDSTREAMS.clocks_of">clocks_of</a></span> (<span class="id">ss</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>)) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> (<span class="kwd">fun</span> <span class="id">s</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">s</span> &lt;&gt;<span class="id">b</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">ss</span> ⋅ <span class="id">clocks_of</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>) <span class="id">ss</span>).<br/>
<br/>
<h3> constant value </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">CoFixpoint</span> <span class="id"><a name="COINDSTREAMS.const_val">const_val</a></span> (<span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">v</span> : <span class="id"><a href="Velus.CoindStreams.html#Op.value">value</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">Streams.hd</a></span> <span class="id">b</span> <span class="kwd">then</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span> <span class="kwd">else</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) ⋅ (<span class="id">const_val</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">b</span>) <span class="id">v</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.const_val_Cons">const_val_Cons</a></span> : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">bs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_val">const_val</a></span> (<span class="id">b</span> ⋅ <span class="id">bs</span>) <span class="id">v</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id">b</span> <span class="kwd">then</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span> <span class="kwd">else</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) ⋅ (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_val">const_val</a></span> <span class="id">bs</span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof64')">Proof.</span></div>
<div class="proofscript" id="proof64">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">b</span> <span class="id">bs</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> <span class="tactic">at</span> 1; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.const_val_nth">const_val_nth</a></span> : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">bs</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_val">const_val</a></span> <span class="id">bs</span> <span class="id">c</span>) # <span class="id">n</span> = <span class="kwd">if</span> <span class="id">bs</span> # <span class="id">n</span> <span class="kwd">then</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">c</span> <span class="kwd">else</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof65')">Proof.</span></div>
<div class="proofscript" id="proof65">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">bs</span>; <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_val_Cons">const_val_Cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.const_val_const">const_val_const</a></span> : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> <span class="id">b</span> <span class="id">c</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_val">const_val</a></span> <span class="id">b</span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Vscalar">Vscalar</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.sem_cconst">sem_cconst</a></span> <span class="id">c</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof66')">Proof.</span></div>
<div class="proofscript" id="proof66">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">const_val_const</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">b0</span> <span class="id">b</span>] <span class="id">c</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.const_val_enum">const_val_enum</a></span> : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.enum">enum</a></span> <span class="id">b</span> <span class="id">c</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_val">const_val</a></span> <span class="id">b</span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">c</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof67')">Proof.</span></div>
<div class="proofscript" id="proof67">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">const_val_const</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">b0</span> <span class="id">b</span>] <span class="id">c</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_val">const_val</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">const_val_morph</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof68')">Proof.</span></div>
<div class="proofscript" id="proof68">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?? <span class="id">Heq</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Heq</span>. <span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h3> bools_of : extract boolean from an svalue stream </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">CoInductive</span> <span class="id"><a name="COINDSTREAMS.bools_of">bools_of</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.bools_of_T">bools_of_T</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vs</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bools_of</span> <span class="id">vs</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bools_of</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.true_tag">true_tag</a></span>) ⋅ <span class="id">vs</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> ⋅ <span class="id">bs</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.bools_of_F">bools_of_F</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vs</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bools_of</span> <span class="id">vs</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bools_of</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.false_tag">false_tag</a></span>) ⋅ <span class="id">vs</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> ⋅ <span class="id">bs</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.bools_of_A">bools_of_A</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vs</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bools_of</span> <span class="id">vs</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bools_of</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">vs</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> ⋅ <span class="id">bs</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="COINDSTREAMS.bools_of_Proper">bools_of_Proper</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of">bools_of</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</span></div>
<div class="proofscript" id="proof69">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">x</span> <span class="id">xs</span>] [<span class="id">x</span>' <span class="id">xs</span>'] <span class="id">Heq1</span> [<span class="id">y</span> <span class="id">ys</span>] [<span class="id">y</span>' <span class="id">ys</span>'] <span class="id">Heq2</span> <span class="id">Hsem</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">Heq1</span>; <span class="id">inv</span> <span class="id">Heq2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>; <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1-3:<span class="tactic">eapply</span> <span class="id">CoFix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.bools_of_det">bools_of_det</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">ys</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of">bools_of</a></span> <span class="id">xs</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of">bools_of</a></span> <span class="id">xs</span> <span class="id">ys</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ys</span> ≡ <span class="id">ys</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof70')">Proof.</span></div>
<div class="proofscript" id="proof70">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hb1</span> <span class="id">Hb2</span>. <span class="id">inv</span> <span class="id">Hb1</span>; <span class="id">inv</span> <span class="id">Hb2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1-3:<span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.bools_of_absent">bools_of_absent</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of">bools_of</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</span></div>
<div class="proofscript" id="proof71">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="Velus.Common.CommonStreams.html#const_Cons">CommonStreams.const_Cons</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>), (<span class="id"><a href="Velus.Common.CommonStreams.html#const_Cons">CommonStreams.const_Cons</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.bools_of_nth">bools_of_nth</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of">bools_of</a></span> <span class="id">xs</span> <span class="id">bs</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, (<span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.true_tag">true_tag</a></span>) /\ <span class="id">bs</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.false_tag">false_tag</a></span>) /\ <span class="id">bs</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> /\ <span class="id">bs</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof72')">Proof.</span></div>
<div class="proofscript" id="proof72">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">Hbools</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">n</span>. <span class="id">revert</span> <span class="id">xs</span> <span class="id">bs</span> <span class="id">Hbools</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>; <span class="id">unfold_Stv</span> <span class="id">xs</span>; <span class="id">unfold_St</span> <span class="id">bs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hbools</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">xs</span> <span class="id">bs</span> <span class="id">Hbools</span>. <span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">unfold_Stv</span> <span class="id">xs</span>; <span class="id">unfold_St</span> <span class="id">bs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id">Hb0</span> := <span class="id">Hbools</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">Hb0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hb0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hb0</span> <span class="kwd">as</span> [(?&amp;?)|[(?&amp;?)|(?&amp;?)]]; <span class="tactic">subst</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>. <span class="tactic">eapply</span> <span class="id">CoFix</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hbools</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)). <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Str_nth_S_hd</span> <span class="kwd">in</span> <span class="id">Hbools</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hbools</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id">Hb0</span> := <span class="id">Hbools</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">Hb0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hb0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hb0</span> <span class="kwd">as</span> [(?&amp;?)|[(?&amp;?)|(?&amp;?)]]; <span class="tactic">subst</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:(<span class="tactic">constructor</span>; <span class="tactic">eapply</span> <span class="id">CoFix</span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hbools</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)); <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Str_nth_S_hd</span> <span class="kwd">in</span> <span class="id">Hbools</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hbools</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">CoFixpoint</span> <span class="id"><a name="COINDSTREAMS.disj_str">disj_str</a></span> (<span class="id">rss</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>)) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> (<span class="kwd">fun</span> <span class="id">rs</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">rs</span>) <span class="id">rss</span>) ⋅ (<span class="id">disj_str</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">_</span>) <span class="id">rss</span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.disj_str_spec">disj_str_spec</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">rss</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str">disj_str</a></span> <span class="id">rss</span>) # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> (<span class="kwd">fun</span> <span class="id">rs</span> =&gt; <span class="id">rs</span> # <span class="id">n</span>) <span class="id">rss</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</span></div>
<div class="proofscript" id="proof73">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> *; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> <span class="tactic">at</span> 1; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">induction</span> <span class="id">rss</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span>. <span class="tactic">induction</span> <span class="id">rss</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHn</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#existsb_map">existsb_map</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#existsb_ext">existsb_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.disj_str_cons">disj_str_cons</a></span>: <span class="kwd">forall</span> <span class="id">r</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str">disj_str</a></span> (<span class="id">r</span>::<span class="id">rs</span>) ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str">disj_str</a></span> [<span class="id">r</span>;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str">disj_str</a></span> <span class="id">rs</span>].<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</span></div>
<div class="proofscript" id="proof74">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str_spec">disj_str_spec</a></span>; <span class="tactic">simpl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_false_r">Bool.orb_false_r</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.disj_str_app">disj_str_app</a></span> : <span class="kwd">forall</span> <span class="id">rs1</span> <span class="id">rs2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str">disj_str</a></span> (<span class="id">rs1</span>++<span class="id">rs2</span>) ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str">disj_str</a></span> [<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str">disj_str</a></span> <span class="id">rs1</span>;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str">disj_str</a></span> <span class="id">rs2</span>].<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</span></div>
<div class="proofscript" id="proof75">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str_spec">disj_str_spec</a></span>; <span class="tactic">simpl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_false_r">Bool.orb_false_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb_app">existsb_app</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.bools_ofs">bools_ofs</a></span> (<span class="id">vs</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>)) (<span class="id">rs</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">rss</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of">bools_of</a></span> <span class="id">vs</span> <span class="id">rss</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rs</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str">disj_str</a></span> <span class="id">rss</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.bools_ofs_empty">bools_ofs_empty</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_ofs">bools_ofs</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</span></div>
<div class="proofscript" id="proof76">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str_spec">disj_str_spec</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_nth">const_nth</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.bools_ofs_absent">bools_ofs_absent</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> (<span class="id">xs</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_ofs">bools_ofs</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">xs</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</span></div>
<div class="proofscript" id="proof77">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_ofs">bools_ofs</a></span>. <span class="tactic">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">xs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_same">Forall2_same</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>. <span class="tactic">intros</span> ? <span class="id">_</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of_absent">bools_of_absent</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str_spec">disj_str_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#existsb_map">existsb_map</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xs</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="COINDSTREAMS.bools_ofs_Proper">bools_ofs_Proper</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_ofs">bools_ofs</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof78')">Proof.</span></div>
<div class="proofscript" id="proof78">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Eq1</span> <span class="id">bs</span> <span class="id">bs</span>' <span class="id">Eq2</span> (<span class="id">rs</span>&amp;<span class="id">Bools</span>&amp;<span class="id">Disj</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Eq2</span> <span class="kwd">in</span> <span class="id">Disj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">rs</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="kwd">in</span> <span class="id">Eq1</span>. <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_trans_ex">Forall2_trans_ex</a></span> <span class="kwd">in</span> <span class="id">Bools</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>]. <span class="tactic">intros</span> ? ? <span class="id">_</span> <span class="id">_</span> (?&amp;?&amp;<span class="id">Eq</span>&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Eq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.bools_ofs_det">bools_ofs_det</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">r</span> <span class="id">r</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_ofs">bools_ofs</a></span> <span class="id">xs</span> <span class="id">r</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_ofs">bools_ofs</a></span> <span class="id">xs</span> <span class="id">r</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">r</span> ≡ <span class="id">r</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof79')">Proof.</span></div>
<div class="proofscript" id="proof79">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * (?&amp;<span class="id">Bools1</span>&amp;<span class="id">Disj1</span>) (?&amp;<span class="id">Bools2</span>&amp;<span class="id">Disj2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Disj1</span>, <span class="id">Disj2</span>. <span class="tactic">clear</span> <span class="id">Disj1</span> <span class="id">Disj2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str_spec">disj_str_spec</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x</span> <span class="id">x0</span> <span class="id">Bools1</span> <span class="id">Bools2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xs</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">Bools1</span>; <span class="id">inv</span> <span class="id">Bools2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of_det">bools_of_det</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id">H1</span>, <span class="id">IHxs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="COINDSTREAMS.disj_str_SameElements_Proper">disj_str_SameElements_Proper</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#SameElements">SameElements</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str">disj_str</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof80')">Proof.</span></div>
<div class="proofscript" id="proof80">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?? <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str_spec">disj_str_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Eq</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H</span>, <span class="id">IHEq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">x</span> # <span class="id">n</span>) <span class="id">eqn</span>:<span class="id">Hxn</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Velus.Common.CommonList.html#Exists_existsb">Exists_existsb</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">x</span>' =&gt; <span class="id">x</span>' # <span class="id">n</span> = <span class="id">x</span> # <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">intros</span> <span class="id">x0</span>. <span class="tactic">split</span>; <span class="tactic">intros</span>; <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.SetoidList.html#InA_altdef">SetoidList.InA_altdef</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_impl">Exists_impl</a></span>; [|<span class="tactic">eauto</span>]. <span class="tactic">intros</span> ? <span class="id">Eq</span>. <span class="tactic">rewrite</span> <span class="id">Eq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">x</span> # <span class="id">n</span>) <span class="id">eqn</span>:<span class="id">Hxn</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Velus.Common.CommonList.html#Exists_existsb">Exists_existsb</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">x</span>' =&gt; <span class="id">x</span>' # <span class="id">n</span> = <span class="id">x</span> # <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">intros</span> <span class="id">x0</span>. <span class="tactic">split</span>; <span class="tactic">intros</span>; <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.SetoidList.html#InA_altdef">SetoidList.InA_altdef</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_impl">Exists_impl</a></span>; [|<span class="tactic">eauto</span>]. <span class="tactic">intros</span> ? <span class="id">Eq</span>. <span class="tactic">rewrite</span> <span class="id">Eq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id">_</span> <span class="id">l</span>') <span class="id">eqn</span>:<span class="id">Ex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Common.CommonList.html#Exists_existsb">Exists_existsb</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="kwd">in</span> *. 2,3:<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#existsb_Forall">existsb_Forall</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="COINDSTREAMS.bools_ofs_SameElements_Proper">bools_ofs_SameElements_Proper</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#SameElements">SameElements</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>) ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_ofs">bools_ofs</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof81')">Proof.</span></div>
<div class="proofscript" id="proof81">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Eq</span> <span class="id">bs</span> <span class="id">bs</span>' ? (<span class="id">rs</span>&amp;<span class="id">Bools</span>&amp;<span class="id">Disj</span>); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_SameElements_1">Forall2_SameElements_1</a></span> <span class="kwd">in</span> <span class="id">Bools</span> <span class="kwd">as</span> (<span class="id">rs</span>'&amp;<span class="id">Perm</span>'&amp;<span class="id">Bools</span>'); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="id">esplit</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Disj</span>, <span class="id">Perm</span>'. 1-3:<span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonStreams.html#EqStrel_Reflexive">EqStrel_Reflexive</a></span>, <span class="id"><a href="Velus.Common.CommonStreams.html#EqStrel_Symmetric">EqStrel_Symmetric</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> * <span class="id">Eq1</span> <span class="id">Eq2</span> <span class="id">Bools</span>'. <span class="tactic">rewrite</span> &lt;-<span class="id">Eq1</span>, &lt;-<span class="id">Eq2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of_det">bools_of_det</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> fby stream </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">CoFixpoint</span> <span class="id"><a name="COINDSTREAMS.sfby">sfby</a></span> (<span class="id">v</span> : <span class="id"><a href="Velus.CoindStreams.html#Op.value">value</a></span>) (<span class="id">str</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">str</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span>') ⋅ <span class="id">str</span>' =&gt; (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span>) ⋅ (<span class="id">sfby</span> <span class="id">v</span>' <span class="id">str</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">str</span>' =&gt; <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ (<span class="id">sfby</span> <span class="id">v</span> <span class="id">str</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.sfby_Cons">sfby_Cons</a></span> : <span class="kwd">forall</span> <span class="id">v</span> <span class="id">y</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sfby">sfby</a></span> <span class="id">v</span> (<span class="id">y</span> ⋅ <span class="id">ys</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">y</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span>' =&gt; (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span>) ⋅ (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sfby">sfby</a></span> <span class="id">v</span>' <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sfby">sfby</a></span> <span class="id">v</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof82')">Proof.</span></div>
<div class="proofscript" id="proof82">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">v</span> <span class="id">y</span> <span class="id">ys</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> <span class="tactic">at</span> 1; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sfby">sfby</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">sfby_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof83')">Proof.</span></div>
<div class="proofscript" id="proof83">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">v</span> [<span class="id">x</span> <span class="id">xs</span>] [<span class="id">y</span> <span class="id">ys</span>] <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Heq</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> Properties of history </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="COINDSTREAMS.history">history</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">K</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.history">history</a></span> := @<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.t">FEnv.t</a></span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history.K">K</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.history_tl">history_tl</a></span> (<span class="id">H</span>: <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span>) : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> := <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>) <span class="id">H</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.history_tl_find_Some">history_tl_find_Some</a></span> : <span class="kwd">forall</span> (<span class="id">H</span>: <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span>) <span class="id">id</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H</span> <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span> <span class="id">H</span>) <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">vs</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof84')">Proof.</span></div>
<div class="proofscript" id="proof84">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">H</span> <span class="id">id</span> <span class="id">vs</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfind</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id">history_tl_find_Some</span>' : <span class="kwd">forall</span> (<span class="id">H</span>: <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span>) <span class="id">id</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span> <span class="id">H</span>) <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">v</span>, <span class="id">H</span> <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span> ⋅ <span class="id">vs</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof85')">Proof.</span></div>
<div class="proofscript" id="proof85">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">H</span> <span class="id">id</span> <span class="id">vs</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv_equalities</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">x</span>). <span class="id">now</span> <span class="tactic">destruct</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.history_tl_find_None">history_tl_find_None</a></span> : <span class="kwd">forall</span> (<span class="id">H</span>: <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span>) <span class="id">id</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H</span> <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span> <span class="id">H</span>) <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof86')">Proof.</span></div>
<div class="proofscript" id="proof86">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">H</span> <span class="id">id</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id">history_tl_find_None</span>' : <span class="kwd">forall</span> (<span class="id">H</span>: <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span>) <span class="id">id</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span> <span class="id">H</span>) <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H</span> <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof87')">Proof.</span></div>
<div class="proofscript" id="proof87">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">H</span> <span class="id">id</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">inv_equalities</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.env">env</a></span> := @<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.t">FEnv.t</a></span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history.K">K</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.history_nth">history_nth</a></span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">H</span>: <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span>) : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.env">env</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth">Str_nth</a></span> <span class="id">n</span>) <span class="id">H</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.history_nth_find_None">history_nth_find_None</a></span> : <span class="kwd">forall</span> <span class="id">n</span> (<span class="id">H</span>: <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span>) <span class="id">id</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H</span> <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_nth">history_nth</a></span> <span class="id">n</span> <span class="id">H</span>) <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof88')">Proof.</span></div>
<div class="proofscript" id="proof88">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_nth">history_nth</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id">history_nth_find_None</span>' : <span class="kwd">forall</span> <span class="id">n</span> (<span class="id">H</span>: <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span>) <span class="id">id</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_nth">history_nth</a></span> <span class="id">n</span> <span class="id">H</span>) <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H</span> <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof89')">Proof.</span></div>
<div class="proofscript" id="proof89">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_nth">history_nth</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">inv_equalities</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.history_nth_find_Some">history_nth_find_Some</a></span> : <span class="kwd">forall</span> <span class="id">n</span> (<span class="id">H</span>: <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span>) <span class="id">id</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H</span> <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_nth">history_nth</a></span> <span class="id">n</span> <span class="id">H</span>) <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth">Str_nth</a></span> <span class="id">n</span> <span class="id">vs</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof90')">Proof.</span></div>
<div class="proofscript" id="proof90">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_nth">history_nth</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id">history_nth_find_Some</span>' : <span class="kwd">forall</span> <span class="id">n</span> (<span class="id">H</span>: <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span>) <span class="id">id</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_nth">history_nth</a></span> <span class="id">n</span> <span class="id">H</span>) <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">vs</span>, <span class="id">H</span> <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vs</span> /\ <span class="id">vs</span> # <span class="id">n</span> = <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof91')">Proof.</span></div>
<div class="proofscript" id="proof91">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_nth">history_nth</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>. <span class="id">inv_equalities</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id">history_nth_find_Some</span>'' : <span class="kwd">forall</span> (<span class="id">H</span>: <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span>) <span class="id">vs</span> <span class="id">id</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_nth">history_nth</a></span> <span class="id">n</span> <span class="id">H</span>) <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">vs</span> # <span class="id">n</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">vs</span>', <span class="id">H</span> <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vs</span>' /\ <span class="id">vs</span>' ≡ <span class="id">vs</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof92')">Proof.</span></div>
<div class="proofscript" id="proof92">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">id</span>) <span class="kwd">as</span> [<span class="id">vs</span>'|] <span class="id">eqn</span>:<span class="id">Hfind</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">exists</span> <span class="id">vs</span>'. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hfind</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_nth">history_nth</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>. <span class="id">inv_equalities</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hf</span> <span class="kwd">in</span> <span class="id">Hfind</span>'. <span class="id">inv</span> <span class="id">Hfind</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">specialize</span> (<span class="id">Hfind</span> 0). <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_nth">history_nth</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>. <span class="id">inv_equalities</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">fenv_scope</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.history_tl_refines">history_tl_refines</a></span> : <span class="kwd">forall</span> <span class="id">H</span> <span class="id">H</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H</span> ⊑ <span class="id">H</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span> <span class="id">H</span>) ⊑ (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span> <span class="id">H</span>').<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof93')">Proof.</span></div>
<div class="proofscript" id="proof93">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">H</span> <span class="id">H</span>' <span class="id">Href</span> <span class="id">x</span> <span class="id">vs</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">history_tl_find_Some</span>' <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> [<span class="id">v</span>' <span class="id">Hfind</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Href</span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> [<span class="id">vs</span>' [<span class="id">Heq</span>' <span class="id">Hfind</span>']].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">vs</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl_find_Some">history_tl_find_Some</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">vs</span>'; <span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">Heq</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.history_tl_Equiv">history_tl_Equiv</a></span> : <span class="kwd">forall</span> <span class="id">H</span> <span class="id">H</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) <span class="id">H</span> <span class="id">H</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span> <span class="id">H</span>) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span> <span class="id">H</span>').<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof94')">Proof.</span></div>
<div class="proofscript" id="proof94">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Heq</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Heq</span> <span class="id">x</span>); <span class="id">inv</span> <span class="id">Heq</span>; <span class="tactic">simpl</span>; <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span> : <span class="id">fenv</span>.<br/>
<br/>
<h1> sem_var
        This is common to Lustre and NLustre Semantics </h1>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="COINDSTREAMS.sem_var">sem_var</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">K</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="COINDSTREAMS.sem_var">sem_var</a></span>: <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var.K">K</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="COINDSTREAMS.sem_var_intro">sem_var_intro</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">xs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H</span> <span class="id">x</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> ≡ <span class="id">xs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sem_var</span> <span class="id">H</span> <span class="id">x</span> <span class="id">xs</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">sem_var_morph</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof95')">Proof.</span></div>
<div class="proofscript" id="proof95">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">H</span> <span class="id">H</span>' ? <span class="id">x</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Heq</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">H0</span> <span class="id">x</span>). <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">eapply</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;-<span class="id">H5</span>, &lt;-<span class="id">H3</span>, <span class="id">Heq</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_det">sem_var_det</a></span> : <span class="kwd">forall</span> <span class="id">H</span> <span class="id">x</span> <span class="id">s1</span> <span class="id">s2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">H</span> <span class="id">x</span> <span class="id">s1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">H</span> <span class="id">x</span> <span class="id">s2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s1</span> ≡ <span class="id">s2</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof96')">Proof.</span></div>
<div class="proofscript" id="proof96">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hsem1</span> <span class="id">Hsem2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem1</span>. <span class="id">inv</span> <span class="id">Hsem2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>, <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.env_maps_tl">env_maps_tl</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">v</span> <span class="id">s</span> <span class="id">H</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H</span> <span class="id">i</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span> ⋅ <span class="id">s</span>) -&gt; (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var.K">K</a></span> <span class="id">H</span>) <span class="id">i</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof97')">Proof.</span></div>
<div class="proofscript" id="proof97">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hmap</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_step">sem_var_step</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">x</span> <span class="id">v</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">H</span> <span class="id">x</span> (<span class="id">v</span> ⋅ <span class="id">s</span>) -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span> <span class="id">H</span>) <span class="id">x</span> <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof98')">Proof.</span></div>
<div class="proofscript" id="proof98">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">xs</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.env_maps_tl">env_maps_tl</a></span>; <span class="tactic">eauto</span>. <span class="id">now</span> <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_step_inv">sem_var_step_inv</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">x</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span> <span class="id">H</span>) <span class="id">x</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">v</span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">H</span> <span class="id">x</span> (<span class="id">v</span> ⋅ <span class="id">s</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof99')">Proof.</span></div>
<div class="proofscript" id="proof99">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> <span class="kwd">in</span> *. <span class="id">inv_equalities</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">x0</span>). <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_step_nl">sem_var_step_nl</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">x</span> <span class="id">v</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">H</span> <span class="id">x</span> (<span class="id">v</span> ⋅ <span class="id">s</span>) -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span> <span class="id">H</span>) <span class="id">x</span> <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof100')">Proof.</span></div>
<div class="proofscript" id="proof100">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">xs</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.env_maps_tl">env_maps_tl</a></span>; <span class="tactic">eauto</span>. <span class="id">now</span> <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_switch_env">sem_var_switch_env</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">H</span>' <span class="id">x</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#orel">orel</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>) (<span class="id">H</span> <span class="id">x</span>) (<span class="id">H</span>' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">H</span> <span class="id">x</span> <span class="id">v</span> &lt;-&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">H</span>' <span class="id">x</span> <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof101')">Proof.</span></div>
<div class="proofscript" id="proof101">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hfind</span>; <span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">Hsem</span>; <span class="tactic">inversion_clear</span> <span class="id">Hsem</span> <span class="kwd">as</span> [???? <span class="id">Hr</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hr</span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="id">inv</span> <span class="id">Hfind</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>; <span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">fenv_scope</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_union">sem_var_union</a></span> : <span class="kwd">forall</span> <span class="id">Hi1</span> <span class="id">Hi2</span> <span class="id">x</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> (<span class="id">Hi1</span> + <span class="id">Hi2</span>) <span class="id">x</span> <span class="id">vs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">Hi1</span> <span class="id">x</span> <span class="id">vs</span> \/ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">Hi2</span> <span class="id">x</span> <span class="id">vs</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof102')">Proof.</span></div>
<div class="proofscript" id="proof102">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hv</span>. <span class="id">inv</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union4">FEnv.union4</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">Hfind</span>|<span class="id">Hfind</span>]; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sem_var_union</span>' : <span class="kwd">forall</span> <span class="id">Hi1</span> <span class="id">Hi2</span> <span class="id">x</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> (<span class="id">Hi1</span> + <span class="id">Hi2</span>) <span class="id">x</span> <span class="id">vs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(~<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.In">FEnv.In</a></span> <span class="id">x</span> <span class="id">Hi2</span> /\ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">Hi1</span> <span class="id">x</span> <span class="id">vs</span>) \/ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">Hi2</span> <span class="id">x</span> <span class="id">vs</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof103')">Proof.</span></div>
<div class="proofscript" id="proof103">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hv</span>. <span class="id">inv</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">FEnv.union4</span>' <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">Hfind</span>|(<span class="id">Hnone</span>&amp;<span class="id">Hfind</span>)]; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">left</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.not_find_In">FEnv.not_find_In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_disj_union">sem_var_disj_union</a></span> : <span class="kwd">forall</span> <span class="id">Hi1</span> <span class="id">Hi2</span> <span class="id">x</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.In">FEnv.In</a></span> <span class="id">x</span> <span class="id">Hi1</span> -&gt; ~<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.In">FEnv.In</a></span> <span class="id">x</span> <span class="id">Hi2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> (<span class="id">Hi1</span> + <span class="id">Hi2</span>) <span class="id">x</span> <span class="id">vs</span> &lt;-&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">Hi1</span> <span class="id">x</span> <span class="id">vs</span> \/ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">Hi2</span> <span class="id">x</span> <span class="id">vs</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof104')">Proof.</span></div>
<div class="proofscript" id="proof104">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hdisj</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var_union">sem_var_union</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> [<span class="id">Hv</span>|<span class="id">Hv</span>]; <span class="id">inv</span> <span class="id">Hv</span>; <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union2">FEnv.union2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Hi2</span> <span class="id">x</span>) <span class="id">eqn</span>:<span class="id">Hhi</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id">Hdisj</span>; <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id">FEnv.union3</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> `{<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.fenv_key">FEnv.fenv_key</a></span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var.K">K</a></span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_of_list">sem_var_of_list</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">x</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">x</span>, <span class="id">vs</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list">FEnv.of_list</a></span> <span class="id">xs</span>) <span class="id">x</span> <span class="id">vs</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof105')">Proof.</span></div>
<div class="proofscript" id="proof105">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnd</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list_In_find">FEnv.of_list_In_find</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sem_var_of_list</span>' : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">x</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list">FEnv.of_list</a></span> <span class="id">xs</span>) <span class="id">x</span> <span class="id">vs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">vs</span>', <span class="id">vs</span> ≡ <span class="id">vs</span>' /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">x</span>, <span class="id">vs</span>') <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof106')">Proof.</span></div>
<div class="proofscript" id="proof106">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvar</span>. <span class="id">inv</span> <span class="id">Hvar</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list_find_In">FEnv.of_list_find_In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_union2">sem_var_union2</a></span> : <span class="kwd">forall</span> <span class="id">Hi1</span> <span class="id">Hi2</span> <span class="id">x</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">Hi1</span> <span class="id">x</span> <span class="id">vs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.In">FEnv.In</a></span> <span class="id">x</span> <span class="id">Hi2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> (<span class="id">Hi1</span> + <span class="id">Hi2</span>) <span class="id">x</span> <span class="id">vs</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof107')">Proof.</span></div>
<div class="proofscript" id="proof107">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvar</span> <span class="id">Hnin</span>. <span class="id">inv</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union2">FEnv.union2</a></span>; <span class="tactic">eauto</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.not_find_In">FEnv.not_find_In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sem_var_union3</span>' : <span class="kwd">forall</span> <span class="id">Hi1</span> <span class="id">Hi2</span> <span class="id">x</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">Hi2</span> <span class="id">x</span> <span class="id">vs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> (<span class="id">Hi1</span> + <span class="id">Hi2</span>) <span class="id">x</span> <span class="id">vs</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof108')">Proof.</span></div>
<div class="proofscript" id="proof108">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hvar</span>. <span class="tactic">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id">FEnv.union3</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span>.<br/>
<br/>
<h2> clocks_of and its properties </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.clocks_of">clocks_of</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">clocks_of_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof109')">Proof.</span></div>
<div class="proofscript" id="proof109">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">clear</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">xs</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xs</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="id">inv</span> <span class="id">Exs</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">xs</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xs</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="id">inv</span> <span class="id">Exs</span>; <span class="tactic">simpl</span>; <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHxs</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.clocks_of_EqStN">clocks_of_EqStN</a></span> : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">xs1</span> <span class="id">xs2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">n</span>) <span class="id">xs1</span> <span class="id">xs2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.clocks_of">clocks_of</a></span> <span class="id">xs1</span>) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.clocks_of">clocks_of</a></span> <span class="id">xs2</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof110')">Proof.</span></div>
<div class="proofscript" id="proof110">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> * <span class="id">Heq</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coindstreams</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.clocks_of">clocks_of</a></span> <span class="id">xs1</span>)), (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.clocks_of">clocks_of</a></span> <span class="id">xs2</span>)); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">clear</span> - <span class="id">Heq</span>. <span class="tactic">induction</span> <span class="id">Heq</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.clocks_of_nth">clocks_of_nth</a></span> : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.clocks_of">clocks_of</a></span> <span class="id">xs</span>) # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> (<span class="kwd">fun</span> <span class="id">s</span> =&gt; <span class="id">s</span> &lt;&gt;<span class="id">b</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth">Str_nth</a></span> <span class="id">n</span>) <span class="id">xs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof111')">Proof.</span></div>
<div class="proofscript" id="proof111">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">cbn</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#existsb_map">existsb_map</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHn</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#existsb_map">existsb_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> abstract_clock and some properties </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">CoFixpoint</span> <span class="id"><a name="COINDSTREAMS.abstract_clock">abstract_clock</a></span> {<span class="id">A</span>} (<span class="id">xs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> <span class="id">A</span>)) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">xs</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">xs</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> ⋅ <span class="id">abstract_clock</span> <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">_</span> ⋅ <span class="id">xs</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> ⋅ <span class="id">abstract_clock</span> <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> {<span class="id">A</span>} : (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">ac_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof112')">Proof.</span></div>
<div class="proofscript" id="proof112">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>; <span class="tactic">intros</span> <span class="id">b</span> <span class="id">b</span>' <span class="id">Eb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">b</span>; <span class="id">unfold_Stv</span> <span class="id">b</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="id">inv</span> <span class="id">Eb</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_Cons">ac_Cons</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">A</span> (<span class="id">x</span> ⋅ <span class="id">xs</span>) ≡<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> | <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="kwd">end</span>) ⋅ (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">xs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof113')">Proof.</span></div>
<div class="proofscript" id="proof113">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *. <span class="tactic">constructor</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_tl">ac_tl</a></span> {<span class="id">A</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>, @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">s</span>) ≡ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">s</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof114')">Proof.</span></div>
<div class="proofscript" id="proof114">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">unfold_Stv</span> <span class="id">s</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_nth">ac_nth</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">A</span> <span class="id">xs</span>) # <span class="id">n</span> = (<span class="kwd">match</span> <span class="id">xs</span> # <span class="id">n</span> <span class="kwd">with</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> | <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="kwd">end</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof115')">Proof.</span></div>
<div class="proofscript" id="proof115">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">xs</span> <span class="id">n</span>. <span class="id">revert</span> <span class="id">xs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>; <span class="id">unfold_Stv</span> <span class="id">xs</span>; <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.ac_Cons">ac_Cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> sem_clock and its properties </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">CoInductive</span> <span class="id"><a name="COINDSTREAMS.whenb">whenb</a></span> (<span class="id">e</span> : <span class="id"><a href="Velus.CoindStreams.html#Op.enumtag">enumtag</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.WhenbA">WhenbA</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">whenb</span> <span class="id">e</span> <span class="id">bs</span> <span class="id">xs</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">whenb</span> <span class="id">e</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> ⋅ <span class="id">bs</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">xs</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> ⋅ <span class="id">ys</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.WhenbPA">WhenbPA</a></span> : <span class="kwd">forall</span> <span class="id">e</span>' <span class="id">bs</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">whenb</span> <span class="id">e</span> <span class="id">bs</span> <span class="id">xs</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">e</span>' &lt;&gt; <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">whenb</span> <span class="id">e</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> ⋅ <span class="id">bs</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">e</span>') ⋅ <span class="id">xs</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> ⋅ <span class="id">ys</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.WhenbPP">WhenbPP</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">whenb</span> <span class="id">e</span> <span class="id">bs</span> <span class="id">xs</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">whenb</span> <span class="id">e</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> ⋅ <span class="id">bs</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">e</span>) ⋅ <span class="id">xs</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> ⋅ <span class="id">ys</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.whenb_nth">whenb_nth</a></span> <span class="id">e</span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.whenb">whenb</a></span> <span class="id">e</span> <span class="id">bs</span> <span class="id">xs</span> <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; (<span class="kwd">forall</span> <span class="id">n</span>, (<span class="id">bs</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> /\ <span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> /\ <span class="id">ys</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ (<span class="tactic">exists</span> <span class="id">e</span>', <span class="id">bs</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> /\ <span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">e</span>') /\ <span class="id">e</span>' &lt;&gt; <span class="id">e</span> /\ <span class="id">ys</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ (<span class="id">bs</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> /\ <span class="id">xs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">e</span>) /\ <span class="id">ys</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof116')">Proof.</span></div>
<div class="proofscript" id="proof116">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">Henum</span> <span class="id">n</span>. <span class="id">revert</span> <span class="id">bs</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">Henum</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">Henum</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">left</span>. <span class="tactic">eexists</span>; <span class="tactic">intuition</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">Henum</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">bs</span> <span class="id">xs</span> <span class="id">ys</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="tactic">intros</span> * <span class="id">Henum</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">bs</span>; <span class="id">unfold_Stv</span> <span class="id">xs</span>; <span class="id">unfold_Stv</span> <span class="id">ys</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">specialize</span> (<span class="id">Henum</span> 0) <span class="kwd">as</span> <span class="id">H0</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [(?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?)]]; <span class="tactic">try</span> <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">constructor</span>; <span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">Henum</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">constructor</span>; <span class="tactic">eauto</span>. <span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">Henum</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">Henum</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="COINDSTREAMS.sem_clock">sem_clock</a></span>: <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="id"><a href="Velus.CoindStreams.html#Clocks.clock">clock</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.Sbase">Sbase</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">b</span> <span class="id">b</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">b</span> ≡ <span class="id">b</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sem_clock</span> <span class="id">H</span> <span class="id">b</span> <span class="id"><a href="Velus.CoindStreams.html#Clocks.Cbase">Cbase</a></span> <span class="id">b</span>'<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.Son">Son</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">b</span> <span class="id">bs</span> <span class="id">ck</span> <span class="id">x</span> <span class="id">t</span> <span class="id">k</span> <span class="id">xs</span> <span class="id">bs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sem_clock</span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">H</span> <span class="id">x</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.whenb">whenb</a></span> <span class="id">k</span> <span class="id">bs</span> <span class="id">xs</span> <span class="id">bs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sem_clock</span> <span class="id">H</span> <span class="id">b</span> (<span class="id"><a href="Velus.CoindStreams.html#Clocks.Con">Con</a></span> <span class="id">ck</span> <span class="id">x</span> (<span class="id">t</span>, <span class="id">k</span>)) <span class="id">bs</span>'.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">e</span> : (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.whenb">whenb</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">whenb_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof117')">Proof.</span></div>
<div class="proofscript" id="proof117">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (?&amp;?) (?&amp;?) <span class="id">Hbs</span> (?&amp;?) (?&amp;?) <span class="id">Hxs</span> (?&amp;?) (?&amp;?) <span class="id">Hys</span> <span class="id">Henums</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Henums</span>; <span class="id">inv</span> <span class="id">Hbs</span>; <span class="id">inv</span> <span class="id">Hxs</span>; <span class="id">inv</span> <span class="id">Hys</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="tactic">constructor</span>; <span class="tactic">eauto</span>; <span class="tactic">eapply</span> <span class="id">CoFix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.whenb_detn">whenb_detn</a></span> <span class="id">e</span> <span class="id">n</span> : <span class="kwd">forall</span> <span class="id">xs1</span> <span class="id">xs2</span> <span class="id">bs1</span> <span class="id">bs2</span> <span class="id">ys1</span> <span class="id">ys2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">n</span> <span class="id">bs1</span> <span class="id">bs2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">n</span> <span class="id">xs1</span> <span class="id">xs2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.whenb">whenb</a></span> <span class="id">e</span> <span class="id">bs1</span> <span class="id">xs1</span> <span class="id">ys1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.whenb">whenb</a></span> <span class="id">e</span> <span class="id">bs2</span> <span class="id">xs2</span> <span class="id">ys2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">n</span> <span class="id">ys1</span> <span class="id">ys2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof118')">Proof.</span></div>
<div class="proofscript" id="proof118">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">EqB</span> <span class="id">EqX</span> <span class="id">When1</span> <span class="id">When2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN_spec">EqStN_spec</a></span>. <span class="tactic">intros</span> <span class="id">k</span> <span class="id">Hlt</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.whenb_nth">whenb_nth</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN_spec">EqStN_spec</a></span> <span class="kwd">in</span> <span class="id">EqB</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN_spec">EqStN_spec</a></span> <span class="kwd">in</span> <span class="id">EqX</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id">When1</span> <span class="id">k</span>) <span class="kwd">as</span> [(?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?)]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id">When2</span> <span class="id">k</span>) <span class="kwd">as</span> [(?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?)]]; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_clock">sem_clock</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">sem_clock_morph</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof119')">Proof.</span></div>
<div class="proofscript" id="proof119">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">H</span> <span class="id">H</span>' <span class="id">Hequiv</span> <span class="id">b</span> <span class="id">b</span>' <span class="id">Eb</span> <span class="id">ck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ck</span>; <span class="tactic">intros</span> <span class="id">bk</span> <span class="id">bk</span>' <span class="id">Ebk</span> <span class="id">Sem</span>; <span class="id">inv</span> <span class="id">Sem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">Eb</span>, &lt;-<span class="id">Ebk</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">IHck</span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">eauto</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;-<span class="id">Hequiv</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> &lt;-<span class="id">Ebk</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sc_step">sc_step</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> <span class="id">s</span> <span class="id">ss</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_clock">sem_clock</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> (<span class="id">s</span> ⋅ <span class="id">ss</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_clock">sem_clock</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history_tl">history_tl</a></span> <span class="id">H</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">b</span>) <span class="id">ck</span> <span class="id">ss</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof120')">Proof.</span></div>
<div class="proofscript" id="proof120">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ck</span>; <span class="tactic">intros</span> * <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">bs</span>, <span class="id">xs</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var_step">sem_var_step</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H9</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.whenb_det">whenb_det</a></span> <span class="id">e</span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">xs</span> <span class="id">ys1</span> <span class="id">ys2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.whenb">whenb</a></span> <span class="id">e</span> <span class="id">bs</span> <span class="id">xs</span> <span class="id">ys1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.whenb">whenb</a></span> <span class="id">e</span> <span class="id">bs</span> <span class="id">xs</span> <span class="id">ys2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ys1</span> ≡ <span class="id">ys2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof121')">Proof.</span></div>
<div class="proofscript" id="proof121">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">When1</span> <span class="id">When2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.whenb_nth">whenb_nth</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">When1</span> <span class="id">n</span>) <span class="kwd">as</span> [(?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?)]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">When2</span> <span class="id">n</span>) <span class="kwd">as</span> [(?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?)]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_clock_det">sem_clock_det</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">ck</span> : <span class="id"><a href="Velus.CoindStreams.html#Clocks.clock">clock</a></span>) (<span class="id">H</span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">b</span> <span class="id">xs</span> <span class="id">xs</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_clock">sem_clock</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_clock">sem_clock</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> <span class="id">xs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> ≡ <span class="id">xs</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof122')">Proof.</span></div>
<div class="proofscript" id="proof122">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ck</span>; <span class="tactic">intros</span> * <span class="id">Hsem1</span> <span class="id">Hsem2</span>; <span class="id">inv</span> <span class="id">Hsem1</span>; <span class="id">inv</span> <span class="id">Hsem2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;-<span class="id">H1</span>, &lt;-<span class="id">H2</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHck</span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var_det">sem_var_det</a></span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.whenb_det">whenb_det</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.sem_clock_true_inv">sem_clock_true_inv</a></span> : <span class="kwd">forall</span> <span class="id">H</span> <span class="id">ck</span> <span class="id">b</span> <span class="id">bs</span> <span class="id">bs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_clock">sem_clock</a></span> <span class="id">H</span> (<span class="id">b</span> ⋅ <span class="id">bs</span>) <span class="id">ck</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> ⋅ <span class="id">bs</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">b</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof123')">Proof.</span></div>
<div class="proofscript" id="proof123">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ck</span>; <span class="tactic">intros</span> * <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">bs0</span>. <span class="id">inv</span> <span class="id">H9</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHck</span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h3> sub_clock </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">CoInductive</span> <span class="id"><a name="COINDSTREAMS.sub_clock">sub_clock</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Relations.Relation_Definitions.html#relation">relation</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.SubP1">SubP1</a></span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">s</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sub_clock</span> <span class="id">s</span> <span class="id">s</span>' -&gt; <span class="id">sub_clock</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> ⋅ <span class="id">s</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> ⋅ <span class="id">s</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.SubP2">SubP2</a></span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">s</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sub_clock</span> <span class="id">s</span> <span class="id">s</span>' -&gt; <span class="id">sub_clock</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> ⋅ <span class="id">s</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> ⋅ <span class="id">s</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.SubA">SubA</a></span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">s</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sub_clock</span> <span class="id">s</span> <span class="id">s</span>' -&gt; <span class="id">sub_clock</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> ⋅ <span class="id">s</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> ⋅ <span class="id">s</span>').<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="COINDSTREAMS.sub_clock_trans">sub_clock_trans</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Transitive">Transitive</a></span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sub_clock">sub_clock</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof124')">Proof.</span></div>
<div class="proofscript" id="proof124">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>. <span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">XY</span> <span class="id">YZ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">x</span>; <span class="id">unfold_Stv</span> <span class="id">z</span>; <span class="id">inv</span> <span class="id">XY</span>; <span class="id">inv</span> <span class="id">YZ</span>; <span class="tactic">constructor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="COINDSTREAMS.sub_clock_refl">sub_clock_refl</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Reflexive">Reflexive</a></span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sub_clock">sub_clock</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof125')">Proof.</span></div>
<div class="proofscript" id="proof125">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>. <span class="tactic">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">x</span>; <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sub_clock">sub_clock</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">sub_clock_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof126')">Proof.</span></div>
<div class="proofscript" id="proof126">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>. <span class="tactic">intros</span> <span class="id">b</span> <span class="id">b</span>' <span class="id">Eb</span> <span class="id">c</span> <span class="id">c</span>' <span class="id">Ec</span> <span class="id">Hsub</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">b</span>'; <span class="id">unfold_Stv</span> <span class="id">c</span>'; <span class="tactic">try</span> <span class="tactic">constructor</span>; <span class="id">inv</span> <span class="id">Eb</span>; <span class="id">inv</span> <span class="id">Ec</span>; <span class="id">inv</span> <span class="id">Hsub</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sub_clock_step">sub_clock_step</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">b</span>', <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sub_clock">sub_clock</a></span> <span class="id">b</span> <span class="id">b</span>' -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sub_clock">sub_clock</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">b</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">b</span>').<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof127')">Proof.</span></div>
<div class="proofscript" id="proof127">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hs</span>. <span class="id">unfold_Stv</span> <span class="id">b</span>; <span class="id">unfold_Stv</span> <span class="id">b</span>'; <span class="id">inv</span> <span class="id">Hs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sub_clock_Con">sub_clock_Con</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> <span class="id">x</span> <span class="id">b0</span> <span class="id">s</span> <span class="id">s</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_clock">sem_clock</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_clock">sem_clock</a></span> <span class="id">H</span> <span class="id">b</span> (<span class="id"><a href="Velus.CoindStreams.html#Clocks.Con">Con</a></span> <span class="id">ck</span> <span class="id">x</span> <span class="id">b0</span>) <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sub_clock">sub_clock</a></span> <span class="id">s</span> <span class="id">s</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof128')">Proof.</span></div>
<div class="proofscript" id="proof128">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hsc</span> <span class="id">Hsc</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsc</span>'. <span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_clock_det">sem_clock_det</a></span> <span class="kwd">in</span> <span class="id">Hsc</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">Hsc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">xs</span> <span class="id">s</span>' <span class="id">bs</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="tactic">intros</span> (?&amp;?) (?&amp;?) (?&amp;?) <span class="id">When</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">When</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sub_clock_parent">sub_clock_parent</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> <span class="id">ck</span>' <span class="id">s</span> <span class="id">s</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_clock">sem_clock</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_clock">sem_clock</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span>' <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#Clocks.clock_parent">clock_parent</a></span> <span class="id">ck</span> <span class="id">ck</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sub_clock">sub_clock</a></span> <span class="id">s</span> <span class="id">s</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof129')">Proof.</span></div>
<div class="proofscript" id="proof129">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hsc</span> <span class="id">Hsc</span>' <span class="id">Hparent</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">s</span>'. <span class="tactic">induction</span> <span class="id">Hparent</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sub_clock_Con">sub_clock_Con</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">Hsc</span>' <span class="kwd">as</span> [|????????? <span class="id">Hck</span>']; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sub_clock_Con">sub_clock_Con</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hck</span>' <span class="id">Hsc</span>');<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHHparent</span> <span class="kwd">in</span> <span class="id">Hck</span>'; <span class="id">etransitivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> Aligned and its properties </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">CoInductive</span> <span class="id"><a name="COINDSTREAMS.aligned">aligned</a></span> {<span class="id">A</span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> <span class="id">A</span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.synchro_present">synchro_present</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span> <span class="id">vs</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">aligned</span> <span class="id">vs</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">aligned</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span> ⋅ <span class="id">vs</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> ⋅ <span class="id">bs</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.synchro_absent">synchro_absent</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vs</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">aligned</span> <span class="id">vs</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">aligned</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">vs</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> ⋅ <span class="id">bs</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="COINDSTREAMS.aligned_Proper">aligned_Proper</a></span> {<span class="id">A</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> <span class="id">A</span>) ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.aligned">aligned</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof130')">Proof.</span></div>
<div class="proofscript" id="proof130">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">vs</span> <span class="id">vs</span>' <span class="id">Heq1</span> <span class="id">bs</span> <span class="id">bs</span>' <span class="id">Heq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">revert</span> <span class="id">vs</span> <span class="id">vs</span>' <span class="id">Heq1</span> <span class="id">bs</span> <span class="id">bs</span>' <span class="id">Heq2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">aligned_Proper</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">v</span> <span class="id">vs</span>] [<span class="id">v</span>' <span class="id">vs</span>'] <span class="id">Heq1</span> [<span class="id">b</span> <span class="id">bs</span>] [<span class="id">b</span>' <span class="id">bs</span>'] <span class="id">Heq2</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Heq1</span>; <span class="id">inv</span> <span class="id">Heq2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>; <span class="id">inv</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.aligned_spec">aligned_spec</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> (<span class="id">vs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> <span class="id">A</span>)) <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.aligned">aligned</a></span> <span class="id">vs</span> <span class="id">bs</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, (<span class="tactic">exists</span> <span class="id">v</span>, <span class="id">bs</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> /\ <span class="id">vs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ (<span class="id">bs</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> /\ <span class="id">vs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof131')">Proof with</span></div>
<div class="proofscript" id="proof131">
 <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">H</span> <span class="id">n</span>. <span class="id">revert</span> <span class="id">vs</span> <span class="id">bs</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">left</span>. <span class="tactic">exists</span> <span class="id">v</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">right</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">vs</span> <span class="id">bs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="tactic">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">vs</span>; <span class="id">unfold_Stv</span> <span class="id">bs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,4:(<span class="tactic">specialize</span> (<span class="id">H</span> 0); <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [[? [? ?]]|[? ?]]; <span class="tactic">try</span> <span class="tactic">congruence</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:(<span class="tactic">constructor</span>; <span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.aligned_EqSt">aligned_EqSt</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> (<span class="id">vs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> <span class="id">A</span>)) <span class="id">bs1</span> <span class="id">bs2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.aligned">aligned</a></span> <span class="id">vs</span> <span class="id">bs1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.aligned">aligned</a></span> <span class="id">vs</span> <span class="id">bs2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bs1</span> ≡ <span class="id">bs2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof132')">Proof.</span></div>
<div class="proofscript" id="proof132">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">v</span> <span class="id">vs</span>] [<span class="id">b1</span> <span class="id">bs1</span>] [<span class="id">b2</span> <span class="id">bs2</span>] <span class="id">Hsync1</span> <span class="id">Hsync2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsync1</span>; <span class="id">inv</span> <span class="id">Hsync2</span>; <span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.const_aligned">const_aligned</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.aligned">aligned</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> <span class="id">bs</span> <span class="id">c</span>) <span class="id">bs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof133')">Proof with</span></div>
<div class="proofscript" id="proof133">
 <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">bs</span> <span class="id">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> <span class="id">bs</span> <span class="id">c</span>) <span class="kwd">as</span> <span class="id">vs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.aligned_spec">aligned_spec</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.eq_EqSt">eq_EqSt</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_spec">const_spec</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Heqvs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">Heqvs</span>; <span class="tactic">clear</span> <span class="id">Heqvs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">bs</span> # <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">left</span>. <span class="tactic">eexists</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>...<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.enum_aligned">enum_aligned</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.aligned">aligned</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.enum">enum</a></span> <span class="id">bs</span> <span class="id">c</span>) <span class="id">bs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof134')">Proof with</span></div>
<div class="proofscript" id="proof134">
 <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">bs</span> <span class="id">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.enum">enum</a></span> <span class="id">bs</span> <span class="id">c</span>) <span class="kwd">as</span> <span class="id">vs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.aligned_spec">aligned_spec</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.eq_EqSt">eq_EqSt</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.enum_spec">enum_spec</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Heqvs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">Heqvs</span>; <span class="tactic">clear</span> <span class="id">Heqvs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">bs</span> # <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">left</span>. <span class="tactic">eexists</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>...<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_when">ac_when</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">cs</span> <span class="id">xs</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when">when</a></span> <span class="id">k</span> <span class="id">cs</span> <span class="id">xs</span> <span class="id">rs</span> -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">cs</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof135')">Proof.</span></div>
<div class="proofscript" id="proof135">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwhen</span>. <span class="id">inv</span> <span class="id">Hwhen</span>; <span class="tactic">econstructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_whenb">ac_whenb</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">cs</span> <span class="id">xs</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.whenb">whenb</a></span> <span class="id">k</span> <span class="id">cs</span> <span class="id">xs</span> <span class="id">rs</span> -&gt; <span class="id">cs</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof136')">Proof.</span></div>
<div class="proofscript" id="proof136">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwhen</span>. <span class="id">inv</span> <span class="id">Hwhen</span>; <span class="tactic">econstructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_merge">ac_merge</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cs</span> <span class="id">xs</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.merge">merge</a></span> <span class="id">cs</span> <span class="id">xs</span> <span class="id">rs</span> -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">cs</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">rs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof137')">Proof.</span></div>
<div class="proofscript" id="proof137">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hmerge</span>. <span class="id">inv</span> <span class="id">Hmerge</span>; <span class="tactic">econstructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_const">ac_const</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const">const</a></span> <span class="id">b</span> <span class="id">c</span>) ≡ <span class="id">b</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof138')">Proof.</span></div>
<div class="proofscript" id="proof138">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">b</span>; <span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_enum">ac_enum</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.enum">enum</a></span> <span class="id">b</span> <span class="id">k</span>) ≡ <span class="id">b</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof139')">Proof.</span></div>
<div class="proofscript" id="proof139">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">b</span>; <span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_case">ac_case</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cs</span> <span class="id">vs</span> <span class="id">d</span> <span class="id">ss</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> <span class="id">cs</span> <span class="id">vs</span> <span class="id">d</span> <span class="id">ss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">cs</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">ss</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof140')">Proof.</span></div>
<div class="proofscript" id="proof140">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hcase</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">cs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hcase</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2,3:<span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_lift1">ac_lift1</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">op</span> <span class="id">ty</span> <span class="id">s</span> <span class="id">o</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.lift1">lift1</a></span> <span class="id">op</span> <span class="id">ty</span> <span class="id">s</span> <span class="id">o</span> -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">s</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">o</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof141')">Proof.</span></div>
<div class="proofscript" id="proof141">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hlift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">s</span>; <span class="id">inv</span> <span class="id">Hlift</span>; <span class="tactic">econstructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_lift2">ac_lift2</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">op</span> <span class="id">ty1</span> <span class="id">ty2</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">o</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.lift2">lift2</a></span> <span class="id">op</span> <span class="id">ty1</span> <span class="id">ty2</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">o</span> -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">s1</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">o</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof142')">Proof.</span></div>
<div class="proofscript" id="proof142">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hlift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">s1</span>; <span class="id">inv</span> <span class="id">Hlift</span>; <span class="tactic">econstructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_liftn">ac_liftn</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">ss</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.liftn">liftn</a></span> <span class="id">f</span> <span class="id">ss</span> <span class="id">vs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">ss</span> =&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">ss</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">vs</span>) <span class="id">ss</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof143')">Proof.</span></div>
<div class="proofscript" id="proof143">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hlift</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.liftn_spec">liftn_spec</a></span> <span class="kwd">in</span> <span class="id">Hlift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.ac_nth">ac_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hlift</span> <span class="id">n</span>) <span class="kwd">as</span> [(?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?)];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">take</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore2">Forall2_ignore2</a></span> <span class="kwd">in</span> <span class="id">it</span>]; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">take</span> (<span class="id">vs</span> # <span class="id">n</span> = <span class="id">_</span>) <span class="id">and</span> <span class="tactic">setoid_rewrite</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">take</span> (<span class="id">x</span> # <span class="id">n</span> = <span class="id">_</span>) <span class="id">and</span> <span class="tactic">setoid_rewrite</span> <span class="id">it</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_aligned">ac_aligned</a></span> {<span class="id">A</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> <span class="id">A</span>)), <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.aligned">aligned</a></span> <span class="id">s</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">s</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof144')">Proof.</span></div>
<div class="proofscript" id="proof144">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">s</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span>; <span class="tactic">simpl</span>; <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sub_clock_sclocksof">sub_clock_sclocksof</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">ss</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">s</span> <span class="id">ss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">s</span>' =&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sub_clock">sub_clock</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">s</span>) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">s</span>')) <span class="id">ss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.clocks_of">clocks_of</a></span> <span class="id">ss</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof145')">Proof.</span></div>
<div class="proofscript" id="proof145">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hin</span> <span class="id">Hsub</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">s</span>) <span class="kwd">as</span> <span class="id">acs</span> <span class="id">eqn</span>: <span class="id">Hacs</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.eq_EqSt">eq_EqSt</a></span> <span class="kwd">in</span> <span class="id">Hacs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hin</span> <span class="id">Hacs</span> <span class="id">Hsub</span>. <span class="id">revert</span> <span class="id">s</span> <span class="id">ss</span> <span class="id">acs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> <span class="id">s</span>) <span class="kwd">in</span> *; <span class="tactic">destruct</span> <span class="id">s</span> <span class="kwd">as</span> [[|]]; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> <span class="kwd">in</span> <span class="id">Hacs</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hacs</span>; <span class="tactic">inversion</span> <span class="id">Hacs</span> <span class="kwd">as</span> [<span class="id">Hac</span> ?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#existsb_Forall">existsb_Forall</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="tactic">intros</span> * <span class="id">Hin</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> <span class="id">Hin</span>' <span class="kwd">as</span> <span class="id">Hs</span>; <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hs</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hacs</span> <span class="kwd">in</span> <span class="id">Hs</span>. <span class="tactic">inversion</span> <span class="id">Hs</span> <span class="kwd">as</span> [| |??? <span class="id">HH</span> <span class="id">Hx</span> ]. <span class="id">unfold_Stv</span> <span class="id">x</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> <span class="kwd">in</span> <span class="id">Hx</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hx</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map">in_map</a></span> <span class="kwd">in</span> <span class="id">Hin</span>. <span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_map">Forall_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> * <span class="id">HH</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.ac_tl">ac_tl</a></span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sub_clock_step">sub_clock_step</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">Hac</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb_exists">existsb_exists</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map">in_map</a></span> <span class="kwd">in</span> <span class="id">Hin</span>. <span class="tactic">eapply</span> <span class="id">Cofix</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_map">Forall_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> * <span class="id">HH</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.ac_tl">ac_tl</a></span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sub_clock_step">sub_clock_step</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.ac_Streams_const">ac_Streams_const</a></span> {<span class="id">A</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) ≡ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof146')">Proof.</span></div>
<div class="proofscript" id="proof146">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h3> count and mask </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">CoFixpoint</span> <span class="id"><a name="COINDSTREAMS.count_acc">count_acc</a></span> (<span class="id">s</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">rs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">s</span> := <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">rs</span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">s</span> <span class="kwd">else</span> <span class="id">s</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> ⋅ <span class="id">count_acc</span> <span class="id">s</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">rs</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.count">count</a></span> := <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_acc">count_acc</a></span> 0.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.count_acc_grow_trans">count_acc_grow_trans</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">s</span>' <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span>' &lt;= <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ForAll">ForAll</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">s</span>' &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_acc">count_acc</a></span> <span class="id">s</span> <span class="id">rs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof147')">Proof.</span></div>
<div class="proofscript" id="proof147">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">rs</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.count_acc_grow">count_acc_grow</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ForAll">ForAll</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">s</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_acc">count_acc</a></span> <span class="id">s</span> <span class="id">rs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof148')">Proof.</span></div>
<div class="proofscript" id="proof148">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_acc_grow_trans">count_acc_grow_trans</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.count_S_nth">count_S_nth</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">s</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_tl">Str_nth_tl</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_acc">count_acc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">s</span>) <span class="id">rs</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_tl">Str_nth_tl</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_acc">count_acc</a></span> <span class="id">s</span> <span class="id">rs</span>))).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof149')">Proof.</span></div>
<div class="proofscript" id="proof149">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth">Str_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">rs</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id">count_S_nth</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">s</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_acc">count_acc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">s</span>) <span class="id">rs</span>) # <span class="id">n</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> ((<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_acc">count_acc</a></span> <span class="id">s</span> <span class="id">rs</span>) # <span class="id">n</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof150')">Proof.</span></div>
<div class="proofscript" id="proof150">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 (<span class="tactic">rewrite</span> &lt;-(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.add_0_l">Nat.add_0_l</a></span> <span class="id">n</span>), &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_plus">Str_nth_plus</a></span>; <span class="tactic">symmetry</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_S_nth">count_S_nth</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.count_0">count_0</a></span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">m</span>, <span class="id">m</span> &lt;= <span class="id">n</span> -&gt; <span class="id">r</span> # <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r</span>) # <span class="id">n</span> = 0.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof151')">Proof.</span></div>
<div class="proofscript" id="proof151">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">revert</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> * <span class="id">Hr</span>; <span class="id">unfold_Stv</span> <span class="id">r</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">specialize</span> (<span class="id">Hr</span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_0_l">Nat.le_0_l</a></span> <span class="id">_</span>)). <span class="id">inv</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">specialize</span> (<span class="id">Hr</span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_0_l">Nat.le_0_l</a></span> <span class="id">_</span>)). <span class="id">inv</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHn</span>. <span class="tactic">intros</span> <span class="id">m</span> <span class="id">Hle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hr</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n_S">le_n_S</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hle</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">intros</span> * <span class="id">Hcount</span> * <span class="id">Hle</span>; <span class="tactic">destruct</span> <span class="id">m</span>; <span class="tactic">try</span> <span class="id">lia</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">r</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">Hcount</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span> <span class="kwd">in</span> <span class="id">Hcount</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">count_S_nth</span>' <span class="kwd">in</span> <span class="id">Hcount</span>; <span class="tactic">auto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">eauto</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.count_not_0">count_not_0</a></span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">m</span>, <span class="id">m</span> &lt;= <span class="id">n</span> /\ <span class="id">r</span> # <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r</span>) # <span class="id">n</span> &gt; 0.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof152')">Proof.</span></div>
<div class="proofscript" id="proof152">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> * <span class="id">Hr</span>; <span class="id">unfold_Stv</span> <span class="id">r</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hr</span> <span class="kwd">as</span> (<span class="id">m</span>&amp;<span class="id">Hle</span>&amp;<span class="id">Hr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hle</span>. <span class="id">inv</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">count_S_nth</span>'. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">IHn</span>. <span class="tactic">destruct</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">exists</span> <span class="id">m</span>. <span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">n</span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">_</span> <span class="id">n</span> ==&gt; @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN">EqStN</a></span> <span class="id">_</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">count_EqStN</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof153')">Proof.</span></div>
<div class="proofscript" id="proof153">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?? <span class="id">Heq</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN_spec">EqStN_spec</a></span>; <span class="tactic">intros</span> * <span class="id">Hlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x</span> <span class="id">y</span> <span class="id">n</span> <span class="id">Hlt</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">k</span>; <span class="tactic">intros</span>; <span class="id">unfold_Stv</span> <span class="id">x</span>; <span class="id">unfold_Stv</span> <span class="id">y</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Heq</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>; <span class="tactic">try</span> <span class="tactic">solve</span> [<span class="id">inv</span> <span class="id">Hlt</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1-2:<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">count_S_nth</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">eapply</span> <span class="id">IHk</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">auto</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">count_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof154')">Proof.</span></div>
<div class="proofscript" id="proof154">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?? <span class="id">Heq</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN_EqSt">EqStN_EqSt</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqStN_EqSt">EqStN_EqSt</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Heq</span>. <span class="tactic">rewrite</span> <span class="id">Heq</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.count_increasing">count_increasing</a></span> : <span class="kwd">forall</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n1</span> &lt;= <span class="id">n2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r</span>) # <span class="id">n1</span> &lt;= (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r</span>) # <span class="id">n2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof155')">Proof.</span></div>
<div class="proofscript" id="proof155">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">n1</span> <span class="id">n2</span>. <span class="id">revert</span> <span class="id">n1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n2</span>; <span class="tactic">intros</span> * <span class="id">Hle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n1</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n1</span>; <span class="id">unfold_Stv</span> <span class="id">r</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">count_S_nth</span>'; <span class="tactic">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n_S">le_n_S</a></span>, <span class="id">IHn2</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">IHn2</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.count_0_inv">count_0_inv</a></span> : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r</span>) # <span class="id">n</span> = 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">r</span> # 0 = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof156')">Proof.</span></div>
<div class="proofscript" id="proof156">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hcount</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_increasing">count_increasing</a></span> 0 <span class="id">n</span> <span class="id">r</span>) <span class="kwd">as</span> <span class="id">Hle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hcount</span> <span class="kwd">in</span> <span class="id">Hle</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_0_r">Nat.le_0_r</a></span> <span class="kwd">in</span> <span class="id">Hle</span>; <span class="tactic">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">Hle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">r</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.count_disj_le2">count_disj_le2</a></span> : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">r1</span> <span class="id">r2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r2</span>) # <span class="id">n</span> &lt;= (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.disj_str">disj_str</a></span> [<span class="id">r1</span>;<span class="id">r2</span>])) # <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof157')">Proof.</span></div>
<div class="proofscript" id="proof157">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">unfold_Stv</span> <span class="id">r1</span>; <span class="id">unfold_Stv</span> <span class="id">r2</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">count_S_nth</span>'; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n_S">le_n_S</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.count_shift">count_shift</a></span> : <span class="kwd">forall</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n1</span> &lt; <span class="id">n2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r</span>) # <span class="id">n2</span> = ((<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r</span>) # <span class="id">n1</span> + (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_tl">Str_nth_tl</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n1</span>) <span class="id">r</span>)) # (<span class="id">n2</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n1</span>))%<span class="id">nat</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof158')">Proof.</span></div>
<div class="proofscript" id="proof158">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">n1</span> <span class="id">n2</span>. <span class="id">revert</span> <span class="id">n1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n2</span>; <span class="tactic">intros</span> * <span class="id">Hlt</span>; <span class="tactic">destruct</span> <span class="id">n1</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="id">lia</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.sub_0_r">Nat.sub_0_r</a></span>. <span class="id">unfold_Stv</span> <span class="id">r</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">count_S_nth</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold_Stv</span> <span class="id">r</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">count_S_nth</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:(<span class="id">erewrite</span> <span class="id">IHn2</span>; [<span class="tactic">reflexivity</span>|<span class="id">lia</span>]).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.count_eq_false">count_eq_false</a></span> : <span class="kwd">forall</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n1</span> &lt; <span class="id">n2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r</span>) # <span class="id">n1</span> = (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r</span>) # <span class="id">n2</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id">n1</span> &lt; <span class="id">k</span> -&gt; <span class="id">k</span> &lt;= <span class="id">n2</span> -&gt; <span class="id">r</span> # <span class="id">k</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof159')">Proof.</span></div>
<div class="proofscript" id="proof159">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hlt</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> * <span class="id">Hcount</span> * <span class="id">Hl1</span> <span class="id">Hl2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_shift">count_shift</a></span> <span class="kwd">with</span> (<span class="id">n2</span>:=<span class="id">n2</span>) <span class="kwd">in</span> <span class="id">Hcount</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_tl">Str_nth_tl</a></span> <span class="id">_</span> <span class="id">_</span>)) # <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hcount</span>'. 2:<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Hcount</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_succ_l">Nat.le_succ_l</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_exists_sub">Nat.le_exists_sub</a></span> <span class="kwd">in</span> <span class="id">Hl1</span> <span class="kwd">as</span> (<span class="id">k</span>'&amp;?&amp;<span class="id">Hl1</span>); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_0">count_0</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">with</span> (<span class="id">m</span>:=<span class="id">k</span>') <span class="kwd">in</span> <span class="id">Hcount</span>'. 2:<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_plus">Str_nth_plus</a></span> <span class="kwd">in</span> <span class="id">Hcount</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> * <span class="id">Hcount</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_shift">count_shift</a></span> <span class="kwd">with</span> (<span class="id">n2</span>:=<span class="id">n2</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_0">count_0</a></span> (<span class="id">_</span> - <span class="id">_</span>) <span class="id">_</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? ?. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_plus">Str_nth_plus</a></span>. <span class="tactic">apply</span> <span class="id">Hcount</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.count_between">count_between</a></span> : <span class="kwd">forall</span> <span class="id">r</span> <span class="id">n1</span> <span class="id">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n1</span> &lt;= <span class="id">n2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r</span>) # <span class="id">n1</span> = (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r</span>) # <span class="id">n2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id">n1</span> &lt;= <span class="id">k</span> -&gt; <span class="id">k</span> &lt;= <span class="id">n2</span> -&gt; (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r</span>) # <span class="id">k</span> = (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r</span>) # <span class="id">n1</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof160')">Proof.</span></div>
<div class="proofscript" id="proof160">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hle</span> <span class="id">Hc</span> ? <span class="id">Hle1</span> <span class="id">Hle2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_antisymm">Nat.le_antisymm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_increasing">count_increasing</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_increasing">count_increasing</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> mask and friends </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">CoFixpoint</span> <span class="id">mask</span>' {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">absent</span>: <span class="id">A</span>) (<span class="id">k</span> <span class="id">k</span>': <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">rs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">xs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mask</span>' <span class="id">k</span>' := <span class="id">mask</span>' <span class="id">absent</span> <span class="id">k</span> <span class="id">k</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">rs</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">xs</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">rs</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> =&gt; (<span class="kwd">if</span> <span class="id">k</span>' =? <span class="id">k</span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">xs</span> <span class="kwd">else</span> <span class="id">absent</span>) ⋅ <span class="id">mask</span>' <span class="id">k</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>  =&gt; (<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>' =? <span class="id">k</span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">xs</span> <span class="kwd">else</span> <span class="id">absent</span>) ⋅ <span class="id">mask</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.mask">mask</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">absent</span>: <span class="id">A</span>) <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mask</span>' <span class="id">absent</span> <span class="id">k</span> 0 <span class="id">rs</span> <span class="id">xs</span>.<br/>
<br/>
<div class="doc">Synchronous value mask </div>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.maskv">maskv</a></span> <span class="id">k</span> <span class="id">rs</span> := @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> <span class="id">k</span> <span class="id">rs</span>.<br/>
<br/>
<div class="doc">Masking an history </div>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.mask_hist">mask_hist</a></span> {<span class="id">K</span>} <span class="id">k</span> <span class="id">rs</span> := @<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> <span class="id">K</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv">maskv</a></span> <span class="id">k</span> <span class="id">rs</span>).<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_hist">mask_hist</a></span> : <span class="id">fenv</span>.<br/>
<br/>
<div class="doc">Boolean mask </div>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.maskb">maskb</a></span> := <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.mask_nth">mask_nth</a></span> {<span class="id">A</span>} (<span class="id">absent</span>: <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span> <span class="id">absent</span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>) # <span class="id">n</span> = <span class="kwd">if</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">rs</span>) # <span class="id">n</span> =? <span class="id">k</span> <span class="kwd">then</span> <span class="id">xs</span> # <span class="id">n</span> <span class="kwd">else</span> <span class="id">absent</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof161')">Proof.</span></div>
<div class="proofscript" id="proof161">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth">Str_nth</a></span>. <span class="tactic">intros</span> <span class="id">n</span> <span class="id">k</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_tl">Str_nth_tl</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">rs</span>))) <span class="kwd">with</span> (0 + <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_tl">Str_nth_tl</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">rs</span>)))%<span class="id">nat</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> 0 <span class="kwd">as</span> <span class="id">k</span>'. <span class="id">revert</span> <span class="id">k</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>; <span class="id">unfold_Stv</span> <span class="id">rs</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.add_1_r">Nat.add_1_r</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.add_0_r">Nat.add_0_r</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">IHn</span>; <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count_S_nth">count_S_nth</a></span>, &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#plus_n_Sm">plus_n_Sm</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#plus_Sn_m">plus_Sn_m</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.maskv_nth">maskv_nth</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv">maskv</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>) # <span class="id">n</span> = <span class="kwd">if</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">rs</span>) # <span class="id">n</span> =? <span class="id">k</span> <span class="kwd">then</span> <span class="id">xs</span> # <span class="id">n</span> <span class="kwd">else</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof162')">Proof.</span></div>
<div class="proofscript" id="proof162">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_nth">mask_nth</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.maskb_nth">maskb_nth</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>) # <span class="id">n</span> = <span class="kwd">if</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">rs</span>) # <span class="id">n</span>  =? <span class="id">k</span> <span class="kwd">then</span> <span class="id">xs</span> # <span class="id">n</span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof163')">Proof.</span></div>
<div class="proofscript" id="proof163">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_nth">mask_nth</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">mask</span>'<span class="id">_Cons</span> {<span class="id">A</span>} (<span class="id">absent</span>: <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">r</span> <span class="id">rs</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">k</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">mask</span>' <span class="id">absent</span> <span class="id">k</span> <span class="id">k</span>' (<span class="id">r</span> ⋅ <span class="id">rs</span>) (<span class="id">x</span> ⋅ <span class="id">xs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (<span class="kwd">match</span> <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> =&gt; (<span class="kwd">if</span> <span class="id">k</span>' =? <span class="id">k</span> <span class="kwd">then</span> <span class="id">x</span> <span class="kwd">else</span> <span class="id">absent</span>) ⋅ <span class="id">mask</span>' <span class="id">absent</span> <span class="id">k</span> <span class="id">k</span>' <span class="id">rs</span> <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>  =&gt; (<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>' =? <span class="id">k</span> <span class="kwd">then</span> <span class="id">x</span> <span class="kwd">else</span> <span class="id">absent</span>) ⋅ <span class="id">mask</span>' <span class="id">absent</span> <span class="id">k</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>') <span class="id">rs</span> <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof164')">Proof.</span></div>
<div class="proofscript" id="proof164">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> (<span class="id">mask</span>' <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">r</span>; <span class="tactic">simpl</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">mask</span>'<span class="id">_S</span> {<span class="id">A</span>} (<span class="id">absent</span>: <span class="id">A</span>) : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">k</span>' <span class="id">rs</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mask</span>' <span class="id">absent</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>') <span class="id">rs</span> <span class="id">xs</span> ≡ <span class="id">mask</span>' <span class="id">absent</span> <span class="id">k</span> <span class="id">k</span>' <span class="id">rs</span> <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof165')">Proof.</span></div>
<div class="proofscript" id="proof165">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">rs</span> <span class="kwd">as</span> [[]], <span class="id">xs</span>; <span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.EqSt_unmask">EqSt_unmask</a></span> {<span class="id">A</span>} (<span class="id">absent</span>: <span class="id">A</span>) : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span> <span class="id">absent</span> <span class="id">k</span> <span class="id">b</span> <span class="id">x</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span> <span class="id">absent</span> <span class="id">k</span> <span class="id">b</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> ≡ <span class="id">y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof166')">Proof.</span></div>
<div class="proofscript" id="proof166">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Heq</span> ((<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">b</span>) # <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.Str_nth_EqSt">Str_nth_EqSt</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_nth">mask_nth</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.mask_false_0">mask_false_0</a></span> {<span class="id">A</span>} (<span class="id">absent</span>: <span class="id">A</span>) : <span class="kwd">forall</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span> <span class="id">absent</span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">xs</span> ≡ <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof167')">Proof.</span></div>
<div class="proofscript" id="proof167">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">k</span>, (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)) # <span class="id">k</span> = 0) <span class="kwd">as</span> <span class="id">Count</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">induction</span> <span class="id">k</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_nth">mask_nth</a></span>, <span class="id">Count</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.masks_false_0">masks_false_0</a></span> {<span class="id">A</span>} (<span class="id">absent</span>: <span class="id">A</span>) : <span class="kwd">forall</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span> <span class="id">absent</span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)) <span class="id">xs</span>) <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof168')">Proof.</span></div>
<div class="proofscript" id="proof168">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *. <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_same">Forall2_same</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>. <span class="tactic">intros</span> ? <span class="id">_</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_false_0">mask_false_0</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.maskb_false_0">maskb_false_0</a></span> : <span class="kwd">forall</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">bs</span> ≡ <span class="id">bs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof169')">Proof.</span></div>
<div class="proofscript" id="proof169">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_false_0">mask_false_0</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.mask_false_S">mask_false_S</a></span> {<span class="id">A</span>} (<span class="id">absent</span>: <span class="id">A</span>) : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span> <span class="id">absent</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">xs</span> ≡ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id">absent</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof170')">Proof.</span></div>
<div class="proofscript" id="proof170">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">k</span>, (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)) # <span class="id">k</span> = 0) <span class="kwd">as</span> <span class="id">Count</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">induction</span> <span class="id">k</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_nth">mask_nth</a></span>, <span class="id">Count</span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_nth">const_nth</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.masks_false_S">masks_false_S</a></span> {<span class="id">A</span>} (<span class="id">absent</span>: <span class="id">A</span>) : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span> <span class="id">absent</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)) <span class="id">xs</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id">absent</span>) <span class="id">xs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof171')">Proof.</span></div>
<div class="proofscript" id="proof171">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *. <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.EqSts">EqSts</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_same">Forall2_same</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>. <span class="tactic">intros</span> ? <span class="id">_</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_false_S">mask_false_S</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.maskb_false_S">maskb_false_S</a></span> : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">bs</span> ≡ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof172')">Proof.</span></div>
<div class="proofscript" id="proof172">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_false_S">mask_false_S</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.mask_hist_false_0">mask_hist_false_0</a></span> {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">H</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> <span class="id">K</span> <span class="id">_</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_hist">mask_hist</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">H</span>) <span class="id">H</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof173')">Proof.</span></div>
<div class="proofscript" id="proof173">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * ?. <span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">x</span>) <span class="id">eqn</span>:<span class="id">Hfind</span>; <span class="tactic">simpl</span>; <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_false_0">mask_false_0</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.mask_hist_false_S">mask_hist_false_S</a></span> {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">H</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> <span class="id">K</span> <span class="id">_</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_hist">mask_hist</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">H</span>) (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">H</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof174')">Proof.</span></div>
<div class="proofscript" id="proof174">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * ?. <span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">x</span>) <span class="id">eqn</span>:<span class="id">Hfind</span>; <span class="tactic">simpl</span>; <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_false_S">mask_false_S</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.consolidate_mask">consolidate_mask</a></span> {<span class="id">A</span>} (<span class="id">absent</span>: <span class="id">A</span>) : <span class="kwd">forall</span> <span class="id">P</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>) <span class="id">P</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="tactic">exists</span> <span class="id">v</span>, <span class="id">P</span> <span class="id">k</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span> <span class="id">absent</span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">v</span>, <span class="kwd">forall</span> <span class="id">k</span>, <span class="id">P</span> <span class="id">k</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span> <span class="id">absent</span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof175')">Proof.</span></div>
<div class="proofscript" id="proof175">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">HP</span> <span class="id">Hmask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.IndefiniteDescription.html#functional_choice">functional_choice</a></span> <span class="kwd">in</span> <span class="id">Hmask</span> <span class="kwd">as</span> (<span class="id">f</span>&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.init_from">init_from</a></span> 0 (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (<span class="id">f</span> ((<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r</span>) # <span class="id">n</span>)) # <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">k</span>. <span class="tactic">specialize</span> (<span class="id">H</span> <span class="id">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">HP</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_nth">mask_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hcount</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span> <span class="kwd">in</span> <span class="id">Hcount</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.init_from_nth">init_from_nth</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.add_0_r">Nat.add_0_r</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.consolidate_mask_hist">consolidate_mask_hist</a></span> {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">P</span> <span class="id">r</span> <span class="id">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>)) ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>) <span class="id">P</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span> <span class="id">H</span>, <span class="id">P</span> <span class="id">k</span> <span class="id">H</span> -&gt; @<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.dom">FEnv.dom</a></span> <span class="id">K</span> <span class="id">_</span> <span class="id">H</span> <span class="id">d</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="tactic">exists</span> <span class="id">H</span>, <span class="id">P</span> <span class="id">k</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">H</span>, <span class="kwd">forall</span> <span class="id">k</span>, <span class="id">P</span> <span class="id">k</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof176')">Proof.</span></div>
<div class="proofscript" id="proof176">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">HP</span> <span class="id">Hdom</span> <span class="id">Hmask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.IndefiniteDescription.html#functional_choice">functional_choice</a></span> <span class="kwd">in</span> <span class="id">Hmask</span> <span class="kwd">as</span> (<span class="id">f</span>&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.mapi">FEnv.mapi</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.init_from">init_from</a></span> 0 (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#or_default_with">or_default_with</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="id">v</span> # <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">f</span> ((<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r</span>) # <span class="id">n</span>)) <span class="id">x</span>))) (<span class="id">f</span> 0)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">k1</span> <span class="id">k2</span> <span class="id">x</span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.In">FEnv.In</a></span> <span class="id">x</span> (<span class="id">f</span> <span class="id">k1</span>) -&gt; <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.In">FEnv.In</a></span> <span class="id">x</span> (<span class="id">f</span> <span class="id">k2</span>)) <span class="kwd">as</span> <span class="id">Hdomf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span> * <span class="id">Hin</span>. <span class="tactic">specialize</span> (<span class="id">H</span> <span class="id">k1</span>) <span class="kwd">as</span> <span class="id">H1</span>. <span class="tactic">specialize</span> (<span class="id">H</span> <span class="id">k2</span>) <span class="kwd">as</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.dom_map">FEnv.dom_map</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hdom</span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map_in_iff">FEnv.map_in_iff</a></span>; [|<span class="tactic">eauto</span>]. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">k</span>. <span class="tactic">specialize</span> (<span class="id">H</span> <span class="id">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">HP</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_hist">mask_hist</a></span>. <span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">f</span> 0) <span class="id">x</span>) <span class="id">eqn</span>:<span class="id">H0</span>, ((<span class="id">f</span> <span class="id">k</span>) <span class="id">x</span>) <span class="id">eqn</span>:<span class="id">Hk</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv_nth">maskv_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hcount</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span> <span class="kwd">in</span> <span class="id">Hcount</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.init_from_nth">init_from_nth</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.add_0_r">Nat.add_0_r</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hk</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="id">edestruct</span> <span class="id">Hdomf</span> <span class="kwd">with</span> (<span class="id">k2</span>:=<span class="id">k</span>); [<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>|]. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="id">edestruct</span> <span class="id">Hdomf</span> <span class="kwd">with</span> (<span class="id">k2</span>:=0); [<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>|]. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> {<span class="id">A</span>} (<span class="id">absent</span>: <span class="id">A</span>) <span class="id">k</span> : (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span> <span class="id">absent</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">mask_morph</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof177')">Proof.</span></div>
<div class="proofscript" id="proof177">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">Ers</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_nth">mask_nth</a></span>, <span class="id">Exs</span>, <span class="id">Ers</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">k</span> : (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv">maskv</a></span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">maskv_morph</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof178')">Proof.</span></div>
<div class="proofscript" id="proof178">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">Ers</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_morph">mask_morph</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> {<span class="id">K</span>} <span class="id">k</span> : (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_hist">mask_hist</a></span> <span class="id">K</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) ==&gt; <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">mask_hist_morph</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof179')">Proof.</span></div>
<div class="proofscript" id="proof179">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">r</span> <span class="id">r</span>' <span class="id">Er</span> <span class="id">H</span> <span class="id">H</span>' <span class="id">EH</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">EH</span> <span class="id">x</span>). <span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">EH</span>; <span class="tactic">simpl</span>; <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>, <span class="id">Er</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">k</span> : (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">maskb_morph</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof180')">Proof.</span></div>
<div class="proofscript" id="proof180">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">Ers</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_morph">mask_morph</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">maskb_EqSt</span>' : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> <span class="id">k</span> <span class="id">b</span> <span class="id">x</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> <span class="id">k</span> <span class="id">b</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> ≡ <span class="id">y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof181')">Proof.</span></div>
<div class="proofscript" id="proof181">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Heq</span> ((<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">b</span>) # <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.Str_nth_EqSt">Str_nth_EqSt</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb_nth">maskb_nth</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.maskb_idem">maskb_idem</a></span> : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">b</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> <span class="id">k</span> <span class="id">b</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> <span class="id">k</span> <span class="id">b</span> <span class="id">x</span>) ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> <span class="id">k</span> <span class="id">b</span> <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof182')">Proof.</span></div>
<div class="proofscript" id="proof182">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb_nth">maskb_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">k</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.mask_absent">mask_absent</a></span> {<span class="id">A</span>} (<span class="id">absent</span>: <span class="id">A</span>) : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span> <span class="id">absent</span> <span class="id">k</span> <span class="id">rs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id">absent</span>) ≡ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id">absent</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof183')">Proof.</span></div>
<div class="proofscript" id="proof183">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_nth">mask_nth</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">k</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.mask_hist_absent">mask_hist_absent</a></span> {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">rs</span> (<span class="id">H</span>: @<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.t">FEnv.t</a></span> <span class="id">K</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">rs</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">H</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">H</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof184')">Proof.</span></div>
<div class="proofscript" id="proof184">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">x</span>. <span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">x</span>); <span class="tactic">simpl</span>; <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_absent">mask_absent</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id">mask_hist_absent</span>' {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">rs</span> (<span class="id">H</span>: @<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.t">FEnv.t</a></span> <span class="id">K</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> (@<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> <span class="id"><a href="Velus.CoindStreams.html#Op.value">value</a></span>)) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">H</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">H</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof185')">Proof.</span></div>
<div class="proofscript" id="proof185">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">x</span>. <span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">x</span>); <span class="tactic">simpl</span>; <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.maskb_absent">maskb_absent</a></span>: <span class="kwd">forall</span> <span class="id">k</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> <span class="id">k</span> <span class="id">rs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) ≡ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof186')">Proof.</span></div>
<div class="proofscript" id="proof186">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb_nth">maskb_nth</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">k</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">fenv_scope</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.refines_mask">refines_mask</a></span> {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">r</span> (<span class="id">H</span> <span class="id">H</span>' : @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>) <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H</span> ⊑ <span class="id">H</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) ⊑ (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>').<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof187')">Proof.</span></div>
<div class="proofscript" id="proof187">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Href</span> ?? <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Href</span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> (?&amp;<span class="id">Heq</span>&amp;<span class="id">Hfind</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfind</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.refines_unmask">refines_unmask</a></span> {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">r</span> (<span class="id">H</span> <span class="id">H</span>' : @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) ⊑ (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>')) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H</span> ⊑ <span class="id">H</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof188')">Proof.</span></div>
<div class="proofscript" id="proof188">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ??? <span class="id">Href</span> ?? <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Href</span> 0 <span class="id">x</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv">maskv</a></span> 0 <span class="id">r</span> <span class="id">v</span>)) <span class="kwd">as</span> <span class="id">Href0</span>. <span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfind</span> <span class="kwd">in</span> <span class="id">Href0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Href0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Href0</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>) <span class="kwd">as</span> (?&amp;?&amp;<span class="id">Hfind0</span>). <span class="id">inv_equalities</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Href</span> ((<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">r</span>) #<span class="id">n</span>) <span class="id">x</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Href</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfind</span>, <span class="id">Hf</span> <span class="kwd">in</span> <span class="id">Href</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Href</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Href</span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>) <span class="kwd">as</span> (?&amp;<span class="id">Heq1</span>&amp;<span class="id">Heq2</span>). <span class="id">inv</span> <span class="id">Heq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Heq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv_nth">maskv_nth</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Heq1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.clocks_of_mask">clocks_of_mask</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">k</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.clocks_of">clocks_of</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv">maskv</a></span> <span class="id">k</span> <span class="id">rs</span>) <span class="id">xs</span>) ≡ (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> <span class="id">k</span> <span class="id">rs</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.clocks_of">clocks_of</a></span> <span class="id">xs</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof189')">Proof.</span></div>
<div class="proofscript" id="proof189">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb_nth">maskb_nth</a></span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.clocks_of_nth">clocks_of_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#existsb_map">existsb_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">k</span>) <span class="id">eqn</span>:<span class="id">Hcount</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#existsb_ext">existsb_ext</a></span>; <span class="tactic">intros</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv_nth">maskv_nth</a></span>, <span class="id">Hcount</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#existsb_Forall">existsb_Forall</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb_forall">forallb_forall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv_nth">maskv_nth</a></span>, <span class="id">Hcount</span>, <span class="id"><a href="Velus.CoindStreams.html#OpAux.neg_eq_svalue">neg_eq_svalue</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_mask">ac_mask</a></span> : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv">maskv</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>) ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> <span class="id">k</span> <span class="id">rs</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">xs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof190')">Proof.</span></div>
<div class="proofscript" id="proof190">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.ac_nth">ac_nth</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv_nth">maskv_nth</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb_nth">maskb_nth</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.ac_nth">ac_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.bools_of_mask">bools_of_mask</a></span> : <span class="kwd">forall</span> <span class="id">rs</span> <span class="id">xs</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of">bools_of</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv">maskv</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">bs</span>)) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of">bools_of</a></span> <span class="id">xs</span> <span class="id">bs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof191')">Proof.</span></div>
<div class="proofscript" id="proof191">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of_nth">bools_of_nth</a></span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_nth">mask_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">specialize</span> (<span class="id">H</span> ((<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.count">count</a></span> <span class="id">rs</span>) # <span class="id">n</span>) <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.bools_of_mask_inv">bools_of_mask_inv</a></span> : <span class="kwd">forall</span> <span class="id">rs</span> <span class="id">k</span> <span class="id">xs</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of">bools_of</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv">maskv</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>) <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">bs</span>', <span class="id">bs</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">bs</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof192')">Proof.</span></div>
<div class="proofscript" id="proof192">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">exists</span> <span class="id">bs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of_nth">bools_of_nth</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;?)|[(?&amp;?)|(?&amp;?)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1-3:<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb_nth">maskb_nth</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv_nth">maskv_nth</a></span> <span class="kwd">in</span> *; <span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.bools_of_mask_det">bools_of_mask_det</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">rs</span> <span class="id">k</span> <span class="id">bs1</span> <span class="id">bs2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of">bools_of</a></span> <span class="id">xs</span> <span class="id">bs1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of">bools_of</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv">maskv</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">xs</span>) <span class="id">bs2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bs2</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> <span class="id">k</span> <span class="id">rs</span> <span class="id">bs1</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof193')">Proof.</span></div>
<div class="proofscript" id="proof193">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hb1</span> <span class="id">Hb2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.bools_of_nth">bools_of_nth</a></span> <span class="kwd">in</span> *. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_nth">mask_nth</a></span> <span class="kwd">in</span> <span class="id">Hb2</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb_nth">maskb_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hb1</span> <span class="id">n</span>) <span class="kwd">as</span> [(?&amp;?)|[(?&amp;?)|(?&amp;?)]]; <span class="tactic">specialize</span> (<span class="id">Hb2</span> <span class="id">n</span>) <span class="kwd">as</span> [(?&amp;?)|[(?&amp;?)|(?&amp;?)]]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1-9:<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_mask">sem_var_mask</a></span> {<span class="id">K</span>}: <span class="kwd">forall</span> <span class="id">k</span> <span class="id">r</span> (<span class="id">H</span> : @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>) <span class="id">x</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">H</span> <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) <span class="id">x</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof194')">Proof.</span></div>
<div class="proofscript" id="proof194">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvar</span>. <span class="id">inv</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_fenv</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_mask_inv">sem_var_mask_inv</a></span> {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">r</span> (<span class="id">H</span> : @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>) <span class="id">x</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">v</span>', <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">H</span> <span class="id">x</span> <span class="id">v</span>' /\ <span class="id">v</span> ≡ (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>').<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof195')">Proof.</span></div>
<div class="proofscript" id="proof195">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvar</span>. <span class="id">inv</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>. <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h3> Caracterizing a stream that is slower than a clock stream </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">CoInductive</span> <span class="id"><a name="COINDSTREAMS.slower">slower</a></span> {<span class="id">A</span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> <span class="id">A</span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.slowerF">slowerF</a></span> : <span class="kwd">forall</span> <span class="id">vs</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">slower</span> <span class="id">vs</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">slower</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">vs</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> ⋅ <span class="id">bs</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.slowerT">slowerT</a></span> : <span class="kwd">forall</span> <span class="id">v</span> <span class="id">vs</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">slower</span> <span class="id">vs</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">slower</span> (<span class="id">v</span> ⋅ <span class="id">vs</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> ⋅ <span class="id">bs</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.slower_hist">slower_hist</a></span> {<span class="id">K</span>} (<span class="id">H</span> : @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>) <span class="id">bs</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">vs</span>, <span class="id">H</span> <span class="id">x</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vs</span> -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower">slower</a></span> <span class="id">vs</span> <span class="id">bs</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.slower_nth">slower_nth</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower">slower</a></span> <span class="id">A</span> <span class="id">vs</span> <span class="id">bs</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">bs</span> # <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt; <span class="id">vs</span> # <span class="id">n</span> = <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof196')">Proof with</span></div>
<div class="proofscript" id="proof196">
 <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">H</span> <span class="id">n</span>. <span class="id">revert</span> <span class="id">vs</span> <span class="id">bs</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span> <span class="kwd">in</span> *; <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">vs</span> <span class="id">bs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="tactic">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">vs</span>; <span class="id">unfold_Stv</span> <span class="id">bs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1-3:(<span class="tactic">constructor</span>; <span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">H</span> 0) <span class="kwd">as</span> <span class="id">H0</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>. <span class="tactic">constructor</span>; <span class="id">cofix_step</span> <span class="id">CoFix</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> {<span class="id">A</span>} : (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower">slower</a></span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">slower_morph</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof197')">Proof.</span></div>
<div class="proofscript" id="proof197">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Exs</span> <span class="id">bs</span> <span class="id">bs</span>' <span class="id">Ebs</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower_nth">slower_nth</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower_nth">slower_nth</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Exs</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">Ebs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.aligned_slower">aligned_slower</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> <span class="id">bs</span> (<span class="id">vs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> <span class="id">A</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.aligned">aligned</a></span> <span class="id">vs</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower">slower</a></span> <span class="id">vs</span> <span class="id">bs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof198')">Proof.</span></div>
<div class="proofscript" id="proof198">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">constructor</span>; <span class="tactic">apply</span> <span class="id">CoFix</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sc_slower">sc_slower</a></span> : <span class="kwd">forall</span> <span class="id">H</span> <span class="id">bs</span> <span class="id">ck</span> <span class="id">bs</span>' (<span class="id">vs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> <span class="id"><a href="Velus.CoindStreams.html#Op.value">value</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_clock">sem_clock</a></span> <span class="id">H</span> <span class="id">bs</span> <span class="id">ck</span> <span class="id">bs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.aligned">aligned</a></span> <span class="id">vs</span> <span class="id">bs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower">slower</a></span> <span class="id">vs</span> <span class="id">bs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof199')">Proof.</span></div>
<div class="proofscript" id="proof199">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ck</span>; <span class="tactic">intros</span> * <span class="id">Hck</span> <span class="id">Hal</span>; <span class="id">inv</span> <span class="id">Hck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.aligned_slower">aligned_slower</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHck</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">take</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.whenb">whenb</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.ac_whenb">ac_whenb</a></span> <span class="kwd">in</span> <span class="id">it</span>. <span class="tactic">rewrite</span> <span class="id">it</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.ac_aligned">ac_aligned</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hal</span> <span class="id">H9</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower_nth">slower_nth</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.aligned_spec">aligned_spec</a></span> <span class="kwd">in</span> <span class="id">Hal</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.whenb_nth">whenb_nth</a></span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hfalse</span>. <span class="tactic">specialize</span> (<span class="id">Hal</span> <span class="id">n</span>). <span class="tactic">specialize</span> (<span class="id">H9</span> <span class="id">n</span>). <span class="tactic">specialize</span> (<span class="id">H6</span> <span class="id">n</span> <span class="id">Hfalse</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H9</span> <span class="kwd">as</span> [(?&amp;?&amp;?)|[(?&amp;?&amp;<span class="id">Hx</span>&amp;?&amp;?)|(?&amp;<span class="id">Hx</span>&amp;?)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">Hal</span> <span class="kwd">as</span> [(?&amp;?&amp;?)|(?&amp;?)]; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">setoid_rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">Hx</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">setoid_rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">Hx</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.slower_mask">slower_mask</a></span> : <span class="kwd">forall</span> <span class="id">vs</span> <span class="id">bs</span> <span class="id">k</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower">slower</a></span> <span class="id">vs</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">bs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vs</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">vs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof200')">Proof.</span></div>
<div class="proofscript" id="proof200">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hslow</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv_nth">maskv_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hcount</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower_nth">slower_nth</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hslow</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb_nth">maskb_nth</a></span>, <span class="id">Hcount</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.slower_mask_hist">slower_mask_hist</a></span> {<span class="id">K</span>} : <span class="kwd">forall</span> (<span class="id">H</span> : @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>) <span class="id">bs</span> <span class="id">k</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower_hist">slower_hist</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">bs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) <span class="id">H</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof201')">Proof.</span></div>
<div class="proofscript" id="proof201">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hslow</span> <span class="id">x</span>. <span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">x</span>) <span class="id">eqn</span>:<span class="id">Hfind</span>; <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hslow</span> <span class="kwd">in</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower_mask">slower_mask</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_slower">ac_slower</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower">slower</a></span> <span class="id">A</span> <span class="id">vs</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">vs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof202')">Proof.</span></div>
<div class="proofscript" id="proof202">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower_nth">slower_nth</a></span>. <span class="tactic">intros</span> <span class="id">n</span> <span class="id">Hac</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.ac_nth">ac_nth</a></span> <span class="kwd">in</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">vs</span> # <span class="id">n</span>) <span class="id">eqn</span>:<span class="id">Hv</span>; <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">ac_slower</span> : <span class="id">coindstreams</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.slower_ac_morph">slower_ac_morph</a></span> {<span class="id">A</span> <span class="id">B</span>} : <span class="kwd">forall</span> (<span class="id">vs1</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> <span class="id">A</span>)) (<span class="id">vs2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> <span class="id">B</span>)) <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">vs1</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">vs2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower">slower</a></span> <span class="id">vs1</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower">slower</a></span> <span class="id">vs2</span> <span class="id">bs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof203')">Proof.</span></div>
<div class="proofscript" id="proof203">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hac</span> <span class="id">Hsc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">vs1</span> <span class="kwd">as</span> ([]&amp;?), <span class="id">vs2</span> <span class="kwd">as</span> ([]&amp;?), <span class="id">bs</span> <span class="kwd">as</span> ([]&amp;?);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsc</span>; <span class="id">inv</span> <span class="id">Hac</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1-3:<span class="tactic">constructor</span>; <span class="tactic">eapply</span> <span class="id">CoFix</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> when relation </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.when_hist">when_hist</a></span> {<span class="id">K</span>} (<span class="id">sel</span> : <span class="id"><a href="Velus.CoindStreams.html#Op.enumtag">enumtag</a></span>) (<span class="id">Hi</span> : @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>) (<span class="id">es</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>) (<span class="id">Hi</span>' : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (<span class="kwd">fun</span> <span class="id">vs</span>' <span class="id">vs</span> =&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when">when</a></span> <span class="id">sel</span> <span class="id">vs</span> <span class="id">es</span> <span class="id">vs</span>') <span class="id">Hi</span>' <span class="id">Hi</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">sel</span> : (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when">when</a></span> <span class="id">sel</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">when_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof204')">Proof.</span></div>
<div class="proofscript" id="proof204">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Heq1</span> * <span class="id">Heq2</span> * <span class="id">Heq3</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when_spec">when_spec</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when_spec">when_spec</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Heq1</span>, &lt;-<span class="id">Heq2</span>, &lt;-<span class="id">Heq3</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hf</span> <span class="kwd">as</span> [|[|]]; <span class="id">destruct_conjs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>; <span class="tactic">left</span>. <span class="tactic">do</span> 2 <span class="id">esplit</span>. <span class="id">erewrite</span> &lt;-<span class="id">Heq1</span>, &lt;-<span class="id">Heq2</span>, &lt;-<span class="id">Heq3</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>; <span class="tactic">right</span>. <span class="id">esplit</span>. <span class="id">erewrite</span> &lt;-<span class="id">Heq1</span>, &lt;-<span class="id">Heq2</span>, &lt;-<span class="id">Heq3</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> {<span class="id">K</span>} <span class="id">sel</span> : (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when_hist">when_hist</a></span> <span class="id">K</span> <span class="id">sel</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">when_hist_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof205')">Proof.</span></div>
<div class="proofscript" id="proof205">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Heq1</span> * <span class="id">Heq2</span> * <span class="id">Heq3</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when_hist">when_hist</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?? <span class="id">Hfind</span>. <span class="tactic">specialize</span> (<span class="id">Heq3</span> <span class="id">x2</span>). <span class="tactic">rewrite</span> <span class="id">Hfind</span> <span class="kwd">in</span> <span class="id">Heq3</span>. <span class="id">inv</span> <span class="id">Heq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id">Hf</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;<span class="id">Hwhen</span>&amp;<span class="id">Hfind</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Heq1</span> <span class="id">x2</span>). <span class="tactic">rewrite</span> <span class="id">Hfind</span>' <span class="kwd">in</span> <span class="id">Heq1</span>. <span class="id">inv</span> <span class="id">Heq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Heq2</span>, &lt;-<span class="id">H2</span>, &lt;-<span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">when as a function </div>
<br/>
&nbsp;&nbsp;<span class="kwd">CoFixpoint</span> <span class="id"><a name="COINDSTREAMS.fwhen">fwhen</a></span> {<span class="id">A</span>} (<span class="id">abs</span> : <span class="id">A</span>) (<span class="id">sel</span> : <span class="id"><a href="Velus.CoindStreams.html#Op.enumtag">enumtag</a></span>) (<span class="id">vs</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>) (<span class="id">es</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">es</span> ==<span class="id">b</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">sel</span>) <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">hd</a></span> <span class="id">vs</span> <span class="kwd">else</span> <span class="id">abs</span>) ⋅ (<span class="id">fwhen</span> <span class="id">abs</span> <span class="id">sel</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">vs</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">tl</a></span> <span class="id">es</span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.fwhenv">fwhenv</a></span> <span class="id">sel</span> <span class="id">vs</span> <span class="id">es</span> := <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen">fwhen</a></span> (@<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> <span class="id"><a href="Velus.CoindStreams.html#Op.value">value</a></span>) <span class="id">sel</span> <span class="id">vs</span> <span class="id">es</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.fwhen_hist">fwhen_hist</a></span> {<span class="id">K</span>} <span class="id">sel</span> <span class="id">H</span> <span class="id">es</span> := @<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> <span class="id">K</span> <span class="id">_</span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">vs</span> =&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv">fwhenv</a></span> <span class="id">sel</span> <span class="id">vs</span> <span class="id">es</span>) <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.fwhenb">fwhenb</a></span> := <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen">fwhen</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_hist">fwhen_hist</a></span> : <span class="id">fenv</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.fwhen_nth">fwhen_nth</a></span> {<span class="id">A</span>} (<span class="id">abs</span> : <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">sel</span> <span class="id">es</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen">fwhen</a></span> <span class="id">abs</span> <span class="id">sel</span> <span class="id">xs</span> <span class="id">es</span>) # <span class="id">n</span> = <span class="kwd">if</span> <span class="id">es</span> # <span class="id">n</span> ==<span class="id">b</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">sel</span>) <span class="kwd">then</span> <span class="id">xs</span> # <span class="id">n</span> <span class="kwd">else</span> <span class="id">abs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof206')">Proof.</span></div>
<div class="proofscript" id="proof206">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth">Str_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>; <span class="id">unfold_St</span> <span class="id">es</span>; <span class="id">unfold_St</span> <span class="id">xs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.fwhenv_nth">fwhenv_nth</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">e</span> <span class="id">es</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv">fwhenv</a></span> <span class="id">e</span> <span class="id">xs</span> <span class="id">es</span>) # <span class="id">n</span> = <span class="kwd">if</span> <span class="id">es</span> # <span class="id">n</span> ==<span class="id">b</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">e</span>) <span class="kwd">then</span> <span class="id">xs</span> # <span class="id">n</span> <span class="kwd">else</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof207')">Proof.</span></div>
<div class="proofscript" id="proof207">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_nth">fwhen_nth</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.fwhenb_nth">fwhenb_nth</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">e</span> <span class="id">es</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenb">fwhenb</a></span> <span class="id">e</span> <span class="id">xs</span> <span class="id">es</span>) # <span class="id">n</span> = <span class="kwd">if</span> <span class="id">es</span> # <span class="id">n</span> ==<span class="id">b</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">e</span>) <span class="kwd">then</span> <span class="id">xs</span> # <span class="id">n</span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof208')">Proof.</span></div>
<div class="proofscript" id="proof208">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_nth">fwhen_nth</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.fwhen_Cons">fwhen_Cons</a></span> {<span class="id">A</span>} (<span class="id">abs</span> : <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sel</span> <span class="id">e</span> <span class="id">es</span> <span class="id">x</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen">fwhen</a></span> <span class="id">abs</span> <span class="id">sel</span> (<span class="id">x</span> ⋅ <span class="id">xs</span>) (<span class="id">e</span> ⋅ <span class="id">es</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (<span class="kwd">if</span> <span class="id">e</span> ==<span class="id">b</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">sel</span>) <span class="kwd">then</span> <span class="id">x</span> <span class="kwd">else</span> <span class="id">abs</span>) ⋅ (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen">fwhen</a></span> <span class="id">abs</span> <span class="id">sel</span> <span class="id">xs</span> <span class="id">es</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof209')">Proof.</span></div>
<div class="proofscript" id="proof209">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen">fwhen</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)); <span class="tactic">simpl</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.when_fwhen">when_fwhen</a></span> <span class="id">sel</span> : <span class="kwd">forall</span> <span class="id">es</span> <span class="id">vs</span> <span class="id">vs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when">when</a></span> <span class="id">sel</span> <span class="id">vs</span> <span class="id">es</span> <span class="id">vs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vs</span>' ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv">fwhenv</a></span> <span class="id">sel</span> <span class="id">vs</span> <span class="id">es</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof210')">Proof.</span></div>
<div class="proofscript" id="proof210">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwhen</span>; <span class="id">inv</span> <span class="id">Hwhen</span>; <span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">inv</span> <span class="id">Heq</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.fwhenv_whenv">fwhenv_whenv</a></span> <span class="id">sel</span> : <span class="kwd">forall</span> <span class="id">es</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonStreams.html#SForall">SForall</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">_</span>) | <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span> <span class="kwd">end</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">vs</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when">when</a></span> <span class="id">sel</span> <span class="id">vs</span> <span class="id">es</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv">fwhenv</a></span> <span class="id">sel</span> <span class="id">vs</span> <span class="id">es</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof211')">Proof.</span></div>
<div class="proofscript" id="proof211">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ([]&amp;?) ([]&amp;?) <span class="id">Hwt</span> <span class="id">Hac</span>; <span class="id">inv</span> <span class="id">Hwt</span>; <span class="id">inv</span> <span class="id">Hac</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv">fwhenv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>. <span class="tactic">apply</span> <span class="id">CoFix</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv">fwhenv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)); <span class="tactic">simpl</span>. <span class="tactic">destruct</span> (<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">inv</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>. <span class="tactic">apply</span> <span class="id">CoFix</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">try</span> <span class="id">now</span> <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>. <span class="tactic">apply</span> <span class="id">CoFix</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">contra</span>. <span class="tactic">subst</span> <span class="id">e</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.when_hist_fwhen_hist">when_hist_fwhen_hist</a></span> {<span class="id">K</span>} <span class="id">sel</span> <span class="id">es</span> : <span class="kwd">forall</span> (<span class="id">Hi</span> <span class="id">Hi</span>' : @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when_hist">when_hist</a></span> <span class="id">sel</span> <span class="id">Hi</span> <span class="id">es</span> <span class="id">Hi</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hi</span>' ⊑ (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_hist">fwhen_hist</a></span> <span class="id">sel</span> <span class="id">Hi</span> <span class="id">es</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof212')">Proof.</span></div>
<div class="proofscript" id="proof212">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwhen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?? <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hwhen</span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> (?&amp;<span class="id">Hf</span>&amp;<span class="id">Hfind</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when_fwhen">when_fwhen</a></span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_fenv</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.when_hist_restrict_ac">when_hist_restrict_ac</a></span> {<span class="id">K</span>} `{<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.fenv_key">FEnv.fenv_key</a></span> <span class="id">K</span>} <span class="id">sel</span> <span class="id">es</span> : <span class="kwd">forall</span> (<span class="id">Hi</span> : @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>) <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonStreams.html#SForall">SForall</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">_</span>) | <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span> <span class="kwd">end</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">vs</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">List.In</a></span> <span class="id">x</span> <span class="id">xs</span> -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">Hi</span> <span class="id">x</span> <span class="id">vs</span> -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">vs</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when_hist">when_hist</a></span> <span class="id">sel</span> <span class="id">Hi</span> <span class="id">es</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict">FEnv.restrict</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_hist">fwhen_hist</a></span> <span class="id">sel</span> <span class="id">Hi</span> <span class="id">es</span>) <span class="id">xs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof213')">Proof.</span></div>
<div class="proofscript" id="proof213">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwt</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?? <span class="id">Hfind</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_find_inv">FEnv.restrict_find_inv</a></span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> (<span class="id">Hin</span>&amp;<span class="id">Hfind</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv_whenv">fwhenv_whenv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hac</span>; <span class="tactic">eauto</span>. <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> {<span class="id">A</span>} (<span class="id">absent</span>: <span class="id">A</span>) <span class="id">k</span> : (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen">fwhen</a></span> <span class="id">absent</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">fwhen_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof214')">Proof.</span></div>
<div class="proofscript" id="proof214">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">Ers</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_nth">fwhen_nth</a></span>, <span class="id">Exs</span>, <span class="id">Ers</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">k</span> : (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv">fwhenv</a></span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">fwhenv_morph</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof215')">Proof.</span></div>
<div class="proofscript" id="proof215">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">Ers</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_EqSt">fwhen_EqSt</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> {<span class="id">K</span>} <span class="id">k</span> : (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_hist">fwhen_hist</a></span> <span class="id">K</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">fwhen_hist_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof216')">Proof.</span></div>
<div class="proofscript" id="proof216">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">H</span> <span class="id">H</span>' <span class="id">EH</span>  <span class="id">r</span> <span class="id">r</span>' <span class="id">Er</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span>. <span class="tactic">specialize</span> (<span class="id">EH</span> <span class="id">x</span>). <span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">EH</span>; <span class="tactic">simpl</span>; <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>, <span class="id">Er</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">k</span> : (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenb">fwhenb</a></span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">fwhenb_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof217')">Proof.</span></div>
<div class="proofscript" id="proof217">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">Ers</span> <span class="id">xs</span> <span class="id">xs</span>' <span class="id">Exs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_EqSt">fwhen_EqSt</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_fwhen">ac_fwhen</a></span> : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">sc</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv">fwhenv</a></span> <span class="id">k</span> <span class="id">xs</span> <span class="id">sc</span>) ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenb">fwhenb</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">xs</span>) <span class="id">sc</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof218')">Proof.</span></div>
<div class="proofscript" id="proof218">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.ac_nth">ac_nth</a></span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_nth">fwhen_nth</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.ac_nth">ac_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_fwhen">sem_var_fwhen</a></span> {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">r</span> (<span class="id">H</span>: @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>) <span class="id">x</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">H</span> <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_hist">fwhen_hist</a></span> <span class="id">k</span> <span class="id">H</span> <span class="id">r</span>) <span class="id">x</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv">fwhenv</a></span> <span class="id">k</span> <span class="id">v</span> <span class="id">r</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof219')">Proof.</span></div>
<div class="proofscript" id="proof219">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvar</span>. <span class="id">inv</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_fenv</span>. <span class="tactic">econstructor</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_when">sem_var_when</a></span> {<span class="id">K</span>} <span class="id">x</span> : <span class="kwd">forall</span> <span class="id">sel</span> <span class="id">sc</span> (<span class="id">Hi</span> <span class="id">Hi</span>': @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>) <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when_hist">when_hist</a></span> <span class="id">sel</span> <span class="id">Hi</span> <span class="id">sc</span> <span class="id">Hi</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">Hi</span> <span class="id">x</span> <span class="id">vs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.In">FEnv.In</a></span> <span class="id">x</span> <span class="id">Hi</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when">when</a></span> <span class="id">sel</span> <span class="id">vs</span> <span class="id">sc</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv">fwhenv</a></span> <span class="id">sel</span> <span class="id">vs</span> <span class="id">sc</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof220')">Proof.</span></div>
<div class="proofscript" id="proof220">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwhen</span> <span class="id">Hvar</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hin</span>. <span class="tactic">eapply</span> <span class="id">Hwhen</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;<span class="id">Hf</span>&amp;<span class="id">Hv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var_det">sem_var_det</a></span> <span class="kwd">in</span> <span class="id">Hvar</span>; [|<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>; <span class="tactic">reflexivity</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hvar</span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hf</span>':=<span class="id">Hf</span>). <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when_fwhen">when_fwhen</a></span> <span class="kwd">in</span> <span class="id">Hf</span>'. <span class="tactic">rewrite</span> &lt;-<span class="id">Hf</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_when_inv">sem_var_when_inv</a></span> {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">r</span> (<span class="id">Hi</span> <span class="id">Hi</span>' : @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>) <span class="id">x</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when_hist">when_hist</a></span> <span class="id">k</span> <span class="id">Hi</span> <span class="id">r</span> <span class="id">Hi</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">Hi</span>' <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">v</span>', <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">Hi</span> <span class="id">x</span> <span class="id">v</span>' /\ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when">when</a></span> <span class="id">k</span> <span class="id">v</span>' <span class="id">r</span> <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof221')">Proof.</span></div>
<div class="proofscript" id="proof221">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hf</span> <span class="id">Hvar</span>. <span class="id">inv</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hf</span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (?&amp;<span class="id">Hwhen</span>&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>. 2:<span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_fwhen_inv">sem_var_fwhen_inv</a></span> {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">sc</span> (<span class="id">H</span>: @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>) <span class="id">x</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_hist">fwhen_hist</a></span> <span class="id">k</span> <span class="id">H</span> <span class="id">sc</span>) <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">v</span>', <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">H</span> <span class="id">x</span> <span class="id">v</span>' /\ <span class="id">v</span> ≡ (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv">fwhenv</a></span> <span class="id">k</span> <span class="id">v</span>' <span class="id">sc</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof222')">Proof.</span></div>
<div class="proofscript" id="proof222">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvar</span>. <span class="id">inv</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.refines_fwhen">refines_fwhen</a></span> {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">sc</span> (<span class="id">H</span> <span class="id">H</span>': @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H</span> ⊑ <span class="id">H</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_hist">fwhen_hist</a></span> <span class="id">e</span> <span class="id">H</span> <span class="id">sc</span>) ⊑ (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_hist">fwhen_hist</a></span> <span class="id">e</span> <span class="id">H</span>' <span class="id">sc</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof223')">Proof.</span></div>
<div class="proofscript" id="proof223">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Href</span> ?? <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Href</span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> (?&amp;<span class="id">Heq</span>&amp;<span class="id">Hfind</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfind</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.when_absent">when_absent</a></span> <span class="id">e</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when">when</a></span> <span class="id">e</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof224')">Proof.</span></div>
<div class="proofscript" id="proof224">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>)), (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>)); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.when_hist_absent">when_hist_absent</a></span> {<span class="id">K</span>} <span class="id">e</span> <span class="id">sc</span> : <span class="kwd">forall</span> (<span class="id">Hi</span> <span class="id">Hi</span>': @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when_hist">when_hist</a></span> <span class="id">e</span> <span class="id">Hi</span> <span class="id">sc</span> <span class="id">Hi</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when_hist">when_hist</a></span> <span class="id">e</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">Hi</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">Hi</span>').<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof225')">Proof.</span></div>
<div class="proofscript" id="proof225">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwhen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?? <span class="id">Hfind</span>. <span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hwhen</span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> (?&amp;<span class="id">Hf</span>&amp;<span class="id">Hfind</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>. 2:<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when_absent">when_absent</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.fwhen_absent">fwhen_absent</a></span> {<span class="id">A</span>} (<span class="id">absent</span>: <span class="id">A</span>) : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">sc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen">fwhen</a></span> <span class="id">absent</span> <span class="id">k</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id">absent</span>) <span class="id">sc</span> ≡ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id">absent</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof226')">Proof.</span></div>
<div class="proofscript" id="proof226">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_nth">fwhen_nth</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.fwhen_hist_absent">fwhen_hist_absent</a></span> {<span class="id">K</span>}: <span class="kwd">forall</span> <span class="id">k</span> <span class="id">sc</span> (<span class="id">H</span>: @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_hist">fwhen_hist</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">H</span>) <span class="id">sc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">H</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof227')">Proof.</span></div>
<div class="proofscript" id="proof227">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">x</span>. <span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">x</span>); <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_absent">fwhen_absent</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id">fwhen_hist_absent</span>' {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">sc</span> (<span class="id">H</span>: @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> (@<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> <span class="id"><a href="Velus.CoindStreams.html#Op.value">value</a></span>)) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_hist">fwhen_hist</a></span> <span class="id">k</span> <span class="id">H</span> <span class="id">sc</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">H</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof228')">Proof.</span></div>
<div class="proofscript" id="proof228">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">x</span>. <span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">x</span>); <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.fwhenb_absent">fwhenb_absent</a></span>: <span class="kwd">forall</span> <span class="id">k</span> <span class="id">sc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenb">fwhenb</a></span> <span class="id">k</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">sc</span> ≡ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof229')">Proof.</span></div>
<div class="proofscript" id="proof229">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenb_nth">fwhenb_nth</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.fwhenb_both_slower">fwhenb_both_slower</a></span> : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">sc</span> <span class="id">bs</span> <span class="id">bs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower">slower</a></span> <span class="id">sc</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower">slower</a></span> <span class="id">sc</span> <span class="id">bs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenb">fwhenb</a></span> <span class="id">k</span> <span class="id">bs</span> <span class="id">sc</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenb">fwhenb</a></span> <span class="id">k</span> <span class="id">bs</span>' <span class="id">sc</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof230')">Proof.</span></div>
<div class="proofscript" id="proof230">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hslow1</span> <span class="id">Hslow2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower_nth">slower_nth</a></span> <span class="kwd">in</span> <span class="id">Hslow1</span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower_nth">slower_nth</a></span> <span class="kwd">in</span> <span class="id">Hslow2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenb_nth">fwhenb_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hslow1</span> <span class="id">n</span>). <span class="tactic">specialize</span> (<span class="id">Hslow2</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">sc</span> # <span class="id">n</span>) <span class="id">eqn</span>:<span class="id">Hsc</span>; <span class="tactic">setoid_rewrite</span> <span class="id">Hsc</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">bs</span> # <span class="id">n</span>), (<span class="id">bs</span>' # <span class="id">n</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">specialize</span> (<span class="id">Hslow2</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">specialize</span> (<span class="id">Hslow1</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> select and fselect, combining when and mask </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.stres_st">stres_st</a></span> (<span class="id">stres</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>))) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#map">Streams.map</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">e</span>) | <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> <span class="kwd">end</span>) <span class="id">stres</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.stres_res">stres_res</a></span> (<span class="id">stres</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>))) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#map">Streams.map</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id">_</span>, <span class="id">b</span>) =&gt; <span class="id">b</span> | <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="kwd">end</span>) <span class="id">stres</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">CoInductive</span> <span class="id">select</span>' (<span class="id">sel</span> : <span class="id"><a href="Velus.CoindStreams.html#Op.enumtag">enumtag</a></span>) (<span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>)) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.svalue">svalue</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.select_abs">select_abs</a></span> : <span class="kwd">forall</span> <span class="id">k</span>' <span class="id">stres</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">select</span>' <span class="id">sel</span> <span class="id">k</span> <span class="id">k</span>' <span class="id">stres</span> <span class="id">xs</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">select</span>' <span class="id">sel</span> <span class="id">k</span> <span class="id">k</span>' (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">stres</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">xs</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">ys</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.select_nsel">select_nsel</a></span> : <span class="kwd">forall</span> <span class="id">k</span>' <span class="id">v</span> <span class="id">r</span> <span class="id">stres</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">select</span>' <span class="id">sel</span> <span class="id">k</span> <span class="id">k</span>' <span class="id">stres</span> <span class="id">xs</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">v</span> &lt;&gt; <span class="id">sel</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">select</span>' <span class="id">sel</span> <span class="id">k</span> <span class="id">k</span>' (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id">v</span>, <span class="id">r</span>) ⋅ <span class="id">stres</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">x</span> ⋅ <span class="id">xs</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> ⋅ <span class="id">ys</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.select_nreset">select_nreset</a></span> : <span class="kwd">forall</span> <span class="id">k</span>' <span class="id">stres</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">select</span>' <span class="id">sel</span> <span class="id">k</span> <span class="id">k</span>' <span class="id">stres</span> <span class="id">xs</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">select</span>' <span class="id">sel</span> <span class="id">k</span> <span class="id">k</span>' (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id">sel</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) ⋅ <span class="id">stres</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">x</span> ⋅ <span class="id">xs</span>) ((<span class="kwd">if</span> <span class="id">k</span>' =? <span class="id">k</span> <span class="kwd">then</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">x</span> <span class="kwd">else</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) ⋅ <span class="id">ys</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="COINDSTREAMS.select_reset">select_reset</a></span> : <span class="kwd">forall</span> <span class="id">k</span>' <span class="id">stres</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">select</span>' <span class="id">sel</span> <span class="id">k</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>') <span class="id">stres</span> <span class="id">xs</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">select</span>' <span class="id">sel</span> <span class="id">k</span> <span class="id">k</span>' (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id">sel</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) ⋅ <span class="id">stres</span>) (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">x</span> ⋅ <span class="id">xs</span>) ((<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>' =? <span class="id">k</span> <span class="kwd">then</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">x</span> <span class="kwd">else</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) ⋅ <span class="id">ys</span>).<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.select">select</a></span> <span class="id">sel</span> <span class="id">k</span> := <span class="id">select</span>' <span class="id">sel</span> <span class="id">k</span> 0.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.select_hist">select_hist</a></span> {<span class="id">K</span>} <span class="id">sel</span> <span class="id">k</span> <span class="id">stres</span> (<span class="id">Hi</span> <span class="id">Hi</span>': @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (<span class="kwd">fun</span> <span class="id">vs</span>' <span class="id">vs</span> =&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select">select</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">vs</span> <span class="id">vs</span>') <span class="id">Hi</span>' <span class="id">Hi</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.fselect">fselect</a></span> {<span class="id">A</span>} (<span class="id">absent</span> : <span class="id">A</span>) (<span class="id">e</span> : <span class="id"><a href="Velus.CoindStreams.html#Op.enumtag">enumtag</a></span>) (<span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">stres</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>))) (<span class="id">xs</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id">A</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span> <span class="id">absent</span> <span class="id">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenb">fwhenb</a></span> <span class="id">e</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_res">stres_res</a></span> <span class="id">stres</span>) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_st">stres_st</a></span> <span class="id">stres</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen">fwhen</a></span> <span class="id">absent</span> <span class="id">e</span> <span class="id">xs</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_st">stres_st</a></span> <span class="id">stres</span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.fselectb">fselectb</a></span> := <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect">fselect</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.fselectv">fselectv</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">xs</span> := <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect">fselect</a></span> (@<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> <span class="id"><a href="Velus.CoindStreams.html#Op.value">value</a></span>) <span class="id">e</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">xs</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.fselect_hist">fselect_hist</a></span> {<span class="id">K</span>} <span class="id">e</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">H</span> := @<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> <span class="id">K</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectv">fselectv</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">stres</span>) <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect_hist">fselect_hist</a></span> : <span class="id">fenv</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_st">stres_st</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">stres_st_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof231')">Proof.</span></div>
<div class="proofscript" id="proof231">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Heq</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_st">stres_st</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> 2 <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="tactic">rewrite</span> <span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_res">stres_res</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">stres_res_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof232')">Proof.</span></div>
<div class="proofscript" id="proof232">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Heq</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_res">stres_res</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> 2 <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="tactic">rewrite</span> <span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.select_mask_when">select_mask_when</a></span> <span class="id">sel</span> <span class="id">k</span> : <span class="kwd">forall</span> <span class="id">stres</span> <span class="id">xs</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select">select</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">xs</span> <span class="id">zs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="tactic">exists</span> <span class="id">ys</span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when">when</a></span> <span class="id">sel</span> <span class="id">xs</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_st">stres_st</a></span> <span class="id">stres</span>) <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">zs</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv">maskv</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenb">fwhenb</a></span> <span class="id">sel</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_res">stres_res</a></span> <span class="id">stres</span>) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_st">stres_st</a></span> <span class="id">stres</span>)) <span class="id">ys</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof233')">Proof.</span></div>
<div class="proofscript" id="proof233">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> * <span class="id">Hsel</span>. <span class="tactic">exists</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv">fwhenv</a></span> <span class="id">sel</span> <span class="id">xs</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_st">stres_st</a></span> <span class="id">stres</span>)). <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">revert</span> <span class="id">Hsel</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select">select</a></span>. <span class="tactic">generalize</span> 0 <span class="kwd">as</span> <span class="id">k</span>'. <span class="id">revert</span> <span class="id">stres</span> <span class="id">xs</span> <span class="id">zs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="tactic">intros</span> [] [] [] * <span class="id">Hsel</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hsel</span>; <span class="tactic">clear</span> <span class="id">Hsel</span>; <span class="tactic">subst</span> <span class="id">k</span>'0 <span class="id">s</span> <span class="id">s0</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">s3</span> <span class="id">s4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_st">stres_st</a></span>; <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv">fwhenv</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#map_Cons">map_Cons</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_Cons">fwhen_Cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">replace</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">v</span>) ==<span class="id">b</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">sel</span>)) <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">destruct</span> (<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">inv</span> <span class="id">Heq</span>. <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span>. <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span>. <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">revert</span> <span class="id">Hsel</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select">select</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv">maskv</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span>. <span class="tactic">generalize</span> 0 <span class="kwd">as</span> <span class="id">k</span>'. <span class="id">revert</span> <span class="id">stres</span> <span class="id">xs</span> <span class="id">zs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="tactic">intros</span> [] [] [] * <span class="id">Hsel</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hsel</span>; <span class="tactic">clear</span> <span class="id">Hsel</span>; <span class="tactic">subst</span> <span class="id">k</span>'0 <span class="id">s</span> <span class="id">s0</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">s3</span> <span class="id">s4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_st">stres_st</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_res">stres_res</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenb">fwhenb</a></span>; <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenb">fwhenb</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv">fwhenv</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#map_Cons">map_Cons</a></span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_Cons">fwhen_Cons</a></span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">mask</span>'<span class="id">_Cons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">replace</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">v</span>) ==<span class="id">b</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.CoindStreams.html#Op.Venum">Venum</a></span> <span class="id">sel</span>)) <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">destruct</span> (<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">inv</span> <span class="id">Heq</span>. <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span>. <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span>. <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> (<span class="id">ys</span>&amp;<span class="id">Hwhen</span>&amp;<span class="id">Hmask</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hwhen</span> <span class="id">Hmask</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv">maskv</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask">mask</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select">select</a></span>. <span class="tactic">generalize</span> 0 <span class="kwd">as</span> <span class="id">k</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">stres</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="tactic">intros</span> [] [] [] [] * <span class="id">Hwhen</span> <span class="id">Hmask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#map_Cons">map_Cons</a></span> <span class="kwd">in</span> <span class="id">Hwhen</span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#map_Cons">map_Cons</a></span> <span class="kwd">in</span> <span class="id">Hmask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hmask</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hwhen</span>; <span class="tactic">clear</span> <span class="id">Hwhen</span>; <span class="tactic">subst</span> <span class="id">cs</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">s3</span> <span class="id">s4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">s</span> <span class="kwd">as</span> [|(?&amp;?)]; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">s</span> <span class="kwd">as</span> [|(?&amp;?)]; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">take</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Heq</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">inv</span> <span class="id">Heq</span>. <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">s</span> <span class="kwd">as</span> [|(?&amp;?)]; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">take</span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="tactic">inversion</span> <span class="id">it</span>; <span class="tactic">subst</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">simpl</span>; <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">e</span> <span class="id">k</span> : (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select">select</a></span> <span class="id">e</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">select_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof234')">Proof.</span></div>
<div class="proofscript" id="proof234">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Heq1</span> * <span class="id">Heq2</span> * <span class="id">Heq3</span> <span class="id">Hsel</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select_mask_when">select_mask_when</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hsel</span> <span class="kwd">as</span> (?&amp;?&amp;?). <span class="tactic">do</span> 2 <span class="id">esplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;-<span class="id">Heq2</span>, &lt;-<span class="id">Heq1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;-<span class="id">Heq3</span>, &lt;-<span class="id">Heq1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> {<span class="id">K</span>} <span class="id">sel</span> <span class="id">k</span> : (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select_hist">select_hist</a></span> <span class="id">K</span> <span class="id">sel</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) ==&gt; <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">select_hist_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof235')">Proof.</span></div>
<div class="proofscript" id="proof235">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Heq1</span> * <span class="id">Heq2</span> * <span class="id">Heq3</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select_hist">select_hist</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?? <span class="id">Hfind</span>. <span class="tactic">specialize</span> (<span class="id">Heq3</span> <span class="id">x2</span>). <span class="tactic">rewrite</span> <span class="id">Hfind</span> <span class="kwd">in</span> <span class="id">Heq3</span>. <span class="id">inv</span> <span class="id">Heq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id">Hf</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;<span class="id">Hwhen</span>&amp;<span class="id">Hfind</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Heq2</span> <span class="id">x2</span>). <span class="tactic">rewrite</span> <span class="id">Hfind</span>' <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="id">inv</span> <span class="id">Heq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Heq1</span>, &lt;-<span class="id">H2</span>, &lt;-<span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> {<span class="id">A</span>} (<span class="id">abs</span> : <span class="id">A</span>) <span class="id">e</span> <span class="id">k</span> : (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect">fselect</a></span> <span class="id">abs</span> <span class="id">e</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">fselect_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof236')">Proof.</span></div>
<div class="proofscript" id="proof236">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Heq1</span> * <span class="id">Heq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect">fselect</a></span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Heq1</span>, <span class="id">Heq2</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">e</span> <span class="id">k</span> : (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectb">fselectb</a></span> <span class="id">e</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">fselectb_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof237')">Proof.</span></div>
<div class="proofscript" id="proof237">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * ? * ?. <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect_EqSt">fselect_EqSt</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">e</span> <span class="id">k</span> : (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectv">fselectv</a></span> <span class="id">e</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">fselectv_morph</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof238')">Proof.</span></div>
<div class="proofscript" id="proof238">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * ? * ?. <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect_EqSt">fselect_EqSt</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> {<span class="id">K</span>} <span class="id">e</span> <span class="id">k</span> : (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect_hist">fselect_hist</a></span> <span class="id">K</span> <span class="id">e</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) ==&gt; <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">fselect_hist_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof239')">Proof.</span></div>
<div class="proofscript" id="proof239">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">r</span> <span class="id">r</span>' <span class="id">Er</span> <span class="id">H</span> <span class="id">H</span>' <span class="id">EH</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">EH</span> <span class="id">x</span>). <span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">EH</span>; <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>, <span class="id">Er</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_fselect">ac_fselect</a></span> : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectv">fselectv</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> <span class="id">xs</span>) ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectb">fselectb</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">xs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof240')">Proof.</span></div>
<div class="proofscript" id="proof240">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectv">fselectv</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectb">fselectb</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect">fselect</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.ac_mask">ac_mask</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.ac_fwhen">ac_fwhen</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.select_fselect">select_fselect</a></span> <span class="id">sel</span> <span class="id">k</span> : <span class="kwd">forall</span> <span class="id">es</span> <span class="id">vs</span> <span class="id">vs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select">select</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">es</span> <span class="id">vs</span> <span class="id">vs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vs</span>' ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectv">fselectv</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">es</span> <span class="id">vs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof241')">Proof.</span></div>
<div class="proofscript" id="proof241">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hsel</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select_mask_when">select_mask_when</a></span> <span class="kwd">in</span> <span class="id">Hsel</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfil</span>&amp;<span class="id">Hmask</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when_fwhen">when_fwhen</a></span> <span class="kwd">in</span> <span class="id">Hfil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hmask</span>, <span class="id">Hfil</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_fselect">sem_var_fselect</a></span> {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">k</span> <span class="id">r</span> (<span class="id">H</span>: @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>) <span class="id">x</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">H</span> <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect_hist">fselect_hist</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) <span class="id">x</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectv">fselectv</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof242')">Proof.</span></div>
<div class="proofscript" id="proof242">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvar</span>. <span class="id">inv</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect_hist">fselect_hist</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_select">sem_var_select</a></span> {<span class="id">K</span>} <span class="id">x</span> : <span class="kwd">forall</span> <span class="id">sel</span> <span class="id">k</span> <span class="id">sc</span> (<span class="id">Hi</span> <span class="id">Hi</span>': @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>) <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select_hist">select_hist</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">sc</span> <span class="id">Hi</span> <span class="id">Hi</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">Hi</span> <span class="id">x</span> <span class="id">vs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.In">FEnv.In</a></span> <span class="id">x</span> <span class="id">Hi</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select">select</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">sc</span> <span class="id">vs</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectv">fselectv</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">sc</span> <span class="id">vs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof243')">Proof.</span></div>
<div class="proofscript" id="proof243">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hselect</span> <span class="id">Hvar</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hin</span>. <span class="tactic">eapply</span> <span class="id">Hselect</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;<span class="id">Hf</span>&amp;<span class="id">Hv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var_det">sem_var_det</a></span> <span class="kwd">in</span> <span class="id">Hvar</span>; [|<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>; <span class="tactic">reflexivity</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hvar</span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hf</span>':=<span class="id">Hf</span>). <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select_fselect">select_fselect</a></span> <span class="kwd">in</span> <span class="id">Hf</span>'. <span class="tactic">rewrite</span> &lt;-<span class="id">Hf</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_select_inv">sem_var_select_inv</a></span> {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">sel</span> <span class="id">k</span> <span class="id">r</span> (<span class="id">Hi</span> <span class="id">Hi</span>': @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>) <span class="id">x</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select_hist">select_hist</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">r</span> <span class="id">Hi</span> <span class="id">Hi</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">Hi</span>' <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">v</span>', <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">Hi</span> <span class="id">x</span> <span class="id">v</span>' /\ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select">select</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>' <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof244')">Proof.</span></div>
<div class="proofscript" id="proof244">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hf</span> <span class="id">Hvar</span>. <span class="id">inv</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hf</span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (?&amp;<span class="id">Hwhen</span>&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>. 2:<span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.sem_var_fselect_inv">sem_var_fselect_inv</a></span> {<span class="id">K</span>}: <span class="kwd">forall</span> <span class="id">sel</span> <span class="id">k</span> <span class="id">r</span> (<span class="id">H</span>: @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>) <span class="id">x</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect_hist">fselect_hist</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">v</span>', <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">H</span> <span class="id">x</span> <span class="id">v</span>' /\ <span class="id">v</span> ≡ (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectv">fselectv</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>').<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof245')">Proof.</span></div>
<div class="proofscript" id="proof245">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvar</span>. <span class="id">inv</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>. <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.fselectv_selectv">fselectv_selectv</a></span> <span class="id">sel</span> <span class="id">k</span> : <span class="kwd">forall</span> <span class="id">es</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">vs</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select">select</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">es</span> <span class="id">vs</span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectv">fselectv</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">es</span> <span class="id">vs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof246')">Proof.</span></div>
<div class="proofscript" id="proof246">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hac</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select_mask_when">select_mask_when</a></span>. <span class="tactic">do</span> 2 <span class="id">esplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv_whenv">fwhenv_whenv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_st">stres_st</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">es</span> # <span class="id">n</span>) <span class="kwd">as</span> [|(?&amp;?)]; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hac</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.ac_nth">ac_nth</a></span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="tactic">destruct</span> (<span class="id">es</span> # <span class="id">n</span>) <span class="kwd">as</span> [|(?&amp;?)]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectv">fselectv</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect">fselect</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenv">fwhenv</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.select_hist_fselect_hist">select_hist_fselect_hist</a></span> {<span class="id">K</span>} <span class="id">sel</span> <span class="id">k</span> <span class="id">es</span> : <span class="kwd">forall</span> (<span class="id">Hi</span> <span class="id">Hi</span>': @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select_hist">select_hist</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">es</span> <span class="id">Hi</span> <span class="id">Hi</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hi</span>' ⊑ (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect_hist">fselect_hist</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">es</span> <span class="id">Hi</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof247')">Proof.</span></div>
<div class="proofscript" id="proof247">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hselect</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?? <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hselect</span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> (?&amp;<span class="id">Hf</span>&amp;<span class="id">Hfind</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select_fselect">select_fselect</a></span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect_hist">fselect_hist</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.select_hist_restrict_ac">select_hist_restrict_ac</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">es</span> : <span class="kwd">forall</span> <span class="id">Hi</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">vs</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">List.In</a></span> <span class="id">x</span> <span class="id">xs</span> -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.sem_var">sem_var</a></span> <span class="id">Hi</span> <span class="id">x</span> <span class="id">vs</span> -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">vs</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select_hist">select_hist</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">es</span> <span class="id">Hi</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict">FEnv.restrict</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect_hist">fselect_hist</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">es</span> <span class="id">Hi</span>) <span class="id">xs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof248')">Proof.</span></div>
<div class="proofscript" id="proof248">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?? <span class="id">Hfind</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_find_inv">FEnv.restrict_find_inv</a></span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> (<span class="id">Hin</span>&amp;<span class="id">Hfind</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectv_selectv">fselectv_selectv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hac</span>; <span class="tactic">eauto</span>. <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.stres_st_ac">stres_st_ac</a></span> : <span class="kwd">forall</span> <span class="id">stres</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_st">stres_st</a></span> <span class="id">stres</span>) ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">stres</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof249')">Proof.</span></div>
<div class="proofscript" id="proof249">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_st">stres_st</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.ac_nth">ac_nth</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">stres</span> # <span class="id">n</span>) <span class="kwd">as</span> [|(?&amp;?)]; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.ac_select">ac_select</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">k</span> <span class="id">cs</span> <span class="id">xs</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select">select</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">cs</span> <span class="id">xs</span> <span class="id">rs</span> -&gt; <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">cs</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.abstract_clock">abstract_clock</a></span> <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof250')">Proof.</span></div>
<div class="proofscript" id="proof250">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hsel</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select_mask_when">select_mask_when</a></span> <span class="kwd">in</span> <span class="id">Hsel</span> <span class="kwd">as</span> (?&amp;<span class="id">Hwhen</span>&amp;<span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.ac_when">ac_when</a></span> <span class="kwd">in</span> <span class="id">Hwhen</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Hwhen</span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_st_ac">stres_st_ac</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.stres_st_absent">stres_st_absent</a></span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_st">stres_st</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) ≡ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof251')">Proof.</span></div>
<div class="proofscript" id="proof251">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_nth">const_nth</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="COINDSTREAMS.stres_res_absent">stres_res_absent</a></span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_res">stres_res</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) ≡ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof252')">Proof.</span></div>
<div class="proofscript" id="proof252">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">setoid_rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_nth">const_nth</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.select_absent">select_absent</a></span> <span class="id">e</span> <span class="id">k</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select">select</a></span> <span class="id">e</span> <span class="id">k</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof253')">Proof.</span></div>
<div class="proofscript" id="proof253">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select_mask_when">select_mask_when</a></span>. <span class="tactic">do</span> 2 <span class="id">esplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_st_absent">stres_st_absent</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.when_absent">when_absent</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_st_absent">stres_st_absent</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.stres_res_absent">stres_res_absent</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.maskv">maskv</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_nth">mask_nth</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_nth">const_nth</a></span>. <span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.select_hist_absent">select_hist_absent</a></span> {<span class="id">K</span>} <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> : <span class="kwd">forall</span> (<span class="id">Hi</span> <span class="id">Hi</span>': @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select_hist">select_hist</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> <span class="id">Hi</span> <span class="id">Hi</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select_hist">select_hist</a></span> <span class="id">e</span> <span class="id">k</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">Hi</span>) (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">Hi</span>').<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof254')">Proof.</span></div>
<div class="proofscript" id="proof254">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hselect</span> ?? <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hselect</span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> (?&amp;<span class="id">Hf</span>&amp;<span class="id">Hfind</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>. 2:<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.select_absent">select_absent</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.fselect_absent">fselect_absent</a></span> {<span class="id">A</span>} (<span class="id">absent</span>: <span class="id">A</span>) : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect">fselect</a></span> <span class="id">absent</span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id">absent</span>) ≡ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id">absent</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof255')">Proof.</span></div>
<div class="proofscript" id="proof255">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *. <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect">fselect</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_nth">mask_nth</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhen_nth">fwhen_nth</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_nth">const_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>. <span class="tactic">destruct</span> (<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.fselect_hist_absent">fselect_hist_absent</a></span> {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> (<span class="id">H</span>: @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect_hist">fselect_hist</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">H</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">H</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof256')">Proof.</span></div>
<div class="proofscript" id="proof256">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">x</span>. <span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">x</span>); <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect_absent">fselect_absent</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id">fselect_hist_absent</span>' {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> (<span class="id">H</span>: @<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.history">history</a></span> <span class="id">K</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> (@<span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span> <span class="id"><a href="Velus.CoindStreams.html#Op.value">value</a></span>)) (<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect_hist">fselect_hist</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> <span class="id">H</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map">FEnv.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">x</span>. <span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">x</span>); <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="COINDSTREAMS.fselectb_absent">fselectb_absent</a></span>: <span class="kwd">forall</span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectb">fselectb</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) ≡ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof257')">Proof.</span></div>
<div class="proofscript" id="proof257">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *. <span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectb">fselectb</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect_absent">fselect_absent</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.fselectb_both_slower">fselectb_both_slower</a></span> : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> <span class="id">bs</span> <span class="id">bs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower">slower</a></span> <span class="id">sc</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower">slower</a></span> <span class="id">sc</span> <span class="id">bs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectb">fselectb</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> <span class="id">bs</span> ≡ <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectb">fselectb</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> <span class="id">bs</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof258')">Proof.</span></div>
<div class="proofscript" id="proof258">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hslow1</span> <span class="id">Hslow2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselectb">fselectb</a></span>, <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fselect">fselect</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.mask_morph">mask_morph</a></span>; [<span class="tactic">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.fwhenb_both_slower">fwhenb_both_slower</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">apply</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower_nth">slower_nth</a></span>; <span class="tactic">intros</span> <span class="id">n</span> <span class="id">Hbs</span>; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower_nth">slower_nth</a></span> <span class="kwd">in</span> <span class="id">Hslow1</span>. <span class="tactic">specialize</span> (<span class="id">Hslow1</span> <span class="id">_</span> <span class="id">Hbs</span>). <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Hslow1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.slower_nth">slower_nth</a></span> <span class="kwd">in</span> <span class="id">Hslow2</span>. <span class="tactic">specialize</span> (<span class="id">Hslow2</span> <span class="id">_</span> <span class="id">Hbs</span>). <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Hslow2</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> Additional definitions for state machines </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="COINDSTREAMS.const_stres">const_stres</a></span> {<span class="id">A</span>} (<span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">v</span> : <span class="id">A</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#map">Streams.map</a></span> (<span class="kwd">fun</span> (<span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) =&gt; <span class="kwd">if</span> <span class="id">b</span> <span class="kwd">then</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span> <span class="kwd">else</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.absent">absent</a></span>) <span class="id">b</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> {<span class="id">A</span>} : (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_stres">const_stres</a></span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">const_stres_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof259')">Proof.</span></div>
<div class="proofscript" id="proof259">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Heq</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.const_stres">const_stres</a></span>. <span class="tactic">rewrite</span> 2 <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>, <span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">CoFixpoint</span> <span class="id"><a name="COINDSTREAMS.first_of">first_of</a></span> {<span class="id">A</span>} (<span class="id">v</span> : <span class="id">A</span>) (<span class="id">bs</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">ys</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> <span class="id">A</span>)) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.CoindStreams.html#OpAux.synchronous">synchronous</a></span> <span class="id">A</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">bs</span>, <span class="id">ys</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> ⋅ <span class="id">bs</span>, <span class="id">_</span> ⋅ <span class="id">ys</span> =&gt; <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span> ⋅ <span class="id">first_of</span> <span class="id">v</span> <span class="id">bs</span> <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> ⋅ <span class="id">bs</span>, <span class="id">y</span> ⋅ <span class="id">ys</span> =&gt; <span class="id">y</span> ⋅ <span class="id">first_of</span> <span class="id">v</span> <span class="id">bs</span> <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="COINDSTREAMS.first_of_nth">first_of_nth</a></span> {<span class="id">A</span>} <span class="id">n</span> : <span class="kwd">forall</span> (<span class="id">v</span> : <span class="id">A</span>) <span class="id">bs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.first_of">first_of</a></span> <span class="id">v</span> <span class="id">bs</span> <span class="id">ys</span>) # <span class="id">n</span> = <span class="kwd">if</span> <span class="id">bs</span> # <span class="id">n</span> <span class="kwd">then</span> <span class="id"><a href="Velus.CoindStreams.html#OpAux.present">present</a></span> <span class="id">v</span> <span class="kwd">else</span> <span class="id">ys</span> # <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof260')">Proof.</span></div>
<div class="proofscript" id="proof260">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> ? (?&amp;?) (?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0">Str_nth_0</a></span>, <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S">Str_nth_S</a></span>, <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> {<span class="id">A</span>} : (@<span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.first_of">first_of</a></span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">first_of_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof261')">Proof.</span></div>
<div class="proofscript" id="proof261">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Heq1</span> * <span class="id">Heq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Heq1</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Heq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS.first_of_nth">first_of_nth</a></span>. <span class="tactic">rewrite</span> <span class="id">Heq1</span>, <span class="id">Heq2</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS">COINDSTREAMS</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="CoindStreamsFun">CoindStreamsFun</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Ids</span> : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Op</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.CoindStreams.html#Ids">Ids</a></span> <span class="id"><a href="Velus.CoindStreams.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Clocks</span> : <span class="id"><a href="Velus.Clocks.html#CLOCKS">CLOCKS</a></span> <span class="id"><a href="Velus.CoindStreams.html#Ids">Ids</a></span> <span class="id"><a href="Velus.CoindStreams.html#Op">Op</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux">OpAux</a></span>)<br/>
&lt;: <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS">COINDSTREAMS</a></span> <span class="id"><a href="Velus.CoindStreams.html#Ids">Ids</a></span> <span class="id"><a href="Velus.CoindStreams.html#Op">Op</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.CoindStreams.html#Clocks">Clocks</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Include</span> <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS">COINDSTREAMS</a></span> <span class="id"><a href="Velus.CoindStreams.html#Ids">Ids</a></span> <span class="id"><a href="Velus.CoindStreams.html#Op">Op</a></span> <span class="id"><a href="Velus.CoindStreams.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.CoindStreams.html#Clocks">Clocks</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.CoindStreams.html#CoindStreamsFun">CoindStreamsFun</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
