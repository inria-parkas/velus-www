
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Correctness</title>
<meta name="description" content="Documentation of Coq module Correctness" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Correctness</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.FunctionalEnvironment.html">FunctionalEnvironment</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Operators.html">Operators</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Clocks.html">Clocks</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.StaticEnv.html">Lustre.StaticEnv</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.LSyntax.html">Lustre.LSyntax</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.CoreExpr.CESyntax.html">CoreExpr.CESyntax</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.NLustre.NLSyntax.html">NLustre.NLSyntax</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Transcription.Tr.html">Transcription.Tr</a></span> <span class="id"><a href="Velus.Transcription.TrOrdered.html">Transcription.TrOrdered</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.LTyping.html">Lustre.LTyping</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.LClocking.html">Lustre.LClocking</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.LOrdered.html">Lustre.LOrdered</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.LSemantics.html">Lustre.LSemantics</a></span> <span class="id"><a href="Velus.Lustre.LClockedSemantics.html">Lustre.LClockedSemantics</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.Normalization.Normalization.html">Lustre.Normalization.Normalization</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.Normalization.Correctness.html">Lustre.Normalization.Correctness</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.NLustre.NLOrdered.html">NLustre.NLOrdered</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.NLustre.NLCoindSemantics.html">NLustre.NLCoindSemantics</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.CoindStreams.html">CoindStreams</a></span> <span class="id"><a href="Velus.IndexedStreams.html">IndexedStreams</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.CoindToIndexed.html">CoindToIndexed</a></span> <span class="id"><a href="Velus.IndexedToCoind.html">IndexedToCoind</a></span> <span class="id"><a href="Velus.CoindIndexed.html">CoindIndexed</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.CoreExpr.CESemantics.html">CoreExpr.CESemantics</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.CoreExpr.CEInterpreter.html">CoreExpr.CEInterpreter</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.NLustre.NLIndexedSemantics.html">NLustre.NLIndexedSemantics</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.NLustre.NLCoindToIndexed.html">NLCoindToIndexed</a></span> <span class="id"><a href="Velus.NLustre.NLIndexedToCoind.html">NLIndexedToCoind</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#ListNotations">List.ListNotations</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html">Permutation</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Setoids.Setoid.html">Setoid</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span>.<br/>
<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list</span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html">common.Errors</a></span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">error_monad_scope</span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html">Classes.EquivDec</a></span>.<br/>
<br/>
<div class="doc">Used in lemma count_ex_dec </div>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html">Classical_Prop</a></span>.<br/>
<br/>
<h1> Semantics Preservation Proof for Transcription </h1>
<br/>
<span class="kwd">Module</span> <span class="kwd">Type</span> <span class="id"><a name="CORRECTNESS">CORRECTNESS</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ids</span>  : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Op</span>   : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">OpAux</span>: <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span>    <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Cks</span>  : <span class="id"><a href="Velus.Clocks.html#CLOCKS">CLOCKS</a></span>           <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Senv</span> : <span class="id"><a href="Velus.Lustre.StaticEnv.html#STATICENV">STATICENV</a></span>        <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">L</span>           : <span class="id"><a href="Velus.Lustre.LSyntax.html#LSYNTAX">LSYNTAX</a></span>          <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">CE</span>   : <span class="id"><a href="Velus.CoreExpr.CESyntax.html#CESYNTAX">CESYNTAX</a></span>         <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NL</span>          : <span class="id"><a href="Velus.NLustre.NLSyntax.html#NLSYNTAX">NLSYNTAX</a></span>         <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span>        <span class="id"><a href="Velus.Transcription.Correctness.html#CE">CE</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">TR</span>   : <span class="id"><a href="Velus.Transcription.Tr.html#TR">TR</a></span>               <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span>      <span class="id"><a href="Velus.Transcription.Correctness.html#CE">CE</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#NL">NL</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LT</span>          : <span class="id"><a href="Velus.Lustre.LTyping.html#LTYPING">LTYPING</a></span>          <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LC</span>          : <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING">LCLOCKING</a></span>        <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Ord</span>         : <span class="id"><a href="Velus.NLustre.NLOrdered.html#NLORDERED">NLORDERED</a></span>        <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span>        <span class="id"><a href="Velus.Transcription.Correctness.html#CE">CE</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#NL">NL</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Lord</span>        : <span class="id"><a href="Velus.Lustre.LOrdered.html#LORDERED">LORDERED</a></span>         <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Str</span>  : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS">COINDSTREAMS</a></span>     <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LS</span>          : <span class="id"><a href="Velus.Lustre.LSemantics.html#LSEMANTICS">LSEMANTICS</a></span>       <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Lord">Lord</a></span>       <span class="id"><a href="Velus.Transcription.Correctness.html#Str">Str</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">LCS</span>  : <span class="id"><a href="Velus.Lustre.LClockedSemantics.html#LCLOCKEDSEMANTICS">LCLOCKEDSEMANTICS</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LC">LC</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str">Str</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS">LS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LN</span>          : <span class="id"><a href="Velus.Lustre.Normalization.Normalization.html#NORMALIZATION">NORMALIZATION</a></span>    <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NLSC</span>        : <span class="id"><a href="Velus.NLustre.NLCoindSemantics.html#NLCOINDSEMANTICS">NLCOINDSEMANTICS</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span>        <span class="id"><a href="Velus.Transcription.Correctness.html#CE">CE</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#NL">NL</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str">Str</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ord">Ord</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_lexp_step">sem_lexp_step</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#L.global">L.global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">e</span>' <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_lexp">to_lexp</a></span> <span class="id">e</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">e</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.history_tl">history_tl</a></span> <span class="id">H</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">b</span>) <span class="id">e</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">_</span>) <span class="id">s</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">einduction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#L.exp_ind2">L.exp_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Htr</span> <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hsem</span>; <span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hsem</span>. <span class="tactic">destruct</span> <span class="id">a</span>. <span class="id">monadInv</span> <span class="id">H1</span>. <span class="id">inv</span> <span class="id">H7</span>; <span class="tactic">destruct</span> <span class="id">xs</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>. <span class="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.env_maps_tl">env_maps_tl</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hsem</span>. <span class="tactic">destruct</span> <span class="id">a</span>. <span class="id">monadInv</span> <span class="id">H1</span>. <span class="tactic">destruct</span> <span class="id">s0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHe0</span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H10</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hsem</span>. <span class="tactic">destruct</span> <span class="id">a</span>. <span class="id">monadInv</span> <span class="id">H1</span>. <span class="tactic">destruct</span> <span class="id">s1</span>, <span class="id">s2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHe0_1</span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">IHe0_2</span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H13</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">cases</span>; <span class="id">monadInv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">inv</span> <span class="id">H9</span>; <span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_step">sem_var_step</a></span>. <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span> ?? <span class="id">_</span> <span class="id">_</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_cexp_step">sem_cexp_step</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#L.global">L.global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">e</span>' <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_cexp">to_cexp</a></span> <span class="id">e</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">e</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.history_tl">history_tl</a></span> <span class="id">H</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">b</span>) <span class="id">e</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">_</span>) <span class="id">s</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">einduction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#L.exp_ind2">L.exp_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Htr</span> <span class="id">Hsem</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">now</span> <span class="id">inv</span> <span class="id">Htr</span>) || (<span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_cexp">to_cexp</a></span> <span class="kwd">in</span> <span class="id">Htr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="id">monadInv</span> <span class="id">Htr</span>; <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_lexp_step">sem_lexp_step</a></span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;merge&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span> <span class="kwd">as</span> ([|? [|]]&amp;?); <span class="id">monadInv</span> <span class="id">Htr</span>; <span class="tactic">fold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_cexp">to_cexp</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>. <span class="tactic">destruct</span> <span class="id">s0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.Smerge">LCS.Smerge</a></span> <span class="kwd">with</span> (<span class="id">vs</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">vs</span>) =&gt; (<span class="id">i</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">vs</span>))) <span class="id">vs</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_step">sem_var_step</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">clear</span> - <span class="id">EQ</span> <span class="id">H0</span> <span class="id">H9</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.Forall2Brs_map_2">LS.Forall2Brs_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.Forall2Brs_impl_In">LS.Forall2Brs_impl_In</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span> ?? <span class="id">Hin</span> <span class="id">Hse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_exists">Exists_exists</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (?&amp;<span class="id">Hin1</span>&amp;<span class="id">Hin2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#mmap_inversion">mmap_inversion</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Coqlib.html#list_forall2_in_left">Coqlib.list_forall2_in_left</a></span> <span class="kwd">in</span> <span class="id">EQ</span> <span class="kwd">as</span> ((?&amp;?)&amp;?&amp;<span class="id">Htr</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases</span>. <span class="id">monadInv</span> <span class="id">Htr</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">destruct</span> <span class="id">Hin2</span> <span class="kwd">as</span> [|[]]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span> ?? <span class="id">_</span> <span class="id">_</span> <span class="id">Hmerge</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hmerge</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span> <span class="kwd">as</span> ([|? [|]]&amp;?); <span class="id">cases</span>; <span class="id">monadInv</span> <span class="id">Htr</span>; <span class="tactic">fold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_cexp">to_cexp</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">Hsem</span>. <span class="tactic">destruct</span> <span class="id">s0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.ScaseDefault">LCS.ScaseDefault</a></span> <span class="kwd">with</span> (<span class="id">vs</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">vs</span>) =&gt; (<span class="id">i</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">vs</span>))) <span class="id">vs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vd</span>:=(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">x</span>)) <span class="id">vd</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_lexp_step">sem_lexp_step</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">H10</span>; <span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">H5</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.Forall2Brs_map_2">LS.Forall2Brs_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.Forall2Brs_impl_In">LS.Forall2Brs_impl_In</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span> ?? <span class="id">Hin</span> <span class="id">Hse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_exists">Exists_exists</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (?&amp;<span class="id">Hin1</span>&amp;<span class="id">Hin2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#mmap_inversion">mmap_inversion</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Coqlib.html#list_forall2_in_left">Coqlib.list_forall2_in_left</a></span> <span class="kwd">in</span> <span class="id">EQ1</span> <span class="kwd">as</span> ((?&amp;?)&amp;?&amp;<span class="id">Htr</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases</span>. <span class="id">monadInv</span> <span class="id">Htr</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">destruct</span> <span class="id">Hin2</span> <span class="kwd">as</span> [|[]]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H13</span>; <span class="id">inv</span> <span class="id">H6</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_map_1">Forall3_map_1</a></span>, &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#concat_map">concat_map</a></span>, 2 <span class="id"><a href="Velus.Common.CommonList.html#Forall3_map_2">Forall3_map_2</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall3_map_3">Forall3_map_3</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_map_2">Forall3_map_2</a></span> <span class="kwd">in</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_impl_In">Forall3_impl_In</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span> ??? <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hcase</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hcase</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">Hsem</span>. <span class="tactic">destruct</span> <span class="id">s0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.ScaseTotal">LCS.ScaseTotal</a></span> <span class="kwd">with</span> (<span class="id">vs</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">vs</span>) =&gt; (<span class="id">i</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">vs</span>))) <span class="id">vs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_lexp_step">sem_lexp_step</a></span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.Forall2Brs_map_2">LS.Forall2Brs_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.Forall2Brs_impl_In">LS.Forall2Brs_impl_In</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span> ?? <span class="id">Hin</span> <span class="id">Hse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_exists">Exists_exists</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (?&amp;<span class="id">Hin1</span>&amp;<span class="id">Hin2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#mmap_inversion">mmap_inversion</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Coqlib.html#list_forall2_in_left">Coqlib.list_forall2_in_left</a></span> <span class="kwd">in</span> <span class="id">EQ1</span> <span class="kwd">as</span> ((?&amp;?)&amp;?&amp;<span class="id">Htr</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases</span>. <span class="id">monadInv</span> <span class="id">Htr</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">destruct</span> <span class="id">Hin2</span> <span class="kwd">as</span> [|[]]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_map_1">Forall3_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall3_map_2">Forall3_map_2</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall3_map_3">Forall3_map_3</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_map_2">Forall3_map_2</a></span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_impl_In">Forall3_impl_In</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span> ??? <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hcase</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hcase</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.ty_lexp">ty_lexp</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#L.global">L.global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">env</span> <span class="id">e</span> <span class="id">e</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LT.wt_exp">LT.wt_exp</a></span> <span class="id">G</span> <span class="id">env</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_lexp">to_lexp</a></span> <span class="id">e</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">e</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#L.typeof">L.typeof</a></span> <span class="id">e</span> = [<span class="id"><a href="Velus.Transcription.Correctness.html#CE.typeof">CE.typeof</a></span> <span class="id">e</span>'].<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#L.exp_ind2">L.exp_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Hwt</span> <span class="id">Htr</span>; <span class="id">inv</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">a</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">a</span>. <span class="tactic">simpl</span>. <span class="id">monadInv</span> <span class="id">H0</span>. <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">a</span>. <span class="id">monadInv</span> <span class="id">H0</span>. <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">cases</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">Hwt</span>. <span class="id">inv</span> <span class="id">H10</span>. <span class="id">inv</span> <span class="id">H5</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">monadInv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#L.typesof">L.typesof</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_exp_lexp">sem_exp_lexp</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">G</span> : @<span class="id"><a href="Velus.Transcription.Correctness.html#L.global">L.global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">env</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">e</span>' <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LT.wt_exp">LT.wt_exp</a></span> <span class="id">G</span> <span class="id">env</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_lexp">to_lexp</a></span> <span class="id">e</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">e</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> [<span class="id">s</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_exp">NLSC.sem_exp</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> <span class="id">H</span>) <span class="id">b</span> <span class="id">e</span>' <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#L.exp_ind2">L.exp_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Hwt</span> <span class="id">Htr</span> <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">now</span> <span class="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">now</span> <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">a</span>. <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_history">LS.sem_var_history</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">a</span>. <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">monadInv</span> <span class="id">H1</span>. <span class="id">inv</span> <span class="id">Hwt</span>. <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.ty_lexp">ty_lexp</a></span> <span class="kwd">in</span> <span class="id">EQ</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">EQ</span>. <span class="id">now</span> <span class="id">inv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">a</span>. <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">monadInv</span> <span class="id">H1</span>. <span class="id">inv</span> <span class="id">Hwt</span>. <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.ty_lexp">ty_lexp</a></span> <span class="kwd">in</span> <span class="id">EQ</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.ty_lexp">ty_lexp</a></span> <span class="kwd">in</span> <span class="id">EQ1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H11</span> <span class="kwd">in</span> <span class="id">EQ</span>. <span class="id">inv</span> <span class="id">EQ</span>. <span class="tactic">rewrite</span> <span class="id">H12</span> <span class="kwd">in</span> <span class="id">EQ1</span>. <span class="id">now</span> <span class="id">inv</span> <span class="id">EQ1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">cases</span>. <span class="id">monadInv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">clear</span> <span class="id">H4</span>. <span class="id">inv</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_history">LS.sem_var_history</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_lexp_single">sem_lexp_single</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">e</span>' <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> <span class="id">ss</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_lexp">to_lexp</a></span> <span class="id">e</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">e</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#L.global">L.global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">ss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">s</span>, <span class="id">ss</span> = [<span class="id">s</span>].<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#L.exp_ind2">L.exp_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Htr</span> <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">Htr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="id">inv</span> <span class="id">Hsem</span>; <span class="tactic">eexists</span>; <span class="id">now</span> <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">H2</span>. <span class="tactic">subst</span>. <span class="id">monadInv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">inv</span> <span class="id">H9</span>. <span class="id">inv</span> <span class="id">H5</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">EQ</span>; [|<span class="tactic">eauto</span>]. <span class="id">inv</span> <span class="id">EQ</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">inv</span> <span class="id">H11</span>. <span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_exps_lexps">sem_exps_lexps</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#L.global">L.global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">H</span> <span class="id">b</span> <span class="id">tenv</span> <span class="id">es</span> <span class="id">les</span> <span class="id">ss</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_lexp">to_lexp</a></span> <span class="id">es</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">les</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LT.wt_exp">LT.wt_exp</a></span> <span class="id">G</span> <span class="id">tenv</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span>) <span class="id">es</span> <span class="id">ss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_exp">NLSC.sem_exp</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> <span class="id">H</span>) <span class="id">b</span>) <span class="id">les</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">ss</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hmmap</span> <span class="id">Hwt</span> <span class="id">Hsem</span>. <span class="id">revert</span> <span class="tactic">dependent</span> <span class="id">les</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hsem</span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">Hmmap</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.mmap_cons">mmap_cons</a></span> <span class="kwd">in</span> <span class="id">Hmmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmmap</span> <span class="kwd">as</span> [ <span class="id">x</span>' [<span class="id">le</span>' [<span class="id">Hle</span> [<span class="id">Htolexp</span>  <span class="id">Hmmap</span>]]]]. <span class="id">inv</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHHsem</span> <span class="kwd">in</span> <span class="id">Hmmap</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Htolexp</span>' := <span class="id">Htolexp</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_lexp_single">sem_lexp_single</a></span> <span class="kwd">in</span> <span class="id">Htolexp</span>'; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">Htolexp</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_exp_lexp">sem_exp_lexp</a></span> <span class="kwd">in</span> <span class="id">Htolexp</span>; <span class="tactic">eauto</span>. <span class="id">now</span> <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_exp_controls">sem_exp_controls</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#L.global">L.global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">env0</span> : <span class="kwd">forall</span> <span class="id">H</span> <span class="id">b</span> <span class="id">es</span> <span class="id">es</span>' <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">forall</span> <span class="id">e</span>' <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LT.wt_exp">LT.wt_exp</a></span> <span class="id">G</span> <span class="id">env0</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_cexp">to_cexp</a></span> <span class="id">e</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">e</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> [<span class="id">s</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_cexp">NLSC.sem_cexp</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> <span class="id">H</span>) <span class="id">b</span> <span class="id">e</span>' <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>)) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LT.wt_exp">LT.wt_exp</a></span> <span class="id">G</span> <span class="id">env0</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>)) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LS.Forall2Brs">LS.Forall2Brs</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span>) <span class="id">es</span> [<span class="id">vs</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#mmap">mmap</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">pat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">pat</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id">i</span>, []) =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">control</span> <span class="id">expression</span> <span class="id">not</span> <span class="id">normalized</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id">i</span>, [<span class="id">e</span>]) =&gt; <span class="tactic">do</span> <span class="id">ce</span> &lt;- <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_cexp">to_cexp</a></span> <span class="id">e</span>; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> (<span class="id">i</span>, <span class="id">ce</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id">i</span>, <span class="id">e</span> :: <span class="id">_</span> :: <span class="id">_</span>) =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> "<span class="id">control</span> <span class="id">expression</span> <span class="id">not</span> <span class="id">normalized</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) <span class="id">es</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">es</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_cexp">NLSC.sem_cexp</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> <span class="id">H</span>) <span class="id">b</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>') (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">vs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">es</span>; <span class="tactic">intros</span> * <span class="id">Hf</span> <span class="id">Hwt</span> <span class="id">Hsem</span> <span class="id">Hmmap</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hf</span>; <span class="id">inv</span> <span class="id">Hwt</span>; <span class="id">inv</span> <span class="id">Hsem</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">monadInv</span> <span class="id">Hmmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">subst</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">cases</span>. <span class="id">monadInv</span> <span class="id">EQ</span>. <span class="id">inv</span> <span class="id">H6</span>; <span class="id">inv</span> <span class="id">H11</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H9</span>; <span class="id">inv</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHes</span> <span class="kwd">in</span> <span class="id">H3</span>. 2,3,4:<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.merge_Permutation">merge_Permutation</a></span> : <span class="kwd">forall</span> <span class="id">c</span> <span class="id">vs</span> <span class="id">vs</span>' <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">vs</span> <span class="id">vs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.merge">merge</a></span> <span class="id">c</span> <span class="id">vs</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.merge">merge</a></span> <span class="id">c</span> <span class="id">vs</span>' <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hperm</span> <span class="id">Hmerge</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.merge_spec">merge_spec</a></span> <span class="kwd">in</span> *. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hmerge</span> <span class="id">n</span>) <span class="kwd">as</span> [(<span class="id">Hc</span>&amp;<span class="id">Hf</span>&amp;<span class="id">Hs</span>)|(?&amp;?&amp;<span class="id">Hc</span>&amp;<span class="id">Hpres</span>&amp;<span class="id">Habs</span>&amp;<span class="id">Hs</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">left</span>. <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;-<span class="id">Hperm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">now</span> <span class="tactic">rewrite</span> &lt;-<span class="id">Hperm</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.case_Permutation">case_Permutation</a></span> : <span class="kwd">forall</span> <span class="id">c</span> <span class="id">vs</span> <span class="id">vs</span>' <span class="id">vd</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">vs</span> <span class="id">vs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> <span class="id">c</span> <span class="id">vs</span> <span class="id">vd</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> <span class="id">c</span> <span class="id">vs</span>' <span class="id">vd</span> <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hperm</span> <span class="id">Hcase</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.case_spec">case_spec</a></span> <span class="kwd">in</span> *. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hcase</span> <span class="id">n</span>) <span class="kwd">as</span> [(<span class="id">Hc</span>&amp;<span class="id">Hf</span>&amp;<span class="id">Hd</span>&amp;<span class="id">Hs</span>)|[(?&amp;?&amp;<span class="id">Hc</span>&amp;<span class="id">Habs</span>&amp;<span class="id">Hpres</span>&amp;<span class="id">Hd</span>&amp;<span class="id">Hs</span>)|(?&amp;?&amp;<span class="id">Hc</span>&amp;<span class="id">Habs</span>&amp;<span class="id">Hneq</span>&amp;<span class="id">Hd</span>&amp;<span class="id">Hs</span>)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">left</span>. <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;-<span class="id">Hperm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>; <span class="tactic">left</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">now</span> <span class="tactic">rewrite</span> &lt;-<span class="id">Hperm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>; <span class="tactic">right</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">now</span> <span class="tactic">rewrite</span> &lt;-<span class="id">Hperm</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.case_complete">case_complete</a></span> : <span class="kwd">forall</span> <span class="id">tx</span> <span class="id">tn</span> <span class="id">c</span> <span class="id">vs</span> <span class="id">vs</span>' <span class="id">vd</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.wt_streams">wt_streams</a></span> [<span class="id">c</span>] [<span class="id"><a href="Velus.Transcription.Correctness.html#Op.Tenum">Tenum</a></span> <span class="id">tx</span> <span class="id">tn</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">vs</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">tn</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span> <span class="id">v</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">i</span>, <span class="id">v</span>) <span class="id">vs</span>' &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">i</span>, <span class="id">v</span>) <span class="id">vs</span> \/ (<span class="id">i</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">vs</span>' /\ ~<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">i</span> <span class="id">vs</span> /\ <span class="id">v</span> = <span class="id">vd</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> <span class="id">c</span> <span class="id">vs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vd</span>) <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> <span class="id">c</span> <span class="id">vs</span>' <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwt</span> <span class="id">Hfst</span> <span class="id">Heq</span> <span class="id">Hcase</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">vs</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">tn</span>) <span class="kwd">as</span> <span class="id">Hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id">Hfst</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_length">seq_length</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.case_spec">case_spec</a></span> <span class="kwd">in</span> *. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hcase</span> <span class="id">n</span>) <span class="kwd">as</span> [(<span class="id">Hc</span>&amp;<span class="id">Hf</span>&amp;<span class="id">Hd</span>&amp;<span class="id">Hs</span>)|[(?&amp;?&amp;<span class="id">Hc</span>&amp;<span class="id">Habs</span>&amp;<span class="id">Hpres</span>&amp;<span class="id">Hd</span>&amp;<span class="id">Hs</span>)|(?&amp;?&amp;<span class="id">Hc</span>&amp;<span class="id">Habs</span>&amp;<span class="id">Hneq</span>&amp;<span class="id">Hd</span>&amp;<span class="id">Hs</span>)]]; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">left</span>. <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="tactic">intros</span> (?&amp;?) <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|(?&amp;<span class="id">Hnin</span>&amp;?)]; <span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hf</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>; <span class="tactic">left</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="tactic">intros</span> (?&amp;?) <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|(?&amp;<span class="id">Hnin</span>&amp;?)]; <span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Habs</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_exists">Exists_exists</a></span> <span class="kwd">in</span> <span class="id">Hpres</span> <span class="kwd">as</span> ((?&amp;?)&amp;<span class="id">Hin</span>&amp;?&amp;<span class="id">Hpres</span>); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_exists">Exists_exists</a></span>. <span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">Heq</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>; <span class="tactic">left</span>. <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="tactic">intros</span> (?&amp;?) <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|(?&amp;<span class="id">Hnin</span>&amp;?)]; <span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Habs</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_singl">Forall2_singl</a></span>, <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span> <span class="kwd">in</span> <span class="id">Hwt</span>. <span class="tactic">rewrite</span> <span class="id">Hc</span> <span class="kwd">in</span> <span class="id">Hwt</span>; <span class="id">inv</span> <span class="id">Hwt</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hnth</span>:=<span class="id">H1</span>). <span class="tactic">rewrite</span> &lt;-<span class="id">Hlen</span> <span class="kwd">in</span> <span class="id">Hnth</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_In">nth_In</a></span> <span class="kwd">with</span> (<span class="id">d</span>:=(0, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#const">Streams.const</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux.absent">absent</a></span>)) <span class="kwd">in</span> <span class="id">Hnth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#combine_fst_snd">combine_fst_snd</a></span> <span class="kwd">in</span> <span class="id">Hnth</span> <span class="tactic">at</span> 1. <span class="tactic">rewrite</span> <span class="id">Hfst</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine_nth">combine_nth</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_nth">seq_nth</a></span> <span class="kwd">in</span> <span class="id">Hnth</span>; <span class="tactic">auto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_length">seq_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_exists">Exists_exists</a></span>. <span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">Hnth</span> <span class="kwd">as</span> [<span class="id">Hin</span>|(?&amp;<span class="id">Hnin</span>&amp;?)]; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hneq</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.Forall2_Permutation_1_fst">Forall2_Permutation_1_fst</a></span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span>} : <span class="kwd">forall</span> (<span class="id">P</span> : (<span class="id">A</span> * <span class="id">B</span>) -&gt; (<span class="id">A</span> * <span class="id">C</span>) -&gt; <span class="kwd">Prop</span>) <span class="id">l1</span> <span class="id">l1</span>' <span class="id">l2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">l1</span> <span class="id">l1</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">P</span> <span class="id">l1</span> <span class="id">l2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">l1</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">l2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">l2</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">l2</span> <span class="id">l2</span>' /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">P</span> <span class="id">l1</span>' <span class="id">l2</span>' /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">l1</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">l2</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">P</span> <span class="id">l1</span> <span class="id">l1</span>' <span class="id">l2</span> <span class="id">Hperm</span> <span class="id">Hf</span> <span class="id">Heq</span>. <span class="id">revert</span> <span class="id">l2</span> <span class="id">Hf</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hperm</span>; <span class="tactic">intros</span> <span class="id">l2</span> <span class="id">Hf</span> <span class="id">Heq</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hf</span>. <span class="tactic">exists</span> []; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hf</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHHperm</span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> (<span class="id">l2</span>'&amp;<span class="id">Hperm</span>'&amp;<span class="id">Hf</span>'&amp;<span class="id">Heq</span>'); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id">y</span>::<span class="id">l2</span>'). <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hf</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id">y1</span>::<span class="id">y0</span>::<span class="id">l</span>'0). <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHHperm1</span> <span class="kwd">in</span> <span class="id">Hf</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">Hf</span> <span class="kwd">as</span> (<span class="id">l2</span>'&amp;<span class="id">Hperm</span>'&amp;<span class="id">Hf</span>'&amp;<span class="id">Heq</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHHperm2</span> <span class="kwd">in</span> <span class="id">Hf</span>'; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">Hf</span>' <span class="kwd">as</span> (<span class="id">l2</span>''&amp;<span class="id">Hperm</span>''&amp;<span class="id">Hf</span>''&amp;<span class="id">Heq</span>'').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">l2</span>''. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">etransitivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">Simpler than an existential : build the list explicitely </div>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="CORRECTNESS.complete_sem">complete_sem</a></span> (<span class="id">s</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op.enumtag">enumtag</a></span>) (<span class="id">brs</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux.svalue">svalue</a></span>)) (<span class="id">d</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux.svalue">svalue</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux.svalue">svalue</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">s</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id">brs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">k</span>::<span class="id">s</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">brs</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; (<span class="id">k</span>, <span class="id">d</span>)::(<span class="id">complete_sem</span> <span class="id">s</span> <span class="id">brs</span> <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id">tag</span>, <span class="id">e</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#tl">tl</a></span> =&gt; <span class="kwd">if</span> (<span class="id">tag</span> =? <span class="id">k</span>) <span class="kwd">then</span> (<span class="id">tag</span>, <span class="id">e</span>)::(<span class="id">complete_sem</span> <span class="id">s</span> <span class="id">tl</span> <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> (<span class="id">k</span>, <span class="id">d</span>)::(<span class="id">complete_sem</span> <span class="id">s</span> <span class="id">brs</span> <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.complete_sem_fst">complete_sem_fst</a></span> : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">es</span> <span class="id">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Sorted.html#StronglySorted">Sorted.StronglySorted</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le">le</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">es</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 <span class="id">n</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.complete_sem">complete_sem</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 <span class="id">n</span>) <span class="id">es</span> <span class="id">d</span>) = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 <span class="id">n</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">generalize</span> 0 <span class="kwd">as</span> <span class="id">start</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> * <span class="id">Hnd</span> <span class="id">Hsort</span> <span class="id">Hincl</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#incl_nil">incl_nil</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_eq_nil">map_eq_nil</a></span> <span class="kwd">in</span> <span class="id">Hincl</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">es</span> <span class="kwd">as</span> [|(?&amp;?)]; <span class="id">inv</span> <span class="id">Hnd</span>; <span class="id">inv</span> <span class="id">Hsort</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">f_equal</span>; <span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id">incl_nil</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Sorted.html#StronglySorted">Sorted.StronglySorted</a></span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">n0</span> =? <span class="id">start</span>) <span class="id">eqn</span>:<span class="id">Hn</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span> <span class="kwd">in</span> <span class="id">Hn</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">incl_cons</span>' <span class="kwd">in</span> <span class="id">Hincl</span> <span class="kwd">as</span> (?&amp;<span class="id">Hincl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hin</span>. <span class="tactic">assert</span> (<span class="id">Hin</span>':=<span class="id">Hin</span>). <span class="tactic">apply</span> <span class="id">Hincl</span> <span class="kwd">in</span> <span class="id">Hin</span>'; <span class="id">inv</span> <span class="id">Hin</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id">H1</span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq">Nat.eqb_neq</a></span> <span class="kwd">in</span> <span class="id">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">simpl</span>. 1,2:<span class="tactic">constructor</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">incl_cons</span>' <span class="kwd">in</span> <span class="id">Hincl</span> <span class="kwd">as</span> (?&amp;<span class="id">Hincl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl_cons">incl_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">intros</span> ? <span class="id">Hin</span>. <span class="tactic">assert</span> (<span class="id">Hin</span>':=<span class="id">Hin</span>). <span class="tactic">apply</span> <span class="id">Hincl</span> <span class="kwd">in</span> <span class="id">Hin</span>'; <span class="id">inv</span> <span class="id">Hin</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">Hle1</span>&amp;<span class="id">Hle2</span>). <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="CORRECTNESS.complete_sem_length">complete_sem_length</a></span> : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">ys</span> <span class="id">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Sorted.html#StronglySorted">Sorted.StronglySorted</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le">le</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ys</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ys</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 <span class="id">n</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.complete_sem">complete_sem</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 <span class="id">n</span>) <span class="id">ys</span> <span class="id">d</span>) = <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnd</span> <span class="id">Hs</span> <span class="id">Hincl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.complete_sem_fst">complete_sem_fst</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_length">seq_length</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.complete_branches_sem">complete_branches_sem</a></span> <span class="id">H</span> <span class="id">b</span> : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">es</span> <span class="id">d</span> <span class="id">ys</span> <span class="id">vd</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ys</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">e</span> <span class="id">y</span> =&gt; <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_cexp">NLSC.sem_cexp</a></span> <span class="id">H</span> <span class="id">b</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">e</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">y</span>)) <span class="id">es</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_cexp">NLSC.sem_cexp</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">d</span> <span class="id">vd</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">oe</span> =&gt; <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_cexp">NLSC.sem_cexp</a></span> <span class="id">H</span> <span class="id">b</span> (<span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span> <span class="id">d</span> <span class="id">oe</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#TR.complete_branches">complete_branches</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 <span class="id">n</span>) <span class="id">es</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.complete_sem">complete_sem</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 <span class="id">n</span>) <span class="id">ys</span> <span class="id">vd</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">generalize</span> 0 <span class="kwd">as</span> <span class="id">start</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> * <span class="id">Hfst</span> <span class="id">Hses</span> <span class="id">Hsd</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span> (?&amp;?) ? <span class="id">_</span> <span class="id">_</span> ?; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hses</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">x</span>, <span class="id">y</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">Hfst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">e</span> =? <span class="id">start</span>); <span class="tactic">simpl</span>; <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.complete_sem_In">complete_sem_In</a></span> : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">ys</span> <span class="id">d</span> <span class="id">i</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Sorted.html#StronglySorted">Sorted.StronglySorted</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le">le</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ys</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ys</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 <span class="id">n</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">i</span>, <span class="id">v</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.complete_sem">complete_sem</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 <span class="id">n</span>) <span class="id">ys</span> <span class="id">d</span>) &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">i</span>, <span class="id">v</span>) <span class="id">ys</span> \/ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">i</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 <span class="id">n</span>) /\ ~<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">i</span> <span class="id">ys</span> /\ <span class="id">v</span> = <span class="id">d</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">generalize</span> 0 <span class="kwd">as</span> <span class="id">start</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> * <span class="id">Hnd</span> <span class="id">Hsorted</span> <span class="id">Hincl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">split</span>; [<span class="tactic">intros</span> <span class="id">Hin</span>|<span class="tactic">intros</span> [<span class="id">Hin</span>|(<span class="id">Hlt</span>&amp;<span class="id">Hnin</span>&amp;<span class="id">Heq</span>)]]); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">ys</span> <span class="kwd">as</span> [|(?&amp;?)]; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Heq</span>|<span class="id">Hin</span>]. <span class="id">inv</span> <span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHn</span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id">incl_nil</span>'. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">n0</span> =? <span class="id">start</span>) <span class="id">eqn</span>:<span class="id">Heq</span>; <span class="tactic">simpl</span>; <span class="id">inv</span> <span class="id">Hin</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hnd</span>; <span class="id">inv</span> <span class="id">Hsorted</span>. <span class="tactic">eapply</span> <span class="id">IHn</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> [?|(?&amp;?&amp;?)]; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">right</span>. <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#and_not_or">and_not_or</a></span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">contra</span>; <span class="tactic">subst</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">eapply</span> <span class="id">incl_cons</span>' <span class="kwd">in</span> <span class="id">Hincl</span> <span class="kwd">as</span> (?&amp;<span class="id">Hincl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hin</span>. <span class="tactic">assert</span> (<span class="id">Hin</span>':=<span class="id">Hin</span>). <span class="tactic">eapply</span> <span class="id">Hincl</span> <span class="kwd">in</span> <span class="id">Hin</span>'; <span class="id">inv</span> <span class="id">Hin</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">apply</span> <span class="id">H2</span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq">Nat.eqb_neq</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">incl_cons</span>' <span class="kwd">in</span> <span class="id">Hincl</span> <span class="kwd">as</span> (<span class="id">Hincl1</span>&amp;<span class="id">Hincl2</span>). <span class="id">inv</span> <span class="id">Hincl1</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">right</span>. <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#and_not_or">and_not_or</a></span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">contra</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> <span class="id">contra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsorted</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq">Nat.eqb_neq</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">incl_cons</span>' <span class="kwd">in</span> <span class="id">Hincl</span> <span class="kwd">as</span> (<span class="id">Hincl1</span>&amp;<span class="id">Hincl2</span>). <span class="id">inv</span> <span class="id">Hincl1</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHn</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> [?|(?&amp;?&amp;?)]; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? [|<span class="id">Hin</span>]; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hin</span>':=<span class="id">Hin</span>). <span class="tactic">eapply</span> <span class="id">Hincl2</span> <span class="kwd">in</span> <span class="id">Hin</span>'; <span class="id">inv</span> <span class="id">Hin</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="id">inv</span> <span class="id">Hnd</span>; <span class="id">inv</span> <span class="id">Hsorted</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">ys</span> <span class="kwd">as</span> [|(?&amp;?)]; [<span class="id">inv</span> <span class="id">Hin</span>|]; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">n0</span> =? <span class="id">start</span>) <span class="id">eqn</span>:<span class="id">Heq</span>; <span class="tactic">simpl</span>; <span class="id">inv</span> <span class="id">Hin</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="tactic">subst</span>. <span class="id">inv</span> <span class="id">Hnd</span>; <span class="id">inv</span> <span class="id">Hsorted</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>. <span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">incl_cons</span>' <span class="kwd">in</span> <span class="id">Hincl</span> <span class="kwd">as</span> (?&amp;<span class="id">Hincl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hin</span>. <span class="tactic">assert</span> (<span class="id">Hin</span>':=<span class="id">Hin</span>). <span class="tactic">eapply</span> <span class="id">Hincl</span> <span class="kwd">in</span> <span class="id">Hin</span>'; <span class="id">inv</span> <span class="id">Hin</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">apply</span> <span class="id">H2</span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq">Nat.eqb_neq</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>. <span class="tactic">right</span>. <span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">incl_cons</span>' <span class="kwd">in</span> <span class="id">Hincl</span> <span class="kwd">as</span> (<span class="id">Hincl1</span>&amp;<span class="id">Hincl2</span>). <span class="id">inv</span> <span class="id">Hincl1</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? [|<span class="id">Hin</span>]; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hin</span>':=<span class="id">Hin</span>). <span class="tactic">eapply</span> <span class="id">Hincl2</span> <span class="kwd">in</span> <span class="id">Hin</span>'; <span class="id">inv</span> <span class="id">Hin</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="id">inv</span> <span class="id">Hnd</span>; <span class="id">inv</span> <span class="id">Hsorted</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq">Nat.eqb_neq</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>. <span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">incl_cons</span>' <span class="kwd">in</span> <span class="id">Hincl</span> <span class="kwd">as</span> (<span class="id">Hincl1</span>&amp;<span class="id">Hincl2</span>). <span class="id">inv</span> <span class="id">Hincl1</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? [|<span class="id">Hin</span>]; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hin</span>':=<span class="id">Hin</span>). <span class="tactic">eapply</span> <span class="id">Hincl2</span> <span class="kwd">in</span> <span class="id">Hin</span>'; <span class="id">inv</span> <span class="id">Hin</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="id">inv</span> <span class="id">Hnd</span>; <span class="id">inv</span> <span class="id">Hsorted</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">ys</span> <span class="kwd">as</span> [|(?&amp;?)]; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">Hlt</span> <span class="kwd">as</span> [|<span class="id">Hseq</span>]; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>. <span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id">incl_nil</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#not_or_and">not_or_and</a></span> <span class="kwd">in</span> <span class="id">Hnin</span> <span class="kwd">as</span> (<span class="id">Hn1</span>&amp;<span class="id">Hn2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">n0</span> =? <span class="id">start</span>) <span class="id">eqn</span>:<span class="id">Heq</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hlt</span> <span class="kwd">as</span> [|<span class="id">Hseq</span>]; <span class="tactic">subst</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>. <span class="id">inv</span> <span class="id">Hnd</span>. <span class="id">inv</span> <span class="id">Hsorted</span>. <span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">incl_cons</span>' <span class="kwd">in</span> <span class="id">Hincl</span> <span class="kwd">as</span> (?&amp;<span class="id">Hincl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hin</span>. <span class="tactic">assert</span> (<span class="id">Hin</span>':=<span class="id">Hin</span>). <span class="tactic">eapply</span> <span class="id">Hincl</span> <span class="kwd">in</span> <span class="id">Hin</span>'; <span class="id">inv</span> <span class="id">Hin</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">apply</span> <span class="id">H1</span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq">Nat.eqb_neq</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hlt</span> <span class="kwd">as</span> [|<span class="id">Hseq</span>]; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>. <span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id">incl_cons</span>' <span class="kwd">in</span> <span class="id">Hincl</span> <span class="kwd">as</span> (<span class="id">Hincl1</span>&amp;<span class="id">Hincl2</span>). <span class="id">inv</span> <span class="id">Hincl1</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? [|<span class="id">Hin</span>]; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hin</span>':=<span class="id">Hin</span>). <span class="tactic">eapply</span> <span class="id">Hincl2</span> <span class="kwd">in</span> <span class="id">Hin</span>'; <span class="id">inv</span> <span class="id">Hin</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="id">inv</span> <span class="id">Hnd</span>; <span class="id">inv</span> <span class="id">Hsorted</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">right</span>. <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#and_not_or">and_not_or</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_exp_cexp">sem_exp_cexp</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#L.global">L.global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">env</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">e</span>' <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LT.wt_exp">LT.wt_exp</a></span> <span class="id">G</span> <span class="id">env</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_cexp">to_cexp</a></span> <span class="id">e</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">e</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> [<span class="id">s</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_cexp">NLSC.sem_cexp</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> <span class="id">H</span>) <span class="id">b</span> <span class="id">e</span>' <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#L.exp_ind2">L.exp_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Hwt</span> <span class="id">Htr</span> <span class="id">Hsem</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">now</span> <span class="id">inv</span> <span class="id">Htr</span>) || (<span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_cexp">to_cexp</a></span> <span class="kwd">in</span> <span class="id">Htr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="id">monadInv</span> <span class="id">Htr</span>; <span class="tactic">econstructor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_exp_lexp">sem_exp_lexp</a></span>; <span class="tactic">eauto</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Eq">Eq</a></span>; <span class="id">monadInv</span> <span class="id">Htr</span>; <span class="tactic">fold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_cexp">to_cexp</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;merge&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">H10</span>; <span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_exp_controls">sem_exp_controls</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_controls_fst">to_controls_fst</a></span> <span class="kwd">in</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.Forall2Brs_fst">LS.Forall2Brs_fst</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.Forall2_Permutation_1_fst">Forall2_Permutation_1_fst</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">s</span>'&amp;<span class="id">Hperm</span>&amp;<span class="id">Hf</span>&amp;<span class="id">Heq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.BranchesSort.Permuted_sort">BranchesSort.Permuted_sort</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_history">LS.sem_var_history</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">s</span>'))) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">s</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">Hf</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">Heq</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, &lt;-<span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.Permutation_seq_eq">Permutation_seq_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#TR.BranchesSort.Permuted_sort">BranchesSort.Permuted_sort</a></span>, &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, 2 <span class="id">EQ</span>, <span class="id">H11</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_length">seq_length</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Sorted.html#Sorted_StronglySorted">Sorted.Sorted_StronglySorted</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Sorted_map">Sorted_map</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Sorted_impl">Sorted_impl</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#TR.BranchesSort.Sorted_sort">BranchesSort.Sorted_sort</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">intros</span> ?? <span class="id">Heqb</span>. <span class="id">lia</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.leb_le">Nat.leb_le</a></span> <span class="kwd">in</span> <span class="id">Heqb</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id"><a href="Velus.Common.CommonList.html#combine_fst_snd">combine_fst_snd</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.merge_Permutation">merge_Permutation</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case&nbsp;(default)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">inv</span> <span class="id">H13</span>; <span class="id">inv</span> <span class="id">H6</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_map_2">Forall3_map_2</a></span> <span class="kwd">in</span> <span class="id">H14</span>. <span class="id">inv</span> <span class="id">H14</span>; <span class="id">inv</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwt</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H20</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_exp_lexp">sem_exp_lexp</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_exp_controls">sem_exp_controls</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_controls_fst">to_controls_fst</a></span> <span class="kwd">in</span> <span class="id">EQ1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.Forall2Brs_fst">LS.Forall2Brs_fst</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.Forall2_Permutation_1_fst">Forall2_Permutation_1_fst</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">s</span>'&amp;<span class="id">Hperm</span>&amp;<span class="id">Hf</span>&amp;<span class="id">Heq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.BranchesSort.Permuted_sort">BranchesSort.Permuted_sort</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Eq5</span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id">Eq5</span> <span class="kwd">in</span> <span class="id">H13</span>; <span class="id">inv</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">s</span>') <span class="kwd">as</span> <span class="id">Hnd</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>, &lt;-<span class="id">Hperm</span>, <span class="id">H12</span>, &lt;-<span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Sorted.html#StronglySorted">Sorted.StronglySorted</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le">le</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">s</span>')) <span class="kwd">as</span> <span class="id">Hsorted</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> &lt;-<span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Sorted.html#Sorted_StronglySorted">Sorted.Sorted_StronglySorted</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Sorted_map">Sorted_map</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Sorted_impl">Sorted_impl</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#TR.BranchesSort.Sorted_sort">BranchesSort.Sorted_sort</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> ?????; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> ?? <span class="id">Hle</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.leb_le">Nat.leb_le</a></span> <span class="kwd">in</span> <span class="id">Hle</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">s</span>') (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">tn</span>))) <span class="kwd">as</span> <span class="id">Hincl</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> &lt;-<span class="id">Hperm</span>, <span class="id">H12</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.complete_branches_sem">complete_branches_sem</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.case_complete">case_complete</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.case_Permutation">case_Permutation</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;*&nbsp;rewrite&nbsp;combine_length,&nbsp;seq_length,&nbsp;Nat.min_id,&nbsp;map_length,&nbsp;complete_sem_length;&nbsp;eauto.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">combine_map_fst</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.complete_sem_length">complete_sem_length</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_length">seq_length</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> ??. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.complete_sem_length">complete_sem_length</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.complete_sem_fst">complete_sem_fst</a></span>, &lt;-<span class="id"><a href="Velus.Common.CommonList.html#combine_fst_snd">combine_fst_snd</a></span> <span class="tactic">at</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.complete_sem_In">complete_sem_In</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine_length">combine_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.complete_sem_length">complete_sem_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_length">seq_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.min_id">Nat.min_id</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> [|(<span class="id">Hlt</span>&amp;?&amp;?)]; <span class="tactic">subst</span>; <span class="tactic">auto</span>. 1,2:<span class="tactic">right</span>; <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">auto</span>. 1,2:<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case&nbsp;(total)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H12</span>; <span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_exp_lexp">sem_exp_lexp</a></span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_exp_controls">sem_exp_controls</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_controls_fst">to_controls_fst</a></span> <span class="kwd">in</span> <span class="id">EQ1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.Forall2Brs_fst">LS.Forall2Brs_fst</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.Forall2_Permutation_1_fst">Forall2_Permutation_1_fst</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">s</span>'&amp;<span class="id">Hperm</span>&amp;<span class="id">Hf</span>&amp;<span class="id">Heq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.BranchesSort.Permuted_sort">BranchesSort.Permuted_sort</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span> (?&amp;?) (?&amp;?) <span class="id">_</span> <span class="id">_</span> ?; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">s</span>'))) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">s</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">Hf</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">Heq</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, &lt;-<span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.Permutation_seq_eq">Permutation_seq_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#TR.BranchesSort.Permuted_sort">BranchesSort.Permuted_sort</a></span>, &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, 2 <span class="id">EQ1</span>, <span class="id">H12</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_length">seq_length</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Sorted.html#Sorted_StronglySorted">Sorted.Sorted_StronglySorted</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Sorted_map">Sorted_map</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Sorted_impl">Sorted_impl</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#TR.BranchesSort.Sorted_sort">BranchesSort.Sorted_sort</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">intros</span> ?? <span class="id">Heqb</span>. <span class="id">lia</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.leb_le">Nat.leb_le</a></span> <span class="kwd">in</span> <span class="id">Heqb</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id"><a href="Velus.Common.CommonList.html#combine_fst_snd">combine_fst_snd</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.case_Permutation">case_Permutation</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_lexp_step2">sem_lexp_step2</a></span>: <span class="kwd">forall</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">v</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_exp">NLSC.sem_exp</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> (<span class="id">v</span> ⋅ <span class="id">s</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_exp">NLSC.sem_exp</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.history_tl">history_tl</a></span> <span class="id">H</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">b</span>) <span class="id">e</span> <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span>; <span class="tactic">intros</span> * <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">unfold_St</span> <span class="id">b</span>. <span class="id">inv</span> <span class="id">H4</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">unfold_St</span> <span class="id">b</span>. <span class="id">inv</span> <span class="id">H6</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">econstructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_step_nl">sem_var_step_nl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">H9</span>; <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">all</span>:<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_step_nl">sem_var_step_nl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">H8</span>; <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">all</span>:<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_step_nl">sem_var_step_nl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">H10</span>; <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">all</span>:<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_step_nl">sem_var_step_nl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="id"><a name="CORRECTNESS.NCor">NCor</a></span> := <span class="id"><a href="Velus.Lustre.Normalization.Correctness.html#CorrectnessFun">CorrectnessFun</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str">Str</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LT">LT</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LC">LC</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS">LS</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS">LCS</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LN">LN</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.reset_or_not_reset">reset_or_not_reset</a></span> : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">m</span>, <span class="id">m</span> &lt;= <span class="id">n</span> -&gt; <span class="id">r</span> # <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">m</span>, <span class="id">m</span> &lt;= <span class="id">n</span> /\ <span class="id">r</span> # <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> *; <span class="id">unfold_Stv</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>. <span class="tactic">exists</span> 0; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">left</span>. <span class="tactic">intros</span> ? <span class="id">Hle</span>. <span class="id">inv</span> <span class="id">Hle</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>. <span class="tactic">exists</span> 0; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_0_l">Nat.le_0_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">IHn</span> <span class="id">r</span>) <span class="kwd">as</span> [<span class="id">Hle</span>|(<span class="id">m</span>&amp;<span class="id">Hle</span>&amp;<span class="id">Htrue</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">left</span>. <span class="tactic">intros</span> [|] ?; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hle</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">right</span>. <span class="tactic">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>). <span class="tactic">split</span>; <span class="tactic">auto</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.fby1_reset1_fby">fby1_reset1_fby</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">r</span> <span class="id">x0</span> <span class="id">v0</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">m</span>, <span class="id">m</span> &lt;= <span class="id">n</span> -&gt; <span class="id">r</span> # <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LS.fby1">LS.fby1</a></span> <span class="id">v0</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val">NCor.const_val</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.abstract_clock">abstract_clock</a></span> (<span class="id">mask</span>' <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux.absent">absent</a></span> 0 0 <span class="id">r</span> <span class="id">x</span>)) <span class="id">x0</span>) (<span class="id">mask</span>' <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux.absent">absent</a></span> 0 0 <span class="id">r</span> <span class="id">x</span>) (<span class="id">mask</span>' <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux.absent">absent</a></span> 0 0 <span class="id">r</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">y</span> # <span class="id">n</span> = (<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.reset1">NLSC.reset1</a></span> <span class="id">x0</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sfby">sfby</a></span> <span class="id">v0</span> <span class="id">x</span>) <span class="id">r</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) # <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hle</span> <span class="id">Hfby</span>; <span class="id">unfold_Stv</span> <span class="id">r</span>; <span class="id">unfold_Stv</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="tactic">specialize</span> (<span class="id">Hle</span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_0_l">Nat.le_0_l</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">Hle</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hle</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="tactic">specialize</span> (<span class="id">Hle</span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_0_l">Nat.le_0_l</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">Hle</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hle</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> 2 <span class="id">mask</span>'<span class="id">_Cons</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_Cons">ac_Cons</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_Cons">NCor.const_val_Cons</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfby</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> 2 <span class="id">mask</span>'<span class="id">_Cons</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_Cons">ac_Cons</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_Cons">NCor.const_val_Cons</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfby</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="tactic">specialize</span> (<span class="id">Hle</span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_0_l">Nat.le_0_l</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">Hle</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hle</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="tactic">specialize</span> (<span class="id">Hle</span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_0_l">Nat.le_0_l</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">Hle</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hle</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> 2 <span class="id">mask</span>'<span class="id">_Cons</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_Cons">ac_Cons</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_Cons">NCor.const_val_Cons</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfby</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHn</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hle</span>'. <span class="tactic">specialize</span> (<span class="id">Hle</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)). <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span> <span class="kwd">in</span> <span class="id">Hle</span>. <span class="tactic">eapply</span> <span class="id">Hle</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> 2 <span class="id">mask</span>'<span class="id">_Cons</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_Cons">ac_Cons</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_Cons">NCor.const_val_Cons</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfby</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHn</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hle</span>'. <span class="tactic">specialize</span> (<span class="id">Hle</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)). <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span> <span class="kwd">in</span> <span class="id">Hle</span>. <span class="tactic">eapply</span> <span class="id">Hle</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.reset1_fby_reset">reset1_fby_reset</a></span> : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">v0</span> <span class="id">v</span> <span class="id">xs</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">m</span>, <span class="id">m</span> &lt;= <span class="id">n</span> /\ <span class="id">rs</span> # <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.reset1">NLSC.reset1</a></span> <span class="id">v0</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sfby">sfby</a></span> <span class="id">v</span> <span class="id">xs</span>) <span class="id">rs</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) # <span class="id">n</span> = (<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.reset1">NLSC.reset1</a></span> <span class="id">v0</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sfby">sfby</a></span> <span class="id">v0</span> <span class="id">xs</span>) <span class="id">rs</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) # <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> * <span class="id">Hle</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">rs</span>; <span class="id">unfold_Stv</span> <span class="id">xs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hle</span> <span class="kwd">as</span> (?&amp;<span class="id">Hle</span>&amp;<span class="id">Hr</span>). <span class="id">inv</span> <span class="id">Hle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">Hr</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hr</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.reset1_fby">NLSC.reset1_fby</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hle</span> <span class="kwd">as</span> (?&amp;<span class="id">Hle</span>&amp;<span class="id">Hr</span>). <span class="tactic">destruct</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">Hr</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hr</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span> <span class="kwd">in</span> <span class="id">Hr</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eexists</span>; <span class="tactic">split</span>; [|<span class="tactic">eauto</span>]. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="CORRECTNESS.fby_reset_fby">fby_reset_fby</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">x0</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#LS.fby">LS.fby</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val">NCor.const_val</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.abstract_clock">abstract_clock</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">x</span>)) <span class="id">x0</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">x</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">y</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">y</span> ≡ <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.reset">NLSC.reset</a></span> <span class="id">x0</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sfby">sfby</a></span> <span class="id">x0</span> <span class="id">x</span>) <span class="id">r</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">k</span>, (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> <span class="id">r</span>) # <span class="id">n</span> &lt;= <span class="id">k</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LS.fby">LS.fby</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val">NCor.const_val</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.abstract_clock">abstract_clock</a></span> (<span class="id">mask</span>' <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux.absent">absent</a></span> <span class="id">k</span> 0 <span class="id">r</span> <span class="id">x</span>)) <span class="id">x0</span>) (<span class="id">mask</span>' <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux.absent">absent</a></span> <span class="id">k</span> 0 <span class="id">r</span> <span class="id">x</span>) (<span class="id">mask</span>' <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux.absent">absent</a></span> <span class="id">k</span> 0 <span class="id">r</span> <span class="id">y</span>)) <span class="kwd">as</span> <span class="id">Hfby</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">Hfby</span>. } <span class="tactic">clear</span> <span class="id">Hfby</span>. <span class="tactic">rename</span> <span class="id">Hfby</span>' <span class="id">into</span> <span class="id">Hfby</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x0</span> <span class="id">x</span> <span class="id">y</span> <span class="id">r</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">unfold_Stv</span> <span class="id">r</span>; <span class="id">unfold_Stv</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">specialize</span> (<span class="id">Hfby</span> 1). <span class="tactic">rewrite</span> 2 <span class="id">mask</span>'<span class="id">_Cons</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_Cons">ac_Cons</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_Cons">NCor.const_val_Cons</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">specialize</span> (<span class="id">Hfby</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_refl">Nat.le_refl</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfby</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">specialize</span> (<span class="id">Hfby</span> 1). <span class="tactic">rewrite</span> 2 <span class="id">mask</span>'<span class="id">_Cons</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_Cons">ac_Cons</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_Cons">NCor.const_val_Cons</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">specialize</span> (<span class="id">Hfby</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_refl">Nat.le_refl</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfby</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">specialize</span> (<span class="id">Hfby</span> 0). <span class="tactic">rewrite</span> 2 <span class="id">mask</span>'<span class="id">_Cons</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_Cons">ac_Cons</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_Cons">NCor.const_val_Cons</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">specialize</span> (<span class="id">Hfby</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_refl">Nat.le_refl</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfby</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">specialize</span> (<span class="id">Hfby</span> 0). <span class="tactic">rewrite</span> 2 <span class="id">mask</span>'<span class="id">_Cons</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_Cons">ac_Cons</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_Cons">NCor.const_val_Cons</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">specialize</span> (<span class="id">Hfby</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_refl">Nat.le_refl</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfby</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.reset1_fby">NLSC.reset1_fby</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">auto</span>. <span class="tactic">intros</span> <span class="id">k</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hfby</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfby</span>. <span class="tactic">setoid_rewrite</span> <span class="id">count_S_nth</span>' <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hfby</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n_S">le_n_S</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hc</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">k</span>; <span class="tactic">rewrite</span> 2 <span class="id">mask</span>'<span class="id">_Cons</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_Cons">ac_Cons</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_Cons">NCor.const_val_Cons</a></span>, 2 <span class="id">mask</span>'<span class="id">_S</span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="id">inv</span> <span class="id">Hfby</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;2&nbsp;possibilities&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;there&nbsp;is&nbsp;no&nbsp;reset&nbsp;before&nbsp;n,&nbsp;in&nbsp;which&nbsp;case&nbsp;the&nbsp;sequence&nbsp;behaves&nbsp;as&nbsp;fby1&nbsp;until&nbsp;n&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;there&nbsp;is&nbsp;a&nbsp;reset&nbsp;before&nbsp;n,&nbsp;in&nbsp;which&nbsp;case&nbsp;we&nbsp;can&nbsp;use&nbsp;the&nbsp;induction&nbsp;hypothesis&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.reset_or_not_reset">reset_or_not_reset</a></span> <span class="id">n</span> <span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">specialize</span> (<span class="id">Hfby</span> 1). <span class="tactic">rewrite</span> 2 <span class="id">mask</span>'<span class="id">_Cons</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_Cons">ac_Cons</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_Cons">NCor.const_val_Cons</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span>, 2 <span class="id">mask</span>'<span class="id">_S</span> <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfby</span>. <span class="tactic">setoid_rewrite</span> <span class="id">count_S_nth</span>' <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_0">count_0</a></span> <span class="id">_</span> <span class="id">_</span>)) <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">auto</span>. <span class="tactic">specialize</span> (<span class="id">Hfby</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_refl">Nat.le_refl</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.fby1_reset1_fby">fby1_reset1_fby</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.reset1_fby_reset">reset1_fby_reset</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">k</span> <span class="id">Hle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">k</span> &gt; 0) <span class="kwd">as</span> <span class="id">Hgt</span> <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_not_0">count_not_0</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hfby</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>, 2 <span class="id">mask</span>'<span class="id">_Cons</span>, 2 <span class="id">mask</span>'<span class="id">_S</span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfby</span>. <span class="tactic">setoid_rewrite</span> <span class="id">count_S_nth</span>' <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hfby</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n_S">le_n_S</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hle</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">k</span>; <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_Cons">ac_Cons</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_Cons">NCor.const_val_Cons</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="id">inv</span> <span class="id">Hfby</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hgt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">auto</span>. <span class="tactic">intros</span> [|<span class="id">k</span>] <span class="id">Hle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">specialize</span> (<span class="id">Hfby</span> 0). <span class="tactic">rewrite</span> 2 <span class="id">mask</span>'<span class="id">_Cons</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_Cons">ac_Cons</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_Cons">NCor.const_val_Cons</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfby</span>. <span class="tactic">specialize</span> (<span class="id">Hfby</span> <span class="id">Hle</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfby</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">specialize</span> (<span class="id">Hfby</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfby</span>. <span class="tactic">specialize</span> (<span class="id">Hfby</span> <span class="id">Hle</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">k</span>; <span class="tactic">rewrite</span> 2 <span class="id">mask</span>'<span class="id">_Cons</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_Cons">ac_Cons</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_Cons">NCor.const_val_Cons</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="id">inv</span> <span class="id">Hfby</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.reset_or_not_reset">reset_or_not_reset</a></span> <span class="id">n</span> <span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">specialize</span> (<span class="id">Hfby</span> 0). <span class="tactic">rewrite</span> 2 <span class="id">mask</span>'<span class="id">_Cons</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_Cons">ac_Cons</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_Cons">NCor.const_val_Cons</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_0">count_0</a></span> <span class="id">_</span> <span class="id">_</span>)) <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">auto</span>. <span class="tactic">specialize</span> (<span class="id">Hfby</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_refl">Nat.le_refl</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.fby1_reset1_fby">fby1_reset1_fby</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.reset1_fby_reset">reset1_fby_reset</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">k</span> <span class="id">Hle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">k</span> &gt; 0) <span class="kwd">as</span> <span class="id">Hgt</span> <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_not_0">count_not_0</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hfby</span> <span class="id">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>, 2 <span class="id">mask</span>'<span class="id">_Cons</span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfby</span>. <span class="tactic">specialize</span> (<span class="id">Hfby</span> <span class="id">Hle</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">k</span> <span class="kwd">as</span> [|[|]]; <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_Cons">ac_Cons</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_Cons">NCor.const_val_Cons</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>; <span class="id">inv</span> <span class="id">Hfby</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hgt</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CORRECTNESS.sem_clock_ac">sem_clock_ac</a></span> : <span class="kwd">forall</span> <span class="id">H</span> <span class="id">bs</span> <span class="id">bs</span>' <span class="id">ck</span> <span class="id">x</span> <span class="id">ty</span> <span class="id">k</span> <span class="id">xs</span> <span class="id">vs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var">sem_var</a></span> <span class="id">H</span> <span class="id">x</span> <span class="id">vs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_clock">sem_clock</a></span> <span class="id">H</span> <span class="id">bs</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Cks.Con">Con</a></span> <span class="id">ck</span> <span class="id">x</span> (<span class="id">ty</span>, <span class="id">k</span>)) <span class="id">bs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.when">when</a></span> <span class="id">k</span> <span class="id">xs</span> <span class="id">vs</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bs</span>' ≡ <span class="id"><a href="Velus.Transcription.Correctness.html#Str.abstract_clock">abstract_clock</a></span> <span class="id">ys</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvar</span> <span class="id">Hck</span> <span class="id">Hwhen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.CIStr.sem_clock_equiv">LCS.CIStr.sem_clock_equiv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.CIStr.CIStr.sem_var_impl">LCS.CIStr.CIStr.sem_var_impl</a></span> <span class="kwd">in</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.when_spec">when_spec</a></span> <span class="kwd">in</span> <span class="id">Hwhen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">specialize</span> (<span class="id">Hvar</span> <span class="id">n</span>). <span class="tactic">specialize</span> (<span class="id">Hck</span> <span class="id">n</span>). <span class="tactic">specialize</span> (<span class="id">Hwhen</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.CIStr.CIStr.tr_Stream_nth">LCS.CIStr.CIStr.tr_Stream_nth</a></span> <span class="kwd">in</span> <span class="id">Hck</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.CIStr.CIStr.tr_Stream_nth">LCS.CIStr.CIStr.tr_Stream_nth</a></span> <span class="kwd">in</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_nth">ac_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hwhen</span> <span class="kwd">as</span> [(<span class="id">Hx</span>&amp;<span class="id">Hv</span>&amp;<span class="id">Hy</span>)|[(?&amp;?&amp;<span class="id">Hx</span>&amp;<span class="id">Hv</span>&amp;?&amp;<span class="id">Hy</span>)|(?&amp;<span class="id">Hx</span>&amp;<span class="id">Hv</span>&amp;<span class="id">Hy</span>)]]; <span class="tactic">rewrite</span> <span class="id">Hv</span> <span class="kwd">in</span> *; <span class="tactic">setoid_rewrite</span> <span class="id">Hy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hck</span>; <span class="tactic">auto</span>. <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.IStr.sem_var_instant_det">IStr.sem_var_instant_det</a></span> <span class="kwd">in</span> <span class="id">Hvar</span>; <span class="tactic">eauto</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hck</span>; <span class="tactic">auto</span>. <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.IStr.sem_var_instant_det">IStr.sem_var_instant_det</a></span> <span class="kwd">in</span> <span class="id">Hvar</span>; [|<span class="tactic">eauto</span>]. <span class="id">inv</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hck</span>; <span class="tactic">auto</span>. 1,2:<span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.IStr.sem_var_instant_det">IStr.sem_var_instant_det</a></span> <span class="kwd">in</span> <span class="id">Hvar</span>; [|<span class="tactic">eauto</span>]; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CORRECTNESS.sem_clock_inv">sem_clock_inv</a></span> : <span class="kwd">forall</span> <span class="id">H</span> <span class="id">bs</span> <span class="id">ck</span> <span class="id">x</span> <span class="id">ty</span> <span class="id">k</span> <span class="id">xs</span> <span class="id">vs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var">sem_var</a></span> <span class="id">H</span> <span class="id">x</span> <span class="id">vs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_clock">sem_clock</a></span> <span class="id">H</span> <span class="id">bs</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Cks.Con">Con</a></span> <span class="id">ck</span> <span class="id">x</span> (<span class="id">ty</span>, <span class="id">k</span>)) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.abstract_clock">abstract_clock</a></span> <span class="id">ys</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.when">when</a></span> <span class="id">k</span> <span class="id">xs</span> <span class="id">vs</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_clock">sem_clock</a></span> <span class="id">H</span> <span class="id">bs</span> <span class="id">ck</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.abstract_clock">abstract_clock</a></span> <span class="id">xs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvar</span> <span class="id">Hck</span> <span class="id">Hwhen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.CIStr.sem_clock_equiv">LCS.CIStr.sem_clock_equiv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.CIStr.CIStr.sem_var_impl">LCS.CIStr.CIStr.sem_var_impl</a></span> <span class="kwd">in</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.when_spec">when_spec</a></span> <span class="kwd">in</span> <span class="id">Hwhen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">specialize</span> (<span class="id">Hvar</span> <span class="id">n</span>). <span class="tactic">specialize</span> (<span class="id">Hck</span> <span class="id">n</span>). <span class="tactic">specialize</span> (<span class="id">Hwhen</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.CIStr.CIStr.tr_Stream_ac">LCS.CIStr.CIStr.tr_Stream_ac</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.CIStr.CIStr.tr_Stream_nth">LCS.CIStr.CIStr.tr_Stream_nth</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hwhen</span> <span class="kwd">as</span> [(<span class="id">Hx</span>&amp;<span class="id">Hv</span>&amp;<span class="id">Hy</span>)|[(?&amp;?&amp;<span class="id">Hx</span>&amp;<span class="id">Hv</span>&amp;?&amp;<span class="id">Hy</span>)|(?&amp;<span class="id">Hx</span>&amp;<span class="id">Hv</span>&amp;<span class="id">Hy</span>)]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hv</span> <span class="kwd">in</span> *; <span class="tactic">setoid_rewrite</span> <span class="id">Hx</span>; <span class="id">inv</span> <span class="id">Hck</span>; <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">setoid_rewrite</span> <span class="id">Hy</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CORRECTNESS.sem_clock_const">sem_clock_const</a></span> : <span class="kwd">forall</span> <span class="id">H</span> <span class="id">ck</span> <span class="id">x</span> <span class="id">s</span> <span class="id">ty</span> <span class="id">k</span> <span class="id">bs</span> <span class="id">bs</span>' <span class="id">bs</span>'' <span class="id">c</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var">sem_var</a></span> <span class="id">H</span> <span class="id">x</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_clock">sem_clock</a></span> <span class="id">H</span> <span class="id">bs</span> <span class="id">ck</span> <span class="id">bs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_clock">sem_clock</a></span> <span class="id">H</span> <span class="id">bs</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Cks.Con">Con</a></span> <span class="id">ck</span> <span class="id">x</span> (<span class="id">ty</span>, <span class="id">k</span>)) <span class="id">bs</span>'' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.when">when</a></span> <span class="id">k</span> <span class="id">xs</span> <span class="id">s</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> ≡ (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val">NCor.const_val</a></span> <span class="id">bs</span>' <span class="id">c</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ys</span> ≡ (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val">NCor.const_val</a></span> <span class="id">bs</span>'' <span class="id">c</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvar</span> <span class="id">Hck1</span> <span class="id">Hck2</span> <span class="id">Hwhen</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.CIStr.CIStr.sem_var_impl">LCS.CIStr.CIStr.sem_var_impl</a></span> <span class="kwd">in</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.CIStr.sem_clock_equiv">LCS.CIStr.sem_clock_equiv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.when_spec">when_spec</a></span> <span class="kwd">in</span> <span class="id">Hwhen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hvar</span> <span class="id">n</span>). <span class="tactic">specialize</span> (<span class="id">Hck1</span> <span class="id">n</span>). <span class="tactic">specialize</span> (<span class="id">Hck2</span> <span class="id">n</span>). <span class="tactic">specialize</span> (<span class="id">Hwhen</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.CIStr.CIStr.tr_Stream_nth">LCS.CIStr.CIStr.tr_Stream_nth</a></span> <span class="kwd">in</span> <span class="id">Hck1</span>, <span class="id">Hck2</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.CIStr.CIStr.tr_Stream_nth">LCS.CIStr.CIStr.tr_Stream_nth</a></span> <span class="kwd">in</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_nth">NCor.const_val_nth</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hwhen</span> <span class="kwd">as</span> [(<span class="id">Hx</span>&amp;<span class="id">Hv</span>&amp;<span class="id">Hy</span>)|[(?&amp;?&amp;<span class="id">Hx</span>&amp;<span class="id">Hv</span>&amp;?&amp;<span class="id">Hy</span>)|(?&amp;<span class="id">Hx</span>&amp;<span class="id">Hv</span>&amp;<span class="id">Hy</span>)]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hx</span>, <span class="id">Hv</span>, <span class="id">Hy</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>; <span class="id">inv</span> <span class="id">Hck2</span>; <span class="tactic">auto</span>. 1,2,4,5:<span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1-5:<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.IStr.sem_var_instant_det">IStr.sem_var_instant_det</a></span> <span class="kwd">in</span> <span class="id">Hvar</span>; [|<span class="tactic">eauto</span>]; <span class="id">inv</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1-2:<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1:<span class="tactic">destruct</span> (<span class="id">bs</span>' # <span class="id">n</span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.to_constant_sem">to_constant_sem</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#L.global">L.global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">cenv</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">ck</span> <span class="id">b</span>' <span class="id">c</span> <span class="id">cs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#L.clockof">L.clockof</a></span> <span class="id">e</span> = [<span class="id">ck</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LC.wc_exp">LC.wc_exp</a></span> <span class="id">G</span> <span class="id">cenv</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_constant">to_constant</a></span> <span class="id">e</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">c</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> [<span class="id">cs</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_clock">sem_clock</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> <span class="id">H</span>) <span class="id">b</span> <span class="id">ck</span> <span class="id">b</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cs</span> ≡ (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val">NCor.const_val</a></span> <span class="id">b</span>' (<span class="id"><a href="Velus.Transcription.Correctness.html#OpAux.sem_const">sem_const</a></span> <span class="id">c</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#L.exp_ind2">L.exp_ind2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hck</span> <span class="id">Hwc</span> <span class="id">Hconst</span> <span class="id">Hsem</span> <span class="id">Hsck</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">Hconst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;constant&nbsp;*)</span> <span class="id">inv</span> <span class="id">Hck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">inv</span> <span class="id">Hsck</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_const">NCor.const_val_const</a></span>, &lt;-<span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;enum&nbsp;*)</span> <span class="id">inv</span> <span class="id">Hck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">inv</span> <span class="id">Hsck</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val_enum">NCor.const_val_enum</a></span>, &lt;-<span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;when&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 (<span class="tactic">destruct</span> <span class="id">es</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwc</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 (<span class="tactic">destruct</span> <span class="id">tys</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">congruence</span>). <span class="id">inv</span> <span class="id">Hck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="id">singleton_length</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">simpl_Forall</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">b</span>' ≡ <span class="id"><a href="Velus.Transcription.Correctness.html#Str.abstract_clock">abstract_clock</a></span> <span class="id">cs</span>) <span class="kwd">as</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_clock_ac">sem_clock_ac</a></span> <span class="kwd">in</span> <span class="id">Hsck</span>; <span class="tactic">eauto</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_history">LS.sem_var_history</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hac</span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_clock_inv">sem_clock_inv</a></span> <span class="kwd">in</span> <span class="id">H8</span> <span class="kwd">as</span> <span class="id">Hck</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hx0</span>:=<span class="id">Hck</span>'). <span class="tactic">eapply</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">Hx0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_clock_const">sem_clock_const</a></span>; <span class="tactic">eauto</span>. 1,2:<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_history">LS.sem_var_history</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="id"><a name="CORRECTNESS.CES">CES</a></span> := <span class="id"><a href="Velus.CoreExpr.CESemantics.html#CESemanticsFun">CESemanticsFun</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#CE">CE</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.IStr">IStr</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="id"><a name="CORRECTNESS.CEI">CEI</a></span> := <span class="id"><a href="Velus.CoreExpr.CEInterpreter.html#CEInterpreterFun">CEInterpreterFun</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#CE">CE</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.IStr">IStr</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.CES">CES</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="id"><a name="CORRECTNESS.ICStr">ICStr</a></span> := <span class="id"><a href="Velus.IndexedToCoind.html#IndexedToCoindFun">IndexedToCoindFun</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.IStr">IStr</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str">Str</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="id">CIStr</span>' := <span class="id"><a href="Velus.CoindToIndexed.html#CoindToIndexedFun">CoindToIndexedFun</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str">Str</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.IStr">IStr</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="kwd">Import</span> <span class="id"><a name="CORRECTNESS.ConvStr">ConvStr</a></span> := <span class="id"><a href="Velus.CoindIndexed.html#CoindIndexedFun">CoindIndexedFun</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str">Str</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.IStr">IStr</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="id"><a name="CORRECTNESS.NLSI">NLSI</a></span> := <span class="id"><a href="Velus.NLustre.NLIndexedSemantics.html#NLIndexedSemanticsFun">NLIndexedSemanticsFun</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#CE">CE</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#NL">NL</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.IStr">IStr</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ord">Ord</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.CES">CES</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="id"><a name="CORRECTNESS.NICStr">NICStr</a></span> := <span class="id"><a href="Velus.NLustre.NLIndexedToCoind.html#NLIndexedToCoindFun">NLIndexedToCoindFun</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#CE">CE</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#NL">NL</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.IStr">IStr</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str">Str</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.ConvStr.ICStr">ICStr</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ord">Ord</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.CES">CES</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.NLSI">NLSI</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.CEI">CEI</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC">NLSC</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="id"><a name="CORRECTNESS.NCIStr">NCIStr</a></span> := <span class="id"><a href="Velus.NLustre.NLCoindToIndexed.html#NLCoindToIndexedFun">NLCoindToIndexedFun</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#CE">CE</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#NL">NL</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.IStr">IStr</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str">Str</a></span> <span class="id">CIStr</span>' <span class="id"><a href="Velus.Transcription.Correctness.html#Ord">Ord</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.CES">CES</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.NLSI">NLSI</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC">NLSC</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_rhs_arhs">sem_rhs_arhs</a></span> : <span class="kwd">forall</span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> <span class="id">e</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_rhs">NLSC.sem_rhs</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_clock">sem_clock</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.abstract_clock">abstract_clock</a></span> <span class="id">s</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_arhs">NLSC.sem_arhs</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> <span class="id">e</span> <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hsem</span> <span class="id">Hsck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_rhs_impl">NICStr.NLCIStr.sem_rhs_impl</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.CIStr.CIStr.sem_clock_impl">CIStr.CIStr.sem_clock_impl</a></span> <span class="kwd">in</span> <span class="id">Hsck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.CIStr.tr_history_equiv">CIStr.tr_history_equiv</a></span>, &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.CIStr.tr_stream_eqst">CIStr.tr_stream_eqst</a></span> <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">b</span>), &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.CIStr.tr_stream_eqst">CIStr.tr_stream_eqst</a></span> <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_arhs_impl">NICStr.sem_arhs_impl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?. <span class="tactic">specialize</span> (<span class="id">Hsem</span> <span class="id">n</span>). <span class="tactic">specialize</span> (<span class="id">Hsck</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_arhs_instant">CES.sem_arhs_instant</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.tr_Stream_nth">NICStr.CIStr.tr_Stream_nth</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_nth">ac_nth</a></span> <span class="kwd">in</span> <span class="id">Hsck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">s</span> # <span class="id">n</span>) <span class="id">eqn</span>:<span class="id">Heq</span>; <span class="tactic">econstructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">setoid_rewrite</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">Hsck</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="CORRECTNESS.sem_exp_arhs">sem_exp_arhs</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#L.global">L.global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">H</span> <span class="id">b</span> <span class="id">env</span> <span class="id">e</span> <span class="id">e</span>' <span class="id">s</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LT.wt_exp">LT.wt_exp</a></span> <span class="id">G</span> <span class="id">env</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_cexp">to_cexp</a></span> <span class="id">e</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">e</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> [<span class="id">s</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_clock">sem_clock</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> <span class="id">H</span>) <span class="id">b</span> <span class="id">ck</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.abstract_clock">abstract_clock</a></span> <span class="id">s</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_arhs">NLSC.sem_arhs</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> <span class="id">H</span>) <span class="id">b</span> <span class="id">ck</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#CE.Ecexp">Ecexp</a></span> <span class="id">e</span>') <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwt</span> <span class="id">Hto</span> <span class="id">Hsem</span> <span class="id">Hsck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_rhs_arhs">sem_rhs_arhs</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_exp_cexp">sem_exp_cexp</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>; [|<span class="tactic">eauto</span>|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_lexp_laexp">sem_lexp_laexp</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">s</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_exp">NLSC.sem_exp</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_clock">sem_clock</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.abstract_clock">abstract_clock</a></span> <span class="id">s</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_aexp">NLSC.sem_aexp</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> <span class="id">e</span> <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cofix</span>. <span class="tactic">intros</span> * <span class="id">Hsem</span> <span class="id">Hsc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">s</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#unfold_Stream">unfold_Stream</a></span> <span class="kwd">in</span> <span class="id">Hsc</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hsc</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>; <span class="tactic">eapply</span> <span class="id">Cofix</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sc_step">sc_step</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_lexp_step2">sem_lexp_step2</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Forall2_forall</span>' {<span class="id">A</span> <span class="id">B</span>} : <span class="kwd">forall</span> (<span class="id">P</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id">P</span> <span class="id">k</span>) <span class="id">xs</span> <span class="id">ys</span>) &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="kwd">forall</span> <span class="id">k</span>, (<span class="id">P</span> <span class="id">k</span> <span class="id">x</span> <span class="id">y</span>)) <span class="id">xs</span> <span class="id">ys</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> * <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">ys</span> <span class="id">Hf</span>. <span class="tactic">induction</span> <span class="id">xs</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">specialize</span> (<span class="id">Hf</span> 0); <span class="id">inv</span> <span class="id">Hf</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">ys</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">specialize</span> (<span class="id">Hf</span> 0). <span class="id">inv</span> <span class="id">Hf</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">constructor</span>. 2:<span class="tactic">apply</span> <span class="id">IHxs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">intros</span> <span class="id">k</span>; <span class="tactic">specialize</span> (<span class="id">Hf</span> <span class="id">k</span>); <span class="id">inv</span> <span class="id">Hf</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">k</span>. <span class="tactic">induction</span> <span class="id">Hf</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.Forall_Forall2">Forall_Forall2</a></span> {<span class="id">A</span> <span class="id">B</span>} : <span class="kwd">forall</span> (<span class="id">P</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="tactic">exists</span> <span class="id">y</span>, <span class="id">P</span> <span class="id">x</span> <span class="id">y</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">ys</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">P</span> <span class="id">xs</span> <span class="id">ys</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hf</span>. <span class="tactic">induction</span> <span class="id">Hf</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;?). <span class="tactic">destruct</span> <span class="id">IHHf</span> <span class="kwd">as</span> (?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_lexp_mask">sem_lexp_mask</a></span>: <span class="kwd">forall</span> <span class="id">r</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_exp">NLSC.sem_exp</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>) <span class="id">e</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_exp">NLSC.sem_exp</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.tr_stream_eqst">tr_stream_eqst</a></span>, &lt;-(<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.tr_stream_eqst">tr_stream_eqst</a></span> <span class="id">v</span>), &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.tr_history_equiv">tr_history_equiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_exp_impl">NICStr.sem_exp_impl</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hsem</span> ((<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> <span class="id">r</span>) # <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_exp_impl">NCIStr.sem_exp_impl</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>. <span class="tactic">specialize</span> (<span class="id">Hsem</span> <span class="id">n</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.tr_Stream">CIStr</a></span>'.<span class="id">tr_Stream</span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb_nth">maskb_nth</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.history_mask_count">LCS.history_mask_count</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="CORRECTNESS.sem_lexps_mask">sem_lexps_mask</a></span>: <span class="kwd">forall</span> <span class="id">r</span> <span class="id">H</span> <span class="id">b</span> <span class="id">es</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">e</span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_exp">NLSC.sem_exp</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>) <span class="id">e</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>)) <span class="id">es</span> <span class="id">vs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_exp">NLSC.sem_exp</a></span> <span class="id">H</span> <span class="id">b</span>) <span class="id">es</span> <span class="id">vs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Forall2_forall</span>' <span class="kwd">in</span> <span class="id">Hf</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_lexp_mask">sem_lexp_mask</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_aexp_mask">sem_aexp_mask</a></span>: <span class="kwd">forall</span> <span class="id">r</span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> <span class="id">e</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_aexp">NLSC.sem_aexp</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>) <span class="id">ck</span> <span class="id">e</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_aexp">NLSC.sem_aexp</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> <span class="id">e</span> <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.tr_stream_eqst">tr_stream_eqst</a></span>, &lt;-(<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.tr_stream_eqst">tr_stream_eqst</a></span> <span class="id">v</span>), &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.tr_history_equiv">tr_history_equiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_aexp_impl">NICStr.sem_aexp_impl</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hsem</span> ((<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> <span class="id">r</span>) # <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_aexp_impl">NCIStr.sem_aexp_impl</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>. <span class="tactic">specialize</span> (<span class="id">Hsem</span> <span class="id">n</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.tr_Stream">CIStr</a></span>'.<span class="id">tr_Stream</span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb_nth">maskb_nth</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.history_mask_count">LCS.history_mask_count</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_arhs_mask">sem_arhs_mask</a></span>: <span class="kwd">forall</span> <span class="id">r</span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> <span class="id">e</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_arhs">NLSC.sem_arhs</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>) <span class="id">ck</span> <span class="id">e</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_arhs">NLSC.sem_arhs</a></span> <span class="id">H</span> <span class="id">b</span> <span class="id">ck</span> <span class="id">e</span> <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.tr_stream_eqst">tr_stream_eqst</a></span>, &lt;-(<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.tr_stream_eqst">tr_stream_eqst</a></span> <span class="id">v</span>), &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.tr_history_equiv">tr_history_equiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_arhs_impl">NICStr.sem_arhs_impl</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hsem</span> ((<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> <span class="id">r</span>) # <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_arhs_impl">NCIStr.sem_arhs_impl</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>. <span class="tactic">specialize</span> (<span class="id">Hsem</span> <span class="id">n</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.tr_Stream">CIStr</a></span>'.<span class="id">tr_Stream</span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb_nth">maskb_nth</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.history_mask_count">LCS.history_mask_count</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_toeq_normalized">sem_toeq_normalized</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#L.global">L.global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">P</span> <span class="id">cenv</span> <span class="id">x</span> <span class="id">e</span> <span class="id">ck</span> <span class="id">e</span>' <span class="id">r</span> <span class="id">H</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LC.wc_global">LC.wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sc_vars">LCS.sc_vars</a></span> <span class="id">cenv</span> <span class="id">H</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LN.Unnesting.normalized_cexp">LN.Unnesting.normalized_cexp</a></span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LT.wt_exp">LT.wt_exp</a></span> <span class="id">G</span> <span class="id">cenv</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LC.wc_exp">LC.wc_exp</a></span> <span class="id">G</span> <span class="id">cenv</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#L.clockof">L.clockof</a></span> <span class="id">e</span> = [<span class="id">ck</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_cexp">to_cexp</a></span> <span class="id">e</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">e</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_equation_ck">LCS.sem_equation_ck</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>) ([<span class="id">x</span>], [<span class="id">e</span>])) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_equation">NLSC.sem_equation</a></span> <span class="id">P</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> <span class="id">H</span>) <span class="id">b</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#NL.EqDef">NL.EqDef</a></span> <span class="id">x</span> <span class="id">ck</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#CE.Ecexp">Ecexp</a></span> <span class="id">e</span>')).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">HwcG</span> <span class="id">Hinv</span> <span class="id">Hnormed</span> <span class="id">Hwt</span> <span class="id">Hwc</span> <span class="id">Hck</span> <span class="id">Hto</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">v</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var">sem_var</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.Var">LS.Var</a></span> <span class="id">x</span>) <span class="id">v</span>) <span class="kwd">as</span> (<span class="id">v</span>&amp;<span class="id">Hvar</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">specialize</span> (<span class="id">Hsem</span> 0). <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">simpl_Foralls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_mask_inv">sem_var_mask_inv</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> (?&amp;<span class="id">Hv</span>&amp;?); <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. 2:<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_history">LS.sem_var_history</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_arhs_mask">sem_arhs_mask</a></span> <span class="kwd">with</span> (<span class="id">r</span>:=<span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">k</span>. <span class="tactic">specialize</span> (<span class="id">Hsem</span> <span class="id">k</span>). <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">simpl_Foralls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_mask_inv">sem_var_mask_inv</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> (?&amp;<span class="id">Hvar</span>'&amp;<span class="id">Heq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_det">sem_var_det</a></span> <span class="kwd">in</span> <span class="id">Hvar</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">Heq</span>, <span class="id">Hvar</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history_mask">LS.var_history_mask</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_exp_arhs">sem_exp_arhs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sc_exp">sc_exp</a></span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sc_vars_mask">LCS.sc_vars_mask</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hck</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H6</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_lexp_mask_inv">sem_lexp_mask_inv</a></span>: <span class="kwd">forall</span> <span class="id">r</span> <span class="id">k</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_exp">NLSC.sem_exp</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>) <span class="id">e</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">v</span>', <span class="id">v</span> ≡ <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span>; <span class="tactic">intros</span> * <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;const&nbsp;*)</span> <span class="tactic">exists</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.const">const</a></span> <span class="id">b</span> <span class="id">c</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span>, 2 <span class="id">const_nth</span>', <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb_nth">maskb_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;enum&nbsp;*)</span> <span class="tactic">exists</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.enum">enum</a></span> <span class="id">b</span> <span class="id">e</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span>, 2 <span class="id">enum_nth</span>', <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb_nth">maskb_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;var&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_mask_inv">sem_var_mask_inv</a></span> <span class="kwd">in</span> <span class="id">H6</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;when&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHe</span> <span class="kwd">in</span> <span class="id">H6</span> <span class="kwd">as</span> (?&amp;<span class="id">Heq</span>). <span class="tactic">rewrite</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">v</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.when_spec">when_spec</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">H9</span> <span class="kwd">as</span> [(<span class="id">Hmask</span>&amp;?&amp;<span class="id">Hv</span>)|[(?&amp;?&amp;<span class="id">Hmask</span>&amp;?&amp;?&amp;<span class="id">Hv</span>)|(?&amp;<span class="id">Hmask</span>&amp;?&amp;<span class="id">Hv</span>)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hv</span>. <span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hv</span>. <span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hv</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span> <span class="kwd">in</span> <span class="id">Hmask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;unop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHe</span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> (?&amp;<span class="id">Heq</span>). <span class="tactic">rewrite</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">v</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.lift1_spec">lift1_spec</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">H8</span> <span class="kwd">as</span> [(?&amp;<span class="id">Hv</span>)|(?&amp;?&amp;<span class="id">Hmask</span>&amp;?&amp;<span class="id">Hv</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hv</span>. <span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hv</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span> <span class="kwd">in</span> <span class="id">Hmask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;binop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHe1</span> <span class="kwd">in</span> <span class="id">H8</span> <span class="kwd">as</span> (?&amp;<span class="id">Heq1</span>). <span class="tactic">rewrite</span> <span class="id">Heq1</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHe2</span> <span class="kwd">in</span> <span class="id">H9</span> <span class="kwd">as</span> (?&amp;<span class="id">Heq2</span>). <span class="tactic">rewrite</span> <span class="id">Heq2</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">v</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.lift2_spec">lift2_spec</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">H10</span> <span class="kwd">as</span> [(?&amp;?&amp;<span class="id">Hv</span>)|(?&amp;?&amp;?&amp;<span class="id">Hm1</span>&amp;<span class="id">Hm2</span>&amp;?&amp;<span class="id">Hv</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hv</span>. <span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hv</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span> <span class="kwd">in</span> <span class="id">Hm1</span>, <span class="id">Hm2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_normalized_lexp_mask_inv">sem_normalized_lexp_mask_inv</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>}: <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#L.global">L.global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">r</span> <span class="id">k</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LN.Unnesting.normalized_lexp">LN.Unnesting.normalized_lexp</a></span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>) <span class="id">e</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">v</span>', <span class="id"><a href="Velus.Transcription.Correctness.html#Str.EqSts">EqSts</a></span> <span class="id">v</span> [<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>'].<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnormed</span>. <span class="id">revert</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hnormed</span>; <span class="tactic">intros</span> * <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;const&nbsp;*)</span> <span class="tactic">exists</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.const">const</a></span> <span class="id">b</span> <span class="id">c</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span>. <span class="tactic">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span>, 2 <span class="id">const_nth</span>', <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb_nth">maskb_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;enum&nbsp;*)</span> <span class="tactic">exists</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.enum">enum</a></span> <span class="id">b</span> <span class="id">k0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span>. <span class="tactic">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span>, 2 <span class="id">enum_nth</span>', <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb_nth">maskb_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;var&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_mask_inv">sem_var_mask_inv</a></span> <span class="kwd">in</span> <span class="id">H6</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;unop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHHnormed</span> <span class="kwd">in</span> <span class="id">H6</span> <span class="kwd">as</span> (?&amp;<span class="id">Heq</span>). <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_singl">Forall2_singl</a></span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="tactic">rewrite</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.lift1_spec">lift1_spec</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">H9</span> <span class="kwd">as</span> [(?&amp;<span class="id">Hv</span>)|(?&amp;?&amp;<span class="id">Hmask</span>&amp;?&amp;<span class="id">Hv</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hv</span>. <span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hv</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span> <span class="kwd">in</span> <span class="id">Hmask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;binop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHHnormed1</span> <span class="kwd">in</span> <span class="id">H5</span> <span class="kwd">as</span> (?&amp;<span class="id">Heq1</span>). <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_singl">Forall2_singl</a></span> <span class="kwd">in</span> <span class="id">Heq1</span>. <span class="tactic">rewrite</span> <span class="id">Heq1</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHHnormed2</span> <span class="kwd">in</span> <span class="id">H8</span> <span class="kwd">as</span> (?&amp;<span class="id">Heq2</span>). <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_singl">Forall2_singl</a></span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="tactic">rewrite</span> <span class="id">Heq2</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.lift2_spec">lift2_spec</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">H12</span> <span class="kwd">as</span> [(?&amp;?&amp;<span class="id">Hv</span>)|(?&amp;?&amp;?&amp;<span class="id">Hm1</span>&amp;<span class="id">Hm2</span>&amp;?&amp;<span class="id">Hv</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hv</span>. <span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hv</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span> <span class="kwd">in</span> <span class="id">Hm1</span>, <span class="id">Hm2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;when&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>; <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHHnormed</span> <span class="kwd">in</span> <span class="id">H2</span> <span class="kwd">as</span> (?&amp;<span class="id">Heq</span>). <span class="id">inv</span> <span class="id">Heq</span>; <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="id">inv</span> <span class="id">H10</span>; <span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.when_spec">when_spec</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">H2</span> <span class="kwd">as</span> [(<span class="id">Hmask</span>&amp;?&amp;<span class="id">Hv</span>)|[(?&amp;?&amp;<span class="id">Hmask</span>&amp;?&amp;?&amp;<span class="id">Hv</span>)|(?&amp;<span class="id">Hmask</span>&amp;?&amp;<span class="id">Hv</span>)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hv</span>. <span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hv</span>. <span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hv</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv_nth">maskv_nth</a></span> <span class="kwd">in</span> <span class="id">Hmask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="CORRECTNESS.sem_laexp_mask_inv">sem_laexp_mask_inv</a></span>: <span class="kwd">forall</span> <span class="id">r</span> <span class="id">k</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">ck</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_aexp">NLSC.sem_aexp</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>) <span class="id">ck</span> <span class="id">e</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">v</span>', <span class="id">v</span> ≡ <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>; <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_lexp_mask_inv">sem_lexp_mask_inv</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_normalized_lexp_det">sem_normalized_lexp_det</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#L.global">L.global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">vs1</span> <span class="id">vs2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LN.Unnesting.normalized_lexp">LN.Unnesting.normalized_lexp</a></span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">vs1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span> <span class="id">e</span> <span class="id">vs2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.EqSts">EqSts</a></span> <span class="id">vs1</span> <span class="id">vs2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hun</span>. <span class="id">revert</span> <span class="id">vs1</span> <span class="id">vs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hun</span>; <span class="tactic">intros</span> * <span class="id">Hs1</span> <span class="id">Hs2</span>; <span class="id">inv</span> <span class="id">Hs1</span>; <span class="id">inv</span> <span class="id">Hs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;const&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span>, <span class="id">H5</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;enum&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span>, <span class="id">H7</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;var&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_det">sem_var_det</a></span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;unop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHHun</span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_singl">Forall2_singl</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H12</span>. <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">inv</span> <span class="id">H11</span>. <span class="tactic">clear</span> - <span class="id">H9</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.lift1_spec">lift1_spec</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">H9</span> <span class="id">n</span>) <span class="kwd">as</span> [(?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?)]; <span class="tactic">specialize</span> (<span class="id">H12</span> <span class="id">n</span>) <span class="kwd">as</span> [(?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?)]; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;binop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHHun1</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_singl">Forall2_singl</a></span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHHun2</span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_singl">Forall2_singl</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span>, <span class="id">H8</span> <span class="kwd">in</span> <span class="id">H17</span>. <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H15</span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="id">inv</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id">H16</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">inv</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">H12</span> <span class="id">H17</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.lift2_spec">lift2_spec</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">H12</span> <span class="id">n</span>) <span class="kwd">as</span> [(?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">H17</span> <span class="id">n</span>) <span class="kwd">as</span> [(?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)]; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;when&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_det">sem_var_det</a></span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHHun</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> -<span class="id">H2</span> <span class="id">H9</span> <span class="id">H10</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">vs1</span> <span class="id">vs2</span> <span class="id">H10</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">H2</span>; <span class="tactic">intros</span>; <span class="id">inv</span> <span class="id">H10</span>; <span class="id">inv</span> <span class="id">H14</span>; <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="tactic">eapply</span> <span class="id">IHForall2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">H</span>, <span class="id">H9</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">clear</span> - <span class="id">H3</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.when_spec">when_spec</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">H3</span> <span class="id">n</span>) <span class="kwd">as</span> [(?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?)]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">H4</span> <span class="id">n</span>) <span class="kwd">as</span> [(?&amp;?&amp;?)|[(?&amp;?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?)]]; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.disj_str_maskb">disj_str_maskb</a></span> : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">r</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str">disj_str</a></span> <span class="id">rs</span>) ≡ <span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str">disj_str</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span>) <span class="id">rs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb_nth">maskb_nth</a></span>, 2 <span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str_spec">disj_str_spec</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#existsb_map">existsb_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hcount</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">induction</span> <span class="id">rs</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb_nth">maskb_nth</a></span>, <span class="id">Hcount</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHrs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.disj_str_comm">disj_str_comm</a></span> : <span class="kwd">forall</span> <span class="id">r1</span> <span class="id">r2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str">disj_str</a></span> [<span class="id">r1</span>;<span class="id">r2</span>] ≡ <span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str">disj_str</a></span> [<span class="id">r2</span>;<span class="id">r1</span>].<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str_spec">disj_str_spec</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_false_r">Bool.orb_false_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_comm">Bool.orb_comm</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">Given a stream r and an index k, either there is a point
      in which we meet the k-nth true value in r, or there is not.
      We need the excluded-middle axiom to prove this,
      as r is an infinite stream, which prevents us from checking which of the cases
      we are in constructively (we would need to iterate infinitely in the case where
      we never meet the k-nth true)
   </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.count_ex_dec">count_ex_dec</a></span> : <span class="kwd">forall</span> <span class="id">r</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">n</span>, (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> <span class="id">r</span>) # <span class="id">n</span> = <span class="id">k</span>) \/ (<span class="kwd">forall</span> <span class="id">n</span>, (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> <span class="id">r</span>) # <span class="id">n</span> &lt;&gt; <span class="id">k</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span> (<span class="tactic">exists</span> <span class="id">n</span>, (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> <span class="id">r</span>) # <span class="id">n</span> = <span class="id">k</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>. <span class="tactic">intros</span> <span class="id">n</span> <span class="id">contra</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.count_neq_0_or_lt">count_neq_0_or_lt</a></span> : <span class="kwd">forall</span> <span class="id">r</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> <span class="id">r</span>) # <span class="id">n</span> &lt;&gt; <span class="id">k</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> = 0 /\ <span class="id">r</span> # 0 = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> <span class="id">r</span>) # <span class="id">n</span> &lt; <span class="id">k</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? [|<span class="id">k</span>'] <span class="id">Hcount</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">left</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">r</span>; <span class="tactic">auto</span>. <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hcount</span> 0); <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">Hcount</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>. <span class="tactic">intros</span> <span class="id">n</span>. <span class="id">revert</span> <span class="id">r</span> <span class="id">k</span>' <span class="id">Hcount</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">specialize</span> (<span class="id">Hcount</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">r</span>; <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">unfold_Stv</span> <span class="id">r</span>; <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">count_S_nth</span>'. <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.succ_lt_mono">Nat.succ_lt_mono</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">k</span>'; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">exfalso</span>. <span class="tactic">apply</span> (<span class="id">Hcount</span> 0); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">eauto</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hcount</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">Hcount</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_S_tl">Str_nth_S_tl</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">count_S_nth</span>'. <span class="tactic">f_equal</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">eauto</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hcount</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n0</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.count_disj_count">count_disj_count</a></span> : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">r1</span> <span class="id">r2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">k1</span> <span class="id">k2</span>, <span class="kwd">forall</span> <span class="id">n</span>, (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str">disj_str</a></span> [<span class="id">r1</span>;<span class="id">r2</span>])) # <span class="id">n</span> = <span class="id">k</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k2</span> <span class="id">r2</span> <span class="id">r1</span>)) # <span class="id">n</span> = <span class="id">k1</span> /\ (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> <span class="id">r2</span>) # <span class="id">n</span> = <span class="id">k2</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.count_ex_dec">count_ex_dec</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str">disj_str</a></span> [<span class="id">r1</span>;<span class="id">r2</span>]) <span class="id">k</span>) <span class="kwd">as</span> [(<span class="id">n</span>&amp;<span class="id">Heq</span>)|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">exists</span> ((<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> ((<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> <span class="id">r2</span>) # <span class="id">n</span>) <span class="id">r2</span> <span class="id">r1</span>)) # <span class="id">n</span>), ((<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> <span class="id">r2</span>) # <span class="id">n</span>); <span class="tactic">intros</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#le_gt_dec">Compare_dec.le_gt_dec</a></span> <span class="id">n</span> <span class="id">n0</span>) <span class="kwd">as</span> [<span class="id">Hle</span>|<span class="id">Hgt</span>]. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.lt_eq_cases">Nat.lt_eq_cases</a></span> <span class="kwd">in</span> <span class="id">Hle</span> <span class="kwd">as</span> [<span class="id">Hlt</span>|<span class="id">Heq</span>]; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">split</span>; [<span class="tactic">intros</span>|<span class="tactic">intros</span> (<span class="id">Hr1</span>&amp;<span class="id">Hr2</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_eq_false">count_eq_false</a></span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hl1</span> <span class="id">Hl2</span>. <span class="tactic">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id">Hl1</span> <span class="id">Hl2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb_nth">maskb_nth</a></span>. <span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str_spec">disj_str_spec</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">r1</span> # <span class="id">k</span>), (<span class="id">r2</span> # <span class="id">k</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_eq_false">count_eq_false</a></span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hl1</span> <span class="id">Hl2</span>. <span class="tactic">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id">Hl1</span> <span class="id">Hl2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str_spec">disj_str_spec</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">r1</span> # <span class="id">k</span>), (<span class="id">r2</span> # <span class="id">k</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">symmetry</span>. <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">Hr1</span>. <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">Hr2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_eq_false">count_eq_false</a></span>; <span class="tactic">auto</span>. <span class="tactic">intros</span> ? <span class="id">Hl1</span> <span class="id">Hl2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> <span class="id">r2</span>) # <span class="id">k</span> = (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> <span class="id">r2</span>) # <span class="id">n</span>) <span class="kwd">as</span> <span class="id">Hr2k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_between">count_between</a></span>. 2:<span class="tactic">eauto</span>. 1-3:<span class="id">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_eq_false">count_eq_false</a></span> <span class="kwd">in</span> <span class="id">Hr1</span>, <span class="id">Hr2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hr1</span> <span class="id">_</span> <span class="id">Hl1</span> <span class="id">Hl2</span>). <span class="tactic">specialize</span> (<span class="id">Hr2</span> <span class="id">_</span> <span class="id">Hl1</span> <span class="id">Hl2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Hr2k</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb_nth">maskb_nth</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Hr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str_spec">disj_str_spec</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">Hr1</span>, <span class="id">Hr2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">do</span> 2 <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.lt_nge">Nat.lt_nge</a></span> <span class="kwd">in</span> <span class="id">Hgt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">intros</span>|<span class="tactic">intros</span> (<span class="id">Hr1</span>&amp;<span class="id">Hr2</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_eq_false">count_eq_false</a></span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hl1</span> <span class="id">Hl2</span>. <span class="tactic">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id">Hl1</span> <span class="id">Hl2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb_nth">maskb_nth</a></span>. <span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str_spec">disj_str_spec</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">r1</span> # <span class="id">k</span>), (<span class="id">r2</span> # <span class="id">k</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_eq_false">count_eq_false</a></span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hl1</span> <span class="id">Hl2</span>. <span class="tactic">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id">Hl1</span> <span class="id">Hl2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str_spec">disj_str_spec</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">r1</span> # <span class="id">k</span>), (<span class="id">r2</span> # <span class="id">k</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_eq_false">count_eq_false</a></span>; <span class="tactic">auto</span>. <span class="tactic">intros</span> ? <span class="id">Hl1</span> <span class="id">Hl2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> <span class="id">r2</span>) # <span class="id">k</span> = (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count">count</a></span> <span class="id">r2</span>) # <span class="id">n</span>) <span class="kwd">as</span> <span class="id">Hr2k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> &lt;-<span class="id">Hr2</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_between">count_between</a></span>. 2:<span class="tactic">eauto</span>. 1-3:<span class="id">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_eq_false">count_eq_false</a></span> <span class="kwd">in</span> <span class="id">Hr1</span>, <span class="id">Hr2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hr1</span> <span class="id">_</span> <span class="id">Hl1</span> <span class="id">Hl2</span>). <span class="tactic">specialize</span> (<span class="id">Hr2</span> <span class="id">_</span> <span class="id">Hl1</span> <span class="id">Hl2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Hr2k</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb_nth">maskb_nth</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span> <span class="kwd">in</span> <span class="id">Hr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str_spec">disj_str_spec</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">Hr1</span>, <span class="id">Hr2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">exists</span> <span class="id">k</span>, <span class="id">k</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.count_neq_0_or_lt">count_neq_0_or_lt</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> [(?&amp;<span class="id">Hr0</span>)|<span class="id">Hlt</span>]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">n</span>; <span class="tactic">split</span>; [<span class="tactic">intros</span> | <span class="tactic">intros</span> (<span class="id">H1</span>&amp;<span class="id">H2</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_0_inv">count_0_inv</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_0_inv">count_0_inv</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_0_inv">count_0_inv</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#Str_nth_0_hd">Str_nth_0_hd</a></span> <span class="kwd">in</span> <span class="id">H1</span>, <span class="id">H2</span>, <span class="id">Hr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold_Stv</span> <span class="id">r1</span>; <span class="id">unfold_Stv</span> <span class="id">r2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">n</span>; <span class="tactic">split</span>; [<span class="tactic">intros</span> | <span class="tactic">intros</span> (<span class="id">H1</span>&amp;<span class="id">H2</span>)]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">specialize</span> (<span class="id">Hlt</span> <span class="id">n</span>). <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">specialize</span> (<span class="id">Hlt</span> <span class="id">n</span>). <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.count_disj_le2">count_disj_le2</a></span> <span class="id">n</span> <span class="id">r1</span> <span class="id">r2</span>) <span class="kwd">as</span> <span class="id">Hle</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.mask_disj">mask_disj</a></span> : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">r1</span> <span class="id">r2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">k1</span> <span class="id">k2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">absent</span>: <span class="id">A</span>) <span class="id">xs</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask">mask</a></span> <span class="id">absent</span> <span class="id">k</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str">disj_str</a></span> [<span class="id">r1</span>;<span class="id">r2</span>]) <span class="id">xs</span> ≡<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask">mask</a></span> <span class="id">absent</span> <span class="id">k1</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k2</span> <span class="id">r2</span> <span class="id">r1</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask">mask</a></span> <span class="id">absent</span> <span class="id">k2</span> <span class="id">r2</span> <span class="id">xs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.count_disj_count">count_disj_count</a></span> <span class="id">k</span> <span class="id">r1</span> <span class="id">r2</span>) <span class="kwd">as</span> (<span class="id">k1</span>&amp;<span class="id">k2</span>&amp;<span class="id">Hk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">k1</span>. <span class="tactic">exists</span> <span class="id">k2</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="tactic">intros</span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_nth">mask_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hcount</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span>, <span class="id">Hk</span> <span class="kwd">in</span> <span class="id">Hcount</span> <span class="kwd">as</span> (<span class="id">Hk1</span>&amp;<span class="id">Hk2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_eq">Nat.eqb_eq</a></span> <span class="kwd">in</span> <span class="id">Hk1</span>, <span class="id">Hk2</span>. <span class="tactic">rewrite</span> <span class="id">Hk1</span>, <span class="id">Hk2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq">Nat.eqb_neq</a></span>, <span class="id">Hk</span> <span class="kwd">in</span> <span class="id">Hcount</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Decidable.html#not_and">Decidable.not_and</a></span> <span class="kwd">in</span> <span class="id">Hcount</span> <span class="kwd">as</span> [?|?]; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_decidable">Nat.eq_decidable</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq">Nat.eqb_neq</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_neq">Nat.eqb_neq</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">destruct</span> (<span class="id">_</span> =? <span class="id">k1</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id">mask_disj</span>' {<span class="id">K</span>} : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">r1</span> <span class="id">r2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">k1</span> <span class="id">k2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">xs</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str">disj_str</a></span> [<span class="id">r1</span>;<span class="id">r2</span>]) <span class="id">xs</span> ≡ <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k1</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k2</span> <span class="id">r2</span> <span class="id">r1</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k2</span> <span class="id">r2</span> <span class="id">xs</span>)) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">bs</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str">disj_str</a></span> [<span class="id">r1</span>;<span class="id">r2</span>]) <span class="id">bs</span> ≡ <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k1</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k2</span> <span class="id">r2</span> <span class="id">r1</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k2</span> <span class="id">r2</span> <span class="id">bs</span>)) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">H</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#Str.history">history</a></span> <span class="id">K</span>), <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str">disj_str</a></span> [<span class="id">r1</span>;<span class="id">r2</span>]) <span class="id">H</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k1</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k2</span> <span class="id">r2</span> <span class="id">r1</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k2</span> <span class="id">r2</span> <span class="id">H</span>))).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.mask_disj">mask_disj</a></span> <span class="id">k</span> <span class="id">r1</span> <span class="id">r2</span>) <span class="kwd">as</span> (<span class="id">k1</span>&amp;<span class="id">k2</span>&amp;<span class="id">Heq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">k1</span>, <span class="id">k2</span>. <span class="tactic">split</span>; [|<span class="tactic">split</span>]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">H</span> ?. <span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">x</span>); <span class="tactic">simpl</span>; <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_toeq">sem_toeq</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cenv</span> <span class="id">out</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#L.global">L.global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">H</span> <span class="id">P</span> <span class="id">env</span> <span class="id">envo</span> <span class="id">xr</span> <span class="id">rs</span> <span class="id">r</span> <span class="id">eq</span> <span class="id">eq</span>' <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LN.NormFby.normalized_equation">LN.NormFby.normalized_equation</a></span> <span class="id">G</span> <span class="id">out</span> <span class="id">eq</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LT.wt_equation">LT.wt_equation</a></span> <span class="id">G</span> <span class="id">cenv</span> <span class="id">eq</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LC.wc_equation">LC.wc_equation</a></span> <span class="id">G</span> <span class="id">cenv</span> <span class="id">eq</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LC.wc_global">LC.wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#TR.envs_eq">envs_eq</a></span> <span class="id">env</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Senv.idck">idck</a></span> <span class="id">cenv</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_node_ck">LCS.sem_node_ck</a></span> <span class="id">G</span> <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_node">NLSC.sem_node</a></span> <span class="id">P</span> <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sc_vars">LCS.sc_vars</a></span> <span class="id">cenv</span> <span class="id">H</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">xr</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">xr</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Senv.idck">idck</a></span> <span class="id">cenv</span>)) <span class="id">xr</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_equation">to_equation</a></span> <span class="id">env</span> <span class="id">envo</span> <span class="id">xr</span> <span class="id">eq</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">eq</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var">sem_var</a></span> <span class="id">H</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Transcription.Correctness.html#LS.Var">LS.Var</a></span> <span class="id">x</span>) <span class="id">xr</span>) <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.bools_ofs">bools_ofs</a></span> <span class="id">rs</span> <span class="id">r</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_equation_ck">LCS.sem_equation_ck</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>) <span class="id">eq</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_equation">NLSC.sem_equation</a></span> <span class="id">P</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> <span class="id">H</span>) <span class="id">b</span> <span class="id">eq</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?????????? [<span class="id">xs</span> [|<span class="id">e</span> []]] <span class="id">eq</span>' <span class="id">b</span> <span class="id">Hnormed</span> <span class="id">Hwt</span> <span class="id">Hwc</span> <span class="id">Hwcg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Henvs</span> <span class="id">Hsemnode</span> <span class="id">Hvar</span> <span class="id">Hxr</span> <span class="id">Htoeq</span> <span class="id">Hsxr</span> <span class="id">Hbools</span> <span class="id">Hsem</span>; <span class="tactic">try</span> <span class="id">now</span> (<span class="id">inv</span> <span class="id">Htoeq</span>; <span class="id">cases</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hwt</span> <span class="kwd">as</span> (<span class="id">Hwt1</span>&amp;<span class="id">Hwt2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1-6,10-12:(<span class="id">inv</span> <span class="id">Hwc</span>; <span class="id">inv</span> <span class="id">Hnormed</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">simpl_Foralls</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *; <span class="tactic">subst</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1-9:(<span class="id">monadInv</span> <span class="id">Htoeq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_toeq_normalized">sem_toeq_normalized</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">erewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.envs_eq_find">envs_eq_find</a></span> <span class="kwd">in</span> <span class="id">EQ</span>; <span class="tactic">eauto</span>; <span class="id">inv</span> <span class="id">EQ</span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H7</span>; <span class="id">solve_In</span>; <span class="tactic">congruence</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;extcall&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="id">inv</span> <span class="id">Hwc</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">Htoeq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">v</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var">sem_var</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.Var">LS.Var</a></span> <span class="id">x</span>) <span class="id">v</span>) <span class="kwd">as</span> (<span class="id">v</span>&amp;<span class="id">Hvar</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">specialize</span> (<span class="id">Hsem</span> 0). <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_mask_inv">sem_var_mask_inv</a></span> <span class="kwd">in</span> <span class="id">H5</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. 2:<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_history">LS.sem_var_history</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_arhs_mask">sem_arhs_mask</a></span> <span class="kwd">with</span> (<span class="id">r</span>:=<span class="id">r</span>). <span class="tactic">intros</span> <span class="id">k</span>. <span class="tactic">specialize</span> (<span class="id">Hsem</span> <span class="id">k</span>). <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">simpl_Foralls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_mask_inv">sem_var_mask_inv</a></span> <span class="kwd">in</span> <span class="id">H5</span> <span class="kwd">as</span> (?&amp;<span class="id">Hvar2</span>&amp;<span class="id">Heq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_det">sem_var_det</a></span> <span class="kwd">in</span> <span class="id">Hvar</span>'; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">Heq</span>, <span class="id">Hvar</span>' <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sc_exp">sc_exp</a></span> <span class="kwd">in</span> <span class="id">H10</span> <span class="kwd">as</span> <span class="id">Hsemck</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sc_vars_mask">LCS.sc_vars_mask</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_rhs_arhs">sem_rhs_arhs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LT.wt_exp">LT.wt_exp</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">sem_exp_ck</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#mmap_inversion">mmap_inversion</a></span> <span class="kwd">in</span> <span class="id">EQ</span>. <span class="tactic">clear</span> - <span class="id">EQ</span> <span class="id">H8</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">tyins0</span> <span class="id">H15</span>. <span class="tactic">induction</span> <span class="id">EQ</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">intros</span> * <span class="id">Htys</span>; <span class="id">inv</span> <span class="id">H8</span>. <span class="id">inv</span> <span class="id">Htys</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.ty_lexp">ty_lexp</a></span> <span class="kwd">in</span> <span class="id">H</span>; [|<span class="tactic">eauto</span>]. <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Htys</span>. <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_exps_lexps">sem_exps_lexps</a></span> <span class="kwd">in</span> <span class="id">H18</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;EFby&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwc</span>; <span class="id">simpl_Foralls</span>. <span class="tactic">rename</span> <span class="id">H2</span> <span class="id">into</span> <span class="id">Hwt</span>. <span class="tactic">rename</span> <span class="id">H4</span> <span class="id">into</span> <span class="id">Hwc</span>. <span class="tactic">rename</span> <span class="id">H3</span> <span class="id">into</span> <span class="id">Hf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Htoeq</span> <span class="kwd">as</span> [<span class="id">Heq</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases</span>; <span class="id">monadInv</span> <span class="id">Heq</span>'. <span class="tactic">rename</span> <span class="id">x1</span> <span class="id">into</span> <span class="id">ck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">y</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var">sem_var</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.Var">LS.Var</a></span> <span class="id">i</span>) <span class="id">y</span>) <span class="kwd">as</span> (<span class="id">y</span>&amp;<span class="id">Hv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">Hsem</span>':=<span class="id">Hsem</span>). <span class="tactic">specialize</span> (<span class="id">Hsem</span>' 0). <span class="id">inv</span> <span class="id">Hsem</span>'. <span class="id">inv</span> <span class="id">H6</span>; <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_mask_inv">sem_var_mask_inv</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">v</span>, <span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_aexp">NLSC.sem_aexp</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>)) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>) <span class="id">ck</span> <span class="id">x2</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Transcription.Correctness.html#LS.fby">LS.fby</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val">NCor.const_val</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.abstract_clock">abstract_clock</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>)) (<span class="id"><a href="Velus.Transcription.Correctness.html#OpAux.sem_const">sem_const</a></span> <span class="id">x0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">y</span>)) <span class="kwd">as</span> (<span class="id">v</span>&amp;<span class="id">Hsel</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.consolidate_mask">consolidate_mask</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">k</span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_aexp">NLSC.sem_aexp</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>)) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>) <span class="id">ck</span> <span class="id">x2</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Transcription.Correctness.html#LS.fby">LS.fby</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.const_val">NCor.const_val</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.abstract_clock">abstract_clock</a></span> <span class="id">v</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#OpAux.sem_const">sem_const</a></span> <span class="id">x0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">v</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span> ?????? (?&amp;?); <span class="tactic">subst</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_aexp_morph">NLSC.sem_aexp_morph</a></span>; <span class="tactic">eauto</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;-<span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">k</span>. <span class="tactic">specialize</span> (<span class="id">Hsem</span> <span class="id">k</span>). <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">inv</span> <span class="id">Hwt</span>. <span class="id">simpl_Foralls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">sem_exp_ck</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>; <span class="id">simpl_Foralls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H24</span>; <span class="id">inv</span> <span class="id">H21</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_exp_lexp">sem_exp_lexp</a></span> <span class="kwd">in</span> <span class="id">EQ2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">y2</span> = <span class="id">ck</span>); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.envs_eq_find">envs_eq_find</a></span> <span class="kwd">in</span> <span class="id">EQ0</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">EQ0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H16</span>; <span class="id">solve_In</span>; <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_clock">sem_clock</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>)) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>) <span class="id">ck</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.abstract_clock">abstract_clock</a></span> <span class="id">y1</span>)) <span class="kwd">as</span> <span class="id">Hck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">Hnormed</span>. 2:{ <span class="id">inv</span> <span class="id">H3</span>; <span class="id">inv</span> <span class="id">H0</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sc_exp">sc_exp</a></span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sc_vars_mask">LCS.sc_vars_mask</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">simpl_Foralls</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_lexp_laexp">sem_lexp_laexp</a></span> <span class="kwd">in</span> <span class="id">EQ2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.to_constant_sem">to_constant_sem</a></span> <span class="kwd">in</span> <span class="id">EQ1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_eq">Forall2_eq</a></span> <span class="kwd">in</span> <span class="id">H7</span>. <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">EQ1</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hmask</span>:=<span class="id">EQ2</span>). <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_laexp_mask_inv">sem_laexp_mask_inv</a></span> <span class="kwd">in</span> <span class="id">Hmask</span> <span class="kwd">as</span> (?&amp;<span class="id">Hmask</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hmask</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_mask">sem_var_mask</a></span> <span class="kwd">in</span> <span class="id">Hv</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_det">sem_var_det</a></span> <span class="kwd">in</span> <span class="id">H14</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">H14</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_aexp_mask">sem_aexp_mask</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">Hsel</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_history">LS.sem_var_history</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>. <span class="tactic">intros</span> (?&amp;?) <span class="id">Hin</span>. <span class="id">simpl_Forall</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore2">Forall2_ignore2</a></span> <span class="kwd">in</span> <span class="id">Hsxr</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var">sem_var</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> (<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_history">LS.sem_var_history</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> <span class="id">Var</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hvar</span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> <span class="id">Hck</span>; [|<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">intros</span> ? <span class="id">Hsemv</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_det">sem_var_det</a></span> <span class="kwd">in</span> <span class="id">Var</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">Var</span>'. <span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_aligned">ac_aligned</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.fby_reset_fby">fby_reset_fby</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_history">LS.sem_var_history</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">k</span>. <span class="tactic">eapply</span> <span class="id">Hsel</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;EArrow&nbsp;*)</span> <span class="id">inv</span> <span class="id">Hnormed</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Eapp&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LN.Unnesting.normalized_lexp">LN.Unnesting.normalized_lexp</a></span> <span class="id">l</span>) <span class="kwd">as</span> <span class="id">Hnormed</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span> - <span class="id">Hnormed</span>. <span class="id">inv</span> <span class="id">Hnormed</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Htoeq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#TR.vars_of">vars_of</a></span> <span class="id">l0</span>) <span class="id">eqn</span>:<span class="id">Vars</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.vars_of_spec">vars_of_spec</a></span> <span class="kwd">in</span> <span class="id">Vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">cases</span>; <span class="id">monadInv</span> <span class="id">Htoeq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">ys</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var">sem_var</a></span> <span class="id">H</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.Var">LS.Var</a></span> <span class="id">xs</span>) <span class="id">ys</span>) <span class="kwd">as</span> (<span class="id">ys</span>&amp;<span class="id">Hv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">Hsem</span>':=<span class="id">Hsem</span>). <span class="tactic">specialize</span> (<span class="id">Hsem</span>' 0). <span class="id">inv</span> <span class="id">Hsem</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (@<span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_vars_mask_inv">LS.sem_vars_mask_inv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.lustre_var">LS.lustre_var</a></span>) <span class="kwd">as</span> (?&amp;?&amp;?); [|<span class="tactic">eauto</span>]. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">vs</span>, <span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>)) <span class="id">l</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span>)) <span class="id">vs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">ess</span>&amp;<span class="id">Hse</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">vs</span>, <span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">e</span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>) <span class="id">e</span> [<span class="id">v</span>]) <span class="id">l</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span>) <span class="id">vs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">ess</span>&amp;<span class="id">Hse</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">Forall2_forall</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">P</span> := <span class="kwd">fun</span> <span class="id">k</span> <span class="id">e</span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>) <span class="id">e</span> [<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.Forall_Forall2">Forall_Forall2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.consolidate_mask">consolidate_mask</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">k</span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_exp_ck">LCS.sem_exp_ck</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>) <span class="id">x0</span> [<span class="id">v</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span> ????? <span class="id">Heq</span> ?; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Heq</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">k</span>. <span class="tactic">specialize</span> (<span class="id">Hsem</span> <span class="id">k</span>). <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">simpl_Foralls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore2">Forall2_ignore2</a></span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_normalized_lexp_mask_inv">sem_normalized_lexp_mask_inv</a></span> <span class="kwd">in</span> <span class="id">Hnormed</span>' <span class="kwd">as</span> (?&amp;<span class="id">Heq</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; [<span class="id">x</span>]) <span class="id">ess</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">k</span>. <span class="tactic">specialize</span> (<span class="id">Hse</span> <span class="id">k</span>). <span class="id">simpl_Forall</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">vr</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var">sem_var</a></span> <span class="id">H</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Transcription.Correctness.html#LS.Var">LS.Var</a></span> <span class="id">x</span>) <span class="id">l2</span>) <span class="id">vr</span>') <span class="kwd">as</span> (<span class="id">vr</span>'&amp;<span class="id">Hvr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span> - <span class="id">Vars</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.Forall_Forall2">Forall_Forall2</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>; <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="tactic">intros</span> (?&amp;?) <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hsem</span> 0). <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">simpl_Foralls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_trans_ex">Forall2_trans_ex</a></span> <span class="kwd">in</span> <span class="id">Vars</span>; [|<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_swap_args">Forall2_swap_args</a></span>, <span class="id">H11</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore1">Forall2_ignore1</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Vars</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp;?&amp;<span class="id">Hs</span>&amp;<span class="id">Hx</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hx</span> <span class="kwd">as</span> (?&amp;?); <span class="tactic">subst</span>. <span class="id">inv</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_mask_inv">sem_var_mask_inv</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">sr</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.bools_of">bools_of</a></span> <span class="id">vr</span>' <span class="id">sr</span>') <span class="kwd">as</span> (<span class="id">sr</span>'&amp;<span class="id">Hbools2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span> - <span class="id">Vars</span> <span class="id">Hsem</span> <span class="id">Hvr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.Forall_Forall2">Forall_Forall2</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="tactic">intros</span> <span class="id">v</span>' <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#Str.bools_of_mask">bools_of_mask</a></span> <span class="kwd">with</span> (<span class="id">rs</span>:=<span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.consolidate_mask">consolidate_mask</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">k</span> <span class="id">sr</span> =&gt; <span class="id"><a href="Velus.Transcription.Correctness.html#Str.bools_of">bools_of</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">v</span>') <span class="id">sr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span> ????? <span class="id">Heq</span> ?; <span class="tactic">subst</span>. <span class="id">now</span> <span class="tactic">rewrite</span> &lt;-<span class="id">Heq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span> <span class="kwd">in</span> <span class="id">Hvr</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore1">Forall2_ignore1</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hvr</span> <span class="kwd">as</span> ((?&amp;?)&amp;<span class="id">Hin</span>'&amp;<span class="id">Hvar</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hsem</span> <span class="id">k</span>). <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">simpl_Foralls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">inversion</span> <span class="id">H12</span> <span class="kwd">as</span> (?&amp;<span class="id">Hbools</span>'&amp;<span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_trans_ex">Forall2_trans_ex</a></span> <span class="kwd">in</span> <span class="id">Vars</span>; [|<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_swap_args">Forall2_swap_args</a></span>, <span class="id">H11</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore1">Forall2_ignore1</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Vars</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp;?&amp;<span class="id">Hs</span>&amp;<span class="id">Hx</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hx</span> <span class="kwd">as</span> (?&amp;?); <span class="tactic">subst</span>. <span class="id">inv</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_mask">sem_var_mask</a></span> <span class="kwd">with</span> (<span class="id">r</span>:=<span class="id">r</span>) (<span class="id">k</span>:=<span class="id">k</span>) <span class="kwd">in</span> <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_det">sem_var_det</a></span> <span class="kwd">in</span> <span class="id">Hvar</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H12</span> <span class="kwd">as</span> (?&amp;<span class="id">Hbools</span>&amp;<span class="id">_</span>). <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore2">Forall2_ignore2</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hbools</span> <span class="kwd">as</span> (?&amp;?&amp;<span class="id">Hbools</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hvar</span> <span class="kwd">in</span> <span class="id">Hbools</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hbm</span>:=<span class="id">Hbools</span>). <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.bools_of_mask_inv">bools_of_mask_inv</a></span> <span class="kwd">in</span> <span class="id">Hbm</span> <span class="kwd">as</span> (<span class="id">v</span>&amp;<span class="id">Heq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">Hbools</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hbools</span> <span class="kwd">as</span> (?&amp;<span class="id">Hbools1</span>&amp;<span class="id">Hdisj</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>. <span class="tactic">instantiate</span> (1:=(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">ess</span>)). 6:<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_lexps_mask">sem_lexps_mask</a></span>. <span class="tactic">intros</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hse</span> <span class="id">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_exps_lexps">sem_exps_lexps</a></span> <span class="kwd">in</span> <span class="id">Hse</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#concat_map">concat_map</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span> <span class="kwd">in</span> <span class="id">Hse</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Foralls</span>. <span class="id">inv</span> <span class="id">H2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_clock_unmask">LCS.sem_clock_unmask</a></span> <span class="kwd">with</span> (<span class="id">r</span>:=<span class="id">r</span>). <span class="tactic">intros</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hse</span> <span class="id">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sc_exps">sc_exps</a></span> <span class="kwd">in</span> <span class="id">Hse</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sc_vars_mask">LCS.sc_vars_mask</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">inv</span> <span class="id">Hwc</span>; <span class="tactic">auto</span>. <span class="id">simpl_Foralls</span>. <span class="id">inv</span> <span class="id">H4</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">n</span> <span class="id">bck</span> <span class="id">sub</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#L.find_node">L.find_node</a></span> <span class="id">i</span> <span class="id">G</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LC.WellInstantiated">LC.WellInstantiated</a></span> <span class="id">bck</span> <span class="id">sub</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) (<span class="id"><a href="Velus.Transcription.Correctness.html#L.n_in">L.n_in</a></span> <span class="id">n</span>)) (<span class="id"><a href="Velus.Transcription.Correctness.html#L.nclocksof">L.nclocksof</a></span> <span class="id">l</span>)) <span class="kwd">as</span> (<span class="id">n</span>&amp;<span class="id">bck</span>&amp;?&amp;<span class="id">Hfind</span>&amp;<span class="id">WIi</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">Hwc</span>; <span class="tactic">eauto</span>. <span class="id">simpl_Foralls</span>. <span class="id">inv</span> <span class="id">H4</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#L.find_node">L.find_node</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span>) <span class="id">and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LC.wc_find_node">LC.wc_find_node</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">n</span> <span class="id">Hwcg</span> <span class="id">it</span>) <span class="kwd">as</span> (?&amp; <span class="id">Wc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Wc</span> <span class="kwd">as</span> [?? <span class="id">Wcin</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#TR.find_base_clock">find_base_clock</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#L.clocksof">L.clocksof</a></span> <span class="id">l</span>) = <span class="id">bck</span>) <span class="kwd">as</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.find_base_clock_bck">find_base_clock_bck</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#L.clocksof_nclocksof">L.clocksof_nclocksof</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LC.WellInstantiated_bck">LC.WellInstantiated_bck</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>. <span class="tactic">exact</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#L.n_ingt0">L.n_ingt0</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LC.WellInstantiated_parent">LC.WellInstantiated_parent</a></span> <span class="kwd">in</span> <span class="id">WIi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#L.clocksof_nclocksof">L.clocksof_nclocksof</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="tactic">eauto</span>. <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sc_parent">LCS.sc_parent</a></span> <span class="kwd">with</span> (<span class="id">ck</span> := <span class="id">bck</span>) <span class="kwd">in</span> <span class="id">Hse</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#concat_map">concat_map</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.clocks_of_mask">clocks_of_mask</a></span> <span class="kwd">in</span> <span class="id">Hse</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#L.clocksof_nclocksof">L.clocksof_nclocksof</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LC.WellInstantiated_bck">LC.WellInstantiated_bck</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>. <span class="tactic">exact</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#L.n_ingt0">L.n_ingt0</a></span> <span class="id">n</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LC.WellInstantiated_parent">LC.WellInstantiated_parent</a></span> <span class="kwd">in</span> <span class="id">WIi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#L.clocksof_nclocksof">L.clocksof_nclocksof</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="tactic">eauto</span>. <span class="id">now</span> <span class="tactic">simpl</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2_app">Forall2_app</a></span> <span class="kwd">with</span> (<span class="id">l1</span>':=<span class="id">rs</span>) (<span class="id">l2</span>':=<span class="id">vr</span>'); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">simpl_Forall</span>; <span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_history">LS.sem_var_history</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">do</span> 2 <span class="tactic">econstructor</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2_app">Forall2_app</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str_app">disj_str_app</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.disj_str_comm">disj_str_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (@<span class="id">mask_disj</span>' <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str">disj_str</a></span> <span class="id">sr</span>') (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str">disj_str</a></span> <span class="id">x0</span>)) <span class="kwd">as</span> (<span class="id">k2</span>&amp;<span class="id">k1</span>&amp;(<span class="id">Hmask</span>&amp;<span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hsem</span> <span class="id">k1</span>). <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">simpl_Foralls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H3</span>. <span class="tactic">specialize</span> (<span class="id">H14</span> <span class="id">k2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">bs</span> ≡ (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k1</span> <span class="id">r</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str">disj_str</a></span> <span class="id">sr</span>'))) <span class="kwd">as</span> <span class="id">Hbs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.bools_ofs_det">bools_ofs_det</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">split</span>. 2:<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.disj_str_maskb">disj_str_maskb</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.EqSts">EqSts</a></span> <span class="id">rs0</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k1</span> <span class="id">r</span>) <span class="id">vr</span>')) <span class="kwd">as</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">clear</span> -<span class="id">Hbools2</span> <span class="id">Heq</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.EqSts">EqSts</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_trans_ex">Forall2_trans_ex</a></span> <span class="kwd">in</span> <span class="id">Hbools2</span>; [|<span class="tactic">eapply</span> <span class="id">Heq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>]. <span class="tactic">intros</span> ?? <span class="id">_</span> <span class="id">_</span> (?&amp;?&amp;<span class="id">Heq</span>'&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heq</span>'; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.bools_of_mask">bools_of_mask</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hvr</span> <span class="id">Hbools2</span> <span class="id">H12</span> <span class="id">Vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_trans_ex">Forall2_trans_ex</a></span> <span class="kwd">in</span> <span class="id">Vars</span>; [|<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_swap_args">Forall2_swap_args</a></span>, <span class="id">H12</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.EqSts">EqSts</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span> <span class="kwd">in</span> <span class="id">Hvr</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.EqSts">EqSts</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_trans_ex">Forall2_trans_ex</a></span> <span class="kwd">in</span> <span class="id">Hvr</span>; [|<span class="tactic">eapply</span> <span class="id">Vars</span>]. <span class="tactic">clear</span> - <span class="id">Hvr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>]. <span class="tactic">intros</span> ?? <span class="id">_</span> <span class="id">_</span> ((?&amp;?)&amp;<span class="id">_</span>&amp;(?&amp;<span class="id">_</span>&amp;?&amp;(?&amp;?))&amp;?); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_mask">sem_var_mask</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_det">sem_var_det</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.mod_sem_node_morph_Proper">NLSC.mod_sem_node_morph_Proper</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3:(<span class="tactic">eapply</span> <span class="id">Hsemnode</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">specialize</span> (<span class="id">Hse</span> <span class="id">k1</span>). <span class="tactic">clear</span> - <span class="id">Hwcg</span> <span class="id">Hnormed</span>' <span class="id">Hmask</span> <span class="id">Hse</span> <span class="id">H10</span> <span class="id">Hbs</span> <span class="id">Hdisj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.EqSts">EqSts</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">ss</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k1</span> <span class="id">r</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">ess</span>))) <span class="kwd">as</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_swap_args">Forall2_swap_args</a></span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_trans_ex">Forall2_trans_ex</a></span> <span class="kwd">in</span> <span class="id">Hse</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.EqSts">EqSts</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span> <span class="kwd">in</span> <span class="id">Hse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_concat">Forall2_concat</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>]. <span class="tactic">intros</span> ?? <span class="id">_</span> <span class="id">_</span> (?&amp;<span class="id">Hin</span>&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hnormed</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_normalized_lexp_det">sem_normalized_lexp_det</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hmask</span> <span class="id">Heq</span> <span class="id">Hbs</span> <span class="id">Hdisj</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.EqSts">EqSts</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span> ?? <span class="id">_</span> <span class="id">_</span> <span class="id">Heq</span>'; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Heq</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hmask</span>, <span class="id">Heq</span>', <span class="id">Hbs</span>, <span class="id">Hdisj</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">clear</span> - <span class="id">Hmask</span> <span class="id">Hv</span> <span class="id">H6</span> <span class="id">Hbs</span> <span class="id">Hdisj</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.EqSts">EqSts</a></span> <span class="id">y</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k1</span> <span class="id">r</span>) <span class="id">ys</span>)) <span class="kwd">as</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">simpl_Forall</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_swap_args">Forall2_swap_args</a></span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_trans_ex">Forall2_trans_ex</a></span> <span class="kwd">in</span> <span class="id">Hv</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.EqSts">EqSts</a></span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_mask">sem_var_mask</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_det">sem_var_det</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hmask</span> <span class="id">Heq</span> <span class="id">Hbs</span> <span class="id">Hdisj</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.EqSts">EqSts</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span> ?? <span class="id">_</span> <span class="id">_</span> <span class="id">Heq</span>'; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Heq</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hmask</span>, <span class="id">Heq</span>', <span class="id">Hbs</span>, <span class="id">Hdisj</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_history">LS.sem_var_history</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_blocktoeq">sem_blocktoeq</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cenv</span> <span class="id">out</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#L.global">L.global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">H</span> <span class="id">P</span> <span class="id">env</span> <span class="id">envo</span> <span class="id">bck</span> <span class="id">xr</span> <span class="id">rs</span> <span class="id">r</span> <span class="id">eqs</span>' <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LN.NormFby.normalized_block">LN.NormFby.normalized_block</a></span> <span class="id">G</span> <span class="id">out</span> <span class="id">bck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LT.wt_block">LT.wt_block</a></span> <span class="id">G</span> <span class="id">cenv</span> <span class="id">bck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LC.wc_block">LC.wc_block</a></span> <span class="id">G</span> <span class="id">cenv</span> <span class="id">bck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LC.wc_global">LC.wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#TR.envs_eq">envs_eq</a></span> <span class="id">env</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Senv.idck">idck</a></span> <span class="id">cenv</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_node_ck">LCS.sem_node_ck</a></span> <span class="id">G</span> <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_node">NLSC.sem_node</a></span> <span class="id">P</span> <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sc_vars">LCS.sc_vars</a></span> <span class="id">cenv</span> <span class="id">H</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">xr0</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">xr0</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Senv.idck">idck</a></span> <span class="id">cenv</span>)) <span class="id">xr</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#TR.block_to_equation">block_to_equation</a></span> <span class="id">env</span> <span class="id">envo</span> <span class="id">xr</span> <span class="id">bck</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">eqs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var">sem_var</a></span> <span class="id">H</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Transcription.Correctness.html#LS.Var">LS.Var</a></span> <span class="id">x</span>) <span class="id">xr</span>) <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Str.bools_ofs">bools_ofs</a></span> <span class="id">rs</span> <span class="id">r</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_block_ck">LCS.sem_block_ck</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist">mask_hist</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">H</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb">maskb</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">b</span>) <span class="id">bck</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_equation">NLSC.sem_equation</a></span> <span class="id">P</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> <span class="id">H</span>) <span class="id">b</span> <span class="id">eqs</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bck</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#L.block_ind2">L.block_ind2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnormed</span> <span class="id">Hwt</span> <span class="id">Hwc</span> <span class="id">HwcG</span> <span class="id">Henvs</span> <span class="id">Hsemnode</span> <span class="id">Hinv</span> <span class="id">Hxr</span> <span class="id">Heqs</span> <span class="id">Hsxr</span> <span class="id">Hbools</span> <span class="id">Hsem</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hnormed</span>; <span class="id">inv</span> <span class="id">Hwt</span>; <span class="id">inv</span> <span class="id">Hwc</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">cases</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;eq&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_toeq">sem_toeq</a></span> <span class="kwd">in</span> <span class="id">Heqs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">k</span>. <span class="tactic">specialize</span> (<span class="id">Hsem</span> <span class="id">k</span>). <span class="id">inv</span> <span class="id">Hsem</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Foralls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">vr</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var">sem_var</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.Var">LS.Var</a></span> <span class="id">x</span>) <span class="id">vr</span>) <span class="kwd">as</span> (<span class="id">vr</span>&amp;<span class="id">Hx</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">Hsem0</span> := <span class="id">Hsem</span> 0). <span class="id">inv</span> <span class="id">Hsem0</span>. <span class="id">inv</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_mask_inv">sem_var_mask_inv</a></span> <span class="kwd">in</span> <span class="id">H13</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">sr</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Str.bools_of">bools_of</a></span> <span class="id">vr</span> <span class="id">sr</span>) <span class="kwd">as</span> (?&amp;<span class="id">Hbool</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">setoid_rewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#Str.bools_of_mask">bools_of_mask</a></span> <span class="kwd">with</span> (<span class="id">rs</span>:=<span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.consolidate_mask">consolidate_mask</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">k</span> <span class="id">sr</span> =&gt; <span class="id"><a href="Velus.Transcription.Correctness.html#Str.bools_of">bools_of</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskv">maskv</a></span> <span class="id">k</span> <span class="id">r</span> <span class="id">vr</span>) <span class="id">sr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span> ????? <span class="id">Heq</span> ?; <span class="tactic">subst</span>. <span class="id">now</span> <span class="tactic">rewrite</span> &lt;-<span class="id">Heq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_mask">sem_var_mask</a></span> <span class="kwd">with</span> (<span class="id">r</span>:=<span class="id">r</span>) (<span class="id">k</span>:=<span class="id">k</span>) <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hsem</span> <span class="id">k</span>). <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">simpl_Foralls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H11</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_det">sem_var_det</a></span> <span class="kwd">in</span> <span class="id">Hx</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">Hx</span> <span class="kwd">in</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hbool</span>:=<span class="id">H14</span>). <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.bools_of_mask_inv">bools_of_mask_inv</a></span> <span class="kwd">in</span> <span class="id">H14</span> <span class="kwd">as</span> (?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">Hbool</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hbools</span> <span class="kwd">as</span> (?&amp;<span class="id">Hbools</span>'&amp;<span class="id">Hdisj</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">Heqs</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>; <span class="tactic">clear</span> <span class="id">H4</span>. 1,2:<span class="tactic">econstructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H9</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (@<span class="id">mask_disj</span>' <span class="id"><a href="Velus.Transcription.Correctness.html#LS.lustre_var">LS.lustre_var</a></span> <span class="id">k</span> <span class="id">x0</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str">disj_str</a></span> <span class="id">x1</span>)) <span class="kwd">as</span> (<span class="id">k1</span>&amp;<span class="id">k2</span>&amp;<span class="id">Hxs</span>&amp;<span class="id">Hbs</span>&amp;<span class="id">HH</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_block_ck_morph">sem_block_ck_morph</a></span>; <span class="tactic">simpl</span>. 3:<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str_cons">disj_str_cons</a></span>; <span class="tactic">symmetry</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.disj_str_cons">disj_str_cons</a></span>; <span class="tactic">symmetry</span>; <span class="tactic">apply</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hsem</span> <span class="id">k2</span>). <span class="id">inv</span> <span class="id">Hsem</span>. <span class="id">simpl_Foralls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">H14</span> <span class="id">k1</span>). <span class="id">simpl_Foralls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H4</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_mask">sem_var_mask</a></span> <span class="kwd">in</span> <span class="id">Hx</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_det">sem_var_det</a></span> <span class="kwd">in</span> <span class="id">H14</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">H14</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.bools_of_mask_det">bools_of_mask_det</a></span> <span class="kwd">in</span> <span class="id">H13</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_block_ck_morph">sem_block_ck_morph</a></span>. 3,4:<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">rewrite</span> <span class="id">H13</span>, <span class="id">Hdisj</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.sem_blockstoeqs">sem_blockstoeqs</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cenv</span> <span class="id">out</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#L.global">L.global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">H</span> <span class="id">P</span> <span class="id">env</span> <span class="id">envo</span> <span class="id">bcks</span> <span class="id">eqs</span>' <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LN.NormFby.normalized_block">LN.NormFby.normalized_block</a></span> <span class="id">G</span> <span class="id">out</span>) <span class="id">bcks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LT.wt_block">LT.wt_block</a></span> <span class="id">G</span> <span class="id">cenv</span>) <span class="id">bcks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LC.wc_block">LC.wc_block</a></span> <span class="id">G</span> <span class="id">cenv</span>) <span class="id">bcks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LC.wc_global">LC.wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#TR.envs_eq">envs_eq</a></span> <span class="id">env</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Senv.idck">idck</a></span> <span class="id">cenv</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_node_ck">LCS.sem_node_ck</a></span> <span class="id">G</span> <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_node">NLSC.sem_node</a></span> <span class="id">P</span> <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sc_vars">LCS.sc_vars</a></span> <span class="id">cenv</span> <span class="id">H</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#mmap">mmap</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#TR.block_to_equation">block_to_equation</a></span> <span class="id">env</span> <span class="id">envo</span> []) <span class="id">bcks</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">eqs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_block_ck">LCS.sem_block_ck</a></span> <span class="id">G</span> <span class="id">H</span> <span class="id">b</span>) <span class="id">bcks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_equation">NLSC.sem_equation</a></span> <span class="id">P</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> <span class="id">H</span>) <span class="id">b</span>) <span class="id">eqs</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bcks</span>; <span class="tactic">intros</span> * <span class="id">Hnormed</span> <span class="id">Hwt</span> <span class="id">Hwc</span> <span class="id">HwcG</span> <span class="id">Henvs</span> <span class="id">Hsemnode</span> <span class="id">Hinv</span> <span class="id">Heqs</span> <span class="id">Hsem</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hnormed</span>; <span class="id">inv</span> <span class="id">Hwt</span>; <span class="id">inv</span> <span class="id">Hwc</span>; <span class="id">inv</span> <span class="id">Hsem</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">monadInv</span> <span class="id">Heqs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_blocktoeq">sem_blocktoeq</a></span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>; <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.bools_ofs_empty">bools_ofs_empty</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_block_ck_morph">sem_block_ck_morph</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist_false_0">mask_hist_false_0</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb_false_0">maskb_false_0</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_block_ck_morph">sem_block_ck_morph</a></span>. 3:<span class="tactic">eauto</span>. 3:<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_block_absent">LCS.sem_block_absent</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.mask_hist_false_S">mask_hist_false_S</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.maskb_false_S">maskb_false_S</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CORRECTNESS.inputs_clocked_vars">inputs_clocked_vars</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">n</span>: @<span class="id"><a href="Velus.Transcription.Correctness.html#L.node">L.node</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">H</span> <span class="id">ins</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var">sem_var</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.Var">LS.Var</a></span> <span class="id">x</span>)) (<span class="id"><a href="Velus.Transcription.Correctness.html#L.idents">L.idents</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#L.n_in">L.n_in</a></span> <span class="id">n</span>)) <span class="id">ins</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sc_vars">LCS.sc_vars</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#L.n_in">L.n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Transcription.Correctness.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#L.n_out">L.n_out</a></span> <span class="id">n</span>)) <span class="id">H</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.clocks_of">clocks_of</a></span> <span class="id">ins</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_clocked_vars">NLSC.sem_clocked_vars</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> <span class="id">H</span>) (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.clocks_of">clocks_of</a></span> <span class="id">ins</span>) (<span class="id"><a href="Velus.Common.Common.html#idck">Common.idck</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">Common.idty</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#L.n_in">L.n_in</a></span> <span class="id">n</span>))).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvs</span> (<span class="id">Hsc</span>&amp;<span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_clocked_vars">NLSC.sem_clocked_vars</a></span>. <span class="id">simpl_Forall</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore2">Forall2_ignore2</a></span> <span class="kwd">in</span> <span class="id">Hvs</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#L.idents">L.idents</a></span> <span class="kwd">in</span> *. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="id">solve_In</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="tactic">intros</span>; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_history">LS.sem_var_history</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_history">LS.sem_var_history</a></span>, <span class="id">Hsc</span> <span class="kwd">in</span> <span class="id">Hvar</span>; [|<span class="tactic">econstructor</span>; <span class="id">solve_In</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#or_introl">or_introl</a></span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.ac_aligned">ac_aligned</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="kwd">Import</span> <span class="id"><a name="CORRECTNESS.TrOrdered">TrOrdered</a></span> := <span class="id"><a href="Velus.Transcription.TrOrdered.html#TrOrderedFun">TrOrderedFun</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#CE">CE</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#NL">NL</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ord">Ord</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR">TR</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id"><a name="CORRECTNESS.sem_l_nl">sem_l_nl</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">G</span> <span class="id">P</span> <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LN.NormFby.normalized_global">LN.NormFby.normalized_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#Lord.Ordered_nodes">Lord.Ordered_nodes</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LT.wt_global">LT.wt_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LC.wc_global">LC.wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_global">to_global</a></span> <span class="id">G</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_node_ck">LCS.sem_node_ck</a></span> <span class="id">G</span> <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_node">NLSC.sem_node</a></span> <span class="id">P</span> <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">nodes</span> <span class="kwd">as</span> [|<span class="id">nd</span>]. <span class="id">now</span> <span class="tactic">inversion</span> 6.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnormed</span> <span class="id">Hord</span> <span class="id">Hwt</span> <span class="id">Hwc</span> <span class="id">Htr</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hwt</span> <span class="kwd">as</span> (<span class="id">Hbool</span>&amp;<span class="id">Hwt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hsem</span>' := <span class="id">Hsem</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hsem</span>' <span class="kwd">as</span> [? ? ? ? ? <span class="id">Hfind</span> <span class="id">Hins</span> <span class="id">Houts</span> ? <span class="id">Slast</span> <span class="id">Sblk</span> (<span class="id">Hdom</span>&amp;<span class="id">Hsc</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Lord.find_node_not_Is_node_in">Lord.find_node_not_Is_node_in</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hord</span> <span class="id">Hfind</span>) <span class="kwd">as</span> <span class="id">Hnini</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hnormed</span>. <span class="tactic">destruct</span> <span class="id">H2</span>. <span class="tactic">inversion_clear</span> <span class="id">H0</span> <span class="kwd">as</span> [??? <span class="id">Hblk</span> <span class="id">Hlocs</span> <span class="id">Hblks</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#L.n_syn">L.n_syn</a></span> <span class="id">n</span>) <span class="kwd">as</span> <span class="id">Hsyn</span>. <span class="tactic">inversion_clear</span> <span class="id">Hsyn</span> <span class="kwd">as</span> [?? <span class="id">Hsyn1</span> <span class="id">Hsyn2</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hwt</span> <span class="kwd">as</span> [|?? (?&amp;?)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hwc</span> <span class="kwd">as</span> [|?? (?&amp;?)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfind</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#ident_eq_dec">ident_eq_dec</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#L.n_name">L.n_name</a></span> <span class="id">nd</span>) <span class="id">f</span>); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#L.find_node_now">L.find_node_now</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hord</span>':=<span class="id">Hord</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hord</span> <span class="kwd">as</span> [|? ? <span class="id">Hord</span>'' <span class="id">Hnnblocks</span> <span class="id">Hnn</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">LCS.sem_node_ck_cons1</span>' <span class="kwd">in</span> <span class="id">Sblk</span> <span class="kwd">as</span> (<span class="id">Sblk</span>'&amp;<span class="id">_</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Htr</span>':=<span class="id">Htr</span>). <span class="id">monadInv</span> <span class="id">Htr</span>'; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">monadInv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_node_ck">LCS.sem_node_ck</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#L.Global">L.Global</a></span> <span class="id">types</span> <span class="id">externs</span> <span class="id">nodes</span>) <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_node">NLSC.sem_node</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#NL.Global">NL.Global</a></span> <span class="id">types</span> <span class="id">externs</span> <span class="id">x3</span>) <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span>) <span class="kwd">as</span> <span class="id">IHnds</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">IHnodes</span>; <span class="tactic">eauto</span>. <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_global">to_global</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">EQ</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LT.wt_node">LT.wt_node</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">inversion_clear</span> <span class="id">it</span> <span class="kwd">as</span> [?? <span class="id">Hwt1</span> <span class="id">Hwt2</span> <span class="id">Hwt3</span> <span class="id">_</span> <span class="id">Hwt4</span>]; <span class="tactic">subst</span> Γ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LC.wc_node">LC.wc_node</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">inversion_clear</span> <span class="id">it</span> <span class="kwd">as</span> [?? <span class="id">Hwc1</span> <span class="id">Hwc2</span> <span class="id">_</span> <span class="id">Hwc3</span>]; <span class="tactic">subst</span> Γ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#L.n_nodup">L.n_nodup</a></span> <span class="id">n</span>) <span class="kwd">as</span> (<span class="id">Hnd1</span>&amp;<span class="id">Hnd2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hblk</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">Hnd2</span>. <span class="id">inv</span> <span class="id">H8</span>. <span class="id">inv</span> <span class="id">Sblk</span>'. <span class="id">inv</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span> ⊑ <span class="id">H</span> + <span class="id">Hi</span>') <span class="kwd">as</span> <span class="id">Href</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.local_hist_dom_refines">LS.local_hist_dom_refines</a></span>. 3:<span class="tactic">eauto</span>. 1,2:<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv.IsVar_fst">IsVar_fst</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Senv.map_fst_senv_of_ins">map_fst_senv_of_ins</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sc_vars">sc_vars</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#L.n_in">L.n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Transcription.Correctness.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#L.n_out">L.n_out</a></span> <span class="id">n</span>)) (<span class="id">H</span> + <span class="id">Hi</span>') (<span class="id"><a href="Velus.Transcription.Correctness.html#Str.clocks_of">clocks_of</a></span> <span class="id">ins</span>)) <span class="kwd">as</span> <span class="id">Hsc</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">Hsc</span> <span class="kwd">as</span> (<span class="id">Hsc1</span>&amp;<span class="id">_</span>). <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> * <span class="id">Hck</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_clock_refines">LS.sem_clock_refines</a></span>, <span class="id">Hsc1</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history_refines">LS.var_history_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hck</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str.sem_var_union">sem_var_union</a></span> <span class="kwd">in</span> <span class="id">Hv</span> <span class="kwd">as</span> [<span class="id">Hv</span>|<span class="id">Hv</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_In">LS.sem_var_In</a></span>, <span class="id">H8</span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Senv.IsVar_senv_of_decls">IsVar_senv_of_decls</a></span> <span class="kwd">in</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H12</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#Senv.map_fst_senv_of_ins">map_fst_senv_of_ins</a></span>, &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>, &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> * <span class="id">_</span> <span class="id">Hl</span>. <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv.NoLast_app">NoLast_app</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv.senv_of_ins_NoLast">senv_of_ins_NoLast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hsyn1</span>. <span class="tactic">intros</span> * <span class="id">L</span>. <span class="id">inv</span> <span class="id">L</span>. <span class="id">simpl_In</span>. <span class="id">simpl_Forall</span>. <span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.SNode">NLSC.SNode</a></span> <span class="kwd">with</span> (<span class="id">H</span>:=<span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history">LS.var_history</a></span> (<span class="id">H</span> + <span class="id">Hi</span>')); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id"><a href="Velus.Transcription.Correctness.html#NL.find_node_now">NL.find_node_now</a></span>; <span class="tactic">eauto</span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_node_name">to_node_name</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> &lt;- <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_node_in">to_node_in</a></span>, <span class="id"><a href="Velus.Common.Common.html#map_fst_idty">map_fst_idty</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_refines">LS.sem_var_refines</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_history">LS.sem_var_history</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history_refines">LS.var_history_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> &lt;- <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_node_out">to_node_out</a></span>, 2 <span class="id"><a href="Velus.Common.Common.html#map_fst_idty">map_fst_idty</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_refines">LS.sem_var_refines</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_history">LS.sem_var_history</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.var_history_refines">LS.var_history_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> &lt;- <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_node_in">to_node_in</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.inputs_clocked_vars">inputs_clocked_vars</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#L.idents">L.idents</a></span>. <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS.sem_var_refines">LS.sem_var_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_equation_cons2">NLSC.sem_equation_cons2</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.ord_l_nl">ord_l_nl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">assert</span> (<span class="id">Htrn</span>' := <span class="id">EQ0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_node_name">to_node_name</a></span> <span class="kwd">in</span> <span class="id">EQ0</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">EQ0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.ninin_l_nl">ninin_l_nl</a></span>; <span class="tactic">eauto</span>. <span class="id">contradict</span> <span class="id">Hnini</span>. <span class="tactic">right</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tonodeInv</span> <span class="id">EQ0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.sem_blockstoeqs">sem_blockstoeqs</a></span> <span class="kwd">with</span> (<span class="id">cenv</span>:=<span class="id"><a href="Velus.Transcription.Correctness.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#L.n_in">L.n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Transcription.Correctness.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Transcription.Correctness.html#L.n_out">L.n_out</a></span> <span class="id">n</span>) ++ <span class="id">_</span>). 1-9:<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5:{ <span class="tactic">clear</span> <span class="id">Htr</span>. <span class="tactic">rewrite</span> <span class="id">Hblk</span> <span class="kwd">in</span> <span class="id">Hmmap</span>. <span class="id">monadInv</span> <span class="id">Hmmap</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">Hwt4</span>. <span class="id">inv</span> <span class="id">H10</span>. <span class="tactic">subst</span> Γ'. <span class="id">simpl_app</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">Hwc3</span>. <span class="id">inv</span> <span class="id">H10</span>. <span class="tactic">subst</span> Γ'. <span class="id">simpl_app</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.envs_eq_node">envs_eq_node</a></span> <span class="kwd">in</span> <span class="id">Hblk</span>. <span class="tactic">clear</span> - <span class="id">Hblk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ??. <span class="tactic">specialize</span> (<span class="id">Hblk</span> <span class="id">x</span> <span class="id">ck</span>). <span class="tactic">rewrite</span> &lt;-<span class="id">Hblk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation_app_comm</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">Common.idty</a></span> (<span class="id"><a href="Velus.Common.Common.html#idty">Common.idty</a></span> <span class="id">locs</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_app</span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">n</span>. <span class="tactic">split</span>; (<span class="tactic">intros</span> [|[|]]; [<span class="tactic">left</span>|<span class="tactic">right</span>;<span class="tactic">left</span>|<span class="tactic">right</span>;<span class="tactic">right</span>]; <span class="id">solve_In</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sc_vars_app">sc_vars_app</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Senv.map_fst_senv_of_ins">map_fst_senv_of_ins</a></span>, <span class="id"><a href="Velus.Transcription.Correctness.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hin1</span> <span class="id">Hin2</span>. <span class="tactic">eapply</span> <span class="id">H12</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> - <span class="id">Hin2</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS.sem_node_ck_cons1">LCS.sem_node_ck_cons1</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Htr</span>' := <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">Htr</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">monadInv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#cons_is_app">cons_is_app</a></span> <span class="kwd">in</span> <span class="id">Hord</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#Lord.Ordered_nodes">Lord.Ordered_nodes</a></span> {| <span class="id"><a href="Velus.Transcription.Correctness.html#L.types">L.types</a></span> := <span class="id">types</span>; <span class="id"><a href="Velus.Transcription.Correctness.html#L.externs">L.externs</a></span> := <span class="id">externs</span>; <span class="id"><a href="Velus.Transcription.Correctness.html#L.nodes">L.nodes</a></span> := <span class="id">nodes</span> |}) <span class="kwd">as</span> <span class="id">Hord</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#Lord.Ordered_nodes_append">Lord.Ordered_nodes_append</a></span> <span class="kwd">in</span> <span class="id">Hord</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. 2:<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#cons_is_app">cons_is_app</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC.sem_node_cons2">NLSC.sem_node_cons2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS.ord_l_nl">ord_l_nl</a></span> <span class="kwd">with</span> (<span class="id">G</span>:=<span class="id"><a href="Velus.Transcription.Correctness.html#L.Global">L.Global</a></span> <span class="id">types</span> <span class="id">externs</span> <span class="id">nodes</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_global">to_global</a></span>; <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">EQ</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">IHnodes</span>; <span class="tactic">eauto</span>. <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_global">to_global</a></span>; <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">EQ</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">replace</span> <span class="id">x3</span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Transcription.Correctness.html#NL.Global">NL.Global</a></span> <span class="id">types</span> <span class="id">externs</span> <span class="id">x3</span>).(<span class="id"><a href="Velus.Transcription.Correctness.html#NL.nodes">NL.nodes</a></span>) <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_global_names">TR.to_global_names</a></span> <span class="kwd">with</span> (<span class="id">G</span>:=<span class="id"><a href="Velus.Transcription.Correctness.html#L.Global">L.Global</a></span> <span class="id">types</span> <span class="id">externs</span> <span class="id">nodes</span>); <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_node_name">to_node_name</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR.to_global">to_global</a></span>; <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">EQ</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS">CORRECTNESS</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="CorrectnessFun">CorrectnessFun</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Ids</span>  : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Op</span>   : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">OpAux</span>: <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span>    <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Cks</span>  : <span class="id"><a href="Velus.Clocks.html#CLOCKS">CLOCKS</a></span>           <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Senv</span> : <span class="id"><a href="Velus.Lustre.StaticEnv.html#STATICENV">STATICENV</a></span>        <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">L</span>    : <span class="id"><a href="Velus.Lustre.LSyntax.html#LSYNTAX">LSYNTAX</a></span>          <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CE</span>   : <span class="id"><a href="Velus.CoreExpr.CESyntax.html#CESYNTAX">CESYNTAX</a></span>         <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NL</span>   : <span class="id"><a href="Velus.NLustre.NLSyntax.html#NLSYNTAX">NLSYNTAX</a></span>         <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span>        <span class="id"><a href="Velus.Transcription.Correctness.html#CE">CE</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TR</span>   : <span class="id"><a href="Velus.Transcription.Tr.html#TR">TR</a></span>               <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span>      <span class="id"><a href="Velus.Transcription.Correctness.html#CE">CE</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#NL">NL</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LT</span>   : <span class="id"><a href="Velus.Lustre.LTyping.html#LTYPING">LTYPING</a></span>          <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LC</span>   : <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING">LCLOCKING</a></span>        <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Ord</span>  : <span class="id"><a href="Velus.NLustre.NLOrdered.html#NLORDERED">NLORDERED</a></span>        <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span>        <span class="id"><a href="Velus.Transcription.Correctness.html#CE">CE</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#NL">NL</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Lord</span> : <span class="id"><a href="Velus.Lustre.LOrdered.html#LORDERED">LORDERED</a></span>         <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Str</span>  : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS">COINDSTREAMS</a></span>     <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LS</span>   : <span class="id"><a href="Velus.Lustre.LSemantics.html#LSEMANTICS">LSEMANTICS</a></span>       <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Lord">Lord</a></span>       <span class="id"><a href="Velus.Transcription.Correctness.html#Str">Str</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LCS</span>  : <span class="id"><a href="Velus.Lustre.LClockedSemantics.html#LCLOCKEDSEMANTICS">LCLOCKEDSEMANTICS</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LC">LC</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str">Str</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS">LS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LN</span>   : <span class="id"><a href="Velus.Lustre.Normalization.Normalization.html#NORMALIZATION">NORMALIZATION</a></span>    <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NLSC</span> : <span class="id"><a href="Velus.NLustre.NLCoindSemantics.html#NLCOINDSEMANTICS">NLCOINDSEMANTICS</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span>        <span class="id"><a href="Velus.Transcription.Correctness.html#CE">CE</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#NL">NL</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str">Str</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ord">Ord</a></span>)<br/>
&lt;: <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS">CORRECTNESS</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#CE">CE</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#NL">NL</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR">TR</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LT">LT</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LC">LC</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ord">Ord</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str">Str</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS">LS</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS">LCS</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LN">LN</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC">NLSC</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Include</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CORRECTNESS">CORRECTNESS</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Op">Op</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#L">L</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#CE">CE</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#NL">NL</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#TR">TR</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LT">LT</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LC">LC</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Ord">Ord</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#Str">Str</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LS">LS</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LCS">LCS</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#LN">LN</a></span> <span class="id"><a href="Velus.Transcription.Correctness.html#NLSC">NLSC</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Transcription.Correctness.html#CorrectnessFun">CorrectnessFun</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
