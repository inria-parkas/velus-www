
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module LCausality</title>
<meta name="description" content="Documentation of Coq module LCausality" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module LCausality</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#ListNotations">List.ListNotations</a></span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html">Permutation</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Setoids.Setoid.html">Setoid</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html">common.Errors</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span> <span class="id"><a href="Velus.Environment.html">Environment</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Operators.html">Operators</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Clocks.html">Clocks</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.AcyGraph.html">AcyGraph</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.StaticEnv.html">Lustre.StaticEnv</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.LSyntax.html">Lustre.LSyntax</a></span>.<br/>
<br/>
<h1> Lustre causality </h1>
<br/>
<span class="kwd">Module</span> <span class="kwd">Type</span> <span class="id"><a name="LCAUSALITY">LCAUSALITY</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ids</span> : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Op</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Cks</span> : <span class="id"><a href="Velus.Clocks.html#CLOCKS">CLOCKS</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Senv</span> : <span class="id"><a href="Velus.Lustre.StaticEnv.html#STATICENV">STATICENV</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Syn</span> : <span class="id"><a href="Velus.Lustre.LSyntax.html#LSYNTAX">LSYNTAX</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv">Senv</a></span>).<br/>
<br/>
<h2> Causality definition </h2>
<br/>
<div class="doc">Variables that appear in the nth stream of an expression, to the left of fbys. </div>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCAUSALITY.Is_free_left">Is_free_left</a></span> (Γ : <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.static_env">static_env</a></span>) (<span class="id">cx</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.exp">exp</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.IFLvar">IFLvar</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left</span> Γ <span class="id">cx</span> 0 (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Evar">Evar</a></span> <span class="id">x</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.IFLlast">IFLlast</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left</span> Γ <span class="id">cx</span> 0 (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Elast">Elast</a></span> <span class="id">x</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.IFLunop">IFLunop</a></span> : <span class="kwd">forall</span> <span class="id">op</span> <span class="id">e</span> <span class="id">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left</span> Γ <span class="id">cx</span> 0 <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left</span> Γ <span class="id">cx</span> 0 (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Eunop">Eunop</a></span> <span class="id">op</span> <span class="id">e</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.IFLbinop">IFLbinop</a></span> : <span class="kwd">forall</span> <span class="id">op</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left</span> Γ <span class="id">cx</span> 0 <span class="id">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id">Is_free_left</span> Γ <span class="id">cx</span> 0 <span class="id">e2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left</span> Γ <span class="id">cx</span> 0 (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Ebinop">Ebinop</a></span> <span class="id">op</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.IFLextcall">IFLextcall</a></span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">es</span> <span class="id">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">k</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id">Is_free_left</span> Γ <span class="id">cx</span> <span class="id">k</span>) <span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left</span> Γ <span class="id">cx</span> 0 (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Eextcall">Eextcall</a></span> <span class="id">f</span> <span class="id">es</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.IFLfby">IFLfby</a></span> : <span class="kwd">forall</span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">a</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left_list</span> Γ <span class="id">cx</span> <span class="id">k</span> <span class="id">e0s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left</span> Γ <span class="id">cx</span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Efby">Efby</a></span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.IFLarrow">IFLarrow</a></span> : <span class="kwd">forall</span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">a</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left_list</span> Γ <span class="id">cx</span> <span class="id">k</span> <span class="id">e0s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id">Is_free_left_list</span> Γ <span class="id">cx</span> <span class="id">k</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left</span> Γ <span class="id">cx</span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Earrow">Earrow</a></span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.IFLwhen">IFLwhen</a></span> : <span class="kwd">forall</span> <span class="id">es</span> <span class="id">x</span> <span class="id">tx</span> <span class="id">b</span> <span class="id">a</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">a</span>) /\ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id">Is_free_left_list</span> Γ <span class="id">cx</span> <span class="id">k</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left</span> Γ <span class="id">cx</span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Ewhen">Ewhen</a></span> <span class="id">es</span> (<span class="id">x</span>, <span class="id">tx</span>) <span class="id">b</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.IFLmerge">IFLmerge</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">es</span> <span class="id">ty</span> <span class="id">a</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">a</span>) /\ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id">Is_free_left_list</span> Γ <span class="id">cx</span> <span class="id">k</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>)) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left</span> Γ <span class="id">cx</span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Emerge">Emerge</a></span> (<span class="id">x</span>, <span class="id">ty</span>) <span class="id">es</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.IFLcase">IFLcase</a></span> : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">es</span> <span class="id">d</span> <span class="id">a</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">a</span>) /\ <span class="id">Is_free_left</span> Γ <span class="id">cx</span> 0 <span class="id">e</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id">Is_free_left_list</span> Γ <span class="id">cx</span> <span class="id">k</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>)) <span class="id">es</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ (<span class="tactic">exists</span> <span class="id">d0</span>, <span class="id">d</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d0</span> /\ <span class="id">Is_free_left_list</span> Γ <span class="id">cx</span> <span class="id">k</span> <span class="id">d0</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left</span> Γ <span class="id">cx</span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Ecase">Ecase</a></span> <span class="id">e</span> <span class="id">es</span> <span class="id">d</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.IFLapp">IFLapp</a></span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">es</span> <span class="id">er</span> <span class="id">a</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">a</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">k</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id">Is_free_left</span> Γ <span class="id">cx</span> <span class="id">k</span>') <span class="id">es</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id">Is_free_left</span> Γ <span class="id">cx</span> 0) <span class="id">er</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left</span> Γ <span class="id">cx</span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Eapp">Eapp</a></span> <span class="id">f</span> <span class="id">es</span> <span class="id">er</span> <span class="id">a</span>)<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">with</span> <span class="id"><a name="LCAUSALITY.Is_free_left_list">Is_free_left_list</a></span> (Γ : <span class="id">static_env</span>) (<span class="id">cx</span> : <span class="id">ident</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.exp">exp</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.IFLLnow">IFLLnow</a></span> : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">e</span> <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left</span> Γ <span class="id">cx</span> <span class="id">k</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left_list</span> Γ <span class="id">cx</span> <span class="id">k</span> (<span class="id">e</span>::<span class="id">es</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.IFLLlater">IFLLlater</a></span> : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">e</span> <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &gt;= <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left_list</span> Γ <span class="id">cx</span> (<span class="id">k</span> - <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_free_left_list</span> Γ <span class="id">cx</span> <span class="id">k</span> (<span class="id">e</span>::<span class="id">es</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Constructors</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Is_free_left">Is_free_left</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Is_free_left_list">Is_free_left_list</a></span> : <span class="id">lcaus</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.idcaus">idcaus</a></span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * (<span class="id">A</span> * <span class="id">B</span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>))) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">cx</span>)) =&gt; (<span class="id">x</span>, <span class="id">cx</span>)) <span class="id">l</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.idcaus_app">idcaus_app</a></span> {<span class="id">A</span> <span class="id">B</span>} : <span class="kwd">forall</span> (<span class="id">l1</span> <span class="id">l2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * (<span class="id">A</span> * <span class="id">B</span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> (<span class="id">l1</span> ++ <span class="id">l2</span>) = <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> <span class="id">l1</span> ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> <span class="id">l2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
 <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.map_fst_idcaus">map_fst_idcaus</a></span> {<span class="id">A</span> <span class="id">B</span>} : <span class="kwd">forall</span> (<span class="id">l1</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * (<span class="id">A</span> * <span class="id">B</span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> <span class="id">l1</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">l1</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l1</span> <span class="kwd">as</span> [|(?&amp;(?&amp;?)&amp;?)]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> : <span class="id">list</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.NoDupMembers_idcaus">NoDupMembers_idcaus</a></span> {<span class="id">A</span> <span class="id">B</span>} : <span class="kwd">forall</span> (<span class="id">xs</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * (<span class="id">A</span> * <span class="id">B</span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> <span class="id">xs</span>) &lt;-&gt; <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.map_fst_idcaus">map_fst_idcaus</a></span>, &lt;-<span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.idcaus_of_senv_ins">idcaus_of_senv_ins</a></span> : <span class="kwd">forall</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_ins">senv_of_ins</a></span> <span class="id">xs</span>) = <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_ins">senv_of_ins</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#map_filter_nil">map_filter_nil</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl_Forall</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>; <span class="id">destruct_conjs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.replace_idcaus">replace_idcaus</a></span> (<span class="id">caus</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>)) (Γ: <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.static_env">static_env</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.ann">ann</a></span>) =&gt; (<span class="id">x</span>, <span class="id"><a href="Velus.Common.Common.html#or_default_with">or_default_with</a></span> <span class="id">ann</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.ann_with_caus">ann_with_caus</a></span> <span class="id">ann</span>) (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">x</span> <span class="id">caus</span>))) Γ.<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> : <span class="id">list</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.replace_idcaus_HasCaus1">replace_idcaus_HasCaus1</a></span> : <span class="kwd">forall</span> <span class="id">caus</span> Γ <span class="id">x</span> <span class="id">cx1</span> <span class="id">cx2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">caus</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">x</span>, <span class="id">cx2</span>) <span class="id">caus</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ) <span class="id">x</span> <span class="id">cx2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnd</span> <span class="id">Hin</span> <span class="id">Hca</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hca</span>; <span class="tactic">econstructor</span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Common.Common.html#assoc_ident_true">assoc_ident_true</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.replace_idcaus_HasCaus2">replace_idcaus_HasCaus2</a></span> : <span class="kwd">forall</span> <span class="id">caus</span> Γ <span class="id">x</span> <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">caus</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ) <span class="id">x</span> <span class="id">cx</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hin</span> <span class="id">Hca</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hca</span>; <span class="tactic">econstructor</span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#assoc_ident_false">assoc_ident_false</a></span> <span class="kwd">in</span> <span class="id">Hin</span>. <span class="tactic">rewrite</span> <span class="id">Hin</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.replace_idcaus_HasCaus3">replace_idcaus_HasCaus3</a></span> : <span class="kwd">forall</span> <span class="id">caus</span> Γ <span class="id">x</span> <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ) <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">x</span>, <span class="id">cx</span>) <span class="id">caus</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hca</span>. <span class="id">inv</span> <span class="id">Hca</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">x</span> <span class="id">caus</span>) <span class="id">eqn</span>:<span class="id">Hassc</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#assoc_ident_In">assoc_ident_In</a></span> <span class="kwd">in</span> <span class="id">Hassc</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.ann_with_caus_causl_last">ann_with_caus_causl_last</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">o</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.causl_last">causl_last</a></span> (<span class="id"><a href="Velus.Common.Common.html#or_default_with">or_default_with</a></span> <span class="id">a</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.ann_with_caus">ann_with_caus</a></span> <span class="id">a</span>) <span class="id">o</span>) = <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.causl_last">causl_last</a></span> <span class="id">a</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">o</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.replace_idcaus_IsVar">replace_idcaus_IsVar</a></span>: <span class="kwd">forall</span> <span class="id">caus</span> Γ <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ) <span class="id">x</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> Γ <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> * <span class="id">Hl</span>; <span class="id">inv</span> <span class="id">Hl</span>; <span class="id">simpl_In</span>; <span class="tactic">econstructor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> *; <span class="id">solve_In</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.replace_idcaus_HasType">replace_idcaus_HasType</a></span>: <span class="kwd">forall</span> <span class="id">caus</span> Γ <span class="id">x</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasType">HasType</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ) <span class="id">x</span> <span class="id">ty</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasType">HasType</a></span> Γ <span class="id">x</span> <span class="id">ty</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> * <span class="id">Hl</span>; <span class="id">inv</span> <span class="id">Hl</span>; <span class="id">simpl_In</span>; <span class="tactic">econstructor</span>; <span class="id">solve_In</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">_</span> <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.replace_idcaus_HasClock">replace_idcaus_HasClock</a></span>: <span class="kwd">forall</span> <span class="id">caus</span> Γ <span class="id">x</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasClock">HasClock</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ) <span class="id">x</span> <span class="id">ck</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> * <span class="id">Hl</span>; <span class="id">inv</span> <span class="id">Hl</span>; <span class="id">simpl_In</span>; <span class="tactic">econstructor</span>; <span class="id">solve_In</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">_</span> <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.replace_idcaus_IsLast">replace_idcaus_IsLast</a></span>: <span class="kwd">forall</span> <span class="id">caus</span> Γ <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsLast">IsLast</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ) <span class="id">x</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> * <span class="id">Hl</span>; <span class="id">inv</span> <span class="id">Hl</span>; <span class="id">simpl_In</span>; <span class="tactic">econstructor</span>; <span class="id">solve_In</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.ann_with_caus_causl_last">ann_with_caus_causl_last</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.replace_idcaus_HasLastCaus">replace_idcaus_HasLastCaus</a></span> : <span class="kwd">forall</span> <span class="id">caus</span> Γ <span class="id">x</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ) <span class="id">x</span> <span class="id">ck</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">ck</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> * <span class="id">Hl</span>; <span class="id">inv</span> <span class="id">Hl</span>; <span class="id">simpl_In</span>; <span class="tactic">econstructor</span>; <span class="id">solve_In</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">_</span> <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.map_fst_replace_idcaus">map_fst_replace_idcaus</a></span> : <span class="kwd">forall</span> <span class="id">caus</span> Γ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>; <span class="tactic">auto</span>. <span class="tactic">intros</span>; <span class="id">destruct_conjs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Hint</span> <span class="kwd">Rewrite</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_IsVar">replace_idcaus_IsVar</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_HasType">replace_idcaus_HasType</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_HasClock">replace_idcaus_HasClock</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_IsLast">replace_idcaus_IsLast</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_HasLastCaus">replace_idcaus_HasLastCaus</a></span> : <span class="id">list</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Hint</span> <span class="kwd">Rewrite</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.map_fst_replace_idcaus">map_fst_replace_idcaus</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.replace_idcaus_HasCaus_incl">replace_idcaus_HasCaus_incl</a></span> <span class="id">caus</span> : <span class="kwd">forall</span> Γ Γ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ) <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ') <span class="id">x</span> <span class="id">cx</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hincl</span> * <span class="id">Hca</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hca</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ' <span class="id">x</span> <span class="id">a</span>.(<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.causl">causl</a></span>)) <span class="kwd">as</span> <span class="id">Hca</span>' <span class="tactic">by</span> <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>. <span class="id">inv</span> <span class="id">Hca</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">_</span> <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.replace_idcaus_HasLastCaus_incl">replace_idcaus_HasLastCaus_incl</a></span> <span class="id">caus</span> : <span class="kwd">forall</span> Γ Γ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ) <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ') <span class="id">x</span> <span class="id">cx</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hincl</span> * <span class="id">Hca</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hca</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hincl</span>. <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">_</span> <span class="id">_</span>); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.replace_idcaus_In_snd">replace_idcaus_In_snd</a></span> : <span class="kwd">forall</span> Γ <span class="id">caus</span> <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">cx</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">cx</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span> Γ)) \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">cx</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">caus</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hin</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span> <span class="kwd">in</span> *. <span class="id">simpl_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> *. <span class="tactic">destruct</span> <span class="id">Hin</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">i</span> <span class="id">caus</span>) <span class="id">eqn</span>:<span class="id">Hassc</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#assoc_ident_In">assoc_ident_In</a></span> <span class="kwd">in</span> <span class="id">Hassc</span>. <span class="tactic">right</span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">left</span>; <span class="tactic">left</span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">left</span>; <span class="tactic">right</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.ann_with_caus_causl_last">ann_with_caus_causl_last</a></span> <span class="kwd">in</span> <span class="id">Hf0</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="tactic">rewrite</span> <span class="id">Hf0</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.replace_idcaus_NoDup">replace_idcaus_NoDup</a></span> : <span class="kwd">forall</span> Γ <span class="id">caus</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span> Γ ++ <span class="id">caus</span> ++ <span class="id">xs</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ) ++ <span class="id">xs</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnd1</span> <span class="id">Hnd</span>. <span class="id">simpl_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">NoDup_app</span>'; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_r">NoDup_app_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span> <span class="kwd">in</span> *. <span class="id">simpl_app</span>. <span class="tactic">apply</span> <span class="id">NoDup_app</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_r">NoDup_app_r</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#map_filter_map">map_filter_map</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#map_filter_ext">map_filter_ext</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">destruct_conjs</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.ann_with_caus_causl_last">ann_with_caus_causl_last</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">simpl_Forall</span>. <span class="tactic">intros</span> <span class="id">Hnin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_In</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.ann_with_caus_causl_last">ann_with_caus_causl_last</a></span> <span class="kwd">in</span> <span class="id">Hf0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Permutation_swap">Permutation_swap</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_In">NoDup_app_In</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>. 2:<span class="id">solve_In</span>; <span class="tactic">rewrite</span> <span class="id">Hf0</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hnd</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hassc</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#assoc_ident_In">assoc_ident_In</a></span> <span class="kwd">in</span> <span class="id">Hassc</span>. <span class="tactic">right</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">left</span>. <span class="tactic">clear</span> <span class="id">Hin</span>. <span class="id">solve_In</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Permutation_swap">Permutation_swap</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_r">NoDup_app_r</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> Γ <span class="kwd">as</span> [|(?&amp;?)]; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hnd1</span>. <span class="id">inv</span> <span class="id">Hnd</span>. <span class="tactic">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">clear</span> <span class="id">IH</span>Γ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hnin</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">i0</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hassc1</span>, (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">i</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hassc2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#assoc_ident_In">assoc_ident_In</a></span> <span class="kwd">in</span> <span class="id">Hassc1</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#assoc_ident_In">assoc_ident_In</a></span> <span class="kwd">in</span> <span class="id">Hassc2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_snd_det">NoDup_snd_det</a></span> <span class="kwd">in</span> <span class="id">Hassc1</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_r">NoDup_app_r</a></span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H1</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">H2</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#assoc_ident_In">assoc_ident_In</a></span> <span class="kwd">in</span> <span class="id">Hassc1</span>. <span class="tactic">right</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#assoc_ident_In">assoc_ident_In</a></span> <span class="kwd">in</span> <span class="id">Hassc2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_snd_det">NoDup_snd_det</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>; [|<span class="tactic">left</span>|<span class="tactic">right</span>]; <span class="tactic">eauto</span>. 2:<span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#assoc_ident_false">assoc_ident_false</a></span> <span class="kwd">in</span> <span class="id">Hassc1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hassc1</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">H2</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">H5</span>. <span class="tactic">left</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_In">NoDup_app_In</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_In_snd">replace_idcaus_In_snd</a></span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCAUSALITY.Is_defined_in_scope">Is_defined_in_scope</a></span> {<span class="id">A</span>} (<span class="id">Pdef</span> : <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.static_env">static_env</a></span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) Γ (<span class="id">cx</span>: <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.scope">scope</a></span> <span class="id">A</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DefScope1">DefScope1</a></span> : <span class="kwd">forall</span> <span class="id">locs</span> <span class="id">blks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Pdef</span> (Γ++<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">locs</span>) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_defined_in_scope</span> <span class="id">Pdef</span> Γ <span class="id">cx</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCAUSALITY.Is_defined_in_branch">Is_defined_in_branch</a></span> {<span class="id">A</span>} (<span class="id">Pdef</span> : <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.static_env">static_env</a></span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) Γ (<span class="id">cx</span>: <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.branch">branch</a></span> <span class="id">A</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DefBranch1">DefBranch1</a></span> : <span class="kwd">forall</span> <span class="id">caus</span> <span class="id">blks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Pdef</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_defined_in_branch</span> <span class="id">Pdef</span> Γ <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DefBranch2">DefBranch2</a></span> : <span class="kwd">forall</span> <span class="id">caus</span> <span class="id">blks</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">caus</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_defined_in_branch</span> <span class="id">Pdef</span> Γ <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCAUSALITY.Is_defined_in">Is_defined_in</a></span> Γ (<span class="id">cx</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.block">block</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DefEq">DefEq</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_defined_in</span> Γ <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Beq">Beq</a></span> (<span class="id">xs</span>, <span class="id">es</span>))<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DefReset">DefReset</a></span> : <span class="kwd">forall</span> <span class="id">blocks</span> <span class="id">er</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id">Is_defined_in</span> Γ <span class="id">cx</span>) <span class="id">blocks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_defined_in</span> Γ <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Breset">Breset</a></span> <span class="id">blocks</span> <span class="id">er</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DefSwitch">DefSwitch</a></span> : <span class="kwd">forall</span> <span class="id">ec</span> <span class="id">branches</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> <span class="id">blks</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_branch">Is_defined_in_branch</a></span> (<span class="kwd">fun</span> Γ =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id">Is_defined_in</span> Γ <span class="id">cx</span>)) Γ <span class="id">cx</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">blks</span>)) <span class="id">branches</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_defined_in</span> Γ <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bswitch">Bswitch</a></span> <span class="id">ec</span> <span class="id">branches</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DefAuto">DefAuto</a></span> : <span class="kwd">forall</span> <span class="id">type</span> <span class="id">ini</span> <span class="id">states</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> <span class="id">blks</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_branch">Is_defined_in_branch</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> Γ <span class="id">blks</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_scope">Is_defined_in_scope</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> Γ <span class="id">blks</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id">Is_defined_in</span> Γ <span class="id">cx</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">blks</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Γ <span class="id">cx</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">blks</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Γ <span class="id">cx</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">blks</span>)) <span class="id">states</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_defined_in</span> Γ <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bauto">Bauto</a></span> <span class="id">type</span> <span class="id">ck</span> <span class="id">ini</span> <span class="id">states</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DefLocal">DefLocal</a></span> : <span class="kwd">forall</span> <span class="id">scope</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_scope">Is_defined_in_scope</a></span> (<span class="kwd">fun</span> Γ =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id">Is_defined_in</span> Γ <span class="id">cx</span>)) Γ <span class="id">cx</span> <span class="id">scope</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_defined_in</span> Γ <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Blocal">Blocal</a></span> <span class="id">scope</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCAUSALITY.Is_last_in_scope">Is_last_in_scope</a></span> {<span class="id">A</span>} (<span class="id">Plast</span> : <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">cx</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.scope">scope</a></span> <span class="id">A</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.LastScope1">LastScope1</a></span> : <span class="kwd">forall</span> <span class="id">locs</span> <span class="id">blks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Plast</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_last_in_scope</span> <span class="id">Plast</span> <span class="id">cx</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.LastScope2">LastScope2</a></span> : <span class="kwd">forall</span> <span class="id">locs</span> <span class="id">blks</span> <span class="id">x</span> <span class="id">ty</span> <span class="id">ck</span> <span class="id">cx</span>' <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">x</span>, (<span class="id">ty</span>, <span class="id">ck</span>, <span class="id">cx</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">e</span>, <span class="id">cx</span>))) <span class="id">locs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_last_in_scope</span> <span class="id">Plast</span> <span class="id">cx</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCAUSALITY.Is_last_in_branch">Is_last_in_branch</a></span> {<span class="id">A</span>} (<span class="id">Plast</span> : <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.branch">branch</a></span> <span class="id">A</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.LastBranch1">LastBranch1</a></span> : <span class="kwd">forall</span> <span class="id">caus</span> <span class="id">blks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Plast</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_last_in_branch</span> <span class="id">Plast</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCAUSALITY.Is_last_in">Is_last_in</a></span> (<span class="id">cx</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.block">block</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.LastReset">LastReset</a></span> : <span class="kwd">forall</span> <span class="id">blocks</span> <span class="id">er</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id">Is_last_in</span> <span class="id">cx</span>) <span class="id">blocks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_last_in</span> <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Breset">Breset</a></span> <span class="id">blocks</span> <span class="id">er</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.LastSwitch">LastSwitch</a></span> : <span class="kwd">forall</span> <span class="id">ec</span> <span class="id">branches</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> <span class="id">blks</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in_branch">Is_last_in_branch</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id">Is_last_in</span> <span class="id">cx</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">blks</span>)) <span class="id">branches</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_last_in</span> <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bswitch">Bswitch</a></span> <span class="id">ec</span> <span class="id">branches</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.LastAuto">LastAuto</a></span> : <span class="kwd">forall</span> <span class="id">type</span> <span class="id">ini</span> <span class="id">states</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> <span class="id">blks</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in_branch">Is_last_in_branch</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">blks</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in_scope">Is_last_in_scope</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">blks</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id">Is_last_in</span> <span class="id">cx</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">blks</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cx</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">blks</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">blks</span>)) <span class="id">states</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_last_in</span> <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bauto">Bauto</a></span> <span class="id">type</span> <span class="id">ck</span> <span class="id">ini</span> <span class="id">states</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.LastLocal">LastLocal</a></span> : <span class="kwd">forall</span> <span class="id">scope</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in_scope">Is_last_in_scope</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id">Is_last_in</span> <span class="id">cx</span>)) <span class="id">cx</span> <span class="id">scope</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Is_last_in</span> <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Blocal">Blocal</a></span> <span class="id">scope</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCAUSALITY.depends_on_last_decl">depends_on_last_decl</a></span> Γ (<span class="id">cx</span> <span class="id">cy</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.decl">decl</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnLast">DepOnLast</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span> <span class="id">ck</span> <span class="id">cl</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">cy</span> 0 <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on_last_decl</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id">x</span>, (<span class="id">ty</span>, <span class="id">ck</span>, <span class="id">cl</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">e</span>, <span class="id">cx</span>))).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCAUSALITY.depends_on_scope">depends_on_scope</a></span> {<span class="id">A</span>} (<span class="id">P_dep</span> : <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="kwd">Prop</span>) Γ (<span class="id">cx</span> <span class="id">cy</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.scope">scope</a></span> <span class="id">A</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnScope1">DepOnScope1</a></span> : <span class="kwd">forall</span> <span class="id">locs</span> <span class="id">blks</span> Γ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Γ' = Γ ++ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">locs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_dep</span> Γ' <span class="id">cx</span> <span class="id">cy</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on_scope</span> <span class="id">P_dep</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnScope2">DepOnScope2</a></span> : <span class="kwd">forall</span> <span class="id">locs</span> <span class="id">blks</span> Γ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Γ' = Γ ++ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">locs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_last_decl">depends_on_last_decl</a></span> Γ' <span class="id">cx</span> <span class="id">cy</span>) <span class="id">locs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on_scope</span> <span class="id">P_dep</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCAUSALITY.depends_on_branch">depends_on_branch</a></span> {<span class="id">A</span>} (<span class="id">P_dep</span> : <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="kwd">Prop</span>) Γ (<span class="id">cx</span> <span class="id">cy</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.branch">branch</a></span> <span class="id">A</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnBranch1">DepOnBranch1</a></span> : <span class="kwd">forall</span> <span class="id">caus</span> <span class="id">blks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_dep</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ) <span class="id">cx</span> <span class="id">cy</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on_branch</span> <span class="id">P_dep</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnBranch2">DepOnBranch2</a></span> : <span class="kwd">forall</span> <span class="id">caus</span> <span class="id">blks</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">x</span>, <span class="id">cy</span>) <span class="id">caus</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on_branch</span> <span class="id">P_dep</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCAUSALITY.depends_on">depends_on</a></span> Γ (<span class="id">cx</span> <span class="id">cy</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.block">block</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnEq">DepOnEq</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">es</span> <span class="id">k</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id">xs</span> <span class="id">k</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list">Is_free_left_list</a></span> Γ <span class="id">cy</span> <span class="id">k</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Beq">Beq</a></span> (<span class="id">xs</span>, <span class="id">es</span>))<br/>
<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnReset1">DepOnReset1</a></span> : <span class="kwd">forall</span> <span class="id">blocks</span> <span class="id">er</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id">depends_on</span> Γ <span class="id">cx</span> <span class="id">cy</span>) <span class="id">blocks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Breset">Breset</a></span> <span class="id">blocks</span> <span class="id">er</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnReset2">DepOnReset2</a></span> : <span class="kwd">forall</span> <span class="id">blocks</span> <span class="id">er</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in">Is_defined_in</a></span> Γ <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Breset">Breset</a></span> <span class="id">blocks</span> <span class="id">er</span>) \/ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in">Is_last_in</a></span> <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Breset">Breset</a></span> <span class="id">blocks</span> <span class="id">er</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">cy</span> 0 <span class="id">er</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Breset">Breset</a></span> <span class="id">blocks</span> <span class="id">er</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnSwitch1">DepOnSwitch1</a></span> : <span class="kwd">forall</span> <span class="id">ec</span> <span class="id">branches</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> <span class="id">blks</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_branch">depends_on_branch</a></span> (<span class="kwd">fun</span> Γ <span class="id">cx</span> <span class="id">cy</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id">depends_on</span> Γ <span class="id">cx</span> <span class="id">cy</span>)) Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">blks</span>)) <span class="id">branches</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bswitch">Bswitch</a></span> <span class="id">ec</span> <span class="id">branches</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnSwitch2">DepOnSwitch2</a></span> : <span class="kwd">forall</span> <span class="id">ec</span> <span class="id">branches</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in">Is_defined_in</a></span> Γ <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bswitch">Bswitch</a></span> <span class="id">ec</span> <span class="id">branches</span>) \/ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in">Is_last_in</a></span> <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bswitch">Bswitch</a></span> <span class="id">ec</span> <span class="id">branches</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">cy</span> 0 <span class="id">ec</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bswitch">Bswitch</a></span> <span class="id">ec</span> <span class="id">branches</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnAuto1">DepOnAuto1</a></span> : <span class="kwd">forall</span> <span class="id">type</span> <span class="id">ini</span> <span class="id">states</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> <span class="id">blks</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_branch">depends_on_branch</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> Γ <span class="id">ck</span> <span class="id">cy</span> <span class="id">blks</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_scope">depends_on_scope</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> Γ <span class="id">cx</span> <span class="id">cy</span> <span class="id">blks</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id">depends_on</span> Γ <span class="id">cx</span> <span class="id">cy</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">blks</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">blks</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">blks</span>)) <span class="id">states</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bauto">Bauto</a></span> <span class="id">type</span> <span class="id">ck</span> <span class="id">ini</span> <span class="id">states</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnAuto2">DepOnAuto2</a></span> : <span class="kwd">forall</span> <span class="id">type</span> <span class="id">ini</span> <span class="id">oth</span> <span class="id">states</span> <span class="id">ck</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in">Is_defined_in</a></span> Γ <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bauto">Bauto</a></span> <span class="id">type</span> <span class="id">ck</span> (<span class="id">ini</span>, <span class="id">oth</span>) <span class="id">states</span>) \/ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in">Is_last_in</a></span> <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bauto">Bauto</a></span> <span class="id">type</span> <span class="id">ck</span> (<span class="id">ini</span>, <span class="id">oth</span>) <span class="id">states</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Cks.Is_free_in_clock">Is_free_in_clock</a></span> <span class="id">y</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">y</span> <span class="id">cy</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bauto">Bauto</a></span> <span class="id">type</span> <span class="id">ck</span> (<span class="id">ini</span>, <span class="id">oth</span>) <span class="id">states</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnAuto3">DepOnAuto3</a></span> : <span class="kwd">forall</span> <span class="id">type</span> <span class="id">ini</span> <span class="id">oth</span> <span class="id">states</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in">Is_defined_in</a></span> Γ <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bauto">Bauto</a></span> <span class="id">type</span> <span class="id">ck</span> (<span class="id">ini</span>, <span class="id">oth</span>) <span class="id">states</span>) \/ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in">Is_last_in</a></span> <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bauto">Bauto</a></span> <span class="id">type</span> <span class="id">ck</span> (<span class="id">ini</span>, <span class="id">oth</span>) <span class="id">states</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">cy</span> 0 <span class="id">e</span>) <span class="id">ini</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bauto">Bauto</a></span> <span class="id">type</span> <span class="id">ck</span> (<span class="id">ini</span>, <span class="id">oth</span>) <span class="id">states</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnAuto4">DepOnAuto4</a></span> : <span class="kwd">forall</span> <span class="id">type</span> <span class="id">ini</span> <span class="id">oth</span> <span class="id">states</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in">Is_defined_in</a></span> Γ <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bauto">Bauto</a></span> <span class="id">type</span> <span class="id">ck</span> (<span class="id">ini</span>, <span class="id">oth</span>) <span class="id">states</span>) \/ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in">Is_last_in</a></span> <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bauto">Bauto</a></span> <span class="id">type</span> <span class="id">ck</span> (<span class="id">ini</span>, <span class="id">oth</span>) <span class="id">states</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">_</span> (<span class="id">unl</span>, <span class="id">_</span>)) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">cy</span> 0 <span class="id">e</span>) <span class="id">unl</span>) <span class="id">states</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bauto">Bauto</a></span> <span class="id">type</span> <span class="id">ck</span> (<span class="id">ini</span>, <span class="id">oth</span>) <span class="id">states</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnLocal">DepOnLocal</a></span> : <span class="kwd">forall</span> <span class="id">scope</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_scope">depends_on_scope</a></span> (<span class="kwd">fun</span> Γ <span class="id">cx</span> <span class="id">cy</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id">depends_on</span> Γ <span class="id">cx</span> <span class="id">cy</span>)) Γ <span class="id">cx</span> <span class="id">cy</span> <span class="id">scope</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Blocal">Blocal</a></span> <span class="id">scope</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCAUSALITY.depends_on_node">depends_on_node</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">cx</span> <span class="id">cy</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) : @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.node">node</a></span> <span class="id">PSyn</span> <span class="id">prefs</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnNode1">DepOnNode1</a></span> : <span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on">depends_on</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_block">n_block</a></span> <span class="id">n</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on_node</span> <span class="id">cx</span> <span class="id">cy</span> <span class="id">n</span><br/>
&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.DepOnNode2">DepOnNode2</a></span> : <span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_last_decl">depends_on_last_decl</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) <span class="id">cx</span> <span class="id">cy</span>) (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">depends_on_node</span> <span class="id">cx</span> <span class="id">cy</span> <span class="id">n</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">inv_scope</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_scope">Is_defined_in_scope</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in_scope">Is_last_in_scope</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_scope">depends_on_scope</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_conjs</span>; <span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">inv_branch</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_branch">Is_defined_in_branch</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in_branch">Is_last_in_branch</a></span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_branch">depends_on_branch</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_conjs</span>; <span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">inv_block</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in">Is_defined_in</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in">Is_last_in</a></span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on">depends_on</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="LCAUSALITY.incl">incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id">Is_free_left_list_incl</span>' : <span class="kwd">forall</span> Γ Γ' <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">forall</span> <span class="id">cx</span> <span class="id">k</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">cx</span> <span class="id">k</span> <span class="id">e</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ' <span class="id">cx</span> <span class="id">k</span> <span class="id">e</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cx</span> <span class="id">k</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list">Is_free_left_list</a></span> Γ <span class="id">cx</span> <span class="id">k</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list">Is_free_left_list</a></span> Γ' <span class="id">cx</span> <span class="id">k</span> <span class="id">es</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hf</span> * <span class="id">Hex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hex</span>; <span class="id">inv</span> <span class="id">Hf</span>; [<span class="tactic">left</span>|<span class="tactic">right</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.Is_free_left_incl">Is_free_left_incl</a></span> : <span class="kwd">forall</span> Γ Γ' <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cx</span> <span class="id">k</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">cx</span> <span class="id">k</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ' <span class="id">cx</span> <span class="id">k</span> <span class="id">e</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hc1</span> <span class="id">Hc2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.exp_ind2">exp_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Hfree</span>; <span class="id">inv</span> <span class="id">Hfree</span>; <span class="tactic">constructor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">_</span> \/ <span class="id">_</span> |- <span class="id">_</span> \/ <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span>; [<span class="tactic">left</span>|<span class="tactic">right</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">_</span> /\ <span class="id">_</span> |- <span class="id">_</span> /\ <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">split</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> <span class="id">_</span> <span class="id">_</span> |- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">solve_Exists</span>; <span class="id">simpl_Forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="tactic">exists</span> <span class="id">_</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">x</span>&amp;?); <span class="tactic">exists</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="tactic">exists</span> <span class="id">_</span>, <span class="id">_</span> /\ <span class="id">_</span> |- <span class="tactic">exists</span> <span class="id">_</span>, <span class="id">_</span> /\ <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">x</span>&amp;?&amp;?); <span class="tactic">subst</span>; <span class="id">esplit</span>; <span class="tactic">split</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list">Is_free_left_list</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">eapply</span> <span class="id">Is_free_left_list_incl</span>' <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.Is_defined_in_scope_incl">Is_defined_in_scope_incl</a></span> {<span class="id">A</span>} <span class="id">P_def</span> : <span class="kwd">forall</span> <span class="id">locs</span> (<span class="id">blk</span>: <span class="id">A</span>) Γ Γ' <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_scope">Is_defined_in_scope</a></span> <span class="id">P_def</span> Γ <span class="id">cx</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blk</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ Γ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_def</span> Γ <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_def</span> Γ' <span class="id">blk</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_scope">Is_defined_in_scope</a></span> <span class="id">P_def</span> Γ' <span class="id">cx</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blk</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hincl</span> <span class="id">Hdef</span> <span class="id">Hind</span>; <span class="id">inv_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">econstructor</span>. <span class="tactic">eapply</span> <span class="id">Hind</span>; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> *. <span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus_app">HasCaus_app</a></span>. <span class="tactic">intros</span> [|]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.Is_defined_in_branch_incl">Is_defined_in_branch_incl</a></span> {<span class="id">A</span>} <span class="id">P_def</span> : <span class="kwd">forall</span> <span class="id">caus</span> (<span class="id">blk</span>: <span class="id">A</span>) Γ Γ' <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_branch">Is_defined_in_branch</a></span> <span class="id">P_def</span> Γ <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blk</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ Γ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_def</span> Γ <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_def</span> Γ' <span class="id">blk</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_branch">Is_defined_in_branch</a></span> <span class="id">P_def</span> Γ' <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blk</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hincl</span> <span class="id">Hdef</span> <span class="id">Hind</span>; <span class="id">inv_branch</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">econstructor</span>. <span class="tactic">eapply</span> <span class="id">Hind</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_HasCaus_incl">replace_idcaus_HasCaus_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.DefBranch2">DefBranch2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.Is_defined_in_incl">Is_defined_in_incl</a></span> : <span class="kwd">forall</span> <span class="id">blk</span> Γ Γ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in">Is_defined_in</a></span> Γ <span class="id">cx</span> <span class="id">blk</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in">Is_defined_in</a></span> Γ' <span class="id">cx</span> <span class="id">blk</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.block_ind2">block_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Hc</span> * <span class="id">Hdef</span>; <span class="id">inv</span> <span class="id">Hdef</span>; <span class="tactic">econstructor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">s</span>:<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.scope">scope</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_scope">Is_defined_in_scope</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_scope_incl">Is_defined_in_scope_incl</a></span>; <span class="tactic">eauto</span>; <span class="tactic">intros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">s</span>:<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.branch">branch</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_branch">Is_defined_in_branch</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_branch_incl">Is_defined_in_branch_incl</a></span>; <span class="tactic">eauto</span>; <span class="tactic">intros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">solve_Exists</span>; <span class="id">simpl_Forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in">Is_defined_in</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.depends_on_scope_incl">depends_on_scope_incl</a></span> {<span class="id">A</span>} (<span class="id">P_dep</span> : <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) : <span class="kwd">forall</span> <span class="id">locs</span> <span class="id">blks</span> Γ Γ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ Γ' <span class="id">cx</span> <span class="id">cy</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_dep</span> Γ <span class="id">cx</span> <span class="id">cy</span> <span class="id">blks</span> -&gt; <span class="id">P_dep</span> Γ' <span class="id">cx</span> <span class="id">cy</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cx</span> <span class="id">cy</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_scope">depends_on_scope</a></span> <span class="id">P_dep</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_scope">depends_on_scope</a></span> <span class="id">P_dep</span> Γ' <span class="id">cx</span> <span class="id">cy</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hca</span> <span class="id">Hla</span> <span class="id">Hp</span> * <span class="id">Hdep</span>. <span class="id">inv_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.DepOnScope1">DepOnScope1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hp</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">eauto</span>; <span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus_app">HasCaus_app</a></span>; <span class="tactic">intros</span> [|]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus_app">HasLastCaus_app</a></span>; <span class="tactic">intros</span> [|]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.DepOnScope2">DepOnScope2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_Exists</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_last_decl">depends_on_last_decl</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>. <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_incl">Is_free_left_incl</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>; <span class="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus_app">HasCaus_app</a></span>; <span class="tactic">intros</span> [|]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus_app">HasLastCaus_app</a></span>; <span class="tactic">intros</span> [|]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.depends_on_branch_incl">depends_on_branch_incl</a></span> {<span class="id">A</span>} (<span class="id">P_dep</span> : <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) : <span class="kwd">forall</span> <span class="id">caus</span> <span class="id">blks</span> Γ Γ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ Γ' <span class="id">cx</span> <span class="id">cy</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_dep</span> Γ <span class="id">cx</span> <span class="id">cy</span> <span class="id">blks</span> -&gt; <span class="id">P_dep</span> Γ' <span class="id">cx</span> <span class="id">cy</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cx</span> <span class="id">cy</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_branch">depends_on_branch</a></span> <span class="id">P_dep</span> Γ <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_branch">depends_on_branch</a></span> <span class="id">P_dep</span> Γ' <span class="id">cx</span> <span class="id">cy</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hca</span> <span class="id">Hla</span> <span class="id">Hp</span> * <span class="id">Hdep</span>. <span class="id">inv_branch</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.DepOnBranch1">DepOnBranch1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hp</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>; <span class="tactic">intros</span> *; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_HasCaus_incl">replace_idcaus_HasCaus_incl</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_HasLastCaus_incl">replace_idcaus_HasLastCaus_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.DepOnBranch2">DepOnBranch2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.depends_on_incl">depends_on_incl</a></span> : <span class="kwd">forall</span> <span class="id">blk</span> Γ Γ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cx</span> <span class="id">cy</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on">depends_on</a></span> Γ <span class="id">cx</span> <span class="id">cy</span> <span class="id">blk</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on">depends_on</a></span> Γ' <span class="id">cx</span> <span class="id">cy</span> <span class="id">blk</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.block_ind2">block_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Hc1</span> <span class="id">Hc2</span> * <span class="id">Hdep</span>; <span class="id">inv_block</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;equation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Is_free_left_list_incl</span>'; <span class="tactic">eauto</span>. <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_incl">Is_free_left_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>. <span class="id">solve_Exists</span>. <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.DepOnReset2">DepOnReset2</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_incl">Is_free_left_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_Exists</span>. <span class="tactic">destruct</span> <span class="id">H2</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_incl">Is_defined_in_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;switch&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>. <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_branch_incl">depends_on_branch_incl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">solve_Exists</span>; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.DepOnSwitch2">DepOnSwitch2</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_incl">Is_free_left_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_incl">Is_defined_in_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;automaton&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>. <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_branch_incl">depends_on_branch_incl</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>; <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span>; <span class="id">destruct_conjs</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_scope_incl">depends_on_scope_incl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">solve_Exists</span>; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.DepOnAuto2">DepOnAuto2</a></span>; <span class="id">solve_Exists</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">H3</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_incl">Is_defined_in_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.DepOnAuto3">DepOnAuto3</a></span>; <span class="id">solve_Exists</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_incl">Is_free_left_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_incl">Is_defined_in_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.DepOnAuto4">DepOnAuto4</a></span>; <span class="id">solve_Exists</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">H2</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_incl">Is_defined_in_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">b</span> <span class="kwd">as</span> [?(?&amp;?)]; <span class="id">solve_Exists</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_incl">Is_free_left_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_scope_incl">depends_on_scope_incl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">solve_Exists</span>; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.incl">incl</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.idcaus_of_decls">idcaus_of_decls</a></span> {<span class="id">A</span>} <span class="id">locs</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span> (@<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">A</span> <span class="id">locs</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_decls">idcaus_of_decls</a></span> : <span class="id">list</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.idcaus_of_scope">idcaus_of_scope</a></span> {<span class="id">A</span>} <span class="id">f_idcaus</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.scope">scope</a></span> <span class="id">A</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span> := <span class="id">s</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_decls">idcaus_of_decls</a></span> <span class="id">locs</span> ++ <span class="id">f_idcaus</span> <span class="id">blks</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.idcaus_of_branch">idcaus_of_branch</a></span> {<span class="id">A</span>} <span class="id">f_idcaus</span> (<span class="id">b</span> : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.branch">branch</a></span> <span class="id">A</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span> := <span class="id">b</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">caus</span> ++ <span class="id">f_idcaus</span> <span class="id">blks</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="LCAUSALITY.idcaus_of_locals">idcaus_of_locals</a></span> <span class="id">blk</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">blk</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Beq">Beq</a></span> <span class="id">_</span> =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Breset">Breset</a></span> <span class="id">blocks</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id">idcaus_of_locals</span> <span class="id">blocks</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bswitch">Bswitch</a></span> <span class="id">_</span> <span class="id">branches</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">b</span>) =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_branch">idcaus_of_branch</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id">idcaus_of_locals</span>) <span class="id">b</span>) <span class="id">branches</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bauto">Bauto</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">states</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">b</span>) =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_branch">idcaus_of_branch</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">s</span>) =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_scope">idcaus_of_scope</a></span> (<span class="kwd">fun</span> '(<span class="id">blks</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id">idcaus_of_locals</span> <span class="id">blks</span>) <span class="id">s</span>) <span class="id">b</span>) <span class="id">states</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Blocal">Blocal</a></span> <span class="id">s</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_scope">idcaus_of_scope</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id">idcaus_of_locals</span>) <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_locals">idcaus_of_locals</a></span> : <span class="id">list</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.graph_of_node">graph_of_node</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span> <span class="id">v</span> <span class="id">a</span>} (<span class="id">n</span> : @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.node">node</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) (<span class="id">g</span> : <span class="id"><a href="Velus.AcyGraph.html#AcyGraph">AcyGraph</a></span> <span class="id">v</span> <span class="id">a</span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#PS.Equal">PS.Equal</a></span> (<span class="id"><a href="Velus.AcyGraph.html#vertices">vertices</a></span> <span class="id">g</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.Common.html#PSP.of_list">PSP.of_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_decls">idcaus_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_locals">idcaus_of_locals</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_block">n_block</a></span> <span class="id">n</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">cx</span> <span class="id">cy</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_node">depends_on_node</a></span> <span class="id">cx</span> <span class="id">cy</span> <span class="id">n</span> -&gt; <span class="id"><a href="Velus.AcyGraph.html#is_arc">is_arc</a></span> <span class="id">g</span> <span class="id">cy</span> <span class="id">cx</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.node_causal">node_causal</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">n</span> : @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.node">node</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_decls">idcaus_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_locals">idcaus_of_locals</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_block">n_block</a></span> <span class="id">n</span>))) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">v</span> <span class="id">a</span> (<span class="id">g</span> : <span class="id"><a href="Velus.AcyGraph.html#AcyGraph">AcyGraph</a></span> <span class="id">v</span> <span class="id">a</span>), <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.graph_of_node">graph_of_node</a></span> <span class="id">n</span> <span class="id">g</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.node_causal_NoDup">node_causal_NoDup</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">nd</span> : @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.node">node</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal">node_causal</a></span> <span class="id">nd</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id">nd</span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_decls">idcaus_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">nd</span>))).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * (<span class="id">Hnd</span>&amp;<span class="id">_</span>). <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id">Is_free_left_list_length</span>' Γ : <span class="kwd">forall</span> <span class="id">es</span> <span class="id">x</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">forall</span> <span class="id">x</span> <span class="id">k</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">x</span> <span class="id">k</span> <span class="id">e</span> -&gt; <span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.annot">annot</a></span> <span class="id">e</span>)) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list">Is_free_left_list</a></span> Γ <span class="id">x</span> <span class="id">k</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.annots">annots</a></span> <span class="id">es</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">es</span>; <span class="tactic">intros</span> * <span class="id">Hf</span> <span class="id">Hfree</span>; <span class="id">inv</span> <span class="id">Hfree</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_length">app_length</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.length_annot_numstreams">length_annot_numstreams</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;now&nbsp;!&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.lt_lt_add_r">PeanoNat.Nat.lt_lt_add_r</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;later&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">IHes</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H4</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.lt_sub_lt_add_l">PeanoNat.Nat.lt_sub_lt_add_l</a></span> <span class="kwd">in</span> <span class="id">IHes</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.Is_free_left_length">Is_free_left_length</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) Γ : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">x</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_exp">wl_exp</a></span> <span class="id">G</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">x</span> <span class="id">k</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.annot">annot</a></span> <span class="id">e</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Ltac</span> <span class="id">solve_forall2</span> <span class="id">Ha</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> &lt;- <span class="id">Ha</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Is_free_left_list_length</span>'; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.exp_ind2">exp_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Hwl</span> <span class="id">Hfree</span>; <span class="id">inv</span> <span class="id">Hfree</span>; <span class="id">inv</span> <span class="id">Hwl</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;extcall&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_conjs</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;fby&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_forall2</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;arrow&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> [?|?]; <span class="tactic">auto</span>. <span class="id">solve_forall2</span> <span class="id">H8</span>. <span class="id">solve_forall2</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;when&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>. <span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [[? ?]|?]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_forall2</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;merge&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>. <span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [[? ?]|?]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_forall2</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>. <span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> [[? ?]|[<span class="id">Hex</span>|(?&amp;?&amp;<span class="id">Hex</span>)]]; <span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Exists</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id">H11</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Is_free_left_list_length</span>'; <span class="tactic">eauto</span>. <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">specialize</span> (<span class="id">H13</span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>). <span class="tactic">specialize</span> (<span class="id">H12</span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_forall2</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCAUSALITY.Is_free_left_list_length">Is_free_left_list_length</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) Γ : <span class="kwd">forall</span> <span class="id">es</span> <span class="id">x</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_exp">wl_exp</a></span> <span class="id">G</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list">Is_free_left_list</a></span> Γ <span class="id">x</span> <span class="id">k</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.annots">annots</a></span> <span class="id">es</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwl</span> <span class="id">Hfree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Is_free_left_list_length</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_length">Is_free_left_length</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.Is_free_left_list_Exists">Is_free_left_list_Exists</a></span> Γ : <span class="kwd">forall</span> <span class="id">es</span> <span class="id">x</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list">Is_free_left_list</a></span> Γ <span class="id">x</span> <span class="id">k</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">k</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">x</span> <span class="id">k</span>') <span class="id">es</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">es</span>; <span class="tactic">intros</span> * <span class="id">Hfree</span>; <span class="id">inv</span> <span class="id">Hfree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">exists</span> <span class="id">k</span>. <span class="tactic">left</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">specialize</span> (<span class="id">IHes</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H3</span>) <span class="kwd">as</span> [<span class="id">k</span>' ?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">k</span>'. <span class="tactic">right</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.Is_free_left_In_snd">Is_free_left_In_snd</a></span> Γ : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">x</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">x</span> <span class="id">k</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">y</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">y</span> <span class="id">x</span> \/ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">y</span> <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.exp_ind2">exp_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Hfree</span>; <span class="id">inv</span> <span class="id">Hfree</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">_</span> \/ <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="id">destruct_conjs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list">Is_free_left_list</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list_Exists">Is_free_left_list_Exists</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;?)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">simpl_Exists</span>; <span class="id">simpl_Forall</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCAUSALITY.Is_free_left_list_In_snd">Is_free_left_list_In_snd</a></span> Γ : <span class="kwd">forall</span> <span class="id">es</span> <span class="id">x</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list">Is_free_left_list</a></span> Γ <span class="id">x</span> <span class="id">k</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">y</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">y</span> <span class="id">x</span> \/ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">y</span> <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hfree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list_Exists">Is_free_left_list_Exists</a></span> <span class="kwd">in</span> <span class="id">Hfree</span> <span class="kwd">as</span> (?&amp;<span class="id">Hex</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_exists">Exists_exists</a></span> <span class="kwd">in</span> <span class="id">Hex</span> <span class="kwd">as</span> (?&amp;<span class="id">_</span>&amp;<span class="id">Hfree</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_In_snd">Is_free_left_In_snd</a></span> <span class="kwd">in</span> <span class="id">Hfree</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Constructors</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Is_defined_in">Is_defined_in</a></span> : <span class="id">lcaus</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.Is_defined_scope_Is_defined_scope">Is_defined_scope_Is_defined_scope</a></span> {<span class="id">A</span>} <span class="id">P_def1</span> (<span class="id">P_def2</span>: <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="kwd">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">locs</span> (<span class="id">blk</span>: <span class="id">A</span>) <span class="id">x</span> <span class="id">cx</span> Γ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Is_defined_in_scope">Syn.Is_defined_in_scope</a></span> <span class="id">P_def1</span> <span class="id">x</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blk</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_def1</span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_def2</span> Γ <span class="id">blk</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_scope">Is_defined_in_scope</a></span> <span class="id">P_def2</span> Γ <span class="id">cx</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blk</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hca</span> <span class="id">Hdef</span> <span class="id">Hind</span>; <span class="id">inv</span> <span class="id">Hdef</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>. <span class="tactic">apply</span> <span class="id">Hind</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus_app">HasCaus_app</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.Is_defined_branch_Is_defined_branch">Is_defined_branch_Is_defined_branch</a></span> {<span class="id">A</span>} <span class="id">P_def1</span> (<span class="id">P_def2</span>: <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="kwd">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">caus</span> (<span class="id">blk</span>: <span class="id">A</span>) <span class="id">x</span> <span class="id">cx</span> Γ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Is_defined_in_branch">Syn.Is_defined_in_branch</a></span> <span class="id">P_def1</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blk</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_def1</span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_def2</span> Γ <span class="id">blk</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_branch">Is_defined_in_branch</a></span> <span class="id">P_def2</span> Γ <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blk</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hca</span> <span class="id">Hdef</span> <span class="id">Hind</span>; <span class="id">inv</span> <span class="id">Hdef</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonList.html#InMembers_dec">InMembers_dec</a></span> <span class="id">x</span> <span class="id">caus</span> <span class="id"><a href="Velus.Common.Common.html#ident_eq_dec">ident_eq_dec</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.DefBranch2">DefBranch2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hind</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_HasCaus2">replace_idcaus_HasCaus2</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.Is_defined_in_Is_defined_in">Is_defined_in_Is_defined_in</a></span> : <span class="kwd">forall</span> <span class="id">blk</span> <span class="id">x</span> <span class="id">cx</span> Γ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Is_defined_in">Syn.Is_defined_in</a></span> <span class="id">x</span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in">Is_defined_in</a></span> Γ <span class="id">cx</span> <span class="id">blk</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.block_ind2">block_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Hin</span> <span class="id">Hdep</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hdep</span>; <span class="id">inv_VarsDefined</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">lcaus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">simpl_Exists</span>; <span class="id">simpl_Forall</span>; <span class="tactic">econstructor</span>; <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="tactic">try</span> (<span class="tactic">destruct</span> <span class="id">b</span>; <span class="id">destruct_conjs</span>; <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_branch_Is_defined_branch">Is_defined_branch_Is_defined_branch</a></span>; <span class="tactic">eauto</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="tactic">try</span> <span class="tactic">destruct</span> <span class="id">s</span>; <span class="tactic">try</span> (<span class="id">destruct_conjs</span>; <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_scope_Is_defined_scope">Is_defined_scope_Is_defined_scope</a></span>; <span class="tactic">eauto</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="tactic">repeat</span> <span class="id">simpl_Exists</span>; <span class="id">simpl_Forall</span>; <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> Causality check </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="LCAUSALITY.collect_free">collect_free</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="LCAUSALITY.collect_free.cenv">cenv</a></span> <span class="id"><a name="LCAUSALITY.collect_free.cenvl">cenvl</a></span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.assemble_brs_free_left_list">assemble_brs_free_left_list</a></span> {<span class="id">A</span>} <span class="id">pss</span> (<span class="id">tys</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">List.fold_left</a></span> (<span class="kwd">fun</span> <span class="id">ps1</span> <span class="id">ps2</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> '(<span class="id">ps1</span>, <span class="id">ps2</span>) =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.union">PS.union</a></span> <span class="id">ps1</span> <span class="id">ps2</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">List.combine</a></span> <span class="id">ps1</span> <span class="id">ps2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pss</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>) <span class="id">tys</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.collect_free_var">collect_free_var</a></span> <span class="id">cenv</span> (<span class="id">x</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="LCAUSALITY.collect_free_clock">collect_free_clock</a></span> (<span class="id">ck</span> : <span class="id"><a href="Velus.Lustre.LCausality.html#Cks.clock">clock</a></span>) : <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ck</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Cks.Cbase">Cbase</a></span> =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Cks.Con">Con</a></span> <span class="id">ck</span> <span class="id">x</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.add">PS.add</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var">collect_free_var</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free.cenv">cenv</a></span> <span class="id">x</span>) (<span class="id">collect_free_clock</span> <span class="id">ck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="LCAUSALITY.collect_free_left">collect_free_left</a></span> (<span class="id">e</span> : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.exp">exp</a></span>) {<span class="kwd">struct</span> <span class="id">e</span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">collect_free_left_list</span> (<span class="id">es</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.exp">exp</a></span>) := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id">collect_free_left</span> <span class="id">es</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Econst">Econst</a></span> <span class="id">_</span> | <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Eenum">Eenum</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; [<span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Evar">Evar</a></span> <span class="id">x</span> <span class="id">_</span> =&gt; [<span class="id"><a href="Velus.Common.Common.html#PS.singleton">PS.singleton</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var">collect_free_var</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free.cenv">cenv</a></span> <span class="id">x</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Elast">Elast</a></span> <span class="id">x</span> <span class="id">_</span> =&gt; [<span class="id"><a href="Velus.Common.Common.html#PS.singleton">PS.singleton</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var">collect_free_var</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free.cenvl">cenvl</a></span> <span class="id">x</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Eunop">Eunop</a></span> <span class="id">_</span> <span class="id">e</span> <span class="id">_</span> =&gt; (<span class="id">collect_free_left</span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Ebinop">Ebinop</a></span> <span class="id">_</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ps1</span> := <span class="id">collect_free_left</span> <span class="id">e1</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ps2</span> := <span class="id">collect_free_left</span> <span class="id">e2</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> '(<span class="id">ps1</span>, <span class="id">ps2</span>) =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.union">PS.union</a></span> <span class="id">ps1</span> <span class="id">ps2</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">List.combine</a></span> <span class="id">ps1</span> <span class="id">ps2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Eextcall">Eextcall</a></span> <span class="id">_</span> <span class="id">es</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="Velus.Common.CommonPS.html#PSUnion">PSUnion</a></span> (<span class="id">collect_free_left_list</span> <span class="id">es</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Efby">Efby</a></span> <span class="id">e0s</span> <span class="id">_</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">collect_free_left_list</span> <span class="id">e0s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Earrow">Earrow</a></span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ps1</span> := <span class="id">collect_free_left_list</span> <span class="id">e0s</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ps2</span> := <span class="id">collect_free_left_list</span> <span class="id">es</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> '(<span class="id">ps1</span>, <span class="id">ps2</span>) =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.union">PS.union</a></span> <span class="id">ps1</span> <span class="id">ps2</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">List.combine</a></span> <span class="id">ps1</span> <span class="id">ps2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Ewhen">Ewhen</a></span> <span class="id">es</span> (<span class="id">x</span>, <span class="id">_</span>) <span class="id">_</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">cx</span> := <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var">collect_free_var</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free.cenv">cenv</a></span> <span class="id">x</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">ps</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.add">PS.add</a></span> <span class="id">cx</span> <span class="id">ps</span>) (<span class="id">collect_free_left_list</span> <span class="id">es</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Emerge">Emerge</a></span> (<span class="id">x</span>, <span class="id">_</span>) <span class="id">es</span> (<span class="id">tys</span>, <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ps</span> := <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.assemble_brs_free_left_list">assemble_brs_free_left_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id">collect_free_left_list</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>)) <span class="id">es</span>) <span class="id">tys</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="Velus.Common.Common.html#PS.add">PS.add</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var">collect_free_var</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free.cenv">cenv</a></span> <span class="id">x</span>)) <span class="id">ps</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Ecase">Ecase</a></span> <span class="id">e</span> <span class="id">es</span> <span class="id">d</span> (<span class="id">tys</span>, <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ps0</span> := <span class="id">collect_free_left</span> <span class="id">e</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">psd</span> := <span class="id"><a href="Velus.Common.Common.html#or_default_with">or_default_with</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>) <span class="id">tys</span>) <span class="id">collect_free_left_list</span> <span class="id">d</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ps1</span> := <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.assemble_brs_free_left_list">assemble_brs_free_left_list</a></span> (<span class="id">psd</span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id">collect_free_left_list</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>)) <span class="id">es</span>) <span class="id">tys</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="Velus.Common.Common.html#PS.union">PS.union</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> 0 <span class="id">ps0</span> <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>)) <span class="id">ps1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Eapp">Eapp</a></span> <span class="id">_</span> <span class="id">es</span> <span class="id">er</span> <span class="id">a</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ps</span> := <span class="id"><a href="Velus.Common.CommonPS.html#PSUnion">PSUnion</a></span> (<span class="id">collect_free_left_list</span> <span class="id">er</span> ++ <span class="id">collect_free_left_list</span> <span class="id">es</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">ps</span>) <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.collect_free_left_list">collect_free_left_list</a></span> (<span class="id">es</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.exp">exp</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left">collect_free_left</a></span> <span class="id">es</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free">collect_free</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.unions_fuse">unions_fuse</a></span> <span class="id">envs</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">List.fold_left</a></span> (<span class="id"><a href="Velus.Environment.html#Env.union_fuse">Env.union_fuse</a></span> <span class="id"><a href="Velus.Common.Common.html#PS.union">PS.union</a></span>) <span class="id">envs</span> (@<span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id">_</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.collect_depends_last_decls">collect_depends_last_decls</a></span> <span class="id">cenv</span> <span class="id">cenvl</span> (<span class="id">decls</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.decl">decl</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">o</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">cx</span>) =&gt; (<span class="id">cx</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> 0 (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left">collect_free_left</a></span> <span class="id">cenv</span> <span class="id">cenvl</span> <span class="id">e</span>) <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>)) <span class="id">o</span>) <span class="id">decls</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.collect_depends_scope">collect_depends_scope</a></span> {<span class="id">A</span>} (<span class="id">f_coll</span> : <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">A</span> -&gt; <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span>) (<span class="id">cenv</span> <span class="id">cenvl</span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.scope">scope</a></span> <span class="id">A</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span> := <span class="id">s</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">cenv</span>' := <span class="id">Env.adds</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">cx</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">cx</span>)) <span class="id">locs</span>) <span class="id">cenv</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">cenvl</span>' := <span class="id">Env.adds</span>' (<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">o</span>)) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">cx</span>) =&gt; (<span class="id">x</span>, <span class="id">cx</span>)) <span class="id">o</span>) <span class="id">locs</span>) <span class="id">cenvl</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">deps1</span> := <span class="id">f_coll</span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">blks</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">deps2</span> := <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_last_decls">collect_depends_last_decls</a></span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">locs</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.union_fuse">Env.union_fuse</a></span> <span class="id"><a href="Velus.Common.Common.html#PS.union">PS.union</a></span> <span class="id">deps1</span> <span class="id">deps2</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.collect_depends_branch">collect_depends_branch</a></span> {<span class="id">A</span>} (<span class="id">f_coll</span> : <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">A</span> -&gt; <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span>) (<span class="id">cenv</span> <span class="id">cenvl</span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.branch">branch</a></span> <span class="id">A</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span> := <span class="id">s</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">cenv</span>' := <span class="id"><a href="Velus.Environment.html#Env.mapi">Env.mapi</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">cx</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span> <span class="id">cx</span> (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">x</span> <span class="id">caus</span>)) <span class="id">cenv</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">deps1</span> := <span class="id">f_coll</span> <span class="id">cenv</span>' <span class="id">cenvl</span> <span class="id">blks</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">deps2</span> := <span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">cx</span>) =&gt; (<span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>), <span class="id"><a href="Velus.Common.Common.html#PS.singleton">PS.singleton</a></span> <span class="id">cx</span>)) <span class="id">caus</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.union_fuse">Env.union_fuse</a></span> <span class="id"><a href="Velus.Common.Common.html#PS.union">PS.union</a></span> <span class="id">deps1</span> <span class="id">deps2</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="LCAUSALITY.collect_depends_on">collect_depends_on</a></span> (<span class="id">cenv</span> <span class="id">cenvl</span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id">d</span> : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.block">block</a></span>) : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">d</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Beq">Beq</a></span> (<span class="id">xs</span>, <span class="id">es</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">List.combine</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var">collect_free_var</a></span> <span class="id">cenv</span>) <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_list">collect_free_left_list</a></span> <span class="id">cenv</span> <span class="id">cenvl</span> <span class="id">es</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Breset">Breset</a></span> <span class="id">blocks</span> <span class="id">er</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">pr</span> := <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left">collect_free_left</a></span> <span class="id">cenv</span> <span class="id">cenvl</span> <span class="id">er</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.map">Env.map</a></span> (<span class="kwd">fun</span> <span class="id">ps</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.union">PS.union</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> 0 <span class="id">pr</span> <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>) <span class="id">ps</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse">unions_fuse</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id">collect_depends_on</span> <span class="id">cenv</span> <span class="id">cenvl</span>) <span class="id">blocks</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bswitch">Bswitch</a></span> <span class="id">ec</span> <span class="id">branches</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">pc</span> := <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left">collect_free_left</a></span> <span class="id">cenv</span> <span class="id">cenvl</span> <span class="id">ec</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.map">Env.map</a></span> (<span class="kwd">fun</span> <span class="id">ps</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.union">PS.union</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> 0 <span class="id">pc</span> <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>) <span class="id">ps</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse">unions_fuse</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">blks</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_branch">collect_depends_branch</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">cenv</span> <span class="id">cenvl</span> <span class="id">blks</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse">unions_fuse</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id">collect_depends_on</span> <span class="id">cenv</span> <span class="id">cenvl</span>) <span class="id">blks</span>)) <span class="id">cenv</span> <span class="id">cenvl</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">blks</span>)) <span class="id">branches</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bauto">Bauto</a></span> <span class="id">_</span> <span class="id">ck</span> (<span class="id">ini</span>, <span class="id">oth</span>) <span class="id">states</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">pc1</span> := <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_clock">collect_free_clock</a></span> <span class="id">cenv</span> <span class="id">ck</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">pc2</span> := <span class="id"><a href="Velus.Common.CommonPS.html#PSUnion">PSUnion</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> 0 (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left">collect_free_left</a></span> <span class="id">cenv</span> <span class="id">cenvl</span> <span class="id">e</span>) <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>) <span class="id">ini</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">pc3</span> := <span class="id"><a href="Velus.Common.CommonPS.html#PSUnion">PSUnion</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">_</span> (<span class="id">unl</span>, <span class="id">_</span>)) =&gt; <span class="id"><a href="Velus.Common.CommonPS.html#PSUnion">PSUnion</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> 0 (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left">collect_free_left</a></span> <span class="id">cenv</span> <span class="id">cenvl</span> <span class="id">e</span>) <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>) <span class="id">unl</span>)) <span class="id">states</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">pc</span> := <span class="id"><a href="Velus.Common.Common.html#PS.union">PS.union</a></span> <span class="id">pc1</span> (<span class="id"><a href="Velus.Common.Common.html#PS.union">PS.union</a></span> <span class="id">pc2</span> <span class="id">pc3</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.map">Env.map</a></span> (<span class="kwd">fun</span> <span class="id">ps</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.union">PS.union</a></span> <span class="id">pc</span> <span class="id">ps</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse">unions_fuse</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">br</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_branch">collect_depends_branch</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">cenv</span> <span class="id">cenvl</span> '(<span class="id">_</span>, <span class="id">blks</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_scope">collect_depends_scope</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">cenv</span> <span class="id">cenvl</span> <span class="id">blks</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse">unions_fuse</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id">collect_depends_on</span> <span class="id">cenv</span> <span class="id">cenvl</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">blks</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cenv</span> <span class="id">cenvl</span> <span class="id">blks</span>) <span class="id">cenv</span> <span class="id">cenvl</span> <span class="id">br</span>) <span class="id">states</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Blocal">Blocal</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.scope">scope</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_scope">collect_depends_scope</a></span> (<span class="kwd">fun</span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">blks</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse">unions_fuse</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id">collect_depends_on</span> <span class="id">cenv</span>' <span class="id">cenvl</span>') <span class="id">blks</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cenv</span> <span class="id">cenvl</span> <span class="id">scope</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.build_graph">build_graph</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">n</span> : @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.node">node</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">cenv</span> := <span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">cx</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">cx</span>)) (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">cenvl</span> := <span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">o</span>)) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">cx</span>) =&gt; (<span class="id">x</span>, <span class="id">cx</span>)) <span class="id">o</span>) (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">indeps</span> := <span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">cx</span>)) =&gt; (<span class="id">cx</span>, <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>)) (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id">n</span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">blkdeps</span> := <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_on">collect_depends_on</a></span> <span class="id">cenv</span> <span class="id">cenvl</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_block">n_block</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">lastdeps</span> := <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_last_decls">collect_depends_last_decls</a></span> <span class="id">cenv</span> <span class="id">cenvl</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse">unions_fuse</a></span> [<span class="id">indeps</span>; <span class="id">blkdeps</span>; <span class="id">lastdeps</span>].<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="LCAUSALITY.msgs_of_labels">msgs_of_labels</a></span>.<br/>
<div class="doc">Generate an error message for each causality label in the block/node </div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.msgs_of_decl">msgs_of_decl</a></span> (<span class="id">x</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * (<span class="id"><a href="Velus.Lustre.LCausality.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LCausality.html#Cks.clock">clock</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.exp">exp</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>))) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">cx</span>, <span class="id">o</span>)) := <span class="id">x</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">cx</span>, [<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">x</span>])::<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">match</span> <span class="id">o</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">_</span>, <span class="id">clx</span>) =&gt; [(<span class="id">clx</span>, [<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">last</span> "; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">x</span>])]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.msg_of_caus">msg_of_caus</a></span> (<span class="id">tag</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id">x</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">x</span>, <span class="id">cx</span>) := <span class="id">x</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">cx</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">x</span>::<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "(" :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">tag</span> :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> ")").<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.enum_nth_constructor">enum_nth_constructor</a></span> (<span class="id">ty</span> : <span class="id"><a href="Velus.Lustre.LCausality.html#Op.type">type</a></span>) <span class="id">k</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ty</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Op.Tenum">Tenum</a></span> <span class="id">_</span> <span class="id">tys</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">List.nth</a></span> <span class="id">k</span> <span class="id">tys</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="LCAUSALITY.msgs_of_local_labels">msgs_of_local_labels</a></span> (<span class="id">blk</span> : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.block">block</a></span>) : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#errmsg">errmsg</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">blk</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Beq">Beq</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Breset">Breset</a></span> <span class="id">blks</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.unions">Env.unions</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">msgs_of_local_labels</span> <span class="id">blks</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bswitch">Bswitch</a></span> <span class="id">e</span> <span class="id">brs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ty</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#hd">List.hd</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#OpAux.bool_velus_type">bool_velus_type</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.typeof">typeof</a></span> <span class="id">e</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.unions">Env.unions</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">k</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">tag</span> := <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.enum_nth_constructor">enum_nth_constructor</a></span> <span class="id">ty</span> <span class="id">k</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Env.adds</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.msg_of_caus">msg_of_caus</a></span> <span class="id">tag</span>) <span class="id">caus</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Environment.html#Env.unions">Env.unions</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">msgs_of_local_labels</span> <span class="id">blks</span>))) <span class="id">brs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Bauto">Bauto</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">states</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.unions">Env.unions</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '((<span class="id">_</span>, <span class="id">tag</span>), <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> (<span class="id">_</span>, <span class="kwd">Scope</span> <span class="id">locs</span> (<span class="id">blks</span>, <span class="id">_</span>))) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Env.adds</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.msg_of_caus">msg_of_caus</a></span> <span class="id">tag</span>) <span class="id">caus</span>++<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.msgs_of_decl">msgs_of_decl</a></span> <span class="id">locs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Environment.html#Env.unions">Env.unions</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">msgs_of_local_labels</span> <span class="id">blks</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="id">states</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Blocal">Blocal</a></span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Env.adds</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.msgs_of_decl">msgs_of_decl</a></span> <span class="id">locs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Environment.html#Env.unions">Env.unions</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">msgs_of_local_labels</span> <span class="id">blks</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.msgs_of_ins">msgs_of_ins</a></span> (<span class="id">x</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * (<span class="id"><a href="Velus.Lustre.LCausality.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LCausality.html#Cks.clock">clock</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">cx</span>)) := <span class="id">x</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">cx</span>, [<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> <span class="id">x</span>]).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.msgs_of_labels">msgs_of_labels</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">n</span> : @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.node">node</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#errmsg">errmsg</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Env.adds</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.msgs_of_ins">msgs_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.msgs_of_decl">msgs_of_decl</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.msgs_of_local_labels">msgs_of_local_labels</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_block">n_block</a></span> <span class="id">n</span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.msgs_of_labels">msgs_of_labels</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.check_node_causality">check_node_causality</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">n</span> : @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.node">node</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">idcaus</span> := (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_decls">idcaus_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_locals">idcaus_of_locals</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_block">n_block</a></span> <span class="id">n</span>))) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">graph</span> := <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.build_graph">build_graph</a></span> <span class="id">n</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Common.Common.html#check_nodup">check_nodup</a></span> <span class="id">idcaus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <span class="id"><a href="Velus.Common.Common.html#PS.equal">PS.equal</a></span> (<span class="id"><a href="Velus.Common.Common.html#PSP.of_list">PSP.of_list</a></span> <span class="id">idcaus</span>) (<span class="id"><a href="Velus.Common.Common.html#PSP.of_list">PSP.of_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">graph</span>))) <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.AcyGraph.html#build_acyclic_graph">build_acyclic_graph</a></span> (<span class="id"><a href="Velus.Environment.html#Env.map">Env.map</a></span> <span class="id"><a href="Velus.Common.Common.html#PSP.to_list">PSP.to_list</a></span> <span class="id">graph</span>) (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.msgs_of_labels">msgs_of_labels</a></span> <span class="id">n</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#msg">msg</a></span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">Node</span> " :: (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_name">n_name</a></span> <span class="id">n</span>)) :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> " : " :: <span class="id">msg</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Error</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">Node</span> " :: (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#CTX">CTX</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_name">n_name</a></span> <span class="id">n</span>)) :: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#MSG">MSG</a></span> " <span class="id">has</span> <span class="id">duplicated</span> <span class="id">causality</span> <span class="id">annotations</span>" :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCAUSALITY.check_causality">check_causality</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.check_node_causality">check_node_causality</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.nodes">nodes</a></span> <span class="id">G</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id">collect_free_left_list_length</span>' <span class="id">cenv</span> <span class="id">cenv</span>' : <span class="kwd">forall</span> <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left">collect_free_left</a></span> <span class="id">cenv</span> <span class="id">cenv</span>' <span class="id">e</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.annot">annot</a></span> <span class="id">e</span>)) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_list">collect_free_left_list</a></span> <span class="id">cenv</span> <span class="id">cenv</span>' <span class="id">es</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.annots">annots</a></span> <span class="id">es</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">es</span>; <span class="tactic">intros</span> * <span class="id">Hf</span>; <span class="id">inv</span> <span class="id">Hf</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_length">app_length</a></span>. <span class="tactic">f_equal</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.assemble_brs_free_left_list_length">assemble_brs_free_left_list_length</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> <span class="id">pss</span> (<span class="id">tys</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">ps</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">ps</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">tys</span>) <span class="id">pss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.assemble_brs_free_left_list">assemble_brs_free_left_list</a></span> <span class="id">pss</span> <span class="id">tys</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">tys</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.assemble_brs_free_left_list">assemble_brs_free_left_list</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">ps</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">ps</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>) <span class="id">tys</span>)) <span class="id">pss</span>) <span class="kwd">as</span> <span class="id">Hlen</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="tactic">eauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>; <span class="tactic">auto</span>. } <span class="tactic">clear</span> <span class="id">Hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">tys</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>) <span class="id">tys</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hlen</span>'. <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>) <span class="id">tys</span>). <span class="tactic">clear</span> <span class="id">tys</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">pss</span>; <span class="tactic">intros</span>; <span class="id">inv</span> <span class="id">Hlen</span>'; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHpss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine_length">combine_length</a></span>, <span class="id">H1</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.min_id">Nat.min_id</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine_length">combine_length</a></span>, <span class="id">Heq</span>, <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.min_id">Nat.min_id</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.collect_free_left_length">collect_free_left_length</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">cenv</span> <span class="id">cenv</span>' <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_exp">wl_exp</a></span> <span class="id">G</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left">collect_free_left</a></span> <span class="id">cenv</span> <span class="id">cenv</span>' <span class="id">e</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.annot">annot</a></span> <span class="id">e</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Ltac</span> <span class="id">solve_forall</span> <span class="id">H</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_Forall">Forall_Forall</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="tactic">eauto</span>; <span class="tactic">intros</span> ? [? ?]; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.exp_ind2">exp_ind2</a></span>; <span class="tactic">intros</span> <span class="id">Hwl</span>; <span class="id">inv</span> <span class="id">Hwl</span>; <span class="id">destruct_conjs</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;unop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.length_annot_numstreams">length_annot_numstreams</a></span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">rewrite</span> <span class="id">IHe</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;binop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.length_annot_numstreams">length_annot_numstreams</a></span> <span class="kwd">in</span> <span class="id">H6</span>, <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine_length">combine_length</a></span>, <span class="id">IHe1</span>, <span class="id">IHe2</span>, <span class="id">H6</span>, <span class="id">H7</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;fby&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">collect_free_left_list_length</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_forall</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;arrow&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine_length">combine_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">collect_free_left_list_length</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H7</span>, <span class="id">H8</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.min_id">PeanoNat.Nat.min_id</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_forall</span> <span class="id">H</span>. <span class="id">solve_forall</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;when&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">collect_free_left_list_length</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_forall</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;merge&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.assemble_brs_free_left_list_length">assemble_brs_free_left_list_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_map">Forall_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> *; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id">H6</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">collect_free_left_list_length</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">specialize</span> (<span class="id">H5</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_forall</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.assemble_brs_free_left_list_length">assemble_brs_free_left_list_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. 2:<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id">H12</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">collect_free_left_list_length</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_impl_In">Forall_impl_In</a></span>; [|<span class="tactic">eapply</span> <span class="id">H0</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_map">Forall_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> *; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id">H10</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id">H1</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">specialize</span> (<span class="id">H9</span> <span class="id">_</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">collect_free_left_list_length</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_impl_In">Forall_impl_In</a></span>; [|<span class="tactic">eauto</span>]. <span class="tactic">intros</span> ? <span class="id">Hin</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;app&nbsp;*)</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCAUSALITY.collect_free_left_list_length">collect_free_left_list_length</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">cenv</span> <span class="id">cenv</span>' <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_exp">wl_exp</a></span> <span class="id">G</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_list">collect_free_left_list</a></span> <span class="id">cenv</span> <span class="id">cenv</span>' <span class="id">es</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.annots">annots</a></span> <span class="id">es</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">collect_free_left_list_length</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> ? ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_length">collect_free_left_length</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="LCAUSALITY.collect_free_spec">collect_free_spec</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> Γ : <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.static_env">static_env</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id">cenv</span>' <span class="id">cenvl</span>' : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCAUSALITY.collect_free_spec.Heq">Heq</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCAUSALITY.collect_free_spec.Heql">Heql</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenvl</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.collect_free_var_correct">collect_free_var_correct</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> Γ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var">collect_free_var</a></span> <span class="id">cenv</span>' <span class="id">x</span> = <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hinm</span> <span class="id">Hcoll</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var">collect_free_var</a></span> <span class="kwd">in</span> <span class="id">Hcoll</span>. <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_spec.Heq">Heq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) <span class="kwd">as</span> (?&amp;<span class="id">Hhas</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_In">InMembers_In</a></span> <span class="kwd">in</span> <span class="id">Hinm</span>; <span class="id">simpl_In</span>. <span class="tactic">destruct</span> <span class="id">Hinm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplit</span>. <span class="tactic">econstructor</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_spec.Heq">Heq</a></span> <span class="kwd">in</span> <span class="id">Hhas</span>. <span class="tactic">setoid_rewrite</span> <span class="id">Hhas</span> <span class="kwd">in</span> <span class="id">Hcoll</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCAUSALITY.collect_free_spec.Hnd1">Hnd1</a></span> : <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.collect_free_var_complete">collect_free_var_complete</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var">collect_free_var</a></span> <span class="id">cenv</span>' <span class="id">x</span> = <span class="id">cx</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var">collect_free_var</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_spec.Heq">Heq</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">Hin</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.collect_free_last_complete">collect_free_last_complete</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var">collect_free_var</a></span> <span class="id">cenvl</span>' <span class="id">x</span> = <span class="id">cx</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var">collect_free_var</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_spec.Heql">Heql</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id">Hin</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">collect_free_left_list_spec</span>' {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">es</span> <span class="id">x</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_exp">wl_exp</a></span> <span class="id">G</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_exp">wx_exp</a></span> Γ) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_exp">wl_exp</a></span> <span class="id">G</span> <span class="id">e</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_exp">wx_exp</a></span> Γ <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">x</span> <span class="id">k</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left">collect_free_left</a></span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">e</span>) <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>)) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list">Is_free_left_list</a></span> Γ <span class="id">x</span> <span class="id">k</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">List.nth</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_list">collect_free_left_list</a></span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">es</span>) <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">es</span>; <span class="tactic">intros</span> * <span class="id">Hwl</span> <span class="id">Hwx</span> <span class="id">Hf</span> <span class="id">Hfree</span>; <span class="id">inv</span> <span class="id">Hwl</span>; <span class="id">inv</span> <span class="id">Hwx</span>; <span class="id">inv</span> <span class="id">Hf</span>. <span class="id">inv</span> <span class="id">Hfree</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left">collect_free_left</a></span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">a</span>) = <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.numstreams">numstreams</a></span> <span class="id">a</span>) <span class="kwd">as</span> <span class="id">Hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_length">collect_free_left_length</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.length_annot_numstreams">length_annot_numstreams</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nth1">app_nth1</a></span>. <span class="tactic">apply</span> <span class="id">H5</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nth2">app_nth2</a></span>. <span class="tactic">apply</span> <span class="id">IHes</span>; <span class="tactic">eauto</span>. 1,2:<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">psunion_collect_free_list_spec</span>' {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">es</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_exp">wl_exp</a></span> <span class="id">G</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_exp">wx_exp</a></span> Γ) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_exp">wl_exp</a></span> <span class="id">G</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_exp">wx_exp</a></span> Γ <span class="id">e</span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">x</span> <span class="id">k</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left">collect_free_left</a></span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">e</span>) <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>)) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">k</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">x</span> <span class="id">k</span>') <span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Common.CommonPS.html#PSUnion">PSUnion</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_list">collect_free_left_list</a></span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">es</span>)).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">es</span>; <span class="tactic">intros</span> * <span class="id">Hwl</span> <span class="id">Hwx</span> <span class="id">Hf</span> (?&amp;<span class="id">Hex</span>); <span class="id">inv</span> <span class="id">Hwl</span>; <span class="id">inv</span> <span class="id">Hwx</span>; <span class="id">inv</span> <span class="id">Hf</span>. <span class="id">inv</span> <span class="id">Hex</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSUnion_In_app">PSUnion_In_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hex</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id">Hk</span>:=<span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_length">Is_free_left_length</a></span> <span class="kwd">in</span> <span class="id">Hk</span>; <span class="tactic">eauto</span>; <span class="id">erewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_length">collect_free_left_length</a></span> <span class="kwd">in</span> <span class="id">Hk</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">left</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonPS.html#In_In_PSUnion">In_In_PSUnion</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_In">nth_In</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">right</span>. <span class="tactic">apply</span> <span class="id">IHes</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.ps_In_k_lt">ps_In_k_lt</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">l</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id">k</span> <span class="id">l</span> <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">l</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span> * <span class="id">Hin</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonPS.html#not_In_empty">not_In_empty</a></span>. <span class="tactic">destruct</span> <span class="id">k</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">k</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.lt_0_succ">PeanoNat.Nat.lt_0_succ</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.succ_lt_mono">Nat.succ_lt_mono</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.Exists_Exists_Is_free">Exists_Exists_Is_free</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">es</span> <span class="id">x</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_exp">wl_exp</a></span> <span class="id">G</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span> = 1) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">x</span> <span class="id">k</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">x</span> 0) <span class="id">es</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Wl</span> <span class="id">Num</span> <span class="id">Free</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">k</span> = 0) <span class="kwd">as</span> <span class="id">Hk</span>'; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_length">Is_free_left_length</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="tactic">eauto</span>. 2:<span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.length_annot_numstreams">length_annot_numstreams</a></span>, <span class="id">Num</span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.lt_1_r">PeanoNat.Nat.lt_1_r</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">Exists_Exists_Is_free</span> : <span class="id">lcaus</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.assemble_brs_free_left_list_spec">assemble_brs_free_left_list_spec</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">k</span> <span class="id">pss</span> (<span class="id">tys</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Op.type">type</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">ps</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">ps</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">tys</span>) <span class="id">pss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> <span class="id">ps</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">List.nth</a></span> <span class="id">k</span> <span class="id">ps</span> <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>)) <span class="id">pss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">List.nth</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.assemble_brs_free_left_list">assemble_brs_free_left_list</a></span> <span class="id">pss</span> <span class="id">tys</span>) <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.assemble_brs_free_left_list">assemble_brs_free_left_list</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">base</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">ps</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">ps</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">base</span>) <span class="id">pss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id">k</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="kwd">fun</span> <span class="id">ps1</span> <span class="id">ps2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">ps0</span>, <span class="id">ps3</span>) =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.union">PS.union</a></span> <span class="id">ps0</span> <span class="id">ps3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">ps1</span> <span class="id">ps2</span>)) <span class="id">pss</span> <span class="id">base</span>) <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> <span class="id">ps</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span> =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id">k</span> <span class="id">ps</span> <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>)) <span class="id">pss</span> \/ <span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id">k</span> <span class="id">base</span> <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span> <span class="id">Hlen</span> <span class="id">tys</span>. <span class="tactic">intros</span> * <span class="id">Hlen</span>; <span class="tactic">split</span>; <span class="id">revert</span> <span class="id">base</span> <span class="id">Hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">induction</span> <span class="id">pss</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="id">inv</span> <span class="id">Hlen</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHpss</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">H</span>|<span class="id">H</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">clear</span> - <span class="id">H2</span> <span class="id">H3</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Heq</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine_length">combine_length</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_spec.Heq">Heq</a></span>, <span class="id">H2</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.min_id">Nat.min_id</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">map_nth</span>' <span class="kwd">with</span> (<span class="id">d</span>':=(<span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>, <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>)) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.ps_In_k_lt">ps_In_k_lt</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine_nth">combine_nth</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#PS.union_spec">PS.union_spec</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">H</span>|<span class="id">H</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">induction</span> <span class="id">pss</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="id">inv</span> <span class="id">Hlen</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">IHpss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="tactic">clear</span> - <span class="id">H2</span> <span class="id">H3</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Heq</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine_length">combine_length</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_spec.Heq">Heq</a></span>, <span class="id">H2</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.min_id">Nat.min_id</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">map_nth</span>' <span class="kwd">with</span> (<span class="id">d</span>':=(<span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>, <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine_length">combine_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.ps_In_k_lt">ps_In_k_lt</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">now</span> <span class="tactic">rewrite</span> &lt;-<span class="id">H2</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.min_id">Nat.min_id</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl_Exists</span>; <span class="id">simpl_Forall</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.ps_In_k_lt">ps_In_k_lt</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H2</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.min_id">Nat.min_id</a></span>, &lt;-<span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.ps_In_k_lt">ps_In_k_lt</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H2</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.min_id">Nat.min_id</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine_nth">combine_nth</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#PS.union_spec">PS.union_spec</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hex</span>. <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.collect_free_left_spec">collect_free_left_spec</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>}: <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">x</span> <span class="id">e</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_exp">wl_exp</a></span> <span class="id">G</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_exp">wx_exp</a></span> Γ <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">x</span> <span class="id">k</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">List.nth</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left">collect_free_left</a></span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">e</span>) <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof49')">Proof with</span></div>
<div class="proofscript" id="proof49">
 <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">lcaus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.exp_ind2">exp_ind2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">intros</span> * <span class="id">Hwl</span> <span class="id">Hwx</span> <span class="id">Hfree</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_length">Is_free_left_length</a></span> <span class="id">G</span> Γ <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hwl</span> <span class="id">Hfree</span>) <span class="kwd">as</span> <span class="id">Hlen1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_length">collect_free_left_length</a></span> <span class="id">G</span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">_</span> <span class="id">Hwl</span>) <span class="kwd">as</span> <span class="id">Hlen2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">destruct</span> <span class="id">a</span> <span class="kwd">as</span> [<span class="id">ty</span> [<span class="id">ck</span> <span class="id">name</span>]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwl</span>; <span class="id">inv</span> <span class="id">Hwx</span>; <span class="id">inv</span> <span class="id">Hfree</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.length_annot_numstreams">length_annot_numstreams</a></span> <span class="kwd">in</span> *; <span class="tactic">idtac</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;var&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#PSF.singleton_2">PSF.singleton_2</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var_complete">collect_free_var_complete</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;last&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#PSF.singleton_2">PSF.singleton_2</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_last_complete">collect_free_last_complete</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;unop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHe</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;binop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_length">collect_free_left_length</a></span> <span class="kwd">with</span> (<span class="id">cenv</span>:=<span class="id">cenv</span>') (<span class="id">cenv</span>':=<span class="id">cenvl</span>') <span class="kwd">in</span> <span class="id">H6</span>, <span class="id">H7</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">singleton_length</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [?|?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#PSF.union_2">PSF.union_2</a></span>. <span class="tactic">eapply</span> <span class="id">IHe1</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#PSF.union_3">PSF.union_3</a></span>. <span class="tactic">eapply</span> <span class="id">IHe2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;extcall&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">psunion_collect_free_list_spec</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;fby&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_list_length">collect_free_left_list_length</a></span> <span class="kwd">with</span> (<span class="id">cenv</span>:=<span class="id">cenv</span>') (<span class="id">cenv</span>':=<span class="id">cenvl</span>') <span class="kwd">in</span> <span class="id">H7</span>, <span class="id">H8</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">collect_free_left_list_spec</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;arrow&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_list_length">collect_free_left_list_length</a></span> <span class="kwd">in</span> <span class="id">H7</span>, <span class="id">H8</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">map_nth</span>' <span class="kwd">with</span> (<span class="id">d</span>':=(<span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>, <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:(<span class="id">erewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id">Hlen2</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine_nth">combine_nth</a></span>. 2:<span class="tactic">setoid_rewrite</span> <span class="id">H7</span>; <span class="tactic">setoid_rewrite</span> <span class="id">H8</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#PS.union_spec">PS.union_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>; [<span class="tactic">left</span>|<span class="tactic">right</span>]; <span class="tactic">eapply</span> <span class="id">collect_free_left_list_spec</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;when&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_list_length">collect_free_left_list_length</a></span> <span class="kwd">with</span> (<span class="id">cenv</span>:=<span class="id">cenv</span>') (<span class="id">cenv</span>':=<span class="id">cenvl</span>') <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">map_nth</span>' <span class="kwd">with</span> (<span class="id">d</span>':=<span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:(<span class="id">erewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id">Hlen2</span>; <span class="tactic">eapply</span> <span class="id">Hlen1</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> [(<span class="id">_</span>&amp;?)|?]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#PSF.add_1">PSF.add_1</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var_complete">collect_free_var_complete</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#PSF.add_2">PSF.add_2</a></span>. <span class="tactic">eapply</span> <span class="id">collect_free_left_list_spec</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;merge&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">ps</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">ps</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">tys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">es0</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left">collect_free_left</a></span> <span class="id">cenv</span>' <span class="id">cenvl</span>') (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es0</span>)) <span class="id">es</span>)) <span class="kwd">as</span> <span class="id">Hlen</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span> - <span class="id">H5</span> <span class="id">H6</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_map">Forall_map</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> *; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id">H6</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_list_length">collect_free_left_list_length</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">map_nth</span>' <span class="kwd">with</span> (<span class="id">d</span>':=<span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:(<span class="id">erewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id">Hlen2</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#PSF.add_iff">PSF.add_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> [(<span class="id">_</span>&amp;?)|<span class="id">Hfree</span>]; <span class="tactic">subst</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var_complete">collect_free_var_complete</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.assemble_brs_free_left_list_spec">assemble_brs_free_left_list_spec</a></span>; <span class="tactic">auto</span>. <span class="id">solve_Exists</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">collect_free_left_list_spec</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">ps</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">ps</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">tys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.Common.html#or_default_with">or_default_with</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="Velus.Lustre.LCausality.html#Op.type">type</a></span> =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>) <span class="id">tys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">es0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.exp">exp</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left">collect_free_left</a></span> <span class="id">cenv</span>' <span class="id">cenvl</span>') <span class="id">es0</span>) <span class="id">d</span> ::<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">es0</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left">collect_free_left</a></span> <span class="id">cenv</span>' <span class="id">cenvl</span>') (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es0</span>)) <span class="id">es</span>)) <span class="kwd">as</span> <span class="id">Hlen</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. 2:<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id">H12</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_list_length">collect_free_left_list_length</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_map">Forall_map</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> *; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id">H10</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_list_length">collect_free_left_list_length</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">map_nth</span>' <span class="kwd">with</span> (<span class="id">d</span>':=<span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:(<span class="id">erewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id">Hlen2</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#PS.union_spec">PS.union_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> [(<span class="id">_</span>&amp;<span class="id">Hfree</span>)|[<span class="id">Hfree</span>|(?&amp;?&amp;<span class="id">Hfree</span>)]]; <span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2,3:<span class="tactic">right</span>; <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.assemble_brs_free_left_list_spec">assemble_brs_free_left_list_spec</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">left</span>. <span class="tactic">apply</span> <span class="id">IHe</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">right</span>. <span class="id">solve_Exists</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">collect_free_left_list_spec</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">left</span>. <span class="tactic">eapply</span> <span class="id">collect_free_left_list_spec</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;app&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">map_nth</span>'; <span class="tactic">eauto</span>. 2:<span class="tactic">exact</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Op.Tenum">Tenum</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> [], <span class="id"><a href="Velus.Lustre.LCausality.html#Cks.Cbase">Cbase</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonPS.html#PSUnion_In_app">PSUnion_In_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">right</span>. <span class="tactic">eapply</span> <span class="id">psunion_collect_free_list_spec</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">left</span>. <span class="tactic">eapply</span> <span class="id">psunion_collect_free_list_spec</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCAUSALITY.collect_free_left_list_spec">collect_free_left_list_spec</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">es</span> <span class="id">x</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_exp">wl_exp</a></span> <span class="id">G</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_exp">wx_exp</a></span> Γ) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list">Is_free_left_list</a></span> Γ <span class="id">x</span> <span class="id">k</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">List.nth</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_list">collect_free_left_list</a></span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">es</span>) <span class="id"><a href="Velus.Common.Common.html#PS.empty">PS.empty</a></span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwl</span> <span class="id">Hwx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">collect_free_left_list_spec</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="tactic">eauto</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_spec">collect_free_left_spec</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_spec">collect_free_spec</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.unions_fuse_PS_In">unions_fuse_PS_In</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">envs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse">unions_fuse</a></span> <span class="id">envs</span>) &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span>) <span class="id">envs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">envs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse">unions_fuse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">envs</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> <span class="id">envs</span>)); <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_involutive">rev_involutive</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fold_right_rev_left">fold_right_rev_left</a></span>, &lt;-<span class="id"><a href="Velus.Common.CommonList.html#Exists_rev">Exists_rev</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> <span class="id">envs</span>); <span class="tactic">split</span>; <span class="tactic">intros</span> * <span class="id">Hin</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.empty_in_iff">Env.Props.P.F.empty_in_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="id">inv</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.union_fuse_In">Env.union_fuse_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>. <span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.union_fuse_In">Env.union_fuse_In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hin</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">left</span>. <span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.equiv_env_scope">equiv_env_scope</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> Γ <span class="id">locs</span> <span class="id">cenv</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">locs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">locs</span> -&gt; ~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id">Env.adds</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x1</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">cx1</span>, <span class="id">_</span>)) =&gt; (<span class="id">x1</span>, <span class="id">cx1</span>)) <span class="id">locs</span>) <span class="id">cenv</span>') = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> (Γ ++ @<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">A</span> <span class="id">locs</span>) <span class="id">x</span> <span class="id">cx</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnd1</span> <span class="id">Hnd2</span> <span class="id">Heq</span> *. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus_app">HasCaus_app</a></span>. <span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">Env.find_adds</span>'<span class="id">_In</span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_In</span>. <span class="tactic">right</span>. <span class="tactic">econstructor</span>. <span class="id">solve_In</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">left</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Env.gsso</span>', <span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hinm</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hnd2</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>. <span class="id">inv</span> <span class="id">Hin</span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">Env.In_find_adds</span>'. 2:(<span class="id">inv</span> <span class="id">Hin</span>; <span class="id">solve_In</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_map">NoDupMembers_map</a></span>; <span class="tactic">auto</span>. <span class="tactic">intros</span>; <span class="id">destruct_conjs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.collect_depends_scope_dom">collect_depends_scope_dom</a></span> {<span class="id">A</span>} <span class="id">P_vd</span> <span class="id">P_nd</span> (<span class="id">P_wl</span>: <span class="id">A</span> -&gt; <span class="id">_</span>) <span class="id">P_wx</span> <span class="id">f_coll</span> <span class="id">P_def</span> <span class="id">P_last</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">locs</span> <span class="id">blks</span> <span class="id">xs</span> Γ <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id">xs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.VarsDefinedCompScope">VarsDefinedCompScope</a></span> <span class="id">P_vd</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupScope">NoDupScope</a></span> <span class="id">P_nd</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ) (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_scope">wl_scope</a></span> <span class="id">P_wl</span> <span class="id">G</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_scope">wx_scope</a></span> <span class="id">P_wx</span> Γ (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_scope">Is_defined_in_scope</a></span> <span class="id">P_def</span> Γ <span class="id">cx</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) \/ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in_scope">Is_last_in_scope</a></span> <span class="id">P_last</span> <span class="id">cx</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ <span class="id">xs</span> <span class="id">cenv</span>' <span class="id">cenvl</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id">xs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_vd</span> <span class="id">blks</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_nd</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_wl</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_wx</span> Γ <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_def</span> Γ <span class="id">blks</span> \/ <span class="id">P_last</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">cx</span> (<span class="id">f_coll</span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">blks</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ Γ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> Γ <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> Γ' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsLast">IsLast</a></span> Γ' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_wx</span> Γ <span class="id">blks</span> -&gt; <span class="id">P_wx</span> Γ' <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_scope">collect_depends_scope</a></span> <span class="id">f_coll</span> <span class="id">cenv</span>' <span class="id">cenvl</span>' (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnd</span> <span class="id">Hca</span> <span class="id">Hincl</span> <span class="id">Hvd</span> <span class="id">Hndloc</span> <span class="id">Hwl</span> <span class="id">Hwx</span> <span class="id">Hdef</span> <span class="id">Hp</span> <span class="id">Hwxincl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hvd</span>. <span class="id">inv</span> <span class="id">Hndloc</span>. <span class="id">inv</span> <span class="id">Hwl</span>. <span class="id">inv</span> <span class="id">Hwx</span>. <span class="tactic">subst</span> Γ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> (Γ ++ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">locs</span>)) <span class="kwd">as</span> <span class="id">Hnd</span>' <span class="tactic">by</span> (<span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupScope_NoDupMembers">NoDupScope_NoDupMembers</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.union_fuse_In">Env.union_fuse_In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hdef</span> <span class="kwd">as</span> [<span class="id">Hdef</span>|<span class="id">Hdef</span>]; <span class="id">inv</span> <span class="id">Hdef</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">Hp</span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.equiv_env_scope">equiv_env_scope</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">incl_appl</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">Hp</span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.equiv_env_scope">equiv_env_scope</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">incl_appl</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Environment.html#Env.In_from_list">Env.In_from_list</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>. <span class="id">solve_In</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.equiv_env_branch">equiv_env_branch</a></span> : <span class="kwd">forall</span> Γ <span class="id">caus</span> <span class="id">cenv</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Environment.html#Env.mapi">Env.mapi</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">cx</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span> <span class="id">cx</span> (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">x</span> <span class="id">caus</span>)) <span class="id">cenv</span>') = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ) <span class="id">x</span> <span class="id">cx</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Heq</span> *. <span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gmapi">Env.gmapi</a></span> <span class="kwd">in</span> <span class="id">Hin</span>. <span class="id">inv_equalities</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">Hf</span>. <span class="id">inv</span> <span class="id">Hf</span>. <span class="tactic">econstructor</span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">_</span> <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gmapi">Env.gmapi</a></span>. <span class="id">inv</span> <span class="id">Hin</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">a</span>.(<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.causl">causl</a></span>)) <span class="kwd">as</span> <span class="id">Hca</span> <span class="tactic">by</span> <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">Hca</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">Hca</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">_</span> <span class="id">_</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.collect_depends_branch_dom">collect_depends_branch_dom</a></span> {<span class="id">A</span>} <span class="id">P_vd</span> <span class="id">P_nd</span> (<span class="id">P_wl</span>: <span class="id">A</span> -&gt; <span class="id">_</span>) <span class="id">P_wx</span> <span class="id">f_coll</span> <span class="id">P_def</span> <span class="id">P_last</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">caus</span> <span class="id">blks</span> <span class="id">xs</span> Γ <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id">xs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.VarsDefinedCompBranch">VarsDefinedCompBranch</a></span> <span class="id">P_vd</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupBranch">NoDupBranch</a></span> <span class="id">P_nd</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_branch">wl_branch</a></span> <span class="id">P_wl</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_branch">wx_branch</a></span> <span class="id">P_wx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_branch">Is_defined_in_branch</a></span> <span class="id">P_def</span> Γ <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) \/ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in_branch">Is_last_in_branch</a></span> <span class="id">P_last</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ' <span class="id">xs</span> <span class="id">cenv</span>' <span class="id">cenvl</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id">xs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> Γ <span class="id">x</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> Γ' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsLast">IsLast</a></span> Γ' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_vd</span> <span class="id">blks</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_nd</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_wl</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_wx</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_def</span> Γ' <span class="id">blks</span> \/ <span class="id">P_last</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">cx</span> (<span class="id">f_coll</span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">blks</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_branch">collect_depends_branch</a></span> <span class="id">f_coll</span> <span class="id">cenv</span>' <span class="id">cenvl</span>' (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnd</span> <span class="id">Hca</span> <span class="id">Hincl</span> <span class="id">Hvd</span> <span class="id">Hndloc</span> <span class="id">Hwl</span> <span class="id">Hwx</span> <span class="id">Hdef</span> <span class="id">Hp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hvd</span>. <span class="id">inv</span> <span class="id">Hndloc</span>. <span class="id">inv</span> <span class="id">Hwl</span>. <span class="id">inv</span> <span class="id">Hwx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ)) <span class="kwd">as</span> <span class="id">Hnd</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_map">NoDupMembers_map</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.union_fuse_In">Env.union_fuse_In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hdef</span> <span class="kwd">as</span> [<span class="id">Hdef</span>|<span class="id">Hdef</span>]; <span class="id">inv</span> <span class="id">Hdef</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">Hp</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.equiv_env_branch">equiv_env_branch</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.map_fst_replace_idcaus">map_fst_replace_idcaus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_IsVar">replace_idcaus_IsVar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_IsLast">replace_idcaus_IsLast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">right</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.In_from_list">Env.In_from_list</a></span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hca</span> <span class="kwd">in</span> <span class="id">H8</span>. <span class="tactic">rewrite</span> <span class="id">H8</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">Hp</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.equiv_env_branch">equiv_env_branch</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.map_fst_replace_idcaus">map_fst_replace_idcaus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_IsVar">replace_idcaus_IsVar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_IsLast">replace_idcaus_IsLast</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.collect_depends_on_dom">collect_depends_on_dom</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) : <span class="kwd">forall</span> <span class="id">blk</span> <span class="id">xs</span> Γ <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.VarsDefinedComp">VarsDefinedComp</a></span> <span class="id">blk</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id">xs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupLocals">NoDupLocals</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ) <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_block">wl_block</a></span> <span class="id">G</span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_block">wx_block</a></span> Γ <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in">Is_defined_in</a></span> Γ <span class="id">cx</span> <span class="id">blk</span> \/ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in">Is_last_in</a></span> <span class="id">cx</span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_on">collect_depends_on</a></span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">blk</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Opaque</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_scope">collect_depends_scope</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.block_ind2">block_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Hnd</span> <span class="id">Heq</span> <span class="id">Hvars</span> <span class="id">Hincl</span> <span class="id">Hndloc</span> <span class="id">Hwl</span> <span class="id">Hwx</span> <span class="id">Hdef</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hvars</span>; <span class="id">inv</span> <span class="id">Hndloc</span>; <span class="id">inv</span> <span class="id">Hwl</span>; <span class="id">inv</span> <span class="id">Hwx</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;equation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">eq</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.In_from_list">Env.In_from_list</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>, <span class="id">combine_map_fst</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">inv</span> <span class="id">H0</span>. <span class="id">erewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_list_length">collect_free_left_list_length</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">Hdef</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="id">inv</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var_complete">collect_free_var_complete</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.map_in_iff">Env.Props.P.F.map_in_iff</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_PS_In">unions_fuse_PS_In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">Hdef</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="id">inv</span> <span class="id">Hin</span>; <span class="id">solve_Exists</span>; <span class="id">simpl_Forall</span>; <span class="id">inv_VarsDefined</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">etransitivity</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#incl_concat">incl_concat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;switch&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.map_in_iff">Env.Props.P.F.map_in_iff</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_PS_In">unions_fuse_PS_In</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Exists_map">Exists_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Exists_impl_In">Exists_impl_In</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">s</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_branch">Is_defined_in_branch</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">s</span>) \/ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in_branch">Is_last_in_branch</a></span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">s</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">destruct</span> <span class="id">Hdef</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="id">inv</span> <span class="id">Hin</span>; <span class="id">solve_Exists</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">simpl_Forall</span>. <span class="tactic">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_branch_dom">collect_depends_branch_dom</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_PS_In">unions_fuse_PS_In</a></span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H20</span> <span class="kwd">as</span> [<span class="id">Hex</span>|<span class="id">Hex</span>]; <span class="id">solve_Exists</span>; <span class="id">inv_VarsDefined</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">solve_Exists</span>. <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">etransitivity</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">H20</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#incl_concat">incl_concat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>; [|<span class="tactic">eauto</span>]. <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar_incl_fst">IsVar_incl_fst</a></span>, <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_block_incl">wx_block_incl</a></span> <span class="kwd">with</span> (Γ:=Γ); <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">solve_Exists</span>. <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">etransitivity</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">H20</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#incl_concat">incl_concat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>; [|<span class="tactic">eauto</span>]. <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar_incl_fst">IsVar_incl_fst</a></span>, <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_block_incl">wx_block_incl</a></span> <span class="kwd">with</span> (Γ:=Γ); <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;automaton&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.map_in_iff">Env.Props.P.F.map_in_iff</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_PS_In">unions_fuse_PS_In</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Exists_map">Exists_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Exists_impl_In">Exists_impl_In</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">s</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_branch">Is_defined_in_branch</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">s</span>) \/ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in_branch">Is_last_in_branch</a></span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">s</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">destruct</span> <span class="id">Hdef</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="id">inv</span> <span class="id">Hin</span>; <span class="id">solve_Exists</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">simpl_Forall</span>. <span class="tactic">destruct</span> <span class="id">b</span> <span class="kwd">as</span> [?(?&amp;[?(?&amp;?)])].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_branch_dom">collect_depends_branch_dom</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_scope_dom">collect_depends_scope_dom</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupScope_incl">NoDupScope_incl</a></span>. 3:<span class="tactic">eauto</span>. 2:<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar_incl_fst">IsVar_incl_fst</a></span>, <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_scope_incl">wx_scope_incl</a></span>. 4:<span class="tactic">eauto</span>. <span class="id">all</span>:<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">simpl_Forall</span>; <span class="id">destruct_conjs</span>; <span class="tactic">split</span>; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_exp_incl">wx_exp_incl</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_block_incl">wx_block_incl</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">destruct_conjs</span>; <span class="tactic">split</span>; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_exp_incl">wx_exp_incl</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_block_incl">wx_block_incl</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_PS_In">unions_fuse_PS_In</a></span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H31</span> <span class="kwd">as</span> [<span class="id">Hex</span>|<span class="id">Hex</span>]; <span class="id">solve_Exists</span>; <span class="id">inv_VarsDefined</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">solve_Exists</span>. <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">H33</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#incl_concat">incl_concat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">solve_Exists</span>. <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">H33</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#incl_concat">incl_concat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;locals&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_scope_dom">collect_depends_scope_dom</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">Hdef</span> <span class="kwd">as</span> [<span class="id">Hdef</span>|<span class="id">Hdef</span>]; <span class="id">inv</span> <span class="id">Hdef</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_PS_In">unions_fuse_PS_In</a></span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H11</span> <span class="kwd">as</span> [<span class="id">Hex</span>|<span class="id">Hex</span>]; <span class="id">solve_Exists</span>; <span class="id">inv_VarsDefined</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">solve_Exists</span>. <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">H11</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#incl_concat">incl_concat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">solve_Exists</span>. <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">H11</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#incl_concat">incl_concat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_block_incl">wx_block_incl</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.unions_fuse_Subset">unions_fuse_Subset</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">envs</span> <span class="id">e</span> <span class="id">ps</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">e</span> <span class="id">envs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">e</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ps</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">ps</span>', <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse">unions_fuse</a></span> <span class="id">envs</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ps</span>' /\ <span class="id"><a href="Velus.Common.Common.html#PS.Subset">PS.Subset</a></span> <span class="id">ps</span> <span class="id">ps</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">envs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse">unions_fuse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">envs</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> <span class="id">envs</span>)); <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_involutive">rev_involutive</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fold_right_rev_left">fold_right_rev_left</a></span>. <span class="tactic">setoid_rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_rev">In_rev</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> <span class="id">envs</span>); <span class="tactic">intros</span> * <span class="id">Hin</span> <span class="id">Hfind</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.union_fuse_spec">Env.union_fuse_spec</a></span>. <span class="id">inv</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">_</span> <span class="id">_</span>); <span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>. 2:<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#PSP.union_subset_2">PSP.union_subset_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHl</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>'&amp;<span class="id">Hsub</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfind</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#PSP.union_subset_1">PSP.union_subset_1</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.collect_free_var_nodup">collect_free_var_nodup</a></span>: <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">cenv</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> <span class="id">cenv</span>') <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">cenv</span>')) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var">collect_free_var</a></span> <span class="id">cenv</span>') <span class="id">xs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</span></div>
<div class="proofscript" id="proof58">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xs</span>; <span class="tactic">intros</span> * <span class="id">Hf</span> <span class="id">Hxs</span> <span class="id">Hcenv</span>'; <span class="id">inv</span> <span class="id">Hf</span>; <span class="id">inv</span> <span class="id">Hxs</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var">collect_free_var</a></span>, <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">Hfind</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H2</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>'); <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfind</span>' <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Environment.html#Env.NoDup_snd_elements">Env.NoDup_snd_elements</a></span> <span class="kwd">with</span> (<span class="id">x1</span>:=<span class="id">a</span>) (<span class="id">x2</span>:=<span class="id">x0</span>) <span class="kwd">in</span> <span class="id">Hcenv</span>'; <span class="tactic">eauto</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.NoDup_locals_inv">NoDup_locals_inv</a></span> : <span class="kwd">forall</span> <span class="id">blks</span> <span class="id">blk</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">blk</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id">xs</span> ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_locals">idcaus_of_locals</a></span> <span class="id">blks</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id">xs</span> ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_locals">idcaus_of_locals</a></span> <span class="id">blk</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof59')">Proof.</span></div>
<div class="proofscript" id="proof59">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hin</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#nodup_app_map_flat_map">nodup_app_map_flat_map</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.NoDup_locals_inv2">NoDup_locals_inv2</a></span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f_idcaus</span> : <span class="id">B</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>)) : <span class="kwd">forall</span> (<span class="id">brs</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id">A</span> * <span class="id">B</span>)) <span class="id">k</span> <span class="id">blks</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">k</span>, <span class="id">blks</span>) <span class="id">brs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id">xs</span> ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">blks</span>) =&gt; <span class="id">f_idcaus</span> <span class="id">blks</span>) <span class="id">brs</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id">xs</span> ++ <span class="id">f_idcaus</span> <span class="id">blks</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof60')">Proof.</span></div>
<div class="proofscript" id="proof60">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hin</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#nodup_app_map_flat_map">nodup_app_map_flat_map</a></span> <span class="kwd">with</span> (<span class="id">ys</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">brs</span>); <span class="tactic">eauto</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map_ext">flat_map_ext</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">destruct_conjs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.NoDup_locals_inv3">NoDup_locals_inv3</a></span> {<span class="id">A</span> <span class="id">B</span> <span class="id">T</span>} (<span class="id">f_idcaus</span> : <span class="id">B</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>)) : <span class="kwd">forall</span> (<span class="id">brs</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id">A</span> * (<span class="id">T</span> * <span class="id">B</span>))) <span class="id">k</span> <span class="id">trans</span> <span class="id">blks</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">k</span>, (<span class="id">trans</span>, <span class="id">blks</span>)) <span class="id">brs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id">xs</span> ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, (<span class="id">_</span>, <span class="id">blks</span>)) =&gt; <span class="id">f_idcaus</span> <span class="id">blks</span>) <span class="id">brs</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id">xs</span> ++ <span class="id">f_idcaus</span> <span class="id">blks</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof61')">Proof.</span></div>
<div class="proofscript" id="proof61">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hin</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#nodup_app_map_flat_map">nodup_app_map_flat_map</a></span> <span class="kwd">with</span> (<span class="id">ys</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span>)) <span class="id">brs</span>); <span class="tactic">eauto</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map_ext">flat_map_ext</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">destruct_conjs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.map_fst_map_filter">map_fst_map_filter</a></span> : <span class="kwd">forall</span> (<span class="id">locs</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * (<span class="id"><a href="Velus.Lustre.LCausality.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LCausality.html#Cks.clock">clock</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">_</span>))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x0</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">o</span>)) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">cx</span>) =&gt; (<span class="id">x0</span>, <span class="id">cx</span>)) <span class="id">o</span>) <span class="id">locs</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x0</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">o</span>)) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.exp">exp</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> =&gt; <span class="id">x0</span>) <span class="id">o</span>) <span class="id">locs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof62')">Proof.</span></div>
<div class="proofscript" id="proof62">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#map_map_filter">map_map_filter</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#map_filter_ext">map_filter_ext</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">destruct_conjs</span>. <span class="tactic">destruct</span> <span class="id">o</span> <span class="kwd">as</span> [(?&amp;?)|]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.equiv_env_last_scope">equiv_env_last_scope</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> Γ <span class="id">locs</span> <span class="id">cenv</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">locs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">locs</span> -&gt; ~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id">Env.adds</span>' (<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x2</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">o</span>)) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">cx0</span>) =&gt; (<span class="id">x2</span>, <span class="id">cx0</span>)) <span class="id">o</span>) <span class="id">locs</span>) <span class="id">cenv</span>') = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> (Γ ++ @<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">A</span> <span class="id">locs</span>) <span class="id">x</span> <span class="id">cx</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof63')">Proof.</span></div>
<div class="proofscript" id="proof63">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnd1</span> <span class="id">Hnd2</span> <span class="id">Heq</span> *. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus_app">HasLastCaus_app</a></span>. <span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">Env.find_adds</span>'<span class="id">_In</span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_In</span>. <span class="tactic">right</span>. <span class="tactic">econstructor</span>. <span class="id">solve_In</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">left</span>. <span class="tactic">eapply</span> <span class="id">Heq</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Env.gsso</span>', <span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hinm</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hnd2</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>. <span class="id">inv</span> <span class="id">Hin</span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">Env.In_find_adds</span>'. 2:(<span class="id">inv</span> <span class="id">Hin</span>; <span class="id">solve_In</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_map_filter">NoDupMembers_map_filter</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">destruct_conjs</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">o</span> <span class="kwd">as</span> [(?&amp;?)|]; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.equiv_env_last_branch">equiv_env_last_branch</a></span> : <span class="kwd">forall</span> Γ <span class="id">caus</span> <span class="id">cenv</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">caus</span> Γ) <span class="id">x</span> <span class="id">cx</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof64')">Proof.</span></div>
<div class="proofscript" id="proof64">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Heq</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_HasLastCaus">replace_idcaus_HasLastCaus</a></span>, <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.collect_free_clock_spec">collect_free_clock_spec</a></span> : <span class="kwd">forall</span> Γ <span class="id">cenv</span> <span class="id">x</span> <span class="id">cx</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Cks.Is_free_in_clock">Is_free_in_clock</a></span> <span class="id">x</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_clock">collect_free_clock</a></span> <span class="id">cenv</span> <span class="id">ck</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof65')">Proof.</span></div>
<div class="proofscript" id="proof65">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ck</span>; <span class="tactic">intros</span> * <span class="id">Href</span> <span class="id">Hfree</span> <span class="id">Hcaus</span>; <span class="id">inv</span> <span class="id">Hfree</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.Common.html#PSF.add_2">PSF.add_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.Common.html#PSF.add_1">PSF.add_1</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var_complete">collect_free_var_complete</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.find_caus_NoDupMembers">find_caus_NoDupMembers</a></span> <span class="id">cenv</span> : <span class="kwd">forall</span> <span class="id">caus</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">cenv</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">caus</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> <span class="id">cenv</span>) <span class="id">caus</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">cx</span>) =&gt; (<span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>), <span class="id"><a href="Velus.Common.Common.html#PS.singleton">PS.singleton</a></span> <span class="id">cx</span>)) <span class="id">caus</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof66')">Proof.</span></div>
<div class="proofscript" id="proof66">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnd1</span> <span class="id">Hnd2</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">caus</span>; <span class="id">inv</span> <span class="id">Hnd2</span>; <span class="id">inv</span> <span class="id">Hf</span>; <span class="tactic">simpl</span>. <span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>). <span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>. <span class="tactic">rewrite</span> <span class="id">Hfind</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hinm</span>. <span class="id">simpl_In</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind2</span>). <span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span> <span class="kwd">in</span> <span class="id">Hfind2</span>. <span class="tactic">rewrite</span> <span class="id">Hfind2</span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Environment.html#Env.NoDup_snd_elements">Env.NoDup_snd_elements</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="tactic">eauto</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (~ <span class="id">_</span>) <span class="id">and</span> <span class="tactic">eapply</span> <span class="id">it</span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.find_caus_NoDup">find_caus_NoDup</a></span> <span class="id">cenv</span> : <span class="kwd">forall</span> (<span class="id">caus</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">cenv</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">cenv</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">x</span>) =&gt; ~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">caus</span>)) <span class="id">cenv</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">caus</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x0</span>, <span class="id">y0</span>) =&gt; (<span class="id">x0</span>, <span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span> <span class="id">y0</span> (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">x0</span> <span class="id">caus</span>))) <span class="id">cenv</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof67')">Proof.</span></div>
<div class="proofscript" id="proof67">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnd1</span> <span class="id">Hnd3</span> <span class="id">Hf</span> <span class="id">Hnd2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">cenv</span> <span class="kwd">as</span> [|(?&amp;?)]; <span class="id">inv</span> <span class="id">Hnd1</span>; <span class="id">inv</span> <span class="id">Hnd3</span>; <span class="id">inv</span> <span class="id">Hf</span>; <span class="tactic">simpl</span>; <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hnin</span>; <span class="id">simpl_In</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">i</span> <span class="id">caus</span>) <span class="id">eqn</span>:<span class="id">Has1</span>, (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">i1</span> <span class="id">caus</span>) <span class="id">eqn</span>:<span class="id">Has2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#assoc_ident_In">assoc_ident_In</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> |- <span class="id">_</span> =&gt; <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#assoc_ident_false">assoc_ident_false</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_snd_det">NoDup_snd_det</a></span> <span class="kwd">in</span> <span class="id">Has1</span>; <span class="tactic">eauto</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H3</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">H6</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">H4</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">H1</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.collect_depends_last_spec">collect_depends_last_spec</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) : <span class="kwd">forall</span> Γ <span class="id">cenv</span> <span class="id">cenvl</span> <span class="id">cx</span> <span class="id">cy</span> <span class="id">decls</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenvl</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_decls">idcaus_of_decls</a></span> <span class="id">decls</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">decls</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">o</span>)) =&gt; <span class="id"><a href="Velus.Common.CommonList.html#LiftO">LiftO</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_exp">wl_exp</a></span> <span class="id">G</span> <span class="id">e</span> /\ <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span> = 1) <span class="id">o</span>) <span class="id">decls</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">o</span>)) =&gt; <span class="id"><a href="Velus.Common.CommonList.html#LiftO">LiftO</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_exp">wx_exp</a></span> Γ <span class="id">e</span>) <span class="id">o</span>) <span class="id">decls</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_last_decl">depends_on_last_decl</a></span> Γ <span class="id">cx</span> <span class="id">cy</span>) <span class="id">decls</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">s</span>, <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span> <span class="id">cx</span> <span class="id">s</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_last_decls">collect_depends_last_decls</a></span> <span class="id">cenv</span> <span class="id">cenvl</span> <span class="id">decls</span>) /\ <span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">cy</span> <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof68')">Proof.</span></div>
<div class="proofscript" id="proof68">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Env</span> <span class="id">EnvL</span> <span class="id">ND1</span> <span class="id">ND2</span> <span class="id">Wl</span> <span class="id">Wx</span> <span class="id">Dep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>. <span class="id">simpl_Forall</span>. <span class="id">inv</span> <span class="id">Dep</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_spec">collect_free_left_spec</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_last_decls">collect_depends_last_decls</a></span>, <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Environment.html#Env.find_In_from_list">Env.find_In_from_list</a></span>; <span class="tactic">eauto</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span> - <span class="id">ND1</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_decls">idcaus_of_decls</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span> <span class="kwd">in</span> <span class="id">ND1</span>. <span class="id">simpl_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_r">NoDup_app_r</a></span> <span class="kwd">in</span> <span class="id">ND1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#map_map_filter">map_map_filter</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#map_filter_map">map_filter_map</a></span> <span class="kwd">in</span> <span class="id">ND1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#map_map_filter">map_map_filter</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#map_filter_ext">map_filter_ext</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">destruct_conjs</span>. <span class="tactic">destruct</span> <span class="id">o</span> <span class="kwd">as</span> [(?&amp;?)|]; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.collect_depends_scope_spec">collect_depends_scope_spec</a></span> {<span class="id">A</span>} <span class="id">f_idcaus</span> <span class="id">P_vd</span> <span class="id">P_nd</span> <span class="id">P_wl</span> <span class="id">P_wx</span> <span class="id">P_dep</span> <span class="id">f_dep</span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">locs</span> (<span class="id">blks</span>: <span class="id">A</span>) <span class="id">xs</span> Γ <span class="id">cenv</span>' <span class="id">cenvl</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenvl</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">cenv</span>' ++ <span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">cenvl</span>' ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_scope">idcaus_of_scope</a></span> <span class="id">f_idcaus</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.VarsDefinedCompScope">VarsDefinedCompScope</a></span> <span class="id">P_vd</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> <span class="id">cenv</span>') <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupScope">NoDupScope</a></span> <span class="id">P_nd</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ) (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_scope">wl_scope</a></span> <span class="id">P_wl</span> <span class="id">G</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_scope">wx_scope</a></span> <span class="id">P_wx</span> Γ (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_scope">depends_on_scope</a></span> <span class="id">P_dep</span> Γ <span class="id">x</span> <span class="id">y</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">xs</span> Γ <span class="id">cenv</span>' <span class="id">cenvl</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenvl</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">cenv</span>' ++ <span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">cenvl</span>' ++ <span class="id">f_idcaus</span> <span class="id">blks</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_vd</span> <span class="id">blks</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> <span class="id">cenv</span>') <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_nd</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_wl</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_wx</span> Γ <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_dep</span> Γ <span class="id">x</span> <span class="id">y</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">s</span>, <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span> <span class="id">x</span> <span class="id">s</span> (<span class="id">f_dep</span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">blks</span>) /\ <span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">y</span> <span class="id">s</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">s</span>, <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span> <span class="id">x</span> <span class="id">s</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_scope">collect_depends_scope</a></span> <span class="id">f_dep</span> <span class="id">cenv</span>' <span class="id">cenvl</span>' (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>)) /\ <span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">y</span> <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</span></div>
<div class="proofscript" id="proof69">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Transparent</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_scope">collect_depends_scope</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnd1</span> <span class="id">Henv</span> <span class="id">Henvl</span> <span class="id">Hnd4</span> <span class="id">Hvars</span> <span class="id">Hndvars</span> <span class="id">Hvarsenv</span> <span class="id">Hndl</span> <span class="id">Hwl</span> <span class="id">Hwx</span> <span class="id">Hdep</span> <span class="id">Hind</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">inv</span> <span class="id">Hvars</span>; <span class="id">inv</span> <span class="id">Hndl</span>; <span class="id">inv</span> <span class="id">Hwl</span>; <span class="id">inv</span> <span class="id">Hwx</span>; <span class="id">inv</span> <span class="id">Hdep</span>; <span class="tactic">subst</span> Γ'.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;sub-blocks&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>. <span class="id">inv_VarsDefined</span>. <span class="id">take</span> (<span class="id">P_dep</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">rename</span> <span class="id">it</span> <span class="id">into</span> <span class="id">Hdep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hind</span> <span class="kwd">with</span> (<span class="id">xs</span>:=<span class="id">xs</span> ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span>) <span class="kwd">in</span> <span class="id">Hdep</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hpsin</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.union_fuse_spec">Env.union_fuse_spec</a></span>, <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#PSF.union_iff">PSF.union_iff</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupScope_NoDupMembers">NoDupScope_NoDupMembers</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.equiv_env_scope">equiv_env_scope</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.equiv_env_last_scope">equiv_env_last_scope</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.Environment.html#Env.elements_adds">Env.elements_adds</a></span>. <span class="id">simpl_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2,3:<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_app">NoDupMembers_app</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Environment.html#Env.NoDupMembers_elements">Env.NoDupMembers_elements</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_NoDup">Permutation_NoDup</a></span>, <span class="id">Hnd4</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span>. <span class="id">simpl_app</span>. <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_head">Permutation_app_head</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Permutation_swap">Permutation_swap</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_head">Permutation_app_head</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> 3 <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#map_filter_map">map_filter_map</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#map_filter_ext">map_filter_ext</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">intros</span>; <span class="id">destruct_conjs</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">o</span> <span class="kwd">as</span> [(?&amp;?)|]; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_map_filter">NoDupMembers_map_filter</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">destruct_conjs</span>. <span class="tactic">destruct</span> <span class="id">o</span> <span class="kwd">as</span> [(?&amp;?)|]; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> * <span class="id">Hin1</span> <span class="id">Hin2</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.elements_In">Env.elements_In</a></span> <span class="kwd">in</span> <span class="id">Hin0</span> <span class="kwd">as</span> (?&amp;<span class="id">Find</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Henvl</span> <span class="kwd">in</span> <span class="id">Find</span>; <span class="id">inv</span> <span class="id">Find</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H5</span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_map">NoDupMembers_map</a></span>; <span class="tactic">auto</span>. <span class="tactic">intros</span>; <span class="id">destruct_conjs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> * <span class="id">Hin1</span> <span class="id">Hin2</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.elements_In">Env.elements_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (?&amp;<span class="id">Find</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Henv</span> <span class="kwd">in</span> <span class="id">Find</span>; <span class="id">inv</span> <span class="id">Find</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H5</span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">NoDup_app</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">simpl_Forall</span>. <span class="tactic">intros</span> <span class="id">Hin2</span>. <span class="id">inv</span> <span class="id">Hvarsenv</span>. <span class="tactic">eapply</span> <span class="id">Henv</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H5</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="tactic">eauto</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Env.In_adds_spec</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_or">in_app_or</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">Hin</span>'|<span class="id">Hin</span>']; [<span class="tactic">right</span>|<span class="tactic">left</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;last&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_last_spec">collect_depends_last_spec</a></span> <span class="kwd">in</span> <span class="id">H10</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hin</span>); <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.equiv_env_scope">equiv_env_scope</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.equiv_env_last_scope">equiv_env_last_scope</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_scope">idcaus_of_scope</a></span> <span class="kwd">in</span> <span class="id">Hnd4</span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> <span class="id">Hnd4</span>. <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_r">NoDup_app_r</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.union_fuse_spec">Env.union_fuse_spec</a></span>, <span class="id">Hfind</span>. <span class="tactic">clear</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">_</span> (<span class="id">f_dep</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)); <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#PSF.union_iff">PSF.union_iff</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.collect_depends_branch_spec">collect_depends_branch_spec</a></span> {<span class="id">A</span>} <span class="id">f_idcaus</span> <span class="id">P_vd</span> <span class="id">P_nd</span> <span class="id">P_wl</span> <span class="id">P_wx</span> <span class="id">P_dep</span> <span class="id">f_dep</span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">caus</span> (<span class="id">blks</span>: <span class="id">A</span>) <span class="id">xs</span> Γ <span class="id">cenv</span>' <span class="id">cenvl</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenvl</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">cenv</span>' ++ <span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">cenvl</span>' ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_branch">idcaus_of_branch</a></span> <span class="id">f_idcaus</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.VarsDefinedCompBranch">VarsDefinedCompBranch</a></span> <span class="id">P_vd</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> <span class="id">cenv</span>') <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupBranch">NoDupBranch</a></span> <span class="id">P_nd</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_branch">wl_branch</a></span> <span class="id">P_wl</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_branch">wx_branch</a></span> <span class="id">P_wx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_branch">depends_on_branch</a></span> <span class="id">P_dep</span> Γ <span class="id">x</span> <span class="id">y</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">xs</span> Γ' <span class="id">cenv</span>' <span class="id">cenvl</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenvl</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ' <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> Γ <span class="id">x</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> Γ' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsLast">IsLast</a></span> Γ' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">cenv</span>' ++ <span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">cenvl</span>' ++ <span class="id">f_idcaus</span> <span class="id">blks</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_vd</span> <span class="id">blks</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> <span class="id">cenv</span>') <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_nd</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_wl</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_wx</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_dep</span> Γ' <span class="id">x</span> <span class="id">y</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">s</span>, <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span> <span class="id">x</span> <span class="id">s</span> (<span class="id">f_dep</span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">blks</span>) /\ <span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">y</span> <span class="id">s</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">s</span>, <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span> <span class="id">x</span> <span class="id">s</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_branch">collect_depends_branch</a></span> <span class="id">f_dep</span> <span class="id">cenv</span>' <span class="id">cenvl</span>' (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>)) /\ <span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">y</span> <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof70')">Proof.</span></div>
<div class="proofscript" id="proof70">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Transparent</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_branch">collect_depends_branch</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnd1</span> <span class="id">Henv</span> <span class="id">Henvl</span> <span class="id">Hnd4</span> <span class="id">Hvars</span> <span class="id">Hndvars</span> <span class="id">Hvarsenv</span> <span class="id">Hndl</span> <span class="id">Hwl</span> <span class="id">Hwx</span> <span class="id">Hdep</span> <span class="id">Hind</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">inv</span> <span class="id">Hvars</span>; <span class="id">inv</span> <span class="id">Hndl</span>; <span class="id">inv</span> <span class="id">Hwl</span>; <span class="id">inv</span> <span class="id">Hwx</span>; <span class="id">inv</span> <span class="id">Hdep</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;sub-blocks&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>. <span class="id">inv_VarsDefined</span>. <span class="id">take</span> (<span class="id">P_dep</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">rename</span> <span class="id">it</span> <span class="id">into</span> <span class="id">Hdep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hind</span> <span class="kwd">with</span> (<span class="id">xs</span>:=<span class="id">xs</span>) (Γ':=<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus">replace_idcaus</a></span> <span class="id">_</span> Γ) (<span class="id">cenv</span>':=<span class="id"><a href="Velus.Environment.html#Env.mapi">Env.mapi</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">in</span> <span class="id">Hdep</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hpsin</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.union_fuse_spec">Env.union_fuse_spec</a></span>, <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#PSF.union_iff">PSF.union_iff</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_map">NoDupMembers_map</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.equiv_env_branch">equiv_env_branch</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.equiv_env_last_branch">equiv_env_last_branch</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_IsVar">replace_idcaus_IsVar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_IsLast">replace_idcaus_IsLast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.mapi_elements">Env.mapi_elements</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_app</span>. <span class="tactic">apply</span> <span class="id">NoDup_app</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.find_caus_NoDup">find_caus_NoDup</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Environment.html#Env.NoDupMembers_elements">Env.NoDupMembers_elements</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_r">NoDup_app_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_In">NoDup_app_In</a></span> <span class="kwd">in</span> <span class="id">Hnd4</span>; [|<span class="id">solve_In</span>]. <span class="id">contradict</span> <span class="id">Hnd4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">clear</span> - <span class="id">Hnd4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_r">NoDup_app_r</a></span> <span class="kwd">in</span> <span class="id">Hnd4</span>. <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation_app_comm</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">caus</span>)), <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> <span class="id">Hnd4</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#assoc_ident">assoc_ident</a></span> <span class="id">k</span> <span class="id">caus</span>) <span class="id">eqn</span>:<span class="id">Hcaus</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#assoc_ident_In">assoc_ident_In</a></span> <span class="kwd">in</span> <span class="id">Hcaus</span>. <span class="tactic">intros</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation_app_comm</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">caus</span>)) <span class="kwd">in</span> <span class="id">Hnd4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> <span class="id">Hnd4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_In">NoDup_app_In</a></span> <span class="kwd">in</span> <span class="id">Hnd4</span>. <span class="tactic">eapply</span> <span class="id">Hnd4</span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span>. <span class="id">simpl_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> *. <span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [|]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_In">NoDup_app_In</a></span> <span class="kwd">in</span> <span class="id">Hnd4</span>; [|<span class="id">solve_In</span>]. <span class="id">contradict</span> <span class="id">Hnd4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> *. <span class="tactic">destruct</span> <span class="id">Hnd4</span> <span class="kwd">as</span> [|]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.mapi_in_iff">Env.Props.P.F.mapi_in_iff</a></span>. <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;caus&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="tactic">exists</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x1</span>, <span class="id">cx</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span> <span class="id">x1</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x1</span> <span class="id">cenv</span>'), <span class="id"><a href="Velus.Common.Common.html#PS.singleton">PS.singleton</a></span> <span class="id">cx</span>)) <span class="id">caus</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">y</span> <span class="id">s</span>) <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hps</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.find_In_from_list">Env.find_In_from_list</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Henv</span> <span class="kwd">in</span> <span class="id">H7</span>. <span class="tactic">rewrite</span> <span class="id">H7</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.find_caus_NoDupMembers">find_caus_NoDupMembers</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_app</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>, <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">simpl_Forall</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#PSF.singleton_2">PSF.singleton_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.union_fuse_spec">Env.union_fuse_spec</a></span>, <span class="id">Hfind</span>. <span class="tactic">clear</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">_</span> (<span class="id">f_dep</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)); <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#PSF.union_iff">PSF.union_iff</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.collect_depends_on_spec">collect_depends_on_spec</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">x</span> <span class="id">y</span> <span class="id">blk</span> <span class="id">xs</span> Γ <span class="id">cenv</span>' <span class="id">cenvl</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenv</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">cenvl</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">cenv</span>' ++ <span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">cenvl</span>' ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_locals">idcaus_of_locals</a></span> <span class="id">blk</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.VarsDefinedComp">VarsDefinedComp</a></span> <span class="id">blk</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> <span class="id">cenv</span>') <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupLocals">NoDupLocals</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ) <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_block">wl_block</a></span> <span class="id">G</span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_block">wx_block</a></span> Γ <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on">depends_on</a></span> Γ <span class="id">x</span> <span class="id">y</span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">s</span>, <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span> <span class="id">x</span> <span class="id">s</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_on">collect_depends_on</a></span> <span class="id">cenv</span>' <span class="id">cenvl</span>' <span class="id">blk</span>) /\ <span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">y</span> <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</span></div>
<div class="proofscript" id="proof71">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Opaque</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_scope">collect_depends_scope</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_branch">collect_depends_branch</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.block_ind2">block_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Hnd1</span> <span class="id">Henv</span> <span class="id">Henvl</span> <span class="id">Hnd4</span> <span class="id">Hvars</span> <span class="id">Hndvars</span> <span class="id">Hvarsenv</span> <span class="id">Hndl</span> <span class="id">Hwl</span> <span class="id">Hwx</span> <span class="id">Hdep</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">inv</span> <span class="id">Hvars</span>; <span class="id">inv</span> <span class="id">Hndl</span>; <span class="id">inv</span> <span class="id">Hwl</span>; <span class="id">inv</span> <span class="id">Hwx</span>; <span class="id">inv</span> <span class="id">Hdep</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;equation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_list_spec">collect_free_left_list_spec</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_list_length">collect_free_left_list_length</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.find_In_from_list">Env.find_In_from_list</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>, <span class="id">combine_map_fst</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var_nodup">collect_free_var_nodup</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_NoDup_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#In_combine_nth_error">In_combine_nth_error</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_nth_error">map_nth_error</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_var_complete">collect_free_var_complete</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">nth_error_nth</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id">H5</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error_Some">nth_error_Some</a></span>; <span class="tactic">intro</span>; <span class="tactic">congruence</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;block&nbsp;(sub-blocks)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>. <span class="id">simpl_Forall</span>. <span class="id">inv_VarsDefined</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H</span> <span class="kwd">with</span> (<span class="id">cenv</span>':=<span class="id">cenv</span>') (<span class="id">cenvl</span>':=<span class="id">cenvl</span>') <span class="kwd">in</span> <span class="id">Hdef</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.NoDup_locals_inv">NoDup_locals_inv</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_concat">NoDup_concat</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_incl">Forall_incl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#incl_concat">incl_concat</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_Subset">unions_fuse_Subset</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hsub</span>). 2:<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">esplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.map_o">Env.Props.P.F.map_o</a></span>, <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.Common.html#PSF.union_iff">PSF.union_iff</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;block&nbsp;(reset&nbsp;expr)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_on_dom">collect_depends_on_dom</a></span>, <span class="id"><a href="Velus.Environment.html#Env.map_2">Env.map_2</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_PS_In">unions_fuse_PS_In</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_exists">Exists_exists</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> (?&amp;<span class="id">Hin1</span>&amp;(?&amp;<span class="id">Hfind2</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2,4,5,6:<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">intros</span> ? <span class="id">Hin</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hvarsenv</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hvarsenv</span>. <span class="tactic">eapply</span> <span class="id">Henv</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">solve_In</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_Subset">unions_fuse_Subset</a></span> <span class="kwd">in</span> <span class="id">Hfind2</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hsub</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">esplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span>. <span class="id">now</span> <span class="id">erewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.map_o">Env.Props.P.F.map_o</a></span>, <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_spec">collect_free_left_spec</a></span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.Common.html#PSF.union_iff">PSF.union_iff</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;switch&nbsp;(sub-blocks)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.map_mapsto_iff">Env.Props.P.F.map_mapsto_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>. <span class="tactic">destruct</span> <span class="id">b</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_branch_spec">collect_depends_branch_spec</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hpsin</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_Subset">unions_fuse_Subset</a></span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hsub</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span>. <span class="tactic">rewrite</span> <span class="id">Hfind</span>; <span class="tactic">simpl</span>. 2:<span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#PSF.union_3">PSF.union_3</a></span>, <span class="id">Hsub</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#nodup_app_map_flat_map">nodup_app_map_flat_map</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span>); <span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span> <span class="kwd">with</span> (<span class="id">l</span>:=<span class="id">branches</span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span> <span class="kwd">with</span> (<span class="id">l</span>:=<span class="id">branches</span>), &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">destruct_conjs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">simpl_Exists</span>. <span class="id">inv_VarsDefined</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H</span> <span class="kwd">with</span> (<span class="id">xs</span>:=<span class="id">xs1</span>) (<span class="id">cenv</span>':=<span class="id">cenv</span>'0) (<span class="id">cenvl</span>':=<span class="id">cenvl</span>'0) <span class="kwd">in</span> <span class="id">H20</span> <span class="kwd">as</span> (?&amp;<span class="id">Hinc</span>&amp;<span class="id">Hpsin</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_Subset">unions_fuse_Subset</a></span> <span class="kwd">in</span> <span class="id">Hinc</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hsub</span>). 2:<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hsub</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.NoDup_locals_inv">NoDup_locals_inv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_concat">NoDup_concat</a></span>; <span class="tactic">eauto</span>. <span class="id">now</span> <span class="id">take</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">rewrite</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">take</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">rewrite</span> &lt;-<span class="id">it</span> <span class="kwd">in</span> <span class="id">H18</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_concat">Forall_concat</a></span> <span class="kwd">in</span> <span class="id">H18</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>; [|<span class="tactic">eauto</span>]. <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar_incl_fst">IsVar_incl_fst</a></span>, <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_block_incl">wx_block_incl</a></span>; [| |<span class="tactic">eauto</span>]; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;switch&nbsp;(condition)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_on_dom">collect_depends_on_dom</a></span>, <span class="id"><a href="Velus.Environment.html#Env.map_2">Env.map_2</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_PS_In">unions_fuse_PS_In</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_exists">Exists_exists</a></span> <span class="kwd">in</span> <span class="id">H9</span> <span class="kwd">as</span> (?&amp;<span class="id">Hin1</span>&amp;(?&amp;<span class="id">Hfind2</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2,4,5,6:<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">intros</span> ? <span class="id">Hin</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hvarsenv</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hvarsenv</span>. <span class="tactic">eapply</span> <span class="id">Henv</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">solve_In</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_Subset">unions_fuse_Subset</a></span> <span class="kwd">in</span> <span class="id">Hfind2</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hsub</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">esplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span>. <span class="id">now</span> <span class="id">erewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.map_o">Env.Props.P.F.map_o</a></span>, <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_spec">collect_free_left_spec</a></span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.Common.html#PSF.union_iff">PSF.union_iff</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;automaton&nbsp;(sub-blocks)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>. <span class="tactic">destruct</span> <span class="id">b</span> <span class="kwd">as</span> [?(?&amp;[?(?&amp;?)])]; <span class="id">destruct_conjs</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_branch_spec">collect_depends_branch_spec</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hpsin</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_Subset">unions_fuse_Subset</a></span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hsub</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.map_o">Env.Props.P.F.map_o</a></span>, <span class="id">Hfind</span>; <span class="tactic">simpl</span>. 2:<span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#PSF.union_3">PSF.union_3</a></span>, <span class="id">Hsub</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#nodup_app_map_flat_map">nodup_app_map_flat_map</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="kwd">fun</span> <span class="id">x</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span>)); <span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span> <span class="kwd">with</span> (<span class="id">l</span>:=<span class="id">states</span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span> <span class="kwd">with</span> (<span class="id">l</span>:=<span class="id">states</span>), &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">destruct_conjs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_scope_spec">collect_depends_scope_spec</a></span> <span class="kwd">with</span> (<span class="id">f_idcaus</span>:=<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">blks</span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">in</span> <span class="id">H23</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hpsin</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupScope_incl">NoDupScope_incl</a></span>. 3:<span class="tactic">eauto</span>. <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar_incl_fst">IsVar_incl_fst</a></span>, <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_scope_incl">wx_scope_incl</a></span>. 4:<span class="tactic">eauto</span>. <span class="id">all</span>:<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">destruct_conjs</span>; <span class="tactic">split</span>; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_exp_incl">wx_exp_incl</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_block_incl">wx_block_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>. <span class="id">simpl_Exists</span>. <span class="id">inv_VarsDefined</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on">depends_on</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">eapply</span> <span class="id">H</span> <span class="kwd">with</span> (<span class="id">xs</span>:=<span class="id">xs2</span>) <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (?&amp;<span class="id">Hinc</span>&amp;<span class="id">Hpsin</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_Subset">unions_fuse_Subset</a></span> <span class="kwd">in</span> <span class="id">Hinc</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hsub</span>). 2:<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hsub</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.NoDup_locals_inv">NoDup_locals_inv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_concat">NoDup_concat</a></span>; <span class="tactic">eauto</span>. <span class="id">now</span> <span class="id">take</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">rewrite</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">take</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">rewrite</span> &lt;-<span class="id">it</span> <span class="kwd">in</span> <span class="id">H32</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_concat">Forall_concat</a></span> <span class="kwd">in</span> <span class="id">H32</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;automaton&nbsp;(clock)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_on_dom">collect_depends_on_dom</a></span>, <span class="id"><a href="Velus.Environment.html#Env.map_2">Env.map_2</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_PS_In">unions_fuse_PS_In</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_exists">Exists_exists</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> (?&amp;<span class="id">Hin1</span>&amp;(?&amp;<span class="id">Hfind2</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2,4,5,6:<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">intros</span> ? <span class="id">Hin</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hvarsenv</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hvarsenv</span>. <span class="tactic">eapply</span> <span class="id">Henv</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">solve_In</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_Subset">unions_fuse_Subset</a></span> <span class="kwd">in</span> <span class="id">Hfind2</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hsub</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">esplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span>. <span class="id">now</span> <span class="id">erewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.map_o">Env.Props.P.F.map_o</a></span>, <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_clock_spec">collect_free_clock_spec</a></span> <span class="kwd">in</span> <span class="id">H16</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.Common.Common.html#PSF.union_iff">PSF.union_iff</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;automaton&nbsp;(initial&nbsp;state)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_on_dom">collect_depends_on_dom</a></span>, <span class="id"><a href="Velus.Environment.html#Env.map_2">Env.map_2</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_PS_In">unions_fuse_PS_In</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_exists">Exists_exists</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> (?&amp;<span class="id">Hin1</span>&amp;(?&amp;<span class="id">Hfind2</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2,4,5,6:<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">intros</span> ? <span class="id">Hin</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hvarsenv</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hvarsenv</span>. <span class="tactic">eapply</span> <span class="id">Henv</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">solve_In</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_Subset">unions_fuse_Subset</a></span> <span class="kwd">in</span> <span class="id">Hfind2</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hsub</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">esplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span>. <span class="id">now</span> <span class="id">erewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.map_o">Env.Props.P.F.map_o</a></span>, <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Exists</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_spec">collect_free_left_spec</a></span> <span class="kwd">in</span> <span class="id">H16</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> 3 <span class="id"><a href="Velus.Common.Common.html#PSF.union_iff">PSF.union_iff</a></span>. <span class="tactic">left</span>; <span class="tactic">right</span>; <span class="tactic">left</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonPS.html#In_In_PSUnion">In_In_PSUnion</a></span>; <span class="tactic">eauto</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;automaton&nbsp;(strong&nbsp;transitions)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_on_dom">collect_depends_on_dom</a></span>, <span class="id"><a href="Velus.Environment.html#Env.map_2">Env.map_2</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_PS_In">unions_fuse_PS_In</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_exists">Exists_exists</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> (?&amp;<span class="id">Hin1</span>&amp;(?&amp;<span class="id">Hfind2</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2,4,5,6:<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">intros</span> ? <span class="id">Hin</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hvarsenv</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hvarsenv</span>. <span class="tactic">eapply</span> <span class="id">Henv</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">solve_In</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_Subset">unions_fuse_Subset</a></span> <span class="kwd">in</span> <span class="id">Hfind2</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hsub</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">esplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span>. <span class="id">now</span> <span class="id">erewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.map_o">Env.Props.P.F.map_o</a></span>, <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">repeat</span> <span class="id">simpl_Exists</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_branch">wx_branch</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_branch">wl_branch</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>. <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_free_left_spec">collect_free_left_spec</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> 3 <span class="id"><a href="Velus.Common.Common.html#PSF.union_iff">PSF.union_iff</a></span>. <span class="tactic">left</span>; <span class="tactic">right</span>; <span class="tactic">right</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonPS.html#In_In_PSUnion">In_In_PSUnion</a></span>. 2:<span class="id">solve_In</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonPS.html#In_In_PSUnion">In_In_PSUnion</a></span>. 2:<span class="id">solve_In</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_scope_spec">collect_depends_scope_spec</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">simpl_Exists</span>. <span class="id">inv_VarsDefined</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on">depends_on</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">rename</span> <span class="id">it</span> <span class="id">into</span> <span class="id">Hdep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H</span> <span class="kwd">with</span> (<span class="id">xs</span>:=<span class="id">xs1</span>) <span class="kwd">in</span> <span class="id">Hdep</span> <span class="kwd">as</span> (?&amp;<span class="id">Hinc</span>&amp;<span class="id">Hpsin</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_Subset">unions_fuse_Subset</a></span> <span class="kwd">in</span> <span class="id">Hinc</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hsub</span>). 2:<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">esplit</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hsub</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.NoDup_locals_inv">NoDup_locals_inv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_concat">NoDup_concat</a></span>; <span class="tactic">eauto</span>. <span class="id">now</span> <span class="id">take</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">rewrite</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">take</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">rewrite</span> &lt;-<span class="id">it</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_concat">Forall_concat</a></span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Constructors</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Is_defined_in">Is_defined_in</a></span> : <span class="id">lcaus</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCAUSALITY.Is_free_in_clock_In">Is_free_in_clock_In</a></span> Γ : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_clock">wx_clock</a></span> Γ <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Cks.Is_free_in_clock">Is_free_in_clock</a></span> <span class="id">x</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> Γ <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof72')">Proof.</span></div>
<div class="proofscript" id="proof72">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ck</span>; <span class="tactic">intros</span> * <span class="id">Hwx</span> <span class="id">Hf</span>; <span class="id">inv</span> <span class="id">Hwx</span>; <span class="id">inv</span> <span class="id">Hf</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.Is_free_left_In">Is_free_left_In</a></span> Γ Γ' : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">k</span> <span class="id">x</span> <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span> Γ)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> \/ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_exp">wx_exp</a></span> Γ' <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">cx</span> <span class="id">k</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> Γ' <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</span></div>
<div class="proofscript" id="proof73">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.exp_ind2">exp_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Hnd</span> <span class="id">Hin</span> <span class="id">Hwx</span> <span class="id">Hfree</span>; <span class="id">inv</span> <span class="id">Hwx</span>; <span class="id">inv</span> <span class="id">Hfree</span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">_</span> \/ <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Hc1</span>: <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">_</span> ?<span class="id">cx</span>, <span class="id">Hc2</span>: <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">_</span> ?<span class="id">cx</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus_snd_det">HasCaus_snd_det</a></span> <span class="kwd">in</span> <span class="id">Hc1</span>; <span class="tactic">eauto</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Hc1</span>: <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">_</span> ?<span class="id">cx</span>, <span class="id">Hc2</span>: <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">_</span> ?<span class="id">cx</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus_snd_det">HasLastCaus_snd_det</a></span> <span class="kwd">in</span> <span class="id">Hc1</span>; <span class="tactic">eauto</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Hc1</span>: <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">_</span> ?<span class="id">cx</span>, <span class="id">Hc2</span>: <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">_</span> ?<span class="id">cx</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.NoDup_HasCaus_HasLastCaus">NoDup_HasCaus_HasLastCaus</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list">Is_free_left_list</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list_Exists">Is_free_left_list_Exists</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;?)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="kwd">forall</span> <span class="id">_</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> -&gt; <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">simpl_Exists</span>; <span class="id">simpl_Forall</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsLast_IsVar">IsLast_IsVar</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.depends_scope_In">depends_scope_In</a></span> {<span class="id">A</span>} <span class="id">f_idcaus</span> <span class="id">P_vd</span> <span class="id">P_nd</span> <span class="id">P_wx</span> <span class="id">P_dep</span> : <span class="kwd">forall</span> <span class="id">locs</span> (<span class="id">blks</span>: <span class="id">A</span>) Γ Γ' <span class="id">xs</span> <span class="id">cy</span> <span class="id">x</span> <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span> Γ ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_scope">idcaus_of_scope</a></span> <span class="id">f_idcaus</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id">xs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> \/ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.VarsDefinedCompScope">VarsDefinedCompScope</a></span> <span class="id">P_vd</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupScope">NoDupScope</a></span> <span class="id">P_nd</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ) (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_scope">wx_scope</a></span> <span class="id">P_wx</span> Γ' (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_scope">depends_on_scope</a></span> <span class="id">P_dep</span> Γ <span class="id">cy</span> <span class="id">cx</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ Γ' <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span> Γ ++ <span class="id">f_idcaus</span> <span class="id">blks</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id">xs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> \/ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_vd</span> <span class="id">blks</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_nd</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_wx</span> Γ' <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_dep</span> Γ <span class="id">cy</span> <span class="id">cx</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> Γ' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> Γ' <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</span></div>
<div class="proofscript" id="proof74">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnd1</span> <span class="id">Hnd</span> <span class="id">Hincl</span> <span class="id">Hin</span> <span class="id">Hnd2</span> <span class="id">Hvd</span> <span class="id">Hwx</span> <span class="id">Hdep</span> <span class="id">Hind</span>; <span class="id">inv</span> <span class="id">Hwx</span>; <span class="id">inv</span> <span class="id">Hdep</span>; <span class="id">inv</span> <span class="id">Hnd2</span>; <span class="id">inv</span> <span class="id">Hvd</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span> Γ'0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;sub-blocks&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hind</span> <span class="kwd">with</span> (Γ':=Γ' ++ <span class="id">_</span>) (<span class="id">xs</span>:=<span class="id">xs</span> ++ <span class="id">_</span>) <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar_app">IsVar_app</a></span> <span class="kwd">in</span> <span class="id">H4</span> <span class="kwd">as</span> [|]; <span class="tactic">auto</span>. <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.InMembers_senv_of_decls">InMembers_senv_of_decls</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H8</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="id">inv</span> <span class="id">Hin</span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_app">NoDupMembers_app</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.NoDupMembers_senv_of_decls">NoDupMembers_senv_of_decls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> * <span class="id">Hin1</span> <span class="id">Hin2</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> <span class="id">Hin1</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.InMembers_senv_of_decls">InMembers_senv_of_decls</a></span> <span class="kwd">in</span> <span class="id">Hin2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H8</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv_app">idcaus_of_senv_app</a></span>, &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_NoDup">Permutation_NoDup</a></span>; [|<span class="tactic">eauto</span>]. <span class="id">solve_Permutation_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">incl_appl</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus_app">HasCaus_app</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus_app">HasLastCaus_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_HasCaus2">replace_idcaus_HasCaus2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;last&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>; <span class="id">simpl_Forall</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_last_decl">depends_on_last_decl</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_In">Is_free_left_In</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">Hin</span>'. 4:<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar_app">IsVar_app</a></span> <span class="kwd">in</span> <span class="id">Hin</span>' <span class="kwd">as</span> [|]; <span class="tactic">eauto</span>. <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar_senv_of_decls">IsVar_senv_of_decls</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H8</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="id">inv</span> <span class="id">Hin</span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">clear</span> - <span class="id">Hnd1</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv_app">idcaus_of_senv_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_app</span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>. <span class="id">simpl_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_NoDup">Permutation_NoDup</a></span>; [|<span class="tactic">eauto</span>]. <span class="id">solve_Permutation_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus_app">HasCaus_app</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus_app">HasLastCaus_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.depends_branch_In">depends_branch_In</a></span> {<span class="id">A</span>} <span class="id">f_idcaus</span> <span class="id">P_vd</span> <span class="id">P_nd</span> <span class="id">P_wx</span> <span class="id">P_dep</span> : <span class="kwd">forall</span> <span class="id">caus</span> (<span class="id">blks</span>: <span class="id">A</span>) Γ1 Γ2 <span class="id">xs</span> <span class="id">cy</span> <span class="id">x</span> <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ1 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span> Γ1 ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_branch">idcaus_of_branch</a></span> <span class="id">f_idcaus</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id">xs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ2) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ1 <span class="id">x</span> <span class="id">cx</span> \/ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ1 <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.VarsDefinedCompBranch">VarsDefinedCompBranch</a></span> <span class="id">P_vd</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupBranch">NoDupBranch</a></span> <span class="id">P_nd</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_branch">wx_branch</a></span> <span class="id">P_wx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_branch">depends_on_branch</a></span> <span class="id">P_dep</span> Γ1 <span class="id">cy</span> <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ1' <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ1' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span> Γ1' ++ <span class="id">f_idcaus</span> <span class="id">blks</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id">xs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ2) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ1' <span class="id">x</span> <span class="id">cx</span> \/ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ1' <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> Γ1 <span class="id">x</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> Γ1' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsLast">IsLast</a></span> Γ1 <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsLast">IsLast</a></span> Γ1' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_vd</span> <span class="id">blks</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_nd</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_wx</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_dep</span> Γ1' <span class="id">cy</span> <span class="id">cx</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> Γ2 <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> Γ2 <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</span></div>
<div class="proofscript" id="proof75">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hnd1</span> <span class="id">Hnd</span> <span class="id">Hincl</span> <span class="id">Hin</span> <span class="id">Hnd2</span> <span class="id">Hvd</span> <span class="id">Hwx</span> <span class="id">Hdep</span> <span class="id">Hind</span>; <span class="id">inv</span> <span class="id">Hwx</span>; <span class="id">inv</span> <span class="id">Hdep</span>; <span class="id">inv</span> <span class="id">Hnd2</span>; <span class="id">inv</span> <span class="id">Hvd</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;sub-blocks&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.CommonList.html#InMembers_dec">InMembers_dec</a></span> <span class="id">x</span> <span class="id">caus</span> <span class="id"><a href="Velus.Common.Common.html#ident_eq_dec">ident_eq_dec</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="tactic">constructor</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>, <span class="id">Hincl</span>, <span class="id">H5</span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hind</span> <span class="kwd">with</span> (<span class="id">xs</span>:=<span class="id">xs</span>) <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_map">NoDupMembers_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_NoDup">replace_idcaus_NoDup</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_HasLastCaus">replace_idcaus_HasLastCaus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_HasCaus2">replace_idcaus_HasCaus2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_IsVar">replace_idcaus_IsVar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.replace_idcaus_IsLast">replace_idcaus_IsLast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;renamed&nbsp;caus&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv_In">idcaus_of_senv_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_snd_det">NoDup_snd_det</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>. 2,3:<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>. 2:<span class="tactic">left</span>; <span class="tactic">eauto</span>. 2:<span class="tactic">right</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>, <span class="id">Hincl</span>, <span class="id">H6</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.depends_on_In">depends_on_In</a></span> : <span class="kwd">forall</span> <span class="id">blk</span> Γ Γ' <span class="id">xs</span> <span class="id">cy</span> <span class="id">x</span> <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span> Γ ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_locals">idcaus_of_locals</a></span> <span class="id">blk</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id">xs</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> \/ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.VarsDefinedComp">VarsDefinedComp</a></span> <span class="id">blk</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupLocals">NoDupLocals</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ) <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_block">wx_block</a></span> Γ' <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on">depends_on</a></span> Γ <span class="id">cy</span> <span class="id">cx</span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar">IsVar</a></span> Γ' <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</span></div>
<div class="proofscript" id="proof76">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.block_ind2">block_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Hnd1</span> <span class="id">Hnd</span> <span class="id">Hincl</span> <span class="id">Hin</span> <span class="id">Hvd</span> <span class="id">Hnd2</span> <span class="id">Hwx</span> <span class="id">Hdep</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwx</span>; <span class="id">inv</span> <span class="id">Hdep</span>; <span class="id">inv</span> <span class="id">Hvd</span>; <span class="id">inv</span> <span class="id">Hnd2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;equation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list_Exists">Is_free_left_list_Exists</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfree</span>). <span class="id">simpl_Exists</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_In">Is_free_left_In</a></span> <span class="kwd">in</span> <span class="id">Hfree</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>; <span class="id">simpl_Forall</span>. <span class="id">inv_VarsDefined</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H</span> <span class="kwd">with</span> (<span class="id">xs</span>:=<span class="id">xs</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.NoDup_locals_inv">NoDup_locals_inv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">etransitivity</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#incl_concat">incl_concat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_In">Is_free_left_In</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;switch&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">H1</span> <span class="id">into</span> <span class="id">Hdef</span>. <span class="id">simpl_Exists</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_branch_In">depends_branch_In</a></span> <span class="kwd">with</span> (Γ2:=Γ'); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#nodup_app_map_flat_map">nodup_app_map_flat_map</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span>); <span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span> <span class="kwd">with</span> (<span class="id">l</span>:=<span class="id">branches</span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span> <span class="kwd">with</span> (<span class="id">l</span>:=<span class="id">branches</span>), &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">destruct_conjs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">simpl_Exists</span>. <span class="id">simpl_Forall</span>. <span class="id">inv_VarsDefined</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H</span> <span class="kwd">with</span> (<span class="id">xs</span>:=<span class="id">xs1</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#nodup_app_map_flat_map">nodup_app_map_flat_map</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">etransitivity</span>; [|<span class="tactic">eauto</span>]. <span class="tactic">rewrite</span> &lt;-<span class="id">H15</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#incl_concat">incl_concat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>; [|<span class="tactic">eauto</span>]. <span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar_incl_fst">IsVar_incl_fst</a></span>, <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_In">Is_free_left_In</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;automaton&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span> <span class="kwd">as</span> [?(?&amp;[?(?&amp;?)])]. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_branch_In">depends_branch_In</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#nodup_app_map_flat_map">nodup_app_map_flat_map</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span>); <span class="tactic">do</span> 2 <span class="id">esplit</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span> <span class="kwd">with</span> (<span class="id">l</span>:=<span class="id">states</span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span> <span class="kwd">with</span> (<span class="id">l</span>:=<span class="id">states</span>), &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">destruct_conjs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_scope_In">depends_scope_In</a></span> <span class="kwd">with</span> (<span class="id">f_idcaus</span>:=<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">blks</span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">in</span> <span class="id">H17</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupScope_incl">NoDupScope_incl</a></span>. 3:<span class="tactic">eauto</span>. <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.IsVar_incl_fst">IsVar_incl_fst</a></span>, <span class="id">H12</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>. <span class="id">simpl_Forall</span>. <span class="id">inv_VarsDefined</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H</span> <span class="kwd">with</span> (<span class="id">xs</span>:=<span class="id">xs2</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#nodup_app_map_flat_map">nodup_app_map_flat_map</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">etransitivity</span>; [|<span class="tactic">eauto</span>]. <span class="id">take</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">_</span> <span class="id">xs1</span>) <span class="id">and</span> <span class="tactic">rewrite</span> &lt;-<span class="id">it</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#incl_concat">incl_concat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_in_clock_In">Is_free_in_clock_In</a></span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">x</span> = <span class="id">y</span>); <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus_snd_det">HasCaus_snd_det</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.NoDup_HasCaus_HasLastCaus">NoDup_HasCaus_HasLastCaus</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_In">Is_free_left_In</a></span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>. <span class="tactic">destruct</span> <span class="id">b</span> <span class="kwd">as</span> [?(?&amp;[?(?&amp;?)])]. <span class="id">simpl_Exists</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_branch">wx_branch</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>. <span class="id">destruct_conjs</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_In">Is_free_left_In</a></span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_scope_In">depends_scope_In</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">simpl_Exists</span>. <span class="id">simpl_Forall</span>. <span class="id">inv_VarsDefined</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H</span> <span class="kwd">with</span> (<span class="id">xs</span>:=<span class="id">xs1</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#nodup_app_map_flat_map">nodup_app_map_flat_map</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">etransitivity</span>; [|<span class="tactic">eauto</span>]. <span class="tactic">rewrite</span> &lt;-<span class="id">H12</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#incl_concat">incl_concat</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Hint</span> <span class="kwd">Constructors</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Is_defined_in">Is_defined_in</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Is_defined_in_scope">Is_defined_in_scope</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Is_defined_in_branch">Is_defined_in_branch</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Is_last_in">Is_last_in</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Is_last_in_scope">Is_last_in_scope</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Is_last_in_branch">Is_last_in_branch</a></span> : <span class="id">lcaus</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Hint</span> <span class="kwd">Constructors</span> <span class="id"><a href="Velus.Lustre.LCausality.html#depends_on">depends_on</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#depends_on_scope">depends_on_scope</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#depends_on_branch">depends_on_branch</a></span> : <span class="id">lcaus</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.depends_scope_def_last">depends_scope_def_last</a></span> {<span class="id">A</span>} <span class="id">P_dep</span> <span class="id">P_def</span> <span class="id">P_last</span> <span class="id">cy</span> <span class="id">cx</span> : <span class="kwd">forall</span> <span class="id">locs</span> (<span class="id">blk</span>: <span class="id">A</span>) Γ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_scope">depends_on_scope</a></span> <span class="id">P_dep</span> Γ <span class="id">cy</span> <span class="id">cx</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blk</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ, <span class="id">P_dep</span> Γ <span class="id">cy</span> <span class="id">cx</span> <span class="id">blk</span> -&gt; <span class="id">P_def</span> Γ <span class="id">blk</span> \/ <span class="id">P_last</span> <span class="id">blk</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_scope">Is_defined_in_scope</a></span> <span class="id">P_def</span> Γ <span class="id">cy</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blk</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in_scope">Is_last_in_scope</a></span> <span class="id">P_last</span> <span class="id">cy</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blk</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</span></div>
<div class="proofscript" id="proof77">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hdep</span> <span class="id">Hind</span>; <span class="id">inv</span> <span class="id">Hdep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">edestruct</span> <span class="id">Hind</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">lcaus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl_Exists</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_last_decl">depends_on_last_decl</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">lcaus</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.depends_branch_def_last">depends_branch_def_last</a></span> {<span class="id">A</span>} <span class="id">P_dep</span> <span class="id">P_def</span> <span class="id">P_last</span> <span class="id">cy</span> <span class="id">cx</span> : <span class="kwd">forall</span> <span class="id">caus</span> (<span class="id">blk</span>: <span class="id">A</span>) Γ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_branch">depends_on_branch</a></span> <span class="id">P_dep</span> Γ <span class="id">cy</span> <span class="id">cx</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blk</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ, <span class="id">P_dep</span> Γ <span class="id">cy</span> <span class="id">cx</span> <span class="id">blk</span> -&gt; <span class="id">P_def</span> Γ <span class="id">blk</span> \/ <span class="id">P_last</span> <span class="id">blk</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in_branch">Is_defined_in_branch</a></span> <span class="id">P_def</span> Γ <span class="id">cy</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blk</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in_branch">Is_last_in_branch</a></span> <span class="id">P_last</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blk</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof78')">Proof.</span></div>
<div class="proofscript" id="proof78">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hdep</span> <span class="id">Hind</span>; <span class="id">inv</span> <span class="id">Hdep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">edestruct</span> <span class="id">Hind</span>; <span class="tactic">eauto</span>; [<span class="tactic">left</span>|<span class="tactic">right</span>]; <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">left</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.DefBranch2">DefBranch2</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.depends_on_def_last">depends_on_def_last</a></span> <span class="id">cy</span> <span class="id">cx</span> : <span class="kwd">forall</span> <span class="id">blk</span> Γ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on">depends_on</a></span> Γ <span class="id">cy</span> <span class="id">cx</span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_defined_in">Is_defined_in</a></span> Γ <span class="id">cy</span> <span class="id">blk</span> \/ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_last_in">Is_last_in</a></span> <span class="id">cy</span> <span class="id">blk</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof79')">Proof.</span></div>
<div class="proofscript" id="proof79">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.block_ind2">block_ind2</a></span>; <span class="tactic">intros</span> * <span class="id">Hdep</span>; <span class="id">inv</span> <span class="id">Hdep</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;equation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">left</span>. <span class="tactic">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error_In">nth_error_In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">H</span>; <span class="tactic">eauto</span>; [<span class="tactic">left</span>|<span class="tactic">right</span>]; <span class="tactic">econstructor</span>; <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;switch&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>. <span class="tactic">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_branch_def_last">depends_branch_def_last</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> [|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">left</span>. <span class="tactic">econstructor</span>. <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">right</span>. <span class="tactic">econstructor</span>. <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> * <span class="id">Hex</span>; <span class="id">simpl_Exists</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">H</span>; <span class="tactic">eauto</span>; [<span class="tactic">left</span>|<span class="tactic">right</span>]; <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;automaton&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>. <span class="tactic">destruct</span> <span class="id">b</span> <span class="kwd">as</span> [?(?&amp;[?(?&amp;?)])].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_branch_def_last">depends_branch_def_last</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> [|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">left</span>. <span class="tactic">econstructor</span>. <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">right</span>. <span class="tactic">econstructor</span>. <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> * <span class="id">Hdep</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_scope_def_last">depends_scope_def_last</a></span> <span class="kwd">in</span> <span class="id">Hdep</span> <span class="kwd">as</span> [|]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hex</span>; <span class="id">simpl_Exists</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">H</span>; <span class="tactic">eauto</span>; [<span class="tactic">left</span>|<span class="tactic">right</span>]; <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_scope_def_last">depends_scope_def_last</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> [|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">left</span>. <span class="tactic">econstructor</span>. <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">right</span>. <span class="tactic">econstructor</span>. <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> * <span class="id">Hex</span>; <span class="id">simpl_Exists</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">H</span>; <span class="tactic">eauto</span>; [<span class="tactic">left</span>|<span class="tactic">right</span>]; <span class="id">solve_Exists</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.build_graph_find">build_graph_find</a></span> {<span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.complete">complete</a></span> <span class="id">prefs</span>) <span class="id">n</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_node">wl_node</a></span> <span class="id">G</span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_node">wx_node</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_decls">idcaus_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_locals">idcaus_of_locals</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_block">n_block</a></span> <span class="id">n</span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_node">depends_on_node</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">ys</span>, (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.build_graph">build_graph</a></span> <span class="id">n</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ys</span> /\ <span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">y</span> <span class="id">ys</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof80')">Proof.</span></div>
<div class="proofscript" id="proof80">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwl</span> <span class="id">Hwx</span> <span class="id">Hndcaus</span> <span class="id">Hdep</span>. <span class="id">inv</span> <span class="id">Hwl</span>. <span class="id">inv</span> <span class="id">Hwx</span>. <span class="tactic">subst</span> Γ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.node_NoDupMembers">node_NoDupMembers</a></span> <span class="id">n</span>) <span class="kwd">as</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_syn">n_syn</a></span> <span class="id">n</span>) <span class="kwd">as</span> <span class="id">Syn</span>. <span class="tactic">inversion_clear</span> <span class="id">Syn</span> <span class="kwd">as</span> [??? <span class="id">Hdef</span> <span class="id">Hperm</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.build_graph">build_graph</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x2</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">cx</span>, <span class="id">_</span>)) =&gt; (<span class="id">x2</span>, <span class="id">cx</span>)) (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>))) <span class="kwd">as</span> <span class="id">Hnd1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_ins">senv_of_ins</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, 2 <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span>. <span class="id">erewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, 2 <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span> <span class="kwd">with</span> (<span class="id">l</span>:=<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.decl">decl</a></span> <span class="kwd">in</span> *; <span class="tactic">intros</span>; <span class="id">destruct_conjs</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x2</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">o</span>)) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">cx0</span>) =&gt; (<span class="id">x2</span>, <span class="id">cx0</span>)) <span class="id">o</span>) (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>))) <span class="kwd">as</span> <span class="id">Hnd2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_map_filter">NoDupMembers_map_filter</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>; <span class="id">destruct_conjs</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">o</span> <span class="kwd">as</span> [(?&amp;?)|]; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_r">NoDup_app_r</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_nodup">n_nodup</a></span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">cx</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">cx</span>)) (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>))) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) <span class="id">x</span> <span class="id">cx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="kwd">as</span> <span class="id">Henv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.from_list_find_In">Env.from_list_find_In</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="id">simpl_In</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">left</span>|<span class="tactic">right</span>]; <span class="tactic">econstructor</span>; <span class="id">solve_In</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hin</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.find_In_from_list">Env.find_In_from_list</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> [|]; [<span class="tactic">left</span>|<span class="tactic">right</span>]; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x1</span>, (<span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">o</span>)) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">cx</span>) =&gt; (<span class="id">x1</span>, <span class="id">cx</span>)) <span class="id">o</span>) (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>))) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) <span class="id">x</span> <span class="id">cx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="kwd">as</span> <span class="id">Henvl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.from_list_find_In">Env.from_list_find_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>. <span class="tactic">econstructor</span>. <span class="id">solve_In</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hin</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.find_In_from_list">Env.find_In_from_list</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> [<span class="id">In</span>|<span class="id">In</span>]; <span class="id">simpl_In</span>; [<span class="tactic">congruence</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hdep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;dependency&nbsp;from&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_on_spec">collect_depends_on_spec</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> (?&amp;<span class="id">Hx</span>&amp;<span class="id">Hy</span>); <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.node_NoDupLocals">node_NoDupLocals</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_Subset">unions_fuse_Subset</a></span> <span class="kwd">in</span> <span class="id">Hx</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hin</span>). <span class="id">erewrite</span> <span class="id">Hfind</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> 2 <span class="id"><a href="Velus.Environment.html#Env.elements_from_list">Env.elements_from_list</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_decls">idcaus_of_decls</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.idcaus_of_senv">idcaus_of_senv</a></span> <span class="kwd">in</span> *. <span class="id">simpl_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span> <span class="kwd">with</span> (<span class="id">l</span>:=<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>), <span class="id"><a href="Velus.Common.CommonList.html#map_filter_map">map_filter_map</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span> <span class="kwd">with</span> (<span class="id">l</span>:=<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id">n</span>), <span class="id"><a href="Velus.Common.CommonList.html#map_filter_ext">map_filter_ext</a></span> <span class="kwd">in</span> <span class="id">Hndcaus</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.decl">decl</a></span>; <span class="tactic">intros</span>; <span class="id">destruct_conjs</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">o</span> <span class="kwd">as</span> [(?&amp;?)|]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hperm</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_r">NoDup_app_r</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_nodup">n_nodup</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hperm</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.In_from_list">Env.In_from_list</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#InMembers_app">InMembers_app</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#or_intror">or_intror</a></span>. <span class="id">solve_In</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;dependency&nbsp;from&nbsp;lasts&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.collect_depends_last_spec">collect_depends_last_spec</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> (?&amp;<span class="id">Hx</span>&amp;<span class="id">Hy</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.unions_fuse_Subset">unions_fuse_Subset</a></span> <span class="kwd">in</span> <span class="id">Hx</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind</span>&amp;<span class="id">Hin</span>). <span class="id">erewrite</span> <span class="id">Hfind</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> 2 <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> <span class="id">Hndcaus</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_r">NoDup_app_r</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_r">NoDup_app_r</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_nodup">n_nodup</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">We prove that the <span class="bracket"><span class="id">check_node_causality</span></span> function only succeeds if
      the node is indeed causal.
      This is a simple consequence of <span class="bracket"><span class="id">build_graph_find</span></span> and <span class="bracket"><span class="id">build_acyclic_graph_spec</span></span>.
   </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.check_node_causality_correct">check_node_causality_correct</a></span> {<span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.complete">complete</a></span> <span class="id">prefs</span>) <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_node">wl_node</a></span> <span class="id">G</span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_node">wx_node</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.check_node_causality">check_node_causality</a></span> <span class="id">n</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal">node_causal</a></span> <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof81')">Proof.</span></div>
<div class="proofscript" id="proof81">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwl</span> <span class="id">Hwx</span> <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.check_node_causality">check_node_causality</a></span> <span class="kwd">in</span> <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">Heq</span>. <span class="id">inv</span> <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">Heq</span> <span class="kwd">as</span> (<span class="id">NoDup</span>&amp;<span class="id">Equal</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.Common.html#check_nodup_correct">check_nodup_correct</a></span> <span class="kwd">in</span> <span class="id">NoDup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.Common.html#PSF.equal_2">PSF.equal_2</a></span> <span class="kwd">in</span> <span class="id">Equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.AcyGraph.html#build_acyclic_graph_spec">build_acyclic_graph_spec</a></span> <span class="kwd">in</span> <span class="id">Heq0</span> <span class="kwd">as</span> (<span class="id">a</span>&amp;(<span class="id">Hv</span>&amp;<span class="id">Ha</span>)&amp;<span class="id">Graph</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">t</span>. <span class="tactic">exists</span> <span class="id">a</span>. <span class="tactic">exists</span> <span class="id">Graph</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Equal</span>. <span class="tactic">intros</span> <span class="id">x</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.map_in_iff">Env.Props.P.F.map_in_iff</a></span>, <span class="id"><a href="Velus.Common.Common.html#In_of_list_InMembers">In_of_list_InMembers</a></span>, <span class="id"><a href="Velus.Environment.html#Env.In_Members">Env.In_Members</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Hdep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.build_graph_find">build_graph_find</a></span> <span class="kwd">in</span> <span class="id">Hwl</span> <span class="kwd">as</span> (<span class="id">ys</span> &amp; <span class="id">Find</span> &amp; <span class="id">In</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id"><a href="Velus.Common.Common.html#PSP.to_list">PSP.to_list</a></span> <span class="id">ys</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.map_o">Env.Props.P.F.map_o</a></span>, <span class="id">Find</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#In_PS_elements">In_PS_elements</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCAUSALITY.check_causality_correct">check_causality_correct</a></span> {<span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.complete">complete</a></span> <span class="id">prefs</span>) <span class="id">tts</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_global">wl_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_global">wx_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.check_causality">check_causality</a></span> <span class="id">G</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">OK</a></span> <span class="id">tts</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal">node_causal</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.nodes">nodes</a></span> <span class="id">G</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof82')">Proof.</span></div>
<div class="proofscript" id="proof82">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_global">wl_global</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_global">wx_global</a></span>, <span class="id"><a href="Velus.Common.CommonTyping.html#wt_program">CommonTyping.wt_program</a></span>, <span class="id"><a href="Velus.Common.CommonProgram.html#units">CommonProgram.units</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.check_causality">check_causality</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">G</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.nodes">nodes</a></span> <span class="id">G</span>); <span class="tactic">intros</span> * <span class="id">Hwl</span> <span class="id">Hwx</span> <span class="id">Hcheck</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwl</span>. <span class="id">inv</span> <span class="id">Hwx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.check_causality">check_causality</a></span> <span class="kwd">in</span> <span class="id">Hcheck</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#bind_inversion">bind_inversion</a></span> <span class="kwd">in</span> <span class="id">Hcheck</span> <span class="kwd">as</span> [? [? <span class="id">Hcheck</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">x</span>. <span class="tactic">destruct</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.check_node_causality_correct">check_node_causality_correct</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#bind_inversion">bind_inversion</a></span> <span class="kwd">in</span> <span class="id">Hcheck</span> <span class="kwd">as</span> [? [? <span class="id">Hcheck</span>]]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> Induction lemmas over a causal node </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind">exp_causal_ind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">PSyn</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.decl">decl</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.block">block</a></span> -&gt; <span class="kwd">Prop</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">prefs</span> : <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind.G">G</a></span> : @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.PSyn">PSyn</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.prefs">prefs</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> Γ : <span class="id"><a href="Velus.Lustre.LCausality.html#Senv.static_env">static_env</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind.P_var">P_var</a></span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> : <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.exp">exp</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCAUSALITY.P_exps">P_exps</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.exp">exp</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.P_exps_now">P_exps_now</a></span> <span class="id">e</span> <span class="id">es</span> <span class="id">k</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> <span class="id">e</span> <span class="id">k</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_exps</span> (<span class="id">e</span>::<span class="id">es</span>) <span class="id">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCAUSALITY.P_exps_later">P_exps_later</a></span> <span class="id">e</span> <span class="id">es</span> <span class="id">k</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &gt;= <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_exps</span> <span class="id">es</span> (<span class="id">k</span>-<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_exps</span> (<span class="id">e</span>::<span class="id">es</span>) <span class="id">k</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.Pexp_Pexps">Pexp_Pexps</a></span> : <span class="kwd">forall</span> <span class="id">es</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">forall</span> <span class="id">k</span>, <span class="id">k</span> &lt; <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">x</span> <span class="id">k</span> <span class="id">e</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_var">P_var</a></span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> <span class="id">e</span> <span class="id">k</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list">Is_free_left_list</a></span> Γ <span class="id">x</span> <span class="id">k</span> <span class="id">es</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_var">P_var</a></span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.annots">annots</a></span> <span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.P_exps">P_exps</a></span> <span class="id">es</span> <span class="id">k</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof83')">Proof.</span></div>
<div class="proofscript" id="proof83">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">es</span>; <span class="tactic">intros</span> * <span class="id">Hf</span> <span class="id">Hfree</span> <span class="id">Hk</span>; <span class="id">inv</span> <span class="id">Hf</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">Hk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.ltb">Nat.ltb</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.numstreams">numstreams</a></span> <span class="id">a</span>)) <span class="id">eqn</span>:<span class="id">Hltb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.ltb_lt">PeanoNat.Nat.ltb_lt</a></span> <span class="kwd">in</span> <span class="id">Hltb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">lcaus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.ltb_ge">PeanoNat.Nat.ltb_ge</a></span> <span class="kwd">in</span> <span class="id">Hltb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.P_exps_later">P_exps_later</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHes</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">lcaus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_length">app_length</a></span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.length_annot_numstreams">length_annot_numstreams</a></span> <span class="kwd">in</span> <span class="id">Hk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind.EconstCase">EconstCase</a></span> : <span class="kwd">forall</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Econst">Econst</a></span> <span class="id">c</span>) 0.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind.EenumCase">EenumCase</a></span> : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Eenum">Eenum</a></span> <span class="id">k</span> <span class="id">ty</span>) 0.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind.EvarCase">EvarCase</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span> <span class="id">ann</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_var">P_var</a></span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Evar">Evar</a></span> <span class="id">x</span> <span class="id">ann</span>) 0.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind.ElastCase">ElastCase</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span> <span class="id">ann</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasLastCaus">HasLastCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_var">P_var</a></span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Elast">Elast</a></span> <span class="id">x</span> <span class="id">ann</span>) 0.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind.EunopCase">EunopCase</a></span> : <span class="kwd">forall</span> <span class="id">op</span> <span class="id">e1</span> <span class="id">ann</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> <span class="id">e1</span> 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Eunop">Eunop</a></span> <span class="id">op</span> <span class="id">e1</span> <span class="id">ann</span>) 0.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind.EbinopCase">EbinopCase</a></span> : <span class="kwd">forall</span> <span class="id">op</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">ann</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> <span class="id">e1</span> 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> <span class="id">e2</span> 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Ebinop">Ebinop</a></span> <span class="id">op</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">ann</span>) 0.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind.EextcallCase">EextcallCase</a></span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">es</span> <span class="id">ann</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.annots">annots</a></span> <span class="id">es</span>) -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.P_exps">P_exps</a></span> <span class="id">es</span> <span class="id">k</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Eextcall">Eextcall</a></span> <span class="id">f</span> <span class="id">es</span> <span class="id">ann</span>) 0.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind.EfbyCase">EfbyCase</a></span> : <span class="kwd">forall</span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">ann</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">ann</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.P_exps">P_exps</a></span> <span class="id">e0s</span> <span class="id">k</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Efby">Efby</a></span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">ann</span>) <span class="id">k</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind.EarrowCase">EarrowCase</a></span> : <span class="kwd">forall</span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">ann</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">ann</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.P_exps">P_exps</a></span> <span class="id">e0s</span> <span class="id">k</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.P_exps">P_exps</a></span> <span class="id">es</span> <span class="id">k</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Earrow">Earrow</a></span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">ann</span>) <span class="id">k</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind.EwhenCase">EwhenCase</a></span> : <span class="kwd">forall</span> <span class="id">es</span> <span class="id">x</span> <span class="id">tx</span> <span class="id">cx</span> <span class="id">b</span> <span class="id">ann</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ann</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.P_exps">P_exps</a></span> <span class="id">es</span> <span class="id">k</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_var">P_var</a></span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Ewhen">Ewhen</a></span> <span class="id">es</span> (<span class="id">x</span>, <span class="id">tx</span>) <span class="id">b</span> <span class="id">ann</span>) <span class="id">k</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind.EmergeCase">EmergeCase</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">cx</span> <span class="id">tx</span> <span class="id">es</span> <span class="id">ann</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ann</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.HasCaus">HasCaus</a></span> Γ <span class="id">x</span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_var">P_var</a></span> <span class="id">cx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.P_exps">P_exps</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>) <span class="id">k</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Emerge">Emerge</a></span> (<span class="id">x</span>, <span class="id">tx</span>) <span class="id">es</span> <span class="id">ann</span>) <span class="id">k</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind.EcaseCase">EcaseCase</a></span> : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">es</span> <span class="id">d</span> <span class="id">ann</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ann</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> <span class="id">e</span> 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.P_exps">P_exps</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>) <span class="id">k</span>) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#LiftO">LiftO</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> (<span class="kwd">fun</span> <span class="id">d</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.P_exps">P_exps</a></span> <span class="id">d</span> <span class="id">k</span>) <span class="id">d</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Ecase">Ecase</a></span> <span class="id">e</span> <span class="id">es</span> <span class="id">d</span> <span class="id">ann</span>) <span class="id">k</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind.EappCase">EappCase</a></span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">es</span> <span class="id">er</span> <span class="id">ann</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">ann</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.annots">annots</a></span> <span class="id">es</span>) -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.P_exps">P_exps</a></span> <span class="id">es</span> <span class="id">k</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">k</span>, <span class="id">k</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.annots">annots</a></span> <span class="id">er</span>) -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.P_exps">P_exps</a></span> <span class="id">er</span> <span class="id">k</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.Eapp">Eapp</a></span> <span class="id">f</span> <span class="id">es</span> <span class="id">er</span> <span class="id">ann</span>) <span class="id">k</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="LCAUSALITY.exp_causal_ind">exp_causal_ind</a></span> <span class="id">e</span> {<span class="kwd">struct</span> <span class="id">e</span>} : <span class="kwd">forall</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_exp">wl_exp</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.G">G</a></span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_exp">wx_exp</a></span> Γ <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> Γ <span class="id">x</span> <span class="id">k</span> <span class="id">e</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_var">P_var</a></span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> &lt; <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.numstreams">numstreams</a></span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_exp">P_exp</a></span> <span class="id">e</span> <span class="id">k</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof84')">Proof with</span></div>
<div class="proofscript" id="proof84">
 <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">senv</span> <span class="id">lcaus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Ltac</span> <span class="id">solve_forall</span>' <span class="id">es</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Hwl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_exp">wl_exp</a></span> <span class="id">_</span>) <span class="id">es</span>, <span class="id">Hwx</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wx_exp">wx_exp</a></span> <span class="id">_</span>) <span class="id">es</span>, <span class="id">Hind</span> : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">k</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.wl_exp">wl_exp</a></span> <span class="id">_</span> <span class="id">e</span> -&gt; <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hind</span> <span class="id">Hwl</span> <span class="id">Hwx</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">es</span>; <span class="id">inv</span> <span class="id">Hwl</span>; <span class="id">inv</span> <span class="id">Hwx</span>; <span class="tactic">constructor</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hwl</span> <span class="id">Hwx</span> <span class="id">Hfree</span> <span class="id">Hnum</span>; <span class="tactic">destruct</span> <span class="id">e</span>; <span class="id">inv</span> <span class="id">Hwl</span>; <span class="id">inv</span> <span class="id">Hwx</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">_</span> &lt; 1 |- <span class="id">_</span> =&gt; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.lt_1_r">PeanoNat.Nat.lt_1_r</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;var&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_In">InMembers_In</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.EvarCase">EvarCase</a></span>, <span class="id">Hfree</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;last&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Senv.causl_last">causl_last</a></span> <span class="id">e</span>) <span class="id">eqn</span>:<span class="id">Hfind</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.ElastCase">ElastCase</a></span>, <span class="id">Hfree</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;unop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.EunopCase">EunopCase</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">exp_causal_ind</span>... <span class="tactic">rewrite</span> <span class="id">H4</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;binop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.EbinopCase">EbinopCase</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">eapply</span> <span class="id">exp_causal_ind</span>... <span class="tactic">rewrite</span> <span class="id">H6</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">H7</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;extcall&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.EextcallCase">EextcallCase</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">k</span>' <span class="id">Hk</span>'. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Pexp_Pexps">Pexp_Pexps</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">solve_forall</span>' <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> ? <span class="id">Hfree</span>'. <span class="tactic">eapply</span> <span class="id">Hfree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list_Exists">Is_free_left_list_Exists</a></span> <span class="kwd">in</span> <span class="id">Hfree</span>' <span class="kwd">as</span> [? ?]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;fby&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.EfbyCase">EfbyCase</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Pexp_Pexps">Pexp_Pexps</a></span>... 2:<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_forall</span>' <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;arrow&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.EarrowCase">EarrowCase</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Pexp_Pexps">Pexp_Pexps</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">lcaus</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_forall</span>' <span class="id">l</span>. <span class="id">solve_forall</span>' <span class="id">l0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;when&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_In">InMembers_In</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.EwhenCase">EwhenCase</a></span>... 2:<span class="tactic">eapply</span> <span class="id">Hfree</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Pexp_Pexps">Pexp_Pexps</a></span>... 2:<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_forall</span>' <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;merge&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_In">InMembers_In</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.EmergeCase">EmergeCase</a></span>... <span class="tactic">eapply</span> <span class="id">Hfree</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list">Is_free_left_list</a></span> Γ <span class="id">x</span> <span class="id">k</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>)) <span class="id">l</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_var">P_var</a></span> <span class="id">x</span>) <span class="kwd">as</span> <span class="id">Hfree</span>' <span class="tactic">by</span> <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">lcaus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Hfree</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="id">inv</span> <span class="id">H4</span>; <span class="id">inv</span> <span class="id">H5</span>; <span class="id">inv</span> <span class="id">H7</span>; <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Pexp_Pexps">Pexp_Pexps</a></span>; <span class="tactic">eauto</span>. 2:<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">exp_causal_ind</span> <span class="id">H2</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>. <span class="tactic">induction</span> <span class="id">l</span>; <span class="id">inv</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H5</span>; <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.EcaseCase">EcaseCase</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">exp_causal_ind</span>... <span class="tactic">rewrite</span> <span class="id">H4</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list">Is_free_left_list</a></span> Γ <span class="id">x</span> <span class="id">k</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>)) <span class="id">l</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.P_var">P_var</a></span> <span class="id">x</span>) <span class="kwd">as</span> <span class="id">Hfree</span>' <span class="tactic">by</span> <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">lcaus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Hfree</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="id">inv</span> <span class="id">H7</span>; <span class="id">inv</span> <span class="id">H8</span>; <span class="id">inv</span> <span class="id">H12</span>; <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Pexp_Pexps">Pexp_Pexps</a></span>; <span class="tactic">eauto</span>. 2:<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">exp_causal_ind</span> <span class="id">H1</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>. <span class="tactic">induction</span> <span class="id">l</span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H8</span>; <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">o</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">H9</span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>). <span class="tactic">specialize</span> (<span class="id">H10</span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>). <span class="tactic">specialize</span> (<span class="id">H13</span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Pexp_Pexps">Pexp_Pexps</a></span>; <span class="tactic">eauto</span>. 3:<span class="tactic">congruence</span>. 2:<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">Hfree</span>; <span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Hfree</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l0</span>; <span class="id">inv</span> <span class="id">H9</span>; <span class="id">inv</span> <span class="id">H13</span>; <span class="tactic">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;app&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind.EappCase">EappCase</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">k</span>' <span class="id">Hk</span>'. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Pexp_Pexps">Pexp_Pexps</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">solve_forall</span>' <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> ? <span class="id">Hfree</span>'. <span class="tactic">eapply</span> <span class="id">Hfree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list_Exists">Is_free_left_list_Exists</a></span> <span class="kwd">in</span> <span class="id">Hfree</span>' <span class="kwd">as</span> [? ?]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">k</span>' <span class="id">Hk</span>'. <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Pexp_Pexps">Pexp_Pexps</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">solve_forall</span>' <span class="id">l0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> ? <span class="id">Hfree</span>'. <span class="tactic">eapply</span> <span class="id">Hfree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_list_Exists">Is_free_left_list_Exists</a></span> <span class="kwd">in</span> <span class="id">Hfree</span>' <span class="kwd">as</span> [? ?]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>. <span class="id">solve_Exists</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.length_annot_numstreams">length_annot_numstreams</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left">Is_free_left</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">rename</span> <span class="id">it</span> <span class="id">into</span> <span class="id">Hfree1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hfree2</span>:=<span class="id">Hfree1</span>). <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.Is_free_left_length">Is_free_left_length</a></span> <span class="kwd">in</span> <span class="id">Hfree1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">Hfree1</span>. <span class="tactic">destruct</span> <span class="id">x0</span>; <span class="tactic">auto</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.exp_causal_ind">exp_causal_ind</a></span>.<br/>
<br/>
<div class="doc">More flexible induction principle </div>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="LCAUSALITY.node_causal_ind">node_causal_ind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">PSyn</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.decl">decl</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#Syn.block">block</a></span> -&gt; <span class="kwd">Prop</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">prefs</span> : <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="LCAUSALITY.node_causal_ind.n">n</a></span> : @<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.node">node</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.PSyn">PSyn</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.prefs">prefs</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="LCAUSALITY.node_causal_ind.P_vars">P_vars</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCAUSALITY.causal_ind">causal_ind</a></span> {<span class="id">v</span> <span class="id">a</span>} : <span class="kwd">forall</span> (<span class="id">g</span> : <span class="id"><a href="Velus.AcyGraph.html#AcyGraph">AcyGraph</a></span> <span class="id">v</span> <span class="id">a</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.graph_of_node">graph_of_node</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.n">n</a></span> <span class="id">g</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">xs</span> <span class="id">ys</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.P_vars">P_vars</a></span> <span class="id">xs</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.P_vars">P_vars</a></span> <span class="id">ys</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.P_vars">P_vars</a></span> [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.n">n</a></span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_decls">idcaus_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.n">n</a></span>))) \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_locals">idcaus_of_locals</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_block">n_block</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.n">n</a></span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.P_vars">P_vars</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">y</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_node">depends_on_node</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.n">n</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">y</span> <span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.P_vars">P_vars</a></span> (<span class="id">x</span>::<span class="id">xs</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.P_vars">P_vars</a></span> (<span class="id"><a href="Velus.Common.Common.html#PS.elements">PS.elements</a></span> (<span class="id"><a href="Velus.AcyGraph.html#vertices">vertices</a></span> <span class="id">g</span>)).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof85')">Proof.</span></div>
<div class="proofscript" id="proof85">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * [<span class="id">Hv</span> <span class="id">Ha</span>] <span class="id">Hperm</span> <span class="id">Hnil</span> <span class="id">Hdep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id"><a href="Velus.AcyGraph.html#has_TopoOrder">has_TopoOrder</a></span> <span class="id">g</span>) <span class="kwd">as</span> (<span class="id">xs</span>'&amp;<span class="id">Heq</span>&amp;<span class="id">Hpre</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hperm</span>. <span class="tactic">rewrite</span> <span class="id">Heq</span>, <span class="id"><a href="Velus.Common.CommonPS.html#Permutation_PS_elements_of_list">Permutation_PS_elements_of_list</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.AcyGraph.html#TopoOrder_NoDup">TopoOrder_NoDup</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id">xs</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.n">n</a></span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_decls">idcaus_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.n">n</a></span>) ++ (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_locals">idcaus_of_locals</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_block">n_block</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.n">n</a></span>))))) <span class="kwd">as</span> <span class="id">Hincl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Velus.Common.CommonPS.html#ps_from_list_ps_of_list">ps_from_list_ps_of_list</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">Hin</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Velus.Common.CommonPS.html#ps_from_list_In">ps_from_list_In</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Heq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">xs</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">incl_cons</span>' <span class="kwd">in</span> <span class="id">Hincl</span> <span class="kwd">as</span> (<span class="id">Hin</span>&amp;<span class="id">Hincl</span>). <span class="tactic">inversion_clear</span> <span class="id">Hpre</span> <span class="kwd">as</span> [|?? (?&amp;?&amp;<span class="id">Hin</span>') <span class="id">Hpre</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hdep</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> * <span class="id">Hdep</span>'. <span class="tactic">eapply</span> <span class="id">Hin</span>'. <span class="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Ha</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCAUSALITY.node_causal_ind">node_causal_ind</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal">node_causal</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.n">n</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">xs</span> <span class="id">ys</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.P_vars">P_vars</a></span> <span class="id">xs</span> -&gt; <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.P_vars">P_vars</a></span> <span class="id">ys</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.P_vars">P_vars</a></span> [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.n">n</a></span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_decls">idcaus_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.n">n</a></span>))) \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_locals">idcaus_of_locals</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_block">n_block</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.n">n</a></span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.P_vars">P_vars</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">y</span>, <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.depends_on_node">depends_on_node</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.n">n</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">y</span> <span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.P_vars">P_vars</a></span> (<span class="id">x</span>::<span class="id">xs</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.P_vars">P_vars</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus">idcaus</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_in">n_in</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.n">n</a></span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_decls">idcaus_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_out">n_out</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.n">n</a></span>) ++ <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.idcaus_of_locals">idcaus_of_locals</a></span> (<span class="id"><a href="Velus.Lustre.LCausality.html#Syn.n_block">n_block</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind.n">n</a></span>))).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof86')">Proof.</span></div>
<div class="proofscript" id="proof86">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * (<span class="id">Hnd</span>&amp;?&amp;?&amp;<span class="id">g</span>&amp;<span class="id">Hcaus</span>) <span class="id">Hperm</span> <span class="id">Hnil</span> <span class="id">Hdep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hvars</span>:=<span class="id">Hcaus</span>). <span class="tactic">eapply</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.causal_ind">causal_ind</a></span> <span class="kwd">in</span> <span class="id">Hvars</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hcaus</span> <span class="kwd">as</span> (<span class="id">Heq</span>&amp;<span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hperm</span>; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heq</span>, <span class="id"><a href="Velus.Common.CommonPS.html#Permutation_PS_elements_of_list">Permutation_PS_elements_of_list</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY.node_causal_ind">node_causal_ind</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY">LCAUSALITY</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="LCausalityFun">LCausalityFun</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Ids</span>   : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Op</span>    : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Cks</span>   : <span class="id"><a href="Velus.Clocks.html#CLOCKS">CLOCKS</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Senv</span>  : <span class="id"><a href="Velus.Lustre.StaticEnv.html#STATICENV">STATICENV</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Syn</span>   : <span class="id"><a href="Velus.Lustre.LSyntax.html#LSYNTAX">LSYNTAX</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv">Senv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;: <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY">LCAUSALITY</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn">Syn</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Include</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCAUSALITY">LCAUSALITY</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.LCausality.html#Syn">Syn</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LCausality.html#LCausalityFun">LCausalityFun</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
