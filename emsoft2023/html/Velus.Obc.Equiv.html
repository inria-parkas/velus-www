
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Equiv</title>
<meta name="description" content="Documentation of Coq module Equiv" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Equiv</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.FSets.FMapPositive.html">FSets.FMapPositive</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.PArith.html">PArith</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.CommonTyping.html">CommonTyping</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Environment.html">Environment</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Operators.html">Operators</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Obc.ObcSyntax.html">Obc.ObcSyntax</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Obc.ObcSemantics.html">Obc.ObcSemantics</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Obc.ObcTyping.html">Obc.ObcTyping</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Relations.Relations.html">Relations</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Setoids.Setoid.html">Setoid</a></span>.<br/>
<br/>
<span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<br/>
<h1> Equivalence of Obc programs </h1>
<br/>
<span class="kwd">Module</span> <span class="kwd">Type</span> <span class="id"><a name="EQUIV">EQUIV</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Ids</span>          : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Op</span>    : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Syn</span>   : <span class="id"><a href="Velus.Obc.ObcSyntax.html#OBCSYNTAX">OBCSYNTAX</a></span>     <span class="id"><a href="Velus.Obc.Equiv.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">ComTyp</span>: <span class="id"><a href="Velus.Common.CommonTyping.html#COMMONTYPING">COMMONTYPING</a></span>  <span class="id"><a href="Velus.Obc.Equiv.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Sem</span>   : <span class="id"><a href="Velus.Obc.ObcSemantics.html#OBCSEMANTICS">OBCSEMANTICS</a></span>  <span class="id"><a href="Velus.Obc.Equiv.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Typ</span>   : <span class="id"><a href="Velus.Obc.ObcTyping.html#OBCTYPING">OBCTYPING</a></span>     <span class="id"><a href="Velus.Obc.Equiv.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Syn">Syn</a></span>  <span class="id"><a href="Velus.Obc.Equiv.html#ComTyp">ComTyp</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Sem">Sem</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="EQUIV.stmt_eval_eq">stmt_eval_eq</a></span> <span class="id">s1</span> <span class="id">s2</span>: <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">prog</span> <span class="id">menv</span> <span class="id">env</span> <span class="id">menv</span>' <span class="id">env</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Sem.stmt_eval">stmt_eval</a></span> <span class="id">prog</span> <span class="id">menv</span> <span class="id">env</span> <span class="id">s1</span> (<span class="id">menv</span>', <span class="id">env</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Sem.stmt_eval">stmt_eval</a></span> <span class="id">prog</span> <span class="id">menv</span> <span class="id">env</span> <span class="id">s2</span> (<span class="id">menv</span>', <span class="id">env</span>').<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="EQUIV.stmt_eval_eq_refl">stmt_eval_eq_refl</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Relations.Relation_Definitions.html#reflexive">reflexive</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Syn.stmt">stmt</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq">stmt_eval_eq</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
 <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#iff_refl">iff_refl</a></span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="EQUIV.stmt_eval_eq_sym">stmt_eval_eq_sym</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Relations.Relation_Definitions.html#symmetric">symmetric</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Syn.stmt">stmt</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq">stmt_eval_eq</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">Heq</span> <span class="id">prog</span> <span class="id">menv</span> <span class="id">env</span> <span class="id">menv</span>' <span class="id">env</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">apply</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="EQUIV.stmt_eval_eq_trans">stmt_eval_eq_trans</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Relations.Relation_Definitions.html#transitive">transitive</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Syn.stmt">stmt</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq">stmt_eval_eq</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">s3</span> <span class="id">Heq1</span> <span class="id">Heq2</span> <span class="id">prog</span> <span class="id">menv</span> <span class="id">env</span> <span class="id">menv</span>' <span class="id">env</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">HH</span>; [<span class="tactic">apply</span> <span class="id">Heq2</span>, <span class="id">Heq1</span>|<span class="tactic">apply</span> <span class="id">Heq1</span>, <span class="id">Heq2</span>]; <span class="tactic">exact</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Add</span> <span class="id">Relation</span> <span class="id"><a href="Velus.Obc.Equiv.html#Syn.stmt">stmt</a></span> (<span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq">stmt_eval_eq</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span> <span class="id">proved</span> <span class="tactic">by</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq_refl">stmt_eval_eq_refl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="id">proved</span> <span class="tactic">by</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq_sym">stmt_eval_eq_sym</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">transitivity</span> <span class="id">proved</span> <span class="tactic">by</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq_trans">stmt_eval_eq_trans</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">stmt_eval_equiv</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="EQUIV.stmt_eval_eq_Proper">stmt_eval_eq_Proper</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq">stmt_eval_eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span>) <span class="id"><a href="Velus.Obc.Equiv.html#Sem.stmt_eval">stmt_eval</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">prog</span>' <span class="id">prog</span> <span class="id">HR1</span> <span class="id">menv</span>' <span class="id">menv</span> <span class="id">HR2</span> <span class="id">env</span>' <span class="id">env</span> <span class="id">HR3</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">Heq</span> <span class="id">r</span>' <span class="id">r</span> <span class="id">HR4</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">destruct</span> <span class="id">r</span> <span class="kwd">as</span> [<span class="id">menv</span>' <span class="id">env</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="EQUIV.stmt_eval_eq_Comp_Proper">stmt_eval_eq_Comp_Proper</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq">stmt_eval_eq</a></span> ==&gt; <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq">stmt_eval_eq</a></span> ==&gt; <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq">stmt_eval_eq</a></span>) <span class="id"><a href="Velus.Obc.Equiv.html#Syn.Comp">Comp</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s</span> <span class="id">s</span>' <span class="id">Hseq</span> <span class="id">t</span> <span class="id">t</span>' <span class="id">Hteq</span> <span class="id">prog</span> <span class="id">menv</span> <span class="id">env</span> <span class="id">menv</span>' <span class="id">env</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">inversion_clear</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">rewrite</span> <span class="id">Hseq</span>, <span class="id">Hteq</span> <span class="kwd">in</span> *; <span class="tactic">econstructor</span>; <span class="id">eassumption</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="tactic">rewrite</span> &lt;-<span class="id">Hseq</span>, &lt;-<span class="id">Hteq</span> <span class="kwd">in</span> *; <span class="tactic">econstructor</span>; <span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="EQUIV.Comp_assoc">Comp_assoc</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">s3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq">stmt_eval_eq</a></span> (<span class="id"><a href="Velus.Obc.Equiv.html#Syn.Comp">Comp</a></span> <span class="id">s1</span> (<span class="id"><a href="Velus.Obc.Equiv.html#Syn.Comp">Comp</a></span> <span class="id">s2</span> <span class="id">s3</span>)) (<span class="id"><a href="Velus.Obc.Equiv.html#Syn.Comp">Comp</a></span> (<span class="id"><a href="Velus.Obc.Equiv.html#Syn.Comp">Comp</a></span> <span class="id">s1</span> <span class="id">s2</span>) <span class="id">s3</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">prog</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">s3</span> <span class="id">menv</span> <span class="id">env</span> <span class="id">menv</span>' <span class="id">env</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">HH</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">progress</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Obc.Equiv.html#Sem.stmt_eval">stmt_eval</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="Velus.Obc.Equiv.html#Syn.Comp">Comp</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">_</span> =&gt; <span class="tactic">repeat</span> <span class="tactic">econstructor</span>; <span class="id">now</span> <span class="id">eassumption</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="EQUIV.stmt_eval_eq_Comp_Skip1">stmt_eval_eq_Comp_Skip1</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq">stmt_eval_eq</a></span> (<span class="id"><a href="Velus.Obc.Equiv.html#Syn.Comp">Comp</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Syn.Skip">Skip</a></span> <span class="id">s</span>) <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.Equiv.html#Sem.stmt_eval">stmt_eval</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> 1; <span class="id">now</span> <span class="id">chase_skip</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="EQUIV.stmt_eval_eq_Comp_Skip2">stmt_eval_eq_Comp_Skip2</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq">stmt_eval_eq</a></span> (<span class="id"><a href="Velus.Obc.Equiv.html#Syn.Comp">Comp</a></span> <span class="id">s</span> <span class="id"><a href="Velus.Obc.Equiv.html#Syn.Skip">Skip</a></span>) <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.Equiv.html#Sem.stmt_eval">stmt_eval</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> 1; <span class="id">now</span> <span class="id">chase_skip</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="EQUIV.stmt_eval_eq_Switch_Proper">stmt_eval_eq_Switch_Proper</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Common.Common.html#orel">orel</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq">stmt_eval_eq</a></span>) ==&gt; <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq">stmt_eval_eq</a></span> ==&gt; <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_eval_eq">stmt_eval_eq</a></span>) <span class="id"><a href="Velus.Obc.Equiv.html#Syn.Switch">Switch</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">e</span> <span class="id">e</span>' <span class="id">Heeq</span> <span class="id">ss</span> <span class="id">ss</span>' <span class="id">Hsseq</span> <span class="id">d</span> <span class="id">d</span>' <span class="id">Hd</span> <span class="id">prog</span> <span class="id">menv</span> <span class="id">env</span> <span class="id">menv</span>' <span class="id">env</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Heeq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">inversion_clear</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">edestruct</span> (@<span class="id"><a href="Velus.Common.CommonList.html#nth_error_Forall2">nth_error_Forall2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Syn.stmt">stmt</a></span>)) <span class="kwd">as</span> (?&amp; <span class="id">Nth</span> &amp; <span class="id">Sem</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Sem</span> <span class="kwd">as</span> [|?? <span class="id">Sem</span>']; <span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Sem</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_swap_args">Forall2_swap_args</a></span> <span class="kwd">in</span> <span class="id">Hsseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (@<span class="id"><a href="Velus.Common.CommonList.html#nth_error_Forall2">nth_error_Forall2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Syn.stmt">stmt</a></span>)) <span class="kwd">as</span> (?&amp; <span class="id">Nth</span> &amp; <span class="id">Sem</span>); <span class="tactic">eauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Sem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Sem</span> <span class="kwd">as</span> [|?? <span class="id">Sem</span>']; <span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Sem</span>'.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">A refinement relation for Obc.
      Refining programs are allowed to replace <span class="bracket"><span class="id">None</span></span> by any value. </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Import</span> <span class="id"><a href="Velus.Environment.html#Env.Notations">Env.Notations</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="EQUIV.exp_eval_refines">exp_eval_refines</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">menv</span>' <span class="id">env1</span> <span class="id">env2</span> <span class="id">e</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env2</span> ⊑ <span class="id">env1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Sem.exp_eval">exp_eval</a></span> <span class="id">menv</span>' <span class="id">env2</span> <span class="id">e</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Sem.exp_eval">exp_eval</a></span> <span class="id">menv</span>' <span class="id">env1</span> <span class="id">e</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">menv</span>' <span class="id">env1</span> <span class="id">env2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span>; <span class="tactic">intros</span> ? <span class="id">Henv</span>; <span class="tactic">inversion</span> 1; <span class="tactic">subst</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.Equiv.html#Sem.exp_eval">exp_eval</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">take</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span> (<span class="tactic">rewrite</span> <span class="id">it</span>; <span class="tactic">apply</span> <span class="id">Henv</span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (<span class="id">v</span>' &amp; -&gt; &amp; &lt;-));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.Equiv.html#Sem.exp_eval">exp_eval</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">take</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">apply</span> <span class="id">Henv</span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (<span class="id">v</span>' &amp; -&gt; &amp; ?);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.Equiv.html#Sem.exp_eval">exp_eval</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">exp_eval_refines</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">menv</span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">e</span> <span class="id">vo</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env2</span> ⊑ <span class="id">env1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Sem.exp_eval">exp_eval</a></span> <span class="id">menv</span> <span class="id">env2</span> <span class="id">e</span> <span class="id">vo</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">vo</span>', <span class="id"><a href="Velus.Obc.Equiv.html#Sem.exp_eval">exp_eval</a></span> <span class="id">menv</span> <span class="id">env1</span> <span class="id">e</span> <span class="id">vo</span>' /\ (<span class="kwd">forall</span> <span class="id">v</span>, <span class="id">vo</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> -&gt; <span class="id">vo</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">menv</span> <span class="id">env1</span> <span class="id">env2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span>; <span class="tactic">intros</span> <span class="id">vo</span> <span class="id">Henv</span>; <span class="tactic">inversion</span> 1; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.Equiv.html#Sem.exp_eval">exp_eval</a></span>, <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.exp_eval_refines">exp_eval_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">i</span> <span class="id">env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.exp_eval_refines">exp_eval_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">exists</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">i</span> <span class="id">env1</span>); <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.Equiv.html#Sem.exp_eval">exp_eval</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Forall2_exp_eval_refines</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">menv</span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">es</span> <span class="id">vos</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env2</span> ⊑ <span class="id">env1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Obc.Equiv.html#Sem.exp_eval">exp_eval</a></span> <span class="id">menv</span> <span class="id">env2</span>) <span class="id">es</span> <span class="id">vos</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">vos</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Obc.Equiv.html#Sem.exp_eval">exp_eval</a></span> <span class="id">menv</span> <span class="id">env1</span>) <span class="id">es</span> <span class="id">vos</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">vo</span> <span class="id">vo</span>' =&gt; <span class="kwd">forall</span> <span class="id">v</span>, <span class="id">vo</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> -&gt; <span class="id">vo</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>) <span class="id">vos</span> <span class="id">vos</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">menv</span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">es</span> <span class="id">vos</span> <span class="id">Henv</span> <span class="id">Hvos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hvos</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">exp_eval_refines</span>' <span class="kwd">with</span> (1:=<span class="id">Henv</span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">vo</span>' &amp; <span class="id">Heval</span> &amp; <span class="id">Hvo</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHHvos</span> <span class="kwd">as</span> (<span class="id">vos</span>' &amp; <span class="id">Hevals</span> &amp; <span class="id">Hvos</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2_cons">Forall2_cons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="EQUIV.stmt_refines">stmt_refines</a></span> <span class="id">prog1</span> <span class="id">prog2</span> <span class="id">P</span> <span class="id">s1</span> <span class="id">s2</span> : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">menv</span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">menv</span>' <span class="id">env2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id">env1</span> <span class="id">env2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env2</span> ⊑ <span class="id">env1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Sem.stmt_eval">stmt_eval</a></span> <span class="id">prog2</span> <span class="id">menv</span> <span class="id">env2</span> <span class="id">s2</span> (<span class="id">menv</span>', <span class="id">env2</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">env1</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env2</span>' ⊑ <span class="id">env1</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Obc.Equiv.html#Sem.stmt_eval">stmt_eval</a></span> <span class="id">prog1</span> <span class="id">menv</span> <span class="id">env1</span> <span class="id">s1</span> (<span class="id">menv</span>', <span class="id">env1</span>')).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="EQUIV.method_refines">method_refines</a></span> <span class="id">prog1</span> <span class="id">prog2</span> <span class="id">P</span> <span class="id">m1</span> <span class="id">m2</span> : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m1</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.m_in">m_in</a></span>) = <span class="id">m2</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.m_in">m_in</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m1</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.m_out">m_out</a></span>) = <span class="id">m2</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.m_out">m_out</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_refines">stmt_refines</a></span> <span class="id">prog1</span> <span class="id">prog2</span> (<span class="id">P</span> <span class="id">m1</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.m_in">m_in</a></span>)) <span class="id">m1</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.m_body">m_body</a></span>) <span class="id">m2</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.m_body">m_body</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="EQUIV.class_refines">class_refines</a></span> <span class="id">prog1</span> <span class="id">prog2</span> <span class="id">P</span> <span class="id">c1</span> <span class="id">c2</span> : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Syn.find_method">find_method</a></span> <span class="id">f</span> <span class="id">c2</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.c_methods">c_methods</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">m1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Syn.find_method">find_method</a></span> <span class="id">f</span> <span class="id">c1</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.c_methods">c_methods</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.method_refines">method_refines</a></span> <span class="id">prog1</span> <span class="id">prog2</span> (<span class="id">P</span> <span class="id">f</span>) <span class="id">m1</span> <span class="id">m2</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="EQUIV.ltsuffix2_prog">ltsuffix2_prog</a></span> := <span class="id"><a href="Velus.Common.CommonList.html#rr">rr</a></span> <span class="id"><a href="Velus.Common.CommonProgram.html#ltsuffix_prog">ltsuffix_prog</a></span> <span class="id"><a href="Velus.Common.CommonProgram.html#ltsuffix_prog">ltsuffix_prog</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="EQUIV.ltsuffix2_prog_wf">ltsuffix2_prog_wf</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Wf.html#well_founded">well_founded</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.ltsuffix2_prog">ltsuffix2_prog</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#rr_wf">rr_wf</a></span>; <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonProgram.html#ltsuffix_prog_wf">ltsuffix_prog_wf</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="EQUIV.program_refines">program_refines</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> -&gt; <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Obc.Equiv.html#Op.type">type</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Op.value">value</a></span> -&gt; <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Op.value">value</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">prog1</span> <span class="id">prog2</span> : <span class="id"><a href="Velus.Obc.Equiv.html#Syn.program">program</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonList.html#PFix">PFix</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.ltsuffix2_prog_wf">ltsuffix2_prog_wf</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">progs</span> : <span class="id"><a href="Velus.Obc.Equiv.html#Syn.program">program</a></span> * <span class="id"><a href="Velus.Obc.Equiv.html#Syn.program">program</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">program_refines</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">progs</span>' : <span class="id"><a href="Velus.Obc.Equiv.html#Syn.program">program</a></span> * <span class="id"><a href="Velus.Obc.Equiv.html#Syn.program">program</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.ltsuffix2_prog">ltsuffix2_prog</a></span> <span class="id">progs</span>' <span class="id">progs</span> -&gt; <span class="kwd">Prop</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">progs</span>).(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.types">types</a></span>) = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">progs</span>).(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.types">types</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">progs</span>).(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.externs">externs</a></span>) = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">progs</span>).(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.externs">externs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">c2</span> <span class="id">prog2</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hf2</span>: <span class="id"><a href="Velus.Obc.Equiv.html#Syn.find_class">find_class</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">progs</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c2</span>, <span class="id">prog2</span>')),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id">c1</span> : <span class="id"><a href="Velus.Obc.Equiv.html#Syn.class">class</a></span>) (<span class="id">prog1</span>' : <span class="id"><a href="Velus.Obc.Equiv.html#Syn.program">program</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hf1</span>: <span class="id"><a href="Velus.Obc.Equiv.html#Syn.find_class">find_class</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">progs</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c1</span>, <span class="id">prog1</span>')),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.class_refines">class_refines</a></span> <span class="id">prog1</span>' <span class="id">prog2</span>' (<span class="id">P</span> <span class="id">n</span>) <span class="id">c1</span> <span class="id">c2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">program_refines</span> (<span class="id">prog1</span>', <span class="id">prog2</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> (<span class="id"><a href="Velus.Common.CommonProgram.html#find_unit_ltsuffix_prog">find_unit_ltsuffix_prog</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">progs</span>) <span class="id">c1</span> <span class="id">prog1</span>' <span class="id">Hf1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonProgram.html#find_unit_ltsuffix_prog">find_unit_ltsuffix_prog</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">progs</span>) <span class="id">c2</span> <span class="id">prog2</span>' <span class="id">Hf2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;)) (<span class="id">prog1</span>, <span class="id">prog2</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="EQUIV.program_refines_def">program_refines_def</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">P</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> -&gt; <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Obc.Equiv.html#Op.type">type</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Op.value">value</a></span> -&gt; <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Op.value">value</a></span> -&gt; <span class="kwd">Prop</span>) <span class="id">prog1</span> <span class="id">prog2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines">program_refines</a></span> <span class="id">P</span> <span class="id">prog1</span> <span class="id">prog2</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">prog1</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.types">types</a></span>) = <span class="id">prog2</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.types">types</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">prog1</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.externs">externs</a></span>) = <span class="id">prog2</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.externs">externs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="kwd">forall</span> <span class="id">n</span> <span class="id">c2</span> <span class="id">prog2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Syn.find_class">find_class</a></span> <span class="id">n</span> <span class="id">prog2</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c2</span>, <span class="id">prog2</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id">c1</span> : <span class="id"><a href="Velus.Obc.Equiv.html#Syn.class">class</a></span>) (<span class="id">prog1</span>' : <span class="id"><a href="Velus.Obc.Equiv.html#Syn.program">program</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Syn.find_class">find_class</a></span> <span class="id">n</span> <span class="id">prog1</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c1</span>, <span class="id">prog1</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.class_refines">class_refines</a></span> <span class="id">prog1</span>' <span class="id">prog2</span>' (<span class="id">P</span> <span class="id">n</span>) <span class="id">c1</span> <span class="id">c2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines">program_refines</a></span> <span class="id">P</span> <span class="id">prog1</span>' <span class="id">prog2</span>').<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines">program_refines</a></span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#PFix_eq">PFix_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">split</span>; <span class="tactic">intros</span> (?&amp;?&amp; <span class="id">HH</span>); (<span class="tactic">split</span>; [|<span class="tactic">split</span>]); <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">n</span> <span class="id">c2</span> <span class="id">prog2</span>' <span class="id">Hfind</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">HH</span> <span class="id">n</span> <span class="id">c2</span> <span class="id">prog2</span>' <span class="id">Hfind</span>) <span class="kwd">as</span> (<span class="id">c1</span>' &amp; <span class="id">prog1</span>' &amp; <span class="id">Hfind</span>' &amp; <span class="id">Hcr</span> &amp; <span class="id">Hfix</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> * <span class="id">H</span>. <span class="id">now</span> <span class="tactic">setoid_rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">program_refines_by_class</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">Pc</span> : <span class="id"><a href="Velus.Obc.Equiv.html#Syn.class">class</a></span> -&gt; <span class="id"><a href="Velus.Obc.Equiv.html#Syn.class">class</a></span> -&gt; <span class="kwd">Prop</span>) <span class="id">P</span> <span class="id">p1</span> <span class="id">p2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Typ.wt_program">wt_program</a></span> <span class="id">p2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">p1</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.types">types</a></span>) = <span class="id">p2</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.types">types</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">p1</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.externs">externs</a></span>) = <span class="id">p2</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.externs">externs</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">c1</span> <span class="id">c2</span> =&gt; <span class="kwd">forall</span> <span class="id">p1</span>' <span class="id">p2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Typ.wt_program">wt_program</a></span> <span class="id">p2</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Typ.wt_class">wt_class</a></span> <span class="id">p2</span>' <span class="id">c2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines">program_refines</a></span> <span class="id">P</span> <span class="id">p1</span>' <span class="id">p2</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">Pc</span> <span class="id">p1</span>'.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.classes">classes</a></span>) <span class="id">p2</span>'.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.classes">classes</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Pc</span> <span class="id">c1</span> <span class="id">c2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c1</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.c_name">c_name</a></span>) = <span class="id">c2</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.c_name">c_name</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.class_refines">class_refines</a></span> <span class="id">p1</span>' <span class="id">p2</span>' (<span class="id">P</span> <span class="id">c1</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.c_name">c_name</a></span>)) <span class="id">c1</span> <span class="id">c2</span>) <span class="id">p1</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.classes">classes</a></span>) <span class="id">p2</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.classes">classes</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">Pc</span> <span class="id">p1</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.classes">classes</a></span>) <span class="id">p2</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.classes">classes</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines">program_refines</a></span> <span class="id">P</span> <span class="id">p1</span> <span class="id">p2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Pc</span> <span class="id">P</span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">WTp</span> <span class="kwd">Types</span> <span class="id">Externs</span> <span class="id">Hfa</span> <span class="id">Hclasses</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines_def">program_refines_def</a></span>; <span class="tactic">split</span>; [|<span class="tactic">split</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.Equiv.html#Syn.find_class">find_class</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hfa</span>) <span class="kwd">as</span> <span class="id">Hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">WTp</span> <span class="id">Hfa</span> <span class="id">Hclasses</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">p1</span>, <span class="id">p2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pattern</span> <span class="id">classes0</span>, <span class="id">classes1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#forall2_right">forall2_right</a></span>; <span class="tactic">auto</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Hlen</span>. <span class="tactic">intros</span> <span class="id">c1</span> <span class="id">c2</span> <span class="id">p1</span>' <span class="id">p2</span>' <span class="id">Hfa</span>' <span class="id">WTp2</span>' <span class="id">Hpr</span>' <span class="id">Hpc</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hpr</span>' <span class="kwd">as</span> [|? ? ? ? <span class="id">Hcr</span>' <span class="id">Hpr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hpc</span>' <span class="kwd">as</span> [|? ? ? ? <span class="id">Hpc</span> <span class="id">Hpcs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">WTp2</span>' <span class="kwd">as</span> [|?? [<span class="id">WTc</span> <span class="id">Hnodup</span>] <span class="id">WTp</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines">program_refines</a></span> <span class="id">P</span> (<span class="kwd">Program</span> <span class="id">types1</span> <span class="id">externs1</span> <span class="id">p1</span>') (<span class="kwd">Program</span> <span class="id">types1</span> <span class="id">externs1</span> <span class="id">p2</span>')) <span class="kwd">as</span> <span class="id">Hpr</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines_def">program_refines_def</a></span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Hfa</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">Hcr</span>' <span class="kwd">as</span> [<span class="id">Hcn</span> <span class="id">Hcr</span>]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="Velus.Obc.Equiv.html#Typ.wt_program">wt_program</a></span>, <span class="id"><a href="Velus.Common.CommonTyping.html#wt_program">CommonTyping.wt_program</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;rewrite&nbsp;program_refines_def.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">n</span> <span class="id">c2</span>' <span class="id">p2</span>'' <span class="id">Hfind2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Velus.Common.CommonProgram.html#find_unit_cons">find_unit_cons</a></span> <span class="kwd">in</span> <span class="id">Hfind2</span> <span class="kwd">as</span> [[<span class="id">E</span> <span class="id">Hfind2</span>]|[<span class="id">E</span> <span class="id">Hfind2</span>]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Velus.Common.CommonProgram.html#find_unit">find_unit</a></span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">Hfind2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Hcn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#ident_eq_dec">ident_eq_dec</a></span> (<span class="id"><a href="Velus.Obc.Equiv.html#Syn.c_name">c_name</a></span> <span class="id">c1</span>) (<span class="id"><a href="Velus.Obc.Equiv.html#Syn.c_name">c_name</a></span> <span class="id">c1</span>)); <span class="tactic">eauto</span>; <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines_def">program_refines_def</a></span> <span class="kwd">in</span> <span class="id">Hpr</span>' <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hpr</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Hpr</span>' <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hfind2</span>) <span class="kwd">as</span> (<span class="id">c1</span>' &amp; <span class="id">p1</span>''' &amp; <span class="id">Hfind1</span> &amp; <span class="id">Hcr1</span> &amp; <span class="id">Hpr1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">c1</span>', <span class="id">p1</span>'''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hcn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#ident_eq_dec">ident_eq_dec</a></span> (<span class="id"><a href="Velus.Obc.Equiv.html#Syn.c_name">c_name</a></span> <span class="id">c2</span>) <span class="id">n</span>); <span class="tactic">try</span> <span class="tactic">congruence</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="EQUIV.stmt_refines_strengthen">stmt_refines_strengthen</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">s1</span> <span class="id">s2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_refines">stmt_refines</a></span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">P</span> <span class="id">s1</span> <span class="id">s2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">env1</span> <span class="id">env2</span>, <span class="id">Q</span> <span class="id">env1</span> <span class="id">env2</span> -&gt; <span class="id">P</span> <span class="id">env1</span> <span class="id">env2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_refines">stmt_refines</a></span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">Q</span> <span class="id">s1</span> <span class="id">s2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">Hr</span> <span class="id">HQP</span> <span class="id">menv</span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">menv</span>' <span class="id">env2</span>' <span class="id">HQ</span> <span class="id">Henv</span> <span class="id">Heval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hr</span> <span class="kwd">in</span> <span class="id">Heval</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="EQUIV.stmt_refines_Proper">stmt_refines_Proper</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#pointwise_relation">pointwise_relation</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#pointwise_relation">pointwise_relation</a></span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#flip">Basics.flip</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html#impl">Basics.impl</a></span>) <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_refines">stmt_refines</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">Hp12</span> <span class="id">p3</span> <span class="id">p4</span> <span class="id">Hp34</span> <span class="id">pre1</span> <span class="id">pre2</span> <span class="id">Hpre</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">Hs12</span> <span class="id">s3</span> <span class="id">s4</span> <span class="id">Hs34</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">p2</span> <span class="id">p4</span> <span class="id">s2</span> <span class="id">s4</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.stmt_refines_strengthen">stmt_refines_strengthen</a></span> <span class="kwd">with</span> (1:=<span class="id">HH</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">Hpre2</span>. <span class="tactic">apply</span> (<span class="id">Hpre</span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">Hpre2</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="EQUIV.program_refines_stmt_call_eval">program_refines_stmt_call_eval</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">P</span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">omenv</span> <span class="id">omenv</span>' <span class="id">clsid</span> <span class="id">f</span> <span class="id">vos</span> <span class="id">vos</span>' <span class="id">rvos</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines">program_refines</a></span> <span class="id">P</span> <span class="id">p1</span> <span class="id">p2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">cls</span> <span class="id">prog</span>' <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Syn.find_class">find_class</a></span> <span class="id">clsid</span> <span class="id">p2</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">cls</span>, <span class="id">prog</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Syn.find_method">find_method</a></span> <span class="id">f</span> <span class="id">cls</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.c_methods">c_methods</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">vos</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">m</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.m_in">m_in</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">vos</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">m</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.m_in">m_in</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id">clsid</span> <span class="id">f</span> <span class="id">m</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.m_in">m_in</a></span>) (<span class="id"><a href="Velus.Environment.html#Env.adds_opt">Env.adds_opt</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">m</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.m_in">m_in</a></span>)) <span class="id">vos</span>' <span class="id"><a href="Velus.Obc.Equiv.html#Sem.vempty">vempty</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Environment.html#Env.adds_opt">Env.adds_opt</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">m</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.m_in">m_in</a></span>)) <span class="id">vos</span> <span class="id"><a href="Velus.Obc.Equiv.html#Sem.vempty">vempty</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Sem.stmt_call_eval">stmt_call_eval</a></span> <span class="id">p2</span> <span class="id">omenv</span> <span class="id">clsid</span> <span class="id">f</span> <span class="id">vos</span> <span class="id">omenv</span>' <span class="id">rvos</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">vo</span> <span class="id">vo</span>' =&gt; <span class="kwd">forall</span> <span class="id">v</span>, <span class="id">vo</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> -&gt; <span class="id">vo</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>) <span class="id">vos</span> <span class="id">vos</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">rvos</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Sem.stmt_call_eval">stmt_call_eval</a></span> <span class="id">p1</span> <span class="id">omenv</span> <span class="id">clsid</span> <span class="id">f</span> <span class="id">vos</span>' <span class="id">omenv</span>' <span class="id">rvos</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">vo</span>' <span class="id">vo</span> =&gt; <span class="kwd">forall</span> <span class="id">v</span>, <span class="id">vo</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> -&gt; <span class="id">vo</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>) <span class="id">rvos</span>' <span class="id">rvos</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hpr</span> <span class="id">HP</span> <span class="id">Hcall</span> <span class="id">Hvos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">Hcall</span> <span class="kwd">as</span> [? ? ? ? ? ? ? ? ? ? ? <span class="id">Hfindc</span> <span class="id">Hfindm</span> <span class="id">Hlvos</span> <span class="id">Heval</span> <span class="id">Hrvos</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines_def">program_refines_def</a></span> <span class="kwd">in</span> <span class="id">Hpr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hfindc2</span>:=<span class="id">Hfindc</span>). <span class="tactic">assert</span> (<span class="id">Hfindm2</span>:=<span class="id">Hfindm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hpr</span> <span class="kwd">in</span> <span class="id">Hfindc</span> <span class="kwd">as</span> (<span class="id">c</span> &amp; <span class="id">p</span> &amp; <span class="id">Hfindc</span> &amp; <span class="id">Hcr</span> &amp; <span class="id">Hpr</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hcr</span> <span class="kwd">in</span> <span class="id">Hfindm</span> <span class="kwd">as</span> (<span class="id">m</span> &amp; <span class="id">Hfindm</span> &amp; (<span class="id">Hm1</span> &amp; <span class="id">Hm2</span> &amp; <span class="id">Hsr</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id"><a href="Velus.Environment.html#Env.adds_opt">Env.adds_opt</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">fm</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.m_in">m_in</a></span>)) <span class="id">vos</span> <span class="id"><a href="Velus.Obc.Equiv.html#Sem.vempty">vempty</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⊑ (<span class="id"><a href="Velus.Environment.html#Env.adds_opt">Env.adds_opt</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">m</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.m_in">m_in</a></span>)) <span class="id">vos</span>' <span class="id"><a href="Velus.Obc.Equiv.html#Sem.vempty">vempty</a></span>)) <span class="kwd">as</span> <span class="id">Henv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> &lt;-<span class="id">Hm1</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Environment.html#Env.refines_adds_opt">Env.refines_adds_opt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_swap_args">Forall2_swap_args</a></span> <span class="kwd">in</span> <span class="id">Hvos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>. <span class="tactic">pose</span> <span class="id">proof</span> <span class="id">m</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.m_nodupvars">m_nodupvars</a></span>) <span class="kwd">as</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>. <span class="id">now</span> <span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_app_l">NoDupMembers_app_l</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.empty_in_iff">Env.Props.P.F.empty_in_iff</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hsr</span> <span class="kwd">in</span> <span class="id">Heval</span> <span class="kwd">as</span> (<span class="id">env1</span>' &amp; <span class="id">Henv1</span>' &amp; <span class="id">Heval</span>'); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">env1</span>') (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">fm</span>.(<span class="id"><a href="Velus.Obc.Equiv.html#Syn.m_out">m_out</a></span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">Hvos</span>. <span class="id">now</span> <span class="tactic">rewrite</span> &lt;-<span class="id">Hvos</span>, <span class="id">Hm1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span>, &lt;-<span class="id">Hm2</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_same">Forall2_same</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span> <span class="kwd">with</span> (2:=<span class="id">Hrvos</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">vo</span> <span class="id">Hxin</span> <span class="id">Hvoin</span> <span class="id">Hfind</span> <span class="id">v</span> <span class="id">Hv</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Henv1</span>' <span class="kwd">in</span> <span class="id">Hv</span> <span class="kwd">as</span> (? &amp; -&gt; &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Hm1</span>. <span class="tactic">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">Hvos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">HP</span>; <span class="tactic">eauto</span>. <span class="id">now</span> <span class="tactic">rewrite</span> &lt;-<span class="id">Hvos</span>, <span class="id">Hlvos</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="EQUIV.wt_exp_program_refines">wt_exp_program_refines</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">P</span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">mems</span> <span class="id">vars</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines">program_refines</a></span> <span class="id">P</span> <span class="id">p1</span> <span class="id">p2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Typ.wt_exp">wt_exp</a></span> <span class="id">p2</span> <span class="id">mems</span> <span class="id">vars</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Typ.wt_exp">wt_exp</a></span> <span class="id">p1</span> <span class="id">mems</span> <span class="id">vars</span> <span class="id">e</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hpr</span> <span class="id">WTe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span>; <span class="id">inv</span> <span class="id">WTe</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.Equiv.html#Typ.wt_exp">wt_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines_def">program_refines_def</a></span> <span class="kwd">in</span> <span class="id">Hpr</span> <span class="kwd">as</span> (<span class="id">E</span> &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">rewrite</span> &lt;-<span class="id">E</span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="EQUIV.wt_stmt_program_refines">wt_stmt_program_refines</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">P</span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">insts</span> <span class="id">mems</span> <span class="id">vars</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines">program_refines</a></span> <span class="id">P</span> <span class="id">p1</span> <span class="id">p2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Typ.wt_stmt">wt_stmt</a></span> <span class="id">p2</span> <span class="id">insts</span> <span class="id">mems</span> <span class="id">vars</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Typ.wt_stmt">wt_stmt</a></span> <span class="id">p1</span> <span class="id">insts</span> <span class="id">mems</span> <span class="id">vars</span> <span class="id">s</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> * <span class="id">Hpr</span> <span class="id">WTs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span> <span class="kwd">using</span> <span class="id">stmt_ind2</span>'; <span class="id">inv</span> <span class="id">WTs</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.Equiv.html#Typ.wt_stmt">wt_stmt</a></span>, <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.wt_exp_program_refines">wt_exp_program_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.wt_exp_program_refines">wt_exp_program_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines_def">program_refines_def</a></span> <span class="kwd">in</span> <span class="id">Hpr</span> <span class="kwd">as</span> (-&gt; &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">pose</span> <span class="id">proof</span> <span class="id">Hpr</span>; <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines_def">program_refines_def</a></span> <span class="kwd">in</span> <span class="id">Hpr</span> <span class="kwd">as</span> (? &amp; <span class="id">Hpr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="Velus.Obc.Equiv.html#Syn.find_class">find_class</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hpr</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">c1</span> &amp; <span class="id">p1</span>' &amp; <span class="id">Hfindc</span> &amp; <span class="id">Hcr</span> &amp; <span class="id">Hpr</span>') <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="Velus.Obc.Equiv.html#Syn.find_method">find_method</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hcr</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">m</span>' &amp; <span class="id">Hfindm</span> &amp; (<span class="id">Hmi</span> &amp; <span class="id">Hmo</span> &amp; <span class="id">Hmr</span>)) <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Hmi</span>, &lt;-<span class="id">Hmo</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="tactic">intros</span> * <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">_</span> <span class="id">es</span>) <span class="id">and</span> <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.wt_exp_program_refines">wt_exp_program_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">econstructor</span>; <span class="id">simpl_Forall</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.wt_exp_program_refines">wt_exp_program_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines_def">program_refines_def</a></span> <span class="kwd">in</span> <span class="id">Hpr</span> <span class="kwd">as</span> (?&amp; -&gt; &amp;?).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="EQUIV.program_refines_types">program_refines_types</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">P</span> <span class="id">p1</span> <span class="id">p2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines">program_refines</a></span> <span class="id">P</span> <span class="id">p1</span> <span class="id">p2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Syn.types">types</a></span> <span class="id">p1</span> = <span class="id"><a href="Velus.Obc.Equiv.html#Syn.types">types</a></span> <span class="id">p2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines_def">program_refines_def</a></span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="EQUIV.program_refines_externs">program_refines_externs</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">P</span> <span class="id">p1</span> <span class="id">p2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines">program_refines</a></span> <span class="id">P</span> <span class="id">p1</span> <span class="id">p2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Obc.Equiv.html#Syn.externs">externs</a></span> <span class="id">p1</span> = <span class="id"><a href="Velus.Obc.Equiv.html#Syn.externs">externs</a></span> <span class="id">p2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV.program_refines_def">program_refines_def</a></span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV">EQUIV</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="EquivFun">EquivFun</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Ids</span>   : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Op</span>    : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Syn</span>   : <span class="id"><a href="Velus.Obc.ObcSyntax.html#OBCSYNTAX">OBCSYNTAX</a></span>     <span class="id"><a href="Velus.Obc.Equiv.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ComTyp</span>: <span class="id"><a href="Velus.Common.CommonTyping.html#COMMONTYPING">COMMONTYPING</a></span>  <span class="id"><a href="Velus.Obc.Equiv.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Sem</span>   : <span class="id"><a href="Velus.Obc.ObcSemantics.html#OBCSEMANTICS">OBCSEMANTICS</a></span>  <span class="id"><a href="Velus.Obc.Equiv.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Typ</span>   : <span class="id"><a href="Velus.Obc.ObcTyping.html#OBCTYPING">OBCTYPING</a></span>     <span class="id"><a href="Velus.Obc.Equiv.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Syn">Syn</a></span>  <span class="id"><a href="Velus.Obc.Equiv.html#ComTyp">ComTyp</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Sem">Sem</a></span>)<br/>
&nbsp;&nbsp;&lt;: <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV">EQUIV</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#ComTyp">ComTyp</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Sem">Sem</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Typ">Typ</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Include</span> <span class="id"><a href="Velus.Obc.Equiv.html#EQUIV">EQUIV</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Op">Op</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#ComTyp">ComTyp</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Sem">Sem</a></span> <span class="id"><a href="Velus.Obc.Equiv.html#Typ">Typ</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Obc.Equiv.html#EquivFun">EquivFun</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
