
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module ResetLs</title>
<meta name="description" content="Documentation of Coq module ResetLs" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module ResetLs</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.html">Cpo</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html">SDfuns</a></span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html">CommonDS</a></span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">bool_scope</span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#ListNotations">ListNotations</a></span>.<br/>
<br/>
<div class="doc">An attempt to prove the equivalence between the reset construct
    of Lucid Synchrone and the one of Denot.SDfuns. </div>
<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> {<span class="id">I</span> <span class="id">Di</span>}.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> {<span class="id">D1</span> <span class="id">D2</span>}.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> {<span class="id">D1</span> <span class="id">D2</span>}.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span> {<span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span>}.<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Hint</span> <span class="id">Rewrite</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#curry_Curry">curry_Curry</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Curry_simpl">Curry_simpl</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2_simpl">fcont_comp2_simpl</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp3_simpl">fcont_comp3_simpl</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST_simpl">FST_simpl</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fst_simpl">Fst_simpl</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND_simpl">SND_simpl</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Snd_simpl">Snd_simpl</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP_simpl">AP_simpl</a></span><br/>
&nbsp;&nbsp;: <span class="id">localdb</span>.<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="DSForall_pres">DSForall_pres</a></span> {<span class="id">A</span>} (<span class="id">P</span> : <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>) -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall">DSForall</a></span> (<span class="kwd">fun</span> <span class="id">s</span> =&gt; <span class="kwd">match</span> <span class="id">s</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id">P</span> <span class="id">v</span> | <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="kwd">end</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="safe_DS">safe_DS</a></span> {<span class="id">A</span>} : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>) -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall">DSForall</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span> | <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="kwd">end</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="when">when</a></span> :  <span class="kwd">forall</span> {<span class="id">A</span>}, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="kwd">fun</span> <span class="id">c</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">c</span>, <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="when_eq">when_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">x</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">A</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">cs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>) ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">c</span>, <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">cs</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">cs</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">cs</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">cs</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span> <span class="kwd">as</span> [|[]|], <span class="id">x</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_when">take_when</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">n</span> <span class="id">cs</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> (@<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">A</span> <span class="id">cs</span> <span class="id">xs</span>) == <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">cs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_zip">take_zip</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_when">rem_when</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">cs</span> (<span class="id">xs</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">cs</span> <span class="id">xs</span>) == <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">cs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_zip">rem_zip</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nrem_when">nrem_when</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">n</span> <span class="id">cs</span> (<span class="id">xs</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">cs</span> <span class="id">xs</span>) == <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> <span class="id">cs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_zip">nrem_zip</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="when_true">when_true</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">cs</span> (<span class="id">xs</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">cs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#DSForall_pres">DSForall_pres</a></span> (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">b</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">cs</span> <span class="id">xs</span> == <span class="id">xs</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Sc</span> <span class="id">Sx</span> <span class="id">Hac</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">cs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">cs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">V</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">cs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">V</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#DSForall_pres">DSForall_pres</a></span> (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">b</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">cs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">cs</span> <span class="id">V</span>).<br/>
&nbsp;&nbsp;3:<span class="id">eauto</span> 8.<br/>
&nbsp;&nbsp;<span class="id">clear</span>; <span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>; <span class="id">now</span> (<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>; <span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>).<br/>
&nbsp;&nbsp;<span class="id">clear</span>; <span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">cs</span> &amp; <span class="id">Hac</span> &amp; <span class="id">Sc</span> &amp; <span class="id">Sv</span> &amp; <span class="id">Hf</span> &amp; <span class="id">Hu</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">cs</span>) <span class="kwd">as</span> (<span class="id">c</span> &amp; <span class="id">cs</span>' &amp; <span class="id">Hcs</span>).<br/>
&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="kwd">in</span> *; <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>; <span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>; <span class="id">rewrite</span> <span class="id">Hac</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">V</span>) <span class="kwd">as</span> (<span class="id">v</span> &amp; <span class="id">V</span>' &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;{ <span class="id">now</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>; <span class="id">rewrite</span> &lt;- <span class="id">Hac</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>; <span class="id">rewrite</span> <span class="id">Hcs</span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hv</span>, <span class="id">Hcs</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when_eq">when_eq</a></span>, <span class="id">Hu</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sc</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sv</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hac</span> <span class="kwd">as</span> []; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">c</span> <span class="kwd">as</span> [|[]|], <span class="id">v</span>; <span class="id">try</span> (<span class="id">tauto</span> || <span class="id">congruence</span>); <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">exists</span> <span class="id">cs</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hv</span>, <span class="id">Hu</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span> <span class="kwd">as</span> [|[]|], <span class="id">v</span>; <span class="id">try</span> (<span class="id">tauto</span> || <span class="id">congruence</span>); <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="when_false">when_false</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">cs</span> (<span class="id">xs</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">cs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#DSForall_pres">DSForall_pres</a></span> (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">b</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">cs</span> <span class="id">xs</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) <span class="id">cs</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Sc</span> <span class="id">Sx</span> <span class="id">Hac</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">cs</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">cs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">cs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#DSForall_pres">DSForall_pres</a></span> (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">b</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">cs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">cs</span> <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) <span class="id">cs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;3:<span class="id">eauto</span> 8.<br/>
&nbsp;&nbsp;<span class="id">clear</span>; <span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>; <span class="id">now</span> (<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>; <span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>).<br/>
&nbsp;&nbsp;<span class="id">clear</span>; <span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">cs</span> &amp; <span class="id">xs</span> &amp; <span class="id">Hac</span> &amp; <span class="id">Sc</span> &amp; <span class="id">Sx</span> &amp; <span class="id">Hf</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">cs</span>) <span class="kwd">as</span> (<span class="id">c</span> &amp; <span class="id">cs</span>' &amp; <span class="id">Hcs</span>).<br/>
&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="kwd">in</span> *; <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>; <span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>; <span class="id">rewrite</span> &lt;- <span class="id">Hv</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">xs</span>) <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hxs</span>).<br/>
&nbsp;&nbsp;{ <span class="id">now</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>; <span class="id">rewrite</span> &lt;- <span class="id">Hac</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>; <span class="id">rewrite</span> <span class="id">Hcs</span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id">Hxs</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when_eq">when_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sc</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sx</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hac</span> <span class="kwd">as</span> []; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span> <span class="kwd">as</span> [|[]|], <span class="id">x</span>; <span class="id">try</span> (<span class="id">tauto</span> || <span class="id">congruence</span>); <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">exists</span> <span class="id">cs</span>', <span class="id">xs</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span> <span class="kwd">as</span> [|[]|], <span class="id">x</span>; <span class="id">try</span> (<span class="id">tauto</span> || <span class="id">congruence</span>); <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span> 7.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="safe_when">safe_when</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">cs</span> (<span class="id">xs</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">cs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">cs</span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Sc</span> <span class="id">Sx</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_ds</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">cs</span> <span class="id">xs</span>) <span class="kwd">as</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>; <span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;{ <span class="id">constructor</span>; <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#eqEps">eqEps</a></span> <span class="kwd">in</span> <span class="id">Ht</span>; <span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#cons_is_cons">cons_is_cons</a></span> <span class="kwd">in</span> <span class="id">Ht</span> <span class="kwd">as</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span> <span class="kwd">in</span> <span class="id">HH</span> <span class="kwd">as</span> [<span class="id">Cc</span> <span class="id">Cx</span>].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Cc</span> <span class="kwd">as</span> (<span class="id">c</span> &amp; <span class="id">cs</span>' &amp; <span class="id">Hc</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Cx</span> <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">cx</span>' &amp; <span class="id">Hx</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hc</span>, <span class="id">Hx</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when_eq">when_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sc</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sx</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span> <span class="kwd">as</span> [|[]|], <span class="id">x</span>; <span class="id">try</span> (<span class="id">congruence</span> || <span class="id">tauto</span>).<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Ht</span> <span class="kwd">as</span> [], <span class="id">Hac</span> <span class="kwd">as</span> []; <span class="id">subst</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">constructor</span>; <span class="id">auto</span>; <span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="whennot">whennot</a></span> :  <span class="kwd">forall</span> {<span class="id">A</span>}, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="kwd">fun</span> <span class="id">c</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">c</span>, <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="whennot_eq">whennot_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">x</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> <span class="id">A</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">cs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>) ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">c</span>, <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> <span class="id">cs</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> <span class="id">cs</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> <span class="id">cs</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> <span class="id">cs</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span> <span class="kwd">as</span> [|[]|], <span class="id">x</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="whennot_false">whennot_false</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">cs</span> (<span class="id">xs</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">cs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#DSForall_pres">DSForall_pres</a></span> (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">b</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> <span class="id">cs</span> <span class="id">xs</span> == <span class="id">xs</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Sc</span> <span class="id">Sx</span> <span class="id">Hac</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">cs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">cs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">V</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">cs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">V</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#DSForall_pres">DSForall_pres</a></span> (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">b</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">cs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> <span class="id">cs</span> <span class="id">V</span>).<br/>
&nbsp;&nbsp;3:<span class="id">eauto</span> 8.<br/>
&nbsp;&nbsp;<span class="id">clear</span>; <span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>; <span class="id">now</span> (<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>; <span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>).<br/>
&nbsp;&nbsp;<span class="id">clear</span>; <span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">cs</span> &amp; <span class="id">Hac</span> &amp; <span class="id">Sc</span> &amp; <span class="id">Sv</span> &amp; <span class="id">Hf</span> &amp; <span class="id">Hu</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">cs</span>) <span class="kwd">as</span> (<span class="id">c</span> &amp; <span class="id">cs</span>' &amp; <span class="id">Hcs</span>).<br/>
&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> <span class="kwd">in</span> *; <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>; <span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>; <span class="id">rewrite</span> <span class="id">Hac</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">V</span>) <span class="kwd">as</span> (<span class="id">v</span> &amp; <span class="id">V</span>' &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;{ <span class="id">now</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>; <span class="id">rewrite</span> &lt;- <span class="id">Hac</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>; <span class="id">rewrite</span> <span class="id">Hcs</span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hv</span>, <span class="id">Hcs</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot_eq">whennot_eq</a></span>, <span class="id">Hu</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sc</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sv</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hac</span> <span class="kwd">as</span> []; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">c</span> <span class="kwd">as</span> [|[]|], <span class="id">v</span>; <span class="id">try</span> (<span class="id">tauto</span> || <span class="id">congruence</span>); <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">exists</span> <span class="id">cs</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hv</span>, <span class="id">Hu</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span> <span class="kwd">as</span> [|[]|], <span class="id">v</span>; <span class="id">try</span> (<span class="id">tauto</span> || <span class="id">congruence</span>); <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<br/>
<div class="doc">Arrow operator initialized by a constant </div>
<span class="kwd">Definition</span> <span class="id"><a name="arrow">arrow</a></span> {<span class="id">A</span>} (<span class="id">a</span> : <span class="id">A</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>).<br/>
&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>; <span class="id">intros</span> [| <span class="id">v</span> | <span class="id">e</span>].<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#uncurry">uncurry</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> <span class="id">_</span> <span class="id">_</span>))).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#CTE">CTE</a></span>, (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#CTE">CTE</a></span>, (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span>)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="arrow_eq">arrow_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">a</span> : <span class="id">A</span>) <span class="id">x</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#arrow">arrow</a></span> <span class="id">a</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>) ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#arrow">arrow</a></span> <span class="id">a</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">a</span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#arrow">arrow</a></span> <span class="kwd">at</span> 1; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="arrow_bot">arrow_bot</a></span> : <span class="kwd">forall</span> <span class="id">A</span> (<span class="id">a</span>:<span class="id">A</span>), <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#arrow">arrow</a></span> <span class="id">a</span> 0 == 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#arrow">arrow</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DScase_bot_eq">DScase_bot_eq</a></span>.<br/>
Qed.</div>
<br/>
<br/>
<div class="doc">A special <span class="bracket"><span class="id">merge</span></span> operator that produces an <span class="bracket"><span class="id">abs</span></span> as soon as an <span class="bracket"><span class="id">abs</span></span>
    is read on the condition stream. Trying to read on both arguments when
    expecting absences could lead to causality issues in the recursive
    definition of reset. </div>
<span class="kwd">Section</span> <span class="id"><a name="MERGE">MERGE</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="expecta">expecta</a></span> : <span class="kwd">forall</span> {<span class="id">A</span>}, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="expecta_eq">expecta_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">c</span> <span class="id">cs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span> <span class="id">A</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">cs</span>) ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">c</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id">cs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>) <span class="id">cs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">c</span>) <span class="id">cs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span>; <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="expecta_bot">expecta_bot</a></span> : <span class="kwd">forall</span> <span class="id">A</span>, @<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span> <span class="id">A</span> 0 == 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_bot">DScase_bot</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="merge">merge</a></span> {<span class="id">A</span>} : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>).<br/>
&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id">_</span> <span class="id">_</span> @2<span class="id">_</span> <span class="id">_</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span>)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>; <span class="id">intro</span> <span class="id">c</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- <span class="id">_</span> (<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">f</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> @<span class="id">_</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">pose</span> (<span class="id">X</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> @<span class="id">_</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">pose</span> (<span class="id">Y</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> @<span class="id">_</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">pose</span> (<span class="id">C</span>' := @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span> <span class="kwd">as</span> [|[]| <span class="id">e</span>].<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> @<span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id">f</span> @4<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> <span class="id">_</span>) <span class="id">C</span>' (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span> @<span class="id">_</span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span> @<span class="id">_</span> <span class="id">Y</span>)).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP">APP</a></span> <span class="id">_</span> @2<span class="id">_</span> <span class="id">X</span>) <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id">f</span> @4<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> <span class="id">_</span>) <span class="id">C</span>' (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> <span class="id">_</span> @<span class="id">_</span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span> @<span class="id">_</span> <span class="id">Y</span>)).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP">APP</a></span> <span class="id">_</span> @2<span class="id">_</span> <span class="id">Y</span>) <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id">f</span> @4<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> <span class="id">_</span>) <span class="id">C</span>' (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span> @<span class="id">_</span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> <span class="id">_</span> @<span class="id">_</span> <span class="id">Y</span>)).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span>) @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span>) @<span class="id">_</span> <span class="id">C</span>')).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="merge_eq">merge_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge">merge</a></span> <span class="id">A</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">cs</span>) <span class="id">xs</span> <span class="id">ys</span> ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">c</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge">merge</a></span> <span class="id">cs</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span> <span class="id">ys</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge">merge</a></span> <span class="id">cs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span> <span class="id">ys</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">ys</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge">merge</a></span> <span class="id">cs</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">ys</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">cs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge">merge</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 3 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#curry_Curry">curry_Curry</a></span>, 3 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Curry_simpl">Curry_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2_simpl">fcont_comp2_simpl</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span> <span class="kwd">as</span> [|[]|].<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons_eq_compat">cons_eq_compat</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_eq_compat">app_eq_compat</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_eq_compat">app_eq_compat</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Opaque</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge">merge</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="expecta_inf">expecta_inf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">xs</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Infx</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Infx</span> <span class="kwd">as</span> (<span class="id">vx</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hxs</span> &amp;<span class="id">Infx</span>').<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hxs</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_eq">expecta_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">vx</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_inf">map_inf</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="merge_false">merge_false</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">cs</span> (<span class="id">xs</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#DSForall_pres">DSForall_pres</a></span> (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">b</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">cs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge">merge</a></span> <span class="id">cs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) <span class="id">cs</span>) <span class="id">xs</span> == <span class="id">xs</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Sc</span> <span class="id">Sx</span> <span class="id">Infc</span> <span class="id">Infx</span> <span class="id">Hf</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;<span class="id">coind_Oeq</span> <span class="id">Cof</span>; <span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">intros</span> <span class="id">Hcons</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Infc</span> <span class="kwd">as</span> (<span class="id">vc</span> &amp; <span class="id">cs</span>' &amp; <span class="id">Hcs</span> &amp;<span class="id">Infc</span>').<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Infx</span> <span class="kwd">as</span> (<span class="id">vx</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hxs</span> &amp;<span class="id">Infx</span>').<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HV</span> <span class="kwd">in</span> <span class="id">Hxs</span>, <span class="id">Hac</span>, <span class="id">Sx</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id">Hxs</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hac</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sc</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sx</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge_eq">merge_eq</a></span> <span class="kwd">in</span> <span class="id">HU</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">vc</span> <span class="kwd">as</span> [|[]|], <span class="id">vx</span> <span class="kwd">as</span> [| |]; <span class="id">subst</span>; <span class="id">try</span> (<span class="id">congruence</span> || <span class="id">tauto</span>).<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;abs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_eq">expecta_eq</a></span> <span class="kwd">in</span> <span class="id">HU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. <span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> (<span class="id">Cof</span> <span class="id">_</span> <span class="id">cs</span>' <span class="id">xs</span>'); <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_inf">expecta_inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id">HV</span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_eq">expecta_eq</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;pres&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_eq">expecta_eq</a></span> <span class="kwd">in</span> <span class="id">HU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. <span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_app_first">first_app_first</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">Cof</span> <span class="id">_</span> <span class="id">cs</span>' <span class="id">xs</span>'); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id">HV</span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="merge_false_merge">merge_false_merge</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">cs</span> <span class="id">cs2</span> (<span class="id">xs</span> <span class="id">ys</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id">A</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">cs2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#DSForall_pres">DSForall_pres</a></span> (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">b</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">cs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">cs2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge">merge</a></span> <span class="id">cs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) <span class="id">cs</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge">merge</a></span> <span class="id">cs2</span> <span class="id">xs</span> <span class="id">ys</span>) == <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge">merge</a></span> <span class="id">cs2</span> <span class="id">xs</span> <span class="id">ys</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
  <span class="id">intros</span> * <span class="id">Sc</span> <span class="id">Sc2</span> <span class="id">Infc</span> <span class="id">Infx</span> <span class="id">Hf</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;<span class="id">coind_Oeq</span> <span class="id">Cof</span>; <span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">intros</span> <span class="id">Hcons</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Infc</span> <span class="kwd">as</span> (<span class="id">vc</span> &amp; <span class="id">cs</span>' &amp; <span class="id">Hcs</span> &amp;<span class="id">Infc</span>').<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">cs2</span>) <span class="kwd">as</span> (<span class="id">vc2</span> &amp; <span class="id">cs2</span>' &amp; <span class="id">Hcs2</span>).<br/>
&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>; <span class="id">rewrite</span> &lt;- <span class="id">Hac</span>, <span class="id">Hcs</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id">Hcs2</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hac</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sc</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sc2</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge_eq">merge_eq</a></span> <span class="kwd">in</span> <span class="id">HU</span>, <span class="id">HV</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">vc</span> <span class="kwd">as</span> [|[]|], <span class="id">vc2</span> <span class="kwd">as</span> [| [] |]; <span class="id">subst</span>; <span class="id">try</span> (<span class="id">congruence</span> || <span class="id">tauto</span>).<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;abs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_eq">expecta_eq</a></span> <span class="kwd">in</span> <span class="id">HU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. <span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> (<span class="id">Cof</span> <span class="id">_</span> <span class="id">cs</span>' <span class="id">cs2</span>' (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span> <span class="id">ys</span>)); <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_inf">expecta_inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HV</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_eq">expecta_eq</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;vc2=true&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_eq">expecta_eq</a></span> <span class="kwd">in</span> <span class="id">HU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. <span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_app_first">first_app_first</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Infx</span> <span class="kwd">as</span> (<span class="id">vx</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hxs</span> &amp;<span class="id">Infx</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hxs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">Cof</span> <span class="id">_</span> <span class="id">cs</span>' <span class="id">cs2</span>' <span class="id">xs</span>' (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span> <span class="id">ys</span>)); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HV</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;vc2=false&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HV</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_app">app_app</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_eq">expecta_eq</a></span> <span class="kwd">in</span> <span class="id">HU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">ys</span>) <span class="kwd">as</span> (<span class="id">vy</span> &amp; <span class="id">ys</span>' &amp; <span class="id">Hys</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span> <span class="kwd">in</span> <span class="id">Hcons</span>; <span class="id">destruct</span> <span class="id">Hcons</span> <span class="kwd">as</span> [<span class="id">Hc</span>|<span class="id">Hc</span>]; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>, <span class="id">Hc</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hys</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span> <span class="kwd">in</span> <span class="id">HU</span>, <span class="id">HV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. <span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">Cof</span> <span class="id">_</span> <span class="id">cs</span>' <span class="id">cs2</span>' (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span> <span class="id">xs</span>) <span class="id">ys</span>'); <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_inf">expecta_inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HV</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, 3 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#MERGE">MERGE</a></span>.<br/>
<br/>
<div class="doc">Definition and characterisations of true_until </div>
<span class="kwd">Section</span> <span class="id"><a name="TRUE_UNTIL">TRUE_UNTIL</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="true_until">true_until</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>).<br/>
&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#arrow">arrow</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> @<span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop">sbinop</a></span> (<span class="kwd">fun</span> <span class="id">b1</span> <span class="id">b2</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> <span class="id">b1</span> &amp;&amp; <span class="id">b2</span>)) @2<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span>) <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby">fby</a></span> @2<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst">sconst</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span>) <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> <span class="id">_</span> <span class="id">_</span> @2<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span>) <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span>).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="true_until_eq">true_until_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> <span class="id">r</span> ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#arrow">arrow</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop">sbinop</a></span> (<span class="kwd">fun</span> <span class="id">b1</span> <span class="id">b2</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> <span class="id">b1</span> &amp;&amp; <span class="id">b2</span>)) <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby">fby</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst">sconst</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">r</span>)) (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> <span class="id">r</span>))).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="true_until_abs">true_until_abs</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> <span class="id">r</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> <span class="id">r</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_eq">true_until_eq</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst_cons">sconst_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby_eq">fby_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#arrow_eq">arrow_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons_eq_compat">cons_eq_compat</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#FIXP_fixp">FIXP_fixp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp_ind">fixp_ind</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span> <span class="id">h</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">setoid_rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_simpl">fmon_comp_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_comp_eq">lub_comp_eq</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_eq_compat">lub_eq_compat</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop">sbinop</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbyA_bot">fbyA_bot</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_bot2">zip_bot2</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#arrow_bot">arrow_bot</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span> <span class="id">ftrue_until</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> ?<span class="id">a</span> ?<span class="id">b</span>) <span class="kwd">with</span> (<span class="id">a</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">localdb</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst_cons">sconst_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby_eq">fby_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#arrow_eq">arrow_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbyA_eq">fbyA_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="true_until_pres1">true_until_pres1</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">r</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">U</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">b</span>) <span class="id">r</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">U</span> == (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop">sbinop</a></span> (<span class="kwd">fun</span> <span class="id">b1</span> <span class="id">b2</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> <span class="id">b1</span> &amp;&amp; <span class="id">b2</span>)) <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1">fby1</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst">sconst</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">r</span>)) <span class="id">U</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id">eexists</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_eq">true_until_eq</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst_cons">sconst_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby_eq">fby_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#arrow_eq">arrow_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_eq">true_until_eq</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst_cons">sconst_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby_eq">fby_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#arrow_eq">arrow_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP_eq">fby1AP_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cs_spec1">cs_spec1</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cs</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop">sbinop</a></span> (<span class="kwd">fun</span> <span class="id">b1</span> <span class="id">b2</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> <span class="id">b1</span> &amp;&amp; <span class="id">b2</span>)) <span class="id">rs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1">fby1</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst">sconst</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">rs</span>)) <span class="id">cs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cs</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">v</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) <span class="id">rs</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Infr</span> <span class="id">Sr</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_Oeq">take_Oeq</a></span>; <span class="id">intro</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">dependent</span> <span class="id">cs</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">dependent</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Infr</span> <span class="kwd">as</span> (<span class="id">vr</span> &amp; <span class="id">rs</span>' &amp; <span class="id">Hrs</span> &amp; <span class="id">Infr</span>').<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst_cons">sconst_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1_eq">fby1_eq</a></span> <span class="kwd">in</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">vr</span>; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;abs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_cons">take_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons_eq_compat">cons_eq_compat</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHn</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP_eq">fby1AP_eq</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;pres&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_cons">take_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">a</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons_eq_compat">cons_eq_compat</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">apply</span> <span class="id">IHn</span>; <span class="id">auto</span>; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP_eq">fby1AP_eq</a></span> <span class="kwd">at</span> 1.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cs_spec">cs_spec</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">cs</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop">sbinop</a></span> (<span class="kwd">fun</span> <span class="id">b1</span> <span class="id">b2</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> <span class="id">b1</span> &amp;&amp; <span class="id">b2</span>)) <span class="id">rs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1">fby1</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst">sconst</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">rs</span>)) <span class="id">cs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">m</span>, (<span class="id">m</span> &lt;= <span class="id">n</span>)%<span class="id">nat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">m</span> <span class="id">cs</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> <span class="kwd">end</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">m</span> <span class="id">rs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> (<span class="id">n</span> - <span class="id">m</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">m</span> <span class="id">cs</span>) ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> <span class="kwd">end</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> (<span class="id">n</span> - <span class="id">m</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">m</span> <span class="id">rs</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span> * <span class="id">Infr</span> <span class="id">Sr</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;{ <span class="kwd">exists</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>; <span class="id">rewrite</span> 3 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_bot">map_bot</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Infr</span> <span class="kwd">as</span> (<span class="id">vr</span> &amp; <span class="id">rs</span>' &amp; <span class="id">Hrs</span> &amp;<span class="id">Infr</span>').<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst_cons">sconst_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1_eq">fby1_eq</a></span> <span class="kwd">in</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">vr</span> <span class="kwd">as</span> [|<span class="id">r</span>|]; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;abs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span> <span class="kwd">in</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHn</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">cs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">rs</span>)) <span class="kwd">as</span> (<span class="id">m</span> &amp; <span class="id">Hle</span> &amp; <span class="id">Ht1</span> &amp; <span class="id">Ht2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id">Hrs</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP_eq">fby1AP_eq</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>); <span class="id">split</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> - <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="kwd">with</span> (<span class="id">n</span> - <span class="id">m</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_cons">take_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_S">nrem_S</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_S">nrem_S</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_cons">take_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;pres&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span> <span class="kwd">in</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">r</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>; <span class="id">split</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.sub_0_r">Nat.sub_0_r</a></span>, 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_bot">map_bot</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">simpl</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">_</span> <span class="id">_</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#cs_spec1">cs_spec1</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">cs</span>) <span class="id">rs</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_morph_Proper">take_morph_Proper</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id">n</span>) <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_cons">take_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_map">take_map</a></span>, &lt;- <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_cons">take_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hcs</span> <span class="kwd">at</span> 1 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP_eq">fby1AP_eq</a></span> <span class="kwd">at</span> 1. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;comme&nbsp;dans&nbsp;abs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHn</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">cs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">rs</span>)) <span class="kwd">as</span> (<span class="id">m</span> &amp; <span class="id">Hle</span> &amp; <span class="id">Ht1</span> &amp; <span class="id">Ht2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id">Hrs</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP_eq">fby1AP_eq</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>); <span class="id">split</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> - <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="kwd">with</span> (<span class="id">n</span> - <span class="id">m</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_cons">take_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_S">nrem_S</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_S">nrem_S</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_cons">take_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">combining previous lemmas, we get the characterisations of <span class="bracket"><span class="id">true_until</span></span> </div>
<span class="kwd">Lemma</span> <span class="id"><a name="take_true_until_spec">take_true_until_spec</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> &lt;= <span class="id">n</span>)%<span class="id">nat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">m</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> <span class="id">rs</span>) ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> <span class="kwd">end</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">m</span> <span class="id">rs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> (<span class="id">n</span> - <span class="id">m</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">m</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> <span class="id">rs</span>)) ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> <span class="kwd">end</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> (<span class="id">n</span> - <span class="id">m</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">m</span> <span class="id">rs</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span> * <span class="id">Infr</span> <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>; <span class="id">rewrite</span> 4 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_bot">map_bot</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Infr</span> <span class="kwd">as</span> (<span class="id">vr</span> &amp; <span class="id">rs</span>' &amp; <span class="id">Hrs</span> &amp;<span class="id">Infr</span>').<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">vr</span> <span class="kwd">as</span> [|<span class="id">vr</span>|]; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;abs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHn</span> <span class="id">rs</span>') <span class="kwd">as</span> (<span class="id">m</span> &amp; <span class="id">Hlt</span> &amp; <span class="id">Ht1</span> &amp; <span class="id">Ht2</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_abs">true_until_abs</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_S">nrem_S</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_cons">take_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> - <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="kwd">with</span> (<span class="id">n</span> - <span class="id">m</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;pres&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_pres1">true_until_pres1</a></span> <span class="id">vr</span> <span class="id">rs</span>') <span class="kwd">as</span> (<span class="id">cs</span> &amp; <span class="id">Htu</span> &amp; <span class="id">Hc</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#cs_spec">cs_spec</a></span> <span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> (<span class="id">m</span> &amp; <span class="id">Hlt</span> &amp; <span class="id">Ht1</span> &amp; <span class="id">Ht2</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id">Htu</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_S">nrem_S</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_cons">take_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> - <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="kwd">with</span> (<span class="id">n</span> - <span class="id">m</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Other properties of true_until </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="true_until_is_cons">true_until_is_cons</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> <span class="id">rs</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">rs</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;<span class="id">intro</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_eq">true_until_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#arrow">arrow</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_is_cons">DScase_is_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_is_cons">sbinop_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="AC_true_until">AC_true_until</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">rs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> <span class="id">rs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">coind_Oeq</span> <span class="id">Cof</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">rs</span>) <span class="kwd">as</span> (<span class="id">vr</span> &amp; <span class="id">rs</span>' &amp; <span class="id">Hrs</span>).<br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span> <span class="kwd">in</span> <span class="id">Hc</span>; <span class="id">destruct</span> <span class="id">Hc</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_is_cons">true_until_is_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">vr</span> <span class="kwd">as</span> [|<span class="id">vr</span>|]; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;abs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_abs">true_until_abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">Cof</span> (<span class="id">rs</span>')); <span class="id">rewrite</span> ?<span class="id">HU</span>, ?<span class="id">HV</span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Cof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;revient&nbsp;&nbsp;l'induction&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">enough</span> (<span class="id">HH</span> : <span class="id">U</span> == <span class="id">V</span>). { <span class="id">rewrite</span> <span class="id">HH</span> <span class="kwd">at</span> 1; <span class="id">split</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Oeq_ds_eq">Oeq_ds_eq</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HU</span>,<span class="id">HV</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_pres1">true_until_pres1</a></span> <span class="id">vr</span> <span class="id">rs</span>') <span class="kwd">as</span> (<span class="id">cs</span> &amp; <span class="id">Htu</span> &amp; <span class="id">Hcs</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Htu</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons_eq_compat">cons_eq_compat</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">H</span> <span class="id">Htu</span> <span class="id">HU</span> <span class="id">HV</span> <span class="id">Hrs</span>; <span class="id">clear</span> <span class="id">U</span> <span class="id">V</span> <span class="id">vr</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;<span class="id">rename</span> <span class="id">rs</span>' <span class="id">into</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hcs</span>; <span class="id">generalize</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="kwd">at</span> 1; <span class="id">intros</span> <span class="id">b</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;<span class="id">coind_Oeq</span> <span class="id">Cof</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">rs</span>) <span class="kwd">as</span> (<span class="id">vr</span> &amp; <span class="id">rs</span>' &amp; <span class="id">Hrs</span>).<br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span> <span class="kwd">in</span> <span class="id">Hc</span>; <span class="id">destruct</span> <span class="id">Hc</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">rewrite</span> <span class="id">Hcs</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_is_cons">sbinop_is_cons</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">tauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HU</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst_cons">sconst_cons</a></span> <span class="kwd">in</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">vr</span> <span class="kwd">as</span> [|<span class="id">vr</span>|]; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;abs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1_eq">fby1_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span> <span class="kwd">in</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, <span class="id">Hcs</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> (<span class="id">Cof</span> <span class="id">rs</span>') <span class="kwd">with</span> (<span class="id">cs</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">cs</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> ?<span class="id">HU</span>, ?<span class="id">HV</span>, ?<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#rem_AC">rem_AC</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP_eq">fby1AP_eq</a></span>. }<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;pres&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1_eq">fby1_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span> <span class="kwd">in</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, <span class="id">Hcs</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> (<span class="id">Cof</span> <span class="id">rs</span>') <span class="kwd">with</span> (<span class="id">cs</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">cs</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> ?<span class="id">HU</span>, ?<span class="id">HV</span>, ?<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#rem_AC">rem_AC</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP_eq">fby1AP_eq</a></span>. }<br/>
Qed.</div>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="true_until_inf">true_until_inf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> <span class="id">rs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Sr</span> <span class="id">Infr</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">Hac</span> := <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#AC_true_until">AC_true_until</a></span> <span class="id">rs</span> <span class="id">Sr</span>).<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span> <span class="kwd">in</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#inf_map">inf_map</a></span>; <span class="id">rewrite</span> &lt;- <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_inf">map_inf</a></span>, <span class="id">Infr</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="safe_true_until">safe_true_until</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> <span class="id">rs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">remember_ds</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> <span class="id">rs</span>) <span class="kwd">as</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>; <span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#eqEps">eqEps</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">rs</span>) <span class="kwd">as</span> (<span class="id">vr</span> &amp; <span class="id">rs</span>' &amp; <span class="id">Hrs</span>).<br/>
&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_is_cons">true_until_is_cons</a></span>; <span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Ht</span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sr</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">vr</span> <span class="kwd">as</span> [|<span class="id">vr</span>|]; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;abs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_abs">true_until_abs</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Ht</span> <span class="kwd">as</span> []; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>; <span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;pres&nbsp;:&nbsp;on&nbsp;recommence&nbsp;une&nbsp;induction&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Cof</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_pres1">true_until_pres1</a></span> <span class="id">vr</span> <span class="id">rs</span>') <span class="kwd">as</span> (<span class="id">cs</span> &amp; <span class="id">Htu</span> &amp; <span class="id">Hcs</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Ht</span>, <span class="id">Htu</span>; <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">H0</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;<span class="id">rename</span> <span class="id">rs</span>' <span class="id">into</span> <span class="id">rs</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hcs</span>; <span class="id">generalize</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="kwd">at</span> 1; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">revert_all</span>; <span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">cs</span>.<br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#eqEps">eqEps</a></span> <span class="kwd">in</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">eapply</span> <span class="id">Cof</span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">rs</span>) <span class="kwd">as</span> (<span class="id">vr</span> &amp; <span class="id">rs</span>' &amp; <span class="id">Hrs</span>).<br/>
&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_is_cons">sbinop_is_cons</a></span>; <span class="id">rewrite</span> &lt;- <span class="id">Hcs</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst_cons">sconst_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">vr</span>; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;abs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1_eq">fby1_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span> <span class="kwd">in</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hcs</span> <span class="kwd">as</span> [? <span class="id">Hcs</span>]; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> (<span class="id">Cof</span> <span class="id">rs</span>'); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP_eq">fby1AP_eq</a></span>. }<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;pres&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1_eq">fby1_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span> <span class="kwd">in</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hcs</span> <span class="kwd">as</span> [? <span class="id">Hcs</span>]; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> (<span class="id">Cof</span> <span class="id">rs</span>'); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP_eq">fby1AP_eq</a></span>. }<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#TRUE_UNTIL">TRUE_UNTIL</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="RESET">RESET</a></span>.<br/>
<div class="doc">Definition of the recursive reset operator, using true_until </div>
<br/>
<span class="kwd">Context</span> {<span class="id">A</span> : <span class="kwd">Type</span>}.<br/>
<span class="kwd">Variable</span> (<span class="id"><a name="RESET.f">f</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET.A">A</a></span>)).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="reset">reset</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET.A">A</a></span>).<br/>
&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- <span class="id">_</span> (<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">freset</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> @<span class="id">_</span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">pose</span> (<span class="id">r</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> @<span class="id">_</span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">pose</span> (<span class="id">x</span> := @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">pose</span> (<span class="id">c</span> := <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> @<span class="id">_</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge">merge</a></span> @3<span class="id">_</span> <span class="id">c</span>) <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET.f">f</a></span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> @2<span class="id">_</span> <span class="id">c</span>) <span class="id">x</span>).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> <span class="id">_</span> <span class="id">_</span> @3<span class="id">_</span> <span class="id">freset</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> @2<span class="id">_</span> <span class="id">c</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> @2<span class="id">_</span> <span class="id">c</span>) <span class="id">x</span>)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="reset_eq">reset_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#reset">reset</a></span> <span class="id">r</span> <span class="id">x</span> ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">c</span> := <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> <span class="id">r</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge">merge</a></span> <span class="id">c</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">c</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#reset">reset</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> <span class="id">c</span> <span class="id">r</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> <span class="id">c</span> <span class="id">x</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#reset">reset</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET">RESET</a></span>.<br/>
<br/>
<div class="doc">simplified version of the denotational <span class="bracket"><span class="id">sreset</span></span> (no environnements) </div>
<span class="kwd">Section</span> <span class="id"><a name="SRESET">SRESET</a></span>.<br/>
<br/>
<span class="kwd">Parameter</span> <span class="id">sreset</span>' : <span class="kwd">forall</span> {<span class="id">A</span>}, (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>.<br/>
<span class="kwd">Conjecture</span> <span class="id">sreset</span>'<span class="id">_eq</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">f</span> <span class="id">r</span> <span class="id">R</span> <span class="id">X</span> <span class="id">Y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id">sreset</span>' <span class="id">A</span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">r</span> <span class="id">R</span>) <span class="id">X</span> <span class="id">Y</span> ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">sreset</span>' <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">R</span>) <span class="id">X</span> (<span class="id">f</span> <span class="id">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">Y</span> (<span class="id">sreset</span>' <span class="id">f</span> <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">Y</span>)).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="sreset">sreset</a></span> {<span class="id">A</span>} : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- <span class="id">_</span> (<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">f</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> @<span class="id">_</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">R</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> @<span class="id">_</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">X</span> := @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> ((<span class="id">sreset</span>' @4<span class="id">_</span> <span class="id">f</span>) <span class="id">R</span> <span class="id">X</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> <span class="id">_</span> <span class="id">_</span> @2<span class="id">_</span> <span class="id">f</span>) <span class="id">X</span>)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sreset_eq">sreset_eq</a></span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">f</span> <span class="id">R</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#sreset">sreset</a></span> <span class="id">A</span> <span class="id">f</span> <span class="id">R</span> <span class="id">X</span> == <span class="id">sreset</span>' <span class="id">f</span> <span class="id">R</span> <span class="id">X</span> (<span class="id">f</span> <span class="id">X</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#SRESET">SRESET</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="RESET_OK">RESET_OK</a></span>.<br/>
<br/>
<span class="kwd">Parameter</span> (<span class="id"><a name="RESET_OK.A">A</a></span> : <span class="kwd">Type</span>).<br/>
<span class="kwd">Parameter</span> (<span class="id"><a name="RESET_OK.f">f</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.A">A</a></span>)).<br/>
<br/>
<span class="kwd">Conjecture</span> <span class="id"><a name="RESET_OK.AbsF">AbsF</a></span> : <span class="kwd">forall</span> <span class="id">xs</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> <span class="id">xs</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> <span class="id">xs</span>).<br/>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="RESET_OK.AbsConstF">AbsConstF</a></span> : <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_Oeq">take_Oeq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.AbsF">AbsF</a></span>, 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)), 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">IHn</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Conjecture</span> <span class="id"><a name="RESET_OK.LpF">LpF</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">xs</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> <span class="id">xs</span>).<br/>
<br/>
<span class="kwd">Conjecture</span> <span class="id"><a name="RESET_OK.SafeF">SafeF</a></span> : <span class="kwd">forall</span> <span class="id">xs</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">xs</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> <span class="id">xs</span>).<br/>
<br/>
<div class="doc">we only consider functions of clock    </div>
<span class="kwd">Conjecture</span> <span class="id"><a name="RESET_OK.AcF">AcF</a></span> : <span class="kwd">forall</span> <span class="id">xs</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> <span class="id">xs</span>).<br/>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="RESET_OK.InfF">InfF</a></span> : <span class="kwd">forall</span> <span class="id">xs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hinf</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">HH</span> := <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.AcF">AcF</a></span> <span class="id">xs</span>); <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#inf_map">inf_map</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, &lt;- <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_inf">map_inf</a></span>, <span class="id">Hinf</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="RESET_OK.AlignF">AlignF</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> <span class="id">xs</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> <span class="id">xs</span>)) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Sx</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">St</span> := <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.SafeF">SafeF</a></span> <span class="id">xs</span> <span class="id">Sx</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">Hac</span> := <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.AcF">AcF</a></span> <span class="id">xs</span>); <span class="id">revert</span> <span class="id">St</span> <span class="id">Hac</span>; <span class="id">generalize</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> <span class="id">xs</span>); <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">dependent</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">dependent</span> <span class="id">xs</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">_</span> <span class="id">_</span>); <span class="id">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">xs</span>) <span class="kwd">as</span> (<span class="id">vx</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hxs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_is_cons">first_is_cons</a></span>; <span class="id">rewrite</span> <span class="id">Hf</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">t</span>) <span class="kwd">as</span> (<span class="id">vt</span> &amp; <span class="id">t</span>' &amp; <span class="id">Ht</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>; <span class="id">rewrite</span> &lt;- <span class="id">Hac</span>, <span class="id">Hxs</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hxs</span>, <span class="id">Ht</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">St</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> [], <span class="id">Hac</span> <span class="kwd">as</span> []; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">vt</span>; <span class="id">try</span> (<span class="id">congruence</span>|| <span class="id">tauto</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_eq_compat">rem_eq_compat</a></span> <span class="kwd">in</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#rem_AC">rem_AC</a></span> <span class="kwd">in</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_rem">DSForall_rem</a></span> <span class="kwd">in</span> <span class="id">Sx</span>, <span class="id">St</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">IHn</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>)); <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="RESET_OK.AlignF_take">AlignF_take</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">n</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">m</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> <span class="id">xs</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">m</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">m</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> <span class="id">xs</span>)) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">m</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">xs</span> <span class="id">n</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">xs</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">m</span>; <span class="id">intros</span> * <span class="id">Sx</span> <span class="id">Ht</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span> <span class="kwd">in</span> <span class="id">Ht</span>|-*.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> <span class="id">xs</span>)) <span class="kwd">as</span> (?&amp;?&amp; <span class="id">HH</span>).<br/>
&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>; <span class="id">rewrite</span> <span class="id">Ht</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HH</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Ht</span> <span class="kwd">as</span> []; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_app_first">app_app_first</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.AlignF">AlignF</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;2: <span class="id">rewrite</span> <span class="id">HH</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_rem">nrem_rem</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_S">nrem_S</a></span>, &lt;- <span class="id">IHm</span>; <span class="id">eauto</span> 1.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_S">nrem_S</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_rem">nrem_rem</a></span>, <span class="id">HH</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="RESET_OK.f_cons_elim">f_cons_elim</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">y</span> <span class="id">ys</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">x</span>) <span class="id">xs</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">y</span>) <span class="id">ys</span>'.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">Hac</span> := <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.AcF">AcF</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">x</span>) <span class="id">xs</span>)).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">x</span>) <span class="id">xs</span>))) <span class="kwd">as</span> (<span class="id">u</span> &amp; <span class="id">U</span>' &amp; <span class="id">Hu</span>).<br/>
&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_is_cons">AC_is_cons</a></span>; <span class="id">rewrite</span> &lt;- <span class="id">Hac</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hu</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span> <span class="kwd">in</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hac</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">u</span> <span class="kwd">as</span> [|<span class="id">u</span>|]; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">u</span>,<span class="id">U</span>'; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="RESET_OK.reset_abs">reset_abs</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#reset">reset</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> <span class="id">r</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> <span class="id">x</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#reset">reset</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> <span class="id">r</span> <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#reset_eq">reset_eq</a></span>; <span class="id">cbv</span> <span class="id">zeta</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_abs">true_until_abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when_eq">when_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot_eq">whennot_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.AbsF">AbsF</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge_eq">merge_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_eq">expecta_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons_eq_compat">cons_eq_compat</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_stable">fcont_stable</a></span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#reset">reset</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#FIXP_fixp">FIXP_fixp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">r</span> <span class="id">x</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp_ind">fixp_ind</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span> <span class="id">h</span> <span class="id">H</span> <span class="id">r</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_simpl">fmon_comp_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_comp_eq">lub_comp_eq</a></span> <span class="kwd">at</span> 1; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_eq_compat">lub_eq_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_intro">ford_eq_intro</a></span>; <span class="id">intro</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_simpl">fmon_comp_simpl</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_app_simpl">fmon_app_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta">expecta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DScase_bot_eq">DScase_bot_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span> <span class="id">freset</span> <span class="id">Hf</span> <span class="id">r</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> ?<span class="id">a</span> ?<span class="id">b</span>) <span class="kwd">with</span> (<span class="id">a</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">localdb</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_abs">true_until_abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when_eq">when_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot_eq">whennot_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.AbsF">AbsF</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge_eq">merge_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_eq">expecta_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hf</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Key lemma to prove the equivalence of resets </div>
<span class="kwd">Lemma</span> <span class="id"><a name="RESET_OK.f_when">f_when</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rs</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> <span class="id">rs</span>) <span class="id">xs</span>) == <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until">true_until</a></span> <span class="id">rs</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Infr</span> <span class="id">Infx</span> <span class="id">Sr</span> <span class="id">Sx</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_Oeq">take_Oeq</a></span>; <span class="id">intro</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#take_true_until_spec">take_true_until_spec</a></span> <span class="id">n</span> <span class="id">rs</span>) <span class="kwd">as</span> (<span class="id">m</span> &amp; <span class="id">Hlt</span> &amp; <span class="id">Ht1</span> &amp; <span class="id">Ht2</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">replace</span> <span class="id">n</span> <span class="kwd">with</span> (<span class="id">m</span> + (<span class="id">n</span> - <span class="id">m</span>)); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_nrem_eq">take_nrem_eq</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;partie&nbsp;true&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Hlt</span> <span class="id">Ht2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.LpF">LpF</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#take_when">take_when</a></span>, <span class="id">Ht1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_map">take_map</a></span>, &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#take_when">take_when</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when_true">when_true</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.LpF">LpF</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.SafeF">SafeF</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">try</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_map">DSForall_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_impl">DSForall_impl</a></span>, <span class="id">Sr</span>; <span class="id">simpl</span>; <span class="id">intros</span> []; <span class="id">tauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="kwd">in</span> *; <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.AcF">AcF</a></span>, <span class="id">Hac</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_comp">map_comp</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_ext">map_ext</a></span>; <span class="id">intros</span> []; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="kwd">in</span> *; <span class="id">rewrite</span> <span class="id">Hac</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_comp">map_comp</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_ext">map_ext</a></span>; <span class="id">intros</span> []; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;partie&nbsp;false&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Ht1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Lt.html#le_lt_or_eq_stt">Lt.le_lt_or_eq_stt</a></span> <span class="kwd">in</span> <span class="id">Hlt</span> <span class="kwd">as</span> [<span class="id">Hlt</span>|]; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.sub_diag">Nat.sub_diag</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#nrem_when">nrem_when</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#take_when">take_when</a></span>, <span class="id">Ht2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when_false">when_false</a></span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">_</span> <span class="id">_</span>)), <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_comp">map_comp</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_map">take_map</a></span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">try</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_map">DSForall_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_take">DSForall_take</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_nrem">DSForall_nrem</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_impl">DSForall_impl</a></span>, <span class="id">Sr</span>; <span class="id">intros</span> []; <span class="id">tauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_take">DSForall_take</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_nrem">DSForall_nrem</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.SafeF">SafeF</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_impl">DSForall_impl</a></span>, <span class="id">Sx</span>; <span class="id">intros</span> []; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_comp">map_comp</a></span>, &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_map">take_map</a></span>, &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_map">nrem_map</a></span>, &lt;- (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.AcF">AcF</a></span> <span class="id">xs</span>), <span class="id">Hac</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_map">nrem_map</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_map">take_map</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_ext">map_ext</a></span>; <span class="id">intros</span> []; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> (<span class="id">n</span> - <span class="id">m</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> =&gt; (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>:<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.A">A</a></span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">m</span> <span class="id">rs</span>)) ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> (<span class="id">n</span> - <span class="id">m</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>)) <span class="kwd">as</span> <span class="id">Habs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">assert</span> (<span class="id">Infn</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">m</span> <span class="id">rs</span>)) <span class="kwd">by</span> (<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_infinite">nrem_infinite</a></span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Infn</span>; <span class="id">generalize</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">m</span> <span class="id">rs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span>; <span class="id">induction</span> (<span class="id">n</span> - <span class="id">m</span>); <span class="id">intros</span> ? [? (? &amp; <span class="id">Ht</span> &amp; ?)]%<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Ht</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">_</span>)), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.AlignF_take">AlignF_take</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_when">safe_when</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_true_until">safe_true_until</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#AC_true_until">AC_true_until</a></span>, <span class="id">Hac</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#nrem_when">nrem_when</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#take_when">take_when</a></span>, <span class="id">Ht2</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when_false">when_false</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_comp">map_comp</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_map">take_map</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">try</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_map">DSForall_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_take">DSForall_take</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_nrem">DSForall_nrem</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_impl">DSForall_impl</a></span>, <span class="id">Sr</span>; <span class="id">intros</span> []; <span class="id">tauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_take">DSForall_take</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_nrem">DSForall_nrem</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_impl">DSForall_impl</a></span>, <span class="id">Sx</span>; <span class="id">intros</span> []; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_comp">map_comp</a></span>, &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_map">take_map</a></span>, &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_map">nrem_map</a></span>, <span class="id">Hac</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_map">nrem_map</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_map">take_map</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_ext">map_ext</a></span>; <span class="id">intros</span> []; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="RESET_OK.bool_of">bool_of</a></span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> | <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="RESET_OK.sreset_match_aux">sreset_match_aux</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rs</span> <span class="id">xs</span> <span class="id">cs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop">sbinop</a></span> (<span class="kwd">fun</span> <span class="id">b1</span> <span class="id">b2</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> <span class="id">b1</span> &amp;&amp; <span class="id">b2</span>)) <span class="id">rs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1">fby1</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst">sconst</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">rs</span>)) <span class="id">cs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge">merge</a></span> <span class="id">cs</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">cs</span> <span class="id">ys</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#reset">reset</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> <span class="id">cs</span> <span class="id">rs</span>) (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> <span class="id">cs</span> <span class="id">xs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id">sreset</span>' <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.bool_of">bool_of</a></span> <span class="id">rs</span>) <span class="id">xs</span> <span class="id">ys</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Infr</span> <span class="id">Infx</span> <span class="id">Infy</span> <span class="id">Sr</span> <span class="id">Sx</span> <span class="id">Sy</span> <span class="id">Hac</span> <span class="id">Acy</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;<span class="id">coind_Oeq</span> <span class="id">Cof</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">intros</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Infr2</span> := <span class="id">Infr</span>). <span class="id">assert</span> (<span class="id">Infx2</span> := <span class="id">Infx</span>). <span class="id">assert</span> (<span class="id">Infy2</span> := <span class="id">Infy</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Infr2</span> <span class="kwd">as</span> (<span class="id">vr</span> &amp; <span class="id">rs</span>' &amp; <span class="id">Hrs</span> &amp;<span class="id">Infr</span>').<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Infx2</span> <span class="kwd">as</span> (<span class="id">vx</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hxs</span> &amp;<span class="id">Infx</span>').<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Infy2</span> <span class="kwd">as</span> (<span class="id">vy</span> &amp; <span class="id">ys</span>' &amp; <span class="id">Hys</span> &amp;<span class="id">Infy</span>').<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id">Hxs</span>, <span class="id">Hys</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hac</span> <span class="kwd">as</span> [], <span class="id">Acy</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Sr2</span> := <span class="id">Sr</span>). <span class="id">assert</span> (<span class="id">Sx2</span> := <span class="id">Sx</span>). <span class="id">assert</span> (<span class="id">Sy2</span> := <span class="id">Sy</span>).<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sr2</span> <span class="kwd">as</span> [|??? <span class="id">Sr</span>']; <span class="id">inversion_clear</span> <span class="id">Sx2</span>; <span class="id">inversion_clear</span> <span class="id">Sy2</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">sreset</span>'<span class="id">_eq</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">vr</span> <span class="kwd">as</span> [|<span class="id">vr</span>|], <span class="id">vx</span>, <span class="id">vy</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">HV</span>; <span class="id">try</span> (<span class="id">tauto</span> || <span class="id">congruence</span>).<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;abs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst_cons">sconst_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1_eq">fby1_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span> <span class="kwd">in</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot_eq">whennot_eq</a></span>,<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge_eq">merge_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.reset_abs">reset_abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when_eq">when_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_eq">expecta_eq</a></span> <span class="kwd">in</span> <span class="id">HU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. <span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">Cof</span> <span class="id">rs</span>' <span class="id">xs</span>' (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">cs</span>) <span class="id">ys</span>'); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP_eq">fby1AP_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id">HU</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">HV</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;pres&nbsp;vr&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst_cons">sconst_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1_eq">fby1_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span> <span class="kwd">in</span> <span class="id">Hcs</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">vr</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hcs</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;vr&nbsp;=&nbsp;false&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot_eq">whennot_eq</a></span>,<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge_eq">merge_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.reset_abs">reset_abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when_eq">when_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_eq">expecta_eq</a></span> <span class="kwd">in</span> <span class="id">HU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">HU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. <span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">Cof</span> <span class="id">rs</span>' <span class="id">xs</span>' (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">cs</span>) <span class="id">ys</span>'); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs</span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP_eq">fby1AP_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hcs</span>, <span class="id">HU</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">HV</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;vr&nbsp;=&nbsp;true,&nbsp;seul&nbsp;cas&nbsp;vraiment&nbsp;intressant,&nbsp;on&nbsp;passe&nbsp;dans&nbsp;l'instance&nbsp;d'aprs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">sreset</span>'<span class="id">_eq</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;refait&nbsp;toutes&nbsp;les&nbsp;proprits&nbsp;casses&nbsp;au&nbsp;dessus...&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">Hxs</span>, &lt;- <span class="id">Hys</span>, &lt;- <span class="id">Hrs</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hac</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">rs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hxs</span>, <span class="id">Hrs</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id">H0</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Acy</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">ys</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hxs</span>, <span class="id">Hys</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id">H2</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hcs2</span> : <span class="id">cs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop">sbinop</a></span> (<span class="kwd">fun</span> <span class="id">b1</span> <span class="id">b2</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> <span class="id">b1</span> &amp;&amp; <span class="id">b2</span>)) <span class="id">rs</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1">fby1</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst">sconst</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">rs</span>)) <span class="id">cs</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst_cons">sconst_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1_eq">fby1_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop_eq">sbinop_eq</a></span>; <span class="id">simpl</span>; <span class="id">now</span> <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#cs_spec1">cs_spec1</a></span> <span class="id">cs</span> <span class="id">rs</span>) <span class="kwd">in</span> <span class="id">Sr</span> <span class="kwd">as</span> <span class="id">Hcs3</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">CsF</span> : <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#DSForall_pres">DSForall_pres</a></span> (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">b</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">cs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hcs3</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_map">DSForall_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_impl">DSForall_impl</a></span>, <span class="id">Sr</span>; <span class="id">intros</span> []; <span class="id">tauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Acc</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">cs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hcs3</span>, <span class="id">Hac</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_comp">map_comp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_ext">map_ext</a></span>; <span class="id">intros</span> []; <span class="id">tauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Sc</span> : <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">cs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hcs3</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_map">DSForall_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_impl">DSForall_impl</a></span>, <span class="id">Sr</span>; <span class="id">intros</span> []; <span class="id">tauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Infc</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">cs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hcs3</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_inf">map_inf</a></span>, <span class="id">Infr</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when_false">when_false</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot_false">whennot_false</a></span> <span class="kwd">in</span> <span class="id">HU</span>; <span class="id">eauto</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#reset_eq">reset_eq</a></span> <span class="kwd">in</span> <span class="id">HU</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">HU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge_false_merge">merge_false_merge</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f_when">f_when</a></span> <span class="kwd">in</span> <span class="id">HU</span>; <span class="id">eauto</span> 4 <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_true_until">safe_true_until</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#AC_true_until">AC_true_until</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.InfF">InfF</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_inf">zip_inf</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_inf">true_until_inf</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f_cons_elim">f_cons_elim</a></span> <span class="id">a</span> <span class="id">xs</span>') <span class="kwd">as</span> (?&amp; <span class="id">rfx</span> &amp; <span class="id">Hfa</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_pres1">true_until_pres1</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id">rs</span>') <span class="kwd">as</span> (<span class="id">cs</span>' &amp; <span class="id">Htu</span> &amp; <span class="id">Hcs</span>'); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id">Htu</span>, <span class="id">Hxs</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot_eq">whennot_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.reset_abs">reset_abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge_eq">merge_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_eq">expecta_eq</a></span>, <span class="id">Hfa</span> <span class="kwd">in</span> <span class="id">HU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hxs</span>, <span class="id">Hfa</span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. <span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_app_first">first_app_first</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when_eq">when_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">Cof</span> <span class="id">rs</span>' <span class="id">xs</span>' <span class="id">cs</span>' (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> <span class="id">xs</span>))); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.InfF">InfF</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.CommonDS.html#DSForall_rem">DSForall_rem</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.SafeF">SafeF</a></span>, <span class="id">Sx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">pose</span> <span class="id">proof</span> (<span class="id">Acf</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_eq_compat">rem_eq_compat</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.AcF">AcF</a></span> <span class="id">xs</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hxs</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#rem_AC">rem_AC</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">Acf</span> <span class="kwd">at</span> 1; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hxs</span>, <span class="id">Hfa</span>, <span class="id">HU</span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when_eq">when_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, 3 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hxs</span>, <span class="id">Hfa</span>, <span class="id">HV</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="RESET_OK.reset_match">reset_match</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rs</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#safe_DS">safe_DS</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rsb</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.bool_of">bool_of</a></span> <span class="id">rs</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#reset">reset</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> <span class="id">rs</span> <span class="id">xs</span> == <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#sreset">sreset</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> <span class="id">rsb</span> <span class="id">xs</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Infr</span> <span class="id">Infx</span> <span class="id">Sr</span> <span class="id">Sx</span> <span class="id">Hac</span> <span class="id">rsb</span>; <span class="id">subst</span> <span class="id">rsb</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#sreset_eq">sreset_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#reset_eq">reset_eq</a></span>; <span class="id">cbv</span> <span class="id">zeta</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f_when">f_when</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">Sy</span> := <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.SafeF">SafeF</a></span> <span class="id">xs</span> <span class="id">Sx</span>); <span class="id">revert</span> <span class="id">Sy</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">Acy</span> := <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.AcF">AcF</a></span> <span class="id">xs</span>); <span class="id">revert</span> <span class="id">Acy</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">Infy</span> := <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.InfF">InfF</a></span> <span class="id">xs</span> <span class="id">Infx</span>); <span class="id">revert</span> <span class="id">Infy</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;commence&nbsp;par&nbsp;laisser&nbsp;passer&nbsp;les&nbsp;absences&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">coind_Oeq</span> <span class="id">Cof</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">intros</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Infr</span> <span class="kwd">as</span> (<span class="id">vr</span> &amp; <span class="id">rs</span>' &amp; <span class="id">Hrs</span> &amp;<span class="id">Infr</span>').<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Infx</span> <span class="kwd">as</span> (<span class="id">vx</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hxs</span> &amp;<span class="id">Infx</span>').<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_decomp">infinite_decomp</a></span> <span class="kwd">in</span> <span class="id">Infy</span> <span class="kwd">as</span> (<span class="id">vy</span> &amp; <span class="id">ys</span>' &amp; <span class="id">Hys</span> &amp;<span class="id">Infy</span>').<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>, <span class="id">Hxs</span>, <span class="id">Hys</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC_cons">AC_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hac</span> <span class="kwd">as</span> [], <span class="id">Acy</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Sr</span>; <span class="id">inversion_clear</span> <span class="id">Sx</span>; <span class="id">inversion_clear</span> <span class="id">Sy</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">sreset</span>'<span class="id">_eq</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">vr</span> <span class="kwd">as</span> [|<span class="id">vr</span>|], <span class="id">vx</span>, <span class="id">vy</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">HV</span>; <span class="id">try</span> (<span class="id">tauto</span> || <span class="id">congruence</span>).<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;abs&nbsp;:&nbsp;co-induction&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.AbsF">AbsF</a></span> <span class="kwd">in</span> <span class="id">Hys</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hys</span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">Hys</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_abs">true_until_abs</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot_eq">whennot_eq</a></span>,<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge_eq">merge_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.reset_abs">reset_abs</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when_eq">when_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_eq">expecta_eq</a></span> <span class="kwd">in</span> <span class="id">HU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span> <span class="kwd">in</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. <span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">Cof</span> <span class="id">rs</span>' <span class="id">xs</span>'); <span class="id">rewrite</span> ?<span class="id">HU</span>, ?<span class="id">HV</span>, &lt;- ?<span class="id">Hys</span>', ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.AbsF">AbsF</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.InfF">InfF</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.AcF">AcF</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.SafeF">SafeF</a></span>.<br/>
&nbsp;&nbsp;} <span class="id">clear</span> <span class="id">Cof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;on&nbsp;se&nbsp;dbarasse&nbsp;maintenant&nbsp;de&nbsp;true_until&nbsp;pour&nbsp;passer&nbsp;dans&nbsp;l'tat&nbsp;rcurrent&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#true_until_pres1">true_until_pres1</a></span> <span class="id">vr</span> <span class="id">rs</span>') <span class="kwd">as</span> (<span class="id">cs</span>' &amp; <span class="id">Htu</span> &amp; <span class="id">Hcs</span>'); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Htu</span> <span class="kwd">in</span> <span class="id">HU</span>; <span class="id">clear</span> <span class="id">Htu</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when_eq">when_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot_eq">whennot_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.reset_abs">reset_abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge_eq">merge_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#expecta_eq">expecta_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span> <span class="kwd">in</span> <span class="id">HU</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">HU</span>, <span class="id">HV</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">destruct</span> <span class="id">vr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">sreset</span>'<span class="id">_eq</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_app_first">first_app_first</a></span>, <span class="id">Hys</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;ce&nbsp;que&nbsp;l'on&nbsp;cherche&nbsp;vraiment&nbsp;&nbsp;prouver&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">enough</span> (<span class="id">Heq</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#merge">merge</a></span> <span class="id">cs</span>' (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#when">when</a></span> <span class="id">cs</span>' <span class="id">ys</span>') (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#reset">reset</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> <span class="id">cs</span>' <span class="id">rs</span>') (<span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#whennot">whennot</a></span> <span class="id">cs</span>' <span class="id">xs</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id">sreset</span>' <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.f">f</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.bool_of">bool_of</a></span> <span class="id">rs</span>') <span class="id">xs</span>' <span class="id">ys</span>').<br/>
&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Oeq_ds_eq">Oeq_ds_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HU</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HV</span>; <span class="id">destruct</span> <span class="id">vr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">sreset</span>'<span class="id">_eq</span>, <span class="id">Hys</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK.sreset_match_aux">sreset_match_aux</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.ResetLs.html#RESET_OK">RESET_OK</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
