
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Cpo_streams_type</title>
<meta name="description" content="Documentation of Coq module Cpo_streams_type" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Cpo_streams_type</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html">Cpo_def</a></span>.<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="kwd">Arguments</span>.<br/>
<br/>
<br/>
<h1> Cpo_streams_type.v: Domain of possibly infinite streams on a type </h1>
<br/>
<span class="kwd">CoInductive</span> <span class="id"><a name="DStr">DStr</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>) : <span class="kwd">Type</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a name="Eps">Eps</a></span> : <span class="id">DStr</span> <span class="id">D</span> -&gt; <span class="id">DStr</span> <span class="id">D</span> | <span class="id"><a name="Con">Con</a></span> : <span class="id">D</span> -&gt; <span class="id">DStr</span> <span class="id">D</span> -&gt; <span class="id">DStr</span> <span class="id">D</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DS_inv">DS_inv</a></span>  : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="kwd">Type</span>) (<span class="id">d</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;<span class="id">d</span> = <span class="kwd">match</span> <span class="id">d</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span> | <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span> <span class="kwd">end</span>.<br/>
<span class="id">destruct</span> <span class="id">d</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">DS_inv</span> : <span class="id">core</span>.<br/>
<br/>
<div class="doc">- Extraction of a finite list from the n first constructors of a stream </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="DS_to_list">DS_to_list</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>)(<span class="id">d</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>) (<span class="id">n</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) {<span class="id">struct</span> <span class="id">n</span>}: <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#list">List.list</a></span> <span class="id">D</span> :=<br/>
&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nil">List.nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">p</span> =&gt; <span class="kwd">match</span> <span class="id">d</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">d</span>' =&gt; <span class="id">DS_to_list</span> <span class="id">d</span>' <span class="id">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">d</span>' =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#cons">List.cons</a></span> <span class="id">a</span> (<span class="id">DS_to_list</span> <span class="id">d</span>' <span class="id">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<h2> Removing Eps steps </h2>
<span class="kwd">Definition</span> <span class="id"><a name="pred">pred</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>) <span class="id">d</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span> := <span class="kwd">match</span> <span class="id">d</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span> =&gt; <span class="id">x</span> | <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">d</span> <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="isCon">isCon</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="isConEps">isConEps</a></span> : <span class="kwd">forall</span> <span class="id">x</span>, <span class="id">isCon</span> <span class="id">x</span> -&gt; <span class="id">isCon</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="isConCon">isConCon</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">s</span>, <span class="id">isCon</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>).<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="isCon_pred">isCon_pred</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">x</span>).<br/>
<span class="id">destruct</span> 1; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">isCon_pred</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="isEps">isEps</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>) (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>) := <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span> <span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Less general than isCon_pred but the result is a subterm of
      the argument (isCon x), used in uncons </div>
<span class="kwd">Lemma</span> <span class="id"><a name="isConEps_inv">isConEps_inv</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isEps">isEps</a></span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">x</span>).<br/>
<span class="id">destruct</span> 1; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">assumption</span>.<br/>
<span class="id">case</span> <span class="id">H</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="isCon_intro">isCon_intro</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">x</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> <span class="id">x</span>.<br/>
<span class="id">destruct</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">isCon_intro</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="pred_nth">pred_nth</a></span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) {<span class="id">struct</span> <span class="id">n</span>} : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span> 0 =&gt; <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> =&gt; <span class="id">pred_nth</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">x</span>) <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pred_nth_switch">pred_nth_switch</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">k</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth">pred_nth</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">x</span>) <span class="id">k</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth">pred_nth</a></span> <span class="id">x</span> <span class="id">k</span>).<br/>
<span class="id">induction</span> <span class="id">k</span>; <span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">pred_nth_switch</span>  : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pred_nthS">pred_nthS</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">k</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth">pred_nth</a></span> <span class="id">x</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>) = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth">pred_nth</a></span> <span class="id">x</span> <span class="id">k</span>).<br/>
<span class="id">exact</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth_switch">pred_nth_switch</a></span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">pred_nthS</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pred_nthCon">pred_nthCon</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>) <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth">pred_nth</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>) <span class="id">n</span> = (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>).<br/>
<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">pred_nthCon</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="decomp">decomp</a></span> <span class="id">D</span> (<span class="id">a</span>:<span class="id">D</span>) (<span class="id">s</span> <span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>) : <span class="kwd">Prop</span> := <span class="kwd">exists</span> <span class="id">k</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth">pred_nth</a></span> <span class="id">x</span> <span class="id">k</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>.<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decomp_isCon">decomp_isCon</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span> <span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> <span class="id">x</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> <span class="id">Hd</span>; <span class="id">case</span> <span class="id">Hd</span>; <span class="id">intro</span> <span class="id">k</span>; <span class="id">generalize</span> <span class="id">x</span>; <span class="id">induction</span> <span class="id">k</span>; <span class="id">simpl</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">subst</span> <span class="id">x0</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decompCon">decompCon</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>).<br/>
<span class="kwd">exists</span> (0%<span class="id">nat</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">decompCon</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decompCon_eq">decompCon_eq</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">b</span> <span class="id">t</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">b</span> <span class="id">t</span>.<br/>
<span class="id">destruct</span> 1.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth">pred_nth</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">b</span> <span class="id">t</span>) <span class="id">x</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">decompCon_eq</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decompEps">decompEps</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span> <span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span>).<br/>
<span class="id">destruct</span> 1.<br/>
<span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">x0</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">decompEps</span> : <span class="id">core</span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decompEps_pred">decompEps_pred</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span> <span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">x</span>).<br/>
<span class="id">destruct</span> 1; <span class="id">intros</span>.<br/>
<span class="kwd">exists</span> <span class="id">x0</span>; <span class="id">auto</span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth">pred_nth</a></span> <span class="id">x</span> <span class="id">x0</span>)); <span class="id">auto</span>.<br/>
<span class="id">rewrite</span> <span class="id">H</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decompEps_pred_sym">decompEps_pred_sym</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span> <span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">x</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span>.<br/>
<span class="id">destruct</span> <span class="id">x</span>; <span class="id">simpl</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">decompEps_pred_sym</span> <span class="id">decompEps_pred</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decomp_ind">decomp_ind</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>) (<span class="id">P</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>-&gt; <span class="kwd">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">P</span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> -&gt; <span class="id">P</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span>))<br/>
&nbsp;-&gt; <span class="id">P</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>) -&gt;  <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> -&gt; <span class="id">P</span> <span class="id">x</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">a</span> <span class="id">s</span> <span class="id">P</span> <span class="id">HE</span> <span class="id">HC</span> <span class="id">x</span> <span class="id">H</span>; <span class="id">case</span> <span class="id">H</span>; <span class="id">intro</span> <span class="id">n</span>; <span class="id">generalize</span> <span class="id">x</span> <span class="id">H</span>; <span class="id">clear</span> <span class="id">x</span> <span class="id">H</span>.<br/>
<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">subst</span>; <span class="id">auto</span>.<br/>
<span class="id">destruct</span> <span class="id">x</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span>); <span class="id">auto</span>.<br/>
<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decompEps_pred">decompEps_pred</a></span> <span class="id">H</span>).<br/>
<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nthCon">pred_nthCon</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
<span class="id">injection</span> <span class="id">H0</span>; <span class="id">intros</span>; <span class="id">subst</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DStr_match">DStr_match</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), {<span class="id">a</span>:<span class="id">D</span> &amp; {<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span> | <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>}}+{<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isEps">isEps</a></span> <span class="id">x</span>}.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">x</span>; <span class="id">case</span> <span class="id">x</span>; <span class="id">simpl</span>; <span class="id">auto</span>; <span class="id">intros</span> <span class="id">a</span> <span class="id">s</span>.<br/>
<span class="id">left</span>; <span class="kwd">exists</span> <span class="id">a</span>; <span class="kwd">exists</span> <span class="id">s</span>; <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="uncons">uncons</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> <span class="id">x</span> -&gt;{<span class="id">a</span>:<span class="id">D</span> &amp; {<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>| <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span>}}.<br/>
<span class="id">intro</span> <span class="id">D</span>. <span class="kwd">fix</span> <span class="id">uncons</span> 2; <span class="id">intros</span> <span class="id">x</span> <span class="id">ic</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr_match">DStr_match</a></span> <span class="id">x</span>); <span class="id">intros</span>.<br/>
<span class="id">case</span> <span class="id">s</span>; <span class="id">clear</span> <span class="id">s</span>; <span class="id">intros</span> <span class="id">a</span> (<span class="id">s</span>, <span class="id">eqx</span>); <span class="kwd">exists</span> <span class="id">a</span>; <span class="kwd">exists</span> <span class="id">s</span>; <span class="id">subst</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
<span class="id">case</span> (<span class="id">uncons</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isConEps_inv">isConEps_inv</a></span> <span class="id">ic</span> <span class="id">i</span>)); <span class="id">intros</span> <span class="id">a</span> (<span class="id">s</span>,<span class="id">dx</span>).<br/>
<span class="kwd">exists</span> <span class="id">a</span>; <span class="kwd">exists</span> <span class="id">s</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<h2> Definition of the order </h2>
<span class="kwd">CoInductive</span> <span class="id"><a name="DSle">DSle</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="DSleEps">DSleEps</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,  <span class="id">DSle</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">DSle</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span>) <span class="id">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  <span class="id"><a name="DSleCon">DSleCon</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">s</span> <span class="id">t</span> <span class="id">y</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">t</span> <span class="id">y</span> -&gt; <span class="id">DSle</span> <span class="id">s</span> <span class="id">t</span> -&gt; <span class="id">DSle</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>) <span class="id">y</span>.<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> : <span class="id">core</span>.<br/>
<br/>
<h2> Properties of the order </h2>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_pred_eq">DSle_pred_eq</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), <span class="kwd">forall</span> <span class="id">n</span>, <span class="id">x</span>=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth">pred_nth</a></span> <span class="id">y</span> <span class="id">n</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="id">intro</span> <span class="id">D</span>; <span class="kwd">cofix</span> <span class="id">DSle_pred_eq</span>; <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">n</span>.<br/>
<span class="id">case</span> <span class="id">x</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleEps">DSleEps</a></span>; <span class="id">apply</span> (<span class="id">DSle_pred_eq</span> <span class="id">d</span> <span class="id">y</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
<span class="id">replace</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth">pred_nth</a></span> <span class="id">y</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth">pred_nth</a></span> <span class="id">y</span> <span class="id">n</span>)).<br/>
<span class="id">rewrite</span> &lt;- <span class="id">H</span>; <span class="id">trivial</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth_switch">pred_nth_switch</a></span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon">DSleCon</a></span> <span class="kwd">with</span> <span class="id">d0</span>.<br/>
<span class="kwd">exists</span> <span class="id">n</span>; <span class="id">auto</span>.<br/>
<span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id">DSle_pred_eq</span> <span class="id">d0</span> <span class="id">d0</span> (0%<span class="id">nat</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_refl">DSle_refl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> <span class="id">x</span> <span class="id">x</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_pred_eq">DSle_pred_eq</a></span> (<span class="id">x</span>:=<span class="id">x</span>) <span class="id">x</span> 0); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">DSle_refl</span> : <span class="id">core</span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_pred_right">DSle_pred_right</a></span>  : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>),  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">y</span>).<br/>
<span class="id">intro</span> <span class="id">D</span>; <span class="kwd">cofix</span> <span class="id">DSle_pred_right</span>; <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H1</span>; <span class="id">case</span> <span class="id">H1</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleEps">DSleEps</a></span>.<br/>
<span class="id">apply</span> <span class="id">DSle_pred_right</span>; <span class="id">assumption</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon">DSleCon</a></span> <span class="kwd">with</span> <span class="id">t</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSleEps_right_elim">DSleEps_right_elim</a></span>  : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>),  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">y</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>; <span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_pred_right">DSle_pred_right</a></span> <span class="id">H</span>).<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_pred_right_elim">DSle_pred_right_elim</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>),  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">y</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="kwd">cofix</span> <span class="id">DSle_pred_right_elim</span>; <span class="id">destruct</span> <span class="id">x</span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleEps">DSleEps</a></span>.<br/>
<span class="id">apply</span> <span class="id">DSle_pred_right_elim</span>; <span class="id">inversion</span> <span class="id">H</span>; <span class="id">assumption</span>.<br/>
<span class="id">inversion</span> <span class="id">H</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon">DSleCon</a></span> <span class="kwd">with</span> <span class="id">t</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_pred_left">DSle_pred_left</a></span>  : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>),  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">x</span>) <span class="id">y</span>.<br/>
<span class="id">destruct</span> 1; <span class="id">simpl</span>; <span class="id">intros</span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon">DSleCon</a></span> <span class="kwd">with</span> <span class="id">t</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">DSle_pred_left</span> <span class="id">DSle_pred_right</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_pred">DSle_pred</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>),  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">y</span>).<br/>
<span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">DSle_pred</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_pred_left_elim">DSle_pred_left_elim</a></span>  : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>),  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">x</span>) <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="id">intro</span> <span class="id">D</span>; <span class="kwd">cofix</span> <span class="id">DSle_pred_left_elim</span>; <span class="id">destruct</span> <span class="id">x</span>; <span class="id">simpl</span>; <span class="id">intros</span>; <span class="id">try</span> <span class="id">assumption</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleEps">DSleEps</a></span>; <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_decomp">DSle_decomp</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span> <span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="kwd">exists</span> <span class="id">t</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">t</span> <span class="id">y</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> <span class="id">s</span> <span class="id">t</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Hdx</span>; <span class="id">case</span> <span class="id">Hdx</span>; <span class="id">intros</span> <span class="id">k</span>; <span class="id">generalize</span> <span class="id">x</span>; <span class="id">induction</span> <span class="id">k</span>; <span class="id">simpl</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">inversion</span> <span class="id">H0</span>.<br/>
<span class="kwd">exists</span> <span class="id">t</span>; <span class="id">auto</span>.<br/>
<span class="id">case</span> (<span class="id">IHk</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">x0</span>)); <span class="id">auto</span>.<br/>
<span class="id">intros</span> <span class="id">t</span> (<span class="id">Hd</span>,<span class="id">Hle</span>).<br/>
<span class="kwd">exists</span> <span class="id">t</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_trans">DSle_trans</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> <span class="id">y</span> <span class="id">z</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle">DSle</a></span> <span class="id">x</span> <span class="id">z</span>.<br/>
<span class="id">intro</span> <span class="id">D</span>; <span class="kwd">cofix</span> <span class="id">DSle_trans</span>; <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">H1</span>; <span class="id">case</span> <span class="id">H1</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleEps">DSleEps</a></span>.<br/>
<span class="id">apply</span> <span class="id">DSle_trans</span> <span class="kwd">with</span> <span class="id">y0</span>; <span class="id">assumption</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_decomp">DSle_decomp</a></span> <span class="id">H</span> <span class="id">H2</span>); <span class="id">intros</span> <span class="id">u</span> (<span class="id">He</span>,<span class="id">Ht</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon">DSleCon</a></span> <span class="kwd">with</span> <span class="id">u</span>; <span class="id">try</span> <span class="id">assumption</span>.<br/>
<span class="id">apply</span> <span class="id">DSle_trans</span> <span class="kwd">with</span> <span class="id">t</span>; <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<h3> Defintion of the ordered set </h3>
<span class="kwd">Definition</span> <span class="id"><a name="DS_ord">DS_ord</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ord">ord</a></span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mk_ord">mk_ord</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_refl">DSle_refl</a></span> (<span class="id">D</span>:=<span class="id">D</span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_trans">DSle_trans</a></span> (<span class="id">D</span>:=<span class="id">D</span>)).<br/>
<br/>
<h3> more Properties </h3>
<span class="kwd">Lemma</span> <span class="id"><a name="DSleEps_right">DSleEps_right</a></span>  : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="kwd">Type</span>) (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>),  <span class="id">x</span> &lt;= <span class="id">y</span> -&gt; <span class="id">x</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">y</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_pred_right_elim">DSle_pred_right_elim</a></span> (<span class="id">x</span>:=<span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">y</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">DSleEps_right</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSleEps_left">DSleEps_left</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>),  <span class="id">x</span> &lt;= <span class="id">y</span> -&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id">y</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_pred_left_elim">DSle_pred_left_elim</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span>) (<span class="id">y</span>:=<span class="id">y</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">DSleEps_left</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSeq_pred">DSeq_pred</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">x</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_pred_right">DSle_pred_right</a></span> (<span class="id">x</span>:=<span class="id">x</span>) (<span class="id">y</span>:=<span class="id">x</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_pred_left">DSle_pred_left</a></span> (<span class="id">x</span>:=<span class="id">x</span>) (<span class="id">y</span>:=<span class="id">x</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">DSeq_pred</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pred_nth_eq">pred_nth_eq</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">n</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>),  <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth">pred_nth</a></span> <span class="id">x</span> <span class="id">n</span>.<br/>
<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">x</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">pred_nth_eq</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSleCon0">DSleCon0</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>),  <span class="id">s</span> &lt;= <span class="id">t</span> -&gt;  (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">t</span>.<br/>
<span class="id">intros</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon">DSleCon</a></span> (<span class="id">a</span>:=<span class="id">a</span>) (<span class="id">s</span>:=<span class="id">s</span>) (<span class="id">t</span>:=<span class="id">t</span>) (<span class="id">y</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">t</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">DSleCon0</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Con_compat">Con_compat</a></span> :<br/>
&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), <span class="id">s</span> == <span class="id">t</span> -&gt;  (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Con_compat</span> : <span class="id">core</span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSleCon_hd">DSleCon_hd</a></span> : <span class="kwd">forall</span> (<span class="id">D</span>:<span class="kwd">Type</span>) <span class="id">a</span> <span class="id">b</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">b</span> <span class="id">t</span>-&gt; <span class="id">a</span> = <span class="id">b</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">a</span> <span class="id">b</span> <span class="id">s</span> <span class="id">t</span> <span class="id">H</span>; <span class="id">inversion</span> <span class="id">H</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">t0</span>=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">b</span> <span class="id">t</span>); <span class="id">auto</span>.<br/>
<span class="id">injection</span> <span class="id">H5</span>; <span class="id">intros</span>; <span class="id">subst</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Con_hd_simpl">Con_hd_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">s</span> <span class="id">t</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>),  (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">b</span> <span class="id">t</span>-&gt; <span class="id">a</span> = <span class="id">b</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon_hd">DSleCon_hd</a></span> <span class="kwd">with</span> <span class="id">s</span> <span class="id">t</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSleCon_tl">DSleCon_tl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">b</span> <span class="id">t</span> -&gt; (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id">t</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">a</span> <span class="id">b</span> <span class="id">s</span> <span class="id">t</span> <span class="id">H</span>; <span class="id">inversion</span> <span class="id">H</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">t0</span>=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">b</span> <span class="id">t</span>); <span class="id">auto</span>.<br/>
<span class="id">injection</span> <span class="id">H5</span>; <span class="id">intros</span>; <span class="id">subst</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Con_tl_simpl">Con_tl_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">b</span> <span class="id">t</span> -&gt; (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) == <span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon_tl">DSleCon_tl</a></span> <span class="kwd">with</span> <span class="id">a</span> <span class="id">b</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon_tl">DSleCon_tl</a></span> <span class="kwd">with</span> <span class="id">b</span> <span class="id">a</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eqEps">eqEps</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">eqEps</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decomp_eqCon">decomp_eqCon</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> <span class="id">s</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> -&gt; <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> <span class="id">Hdx</span>; <span class="id">case</span> <span class="id">Hdx</span>; <span class="id">intro</span> <span class="id">k</span>; <span class="id">generalize</span> <span class="id">x</span>; <span class="id">induction</span> <span class="id">k</span>; <span class="id">auto</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">x0</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">decomp_eqCon</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decomp_DSleCon">decomp_DSleCon</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> <span class="id">s</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> -&gt; <span class="id">x</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>.<br/>
<span class="id">intros</span>; <span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp_eqCon">decomp_eqCon</a></span> <span class="id">H</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decomp_DSleCon_sym">decomp_DSleCon_sym</a></span> :<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> <span class="id">s</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> -&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>)&lt;=<span class="id">x</span>.<br/>
<span class="id">intros</span>; <span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp_eqCon">decomp_eqCon</a></span> <span class="id">H</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">decomp_DSleCon</span> <span class="id">decomp_DSleCon_sym</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSleCon_exists_decomp">DSleCon_exists_decomp</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) <span class="id">a</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="kwd">exists</span> <span class="id">b</span>, <span class="kwd">exists</span> <span class="id">t</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">b</span> <span class="id">t</span> <span class="id">x</span> /\ <span class="id">a</span> = <span class="id">b</span> /\ <span class="id">s</span> &lt;= <span class="id">t</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">x</span> <span class="id">a</span> <span class="id">s</span> <span class="id">H</span>; <span class="id">inversion</span> <span class="id">H</span>; <span class="id">eauto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Con_exists_decompDSle">Con_exists_decompDSle</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) <span class="id">a</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">exists</span> <span class="id">t</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">t</span> <span class="id">x</span> /\ <span class="id">s</span> &lt;= <span class="id">t</span>) -&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id">x</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">x</span> <span class="id">a</span> <span class="id">s</span> (<span class="id">t</span>,(<span class="id">H</span>,<span class="id">H1</span>)).<br/>
<span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon">DSleCon</a></span> <span class="kwd">with</span> <span class="id">t</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">DSleCon_exists_decomp</span> <span class="id">Con_exists_decompDSle</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_isCon">DSle_isCon</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span> <span class="id">x</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> <span class="id">x</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> <span class="id">H</span>; <span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon_exists_decomp">DSleCon_exists_decomp</a></span> <span class="id">H</span>); <span class="id">intros</span> <span class="id">b</span> (<span class="id">t</span>,(<span class="id">H1</span>,(<span class="id">H2</span>,<span class="id">H3</span>))); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp_isCon">decomp_isCon</a></span> <span class="id">H1</span>).<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_uncons">DSle_uncons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) <span class="id">a</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; { <span class="id">t</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span> | <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">t</span> <span class="id">x</span> /\ <span class="id">s</span> &lt;= <span class="id">t</span>}.<br/>
<span class="id">intros</span>; <span class="id">case</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#uncons">uncons</a></span> <span class="id">D</span> <span class="id">x</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_isCon">DSle_isCon</a></span> <span class="id">H</span>).<br/>
<span class="id">intros</span> <span class="id">b</span> (<span class="id">t</span>,<span class="id">Hd</span>).<br/>
<span class="kwd">exists</span> <span class="id">t</span>.<br/>
<span class="id">assert</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">b</span> <span class="id">t</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
<span class="id">split</span>; <span class="id">auto</span>.<br/>
<span class="id">assert</span> (<span class="id">a</span>=<span class="id">b</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon_hd">DSleCon_hd</a></span> <span class="kwd">with</span> <span class="id">s</span> <span class="id">t</span>; <span class="id">trivial</span>.<br/>
<span class="id">rewrite</span> <span class="id">H1</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon_tl">DSleCon_tl</a></span> <span class="kwd">with</span> <span class="id">a</span> <span class="id">b</span>; <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_rec">DSle_rec</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">R</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span> -&gt; <span class="kwd">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span>) <span class="id">y</span> -&gt; <span class="id">R</span> <span class="id">x</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span> <span class="id">s</span> <span class="id">y</span>, <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>) <span class="id">y</span> -&gt; <span class="kwd">exists</span> <span class="id">t</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">t</span> <span class="id">y</span> /\ <span class="id">R</span> <span class="id">s</span> <span class="id">t</span>)<br/>
&nbsp;&nbsp;&nbsp;-&gt; <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>, <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">x</span> &lt;= <span class="id">y</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">R</span> <span class="id">REps</span> <span class="id">RCon</span>; <span class="kwd">cofix</span> <span class="id">DSle_rec</span>; <span class="id">destruct</span> <span class="id">x</span>; <span class="id">intros</span>.<br/>
<span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleEps">DSleEps</a></span>; <span class="id">apply</span> <span class="id">DSle_rec</span>; <span class="id">auto</span>.<br/>
<span class="id">case</span> (<span class="id">RCon</span> <span class="id">d</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>); <span class="id">intros</span> <span class="id">u</span> (<span class="id">H1</span>,<span class="id">H2</span>); <span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon">DSleCon</a></span> <span class="kwd">with</span> <span class="id">u</span>; <span class="id">try</span> <span class="id">assumption</span>.<br/>
<span class="id">apply</span> <span class="id">DSle_rec</span>; <span class="id">assumption</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="isEps_Eps">isEps_Eps</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isEps">isEps</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span>).<br/>
<span class="id">repeat</span> <span class="id">red</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="not_isEpsCon">not_isEpsCon</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), ~ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isEps">isEps</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>).<br/>
<span class="id">repeat</span> <span class="id">red</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">isEps_Eps</span> <span class="id">not_isEpsCon</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="isCon_le">isCon_le</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> <span class="id">x</span> -&gt; <span class="id">x</span> &lt;= <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> <span class="id">y</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>; <span class="id">generalize</span> <span class="id">y</span>; <span class="id">induction</span> <span class="id">H</span>; <span class="id">intros</span>.<br/>
<span class="id">inversion_clear</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
<span class="id">inversion_clear</span> <span class="id">H</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp_isCon">decomp_isCon</a></span> <span class="kwd">with</span> <span class="id">a</span> <span class="id">t</span>; <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decomp_eq">decomp_eq</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span> <span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span> -&gt; <span class="kwd">exists</span> <span class="id">t</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">t</span> <span class="id">x</span> /\ <span class="id">s</span>==<span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">assert</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id">x</span>); <span class="id">auto</span>.<br/>
<span class="id">inversion_clear</span> <span class="id">H0</span>.<br/>
<span class="kwd">exists</span> <span class="id">t</span>.<br/>
<span class="id">assert</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">t</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
<span class="id">split</span>; <span class="id">auto</span>.<br/>
<span class="id">split</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon_tl">DSleCon_tl</a></span> <span class="id">H0</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_rec_eq">DSle_rec_eq</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">R</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span> -&gt; <span class="kwd">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">y1</span> <span class="id">y2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>, <span class="id">R</span> <span class="id">x1</span> <span class="id">y1</span> -&gt; <span class="id">x1</span>==<span class="id">x2</span> -&gt; <span class="id">y1</span>==<span class="id">y2</span> -&gt; <span class="id">R</span> <span class="id">x2</span> <span class="id">y2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span> <span class="id">s</span> (<span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>) <span class="id">y</span> -&gt; <span class="kwd">exists</span> <span class="id">t</span>, <span class="id">y</span>==<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">t</span> /\ <span class="id">R</span> <span class="id">s</span> <span class="id">t</span>)<br/>
&nbsp;&nbsp;&nbsp;-&gt; <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>, <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">x</span> &lt;= <span class="id">y</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">R</span> <span class="id">Req</span> <span class="id">RCon</span>; <span class="kwd">cofix</span> <span class="id">DSle_rec_eq</span>; <span class="id">destruct</span> <span class="id">x</span>; <span class="id">intros</span>.<br/>
<span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleEps">DSleEps</a></span>; <span class="id">apply</span> <span class="id">DSle_rec_eq</span>.<br/>
<span class="id">apply</span> <span class="id">Req</span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span>) <span class="id">y</span>; <span class="id">auto</span>.<br/>
<span class="id">case</span> (<span class="id">RCon</span> <span class="id">d</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>); <span class="id">intros</span> <span class="id">u</span> (<span class="id">H1</span>,<span class="id">H2</span>).<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp_eq">decomp_eq</a></span> <span class="id">H1</span>); <span class="id">intros</span> <span class="id">u</span>' (<span class="id">H4</span>,<span class="id">H5</span>).<br/>
<span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon">DSleCon</a></span> <span class="kwd">with</span> <span class="id">u</span>'; <span class="id">try</span> <span class="id">assumption</span>.<br/>
<span class="id">apply</span> <span class="id">DSle_rec_eq</span>.<br/>
<span class="id">apply</span> <span class="id">Req</span> <span class="kwd">with</span> <span class="id">x</span> <span class="id">u</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSeq_rec">DSeq_rec</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">R</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span> -&gt; <span class="kwd">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">y1</span> <span class="id">y2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>, <span class="id">R</span> <span class="id">x1</span> <span class="id">y1</span> -&gt; <span class="id">x1</span>==<span class="id">x2</span> -&gt; <span class="id">y1</span>==<span class="id">y2</span> -&gt; <span class="id">R</span> <span class="id">x2</span> <span class="id">y2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span> <span class="id">s</span> (<span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>) <span class="id">y</span> -&gt; <span class="kwd">exists</span> <span class="id">t</span>, <span class="id">y</span>==<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">t</span> /\ <span class="id">R</span> <span class="id">s</span> <span class="id">t</span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span> <span class="id">s</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), <span class="id">R</span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>) -&gt; <span class="kwd">exists</span> <span class="id">t</span>, <span class="id">x</span>==<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">t</span> /\ <span class="id">R</span> <span class="id">t</span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;-&gt; <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>, <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">x</span> == <span class="id">y</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_rec_eq">DSle_rec_eq</a></span> <span class="kwd">with</span> <span class="id">R</span>; <span class="id">auto</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_rec_eq">DSle_rec_eq</a></span> <span class="kwd">with</span> (<span class="id">R</span>:=<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id">R</span> <span class="id">y</span> <span class="id">x</span>); <span class="id">intros</span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id">H</span> <span class="kwd">with</span> <span class="id">y1</span> <span class="id">x1</span>; <span class="id">auto</span>.<br/>
<span class="id">case</span> (<span class="id">H1</span> <span class="id">a</span> <span class="id">s</span> <span class="id">y0</span> <span class="id">H3</span>); <span class="id">intros</span> <span class="id">t</span> (<span class="id">H4</span>,<span class="id">H5</span>); <span class="kwd">exists</span> <span class="id">t</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<br/>
<h2> Bottom is given by an infinite chain of Eps </h2>
<span class="kwd">CoFixpoint</span> <span class="id"><a name="DS_bot">DS_bot</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> (<span class="id">DS_bot</span> <span class="id">D</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DS_bot_eq">DS_bot_eq</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_bot">DS_bot</a></span> <span class="id">D</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_bot">DS_bot</a></span> <span class="id">D</span>).<br/>
<span class="id">transitivity</span> <span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_bot">DS_bot</a></span> <span class="id">D</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span> | <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span> <span class="kwd">end</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_inv">DS_inv</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_bot">DS_bot</a></span> <span class="id">D</span>)).<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DS_bot_least">DS_bot_least</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_bot">DS_bot</a></span> <span class="id">D</span> &lt;= <span class="id">x</span>.<br/>
<span class="id">intro</span> <span class="id">D</span>; <span class="kwd">cofix</span> <span class="id">DS_bot_least</span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_bot_eq">DS_bot_eq</a></span>; <span class="id">destruct</span> <span class="id">x</span>.<br/>
<span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleEps">DSleEps</a></span>; <span class="id">apply</span> <span class="id">DS_bot_least</span>.<br/>
<span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleEps">DSleEps</a></span>; <span class="id">apply</span> <span class="id">DS_bot_least</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">DS_bot_least</span> : <span class="id">core</span>.<br/>
<br/>
<br/>
<h2> Construction of least upper bounds </h2>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="chain_tl">chain_tl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> (<span class="id">c</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">c</span> <span class="id">H</span>.<br/>
<span class="id">assert</span> (<span class="id">H</span>':<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> (<span class="id">c</span> <span class="id">n</span>)).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon_le">isCon_le</a></span> <span class="kwd">with</span> (<span class="id">c</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
<span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="kwd">let</span> (<span class="id">b</span>,<span class="id">r</span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#uncons">uncons</a></span> (<span class="id">H</span>' <span class="id">n</span>) <span class="kwd">in</span> <span class="kwd">let</span> (<span class="id">t</span>,<span class="id">_</span>) := <span class="id">r</span> <span class="kwd">in</span> <span class="id">t</span>).<br/>
<span class="id">intros</span> <span class="id">n</span> <span class="id">m</span> <span class="id">H1</span>; <span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#uncons">uncons</a></span> (<span class="id">H</span>' <span class="id">n</span>)); <span class="id">intros</span> <span class="id">b</span> (<span class="id">t</span>,<span class="id">hn</span>);<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#uncons">uncons</a></span> (<span class="id">H</span>' <span class="id">m</span>)); <span class="id">intros</span> <span class="id">d</span> (<span class="id">u</span>,<span class="id">hm</span>).<br/>
<span class="id">assert</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">b</span> <span class="id">t</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>)&lt;=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">d</span> <span class="id">u</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">c</span> <span class="id">n</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">c</span> <span class="id">m</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon_tl">DSleCon_tl</a></span> <span class="id">H0</span>).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="chain_uncons">chain_uncons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> (<span class="id">c</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">hd</span>:<span class="id">D</span> &amp; {<span class="id">ctl</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span> | <span class="kwd">forall</span> <span class="id">n</span>, <span class="id">c</span> <span class="id">n</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">hd</span> (<span class="id">ctl</span> <span class="id">n</span>)}}.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">c</span> <span class="id">H</span>; <span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#uncons">uncons</a></span> <span class="id">H</span>); <span class="id">intros</span> <span class="id">hd</span> (<span class="id">tl</span>,<span class="id">H1</span>); <span class="kwd">exists</span> <span class="id">hd</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#chain_tl">chain_tl</a></span> <span class="id">c</span> <span class="id">H</span>); <span class="id">intros</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#chain_tl">chain_tl</a></span>; <span class="id">simpl</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#uncons">uncons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon_le">isCon_le</a></span> <span class="id">H</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_le_compat">fmon_le_compat</a></span> <span class="id">c</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.le_0_l">Nat.le_0_l</a></span> <span class="id">n</span>)))); <span class="id">intros</span>.<br/>
<span class="id">case</span> <span class="id">s</span>; <span class="id">clear</span> <span class="id">s</span>; <span class="id">intros</span> <span class="id">t</span> <span class="id">H2</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">x</span> <span class="id">t</span>); <span class="id">auto</span>.<br/>
<span class="id">assert</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">hd</span> <span class="id">tl</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">x</span> <span class="id">t</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">c</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">c</span> <span class="id">n</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
<span class="id">assert</span> (<span class="id">hd</span>=<span class="id">x</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon_hd">DSleCon_hd</a></span> <span class="kwd">with</span> <span class="id">tl</span> <span class="id">t</span>; <span class="id">trivial</span>.<br/>
<span class="id">rewrite</span> <span class="id">H3</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con_compat">Con_compat</a></span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fCon">fCon</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">hd</span>: <span class="id">D</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">tlc</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">m</span>, <span class="id">m</span> &lt; <span class="id">n</span> /\ <span class="kwd">forall</span> <span class="id">k</span>, <span class="id">c</span> (<span class="id">k</span>+<span class="id">m</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">hd</span> (<span class="id">tlc</span> <span class="id">k</span>)}}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ {<span class="kwd">forall</span> <span class="id">k</span>, <span class="id">k</span>&lt;<span class="id">n</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isEps">isEps</a></span> (<span class="id">c</span> <span class="id">k</span>)}.<br/>
<span class="id">induction</span> <span class="id">n</span>.<br/>
<span class="id">right</span>; <span class="id">intros</span>; <span class="id">absurd</span> (<span class="id">k</span>&lt;0); <span class="id">lia</span>.<br/>
<span class="id">case</span> <span class="id">IHn</span>; <span class="id">clear</span> <span class="id">IHn</span>; <span class="id">intro</span>.<br/>
<span class="id">case</span> <span class="id">s</span>; <span class="id">clear</span> <span class="id">s</span>; <span class="id">intros</span> <span class="id">hdc</span> (<span class="id">tlc</span>,<span class="id">H</span>).<br/>
<span class="id">left</span>; <span class="kwd">exists</span> <span class="id">hdc</span>; <span class="kwd">exists</span> <span class="id">tlc</span>; <span class="id">case</span> <span class="id">H</span>; <span class="id">intro</span> <span class="id">m</span>; <span class="kwd">exists</span> <span class="id">m</span>; <span class="id">intuition</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr_match">DStr_match</a></span> (<span class="id">c</span> <span class="id">n</span>)); <span class="id">intros</span>.<br/>
<span class="id">case</span> <span class="id">s</span>; <span class="id">clear</span> <span class="id">s</span>; <span class="id">intros</span> <span class="id">a</span> (<span class="id">s</span>,<span class="id">H</span>); <span class="id">left</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_left">mseq_lift_left</a></span> <span class="id">c</span> <span class="id">n</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>)).<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_left">mseq_lift_left</a></span>; <span class="id">simpl</span>.<br/>
<span class="id">replace</span> (<span class="id">n</span>+0) <span class="kwd">with</span> <span class="id">n</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>; <span class="id">rewrite</span> <span class="id">H</span>; <span class="id">auto</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#chain_uncons">chain_uncons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_left">mseq_lift_left</a></span> <span class="id">c</span> <span class="id">n</span>) <span class="id">H0</span>); <span class="id">intros</span> <span class="id">hdc</span> (<span class="id">tlc</span>, <span class="id">H1</span>).<br/>
<span class="kwd">exists</span> <span class="id">hdc</span>; <span class="kwd">exists</span> <span class="id">tlc</span>; <span class="kwd">exists</span> <span class="id">n</span>; <span class="id">auto</span>; <span class="id">intuition</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_left">mseq_lift_left</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
<span class="id">replace</span> (<span class="id">k</span>+<span class="id">n</span>) <span class="kwd">with</span> (<span class="id">n</span>+<span class="id">k</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
<span class="id">right</span>; <span class="id">intros</span>.<br/>
<span class="id">assert</span> (<span class="id">H0</span>:(<span class="id">k</span>&lt;<span class="id">n</span> \/ <span class="id">k</span>=<span class="id">n</span>)%<span class="id">nat</span>); <span class="id">try</span> <span class="id">lia</span>.<br/>
<span class="id">case</span> <span class="id">H0</span>; <span class="id">intro</span>; <span class="id">subst</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Defined.
<br/>
<br/>
<h2> Lubs on streams </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="cpred">cpred</a></span> <span class="id">D</span> (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>.<br/>
<span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> (<span class="id">c</span> <span class="id">n</span>)).<br/>
<span class="id">intros</span> <span class="id">n</span> <span class="id">m</span> <span class="id">H</span>; <span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_pred">DSle_pred</a></span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> <span class="id">c</span> <span class="id">H</span>).<br/>
Defined.
<br/>
<br/>
<span class="kwd">CoFixpoint</span> <span class="id"><a name="DS_lubn">DS_lubn</a></span> <span class="id">D</span> (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#fCon">fCon</a></span> <span class="id">c</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#inleft">inleft</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> <span class="id">_</span> <span class="id">hd</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">tlc</span> <span class="id">_</span>)) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">hd</span> (<span class="id">DS_lubn</span> <span class="id">tlc</span> 2)<br/>
&nbsp;&nbsp;&nbsp;|  <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#inright">inright</a></span> <span class="id">_</span>  =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> (<span class="id">DS_lubn</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cpred">cpred</a></span> <span class="id">c</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="DS_lub">DS_lub</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>) (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubn">DS_lubn</a></span> <span class="id">c</span> 2.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DS_lubn_inv">DS_lubn_inv</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubn">DS_lubn</a></span> <span class="id">c</span> <span class="id">n</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#fCon">fCon</a></span> <span class="id">c</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#inleft">inleft</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> <span class="id">_</span> <span class="id">hd</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">tlc</span> <span class="id">_</span>)) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">hd</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">tlc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#inright">inright</a></span> <span class="id">_</span>  =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubn">DS_lubn</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cpred">cpred</a></span> <span class="id">c</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<span class="id">intros</span>; <span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_inv">DS_inv</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubn">DS_lubn</a></span> <span class="id">c</span> <span class="id">n</span>)).<br/>
<span class="id">simpl</span>; <span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#fCon">fCon</a></span> <span class="id">c</span> <span class="id">n</span>); <span class="id">trivial</span>.<br/>
<span class="id">destruct</span> <span class="id">s</span>; <span class="id">simpl</span>.<br/>
<span class="id">destruct</span> <span class="id">s</span>; <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DS_lubn_pred_nth">DS_lubn_pred_nth</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>)  <span class="id">n</span> <span class="id">k</span> <span class="id">p</span> (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;(<span class="id">n</span>&lt;<span class="id">k</span>+<span class="id">p</span>)%<span class="id">nat</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth">pred_nth</a></span> (<span class="id">c</span> <span class="id">n</span>) <span class="id">k</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">d</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubn">DS_lubn</a></span> <span class="id">c</span> <span class="id">p</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">d</span>) /\ (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id">d</span> <span class="id">n</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">a</span> <span class="id">s</span> <span class="id">n</span> <span class="id">k</span>; <span class="id">pattern</span> <span class="id">k</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Wf_nat.html#lt_wf_ind">Wf_nat.lt_wf_ind</a></span>; <span class="id">intros</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubn_inv">DS_lubn_inv</a></span> <span class="id">c</span> <span class="id">p</span>).<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#fCon">fCon</a></span> <span class="id">c</span> <span class="id">p</span>); <span class="id">intros</span>.<br/>
<span class="id">case</span> <span class="id">s0</span>; <span class="id">clear</span> <span class="id">s0</span>; <span class="id">intros</span> <span class="id">hd</span> (<span class="id">tlc</span>,(<span class="id">m</span>,(<span class="id">H2</span>,<span class="id">H3</span>))).<br/>
<span class="id">assert</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">hd</span> (<span class="id">tlc</span> <span class="id">n</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">c</span> (<span class="id">n</span>+<span class="id">m</span>)); <span class="id">auto</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id">H1</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">c</span> <span class="id">n</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
<span class="kwd">exists</span> <span class="id">tlc</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
<span class="id">assert</span> (<span class="id">Heq</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon_hd">DSleCon_hd</a></span> <span class="id">H4</span>).<br/>
<span class="id">rewrite</span> <span class="id">Heq</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con_compat">Con_compat</a></span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon_tl">DSleCon_tl</a></span> <span class="kwd">with</span> <span class="id">a</span> <span class="id">hd</span>; <span class="id">auto</span>.<br/>
<span class="id">destruct</span> <span class="id">n0</span>; <span class="id">simpl</span> <span class="id">pred_nth</span> <span class="kwd">in</span> *|-*.<br/>
<span class="id">absurd</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isEps">isEps</a></span> (<span class="id">c</span> <span class="id">n</span>)); <span class="id">auto</span>.<br/>
<span class="id">rewrite</span> <span class="id">H1</span>; <span class="id">auto</span>.<br/>
<span class="id">case</span> (<span class="id">H</span> <span class="id">n0</span>) <span class="kwd">with</span>  (<span class="id">p</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">p</span>) (<span class="id">c</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cpred">cpred</a></span> <span class="id">c</span>); <span class="id">auto</span>; <span class="id">try</span> <span class="id">lia</span>.<br/>
<span class="id">intros</span> <span class="id">d</span> (<span class="id">H2</span>,<span class="id">H3</span>); <span class="kwd">exists</span> <span class="id">d</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubn">DS_lubn</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cpred">cpred</a></span> <span class="id">c</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">p</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DS_lubn_pred_nth_inv">DS_lubn_pred_nth_inv</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) <span class="id">k</span> <span class="id">p</span> (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth">pred_nth</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubn">DS_lubn</a></span> <span class="id">c</span> <span class="id">p</span>) <span class="id">k</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">tlc</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>, <span class="id">s</span>= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">tlc</span> /\ <span class="kwd">exists</span> <span class="id">m</span>, <span class="kwd">forall</span> <span class="id">l</span>, <span class="id">c</span> (<span class="id">l</span>+<span class="id">m</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> (<span class="id">tlc</span> <span class="id">l</span>).<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">a</span> <span class="id">s</span> <span class="id">k</span>; <span class="id">pattern</span> <span class="id">k</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Wf_nat.html#lt_wf_ind">Wf_nat.lt_wf_ind</a></span>; <span class="id">clear</span> <span class="id">k</span>; <span class="id">intros</span> <span class="id">n</span> <span class="id">IH</span> <span class="id">p</span> <span class="id">c</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubn_inv">DS_lubn_inv</a></span> <span class="id">c</span> <span class="id">p</span>).<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#fCon">fCon</a></span> <span class="id">c</span> <span class="id">p</span>).<br/>
<span class="id">intros</span> (<span class="id">hdc</span>,(<span class="id">tlc</span>,(<span class="id">m</span>,(<span class="id">H2</span>,<span class="id">H3</span>)))) <span class="id">H</span>.<br/>
<span class="kwd">exists</span> <span class="id">tlc</span>.<br/>
<span class="id">assert</span> (<span class="id">Heq</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">hdc</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">tlc</span>)=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>).<br/>
<span class="id">transitivity</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth">pred_nth</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">hdc</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">tlc</span>)) <span class="id">n</span>); <span class="id">auto</span>.<br/>
<span class="id">injection</span> <span class="id">Heq</span>; <span class="id">auto</span>.<br/>
<span class="id">intros</span>; <span class="id">subst</span>; <span class="id">repeat</span> <span class="id">split</span>; <span class="id">auto</span>.<br/>
<span class="kwd">exists</span> <span class="id">m</span>; <span class="id">auto</span>.<br/>
<span class="id">destruct</span> <span class="id">n</span>; <span class="id">simpl</span> <span class="id">pred_nth</span>; <span class="id">intros</span>.<br/>
<span class="id">discriminate</span> <span class="id">H</span>.<br/>
<span class="id">case</span> (<span class="id">IH</span> <span class="id">n</span>) <span class="kwd">with</span> (<span class="id">p</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">p</span>) (<span class="id">c</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cpred">cpred</a></span> <span class="id">c</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">arith</span>; <span class="id">clear</span> <span class="id">IH</span>.<br/>
<span class="id">intros</span> <span class="id">tlc</span> (<span class="id">H1</span>,(<span class="id">m</span>,<span class="id">H3</span>)).<br/>
<span class="kwd">exists</span> <span class="id">tlc</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
<span class="kwd">exists</span> <span class="id">m</span>; <span class="id">intro</span> <span class="id">l</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cpred">cpred</a></span> <span class="id">c</span> (<span class="id">l</span> + <span class="id">m</span>)); <span class="id">auto</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cpred">cpred</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DS_lubCon_inv">DS_lubCon_inv</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">c</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">tlc</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span>==<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">tlc</span>  /\ <span class="kwd">exists</span> <span class="id">m</span>, <span class="kwd">forall</span> <span class="id">l</span>, <span class="id">c</span> (<span class="id">l</span>+<span class="id">m</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> (<span class="id">tlc</span> <span class="id">l</span>).<br/>
<span class="id">intros</span>; <span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp_eq">decomp_eq</a></span> <span class="id">H</span>); <span class="id">intros</span> <span class="id">t</span> (<span class="id">H1</span>,<span class="id">H2</span>).<br/>
<span class="id">case</span> <span class="id">H1</span>; <span class="id">intros</span> <span class="id">k</span> <span class="id">H4</span>.<br/>
<span class="id">case</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubn_pred_nth_inv">DS_lubn_pred_nth_inv</a></span> <span class="id">D</span> <span class="id">a</span> <span class="id">t</span> <span class="id">k</span> 2 <span class="id">c</span> <span class="id">H4</span>); <span class="id">intros</span> <span class="id">tlc</span> (<span class="id">H5</span>,(<span class="id">m</span>,<span class="id">H7</span>)).<br/>
<span class="kwd">exists</span> <span class="id">tlc</span>; <span class="id">split</span>; <span class="id">subst</span>; <span class="id">auto</span>.<br/>
<span class="kwd">exists</span> <span class="id">m</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> (<span class="id">tlc</span> <span class="id">l</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DS_lubCon">DS_lubCon</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> <span class="id">s</span> <span class="id">n</span> (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id">c</span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">d</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">c</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">d</span>)  /\ (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id">d</span> <span class="id">n</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">a</span> <span class="id">s</span> <span class="id">n</span> <span class="id">c</span> <span class="id">H</span>; <span class="id">inversion_clear</span> <span class="id">H</span>.<br/>
<span class="id">case</span> <span class="id">H0</span>; <span class="id">intros</span> <span class="id">k</span> <span class="id">H3</span>.<br/>
<span class="id">case</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubn_pred_nth">DS_lubn_pred_nth</a></span> <span class="id">D</span> <span class="id">a</span> <span class="id">t</span> <span class="id">n</span> (<span class="id">n</span>+<span class="id">k</span>) 2 <span class="id">c</span>); <span class="id">auto</span>; <span class="id">try</span> <span class="id">lia</span>.<br/>
<span class="id">pattern</span> <span class="id">n</span> <span class="kwd">at</span> 2; <span class="id">elim</span> <span class="id">n</span>; <span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred_nth">pred_nth</a></span> (<span class="id">c</span> <span class="id">n</span>) (<span class="id">n0</span> + <span class="id">k</span>))); <span class="id">auto</span>.<br/>
<span class="id">rewrite</span> <span class="id">H</span>; <span class="id">auto</span>.<br/>
<span class="id">intros</span> <span class="id">d</span> (<span class="id">H4</span>,<span class="id">H5</span>).<br/>
<span class="kwd">exists</span> <span class="id">d</span>; <span class="id">split</span>; <span class="id">eauto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DS_lub_upper">DS_lub_upper</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>), <span class="kwd">forall</span> <span class="id">n</span>, <span class="id">c</span> <span class="id">n</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">c</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_rec_eq">DSle_rec_eq</a></span><br/>
&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">R</span>:= <span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span> =&gt;<span class="kwd">exists</span> <span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>, <span class="id">x</span>&lt;=<span class="id">c</span> <span class="id">n</span> /\ <span class="id">y</span>==<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">c</span>); <span class="id">intuition</span>.<br/>
<span class="id">clear</span> <span class="id">c</span>; <span class="id">case</span> <span class="id">H</span>; <span class="id">intros</span> <span class="id">c</span> (<span class="id">H2</span>,<span class="id">H3</span>); <span class="kwd">exists</span> <span class="id">c</span>; <span class="id">split</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">x1</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> <span class="id">y1</span>; <span class="id">auto</span>.<br/>
<span class="id">clear</span> <span class="id">c</span>; <span class="id">case</span> <span class="id">H</span>; <span class="id">clear</span> <span class="id">H</span>; <span class="id">intros</span> <span class="id">c</span> (<span class="id">H1</span>,<span class="id">H2</span>).<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubCon">DS_lubCon</a></span> <span class="id">n</span> <span class="id">c</span> <span class="id">H1</span>); <span class="id">intros</span> <span class="id">d</span> (<span class="id">H3</span>,<span class="id">H4</span>).<br/>
<span class="id">assert</span> (<span class="id">H6</span>:(<span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>)==<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">d</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">c</span>); <span class="id">trivial</span>.<br/>
<span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">d</span>); <span class="id">split</span>; <span class="id">auto</span>.<br/>
<span class="kwd">exists</span> <span class="id">d</span>; <span class="id">auto</span>.<br/>
<span class="kwd">exists</span> <span class="id">c</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DS_lub_least">DS_lub_least</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">c</span> <span class="id">n</span> &lt;= <span class="id">x</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">c</span> &lt;= <span class="id">x</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_rec_eq">DSle_rec_eq</a></span><br/>
&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">R</span>:= <span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>=&gt;<span class="kwd">exists</span> <span class="id">c</span>, <span class="id">x</span>==<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">c</span> /\ <span class="kwd">forall</span> <span class="id">n</span>, <span class="id">c</span> <span class="id">n</span> &lt;= <span class="id">y</span>); <span class="id">intros</span>.<br/>
<span class="id">case</span> <span class="id">H0</span>; <span class="id">intros</span> <span class="id">d</span> (<span class="id">H3</span>,<span class="id">H4</span>); <span class="kwd">exists</span> <span class="id">d</span>; <span class="id">split</span>; <span class="id">eauto</span>.<br/>
<span class="id">case</span> <span class="id">H0</span>; <span class="id">intros</span> <span class="id">d</span> (<span class="id">H3</span>,<span class="id">H4</span>).<br/>
<span class="id">assert</span> (<span class="id">H5</span>:(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> <span class="id">d</span>); <span class="id">auto</span>.<br/>
<span class="id">inversion_clear</span> <span class="id">H5</span>.<br/>
<span class="id">case</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubCon_inv">DS_lubCon_inv</a></span> <span class="id">D</span> <span class="id">a</span> <span class="id">s</span> <span class="id">d</span>); <span class="id">auto</span>; <span class="id">intros</span> <span class="id">tlc</span> (<span class="id">H7</span>,(<span class="id">m</span>,<span class="id">H9</span>)).<br/>
<span class="id">assert</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> (<span class="id">tlc</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>) :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id">y</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">d</span> (0+<span class="id">m</span>)); <span class="id">auto</span>.<br/>
<span class="id">inversion_clear</span> <span class="id">H5</span>.<br/>
<span class="id">assert</span> (<span class="id">y</span>==<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">t0</span>); <span class="id">auto</span>.<br/>
<span class="kwd">exists</span> <span class="id">t0</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">l</span>, (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> (<span class="id">tlc</span> <span class="id">l</span>): <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">t0</span>).<br/>
<span class="id">intro</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">d</span> (<span class="id">l</span>+<span class="id">m</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">y</span>; <span class="id">auto</span>.<br/>
<span class="kwd">exists</span> <span class="id">tlc</span>; <span class="id">split</span>; <span class="id">auto</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon_tl">DSleCon_tl</a></span> <span class="kwd">with</span> <span class="id">a</span> <span class="id">a</span>; <span class="id">auto</span>.<br/>
<span class="kwd">exists</span> <span class="id">c</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<h2> Definition of the cpo of streams </h2>
<span class="kwd">Definition</span> <span class="id"><a name="DS">DS</a></span> : <span class="kwd">Type</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#cpo">cpo</a></span>.<br/>
<span class="id">intro</span> <span class="id">D</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_bot">DS_bot</a></span> <span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub">DS_lub</a></span> (<span class="id">D</span>:=<span class="id">D</span>)); <span class="id">auto</span>.<br/>
<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub_upper">DS_lub_upper</a></span> (<span class="id">D</span>:=<span class="id">D</span>)).<br/>
<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lub_least">DS_lub_least</a></span> (<span class="id">D</span>:=<span class="id">D</span>)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DS_lub_inv">DS_lub_inv</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">c</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#fCon">fCon</a></span> <span class="id">c</span> 2 <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#inleft">inleft</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> <span class="id">_</span> <span class="id">hd</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">tlc</span> <span class="id">_</span>)) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">hd</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) <span class="id">tlc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#inright">inright</a></span> <span class="id">_</span>  =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubn">DS_lubn</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cpred">cpred</a></span> <span class="id">c</span>) 3)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">c</span>; <span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubn_inv">DS_lubn_inv</a></span> <span class="id">c</span> 2).<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="cons">cons</a></span> <span class="id">D</span> (<span class="id">a</span> : <span class="id">D</span>) (<span class="id">s</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cons_le_compat">cons_le_compat</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id">a</span> = <span class="id">b</span> -&gt; <span class="id">s</span> &lt;= <span class="id">t</span> -&gt;  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">b</span> <span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span>; <span class="id">rewrite</span> <span class="id">H</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon0">DSleCon0</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">cons_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cons_eq_compat">cons_eq_compat</a></span> :<br/>
&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id">a</span> = <span class="id">b</span> -&gt; <span class="id">s</span> == <span class="id">t</span> -&gt;  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">b</span> <span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">cons_eq_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">D</span> : (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">D</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) ==&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) <span class="kwd">as</span> <span class="id">cons_eq_compat_morph</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons_eq_compat">cons_eq_compat</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="not_le_consBot">not_le_consBot</a></span>: <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), ~ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span> &lt;= 0.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">a</span> <span class="id">s</span> <span class="id">H</span>.<br/>
<span class="id">inversion_clear</span> <span class="id">H</span>.<br/>
<span class="id">case</span> <span class="id">H0</span>; <span class="id">intros</span>.<br/>
<span class="id">induction</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_bot_eq">DS_bot_eq</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
<span class="id">discriminate</span> <span class="id">H</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">not_le_consBot</span> : <span class="id">core</span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_intro_cons">DSle_intro_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), (<span class="kwd">forall</span> <span class="id">a</span> <span class="id">s</span>, <span class="id">x</span>==<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span> &lt;= <span class="id">y</span>) -&gt; <span class="id">x</span> &lt;= <span class="id">y</span>.<br/>
<span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_rec_eq">DSle_rec_eq</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span>:= <span class="kwd">fun</span> (<span class="id">x</span> <span class="id">y</span> :<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) =&gt; <span class="kwd">forall</span> <span class="id">a</span> <span class="id">s</span>, <span class="id">x</span>==<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span> &lt;= <span class="id">y</span>); <span class="id">auto</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">y1</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id">H0</span> <span class="id">a</span> <span class="id">s</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> <span class="id">x2</span>; <span class="id">auto</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span> &lt;= <span class="id">y0</span>); <span class="id">eauto</span>.<br/>
<span class="id">inversion_clear</span> <span class="id">H1</span>.<br/>
<span class="kwd">exists</span> <span class="id">t</span>; <span class="id">split</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">s</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="is_cons">is_cons</a></span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon">isCon</a></span> <span class="id">x</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_intro">is_cons_intro</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">a</span>:<span class="id">D</span>) (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>).<br/>
<span class="id">red</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">is_cons_intro</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_elim">is_cons_elim</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span> -&gt; <span class="kwd">exists</span> <span class="id">a</span>, <span class="kwd">exists</span> <span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>, <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>.<br/>
<span class="id">intros</span>; <span class="id">elim</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#uncons">uncons</a></span> <span class="id">H</span>); <span class="id">intros</span> <span class="id">a</span> (<span class="id">s</span>,<span class="id">H1</span>).<br/>
<span class="kwd">exists</span> <span class="id">a</span>; <span class="kwd">exists</span> <span class="id">s</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="not_is_consBot">not_is_consBot</a></span> : <span class="kwd">forall</span> <span class="id">D</span>, ~ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (0:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">H</span>); <span class="id">intros</span> <span class="id">a</span> (<span class="id">s</span>,<span class="id">Heq</span>).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#not_le_consBot">not_le_consBot</a></span> (<span class="id">a</span>:=<span class="id">a</span>) (<span class="id">s</span>:=<span class="id">s</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">not_is_consBot</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_le_compat">is_cons_le_compat</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id">x</span> &lt;= <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">y</span>.<br/>
<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span>; <span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isCon_le">isCon_le</a></span> <span class="kwd">with</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_eq_compat">is_cons_eq_compat</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id">x</span> == <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">y</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_le_compat">is_cons_le_compat</a></span> <span class="kwd">with</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_intro_is_cons">DSle_intro_is_cons</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span> -&gt; <span class="id">x</span> &lt;= <span class="id">y</span>) -&gt; <span class="id">x</span> &lt;= <span class="id">y</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_intro_cons">DSle_intro_cons</a></span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id">H</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_eq_compat">is_cons_eq_compat</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSeq_intro_is_cons">DSeq_intro_is_cons</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span> -&gt; <span class="id">x</span> &lt;= <span class="id">y</span>) -&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">y</span> -&gt; <span class="id">y</span> &lt;= <span class="id">x</span>) -&gt; <span class="id">x</span> == <span class="id">y</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_intro_is_cons">DSle_intro_is_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">D</span> : (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">D</span>)<br/>
<span class="kwd">with</span> <span class="id">signature</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span> <span class="kwd">as</span> <span class="id">is_cons_eq_iff</span>.<br/>
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span>; <span class="id">split</span>; <span class="id">intro</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_eq_compat">is_cons_eq_compat</a></span> <span class="kwd">with</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_eq_compat">is_cons_eq_compat</a></span> <span class="kwd">with</span> <span class="id">y</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">D</span> : (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">D</span>)<br/>
<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) ++&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) <span class="kwd">as</span> <span class="id">cons_le_morph</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons_le_compat">cons_le_compat</a></span> (<span class="id">D</span>:=<span class="id">D</span>)); <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">cons_le_morph</span> : <span class="id">core</span>.<br/>
<br/>
<h2> Basic functions </h2>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Simple_functions">Simple_functions</a></span>.<br/>
<br/>
<h3> Build a function F such that F (Con a s) = f a s and F (Eps x) = Eps (F x) </h3>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Simple_functions.D">D</a></span> <span class="id">D</span>': <span class="kwd">Type</span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Simple_functions.f">f</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>'.<br/>
<br/>
<span class="kwd">CoFixpoint</span> <span class="id"><a name="DScase">DScase</a></span>  (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>':=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">s</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> (<span class="id">DScase</span> <span class="id">x</span>) | <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">l</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">a</span> <span class="id">l</span> <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScase_inv">DScase_inv</a></span> :<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">s</span> = <span class="kwd">match</span> <span class="id">s</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">l</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">l</span>)  | <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">l</span> =&gt;  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">a</span> <span class="id">l</span> <span class="kwd">end</span>.<br/>
<span class="id">intros</span>; <span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_inv">DS_inv</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">s</span>)); <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScaseEps">DScaseEps</a></span> : <span class="kwd">forall</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">s</span>) = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">s</span>).<br/>
<span class="id">intros</span>; <span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_inv">DScase_inv</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">s</span>)); <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScase_cons">DScase_cons</a></span> : <span class="kwd">forall</span> <span class="id">a</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>) = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">a</span> <span class="id">s</span>.<br/>
<span class="id">intros</span>; <span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_inv">DScase_inv</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>)); <span class="id">trivial</span>.<br/>
Qed.
<br/>
<span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">DScaseEps</span> <span class="id">DScase_cons</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScase_decomp">DScase_decomp</a></span> : <span class="kwd">forall</span> <span class="id">a</span> (<span class="id">s</span> <span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> -&gt;  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">a</span> <span class="id">s</span>.<br/>
<span class="id">intros</span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> <span class="id">Hd</span>.<br/>
<span class="id">pattern</span> <span class="id">x</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp_ind">decomp_ind</a></span> <span class="kwd">with</span> (3:=<span class="id">Hd</span>); <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScaseEps">DScaseEps</a></span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">x0</span>); <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScase_eq_cons">DScase_eq_cons</a></span> : <span class="kwd">forall</span> <span class="id">a</span> (<span class="id">s</span> <span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>), <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">a</span> <span class="id">s</span>.<br/>
<span class="id">intros</span>; <span class="id">elim</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp_eq">decomp_eq</a></span> <span class="id">H</span>); <span class="id">intros</span> <span class="id">t</span> (<span class="id">H1</span>,<span class="id">H2</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">a</span> <span class="id">t</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_decomp">DScase_decomp</a></span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_stable">fmon_stable</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">a</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">DScase_eq_cons</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScase_bot">DScase_bot</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> 0 &lt;= 0.<br/>
<span class="kwd">cofix</span> <span class="id">DScase_bot</span>; <span class="id">simpl</span>.<br/>
<span class="id">pattern</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_bot">DS_bot</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>) <span class="kwd">at</span> 1; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_bot_eq">DS_bot_eq</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScaseEps">DScaseEps</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleEps">DSleEps</a></span>; <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScase_le_cons">DScase_le_cons</a></span> : <span class="kwd">forall</span> <span class="id">a</span> (<span class="id">s</span> <span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span> &lt;= <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">a</span> <span class="id">s</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">x</span>.<br/>
<span class="id">intros</span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> <span class="id">H</span>; <span class="id">inversion</span> <span class="id">H</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">a</span> <span class="id">t</span>).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">a</span>)); <span class="id">auto</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_decomp">DScase_decomp</a></span> <span class="id">H2</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScase_le_compat">DScase_le_compat</a></span> : <span class="kwd">forall</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>), <span class="id">s</span> &lt;= <span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">s</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">t</span>.<br/>
<span class="kwd">cofix</span> <span class="id">DScase_le_compat</span>.<br/>
<span class="id">intros</span> <span class="id">s</span> <span class="id">t</span> <span class="id">H</span>; <span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_inv">DScase_inv</a></span> <span class="id">s</span>); <span class="id">case</span> <span class="id">H</span>; <span class="id">intros</span>.<br/>
<span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleEps">DSleEps</a></span>.<br/>
<span class="id">apply</span> <span class="id">DScase_le_compat</span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">a</span> <span class="id">t0</span>); <span class="id">auto</span>.<br/>
<span class="id">pattern</span> <span class="id">y</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp_ind">decomp_ind</a></span> <span class="kwd">with</span> (3:=<span class="id">H0</span>); <span class="id">auto</span>; <span class="id">intros</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScaseEps">DScaseEps</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">x</span>).<br/>
<span class="id">exact</span> <span class="id">H2</span>.<br/>
<span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleEps_right">DSleEps_right</a></span>.<br/>
<span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_refl">DSle_refl</a></span>.<br/>
Qed.
<br/>
<span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">DScase_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScase_eq_compat">DScase_eq_compat</a></span> : <span class="kwd">forall</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>), <span class="id">s</span> == <span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">s</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">DScase_eq_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span><br/>
<span class="kwd">with</span> <span class="id">signature</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>)) ==&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>')) <span class="kwd">as</span> <span class="id">DScase_eq_compat_morph</span>.<br/>
<span class="id">exact</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_eq_compat">DScase_eq_compat</a></span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="DSCase">DSCase</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>'.<br/>
<span class="kwd">exists</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span>; <span class="id">red</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSCase_simpl">DSCase_simpl</a></span> : <span class="kwd">forall</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCase">DSCase</a></span> <span class="id">s</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">s</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScase_decomp_elim">DScase_decomp_elim</a></span> : <span class="kwd">forall</span> <span class="id">a</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>') (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>),<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">x</span>) -&gt; <span class="kwd">exists</span> <span class="id">b</span>, <span class="kwd">exists</span> <span class="id">t</span>, <span class="id">x</span>==<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">b</span> <span class="id">t</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">b</span> <span class="id">t</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>.<br/>
<span class="id">intros</span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> <span class="id">H</span>; <span class="id">case</span> <span class="id">H</span>; <span class="id">clear</span> <span class="id">H</span>.<br/>
<span class="id">intro</span> <span class="id">k</span>; <span class="id">generalize</span> <span class="id">x</span>; <span class="id">clear</span> <span class="id">x</span>; <span class="id">pattern</span> <span class="id">k</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Wf_nat.html#lt_wf_ind">Wf_nat.lt_wf_ind</a></span>; <span class="id">intros</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_inv">DScase_inv</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">destruct</span> <span class="id">x</span>.<br/>
<span class="id">destruct</span> <span class="id">n</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
<span class="id">discriminate</span> <span class="id">H0</span>.<br/>
<span class="id">case</span> (<span class="id">H</span> <span class="id">n</span>) <span class="kwd">with</span> (2:=<span class="id">H0</span>); <span class="id">auto</span>.<br/>
<span class="id">intros</span> <span class="id">b</span> (<span class="id">t</span>,(<span class="id">H1</span>,<span class="id">H2</span>)).<br/>
<span class="kwd">exists</span> <span class="id">b</span>; <span class="kwd">exists</span> <span class="id">t</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_sym">Oeq_sym</a></span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#eqEps">eqEps</a></span> <span class="id">x</span>).<br/>
<span class="kwd">exists</span> <span class="id">d</span>; <span class="kwd">exists</span> <span class="id">x</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id">H0</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScase_eq_cons_elim">DScase_eq_cons_elim</a></span> : <span class="kwd">forall</span> <span class="id">a</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>') (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>),<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span> -&gt; <span class="kwd">exists</span> <span class="id">b</span>, <span class="kwd">exists</span> <span class="id">t</span>, <span class="id">x</span>==<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">b</span> <span class="id">t</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">b</span> <span class="id">t</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>.<br/>
<span class="id">intros</span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span> <span class="id">H</span>; <span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp_eq">decomp_eq</a></span> <span class="id">H</span>); <span class="id">intros</span> <span class="id">t</span> (<span class="id">H1</span>,<span class="id">H2</span>).<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_decomp_elim">DScase_decomp_elim</a></span> <span class="id">x</span> <span class="id">H1</span>); <span class="id">intros</span> <span class="id">c</span> (<span class="id">u</span>,(<span class="id">H4</span>,<span class="id">H5</span>)).<br/>
<span class="kwd">exists</span> <span class="id">c</span>; <span class="kwd">exists</span> <span class="id">u</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">t</span>); <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScase_is_cons">DScase_is_cons</a></span> : <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">x</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span>.<br/>
<span class="id">intros</span>; <span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">H</span>); <span class="id">intros</span> <span class="id">a</span> (<span class="id">s</span>,<span class="id">H1</span>).<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_eq_cons_elim">DScase_eq_cons_elim</a></span> <span class="id">x</span> <span class="id">H1</span>); <span class="id">intros</span> <span class="id">b</span> (<span class="id">t</span>,(<span class="id">H2</span>,<span class="id">H3</span>)).<br/>
<span class="id">red</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_isCon">DSle_isCon</a></span> <span class="kwd">with</span> <span class="id">b</span> <span class="id">t</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_DScase">is_cons_DScase</a></span> : (<span class="kwd">forall</span> <span class="id">a</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">a</span> <span class="id">s</span>)) -&gt; <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">x</span>).<br/>
<span class="id">intros</span>; <span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">H0</span>); <span class="id">intros</span> <span class="id">a</span> (<span class="id">s</span>,<span class="id">H1</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_eq_compat">is_cons_eq_compat</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">a</span> <span class="id">s</span>); <span class="id">auto</span>.<br/>
<span class="id">rewrite</span> <span class="id">H1</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Simple_functions.fcont">fcont</a></span> : <span class="kwd">forall</span> <span class="id">c</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">c</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScase_cont">DScase_cont</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCase">DSCase</a></span>.<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCase_simpl">DSCase_simpl</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_intro_cons">DSle_intro_cons</a></span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_eq_cons_elim">DScase_eq_cons_elim</a></span> (<span class="id">a</span>:=<span class="id">a</span>) (<span class="id">s</span>:=<span class="id">s</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>)); <span class="id">auto</span>; <span class="id">intros</span> <span class="id">b</span> (<span class="id">t</span>,(<span class="id">H3</span>,<span class="id">H4</span>)).<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubCon_inv">DS_lubCon_inv</a></span> <span class="id">h</span> <span class="id">H3</span>).<br/>
<span class="id">intros</span> <span class="id">tlc</span> (<span class="id">H5</span>,(<span class="id">m</span>,<span class="id">H6</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">b</span> <span class="id">t</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">b</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>) <span class="id">tlc</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.f">f</a></span> <span class="id">b</span> @ <span class="id">tlc</span>)); <span class="id">auto</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_lift_right">lub_lift_right</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCase">DSCase</a></span> @ <span class="id">h</span>) <span class="id">m</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span> (<span class="id">D</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>')).<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_right">mseq_lift_right</a></span>; <span class="id">simpl</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_le_cons">DScase_le_cons</a></span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">DScase_cont</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScase_cont_eq">DScase_cont_eq</a></span> : <span class="kwd">forall</span> (<span class="id">c</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span>-<span class="id">m</span>&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions.D">D</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">c</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCase">DSCase</a></span> @ <span class="id">c</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_comp_eq">lub_comp_eq</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCase">DSCase</a></span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Simple_functions">Simple_functions</a></span>.<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">DScaseEps</span> <span class="id">DScase_cons</span> <span class="id">DScase_le_compat</span> <span class="id">DScase_eq_compat</span> <span class="id">DScase_bot</span> <span class="id">DScase_cont</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="DSCASE_mon">DSCASE_mon</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">D</span>', (<span class="id">D</span>-<span class="id">O</span>-&gt;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">M</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>')) -<span class="id">M</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">M</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>'.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">D</span>'; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCase">DSCase</a></span> (<span class="id">D</span>:=<span class="id">D</span>)(<span class="id">D</span>':=<span class="id">D</span>')); <span class="id">red</span>; <span class="id">intros</span> <span class="id">f</span> <span class="id">g</span> <span class="id">Hle</span>; <span class="id">intro</span> <span class="id">s</span>.<br/>
<span class="id">repeat</span> (<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCase_simpl">DSCase_simpl</a></span>).<br/>
<span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_intro_cons">DSle_intro_cons</a></span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_eq_cons_elim">DScase_eq_cons_elim</a></span> <span class="id">f</span> (<span class="id">a</span>:=<span class="id">a</span>) (<span class="id">s</span>:=<span class="id">s0</span>) <span class="id">s</span>); <span class="id">auto</span>; <span class="id">intros</span> <span class="id">b</span> (<span class="id">t</span>,(<span class="id">Hs</span>,<span class="id">Hf</span>)).<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">g</span> <span class="id">s</span> == <span class="id">g</span> <span class="id">b</span> <span class="id">t</span>).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_eq_cons">DScase_eq_cons</a></span> <span class="id">g</span> <span class="id">Hs</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> <span class="id">b</span> <span class="id">t</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">g</span> <span class="id">b</span> <span class="id">t</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSCASE_mon_simpl">DSCASE_mon_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">D</span>' <span class="id">f</span> <span class="id">s</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_mon">DSCASE_mon</a></span> <span class="id">D</span> <span class="id">D</span>' <span class="id">f</span> <span class="id">s</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">f</span> <span class="id">s</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSCASE_mon_cont">DSCASE_mon_cont</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">D</span>', <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_mon">DSCASE_mon</a></span> <span class="id">D</span> <span class="id">D</span>').<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">intro</span> <span class="id">s</span>; <span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_mon_simpl">DSCASE_mon_simpl</a></span> (<span class="id">D</span>:=<span class="id">D</span>) (<span class="id">D</span>':=<span class="id">D</span>')).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_intro_cons">DSle_intro_cons</a></span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_eq_cons_elim">DScase_eq_cons_elim</a></span>  (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) (<span class="id">a</span>:=<span class="id">a</span>) (<span class="id">s</span>:=<span class="id">s0</span>) <span class="id">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span>; <span class="id">intros</span> <span class="id">b</span> (<span class="id">t</span>,(<span class="id">Hs</span>,<span class="id">Hf</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_lub_simpl">fmon_lub_simpl</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> ((<span class="id">h</span> &lt;<span class="id">o</span>&gt; <span class="id">b</span>) &lt;<span class="id">_</span>&gt; <span class="id">t</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span> (<span class="id">D</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>')); <span class="id">intro</span> <span class="id">n</span>.<br/>
<span class="id">repeat</span> (<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_app_simpl">fmon_app_simpl</a></span>); <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_simpl">fmon_comp_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_mon_simpl">DSCASE_mon_simpl</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_eq_cons">DScase_eq_cons</a></span> (<span class="id">h</span> <span class="id">n</span>) <span class="id">Hs</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="DSCASE_cont">DSCASE_cont</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">D</span>', (<span class="id">D</span>-<span class="id">O</span>-&gt;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>')) -<span class="id">m</span>&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>').<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">D</span>'.<br/>
<span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">f</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mk_fconti">mk_fconti</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cont">DScase_cont</a></span> (<span class="id">D</span>:=<span class="id">D</span>) (<span class="id">D</span>':=<span class="id">D</span>') (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id">f</span> <span class="id">a</span>)) (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontinuous">fcontinuous</a></span> (<span class="id">f</span> <span class="id">a</span>)))).<br/>
<span class="id">intros</span> <span class="id">f</span> <span class="id">g</span> <span class="id">Hle</span>; <span class="id">intro</span> <span class="id">s</span>;<span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_intro_cons">DSle_intro_cons</a></span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_eq_cons_elim">DScase_eq_cons_elim</a></span> (<span class="kwd">fun</span> <span class="id">a</span> : <span class="id">D</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id">f</span> <span class="id">a</span>)) (<span class="id">a</span>:=<span class="id">a</span>) (<span class="id">s</span>:=<span class="id">s0</span>) <span class="id">s</span>); <span class="id">auto</span>; <span class="id">intros</span> <span class="id">b</span> (<span class="id">t</span>,(<span class="id">Hs</span>,<span class="id">Hf</span>)).<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> (<span class="kwd">fun</span> <span class="id">a0</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id">g</span> <span class="id">a0</span>)) <span class="id">s</span> == <span class="id">g</span> <span class="id">b</span> <span class="id">t</span>).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_eq_cons">DScase_eq_cons</a></span> (<span class="kwd">fun</span> <span class="id">a0</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id">g</span> <span class="id">a0</span>)) <span class="id">Hs</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> <span class="id">b</span> <span class="id">t</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id">g</span> <span class="id">b</span> <span class="id">t</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_le_elim">fcont_le_elim</a></span> (<span class="id">Hle</span> <span class="id">b</span>)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSCASE_cont_simpl">DSCASE_cont_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">D</span>' <span class="id">f</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_cont">DSCASE_cont</a></span> <span class="id">D</span> <span class="id">D</span>' <span class="id">f</span> <span class="id">s</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id">f</span> <span class="id">a</span>)) <span class="id">s</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="DSCASE">DSCASE</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">D</span>', (<span class="id">D</span>-<span class="id">O</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">C</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>')-<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">C</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>'.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_cont">DSCASE_cont</a></span> <span class="id">D</span> <span class="id">D</span>').<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">intro</span> <span class="id">s</span>.<br/>
<span class="id">change</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_cont">DSCASE_cont</a></span> <span class="id">D</span> <span class="id">D</span>' (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) <span class="id">s</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_cont">DSCASE_cont</a></span> <span class="id">D</span> <span class="id">D</span>' @ <span class="id">h</span>) <span class="id">s</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_cont_simpl">DSCASE_cont_simpl</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_intro_cons">DSle_intro_cons</a></span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_eq_cons_elim">DScase_eq_cons_elim</a></span>  (<span class="kwd">fun</span> <span class="id">a</span> : <span class="id">D</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>) <span class="id">a</span>)) (<span class="id">a</span>:=<span class="id">a</span>) (<span class="id">s</span>:=<span class="id">s0</span>) <span class="id">s</span>); <span class="id">auto</span>; <span class="id">intros</span> <span class="id">b</span> (<span class="id">t</span>,(<span class="id">Hs</span>,<span class="id">Hf</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_lub_simpl">fcont_lub_simpl</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> ((<span class="id">h</span> &lt;<span class="id">o</span>&gt; <span class="id">b</span>) &lt;<span class="id">__</span>&gt; <span class="id">t</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span> (<span class="id">D</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>')); <span class="id">intro</span> <span class="id">n</span>.<br/>
<span class="id">repeat</span> (<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_app_simpl">fcont_app_simpl</a></span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_simpl">fmon_comp_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_cont_simpl">DSCASE_cont_simpl</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_eq_cons">DScase_eq_cons</a></span> (<span class="kwd">fun</span> <span class="id">a0</span> : <span class="id">D</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id">h</span> <span class="id">n</span> <span class="id">a0</span>)) <span class="id">Hs</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSCASE_simpl">DSCASE_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">D</span>' <span class="id">f</span> <span class="id">s</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id">D</span> <span class="id">D</span>' <span class="id">f</span> <span class="id">s</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> (<span class="id">f</span> <span class="id">a</span>)) <span class="id">s</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<h2> Basic functions on streams </h2>
<br/>
<div class="doc">- Cons is continuous </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Cons">Cons</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>): <span class="id">D</span> -<span class="id">o</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>.<br/>
<span class="id">intro</span> <span class="id">b</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">b</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Cons_simpl">Cons_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">a</span> : <span class="id">D</span>) (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Cons">Cons</a></span> <span class="id">a</span> <span class="id">s</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Cons_cont">Cons_cont</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">a</span> : <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Cons">Cons</a></span> <span class="id">a</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span> <span class="id">D</span> <span class="id">a</span> <span class="id">h</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubCon">DS_lubCon</a></span> (<span class="id">a</span>:=<span class="id">a</span>) (<span class="id">s</span>:=<span class="id">h</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Cons">Cons</a></span> <span class="id">a</span> @ <span class="id">h</span>)); <span class="id">trivial</span>.<br/>
<span class="id">intros</span> <span class="id">d</span> (<span class="id">H1</span>,<span class="id">H2</span>).<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubCon_inv">DS_lubCon_inv</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Cons">Cons</a></span> <span class="id">a</span> @ <span class="id">h</span>) <span class="id">H1</span>).<br/>
<span class="id">intros</span> <span class="id">tlc</span> (<span class="id">H4</span>,<span class="id">H5</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) <span class="id">d</span>)); <span class="id">auto</span>.<br/>
<span class="id">case</span> <span class="id">H5</span>; <span class="id">clear</span> <span class="id">H5</span>; <span class="id">intros</span> <span class="id">m</span> <span class="id">H5</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Cons_simpl">Cons_simpl</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons_le_compat">cons_le_compat</a></span>; <span class="id">trivial</span>.<br/>
<span class="id">rewrite</span> <span class="id">H4</span>.<br/>
<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>, <span class="id">h</span> (<span class="id">l</span> + <span class="id">m</span>) == <span class="id">tlc</span> <span class="id">l</span>).<br/>
<span class="id">intro</span> <span class="id">l</span>; <span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con_tl_simpl">Con_tl_simpl</a></span> <span class="kwd">with</span> <span class="id">a</span> <span class="id">a</span>.<br/>
<span class="id">apply</span> (<span class="id">H5</span> <span class="id">l</span>).<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_lift_right">lub_lift_right</a></span> <span class="id">h</span> <span class="id">m</span>).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span> (<span class="id">D</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)  (<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mseq_lift_right">mseq_lift_right</a></span> (<span class="id">O</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) <span class="id">h</span> <span class="id">m</span>) (<span class="id">g</span>:=<span class="id">tlc</span>)); <span class="id">intro</span> <span class="id">n</span>; <span class="id">simpl</span>.<br/>
<span class="id">case</span> (<span class="id">H</span> <span class="id">n</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Cons_cont</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="CONS">CONS</a></span> <span class="id">D</span> (<span class="id">a</span> : <span class="id">D</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#mk_fconti">mk_fconti</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Cons_cont">Cons_cont</a></span> <span class="id">a</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="CONS_simpl">CONS_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">a</span> : <span class="id">D</span>) (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id">a</span> <span class="id">s</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<div class="doc">- first takes a stream and return the stream with only the first element
        f a s = cons a nil
</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="firstf">firstf</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>) : <span class="id">D</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">m</span>&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>:=<br/>
<span class="kwd">fun</span> (<span class="id">d</span>:<span class="id">D</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) (<span class="id">O2</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">d</span> (0:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="firstf_simpl">firstf_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">a</span>:<span class="id">D</span>) (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#firstf">firstf</a></span> <span class="id">a</span> <span class="id">s</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> (0:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>).<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="firstf_cont">firstf_cont</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">a</span>:<span class="id">D</span>) <span class="id">c</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#firstf">firstf</a></span> <span class="id">a</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">c</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#firstf">firstf</a></span> <span class="id">a</span> @ <span class="id">c</span>).<br/>
<span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#firstf_simpl">firstf_simpl</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#firstf">firstf</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> (<span class="id">O2</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> (0 : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)))); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">firstf_cont</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="First">First</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCase">DSCase</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#firstf">firstf</a></span> (<span class="id">D</span>:=<span class="id">D</span>)).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="first">first</a></span> <span class="id">D</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#First">First</a></span> <span class="id">D</span> <span class="id">s</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="first_simpl">first_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#firstf">firstf</a></span> (<span class="id">D</span>:=<span class="id">D</span>)) <span class="id">s</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="first_le_compat">first_le_compat</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id">s</span> &lt;= <span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">t</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">first_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="first_eq_compat">first_eq_compat</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id">s</span> == <span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">first_eq_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="first_cons">first_cons</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>) = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> (0:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>).<br/>
<span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_simpl">first_simpl</a></span>; <span class="id">intros</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>; <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="first_bot">first_bot</a></span> : <span class="kwd">forall</span> <span class="id">D</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id">D</span>:=<span class="id">D</span>) 0 &lt;= 0.<br/>
<span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_simpl">first_simpl</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="first_cons_elim">first_cons_elim</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">t</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span> -&gt; <span class="kwd">exists</span> <span class="id">u</span>, <span class="id">t</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">u</span> /\ <span class="id">s</span>==(0:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>).<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">a</span> <span class="id">s</span> <span class="id">t</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_simpl">first_simpl</a></span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_eq_cons_elim">DScase_eq_cons_elim</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#firstf">firstf</a></span> (<span class="id">D</span>:=<span class="id">D</span>)) <span class="id">t</span> <span class="id">H</span>).<br/>
<span class="id">intros</span> <span class="id">b</span> (<span class="id">u</span>,(<span class="id">H1</span>,<span class="id">H2</span>)).<br/>
<span class="kwd">exists</span> <span class="id">u</span>.<br/>
<span class="id">assert</span> (<span class="id">b</span>=<span class="id">a</span>).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con_hd_simpl">Con_hd_simpl</a></span> <span class="id">H2</span>).<br/>
<span class="id">assert</span> ((0:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) ==<span class="id">s</span>).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con_tl_simpl">Con_tl_simpl</a></span> <span class="id">H2</span>).<br/>
<span class="id">split</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> (1:=<span class="id">H1</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">D</span> : (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">D</span>)<br/>
<span class="kwd">with</span> <span class="id">signature</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) ==&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) <span class="kwd">as</span> <span class="id">first_eq_compat_morph</span>.<br/>
<span class="id">exact</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_eq_compat">first_eq_compat</a></span> <span class="id">D</span>).<br/>
Qed.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">D</span> : (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">D</span>)<br/>
<span class="kwd">with</span> <span class="id">signature</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) ++&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) <span class="kwd">as</span> <span class="id">first_le_compat_morph</span>.<br/>
<span class="id">exact</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_le_compat">first_le_compat</a></span> <span class="id">D</span>).<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_first">is_cons_first</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">s</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span>).<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#First">First</a></span>; <span class="id">intros</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCase_simpl">DSCase_simpl</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_DScase">is_cons_DScase</a></span>; <span class="id">auto</span>.<br/>
<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#firstf">firstf</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">is_cons_first</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="first_is_cons">first_is_cons</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">s</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#First">First</a></span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_is_cons">DScase_is_cons</a></span> <span class="kwd">with</span> <span class="id">D</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#firstf">firstf</a></span> (<span class="id">D</span>:=<span class="id">D</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">first_is_cons</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="first_cont">first_cont</a></span> : <span class="kwd">forall</span> <span class="id">D</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#First">First</a></span> <span class="id">D</span>).<br/>
<span class="id">intro</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#First">First</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cont">DScase_cont</a></span>; <span class="id">intros</span>.<br/>
<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#firstf_cont">firstf_cont</a></span> <span class="id">c</span>).<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">first_cont</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="FIRST">FIRST</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>.<br/>
<span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#First">First</a></span> <span class="id">D</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FIRST_simpl">FIRST_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">s</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FIRST">FIRST</a></span> <span class="id">D</span> <span class="id">s</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<div class="doc">- rem returns the stream without the first element </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="remf">remf</a></span> <span class="id">D</span> (<span class="id">d</span>: <span class="id">D</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_id">fmon_id</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="remf_simpl">remf_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">a</span>:<span class="id">D</span>) <span class="id">s</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#remf">remf</a></span> <span class="id">a</span> <span class="id">s</span> = <span class="id">s</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="remf_cont">remf_cont</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">a</span>:<span class="id">D</span>) <span class="id">s</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#remf">remf</a></span> <span class="id">a</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">s</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#remf">remf</a></span> <span class="id">a</span> @ <span class="id">s</span>).<br/>
<span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#remf_simpl">remf_simpl</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">remf_cont</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Rem">Rem</a></span> <span class="id">D</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCase">DSCase</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#remf">remf</a></span> (<span class="id">D</span>:=<span class="id">D</span>)).<br/>
<span class="kwd">Definition</span> <span class="id"><a name="rem">rem</a></span> <span class="id">D</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Rem">Rem</a></span> <span class="id">D</span> <span class="id">s</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_simpl">rem_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#remf">remf</a></span> (<span class="id">D</span>:=<span class="id">D</span>)) <span class="id">s</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_cons">rem_cons</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">a</span>:<span class="id">D</span>) <span class="id">s</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>) = <span class="id">s</span>.<br/>
<span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_simpl">rem_simpl</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>; <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_bot">rem_bot</a></span> : <span class="kwd">forall</span> <span class="id">D</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id">D</span>:=<span class="id">D</span>) 0 &lt;= 0.<br/>
<span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_simpl">rem_simpl</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_le_compat">rem_le_compat</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id">s</span>&lt;=<span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">t</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">rem_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_eq_compat">rem_eq_compat</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id">s</span>==<span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">rem_eq_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">D</span> : (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">D</span>)<br/>
<span class="kwd">with</span> <span class="id">signature</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) ==&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) <span class="kwd">as</span> <span class="id">rem_eq_compat_morph</span>.<br/>
<span class="id">exact</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_eq_compat">rem_eq_compat</a></span> <span class="id">D</span>).<br/>
Qed.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">D</span> : (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">D</span>)<br/>
<span class="kwd">with</span> <span class="id">signature</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) ++&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) <span class="kwd">as</span> <span class="id">rem_le_compat_morph</span>.<br/>
<span class="id">exact</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_le_compat">rem_le_compat</a></span> <span class="id">D</span>).<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_is_cons">rem_is_cons</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">s</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Rem">Rem</a></span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_is_cons">DScase_is_cons</a></span> <span class="kwd">with</span> <span class="id">D</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#remf">remf</a></span> (<span class="id">D</span>:=<span class="id">D</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">rem_is_cons</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_cont">rem_cont</a></span> : <span class="kwd">forall</span> <span class="id">D</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Rem">Rem</a></span> <span class="id">D</span>).<br/>
<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Rem">Rem</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cont">DScase_cont</a></span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#remf_cont">remf_cont</a></span> <span class="id">c</span>).<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">rem_cont</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="REM">REM</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Rem">Rem</a></span> <span class="id">D</span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="REM_simpl">REM_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> <span class="id">D</span> <span class="id">s</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<div class="doc">- app s t concatenates the first element of s to t </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="appf">appf</a></span> <span class="id">D</span> (<span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) (<span class="id">d</span>: <span class="id">D</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">m</span>&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Cons">Cons</a></span> <span class="id">d</span> <span class="id">t</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="appf_simpl">appf_simpl</a></span> <span class="id">D</span> (<span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">s</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span> <span class="id">t</span> <span class="id">a</span> <span class="id">s</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">t</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Appf">Appf</a></span> : <span class="kwd">forall</span> <span class="id">D</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">m</span>&gt; <span class="id">D</span> -<span class="id">o</span>&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>).<br/>
<span class="id">intro</span> <span class="id">D</span>; <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span> (<span class="id">D</span>:=<span class="id">D</span>)); <span class="id">red</span>; <span class="id">intros</span>; <span class="id">intros</span> <span class="id">a</span> <span class="id">s</span>; <span class="id">repeat</span> (<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf_simpl">appf_simpl</a></span>); <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Appf_simpl">Appf_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">t</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Appf">Appf</a></span> <span class="id">D</span> <span class="id">t</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span> <span class="id">t</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="appf_cont">appf_cont</a></span> <span class="id">D</span> (<span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">c</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span> <span class="id">t</span> <span class="id">a</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">c</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span> <span class="id">t</span> <span class="id">a</span> @ <span class="id">c</span>).<br/>
<span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf_simpl">appf_simpl</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_cte">fmon_cte</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#natO">natO</a></span> (<span class="id">O2</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Cons">Cons</a></span> <span class="id">a</span> <span class="id">t</span>))); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">appf_cont</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="appf_cont_par">appf_cont_par</a></span> : <span class="kwd">forall</span> <span class="id">D</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">D2</span>:=<span class="id">D</span> -<span class="id">O</span>-&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">M</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Appf">Appf</a></span> <span class="id">D</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">intros</span> <span class="id">a</span> <span class="id">s</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Appf_simpl">Appf_simpl</a></span> (<span class="id">D</span>:=<span class="id">D</span>)); <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf_simpl">appf_simpl</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Cons">Cons</a></span> <span class="id">a</span> @ <span class="id">h</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Cons_cont">Cons_cont</a></span> <span class="id">a</span> <span class="id">h</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcpo_lub_simpl">fcpo_lub_simpl</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_lub_simpl">fmon_lub_simpl</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">intro</span> <span class="id">n</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">appf_cont_par</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="AppI">AppI</a></span> : <span class="kwd">forall</span> <span class="id">D</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>.<br/>
<span class="id">intros</span>; <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">t</span> =&gt;  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCase">DSCase</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span> <span class="id">t</span>)); <span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_mon">DSCASE_mon</a></span> <span class="id">D</span> <span class="id">D</span>) (<span class="id">x</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span> <span class="id">x</span>) (<span class="id">y</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span> <span class="id">y</span>)).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Appf">Appf</a></span> <span class="id">D</span>) (<span class="id">x</span>:=<span class="id">x</span>) (<span class="id">y</span>:=<span class="id">y</span>)); <span class="id">trivial</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="AppI_simpl">AppI_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">s</span> <span class="id">t</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#AppI">AppI</a></span> <span class="id">D</span> <span class="id">t</span> <span class="id">s</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span> <span class="id">t</span>) <span class="id">s</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="App">App</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_shift">fmon_shift</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#AppI">AppI</a></span> <span class="id">D</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="App_simpl">App_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">s</span> <span class="id">t</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#App">App</a></span> <span class="id">D</span> <span class="id">s</span> <span class="id">t</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span> <span class="id">t</span>) <span class="id">s</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="app">app</a></span> <span class="id">D</span> <span class="id">s</span> <span class="id">t</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#App">App</a></span> <span class="id">D</span> <span class="id">s</span> <span class="id">t</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_simpl">app_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">s</span> <span class="id">t</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span> <span class="id">t</span>) <span class="id">s</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_cons">app_cons</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>) <span class="id">t</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_simpl">app_simpl</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>; <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_bot">app_bot</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> 0 <span class="id">s</span> &lt;= 0.<br/>
<span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_simpl">app_simpl</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_mon_left">app_mon_left</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> <span class="id">t</span> <span class="id">u</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id">s</span> &lt;= <span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">s</span> <span class="id">u</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">t</span> <span class="id">u</span>.<br/>
<span class="id">intros</span>; <span class="id">repeat</span> (<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_simpl">app_simpl</a></span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_cons_elim">app_cons_elim</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span> <span class="id">t</span> <span class="id">u</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">t</span> <span class="id">u</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">t</span>', <span class="id">t</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">t</span>' /\ <span class="id">s</span> == <span class="id">u</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">a</span> <span class="id">s</span> <span class="id">t</span> <span class="id">u</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_simpl">app_simpl</a></span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_eq_cons_elim">DScase_eq_cons_elim</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span> <span class="id">u</span>) <span class="id">t</span> <span class="id">H</span>).<br/>
<span class="id">intros</span> <span class="id">b</span> (<span class="id">t</span>',(<span class="id">H1</span>,<span class="id">H2</span>)).<br/>
<span class="kwd">exists</span> <span class="id">t</span>'.<br/>
<span class="id">assert</span> (<span class="id">b</span>=<span class="id">a</span>).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con_hd_simpl">Con_hd_simpl</a></span> <span class="id">H2</span>).<br/>
<span class="id">assert</span> (<span class="id">u</span>==<span class="id">s</span>).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con_tl_simpl">Con_tl_simpl</a></span> <span class="id">H2</span>).<br/>
<span class="id">split</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> (1:=<span class="id">H1</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_mon_right">app_mon_right</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> <span class="id">t</span> <span class="id">u</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id">t</span> &lt;= <span class="id">u</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">s</span> <span class="id">t</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">s</span> <span class="id">u</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#App">App</a></span> <span class="id">D</span> <span class="id">s</span>) <span class="id">H</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">first_cons</span> <span class="id">first_bot</span> <span class="id">app_cons</span> <span class="id">app_bot</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">app_mon_left</span> <span class="id">app_mon_right</span> <span class="id">rem_cons</span> <span class="id">rem_bot</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_le_compat">app_le_compat</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> <span class="id">t</span> <span class="id">u</span> <span class="id">v</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id">s</span> &lt;= <span class="id">t</span> -&gt; <span class="id">u</span> &lt;= <span class="id">v</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">s</span> <span class="id">u</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">t</span> <span class="id">v</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">t</span> <span class="id">u</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">app_le_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_eq_compat">app_eq_compat</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> <span class="id">t</span> <span class="id">u</span> <span class="id">v</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id">s</span> == <span class="id">t</span> -&gt; <span class="id">u</span> == <span class="id">v</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">s</span> <span class="id">u</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">t</span> <span class="id">v</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_le_compat">app_le_compat</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">app_eq_compat</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">D</span> : (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">D</span>)<br/>
<span class="kwd">with</span> <span class="id">signature</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) ==&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) ==&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) <span class="kwd">as</span> <span class="id">app_eq_compat_morph</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_eq_compat">app_eq_compat</a></span> <span class="id">H</span> <span class="id">H0</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">D</span> : (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">D</span>)<br/>
<span class="kwd">with</span> <span class="id">signature</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) ++&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) ++&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole">Ole</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) <span class="kwd">as</span> <span class="id">app_le_compat_morph</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_le_compat">app_le_compat</a></span> <span class="id">H</span> <span class="id">H0</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_app">is_cons_app</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> <span class="id">y</span>).<br/>
<span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_simpl">app_simpl</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_DScase">is_cons_DScase</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">is_cons_app</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_is_cons">app_is_cons</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> <span class="id">y</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span>.<br/>
<span class="id">intros</span> <span class="id">D</span> <span class="id">x</span> <span class="id">y</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_simpl">app_simpl</a></span>; <span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_is_cons">DScase_is_cons</a></span> <span class="kwd">with</span> <span class="id">D</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span> <span class="id">y</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_cont">app_cont</a></span> : <span class="kwd">forall</span> <span class="id">D</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2">continuous2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#App">App</a></span> <span class="id">D</span>).<br/>
<span class="id">intro</span> <span class="id">D</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous_continuous2">continuous_continuous2</a></span>; <span class="id">intros</span>.<br/>
<span class="id">red</span>; <span class="id">intros</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#App_simpl">App_simpl</a></span> (<span class="id">D</span>:=<span class="id">D</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">D</span>-<span class="id">O</span>-&gt;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">M</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Appf">Appf</a></span> <span class="id">D</span> @ <span class="id">h</span>)) <span class="id">k</span>).<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCase">DSCase</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) <span class="id">h</span>)) &lt;=<br/>
<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCase">DSCase</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">D</span> -<span class="id">O</span>-&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">M</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Appf">Appf</a></span> <span class="id">D</span> @ <span class="id">h</span>))); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmonotonic">fmonotonic</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_mon">DSCASE_mon</a></span> <span class="id">D</span> <span class="id">D</span>) (<span class="id">x</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> <span class="id">h</span>)) (<span class="id">y</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id">D</span> -<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">M</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Appf">Appf</a></span> <span class="id">D</span> @ <span class="id">h</span>))).<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf_cont_par">appf_cont_par</a></span> (<span class="id">D</span>:=<span class="id">D</span>) <span class="id">h</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub">lub</a></span> (<span class="id">c</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">M</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_mon">DSCASE_mon</a></span> <span class="id">D</span> <span class="id">D</span> @ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Appf">Appf</a></span> <span class="id">D</span> @ <span class="id">h</span>)) <span class="id">k</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_mon_cont">DSCASE_mon_cont</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Appf">Appf</a></span> <span class="id">D</span> @ <span class="id">h</span>) <span class="id">k</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span>; <span class="id">intro</span> <span class="id">k</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_lub_simpl">fmon_lub_simpl</a></span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous">continuous</a></span> (<span class="id">D1</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) (<span class="id">D2</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCase">DSCase</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf">appf</a></span> <span class="id">k</span>))).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cont">DScase_cont</a></span>; <span class="id">intros</span>.<br/>
<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#appf_cont">appf_cont</a></span> <span class="id">k</span> <span class="id">c</span>).<br/>
<span class="id">exact</span> (<span class="id">H</span> <span class="id">h</span>).<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">app_cont</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="APP">APP</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#continuous2_cont">continuous2_cont</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cont">app_cont</a></span> (<span class="id">D</span>:=<span class="id">D</span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="APP_simpl">APP_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> <span class="id">t</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP">APP</a></span> <span class="id">D</span> <span class="id">s</span> <span class="id">t</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">s</span> <span class="id">t</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<h3> Basic equalities </h3>
<span class="kwd">Lemma</span> <span class="id"><a name="first_eq_bot">first_eq_bot</a></span> : <span class="kwd">forall</span> <span class="id">D</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id">D</span>:=<span class="id">D</span>) 0 == 0.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_eq_bot">rem_eq_bot</a></span> : <span class="kwd">forall</span> <span class="id">D</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id">D</span>:=<span class="id">D</span>) 0 == 0.<br/>
<span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_eq_bot">app_eq_bot</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> 0 <span class="id">s</span> == 0.<br/>
<span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">first_eq_bot</span> <span class="id">rem_eq_bot</span> <span class="id">app_eq_bot</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_app_bot_right_first">DSle_app_bot_right_first</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">s</span> 0 &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_intro_cons">DSle_intro_cons</a></span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons_elim">app_cons_elim</a></span> <span class="id">s</span> 0 <span class="id">H</span>); <span class="id">intros</span> <span class="id">b</span> (<span class="id">H1</span>,<span class="id">H2</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> (0:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">b</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_first_app_bot_right">DSle_first_app_bot_right</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">s</span> 0.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_intro_cons">DSle_intro_cons</a></span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons_elim">first_cons_elim</a></span> <span class="id">s</span> <span class="id">H</span>); <span class="id">intros</span> <span class="id">s</span>' (<span class="id">H1</span>,<span class="id">H2</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_bot_right_first">app_bot_right_first</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">s</span> 0 == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_app_bot_right_first">DSle_app_bot_right_first</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_first_app_bot_right">DSle_first_app_bot_right</a></span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_first_app_first">DSle_first_app_first</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> <span class="id">y</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">x</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_intro_cons">DSle_intro_cons</a></span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons_elim">first_cons_elim</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> <span class="id">y</span>) <span class="id">H</span>); <span class="id">intros</span> <span class="id">s</span>' (<span class="id">H1</span>,<span class="id">H2</span>).<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons_elim">app_cons_elim</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">H1</span>); <span class="id">intros</span> <span class="id">x</span>' (<span class="id">H3</span>,<span class="id">H4</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">x</span>')); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> (0:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_first_first_app">DSle_first_first_app</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">x</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> <span class="id">y</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_intro_cons">DSle_intro_cons</a></span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons_elim">first_cons_elim</a></span> <span class="id">x</span> <span class="id">H</span>); <span class="id">intros</span> <span class="id">x</span>' (<span class="id">H1</span>,<span class="id">H2</span>).<br/>
<span class="id">apply</span>  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">x</span>') <span class="id">y</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">y</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> (0:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="first_app_first">first_app_first</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> <span class="id">y</span>)==<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">x</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_first_app_first">DSle_first_app_first</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_first_first_app">DSle_first_first_app</a></span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">app_bot_right_first</span> <span class="id">first_app_first</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_app_first_rem">DSle_app_first_rem</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>) &lt;= <span class="id">x</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_intro_cons">DSle_intro_cons</a></span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons_elim">app_cons_elim</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>) <span class="id">H</span>); <span class="id">intros</span> <span class="id">t</span> (<span class="id">H1</span>,<span class="id">H2</span>).<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons_elim">first_cons_elim</a></span> <span class="id">x</span> <span class="id">H1</span>); <span class="id">intros</span> <span class="id">x</span>' (<span class="id">H3</span>,<span class="id">H4</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">x</span>'); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons_le_compat">cons_le_compat</a></span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">x</span>')); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_app_first_rem_sym">DSle_app_first_rem_sym</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id">x</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_intro_cons">DSle_intro_cons</a></span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>))).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>))); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_first_rem">app_first_rem</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>) == <span class="id">x</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_antisym">Ole_antisym</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_app_first_rem">DSle_app_first_rem</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_app_first_rem_sym">DSle_app_first_rem_sym</a></span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">app_first_rem</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_app">rem_app</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> <span class="id">y</span>) == <span class="id">y</span>.<br/>
<span class="id">intros</span>; <span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">H</span>); <span class="id">intros</span> <span class="id">a</span> (<span class="id">s</span>,<span class="id">H1</span>).<br/>
<span class="id">rewrite</span> <span class="id">H1</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">trivial</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">rem_app</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_app_le">rem_app_le</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> <span class="id">y</span>) &lt;= <span class="id">y</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_intro_is_cons">DSle_intro_is_cons</a></span>; <span class="id">intros</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> <span class="id">y</span>)); <span class="id">auto</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span> <span class="kwd">with</span> <span class="id">y</span>; <span class="id">trivial</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">rem_app_le</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_rem_app">is_cons_rem_app</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> <span class="id">y</span>)).<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_eq_compat">is_cons_eq_compat</a></span> <span class="kwd">with</span> <span class="id">y</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_sym">Oeq_sym</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">is_cons_rem_app</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_app_is_cons">rem_app_is_cons</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> <span class="id">y</span>)) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">y</span>.<br/>
<span class="id">intros</span>; <span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> <span class="id">y</span>)); <span class="id">auto</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span> <span class="kwd">with</span> <span class="id">y</span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_eq_compat">is_cons_eq_compat</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> <span class="id">y</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="first_first_eq">first_first_eq</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span>))); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">first_first_eq</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_app_first">app_app_first</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> <span class="id">t</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span>) <span class="id">t</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">s</span> <span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSeq_intro_is_cons">DSeq_intro_is_cons</a></span>; <span class="id">intros</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">s</span>).<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span> <span class="kwd">with</span> <span class="id">t</span>; <span class="id">trivial</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">H0</span>); <span class="id">intros</span> <span class="id">a</span> (<span class="id">s</span>',<span class="id">H1</span>).<br/>
<span class="id">rewrite</span> <span class="id">H1</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>; <span class="id">trivial</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">s</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span> <span class="kwd">with</span> <span class="id">t</span>; <span class="id">trivial</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">H0</span>); <span class="id">intros</span> <span class="id">a</span> (<span class="id">s</span>',<span class="id">H1</span>).<br/>
<span class="id">rewrite</span> <span class="id">H1</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>; <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<h2> Proof by co-recursion </h2>
<span class="kwd">Lemma</span> <span class="id"><a name="DS_bisimulation">DS_bisimulation</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">R</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -&gt; <span class="kwd">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">y1</span> <span class="id">y2</span>, <span class="id">R</span> <span class="id">x1</span> <span class="id">y1</span> -&gt; <span class="id">x1</span>==<span class="id">x2</span> -&gt; <span class="id">y1</span>==<span class="id">y2</span> -&gt; <span class="id">R</span> <span class="id">x2</span> <span class="id">y2</span>)<br/>
&nbsp;&nbsp;&nbsp;-&gt; (<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span> \/ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">y</span>) -&gt; <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;-&gt; (<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span> \/ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">y</span>) -&gt; <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">y</span>))<br/>
&nbsp;&nbsp;&nbsp;-&gt; <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">x</span> == <span class="id">y</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSeq_rec">DSeq_rec</a></span> <span class="id">R</span>); <span class="id">auto</span>; <span class="id">intros</span>.<br/>
<span class="id">assert</span> (<span class="id">Hf</span>:=<span class="id">H0</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>) <span class="id">y0</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#or_introl">or_introl</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">y0</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_intro">is_cons_intro</a></span> <span class="id">a</span> <span class="id">s</span>)) <span class="id">H3</span>).<br/>
<span class="id">assert</span> (<span class="id">Hr</span>:=<span class="id">H1</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>) <span class="id">y0</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#or_introl">or_introl</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">y0</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_intro">is_cons_intro</a></span> <span class="id">a</span> <span class="id">s</span>)) <span class="id">H3</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons_elim">first_cons_elim</a></span> (<span class="id">a</span>:=<span class="id">a</span>) (<span class="id">s</span>:=0:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) <span class="id">y0</span>); <span class="id">auto</span>; <span class="id">intros</span> <span class="id">x0</span> (<span class="id">H4</span>,<span class="id">_</span>).<br/>
<span class="kwd">exists</span> <span class="id">x0</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id">H</span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">y0</span>); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">x0</span>)); <span class="id">auto</span>.<br/>
<span class="id">assert</span> (<span class="id">Hf</span>:=<span class="id">H0</span> <span class="id">x0</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>)  (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#or_intror">or_intror</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x0</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_intro">is_cons_intro</a></span> <span class="id">a</span> <span class="id">s</span>)) <span class="id">H3</span>).<br/>
<span class="id">assert</span> (<span class="id">Hr</span>:=<span class="id">H1</span> <span class="id">x0</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#or_intror">or_intror</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x0</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_intro">is_cons_intro</a></span> <span class="id">a</span> <span class="id">s</span>)) <span class="id">H3</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons_elim">first_cons_elim</a></span> (<span class="id">a</span>:=<span class="id">a</span>) (<span class="id">s</span>:=0:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) <span class="id">x0</span>); <span class="id">auto</span>; <span class="id">intros</span> <span class="id">y0</span> (<span class="id">H4</span>,<span class="id">_</span>).<br/>
<span class="kwd">exists</span> <span class="id">y0</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id">H</span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x0</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>)); <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_trans">Oeq_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">y0</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DS_bisimulation2">DS_bisimulation2</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">R</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -&gt; <span class="kwd">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">y1</span> <span class="id">y2</span>, <span class="id">R</span> <span class="id">x1</span> <span class="id">y1</span> -&gt; <span class="id">x1</span>==<span class="id">x2</span> -&gt; <span class="id">y1</span>==<span class="id">y2</span> -&gt; <span class="id">R</span> <span class="id">x2</span> <span class="id">y2</span>)<br/>
&nbsp;&nbsp;&nbsp;-&gt; (<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span> \/ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">y</span>) -&gt; <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;-&gt; (<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>) \/ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">y</span>)) -&gt; <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">y</span>))<br/>
&nbsp;&nbsp;&nbsp;-&gt; (<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>) \/ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">y</span>)) -&gt; <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">y</span>)))<br/>
&nbsp;&nbsp;&nbsp;-&gt; <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">x</span> == <span class="id">y</span>.<br/>
<span class="id">intros</span>;<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_bisimulation">DS_bisimulation</a></span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">R</span>:= <span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> \/ ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span> \/ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">y</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">y</span>)))); <span class="id">intros</span>.<br/>
<span class="id">case</span> <span class="id">H4</span>; <span class="id">clear</span> <span class="id">H4</span>; <span class="id">intros</span>.<br/>
<span class="id">left</span>; <span class="id">apply</span> <span class="id">H</span> <span class="kwd">with</span> <span class="id">x1</span> <span class="id">y1</span>; <span class="id">trivial</span>.<br/>
<span class="id">right</span>; <span class="id">intros</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x1</span> \/ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">y1</span>).<br/>
<span class="id">case</span> <span class="id">H7</span>; <span class="id">clear</span> <span class="id">H7</span>; <span class="id">intro</span>.<br/>
<span class="id">left</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_eq_compat">is_cons_eq_compat</a></span> <span class="kwd">with</span> <span class="id">x2</span>; <span class="id">auto</span>.<br/>
<span class="id">right</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_eq_compat">is_cons_eq_compat</a></span> <span class="kwd">with</span> <span class="id">y2</span>; <span class="id">auto</span>.<br/>
<span class="id">assert</span> (<span class="id">H9</span>:=<span class="id">H4</span> <span class="id">H8</span>); <span class="id">clear</span> <span class="id">H4</span> <span class="id">H7</span> <span class="id">H8</span>; <span class="id">intuition</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id">H5</span>; <span class="id">rewrite</span> &lt;- <span class="id">H6</span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id">H</span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x1</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">y1</span>); <span class="id">auto</span>.<br/>
<span class="id">case</span> <span class="id">H5</span>; <span class="id">clear</span> <span class="id">H5</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">case</span> (<span class="id">H5</span> <span class="id">H4</span>); <span class="id">trivial</span>.<br/>
<span class="id">case</span> <span class="id">H5</span>; <span class="id">clear</span> <span class="id">H5</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">case</span> (<span class="id">H5</span> <span class="id">H4</span>); <span class="id">clear</span> <span class="id">H4</span> <span class="id">H5</span>; <span class="id">intros</span>.<br/>
<span class="id">auto</span>.<br/>
<span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<h2> Finiteness of streams </h2>
<br/>
<span class="kwd">CoInductive</span> <span class="id"><a name="infinite">infinite</a></span> (<span class="id">D</span>:<span class="kwd">Type</span>) (<span class="id">s</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="inf_intro">inf_intro</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">s</span> -&gt; <span class="id">infinite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span>) -&gt; <span class="id">infinite</span> <span class="id">s</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="infinite_le_compat">infinite_le_compat</a></span> :  <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id">s</span> &lt;= <span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">s</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">t</span>.<br/>
<span class="id">intro</span> <span class="id">D</span>; <span class="kwd">cofix</span> <span class="id">infinite_le_compat</span>; <span class="id">intros</span>.<br/>
<span class="id">case</span> <span class="id">H0</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#inf_intro">inf_intro</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_le_compat">is_cons_le_compat</a></span> <span class="kwd">with</span> <span class="id">s</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id">infinite_le_compat</span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">D</span> : (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">D</span>)<br/>
<span class="kwd">with</span> <span class="id">signature</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span> <span class="kwd">as</span> <span class="id">infinite_morph</span>.<br/>
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span>; <span class="id">split</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite_le_compat">infinite_le_compat</a></span> <span class="kwd">with</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite_le_compat">infinite_le_compat</a></span> <span class="kwd">with</span> <span class="id">y</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="not_infiniteBot">not_infiniteBot</a></span> : <span class="kwd">forall</span> <span class="id">D</span>, ~ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (0:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span> <span class="id">D</span> <span class="id">H</span>; <span class="id">case</span> <span class="id">H</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#not_is_consBot">not_is_consBot</a></span> (<span class="id">D</span>:=<span class="id">D</span>)); <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">not_infiniteBot</span> : <span class="id">core</span>.<br/>
<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="finite">finite</a></span>  (<span class="id">D</span>:<span class="kwd">Type</span>) (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="fin_bot">fin_bot</a></span> : <span class="id">s</span> &lt;= 0 -&gt; <span class="id">finite</span> <span class="id">s</span> | <span class="id"><a name="fin_cons">fin_cons</a></span> : <span class="id">finite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span>) -&gt; <span class="id">finite</span> <span class="id">s</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="finite_mon">finite_mon</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id">s</span> &lt;= <span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#finite">finite</a></span> <span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#finite">finite</a></span> <span class="id">s</span>.<br/>
<span class="id">intros</span>.<br/>
<span class="id">generalize</span> <span class="id">s</span> <span class="id">H</span>.<br/>
<span class="id">elim</span> <span class="id">H0</span>; <span class="id">clear</span> <span class="id">s</span> <span class="id">t</span> <span class="id">H</span> <span class="id">H0</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#fin_bot">fin_bot</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> <span class="id">s</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#fin_cons">fin_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">D</span> : (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#finite">finite</a></span> <span class="id">D</span>)<br/>
<span class="kwd">with</span> <span class="id">signature</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span> <span class="kwd">as</span> <span class="id">finite_morph</span>.<br/>
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span>; <span class="id">split</span>; <span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#finite_mon">finite_mon</a></span> <span class="kwd">with</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#finite_mon">finite_mon</a></span> <span class="kwd">with</span> <span class="id">y</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="not_finite_infinite">not_finite_infinite</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#finite">finite</a></span> <span class="id">s</span> -&gt; ~ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">s</span>.<br/>
<span class="id">induction</span> 1; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">red</span>; <span class="id">intro</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#not_infiniteBot">not_infiniteBot</a></span> (<span class="id">D</span>:=<span class="id">D</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite_le_compat">infinite_le_compat</a></span> <span class="kwd">with</span> <span class="id">s</span>; <span class="id">auto</span>.<br/>
<span class="id">red</span>; <span class="id">intro</span>; <span class="id">apply</span> <span class="id">IHfinite</span>.<br/>
<span class="id">case</span> <span class="id">H0</span>; <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<h2> Mapping a function on a stream </h2>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="MapStream">MapStream</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="MapStream.D">D</a></span> <span class="id">D</span>': <span class="kwd">Type</span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="MapStream.F">F</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span> -&gt; <span class="id">D</span>'.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="mapf">mapf</a></span> : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>') -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>'.<br/>
<span class="kwd">exists</span> (<span class="kwd">fun</span> (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>') (<span class="id">a</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.F">F</a></span> <span class="id">a</span>) @<span class="id">_</span> <span class="id">f</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span> <span class="id">f</span> <span class="id">g</span> <span class="id">Hle</span> <span class="id">a</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_le_intro">fcont_le_intro</a></span> (<span class="id">D1</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span>) (<span class="id">D2</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>')); <span class="id">intro</span> <span class="id">s</span>.<br/>
<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>.<br/>
<span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mapf_simpl">mapf_simpl</a></span> : <span class="kwd">forall</span> <span class="id">f</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#mapf">mapf</a></span> <span class="id">f</span> = <span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.F">F</a></span> <span class="id">a</span>) @<span class="id">_</span> <span class="id">f</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mapf">Mapf</a></span> : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>') -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span>-<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span> -<span class="id">C</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>'.<br/>
<span class="kwd">exists</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#mapf">mapf</a></span>.<br/>
<span class="id">red</span>; <span class="id">intros</span> <span class="id">h</span> <span class="id">a</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#mapf_simpl">mapf_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcpo_lub_simpl">fcpo_lub_simpl</a></span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_le_intro">fcont_le_intro</a></span> (<span class="id">D1</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span>) (<span class="id">D2</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>')); <span class="id">intro</span> <span class="id">s</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_lub_simpl">fcont_lub_simpl</a></span>.<br/>
<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_lub_simpl">fcont_lub_simpl</a></span>; <span class="id">intros</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontinuous">fcontinuous</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.F">F</a></span> <span class="id">a</span>)) (<span class="id">h</span> &lt;<span class="id">__</span>&gt; <span class="id">s</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">intro</span> <span class="id">n</span>; <span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mapf_simpl">Mapf_simpl</a></span> : <span class="kwd">forall</span> <span class="id">f</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Mapf">Mapf</a></span> <span class="id">f</span> = <span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.F">F</a></span> <span class="id">a</span>) @<span class="id">_</span> <span class="id">f</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="MAP">MAP</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>' := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span>-<span class="id">C</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>') (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span> <span class="id">D</span>' @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Mapf">Mapf</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="MAP_eq">MAP_eq</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span> <span class="id">D</span>' (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Mapf">Mapf</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span>).<br/>
<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>  (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span> <span class="id">D</span>' @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Mapf">Mapf</a></span>)).<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="map">map</a></span> (<span class="id">s</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id">s</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="map_eq">map_eq</a></span> : <span class="kwd">forall</span> <span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">s</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Cons">Cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.F">F</a></span> <span class="id">a</span>) @ (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span>)) <span class="id">s</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_eq_elim">fcont_eq_elim</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP_eq">MAP_eq</a></span> <span class="id">s</span>).<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="map_bot">map_bot</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> 0 == 0.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_eq_elim">fcont_eq_elim</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP_eq">MAP_eq</a></span> 0).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="map_eq_cons">map_eq_cons</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.F">F</a></span> <span class="id">a</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">s</span>).<br/>
<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="kwd">at</span> 1.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_eq_elim">fcont_eq_elim</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP_eq">MAP_eq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="map_le_compat">map_le_compat</a></span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">t</span>, <span class="id">s</span> &lt;= <span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">s</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_monotonic">fcont_monotonic</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span>); <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="map_eq_compat">map_eq_compat</a></span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">t</span>, <span class="id">s</span> == <span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">s</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_stable">fcont_stable</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id">H</span>).<br/>
Qed.
<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span><br/>
<span class="kwd">with</span> <span class="id">signature</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span>)) ==&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>')) <span class="kwd">as</span> <span class="id">map_eq_compat_morph_local</span>.<br/>
<span class="id">exact</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_compat">map_eq_compat</a></span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_map">is_cons_map</a></span> : <span class="kwd">forall</span> (<span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">s</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">s</span>).<br/>
<span class="id">intros</span>; <span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">H</span>); <span class="id">intros</span> <span class="id">a</span> (<span class="id">t</span>,<span class="id">H1</span>).<br/>
<span class="id">rewrite</span> <span class="id">H1</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">is_cons_map</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="map_is_cons">map_is_cons</a></span> : <span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">s</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">s</span>.<br/>
<span class="id">intros</span>; <span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">H</span>); <span class="id">intros</span> <span class="id">a</span> (<span class="id">t</span>,<span class="id">H1</span>).<br/>
<span class="id">generalize</span> <span class="id">H1</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq">map_eq</a></span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_is_cons">DScase_is_cons</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="kwd">fun</span> <span class="id">a0</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.D">D</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Cons">Cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream.F">F</a></span> <span class="id">a0</span>) @ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontit">fcontit</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span>).<br/>
<span class="id">rewrite</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<span class="kwd">Hint</span> <span class="id">Immediate</span> <span class="id">map_is_cons</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">End</span>  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MapStream">MapStream</a></span>.<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">map_bot</span> <span class="id">map_eq_cons</span> <span class="id">map_le_compat</span> <span class="id">map_eq_compat</span> <span class="id">is_cons_map</span> : <span class="id">core</span>.<br/>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">D</span> <span class="id">D</span>' : (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">D</span> <span class="id">D</span>')<br/>
<span class="kwd">with</span> <span class="id">signature</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) ==&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>')) <span class="kwd">as</span> <span class="id">map_eq_compat_morph</span>.<br/>
<span class="id">exact</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_compat">map_eq_compat</a></span> <span class="id">D</span> <span class="id">D</span>').<br/>
Qed.
<br/>
<br/>
<h2> Filtering a stream </h2>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="FilterStream">FilterStream</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="FilterStream.D">D</a></span> : <span class="kwd">Type</span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="FilterStream.P">P</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="FilterStream.Pdec">Pdec</a></span> : <span class="kwd">forall</span> <span class="id">x</span>, {<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.P">P</a></span> <span class="id">x</span>}+{~ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.P">P</a></span> <span class="id">x</span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="filterf">filterf</a></span> : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span>) -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span>-<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span> -<span class="id">C</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span>.<br/>
<span class="kwd">exists</span> (<span class="kwd">fun</span> (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span>) <span class="id">a</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.Pdec">Pdec</a></span> <span class="id">a</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id">a</span> @<span class="id">_</span> <span class="id">f</span> <span class="kwd">else</span> <span class="id">f</span>).<br/>
<span class="id">red</span>; <span class="id">intros</span> <span class="id">f</span> <span class="id">g</span> <span class="id">Hle</span> <span class="id">a</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.Pdec">Pdec</a></span> <span class="id">a</span>); <span class="id">intros</span>; <span class="id">auto</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_le_intro">fcont_le_intro</a></span> (<span class="id">D1</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span>) (<span class="id">D2</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span>)); <span class="id">intro</span> <span class="id">s</span>.<br/>
<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>.<br/>
<span class="id">auto</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filterf_simpl">filterf_simpl</a></span> : <span class="kwd">forall</span> <span class="id">f</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filterf">filterf</a></span> <span class="id">f</span> = <span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.Pdec">Pdec</a></span> <span class="id">a</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id">a</span> @<span class="id">_</span> <span class="id">f</span> <span class="kwd">else</span> <span class="id">f</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Filterf">Filterf</a></span> : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span>) -<span class="id">c</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span>-<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span> -<span class="id">C</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span>.<br/>
<span class="kwd">exists</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filterf">filterf</a></span>.<br/>
<span class="id">red</span>; <span class="id">intros</span> <span class="id">h</span> <span class="id">a</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filterf_simpl">filterf_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcpo_lub_simpl">fcpo_lub_simpl</a></span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_le_intro">fcont_le_intro</a></span> (<span class="id">D1</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span>) (<span class="id">D2</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span>)); <span class="id">intro</span> <span class="id">s</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_lub_simpl">fcont_lub_simpl</a></span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.Pdec">Pdec</a></span> <span class="id">a</span>); <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_lub_simpl">fcont_lub_simpl</a></span>; <span class="id">intros</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcontinuous">fcontinuous</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id">a</span>) (<span class="id">h</span> &lt;<span class="id">__</span>&gt; <span class="id">s</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">intro</span> <span class="id">n</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_simpl">fmon_comp_simpl</a></span>.<br/>
<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_app_simpl">fcont_app_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_app_simpl">ford_app_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_simpl">fmon_comp_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filterf_simpl">filterf_simpl</a></span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.Pdec">Pdec</a></span> <span class="id">a</span>); <span class="id">intuition</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#lub_le_compat">lub_le_compat</a></span>; <span class="id">intro</span> <span class="id">m</span>.<br/>
<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_app_simpl">fcont_app_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_app_simpl">ford_app_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fmon_comp_simpl">fmon_comp_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filterf_simpl">filterf_simpl</a></span>.<br/>
<span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.Pdec">Pdec</a></span> <span class="id">a</span>); <span class="id">intuition</span>.<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Filterf_simpl">Filterf_simpl</a></span> : <span class="kwd">forall</span> <span class="id">f</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Filterf">Filterf</a></span> <span class="id">f</span> = <span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.Pdec">Pdec</a></span> <span class="id">a</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id">a</span> @<span class="id">_</span> <span class="id">f</span> <span class="kwd">else</span> <span class="id">f</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="FILTER">FILTER</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span>-<span class="id">C</span>-&gt;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Filterf">Filterf</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FILTER_eq">FILTER_eq</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FILTER">FILTER</a></span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Filterf">Filterf</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FILTER">FILTER</a></span>).<br/>
<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>  (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Filterf">Filterf</a></span>)).<br/>
Qed.
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="filter">filter</a></span> (<span class="id">s</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.D">D</a></span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FILTER">FILTER</a></span> <span class="id">s</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_bot">filter_bot</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span> 0 == 0.<br/>
<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_eq_elim">fcont_eq_elim</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FILTER_eq">FILTER_eq</a></span> 0).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>; <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_eq_cons">filter_eq_cons</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>) == <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.Pdec">Pdec</a></span> <span class="id">a</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span> <span class="id">s</span>) <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span> <span class="id">s</span>.<br/>
<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span> <span class="kwd">at</span> 1.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_eq_elim">fcont_eq_elim</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FILTER_eq">FILTER_eq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Filterf_simpl">Filterf_simpl</a></span>; <span class="id">case</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream.Pdec">Pdec</a></span> <span class="id">a</span>); <span class="id">auto</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_le_compat">filter_le_compat</a></span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">t</span>, <span class="id">s</span> &lt;= <span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span> <span class="id">s</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span> <span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_monotonic">fcont_monotonic</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FILTER">FILTER</a></span>); <span class="id">trivial</span>.<br/>
Qed.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_eq_compat">filter_eq_compat</a></span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">t</span>, <span class="id">s</span> == <span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span> <span class="id">s</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span> <span class="id">t</span>.<br/>
<span class="id">intros</span>; <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_stable">fcont_stable</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FILTER">FILTER</a></span> <span class="id">H</span>).<br/>
Qed.
<br/>
<br/>
<span class="kwd">End</span>  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FilterStream">FilterStream</a></span>.<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">filter_bot</span> <span class="id">filter_eq_cons</span> <span class="id">filter_le_compat</span> <span class="id">filter_eq_compat</span> : <span class="id">core</span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
