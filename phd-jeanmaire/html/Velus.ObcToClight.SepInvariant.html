
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module SepInvariant</title>
<meta name="description" content="Documentation of Coq module SepInvariant" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module SepInvariant</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html">common.Separation</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html">common.Values</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Memdata.html">common.Memdata</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Memory.html">common.Memory</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Globalenvs.html">common.Globalenvs</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html">common.Errors</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html">cfrontend.Ctypes</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html">cfrontend.Clight</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html">lib.Maps</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Coqlib.html">lib.Coqlib</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html">lib.Integers</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.CommonTyping.html">Common.CommonTyping</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.CompCertLib.html">Common.CompCertLib</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Ident.html">Ident</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Environment.html">Environment</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.VelusMemory.html">VelusMemory</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#ListNotations">List.ListNotations</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html">ZArith.BinInt</a></span>.<br/>
<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html">ObcToClight.MoreSeparation</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Generation.html">ObcToClight.Generation</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html">ObcToClight.GenerationProperties</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html">ObcToClight.Interface</a></span>.<br/>
<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#OpAux">OpAux</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#ComTyp">ComTyp</a></span>.<br/>
<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn">Obc.Syn</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem">Obc.Sem</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ">Obc.Typ</a></span>.<br/>
<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">sep_scope</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">Z</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_value">match_value</a></span> (<span class="id">ov</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.value">value</a></span>) (<span class="id">v</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.cvalue">cvalue</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#or_default_with">or_default_with</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> (<span class="kwd">fun</span> <span class="id">v</span>' =&gt; <span class="id">v</span> = <span class="id"><a href="Velus.ObcToClight.Interface.html#value_to_cvalue">value_to_cvalue</a></span> <span class="id">v</span>') <span class="id">ov</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_var">match_var</a></span> (<span class="id">ve</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.venv">venv</a></span>) (<span class="id">le</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#temp_env">temp_env</a></span>) (<span class="id">x</span>: <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#or_default_with">or_default_with</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_value">match_value</a></span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">ve</span>)) (<span class="id">le</span> ! <span class="id">x</span>).<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Staterep">Staterep</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="Staterep.ge">ge</a></span> : <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="staterep_mems">staterep_mems</a></span> (<span class="id">cls</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.class">class</a></span>) (<span class="id">me</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.menv">menv</a></span>) (<span class="id">b</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#block">block</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) '((<span class="id">x</span>, <span class="id">ty</span>): <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Staterep.ge">ge</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="id">cls</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id">d</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#contains_w">contains_w</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type_to_chunk">type_to_chunk</a></span> <span class="id">ty</span>) <span class="id">b</span> (<span class="id">ofs</span> + <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">d</span>) (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_value">match_value</a></span> (<span class="id"><a href="Velus.VelusMemory.html#find_val">find_val</a></span> <span class="id">x</span> <span class="id">me</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Errors.Error</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepfalse">sepfalse</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="find_class_dec">find_class_dec</a></span> (<span class="id">f</span>: <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id">p</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.program">program</a></span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> { <span class="id">cl_p</span>' | <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">f</span> <span class="id">p</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cl_p</span>'}.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">f</span> <span class="id">p</span>) <span class="kwd">as</span> [[<span class="id">c</span> <span class="id">p</span>']|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>; <span class="kwd">exists</span> (<span class="id">c</span>, <span class="id">p</span>'); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="find_class_dec_spec_None">find_class_dec_spec_None</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#find_class_dec">find_class_dec</a></span> <span class="id">f</span> <span class="id">p</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> &lt;-&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">f</span> <span class="id">p</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#find_class_dec">find_class_dec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">f</span> <span class="id">p</span>) <span class="kwd">as</span> [[]|]; <span class="id">split</span>; <span class="id">auto</span>; <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="staterep">staterep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">p</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.program">program</a></span>) (<span class="id">clsnm</span>: <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id">me</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.menv">menv</a></span>) (<span class="id">b</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#block">block</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>): <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Wf.html#Fix">Wf.Fix</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="Velus.Common.CommonProgram.html#ltsuffix_prog">ltsuffix_prog</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">x</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">y</span>)) <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> '(<span class="id">p</span>, (<span class="id">clsnm</span>, <span class="id">me</span>, <span class="id">ofs</span>)) <span class="id">staterep</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#find_class_dec">find_class_dec</a></span> <span class="id">clsnm</span> <span class="id">p</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepfalse">sepfalse</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">cl_p</span>' <span class="id">E</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">cl</span> ,<span class="id">p</span>') := <span class="id">cl_p</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_mems">staterep_mems</a></span> <span class="id">cl</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span>) <span class="id">cl</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_mems">c_mems</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> (<span class="kwd">fun</span> '((<span class="id">i</span>, <span class="id">c</span>): <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Staterep.ge">ge</a></span> <span class="id">i</span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="id">cl</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id">d</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">staterep</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">cl_p</span>', (<span class="id">c</span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.instance_match">instance_match</a></span> <span class="id">i</span> <span class="id">me</span>, <span class="id">ofs</span> + <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">d</span>)) <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Errors.Error</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepfalse">sepfalse</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) <span class="id">cl</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_objs">c_objs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) (<span class="id">p</span>, (<span class="id">clsnm</span>, <span class="id">me</span>, <span class="id">ofs</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="Velus.Common.CommonProgram.html#ltsuffix_prog_wf">ltsuffix_prog_wf</a></span> <span class="kwd">as</span> <span class="id">WF</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Program.Wf.html#measure_wf">Wf.measure_wf</a></span> <span class="kwd">in</span> <span class="id">WF</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">cl_p</span>'; <span class="id">simpl</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonProgram.html#find_unit_ltsuffix_prog">find_unit_ltsuffix_prog</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="staterep_objs">staterep_objs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">p</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.program">program</a></span>) (<span class="id">cls</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.class">class</a></span>) (<span class="id">me</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.menv">menv</a></span>) (<span class="id">b</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#block">block</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) '((<span class="id">i</span>, <span class="id">c</span>): <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Staterep.ge">ge</a></span> <span class="id">i</span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="id">cls</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id">d</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id">p</span> <span class="id">c</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.instance_match">instance_match</a></span> <span class="id">i</span> <span class="id">me</span>) <span class="id">b</span> (<span class="id">ofs</span> + <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#Error">Errors.Error</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepfalse">sepfalse</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="staterep_def">staterep_def</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">clsnm</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id">p</span> <span class="id">clsnm</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#or_default_with">or_default_with</a></span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepfalse">sepfalse</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> '(<span class="id">cl</span>, <span class="id">p</span>') =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_mems">staterep_mems</a></span> <span class="id">cl</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span>) <span class="id">cl</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_mems">c_mems</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_objs">staterep_objs</a></span> <span class="id">p</span>' <span class="id">cl</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span>) <span class="id">cl</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_objs">c_objs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">clsnm</span> <span class="id">p</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Common.Common.html#or_default_with">or_default_with</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_objs">staterep_objs</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Wf.html#Fix_eq">Fix_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#find_class_dec_spec_None">find_class_dec_spec_None</a></span> <span class="id">clsnm</span> <span class="id">p</span>) <span class="kwd">as</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#find_class_dec">find_class_dec</a></span> <span class="id">clsnm</span> <span class="id">p</span>) <span class="kwd">as</span> [[[] -&gt;]|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">E</span> <span class="kwd">as</span> [-&gt;]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> (<span class="id">p</span>' &amp;(( <span class="id">clsnm</span>' &amp; <span class="id">me</span>')&amp; <span class="id">ofs</span>')) ???.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#find_class_dec">find_class_dec</a></span> <span class="id">clsnm</span>' <span class="id">p</span>') <span class="kwd">as</span> [[[]]|]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_objs">c_objs</a></span> <span class="id">c</span>) <span class="kwd">as</span> [|[]]; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="staterep_objs_not_in">staterep_objs_not_in</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">objs</span> <span class="id">p</span> <span class="id">cls</span> <span class="id">me</span> <span class="id">i</span> <span class="id">me_i</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">i</span> <span class="id">objs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_objs">staterep_objs</a></span> <span class="id">p</span> <span class="id">cls</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span>) <span class="id">objs</span> &lt;-*-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_objs">staterep_objs</a></span> <span class="id">p</span> <span class="id">cls</span> (<span class="id"><a href="Velus.VelusMemory.html#add_inst">add_inst</a></span> <span class="id">i</span> <span class="id">me_i</span> <span class="id">me</span>) <span class="id">b</span> <span class="id">ofs</span>) <span class="id">objs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">objs</span> <span class="kwd">as</span> [|(<span class="id">o</span>, <span class="id">c</span>)]; <span class="id">intros</span> * <span class="id">Hnin</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NotInMembers_cons">NotInMembers_cons</a></span> <span class="kwd">in</span> <span class="id">Hnin</span> <span class="kwd">as</span> (?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sepconj_morph_2">sepconj_morph_2</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.instance_match">instance_match</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.VelusMemory.html#find_inst_gso">find_inst_gso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="staterep_chained_in_objs">staterep_chained_in_objs</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">f</span> <span class="id">cl</span> <span class="id">p</span>' <span class="id">i</span> <span class="id">g</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.wt_program">wt_program</a></span> <span class="id">p</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">f</span> <span class="id">p</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">cl</span>, <span class="id">p</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">i</span>, <span class="id">g</span>) <span class="id">cl</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_objs">c_objs</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id">p</span>' <span class="id">g</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span> &lt;-*-&gt; <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id">p</span> <span class="id">g</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">WTp</span> <span class="id">Find</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_def">staterep_def</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.wt_program_find_class_chained_in_objs">wt_program_find_class_chained_in_objs</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="decidable_footprint_staterep">decidable_footprint_staterep</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">clsnm</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#decidable_footprint">decidable_footprint</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id">p</span> <span class="id">clsnm</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">p</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonProgram.html#program_ind">program_ind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_def">staterep_def</a></span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">clsnm</span> <span class="id">p</span>) <span class="kwd">as</span> [[]|] <span class="id">eqn</span>: <span class="id">Find</span>; <span class="id">simpl</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">sep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#decidable_footprint_sepconj">decidable_footprint_sepconj</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#decidable_footprint_sepall">decidable_footprint_sepall</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">x</span>,?); <span class="id">simpl</span>; <span class="id">cases</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">sep</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="footprint_perm_staterep">footprint_perm_staterep</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">clsnm</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">b</span>' <span class="id">lo</span> <span class="id">hi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#footprint_perm_w">footprint_perm_w</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id">p</span> <span class="id">clsnm</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span>) <span class="id">b</span>' <span class="id">lo</span> <span class="id">hi</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">p</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonProgram.html#program_ind">program_ind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_def">staterep_def</a></span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">clsnm</span> <span class="id">p</span>) <span class="kwd">as</span> [[]|] <span class="id">eqn</span>: <span class="id">Find</span>; <span class="id">simpl</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">sep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#footprint_perm_sepconj">footprint_perm_sepconj</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#footprint_perm_sepall">footprint_perm_sepall</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">x</span>,?); <span class="id">simpl</span>; <span class="id">cases</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">sep</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Staterep">Staterep</a></span>.<br/>
<br/>
<div class="doc">The struct_in_bounds predicate.
    TODO: add explanatory text. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="StructInBounds">StructInBounds</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="StructInBounds.env">env</a></span> : <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="StructInBounds.env_consistent">env_consistent</a></span>: <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#composite_env_consistent">composite_env_consistent</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StructInBounds.env">env</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="struct_in_bounds">struct_in_bounds</a></span> (<span class="id">min</span> <span class="id">max</span> <span class="id">ofs</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">flds</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#members">Ctypes.members</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">min</span> &lt;= <span class="id">ofs</span> /\ <span class="id">ofs</span> + <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#sizeof_struct">sizeof_struct</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StructInBounds.env">env</a></span> <span class="id">flds</span> &lt;= <span class="id">max</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="struct_in_bounds_sizeof">struct_in_bounds_sizeof</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">co</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StructInBounds.env">env</a></span>!<span class="id">id</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">co</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#struct_in_bounds">struct_in_bounds</a></span> 0 (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#sizeof_struct">sizeof_struct</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StructInBounds.env">env</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">co</span>)) 0 (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">co</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#struct_in_bounds">struct_in_bounds</a></span>. <span class="id">auto</span> <span class="kwd">with</span> <span class="id">zarith</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="struct_in_bounds_weaken">struct_in_bounds_weaken</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">min</span>' <span class="id">max</span>' <span class="id">min</span> <span class="id">max</span> <span class="id">ofs</span> <span class="id">flds</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#struct_in_bounds">struct_in_bounds</a></span> <span class="id">min</span> <span class="id">max</span> <span class="id">ofs</span> <span class="id">flds</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">min</span>' &lt;= <span class="id">min</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">max</span> &lt;= <span class="id">max</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#struct_in_bounds">struct_in_bounds</a></span> <span class="id">min</span>' <span class="id">max</span>' <span class="id">ofs</span> <span class="id">flds</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#struct_in_bounds">struct_in_bounds</a></span>. <span class="id">destruct</span> 1; <span class="id">intros</span>. <span class="id">auto</span> <span class="kwd">with</span> <span class="id">zarith</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="struct_in_bounds_field">struct_in_bounds_field</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">min</span> <span class="id">max</span> <span class="id">ofs</span> <span class="id">flds</span> <span class="id">id</span> <span class="id">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#struct_in_bounds">struct_in_bounds</a></span> <span class="id">min</span> <span class="id">max</span> <span class="id">ofs</span> (<span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span> <span class="id">flds</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StructInBounds.env">env</a></span> <span class="id">id</span> (<span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span> <span class="id">flds</span>) = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id">d</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">min</span> &lt;= <span class="id">ofs</span> + <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">d</span> &lt;= <span class="id">max</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#struct_in_bounds">struct_in_bounds</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * (<span class="id">Hmin</span> &amp; <span class="id">Hmax</span>) <span class="id">Hfo</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Common.CompCertLib.html#field_offset_type">field_offset_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hfo</span>) <span class="kwd">as</span> (<span class="id">ty</span> &amp; <span class="id">Hft</span>). <span class="id">destruct</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Common.CompCertLib.html#field_offset_mk_members">field_offset_mk_members</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hfo</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset_in_range">field_offset_in_range</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hfo</span> <span class="id">Hft</span>) <span class="kwd">as</span> (<span class="id">H0d</span> &amp; <span class="id">Hsize</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">auto</span>; <span class="id">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_le_mono">Z.add_le_mono</a></span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">zarith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (2:=<span class="id">Hsize</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_0_r_reverse">Zplus_0_r_reverse</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span> <span class="kwd">using</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ge_le">Z.ge_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#sizeof_pos">sizeof_pos</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StructInBounds.env">env</a></span> <span class="id">ty</span>)) <span class="kwd">with</span> <span class="id">zarith</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="struct_in_struct_in_bounds">struct_in_struct_in_bounds</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">min</span> <span class="id">max</span> <span class="id">ofs</span> <span class="id">flds</span> <span class="id">id</span> <span class="id">sid</span> <span class="id">d</span> <span class="id">co</span> <span class="id">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#struct_in_bounds">struct_in_bounds</a></span> <span class="id">min</span> <span class="id">max</span> <span class="id">ofs</span> (<span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span> <span class="id">flds</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StructInBounds.env">env</a></span> <span class="id">id</span> (<span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span> <span class="id">flds</span>) = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id">d</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_type">field_type</a></span> <span class="id">id</span> (<span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span> <span class="id">flds</span>) = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Tstruct">Tstruct</a></span> <span class="id">sid</span> <span class="id">a</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StructInBounds.env">env</a></span>!<span class="id">sid</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">co</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_su">co_su</a></span> <span class="id">co</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Struct">Struct</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#struct_in_bounds">struct_in_bounds</a></span> <span class="id">min</span> <span class="id">max</span> (<span class="id">ofs</span> + <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">d</span>) (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">co</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#struct_in_bounds">struct_in_bounds</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * (<span class="id">Hmin</span> &amp; <span class="id">Hmax</span>) <span class="id">Hfo</span> <span class="id">Hft</span> <span class="id">Henv</span> <span class="id">Hsu</span>. <span class="id">destruct</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Common.CompCertLib.html#field_offset_mk_members">field_offset_mk_members</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hfo</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset_in_range">field_offset_in_range</a></span> <span class="kwd">with</span> (1:=<span class="id">Hfo</span>) <span class="kwd">in</span> <span class="id">Hft</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hft</span> <span class="kwd">as</span> (<span class="id">Hd0</span> &amp; <span class="id">Hsizeof</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">split</span>; <span class="id">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zplus_le_compat_l">Zplus_le_compat_l</a></span> <span class="kwd">with</span> (<span class="id">p</span>:=<span class="id">ofs</span>) <span class="kwd">in</span> <span class="id">Hsizeof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (1:=<span class="id">Hsizeof</span>) <span class="kwd">in</span> <span class="id">Hmax</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (2:=<span class="id">Hmax</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">rewrite</span> <span class="id">Henv</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_assoc">Z.add_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_le_mono_l">Z.add_le_mono_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StructInBounds.env_consistent">env_consistent</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Henv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_consistent_sizeof">co_consistent_sizeof</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StructInBounds.env_consistent">env_consistent</a></span>), <span class="id">Hsu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Coqlib.html#align_le">align_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_alignof_two_p">co_alignof_two_p</a></span> <span class="id">co</span>) <span class="kwd">as</span> (<span class="id">n</span> &amp; <span class="id">H2p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H2p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Coqlib.html#two_power_nat_pos">two_power_nat_pos</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StructInBounds">StructInBounds</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="StateRepProperties">StateRepProperties</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="StateRepProperties.prog">prog</a></span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.program">program</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="StateRepProperties.gcenv">gcenv</a></span>: <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="StateRepProperties.gcenv_consistent">gcenv_consistent</a></span>: <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#composite_env_consistent">composite_env_consistent</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="StateRepProperties.make_members_co">make_members_co</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">clsnm</span> <span class="id">cls</span> <span class="id">prog</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">clsnm</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.prog">prog</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">cls</span>, <span class="id">prog</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">exists</span> <span class="id">co</span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span>!<span class="id">clsnm</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">co</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_su">co_su</a></span> <span class="id">co</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Struct">Struct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">co</span> = <span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="id">cls</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#attr_alignas">attr_alignas</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_attr">co_attr</a></span> <span class="id">co</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#name_member">name_member</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">co</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">co</span>.(<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_sizeof">co_sizeof</a></span>) &lt;= <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">struct_in_struct_in_bounds</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">min</span> <span class="id">max</span> <span class="id">ofs</span> <span class="id">clsid</span> <span class="id">cls</span> <span class="id">o</span> <span class="id">c</span> <span class="id">cls</span>' <span class="id">prog</span>' <span class="id">prog</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.wt_program">wt_program</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.prog">prog</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">clsid</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.prog">prog</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">cls</span>, <span class="id">prog</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#struct_in_bounds">struct_in_bounds</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id">min</span> <span class="id">max</span> <span class="id">ofs</span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="id">cls</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">o</span>, <span class="id">c</span>) <span class="id">cls</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_objs">c_objs</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">c</span> <span class="id">prog</span>' = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">cls</span>', <span class="id">prog</span>'') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">d</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id">o</span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="id">cls</span>) = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#struct_in_bounds">struct_in_bounds</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id">min</span> <span class="id">max</span> (<span class="id">ofs</span> + <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">d</span>) (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="id">cls</span>').<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">WTp</span> <span class="id">Hfc</span> <span class="id">Hsb</span> <span class="id">Hin</span> <span class="id">Hfc</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#c_objs_field_offset">c_objs_field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hin</span>) <span class="kwd">as</span> (<span class="id">d</span> &amp; <span class="id">Hfo</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">d</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.make_members_co">make_members_co</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hfc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">cls_co</span> &amp; <span class="id">Hg</span> &amp; <span class="id">Hsu</span> &amp; <span class="id">Hmem</span> &amp; <span class="id">Hattr</span> &amp; <span class="id">Hndup</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">Hmem</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonTyping.html#wt_program_find_unit_chained">wt_program_find_unit_chained</a></span> <span class="kwd">with</span> (1:=<span class="id">WTp</span>) (2:=<span class="id">Hfc</span>) <span class="kwd">in</span> <span class="id">Hfc</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.make_members_co">make_members_co</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hfc</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">cls</span>'<span class="id">_co</span> &amp; <span class="id">Hg</span>' &amp; <span class="id">Hsu</span>' &amp; <span class="id">Hmem</span>' &amp; <span class="id">Hattr</span>' &amp; <span class="id">Hndup</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">Hmem</span>' <span class="kwd">in</span> *. <span class="id">destruct</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Common.CompCertLib.html#field_offset_type">field_offset_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hfo</span>) <span class="kwd">as</span> (<span class="id">ty</span> &amp; <span class="id">Hty</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#struct_in_struct_in_bounds">struct_in_struct_in_bounds</a></span> <span class="kwd">with</span> (<span class="id">a</span>:=<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#noattr">noattr</a></span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">setoid_rewrite</span> &lt;-<span class="id">Hmem</span>; <span class="id">eauto</span>. <span class="id">rewrite</span> <span class="id">Hmem</span> <span class="kwd">in</span> <span class="id">Hsb</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">make_members_co</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Show&nbsp;that&nbsp;the&nbsp;field_type&nbsp;is&nbsp;a&nbsp;Tstruct&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">cls</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_nodup">c_nodup</a></span>) <span class="kwd">as</span> <span class="id">Hnodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation.Permutation_app_comm</a></span> <span class="kwd">in</span> <span class="id">Hnodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (~<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">o</span> <span class="id">cls</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_mems">c_mems</a></span>)) <span class="kwd">as</span> <span class="id">Hnmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_In">NoDup_app_In</a></span> <span class="kwd">with</span> (<span class="id">x</span>:=<span class="id">o</span>) <span class="kwd">in</span> <span class="id">Hnodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> <span class="id">Hin</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_weaken">NoDup_app_weaken</a></span> <span class="kwd">in</span> <span class="id">Hnodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hnodup</span> <span class="id">Hty</span> <span class="id">Hin</span>. <span class="id">rewrite</span> <span class="id">Hmem</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CompCertLib.html#field_type_skip_app">field_type_skip_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#InMembers_translate_param_idem">InMembers_translate_param_idem</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">cls</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_objs">c_objs</a></span>) <span class="kwd">as</span> [|<span class="id">x</span> <span class="id">xs</span> <span class="id">IH</span>]; [<span class="id">now</span> <span class="id">inversion</span> 1|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span> <span class="kwd">as</span> [<span class="id">o</span>' <span class="id">c</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#ident_eq_dec">ident_eq_dec</a></span> <span class="id">o</span> <span class="id">o</span>') <span class="kwd">as</span> [<span class="id">He</span>|<span class="id">Hne</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id">He</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Coqlib.html#peq_true">peq_true</a></span>. <span class="id">intros</span> <span class="id">Hnodup</span> ? <span class="id">Hoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hoc</span> <span class="kwd">as</span> [<span class="id">Hoc</span>|<span class="id">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">injection</span> <span class="id">Hoc</span>; <span class="id">intros</span> <span class="id">R1</span>; <span class="id">rewrite</span> &lt;-<span class="id">R1</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">Hnodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:~<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">contradiction</span> <span class="id">H</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>. <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl</span>; <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Coqlib.html#peq_false">peq_false</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">Hnodup</span> <span class="id">Hft</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">injection</span> <span class="id">H</span>; <span class="id">intros</span> <span class="id">R1</span> <span class="id">R2</span>; <span class="id">rewrite</span> &lt;-<span class="id">R1</span>,&lt;-<span class="id">R2</span> <span class="kwd">in</span> *; <span class="id">contradiction</span> <span class="id">Hne</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hnodup</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Z.divide_trans</span> : <span class="id">zarith</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="range_staterep">range_staterep</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">clsnm</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.wt_program">wt_program</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.prog">prog</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">clsnm</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.prog">prog</a></span> &lt;&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#range_w">range_w</a></span> <span class="id">b</span> 0 (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst">type_of_inst</a></span> <span class="id">clsnm</span>)) -*&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.prog">prog</a></span> <span class="id">clsnm</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.mempty">mempty</a></span> <span class="id">b</span> 0.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">WTp</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Weaken&nbsp;the&nbsp;goal&nbsp;for&nbsp;proof&nbsp;by&nbsp;induction.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut</span> (<span class="kwd">forall</span> <span class="id">lo</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst">type_of_inst</a></span> <span class="id">clsnm</span>) | <span class="id">lo</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert_imp">massert_imp</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#range_w">range_w</a></span> <span class="id">b</span> <span class="id">lo</span> (<span class="id">lo</span> + <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst">type_of_inst</a></span> <span class="id">clsnm</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.prog">prog</a></span> <span class="id">clsnm</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.mempty">mempty</a></span> <span class="id">b</span> <span class="id">lo</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">intro</span> <span class="id">HH</span>; <span class="id">apply</span> <span class="id">HH</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_0_r">Z.divide_0_r</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Setup&nbsp;an&nbsp;induction&nbsp;on&nbsp;prog.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">clsnm</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.prog">prog</a></span> <span class="kwd">as</span> [? <span class="id">IH</span>] <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonProgram.html#program_ind">program_ind</a></span>; <span class="id">intros</span> ??? <span class="id">Halign</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#not_None_is_Some">not_None_is_Some</a></span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> ((<span class="id">cls</span>', <span class="id">prog</span>'') &amp; <span class="id">Hfind</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Exploit&nbsp;make_members_co&nbsp;for&nbsp;the&nbsp;named&nbsp;class.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.make_members_co">make_members_co</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hfind</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">co</span> &amp; <span class="id">Hg</span> &amp; <span class="id">Hsu</span> &amp; <span class="id">Hmem</span> &amp; <span class="id">Hattr</span> &amp; <span class="id">Hndup</span> &amp; ?).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Develop&nbsp;some&nbsp;facts&nbsp;about&nbsp;member&nbsp;alignment.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Common.CompCertLib.html#co_members_alignof">co_members_alignof</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hmem</span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv_consistent">gcenv_consistent</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hg</span>) <span class="id">Hattr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">Hcoal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hmem</span> <span class="kwd">in</span> <span class="id">Hcoal</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="kwd">in</span> <span class="id">Hcoal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_app">Forall_app</a></span> <span class="kwd">in</span> <span class="id">Hcoal</span> <span class="kwd">as</span> [<span class="id">Hcoal1</span> <span class="id">Hcoal2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Halign</span>. <span class="id">rewrite</span> <span class="id">Hg</span>, <span class="id"><a href="Velus.Common.CompCertLib.html#align_noattr">align_noattr</a></span> <span class="kwd">in</span> <span class="id">Halign</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hndup</span>':=<span class="id">Hndup</span>). <span class="id">rewrite</span> <span class="id">Hmem</span> <span class="kwd">in</span> <span class="id">Hndup</span>'.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Massage&nbsp;the&nbsp;goal&nbsp;into&nbsp;two&nbsp;parallel&nbsp;parts:&nbsp;for&nbsp;locals&nbsp;and&nbsp;instances.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_def">staterep_def</a></span>, <span class="id">Hfind</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_mems">staterep_mems</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_objs">staterep_objs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hg</span>, &lt;-<span class="id">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#split_range_fields">split_range_fields</a></span>. 2-6:<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_app">sepall_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sep_imp</span>'.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Divide&nbsp;up&nbsp;the&nbsp;memory&nbsp;sub-block&nbsp;for&nbsp;cls.(c_mems).&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#field_translate_mem_type">field_translate_mem_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hfind</span>) <span class="kwd">as</span> <span class="id">Htype</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hmem</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_map">sepall_map</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_weakenp">sepall_weakenp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (?&amp;?) <span class="id">Hin</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hfo</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gempty">Env.gempty</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#sizeof_translate_type_chunk">sizeof_translate_type_chunk</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">range_contains</span>'; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">mem</span>. <span class="id">destruct</span> <span class="id">p0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">field_offset_aligned</span>' <span class="kwd">in</span> <span class="id">Hfo</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_add_r">Z.divide_add_r</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_trans">Z.divide_trans</a></span> <span class="kwd">with</span> <span class="id">clight</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span> <span class="kwd">in</span> <span class="id">Hcoal1</span>. <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hcoal1</span>; <span class="id">eauto</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">zarith</span> <span class="id">clight</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Divide&nbsp;up&nbsp;the&nbsp;memory&nbsp;sub-block&nbsp;for&nbsp;cls.(c_objs).&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#field_translate_obj_type">field_translate_obj_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hfind</span>) <span class="kwd">as</span> <span class="id">Htype</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">Hmem</span> <span class="kwd">in</span> <span class="id">Htype</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.Common.CommonTyping.html#wt_program_find_unit">wt_program_find_unit</a></span> <span class="kwd">as</span> [<span class="id">WTc</span> <span class="id">WTp</span>']; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">WTc</span> <span class="kwd">as</span> [<span class="id">Ho</span> <span class="id">Hm</span>]; <span class="id">clear</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hmem</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_map">sepall_map</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_weakenp">sepall_weakenp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (?&amp;?) <span class="id">Hin</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hfo</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.instance_match_empty">instance_match_empty</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Htype</span> <span class="id">i</span> <span class="id">i0</span> <span class="id">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">clsnm</span> <span class="id">cls</span> <span class="id">prog</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">clsnm</span> <span class="id">prog</span>'' = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">cls</span>, <span class="id">prog</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">co</span> : <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#composite">composite</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> ! <span class="id">clsnm</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">co</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_su">co_su</a></span> <span class="id">co</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Struct">Struct</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">co</span> = <span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="id">cls</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#attr_alignas">attr_alignas</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_attr">co_attr</a></span> <span class="id">co</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#name_member">name_member</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">co</span>)) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_sizeof">co_sizeof</a></span> <span class="id">co</span> &lt;= <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>) <span class="kwd">as</span> <span class="id">make_members_co</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.make_members_co">make_members_co</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonTyping.html#wt_program_find_unit_chained">wt_program_find_unit_chained</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Ho</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hfind</span>':=<span class="id">Ho</span>). <span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#not_None_is_Some">not_None_is_Some</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>' <span class="kwd">as</span> ((<span class="id">c</span>' &amp; <span class="id">prog</span>''') &amp; <span class="id">Hfind</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">make_members_co</span>' <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hfind</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">co</span>' &amp; <span class="id">Hg</span>' &amp; <span class="id">Hsu</span>' &amp; <span class="id">Hmem</span>' &amp; <span class="id">Hattr</span>' &amp; <span class="id">Hnodup</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">rewrite</span> <span class="id">Hg</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IH</span> <span class="kwd">with</span> (<span class="id">lo</span>:=<span class="id">lo</span> + <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">p0</span>) <span class="kwd">in</span> <span class="id">make_members_co</span>'; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hg</span>' <span class="kwd">in</span> <span class="id">make_members_co</span>'; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span> <span class="kwd">in</span> <span class="id">Hcoal2</span>. <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hcoal2</span>; <span class="id">eauto</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_add_r">Z.divide_add_r</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_trans">Z.divide_trans</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">p0</span>. <span class="id">eapply</span> <span class="id">field_offset_aligned</span>' <span class="kwd">in</span> <span class="id">Hfo</span>; <span class="id">eauto</span>. 2:<span class="id">rewrite</span> <span class="id">Hmem</span> <span class="kwd">in</span> <span class="id">Htype</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hg</span>', <span class="id"><a href="Velus.Common.CompCertLib.html#align_noattr">align_noattr</a></span> <span class="kwd">in</span> *; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">zarith</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Opaque</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sepconj">sepconj</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="staterep_deref_mem">staterep_deref_mem</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">clsnm</span> <span class="id">c</span> <span class="id">prog</span> <span class="id">prog</span>' <span class="id">m</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">x</span> <span class="id">ty</span> <span class="id">d</span> <span class="id">v</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">clsnm</span> <span class="id">prog</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span>, <span class="id">prog</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id">prog</span> <span class="id">clsnm</span>  <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span> ** <span class="id">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">x</span>, <span class="id">ty</span>) <span class="id">c</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_mems">c_mems</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.VelusMemory.html#find_val">find_val</a></span> <span class="id">x</span> <span class="id">me</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="id">c</span>) = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id">d</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#deref_loc">Clight.deref_loc</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#translate_type">translate_type</a></span> <span class="id">ty</span>) <span class="id">m</span> <span class="id">b</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id">ofs</span> + <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">d</span>)) <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Full">Full</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#value_to_cvalue">value_to_cvalue</a></span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Find</span> <span class="id">Hm</span> <span class="id">Hin</span> <span class="id">Hv</span> <span class="id">Hoff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_def">staterep_def</a></span>, <span class="id">Find</span> <span class="kwd">in</span> <span class="id">Hm</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_in">sepall_in</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">ws</span> [<span class="id">xs</span> [<span class="id">Hsplit</span> <span class="id">Hin</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hin</span> <span class="kwd">in</span> <span class="id">Hm</span>. <span class="id">clear</span> <span class="id">Hsplit</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">Hm</span>. <span class="id">clear</span> <span class="id">ws</span> <span class="id">xs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_mems">staterep_mems</a></span> <span class="kwd">in</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hoff</span> <span class="kwd">in</span> <span class="id">Hm</span>. <span class="id">clear</span> <span class="id">Hoff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#loadv_rule">loadv_rule</a></span> <span class="kwd">in</span> <span class="id">Hm</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hm</span> <span class="kwd">as</span> [<span class="id">v</span>' [<span class="id">Hloadv</span> <span class="id">Hmatch</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_value">match_value</a></span> <span class="kwd">in</span> <span class="id">Hmatch</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hmatch</span>; <span class="id">clear</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hmatch</span> <span class="kwd">in</span> <span class="id">Hloadv</span>; <span class="id">clear</span> <span class="id">Hmatch</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#deref_loc_value">Clight.deref_loc_value</a></span> <span class="kwd">with</span> (2:=<span class="id">Hloadv</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">clight</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="staterep_field_offset">staterep_field_offset</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">me</span> <span class="id">c</span> <span class="id">prog</span>' <span class="id">cls</span> <span class="id">prog</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">x</span> <span class="id">ty</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">c</span> <span class="id">prog</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">cls</span>, <span class="id">prog</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id">prog</span> <span class="id">c</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span> ** <span class="id">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">x</span>, <span class="id">ty</span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_mems">c_mems</a></span> <span class="id">cls</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">d</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="id">cls</span>) = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ 0 &lt;= <span class="id">ofs</span> + <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">d</span> &lt;= <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Find</span> <span class="id">Hm</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_def">staterep_def</a></span>, <span class="id">Find</span> <span class="kwd">in</span> <span class="id">Hm</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_in">sepall_in</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">ws</span> [<span class="id">xs</span> [<span class="id">Hsplit</span> <span class="id">Hin</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hin</span> <span class="kwd">in</span> <span class="id">Hm</span>. <span class="id">clear</span> <span class="id">Hsplit</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">ws</span> <span class="id">xs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_mems">staterep_mems</a></span> <span class="kwd">in</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="id">cls</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="kwd">exists</span> <span class="id">p</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#contains_no_overflow">contains_no_overflow</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">contradict</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="staterep_extract">staterep_extract</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cid</span> <span class="id">c</span> <span class="id">prog</span>' <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">m</span> <span class="id">i</span> <span class="id">c</span>' <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.wt_program">wt_program</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.prog">prog</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">cid</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.prog">prog</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span>, <span class="id">prog</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">i</span>, <span class="id">c</span>') <span class="id">c</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_objs">c_objs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.prog">prog</a></span> <span class="id">cid</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span> ** <span class="id">P</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="kwd">exists</span> <span class="id">objs</span> <span class="id">objs</span>' <span class="id">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_objs">c_objs</a></span>) = <span class="id">objs</span> ++ (<span class="id">i</span>, <span class="id">c</span>') :: <span class="id">objs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id">i</span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="id">c</span>) = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.prog">prog</a></span> <span class="id">c</span>' (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.instance_match">instance_match</a></span> <span class="id">i</span> <span class="id">me</span>) <span class="id">b</span> (<span class="id">ofs</span> + <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_mems">staterep_mems</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id">c</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span>) <span class="id">c</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_mems">c_mems</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_objs">staterep_objs</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.prog">prog</a></span> <span class="id">c</span> <span class="id">me</span> <span class="id">b</span> <span class="id">ofs</span>) (<span class="id">objs</span> ++ <span class="id">objs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">P</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">make_members_co</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">WT</span> <span class="id">Find</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_def">staterep_def</a></span>, <span class="id">Find</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> (<span class="id">Hin</span> &amp; <span class="id">Hmem</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_in">sepall_in</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (<span class="id">objs</span> &amp; <span class="id">objs</span>' &amp; <span class="id">E</span> &amp; <span class="id">Hp</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hp</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_objs">staterep_objs</a></span> <span class="kwd">at</span> 1 <span class="kwd">in</span> <span class="id">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties.gcenv">gcenv</a></span> <span class="id">i</span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="id">c</span>)) <span class="kwd">as</span> [<span class="id">d</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepconj_sepfalse">sepconj_sepfalse</a></span> <span class="kwd">in</span> <span class="id">Hmem</span>; <span class="id">contradiction</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">objs</span>, <span class="id">objs</span>', <span class="id">d</span>; <span class="id">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_chained_in_objs">staterep_chained_in_objs</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_imp">sep_imp</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">apply</span> <span class="id">sep_imp</span>'; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_weakenp">sepall_weakenp</a></span>; <span class="id">intros</span> (<span class="id">i</span>' &amp; <span class="id">c</span>'') <span class="id">Hin</span>'; <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_objs">staterep_objs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">i</span>', <span class="id">c</span>'') (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_objs">c_objs</a></span> <span class="id">c</span>)) <span class="kwd">as</span> <span class="id">Hin</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">rewrite</span> <span class="id">E</span>, <span class="id"><a href="Velus.Common.CommonList.html#in_app">in_app</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Coqlib.html#in_cns">in_cns</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#in_app">in_app</a></span> <span class="kwd">in</span> <span class="id">Hin</span>'; <span class="id">tauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_chained_in_objs">staterep_chained_in_objs</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> (<span class="id">objs</span> &amp; <span class="id">objs</span>' &amp; <span class="id">d</span> &amp; <span class="id">E</span> &amp; <span class="id">Hofs</span> &amp; <span class="id">Hmem</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">E</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#in_app">in_app</a></span>; <span class="id">right</span>; <span class="id">left</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> (<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_breakout">sepall_breakout</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_objs">c_objs</a></span> <span class="id">c</span>)), <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap">sep_swap</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_objs">staterep_objs</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hofs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">i</span>, <span class="id">c</span>') (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_objs">c_objs</a></span> <span class="id">c</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">rewrite</span> <span class="id">E</span>, <span class="id"><a href="Velus.Common.CommonList.html#in_app">in_app</a></span>; <span class="id">right</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_eq">in_eq</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_chained_in_objs">staterep_chained_in_objs</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_imp">sep_imp</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">apply</span> <span class="id">sep_imp</span>'; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_weakenp">sepall_weakenp</a></span>; <span class="id">intros</span> (<span class="id">i</span>' &amp; <span class="id">c</span>'') <span class="id">Hin</span>'; <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_objs">staterep_objs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">i</span>', <span class="id">c</span>'') (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_objs">c_objs</a></span> <span class="id">c</span>)) <span class="kwd">as</span> <span class="id">Hin</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">rewrite</span> <span class="id">E</span>, <span class="id"><a href="Velus.Common.CommonList.html#in_app">in_app</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Coqlib.html#in_cns">in_cns</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#in_app">in_app</a></span> <span class="kwd">in</span> <span class="id">Hin</span>'; <span class="id">tauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_chained_in_objs">staterep_chained_in_objs</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#StateRepProperties">StateRepProperties</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Fieldsrep">Fieldsrep</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="Fieldsrep.ge">ge</a></span> : <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="Fieldsrep.ge_consistent">ge_consistent</a></span> : <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#composite_env_consistent">composite_env_consistent</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Fieldsrep.ge">ge</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="fieldrep">fieldrep</a></span> (<span class="id">ve</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.venv">venv</a></span>) (<span class="id">flds</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#members">members</a></span>) (<span class="id">b</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#block">block</a></span>) '((<span class="id">x</span>, <span class="id">ty</span>) : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#type">Ctypes.type</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Fieldsrep.ge">ge</a></span> <span class="id">x</span> <span class="id">flds</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#access_mode">access_mode</a></span> <span class="id">ty</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id">d</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#By_value">By_value</a></span> <span class="id">chunk</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#contains">contains</a></span> <span class="id">chunk</span> <span class="id">b</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">d</span>) (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_value">match_value</a></span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">ve</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepfalse">sepfalse</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="fieldsrep">fieldsrep</a></span> (<span class="id">ve</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.venv">venv</a></span>) (<span class="id">ms</span> : <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#members">members</a></span>) (<span class="id">b</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#block">block</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldrep">fieldrep</a></span> <span class="id">ve</span> <span class="id">ms</span> <span class="id">b</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#name_member">name_member</a></span> <span class="id">m</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#type_member">type_member</a></span> <span class="id">m</span>)) <span class="id">ms</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fieldsrep_deref_mem">fieldsrep_deref_mem</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">ve</span> <span class="id">flds</span> <span class="id">b</span> <span class="id">x</span> <span class="id">ty</span> <span class="id">d</span> <span class="id">v</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="id">ve</span> <span class="id">flds</span> <span class="id">b</span> ** <span class="id">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Member_plain">Member_plain</a></span> <span class="id">x</span> <span class="id">ty</span>) <span class="id">flds</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">ve</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Fieldsrep.ge">ge</a></span> <span class="id">x</span> <span class="id">flds</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id">d</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#deref_loc">Clight.deref_loc</a></span> <span class="id">ty</span> <span class="id">m</span> <span class="id">b</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">d</span>)) <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Full">Full</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#value_to_cvalue">value_to_cvalue</a></span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hm</span> <span class="id">Hin</span> <span class="id">Hv</span> <span class="id">Hoff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="kwd">in</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_in">sepall_in</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">ws</span> [<span class="id">xs</span> [<span class="id">Hsplit</span> <span class="id">Hin</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hin</span> <span class="kwd">in</span> <span class="id">Hm</span>. <span class="id">clear</span> <span class="id">Hsplit</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">Hm</span>. <span class="id">clear</span> <span class="id">ws</span> <span class="id">xs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldrep">fieldrep</a></span> <span class="kwd">in</span> <span class="id">Hm</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hm</span>; <span class="id">rewrite</span> <span class="id">Hoff</span> <span class="kwd">in</span> <span class="id">Hm</span>. <span class="id">clear</span> <span class="id">Hoff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#access_mode">access_mode</a></span> <span class="id">ty</span>) <span class="id">eqn</span>:<span class="id">Haccess</span>; <span class="id">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#loadv_rule">loadv_rule</a></span> <span class="kwd">in</span> <span class="id">Hm</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hm</span> <span class="kwd">as</span> [<span class="id">v</span>' [<span class="id">Hloadv</span> <span class="id">Hmatch</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_value">match_value</a></span> <span class="kwd">in</span> <span class="id">Hmatch</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hmatch</span>. <span class="id">clear</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hmatch</span> <span class="kwd">in</span> <span class="id">Hloadv</span>. <span class="id">clear</span> <span class="id">Hmatch</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#deref_loc_value">Clight.deref_loc_value</a></span> <span class="kwd">with</span> (1:=<span class="id">Haccess</span>) (2:=<span class="id">Hloadv</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="footprint_perm_fieldsrep">footprint_perm_fieldsrep</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ve</span> <span class="id">flds</span> <span class="id">b</span> <span class="id">b</span>' <span class="id">lo</span> <span class="id">hi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#footprint_perm">footprint_perm</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="id">ve</span> <span class="id">flds</span> <span class="id">b</span>) <span class="id">b</span>' <span class="id">lo</span> <span class="id">hi</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#footprint_perm_sepall">footprint_perm_sepall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">b</span>'' <span class="id">lo</span>' <span class="id">hi</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldrep">fieldrep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Fieldsrep.ge">ge</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#name_member">name_member</a></span> <span class="id">x</span>) <span class="id">flds</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#footprint_perm_sepfalse">footprint_perm_sepfalse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#access_mode">access_mode</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#type_member">type_member</a></span> <span class="id">x</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#footprint_perm_sepfalse">footprint_perm_sepfalse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#footprint_perm_contains">footprint_perm_contains</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="footprint_decidable_fieldsrep">footprint_decidable_fieldsrep</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ve</span> <span class="id">flds</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#decidable_footprint">decidable_footprint</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="id">ve</span> <span class="id">flds</span> <span class="id">b</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#decidable_footprint_sepall">decidable_footprint_sepall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">m</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldrep">fieldrep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Fieldsrep.ge">ge</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#name_member">name_member</a></span> <span class="id">m</span>) <span class="id">flds</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#decidable_footprint_sepfalse">decidable_footprint_sepfalse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#access_mode">access_mode</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#type_member">type_member</a></span> <span class="id">m</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#decidable_footprint_sepfalse">decidable_footprint_sepfalse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#decidable_footprint_contains">decidable_footprint_contains</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">fieldsrep_empty</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">flds</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">flds</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">x</span>, <span class="id">ty</span>) <span class="id">flds</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">chunk</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#access_mode">access_mode</a></span> <span class="id">ty</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#By_value">By_value</a></span> <span class="id">chunk</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Memdata.html#align_chunk">Memdata.align_chunk</a></span> <span class="id">chunk</span> | <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Fieldsrep.ge">ge</a></span> <span class="id">ty</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> (<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#field_range">field_range</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Fieldsrep.ge">ge</a></span> <span class="id">flds</span> <span class="id">b</span> 0) <span class="id">flds</span> &lt;-*-&gt; <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.vempty">vempty</a></span> (<span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span> <span class="id">flds</span>) <span class="id">b</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hndups</span> <span class="id">Hchunk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_map">sepall_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_swapp">sepall_swapp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">x</span>&amp;<span class="id">ty</span>) <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span>, <span class="id">field_range</span>', <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldrep">fieldrep</a></span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Fieldsrep.ge">ge</a></span> <span class="id">x</span> <span class="id">_</span>) <span class="kwd">as</span> [(?&amp;?)|] <span class="id">eqn</span>:<span class="id">Hoff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">field_offset_aligned</span>' <span class="kwd">with</span> (<span class="id">ty</span>:=<span class="id">ty</span>) <span class="kwd">in</span> <span class="id">Hoff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">apply</span> <span class="id"><a href="Velus.Common.CompCertLib.html#in_field_type">in_field_type</a></span> <span class="kwd">with</span> (1:=<span class="id">Hndups</span>) (2:=<span class="id">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">Hchunk</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hin</span>) <span class="kwd">as</span> [<span class="id">chunk</span> [<span class="id">Haccess</span> <span class="id">Halign</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Haccess</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">split</span>|<span class="id">split</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> <span class="id">m</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gempty">Env.gempty</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">range_contains</span>'; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_trans">Z.divide_trans</a></span> <span class="kwd">with</span> (1:=<span class="id">Halign</span>) (2:=<span class="id">Hoff</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id"><a href="Velus.Common.CompCertLib.html#sizeof_by_value">sizeof_by_value</a></span> <span class="kwd">with</span> (1:=<span class="id">Haccess</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CompCertLib.html#sizeof_by_value">sizeof_by_value</a></span> <span class="kwd">with</span> (1:=<span class="id">Haccess</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CompCertLib.html#sizeof_by_value">sizeof_by_value</a></span> <span class="kwd">with</span> (1:=<span class="id">Haccess</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">now</span> <span class="id">apply</span> <span class="id">contains_range</span>' <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;NB:&nbsp;requires&nbsp;"new"&nbsp;definition&nbsp;of&nbsp;contains&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CompCertLib.html#sizeof_by_value">sizeof_by_value</a></span> <span class="kwd">with</span> (1:=<span class="id">Haccess</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fieldsrep_empty">fieldsrep_empty</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">nm</span> <span class="id">co</span> <span class="id">flds</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Fieldsrep.ge">ge</a></span>!<span class="id">nm</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">co</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_su">co_su</a></span> <span class="id">co</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Struct">Struct</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">co</span> = <span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span> <span class="id">flds</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#name_member">name_member</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">co</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Member_plain">Member_plain</a></span> <span class="id">x</span> <span class="id">ty</span>) (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">co</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">chunk</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#access_mode">access_mode</a></span> <span class="id">ty</span> = <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#By_value">By_value</a></span> <span class="id">chunk</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Memdata.html#align_chunk">Memdata.align_chunk</a></span> <span class="id">chunk</span> | <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Fieldsrep.ge">ge</a></span> <span class="id">ty</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#range">range</a></span> <span class="id">b</span> 0 (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_sizeof">co_sizeof</a></span> <span class="id">co</span>) -*&gt; <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.vempty">vempty</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">co</span>) <span class="id">b</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hco</span> <span class="id">Hstruct</span> <span class="id">Hmem</span> <span class="id">Hndups</span> <span class="id">Hchunk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#split_range_fields">split_range_fields</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (1:=<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Fieldsrep.ge_consistent">ge_consistent</a></span>) (2:=<span class="id">Hco</span>) (3:=<span class="id">Hstruct</span>) (4:=<span class="id">Hmem</span>) (5:=<span class="id">Hndups</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">Hmem</span>, <span class="id">fieldsrep_empty</span>'. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id">Hmem</span>, <span class="id"><a href="Velus.Common.CompCertLib.html#mk_members_names">mk_members_names</a></span>, &lt;-<span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span> <span class="kwd">in</span> <span class="id">Hndups</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">eapply</span> <span class="id">Hchunk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hmem</span>. <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>; <span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">eauto</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fieldsrep_any_empty">fieldsrep_any_empty</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">flds</span> <span class="id">ve</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="id">ve</span> <span class="id">flds</span> <span class="id">b</span> -*&gt; <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.vempty">vempty</a></span> <span class="id">flds</span> <span class="id">b</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">flds</span> <span class="id">ve</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_weakenp">sepall_weakenp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">f</span> <span class="id">Hin</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldrep">fieldrep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Fieldsrep.ge">ge</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#name_member">name_member</a></span> <span class="id">f</span>) <span class="id">flds</span>); <span class="id">try</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#access_mode">access_mode</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#type_member">type_member</a></span> <span class="id">f</span>)); <span class="id">try</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#contains_imp">contains_imp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gempty">Env.gempty</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fieldsrep_nodup">fieldsrep_nodup</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">xs</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span>)) <span class="id">vs</span> <span class="id">flds</span> <span class="id">ve</span> <span class="id">ob</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">xs</span> ++ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#name_member">name_member</a></span> <span class="id">flds</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="id">ve</span> <span class="id">flds</span> <span class="id">ob</span> &lt;-*-&gt; <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> (<span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">xs</span>) <span class="id">vs</span> <span class="id">ve</span>) <span class="id">flds</span> <span class="id">ob</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Nodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_swapp">sepall_swapp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ? <span class="id">Hin</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldrep">fieldrep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Fieldsrep.ge">ge</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#name_member">name_member</a></span> <span class="id">x</span>) <span class="id">flds</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#access_mode">access_mode</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#type_member">type_member</a></span> <span class="id">x</span>)); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (~<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#name_member">name_member</a></span> <span class="id">x</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">xs</span>)) <span class="kwd">as</span> <span class="id">Hnxs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation.Permutation_app_comm</a></span> <span class="kwd">in</span> <span class="id">Nodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_In">NoDup_app_In</a></span> <span class="kwd">in</span> <span class="id">Nodup</span>; <span class="id">eauto</span>. <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gsso">Env.gsso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fieldsrep_field_offset">fieldsrep_field_offset</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">ve</span> <span class="id">flds</span> <span class="id">b</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="id">ve</span> (<span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span> <span class="id">flds</span>) <span class="id">b</span> ** <span class="id">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">x</span>, <span class="id">ty</span>) <span class="id">flds</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">d</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Fieldsrep.ge">ge</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span> <span class="id">flds</span>) = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ 0 &lt;= <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">d</span> &lt;= <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hm</span> ? ? <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="kwd">in</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Member_plain">Member_plain</a></span> <span class="id">x</span> <span class="id">ty</span>) (<span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span> <span class="id">flds</span>)) <span class="kwd">as</span> <span class="id">Hin</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>; <span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">eauto</span>. <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_in">sepall_in</a></span> <span class="kwd">in</span> <span class="id">Hin</span>' <span class="kwd">as</span> [<span class="id">ws</span> [<span class="id">xs</span> [<span class="id">Hsplit</span> <span class="id">Hin</span>']]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hin</span>' <span class="kwd">in</span> <span class="id">Hm</span>. <span class="id">clear</span> <span class="id">Hsplit</span> <span class="id">Hin</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">Hm</span>. <span class="id">clear</span> <span class="id">ws</span> <span class="id">xs</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldrep">fieldrep</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Fieldsrep.ge">ge</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span> <span class="id">flds</span>)), (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#access_mode">access_mode</a></span> <span class="id">ty</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">now</span> <span class="id">contradict</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">p</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#contains_no_overflow">contains_no_overflow</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fieldsrep_add">fieldsrep_add</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">outb</span> <span class="id">ve</span> <span class="id">x</span> <span class="id">v</span> <span class="id">flds</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">flds</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="id">ve</span> (<span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span> <span class="id">flds</span>) <span class="id">outb</span> -*&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> (<span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id">x</span> <span class="id">v</span> <span class="id">ve</span>) (<span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span> <span class="id">flds</span>) <span class="id">outb</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hnin</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldrep">fieldrep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_swapp">sepall_swapp</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ? <span class="id">Hx</span>'; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gso">Env.gso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hx</span>' <span class="kwd">as</span> ((?&amp;?)&amp;?&amp;<span class="id">Hin</span>); <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">Hxx</span>'; <span class="id">subst</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#Fieldsrep">Fieldsrep</a></span>.<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">footprint_perm_fieldsrep</span> <span class="id">footprint_decidable_fieldsrep</span> : <span class="id">sep</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="SubRep">SubRep</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="SubRep.ge">ge</a></span> : <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="fieldsrep_of">fieldsrep_of</a></span> (<span class="id">id</span>: <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id">b</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#block">block</a></span>): <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#SubRep.ge">ge</a></span> ! <span class="id">id</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">co</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#SubRep.ge">ge</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.vempty">vempty</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">co</span>) <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepfalse">sepfalse</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="subrep_inst">subrep_inst</a></span> '((<span class="id">_</span>, (<span class="id">b</span>, <span class="id">t</span>)): <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#block">block</a></span> * <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#type">Ctypes.type</a></span>)): <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">t</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Tstruct">Tstruct</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep_of">fieldsrep_of</a></span> <span class="id">id</span> <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepfalse">sepfalse</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="subrep_inst_env">subrep_inst_env</a></span> (<span class="id">e</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#env">Clight.env</a></span>) '((<span class="id">x</span>, <span class="id">t</span>): <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#type">Ctypes.type</a></span>): <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> ! <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Tstruct">Tstruct</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">_</span> <span class="kwd">as</span> <span class="id">t</span>') =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#type_eq">type_eq</a></span> <span class="id">t</span> <span class="id">t</span>' <span class="kwd">then</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep_of">fieldsrep_of</a></span> <span class="id">id</span> <span class="id">b</span> <span class="kwd">else</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepfalse">sepfalse</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepfalse">sepfalse</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="subrep">subrep</a></span> (<span class="id">f</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.method">method</a></span>) (<span class="id">e</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#env">Clight.env</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_inst_env">subrep_inst_env</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_vars">make_out_vars</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#instance_methods">instance_methods</a></span> <span class="id">f</span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="subrep_eqv">subrep_eqv</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation.Permutation</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_vars">make_out_vars</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#instance_methods">instance_methods</a></span> <span class="id">f</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Common.CompCertLib.html#drop_block">drop_block</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="id">e</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep">subrep</a></span> <span class="id">f</span> <span class="id">e</span> &lt;-*-&gt; <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_inst">subrep_inst</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="id">e</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Permut</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep">subrep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Permut</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Permut</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction_list</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="id">e</span>) <span class="kwd">as</span> [|(<span class="id">x</span>, (<span class="id">b</span>, <span class="id">t</span>))] <span class="kwd">with</span> <span class="id">elems</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepconj_eqv">sepconj_eqv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">assert</span> (<span class="id">e</span> ! <span class="id">x</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b</span>, <span class="id">t</span>)) <span class="kwd">as</span> <span class="id">Hx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements_complete">PTree.elements_complete</a></span>; <span class="id">rewrite</span> <span class="id">Helems</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#in_app">in_app</a></span>; <span class="id">left</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#in_app">in_app</a></span>; <span class="id">right</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_eq">in_eq</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">t</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CompCertLib.html#type_eq_refl">type_eq_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">IHelems</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="range_inst">range_inst</a></span> '((<span class="id">_</span>, (<span class="id">b</span>, <span class="id">t</span>)): <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#block">block</a></span> * <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#type">Ctypes.type</a></span>)) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#range">range</a></span> <span class="id">b</span> 0 (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#sizeof">Ctypes.sizeof</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#SubRep.ge">ge</a></span> <span class="id">t</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="range_inst_env">range_inst_env</a></span> (<span class="id">e</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#env">Clight.env</a></span>) (<span class="id">x</span>: <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> ! <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b</span>, <span class="id">t</span>) =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#range">range</a></span> <span class="id">b</span> 0 (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#sizeof">Ctypes.sizeof</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#SubRep.ge">ge</a></span> <span class="id">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepfalse">sepfalse</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="subrep_range">subrep_range</a></span> (<span class="id">e</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#env">Clight.env</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#range_inst">range_inst</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="id">e</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="subrep_range_eqv">subrep_range_eqv</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_range">subrep_range</a></span> <span class="id">e</span> &lt;-*-&gt; <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#range_inst_env">range_inst_env</a></span> <span class="id">e</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="id">e</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_range">subrep_range</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction_list</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="id">e</span>) <span class="kwd">as</span> [|(<span class="id">x</span>, (<span class="id">b</span>, <span class="id">t</span>))] <span class="kwd">with</span> <span class="id">elems</span>; <span class="id">auto</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepconj_eqv">sepconj_eqv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#range_inst_env">range_inst_env</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">x</span>, (<span class="id">b</span>, <span class="id">t</span>)) (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="id">e</span>)) <span class="kwd">as</span> <span class="id">Hin</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">rewrite</span> <span class="id">Helems</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>; <span class="id">left</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>; <span class="id">right</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_eq">in_eq</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements_complete">PTree.elements_complete</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">IHelems</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Remark</span> <span class="id"><a name="decidable_footprint_subrep_inst">decidable_footprint_subrep_inst</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#decidable_footprint">decidable_footprint</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_inst">subrep_inst</a></span> <span class="id">x</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">x</span>, (<span class="id">b</span>, <span class="id">t</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">destruct</span> <span class="id">t</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">sep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep_of">fieldsrep_of</a></span>; <span class="id">destruct</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#SubRep.ge">ge</a></span> ! <span class="id">i</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">sep</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="decidable_subrep">decidable_subrep</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">e</span>, <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#decidable_footprint">decidable_footprint</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep">subrep</a></span> <span class="id">f</span> <span class="id">e</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep">subrep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_vars">make_out_vars</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#instance_methods">instance_methods</a></span> <span class="id">f</span>)) <span class="kwd">as</span> [|(<span class="id">x</span>, <span class="id">t</span>)]; <span class="id">simpl</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">sep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#decidable_footprint_sepconj">decidable_footprint_sepconj</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">e</span> ! <span class="id">x</span>) <span class="kwd">as</span> [(<span class="id">b</span>, <span class="id">t</span>')|]; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">sep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">t</span>'; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">sep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#type_eq">type_eq</a></span> <span class="id">t</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Tstruct">Tstruct</a></span> <span class="id">i</span> <span class="id">a</span>)); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">sep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep_of">fieldsrep_of</a></span>; <span class="id">destruct</span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#SubRep.ge">ge</a></span> ! <span class="id">i</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">sep</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Remark</span> <span class="id"><a name="footprint_perm_subrep_inst">footprint_perm_subrep_inst</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#footprint_perm">footprint_perm</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_inst">subrep_inst</a></span> <span class="id">x</span>) <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">x</span>, (<span class="id">b</span>, <span class="id">t</span>)) <span class="id">b</span>' <span class="id">lo</span> <span class="id">hi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">destruct</span> <span class="id">t</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">sep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep_of">fieldsrep_of</a></span>; <span class="id">destruct</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#SubRep.ge">ge</a></span> ! <span class="id">i</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">sep</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Remark</span> <span class="id"><a name="disjoint_footprint_range_inst">disjoint_footprint_range_inst</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">b</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">l</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#disjoint_footprint">disjoint_footprint</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#range">range</a></span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span>) (<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#range_inst">range_inst</a></span> <span class="id">l</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="kwd">as</span> [|(<span class="id">x</span>, (<span class="id">b</span>', <span class="id">t</span>'))]; <span class="id">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">Notin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepemp_disjoint">sepemp_disjoint</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#disjoint_footprint_sepconj">disjoint_footprint_sepconj</a></span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">blk</span> <span class="id">ofs</span> <span class="id">Hfp</span> <span class="id">Hfp</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Notin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hfp</span>', <span class="id">Hfp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">transitivity</span> <span class="id">blk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span>; <span class="id">apply</span> <span class="id">Notin</span>; <span class="id">now</span> <span class="id">right</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">decidable_footprint_subrep_inst</span> <span class="id">decidable_subrep</span> <span class="id">footprint_perm_subrep_inst</span> : <span class="id">sep</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="range_wand_equiv">range_wand_equiv</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#composite_env_consistent">composite_env_consistent</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#SubRep.ge">ge</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#wf_struct">wf_struct</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#SubRep.ge">ge</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Common.CompCertLib.html#drop_block">drop_block</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="id">e</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="id">e</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_range">subrep_range</a></span> <span class="id">e</span> &lt;-*-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_inst">subrep_inst</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** (<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_inst">subrep_inst</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="id">e</span>) -* <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_range">subrep_range</a></span> <span class="id">e</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_range">subrep_range</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Consistent</span> <span class="id">Forall</span> <span class="id">Nodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sep_unwand">sep_unwand</a></span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">sep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="id">e</span>) <span class="kwd">as</span> [|(<span class="id">x</span>, (<span class="id">b</span>, <span class="id">t</span>))]; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#hide_in_sepwand">hide_in_sepwand</a></span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">sep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepemp_right">sepemp_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inversion_clear</span> <span class="id">Forall</span> <span class="kwd">as</span> [|? ? <span class="id">Hidco</span> <span class="id">Forall</span>']; <span class="id">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rename</span> <span class="id">Forall</span>' <span class="id">into</span> <span class="id">Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hidco</span> <span class="kwd">as</span> (<span class="id">id</span> &amp; <span class="id">co</span> &amp; <span class="id">Ht</span> &amp; <span class="id">Hco</span> &amp; ? &amp; (?&amp;?) &amp; <span class="id">Hnd</span> &amp; <span class="id">Hchunk</span>); <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Nodup</span> <span class="kwd">as</span> [|? ? ? <span class="id">Notin</span> <span class="id">Nodup</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep_of">fieldsrep_of</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Ht</span>, <span class="id">Hco</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">IHl</span> <span class="kwd">at</span> 1; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#unify_distinct_wands">unify_distinct_wands</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">rewrite</span> &lt;-<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sep_imp</span>'; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_comm">sep_comm</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap">sep_swap</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sep_imp</span>'; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#range_imp_with_wand">range_imp_with_wand</a></span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">sep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hco</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep_empty">fieldsrep_empty</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#disjoint_footprint_range_inst">disjoint_footprint_range_inst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>; <span class="id">rewrite</span> <span class="id">Hco</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep_empty">fieldsrep_empty</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#subseteq_footprint_sepall">subseteq_footprint_sepall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">x</span>', (<span class="id">b</span>', <span class="id">t</span>')) <span class="id">Hin</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">x</span>', <span class="id">t</span>') (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Common.CompCertLib.html#drop_block">drop_block</a></span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">change</span> (<span class="id">x</span>', <span class="id">t</span>') <span class="kwd">with</span> (<span class="id"><a href="Velus.Common.CompCertLib.html#drop_block">drop_block</a></span> (<span class="id">x</span>', (<span class="id">b</span>', <span class="id">t</span>'))); <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map">in_map</a></span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Forall</span> <span class="kwd">as</span> (<span class="id">id</span>' &amp; <span class="id">co</span>' &amp; <span class="id">Ht</span>' &amp; <span class="id">Hco</span>' &amp; ? &amp; (?&amp;?) &amp; ? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep_of">fieldsrep_of</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Ht</span>', <span class="id">Hco</span>'. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hco</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep_empty">fieldsrep_empty</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="subrep_extract">subrep_extract</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">f</span>' <span class="id">e</span> <span class="id">m</span> <span class="id">o</span> <span class="id">c</span>' <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Generation.html#M.MapsTo">M.MapsTo</a></span> (<span class="id">o</span>, <span class="id">f</span>') <span class="id">c</span>' (<span class="id"><a href="Velus.ObcToClight.Generation.html#instance_methods">instance_methods</a></span> <span class="id">f</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep">subrep</a></span> <span class="id">f</span> <span class="id">e</span> ** <span class="id">P</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">b</span> <span class="id">co</span> <span class="id">ws</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">e</span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix_out">prefix_out</a></span> <span class="id">f</span>' <span class="id">o</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b</span>, <span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst">type_of_inst</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix_fun">prefix_fun</a></span> <span class="id">f</span>' <span class="id">c</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#SubRep.ge">ge</a></span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix_fun">prefix_fun</a></span> <span class="id">f</span>' <span class="id">c</span>') = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">co</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_vars">make_out_vars</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#instance_methods">instance_methods</a></span> <span class="id">f</span>) = <span class="id">ws</span> ++ (<span class="id"><a href="Velus.Ident.html#Ids.prefix_out">prefix_out</a></span> <span class="id">f</span>' <span class="id">o</span>, <span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst">type_of_inst</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix_fun">prefix_fun</a></span> <span class="id">f</span>' <span class="id">c</span>')) :: <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#SubRep.ge">ge</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.vempty">vempty</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">co</span>) <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_inst_env">subrep_inst_env</a></span> <span class="id">e</span>) (<span class="id">ws</span> ++ <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">P</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep">subrep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix_out">prefix_out</a></span> <span class="id">f</span>' <span class="id">o</span>, <span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst">type_of_inst</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix_fun">prefix_fun</a></span> <span class="id">f</span>' <span class="id">c</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_vars">make_out_vars</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#instance_methods">instance_methods</a></span> <span class="id">f</span>))) <span class="kwd">as</span> <span class="id">Hin</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.Generation.html#M.elements_1">M.elements_1</a></span>, <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#setoid_in_key_elt">setoid_in_key_elt</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map">in_map</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:=<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">let</span> '(<span class="id">o0</span>, <span class="id">f0</span>, <span class="id">cid</span>) := <span class="id">x</span> <span class="kwd">in</span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix_out">prefix_out</a></span> <span class="id">f0</span> <span class="id">o0</span>, <span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst">type_of_inst</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix_fun">prefix_fun</a></span> <span class="id">f0</span> <span class="id">cid</span>))) <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_vars">make_out_vars</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_in">sepall_in</a></span> <span class="kwd">in</span> <span class="id">Hin</span>'; <span class="id">destruct</span> <span class="id">Hin</span>' <span class="kwd">as</span> (<span class="id">ws</span> &amp; <span class="id">xs</span> &amp; <span class="id">Hin</span> &amp; <span class="id">Heq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Heq</span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_inst_env">subrep_inst_env</a></span> <span class="kwd">at</span> 1 <span class="kwd">in</span> <span class="id">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">e</span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix_out">prefix_out</a></span> <span class="id">f</span>' <span class="id">o</span>) <span class="kwd">as</span> [(<span class="id">oblk</span>, <span class="id">t</span>)|]; [|<span class="id">destruct</span> <span class="id">Hmem</span>; <span class="id">contradiction</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">t</span>; <span class="id">try</span> (<span class="id">destruct</span> <span class="id">Hmem</span>; <span class="id">contradiction</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#type_eq">type_eq</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst">type_of_inst</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix_fun">prefix_fun</a></span> <span class="id">f</span>' <span class="id">c</span>')) (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Tstruct">Tstruct</a></span> <span class="id">i</span> <span class="id">a</span>)) <span class="kwd">as</span> [<span class="id">Eq</span>|]; [|<span class="id">destruct</span> <span class="id">Hmem</span>; <span class="id">contradiction</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst">type_of_inst</a></span> <span class="kwd">in</span> <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep_of">fieldsrep_of</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#SubRep.ge">ge</a></span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix_fun">prefix_fun</a></span> <span class="id">f</span>' <span class="id">c</span>'); [|<span class="id">destruct</span> <span class="id">Hmem</span>; <span class="id">contradiction</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">oblk</span>, <span class="id">c</span>, <span class="id">ws</span>, <span class="id">xs</span>; <span class="id">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> (<span class="id">oblk</span> &amp; <span class="id">c</span> &amp; <span class="id">ws</span>' &amp; <span class="id">xs</span>' &amp; <span class="id">He</span> &amp; <span class="id">Hge</span> &amp; <span class="id">Eq</span> &amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;rewrite&nbsp;Eq.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_breakout">sepall_breakout</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_imp">sep_imp</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_inst_env">subrep_inst_env</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">He</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst">type_of_inst</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CompCertLib.html#type_eq_refl">type_eq_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep_of">fieldsrep_of</a></span>; <span class="id">rewrite</span> <span class="id">Hge</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#SubRep">SubRep</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="free_exists">free_exists</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ge</span> <span class="id">e</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">gcenv</span> := <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#genv_cenv">Clight.genv_cenv</a></span> <span class="id">ge</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_range">subrep_range</a></span> <span class="id">gcenv</span> <span class="id">e</span> ** <span class="id">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Memory.html#Mem.free_list">Mem.free_list</a></span> <span class="id">m</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#blocks_of_env">blocks_of_env</a></span> <span class="id">ge</span> <span class="id">e</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id">P</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
&nbsp;&nbsp;<span class="kwd">Opaque</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sepconj">sepconj</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">ge</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_range">subrep_range</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#blocks_of_env">blocks_of_env</a></span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="id">e</span>) <span class="kwd">as</span> [|(<span class="id">x</span>,(<span class="id">b</span>,<span class="id">ty</span>))];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">Hrep</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">exists</span> <span class="id">m</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepemp_left">sepemp_left</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">Hrep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#free_rule">free_rule</a></span> <span class="kwd">in</span> <span class="id">Hrep</span> <span class="kwd">as</span> (<span class="id">m1</span> &amp; <span class="id">Hfree</span> &amp; <span class="id">Hm1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hfree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id">IHl</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="varsrep">varsrep</a></span> (<span class="id">f</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.method">method</a></span>) (<span class="id">ve</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.venv">venv</a></span>) (<span class="id">le</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#temp_env">temp_env</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#pure">pure</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_var">match_var</a></span> <span class="id">ve</span> <span class="id">le</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span>) ++ <span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_vars">m_vars</a></span>)))).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="varsrep_any_empty">varsrep_any_empty</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> -*&gt; <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span> <span class="id">f</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.vempty">vempty</a></span> <span class="id">le</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#pure_imp">pure_imp</a></span>; <span class="id">intro</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">f</span> ++ <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_vars">m_vars</a></span> <span class="id">f</span>)) <span class="kwd">as</span> [|<span class="id">x</span>]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_var">match_var</a></span> <span class="kwd">in</span> *; <span class="id">destruct</span> (<span class="id">le</span> ! <span class="id">x</span>); <span class="id">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gempty">Env.gempty</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="varsrep_corres_out">varsrep_corres_out</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> <span class="id">x</span> <span class="id">t</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">x</span>, <span class="id">t</span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id">f</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> -*&gt; <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id">x</span> <span class="id">v</span> <span class="id">ve</span>) <span class="id">le</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#pure_imp">pure_imp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intro</span> <span class="id">Hforall</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (~<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> (<span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span>) ++ <span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_vars">m_vars</a></span>))) <span class="kwd">as</span> <span class="id">Notin</span>.<br/>
&nbsp;&nbsp;{ <span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_nodupvars">m_nodupvars</a></span> <span class="id">f</span>) <span class="kwd">as</span> <span class="id">Nodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation.Permutation_app_comm</a></span> <span class="kwd">in</span> <span class="id">Nodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_app_InMembers">NoDupMembers_app_InMembers</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">f</span> ++ <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_vars">m_vars</a></span> <span class="id">f</span>) <span class="kwd">as</span> [|(<span class="id">x</span>', <span class="id">t</span>')]; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_var">match_var</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hforall</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">le</span> ! <span class="id">x</span>'; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gso">Env.gso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">IHl</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="varsrep_add">varsrep_add</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> <span class="id">x</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> -*&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id">x</span> <span class="id">v</span> <span class="id">ve</span>) (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#value_to_cvalue">value_to_cvalue</a></span> <span class="id">v</span>) <span class="id">le</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#pure_imp">pure_imp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intro</span> <span class="id">Hforall</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">f</span> ++ <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_vars">m_vars</a></span> <span class="id">f</span>) <span class="kwd">as</span> [|(<span class="id">x</span>', <span class="id">t</span>')]; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hforall</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_var">match_var</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#ident_eqb">ident_eqb</a></span> <span class="id">x</span>' <span class="id">x</span>) <span class="id">eqn</span>: <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#ident_eqb_eq">ident_eqb_eq</a></span> <span class="kwd">in</span> <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gss">PTree.gss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_value">match_value</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gss">Env.gss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#ident_eqb_neq">ident_eqb_neq</a></span> <span class="kwd">in</span> <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gso">Env.gso</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="id">apply</span> <span class="id">IHl</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">varsrep_add</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> <span class="id">x</span> <span class="id">v</span> <span class="id">y</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">y</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">f</span> ++ <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_vars">m_vars</a></span> <span class="id">f</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> -*&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id">x</span> <span class="id">v</span> <span class="id">ve</span>) (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#value_to_cvalue">value_to_cvalue</a></span> <span class="id">v</span>) (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id">y</span> <span class="id">v</span>' <span class="id">le</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Notin</span>.<br/>
&nbsp;&nbsp;<span class="id">transitivity</span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span> <span class="id">f</span> <span class="id">ve</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id">y</span> <span class="id">v</span>' <span class="id">le</span>)).<br/>
&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#pure_imp">pure_imp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">Hforall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">f</span> ++ <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_vars">m_vars</a></span> <span class="id">f</span>) <span class="kwd">as</span> [|(<span class="id">x</span>', <span class="id">t</span>')]; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hforall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Decidable.html#not_or">Decidable.not_or</a></span> <span class="kwd">in</span> <span class="id">Notin</span>; <span class="id">destruct</span> <span class="id">Notin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_var">match_var</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">apply</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep_add">varsrep_add</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">varsrep_add</span>'':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> <span class="id">x</span> <span class="id">v</span> <span class="id">y</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">y</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">f</span> ++ <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_vars">m_vars</a></span> <span class="id">f</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> &lt;&gt; <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id">x</span> <span class="id">v</span> <span class="id">ve</span>) <span class="id">le</span> -*&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id">x</span> <span class="id">v</span> <span class="id">ve</span>) (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id">y</span> <span class="id">v</span>' <span class="id">le</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Notin</span> ?.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#pure_imp">pure_imp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intro</span> <span class="id">Hforall</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">f</span> ++ <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_vars">m_vars</a></span> <span class="id">f</span>) <span class="kwd">as</span> [|(<span class="id">x</span>', <span class="id">t</span>')]; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hforall</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Decidable.html#not_or">Decidable.not_or</a></span> <span class="kwd">in</span> <span class="id">Notin</span>; <span class="id">destruct</span> <span class="id">Notin</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_var">match_var</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="id">apply</span> <span class="id">IHl</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">varsrep_add</span>''':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> <span class="id">x</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">f</span> ++ <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_vars">m_vars</a></span> <span class="id">f</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> -*&gt; <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span> <span class="id">f</span> <span class="id">ve</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id">x</span> <span class="id">v</span> <span class="id">le</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Notin</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#pure_imp">pure_imp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intro</span> <span class="id">Hforall</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">f</span> ++ <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_vars">m_vars</a></span> <span class="id">f</span>) <span class="kwd">as</span> [|(<span class="id">x</span>', <span class="id">t</span>')]; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hforall</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Decidable.html#not_or">Decidable.not_or</a></span> <span class="kwd">in</span> <span class="id">Notin</span>; <span class="id">destruct</span> <span class="id">Notin</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_var">match_var</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="id">apply</span> <span class="id">IHl</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="var_ptr">var_ptr</a></span> (<span class="id">b</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#block">block</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#val">val</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="MatchStates">MatchStates</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="MatchStates.ge">ge</a></span> : <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="outputrep">outputrep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.class">class</a></span>) (<span class="id">f</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.method">method</a></span>) (<span class="id">ve</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.venv">venv</a></span>) (<span class="id">le</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#temp_env">temp_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">outb_co</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#block">block</a></span> * <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#composite">composite</a></span>)) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#case_out">case_out</a></span> <span class="id">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepemp">sepemp</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> <span class="id">_</span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#pure">pure</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_var">match_var</a></span> <span class="id">ve</span> <span class="id">le</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="kwd">match</span> <span class="id">outb_co</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">outb</span>, <span class="id">outco</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#pure">pure</a></span> (<span class="id">le</span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.out">out</a></span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#var_ptr">var_ptr</a></span> <span class="id">outb</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#pure">pure</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix_fun">prefix_fun</a></span> <span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_name">m_name</a></span>) <span class="id">c</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_name">c_name</a></span>)) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">outco</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> <span class="id">ve</span> <span class="id">outco</span>.(<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span>) <span class="id">outb</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepfalse">sepfalse</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="outputrep_add_prefix">outputrep_add_prefix</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> <span class="id">outb_co</span> <span class="id">x</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span> <span class="id">c</span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> <span class="id">outb_co</span> &lt;-*-&gt; <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span> <span class="id">c</span> <span class="id">f</span> <span class="id">ve</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.set">PTree.set</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.temp">temp</a></span> <span class="id">x</span>) <span class="id">v</span> <span class="id">le</span>) <span class="id">outb_co</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span>, <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#case_out">case_out</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_list</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id">f</span>) <span class="kwd">as</span> (?,?) (?,?) ? : <span class="id">Hout</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_var">match_var</a></span>; <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_good_out">m_good_out</a></span> <span class="id">f</span>) <span class="kwd">as</span> <span class="id">Good</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.temp">temp</a></span> <span class="id">x</span>, <span class="id">t</span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id">f</span>)) <span class="kwd">as</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hout</span>. <span class="id">left</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Good</span>, <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#AtomOrGensym_inv">AtomOrGensym_inv</a></span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">ident</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">cases</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">prefix_injective</span>'. <span class="id">left</span>. <span class="id">prove_str_to_pos_neq</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="outputrep_nil">outputrep_nil</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> <span class="id">outb_co</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span>) = [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span> <span class="id">c</span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> <span class="id">outb_co</span> &lt;-*-&gt; <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepemp">sepemp</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span>, <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#case_out">case_out</a></span>; <span class="id">rewrite</span> <span class="id">Nil</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="outputrep_singleton">outputrep_singleton</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> <span class="id">m</span> <span class="id">outb_co</span> <span class="id">x</span> <span class="id">t</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span>) = [(<span class="id">x</span>, <span class="id">t</span>)] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span> <span class="id">c</span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> <span class="id">outb_co</span> ** <span class="id">P</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id">P</span> /\ <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_var">match_var</a></span> <span class="id">ve</span> <span class="id">le</span> <span class="id">x</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Sing</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span>, <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#case_out">case_out</a></span>; <span class="id">split</span>; <span class="id">intros</span> * <span class="id">H</span>; <span class="id">rewrite</span> <span class="id">Sing</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_pure">sep_pure</a></span> <span class="kwd">in</span> *; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="outputrep_notnil">outputrep_notnil</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> <span class="id">m</span> <span class="id">outb_co</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1 &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span>))%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span> <span class="id">c</span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> <span class="id">outb_co</span> ** <span class="id">P</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">outb</span> <span class="id">outco</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">outb_co</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">outb</span>, <span class="id">outco</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> <span class="id">ve</span> <span class="id">outco</span>.(<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span>) <span class="id">outb</span> ** <span class="id">P</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">le</span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.out">out</a></span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#var_ptr">var_ptr</a></span> <span class="id">outb</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix_fun">prefix_fun</a></span> <span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_name">m_name</a></span>) <span class="id">c</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_name">c_name</a></span>)) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">outco</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Length</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span>, <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#case_out">case_out</a></span>; <span class="id">split</span>; <span class="id">intros</span> * <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_list</span> <span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span>) <span class="kwd">as</span> (?, ?) ? ?; <span class="id">try</span> (<span class="id">now</span> <span class="id">contradict</span> <span class="id">Length</span>; <span class="id">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">outb_co</span> <span class="kwd">as</span> [(?, ?)|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_pure">sep_pure</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 3 <span class="id">econstructor</span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (? &amp; ? &amp; <span class="id">H</span> &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H</span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_pure">sep_pure</a></span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="prefix_out_env">prefix_out_env</a></span> (<span class="id">e</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#env">Clight.env</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">b</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">e</span> ! <span class="id">x</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b</span>, <span class="id">t</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">o</span> <span class="id">f</span>, <span class="id">x</span> = <span class="id"><a href="Velus.Ident.html#Ids.prefix_out">prefix_out</a></span> <span class="id">o</span> <span class="id">f</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bounded_struct_of_class">bounded_struct_of_class</a></span> (<span class="id">c</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.class">class</a></span>) (<span class="id">sofs</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#ptrofs">ptrofs</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#struct_in_bounds">struct_in_bounds</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> 0 <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">sofs</span>) (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="id">c</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bounded_struct_of_class_ge0">bounded_struct_of_class_ge0</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">sofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#bounded_struct_of_class">bounded_struct_of_class</a></span> <span class="id">c</span> <span class="id">sofs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">sofs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#bounded_struct_of_class">bounded_struct_of_class</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#struct_in_bounds">struct_in_bounds</a></span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">bounded_struct_of_class_ge0</span> : <span class="id">clight</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="selfrep">selfrep</a></span> (<span class="id">p</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.program">program</a></span>) (<span class="id">c</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.class">class</a></span>) (<span class="id">me</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.menv">menv</a></span>) (<span class="id">le</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#temp_env">Clight.temp_env</a></span>) (<span class="id">sb</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#block">block</a></span>) (<span class="id">sofs</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#ptrofs">ptrofs</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#pure">pure</a></span> (<span class="id">le</span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.self">self</a></span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sb</span> <span class="id">sofs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#pure">pure</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#bounded_struct_of_class">bounded_struct_of_class</a></span> <span class="id">c</span> <span class="id">sofs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> <span class="id">p</span> <span class="id">c</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_name">c_name</a></span>) <span class="id">me</span> <span class="id">sb</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">sofs</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="selfrep_conj">selfrep_conj</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">p</span> <span class="id">c</span> <span class="id">me</span> <span class="id">le</span> <span class="id">sb</span> <span class="id">sofs</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#selfrep">selfrep</a></span> <span class="id">p</span> <span class="id">c</span> <span class="id">me</span> <span class="id">le</span> <span class="id">sb</span> <span class="id">sofs</span> ** <span class="id">P</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> <span class="id">p</span> <span class="id">c</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_name">c_name</a></span>) <span class="id">me</span> <span class="id">sb</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">sofs</span>) ** <span class="id">P</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">le</span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.self">self</a></span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sb</span> <span class="id">sofs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#bounded_struct_of_class">bounded_struct_of_class</a></span> <span class="id">c</span> <span class="id">sofs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#selfrep">selfrep</a></span>; <span class="id">split</span>; <span class="id">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_pure">sep_pure</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_pure">sep_pure</a></span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="outputsrep">outputsrep</a></span> (<span class="id">f</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.method">method</a></span>) (<span class="id">e</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#env">Clight.env</a></span>) : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#pure">pure</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#prefix_out_env">prefix_out_env</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep">subrep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> <span class="id">f</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;** (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep">subrep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> <span class="id">f</span> <span class="id">e</span> -* <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_range">subrep_range</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> <span class="id">e</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="match_states">match_states</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">p</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.program">program</a></span>) (<span class="id">c</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.class">class</a></span>) (<span class="id">f</span>: <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.method">method</a></span>) '((<span class="id">me</span>, <span class="id">ve</span>): <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.menv">menv</a></span> * <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.venv">venv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'((<span class="id">e</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Peano.html#le">le</a></span>): <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#env">Clight.env</a></span> * <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#temp_env">Clight.temp_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sb</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#block">block</a></span>) (<span class="id">sofs</span>: <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#ptrofs">ptrofs</a></span>) (<span class="id">outb_co</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#block">block</a></span> * <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#composite">composite</a></span>)): <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#pure">pure</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.wt_state">wt_state</a></span> <span class="id">p</span> <span class="id">me</span> <span class="id">ve</span> <span class="id">c</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.meth_vars">meth_vars</a></span> <span class="id">f</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#selfrep">selfrep</a></span> <span class="id">p</span> <span class="id">c</span> <span class="id">me</span> <span class="id">le</span> <span class="id">sb</span> <span class="id">sofs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span> <span class="id">c</span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> <span class="id">outb_co</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputsrep">outputsrep</a></span> <span class="id">f</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="match_states_conj">match_states_conj</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">c</span> <span class="id">f</span> <span class="id">me</span> <span class="id">ve</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">sb</span> <span class="id">sofs</span> <span class="id">outb_co</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_states">match_states</a></span> <span class="id">p</span> <span class="id">c</span> <span class="id">f</span> (<span class="id">me</span>, <span class="id">ve</span>) (<span class="id">e</span>, <span class="id">le</span>) <span class="id">sb</span> <span class="id">sofs</span> <span class="id">outb_co</span> ** <span class="id">P</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> <span class="id">p</span> <span class="id">c</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_name">c_name</a></span>) <span class="id">me</span> <span class="id">sb</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">sofs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span> <span class="id">c</span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span> <span class="id">outb_co</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep">subrep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> <span class="id">f</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep">subrep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> <span class="id">f</span> <span class="id">e</span> -* <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_range">subrep_range</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#varsrep">varsrep</a></span> <span class="id">f</span> <span class="id">ve</span> <span class="id">le</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">P</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#bounded_struct_of_class">bounded_struct_of_class</a></span> <span class="id">c</span> <span class="id">sofs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.wt_state">wt_state</a></span> <span class="id">p</span> <span class="id">me</span> <span class="id">ve</span> <span class="id">c</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.meth_vars">meth_vars</a></span> <span class="id">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">le</span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.self">self</a></span>)= <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sb</span> <span class="id">sofs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#prefix_out_env">prefix_out_env</a></span> <span class="id">e</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_states">match_states</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#selfrep">selfrep</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputsrep">outputsrep</a></span>; <span class="id">split</span>; <span class="id">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_pure">sep_pure</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap3">sep_swap3</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_pure">sep_pure</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_pure">sep_pure</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap3">sep_swap3</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_pure">sep_pure</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap">sep_swap</a></span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="match_states_wt_state">match_states_wt_state</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">c</span> <span class="id">f</span> <span class="id">me</span> <span class="id">ve</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">sb</span> <span class="id">sofs</span> <span class="id">outb_co</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_states">match_states</a></span> <span class="id">p</span> <span class="id">c</span> <span class="id">f</span> (<span class="id">me</span>, <span class="id">ve</span>) (<span class="id">e</span>, <span class="id">le</span>) <span class="id">sb</span> <span class="id">sofs</span> <span class="id">outb_co</span> ** <span class="id">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.wt_state">wt_state</a></span> <span class="id">p</span> <span class="id">me</span> <span class="id">ve</span> <span class="id">c</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.meth_vars">meth_vars</a></span> <span class="id">f</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_states_conj">match_states_conj</a></span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="MatchStates.MatchStatesPreservation">MatchStatesPreservation</a></span>.<br/>
<br/>
<div class="doc">various basic 'Hoare triples' for memory assignments        *</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span><br/>
<div class="doc">Obc program  </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="MatchStates.MatchStatesPreservation.prog">prog</a></span>     : <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.program">program</a></span>)<br/>
<br/>
<div class="doc">Obc class </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="MatchStates.MatchStatesPreservation.ownerid">ownerid</a></span>  : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>)     (<span class="id"><a name="MatchStates.MatchStatesPreservation.owner">owner</a></span>  : <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.class">class</a></span>)     (<span class="id">prog</span>' : <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.program">program</a></span>)<br/>
<br/>
<div class="doc">Obc method </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="MatchStates.MatchStatesPreservation.callerid">callerid</a></span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>)     (<span class="id"><a name="MatchStates.MatchStatesPreservation.caller">caller</a></span> : <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.method">method</a></span>)<br/>
<br/>
<div class="doc">Obc state </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="MatchStates.MatchStatesPreservation.me">me</a></span>       : <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.menv">menv</a></span>)      (<span class="id"><a name="MatchStates.MatchStatesPreservation.ve">ve</a></span>     : <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.venv">venv</a></span>)<br/>
<br/>
<div class="doc">Clight state </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="MatchStates.MatchStatesPreservation.m">m</a></span>        : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Memory.html#Mem.mem">Mem.mem</a></span>)   (<span class="id"><a name="MatchStates.MatchStatesPreservation.e">e</a></span>      : <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#env">Clight.env</a></span>) (<span class="id"><a name="MatchStates.MatchStatesPreservation.le">le</a></span>   : <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#temp_env">temp_env</a></span>)<br/>
<br/>
<div class="doc">Clight self structure </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="MatchStates.MatchStatesPreservation.sb">sb</a></span>       : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#block">block</a></span>)     (<span class="id"><a name="MatchStates.MatchStatesPreservation.sofs">sofs</a></span>   : <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#ptrofs">ptrofs</a></span>)<br/>
<br/>
<div class="doc">Clight output structure </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="MatchStates.MatchStatesPreservation.outb_co">outb_co</a></span>  : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#block">block</a></span> * <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#composite">composite</a></span>))<br/>
<br/>
<div class="doc">frame </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="MatchStates.MatchStatesPreservation.P">P</a></span>        : <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#massert">massert</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id"><a name="MatchStates.MatchStatesPreservation.Findcl">Findcl</a></span>      : <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ownerid">ownerid</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.prog">prog</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.owner">owner</a></span>, <span class="id">prog</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="MatchStates.MatchStatesPreservation.Findmth">Findmth</a></span>     : <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_method">find_method</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.callerid">callerid</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.owner">owner</a></span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_methods">c_methods</a></span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="MatchStates.MatchStatesPreservation.OutputMatch">OutputMatch</a></span> : <span class="kwd">forall</span> <span class="id">outco</span> , (1 &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span>))%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix_fun">prefix_fun</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.callerid">callerid</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ownerid">ownerid</a></span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">outco</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.ObcToClight.Generation.html#translate_param">translate_param</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span>)) = <span class="id">outco</span>.(<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span>)).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="MatchStates.MatchStatesPreservation.v">v</a></span> : <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.value">value</a></span>) (<span class="id"><a name="MatchStates.MatchStatesPreservation.x">x</a></span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id"><a name="MatchStates.MatchStatesPreservation.ty">ty</a></span> : <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.type">type</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id"><a name="MatchStates.MatchStatesPreservation.WTv">WTv</a></span> : <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.wt_value">wt_value</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.v">v</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ty">ty</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="outputrep_assign_gt1_mem">outputrep_assign_gt1_mem</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.x">x</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ty">ty</a></span>) <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1 &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span>))%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.m">m</a></span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.owner">owner</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ve">ve</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.le">le</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.outb_co">outb_co</a></span> ** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">m</span>' <span class="id">b</span> <span class="id">co</span> <span class="id">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.outb_co">outb_co</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b</span>, <span class="id">co</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.x">x</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">co</span>) = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#assign_loc">Clight.assign_loc</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#translate_type">translate_type</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ty">ty</a></span>) <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.m">m</a></span> <span class="id">b</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">d</span>)) <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Full">Full</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#value_to_cvalue">value_to_cvalue</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.v">v</a></span>) <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.owner">owner</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span> (<span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.x">x</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.v">v</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ve">ve</a></span>) <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.le">le</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.outb_co">outb_co</a></span> ** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.P">P</a></span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hin</span> <span class="id">Len</span> <span class="id">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep_notnil">outputrep_notnil</a></span> <span class="kwd">in</span> <span class="id">Hmem</span> <span class="kwd">as</span> (<span class="id">b</span> &amp; <span class="id">co</span> &amp; <span class="id">Hout</span> &amp; <span class="id">Hrep</span> &amp;?&amp; <span class="id">Hco</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class_name">find_class_name</a></span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_method_name">find_method_name</a></span> <span class="kwd">in</span> <span class="id">Hco</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map">in_map</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="Velus.ObcToClight.Generation.html#translate_param">translate_param</a></span>) <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_nodupvars">m_nodupvars</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span>) <span class="kwd">as</span> <span class="id">Nodup</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;get&nbsp;the&nbsp;updated&nbsp;memory&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_in">sepall_in</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">ws</span> [<span class="id">ys</span> [<span class="id">Hys</span> <span class="id">Heq</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="kwd">in</span> <span class="id">Hrep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Local</span> <span class="kwd">Opaque</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sepconj">sepconj</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_states">match_states</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.OutputMatch">OutputMatch</a></span> <span class="kwd">in</span> <span class="id">Hrep</span>; <span class="id">eauto</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span> <span class="kwd">in</span> <span class="id">Hrep</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_map">sepall_map</a></span>, <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">Hrep</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.x">x</a></span> <span class="id">_</span>) <span class="kwd">as</span> [<span class="id">d</span>|] <span class="id">eqn</span>: <span class="id">Hofs</span>; <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">Hrep</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> (<span class="id">destruct</span> <span class="id">Hrep</span>; <span class="id">contradiction</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#translate_type_access_by_value">translate_type_access_by_value</a></span> <span class="kwd">in</span> <span class="id">Hrep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Separation.storev_rule</span>' <span class="kwd">with</span> (<span class="id">v</span>:=<span class="id"><a href="Velus.ObcToClight.Interface.html#value_to_cvalue">value_to_cvalue</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.v">v</a></span>) <span class="kwd">in</span> <span class="id">Hrep</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">m</span>' &amp; ? &amp; <span class="id">Hrep</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">m</span>', <span class="id">b</span>, <span class="id">co</span>, <span class="id">d</span>; <span class="id">intuition</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#assign_loc">assign_loc</a></span> <span class="kwd">with</span> <span class="id">clight</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.OutputMatch">OutputMatch</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep_notnil">outputrep_notnil</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class_name">find_class_name</a></span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_method_name">find_method_name</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">b</span>, <span class="id">co</span>; <span class="id">split</span>; <span class="id">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldrep">fieldrep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.OutputMatch">OutputMatch</a></span>; <span class="id">eauto</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Common.CompCertLib.html#mk_members">mk_members</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_map">sepall_map</a></span>, <span class="id">Heq</span>; <span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id">Hofs</span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#translate_type_access_by_value">translate_type_access_by_value</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_imp">sep_imp</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id">hasvalue</span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_value">match_value</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gss">Env.gss</a></span>, &lt;-<span class="id"><a href="Velus.ObcToClight.Interface.html#wt_value_load_result">wt_value_load_result</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">sep_imp</span>'; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_app_r">NoDupMembers_app_r</a></span> <span class="kwd">in</span> <span class="id">Nodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>, &lt;-<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#translate_param_fst">translate_param_fst</a></span>, &lt;-<span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span> <span class="kwd">in</span> <span class="id">Nodup</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">Hys</span> <span class="kwd">in</span> <span class="id">Nodup</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_app_cons">NoDupMembers_app_cons</a></span> <span class="kwd">in</span> <span class="id">Nodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Nodup</span> <span class="kwd">as</span> (<span class="id">Notin</span> &amp; <span class="id">Nodup</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_swapp">sepall_swapp</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">x</span>' &amp; <span class="id">t</span>') <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gso">Env.gso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">intro</span>; <span class="id">subst</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Notin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="outputrep_assign_singleton_mem">outputrep_assign_singleton_mem</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span> = [(<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.x">x</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ty">ty</a></span>)] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.owner">owner</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ve">ve</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.le">le</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.outb_co">outb_co</a></span> -*&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.owner">owner</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span> (<span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.x">x</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.v">v</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ve">ve</a></span>) (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.x">x</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#value_to_cvalue">value_to_cvalue</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.v">v</a></span>) <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.le">le</a></span>) <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.outb_co">outb_co</a></span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span>, <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#case_out">case_out</a></span>; <span class="id">rewrite</span> <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_var">match_var</a></span>; <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gss">PTree.gss</a></span>, <span class="id"><a href="Velus.Environment.html#Env.gss">Env.gss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="outputrep_assign_var_mem">outputrep_assign_var_mem</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.x">x</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.x">x</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ty">ty</a></span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.meth_vars">meth_vars</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.m">m</a></span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.owner">owner</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ve">ve</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.le">le</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.outb_co">outb_co</a></span> ** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.m">m</a></span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.owner">owner</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span> (<span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.x">x</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.v">v</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ve">ve</a></span>) (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.x">x</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#value_to_cvalue">value_to_cvalue</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.v">v</a></span>) <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.le">le</a></span>) <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.outb_co">outb_co</a></span> ** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.P">P</a></span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hnin</span> <span class="id">Hin</span> <span class="id">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_imp">sep_imp</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep">outputrep</a></span>, <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#case_out">case_out</a></span> <span class="kwd">in</span> *; <span class="id">destruct_list</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span>) <span class="kwd">as</span> (?, ?) (?, ?) ? : <span class="id">Hout</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#pure_imp">pure_imp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">i</span> &lt;&gt; <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.x">x</a></span>) <span class="kwd">by</span> (<span class="id">intro</span>; <span class="id">subst</span>; <span class="id">apply</span> <span class="id">Hnin</span>; <span class="id">constructor</span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_var">match_var</a></span>; <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>, <span class="id"><a href="Velus.Environment.html#Env.gso">Env.gso</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class_name">find_class_name</a></span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_method_name">find_method_name</a></span> <span class="kwd">in</span>*; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.outb_co">outb_co</a></span> <span class="kwd">as</span> [(<span class="id">outb</span>, <span class="id">outco</span>)|]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">apply</span> <span class="id">sep_imp</span>'; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#pure_imp">pure_imp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span>; <span class="id">subst</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_AtomOrGensym">m_AtomOrGensym</a></span>, <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#AtomOrGensym_inv">AtomOrGensym_inv</a></span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">ident</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> 2 <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>, 2 <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_pure">sep_pure</a></span> <span class="kwd">in</span> <span class="id">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hmem</span> <span class="kwd">as</span> (?&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.OutputMatch">OutputMatch</a></span>; <span class="id">eauto</span>; <span class="id">try</span> (<span class="id">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep_add">fieldsrep_add</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#InMembers_translate_param_idem">InMembers_translate_param_idem</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="match_states_assign_state_mem">match_states_assign_state_mem</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.m">m</a></span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_states">match_states</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.prog">prog</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.owner">owner</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.me">me</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ve">ve</a></span>) (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.e">e</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.le">le</a></span>) <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.sb">sb</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.sofs">sofs</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.outb_co">outb_co</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.x">x</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ty">ty</a></span>) <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.owner">owner</a></span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_mems">c_mems</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">m</span>' <span class="id">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.x">x</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.owner">owner</a></span>) = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#assign_loc">Clight.assign_loc</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#translate_type">translate_type</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ty">ty</a></span>) <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.m">m</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.sb">sb</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.sofs">sofs</a></span> + <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">d</span>)) <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#Full">Full</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#value_to_cvalue">value_to_cvalue</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.v">v</a></span>) <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_states">match_states</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.prog">prog</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.owner">owner</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.caller">caller</a></span> (<span class="id"><a href="Velus.VelusMemory.html#add_val">add_val</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.x">x</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.v">v</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.me">me</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.ve">ve</a></span>) (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.e">e</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.le">le</a></span>) <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.sb">sb</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.sofs">sofs</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.outb_co">outb_co</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.P">P</a></span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">Hmem</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_states_conj">match_states_conj</a></span> <span class="kwd">in</span> <span class="id">Hmem</span> <span class="kwd">as</span> (<span class="id">Hmem</span> &amp; ?&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class_name">find_class_name</a></span> <span class="kwd">in</span> <span class="id">Hmem</span>; <span class="id">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;get&nbsp;the&nbsp;updated&nbsp;memory&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_def">staterep_def</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.Findcl">Findcl</a></span> <span class="kwd">in</span> <span class="id">Hmem</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_in">sepall_in</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">ws</span> [<span class="id">ys</span> [<span class="id">Hys</span> <span class="id">Heq</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_mems">staterep_mems</a></span> <span class="kwd">in</span> <span class="id">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.ge">ge</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.x">x</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_members">make_members</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.owner">owner</a></span>)) <span class="kwd">as</span> [<span class="id">d</span>|] <span class="id">eqn</span>: <span class="id">Hofs</span>; <span class="id">rewrite</span> 2 <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">Hmem</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> (<span class="id">destruct</span> <span class="id">Hmem</span>; <span class="id">contradiction</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Separation.storev_rule</span>' <span class="kwd">with</span> (<span class="id">v</span> := <span class="id"><a href="Velus.ObcToClight.Interface.html#value_to_cvalue">value_to_cvalue</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.v">v</a></span>) <span class="kwd">in</span> <span class="id">Hmem</span> <span class="kwd">as</span> (<span class="id">m</span>' &amp; ? &amp; <span class="id">Hmem</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">m</span>', <span class="id">d</span>; <span class="id">intuition</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#assign_loc">assign_loc</a></span> <span class="kwd">with</span> <span class="id">clight</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_states_conj">match_states_conj</a></span>; <span class="id">intuition</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">obctyping</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class_name">find_class_name</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_def">staterep_def</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.Findcl">Findcl</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep_mems">staterep_mems</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">Heq</span>, <span class="id">Hofs</span>, 2 <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_imp">sep_imp</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id">hasvalue</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.VelusMemory.html#find_val_gss">find_val_gss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.Interface.html#wt_value_load_result">wt_value_load_result</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">apply</span> <span class="id">sep_imp</span>'; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_nodupmems">c_nodupmems</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation.owner">owner</a></span>) <span class="kwd">as</span> <span class="id">Nodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hys</span> <span class="kwd">in</span> <span class="id">Nodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_app_cons">NoDupMembers_app_cons</a></span> <span class="kwd">in</span> <span class="id">Nodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Nodup</span> <span class="kwd">as</span> (<span class="id">Notin</span> &amp; <span class="id">Nodup</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall_swapp">sepall_swapp</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">x</span>' &amp; <span class="id">t</span>') <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.VelusMemory.html#find_val_gso">find_val_gso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span>; <span class="id">subst</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Notin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates.MatchStatesPreservation">MatchStatesPreservation</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MatchStates">MatchStates</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="FunctionEntry">FunctionEntry</a></span>.<br/>
<br/>
<div class="doc">results about allocation of the environment and temporary   *</div>
<div class="doc">environment at function entry                               *</div>
<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Remark</span> <span class="id"><a name="bind_parameter_temps_exists">bind_parameter_temps_exists</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">s</span> <span class="id">ts</span> <span class="id">o</span> <span class="id">to</span> <span class="id">ys</span> <span class="id">vs</span> <span class="id">sptr</span> <span class="id">optr</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> &lt;&gt; <span class="id">o</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">s</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">o</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">s</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">o</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">xs</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">vs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">le</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#bind_parameter_temps">bind_parameter_temps</a></span> ((<span class="id">s</span>, <span class="id">ts</span>) :: (<span class="id">o</span>, <span class="id">to</span>) :: <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sptr</span> :: <span class="id">optr</span> :: <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#value_to_cvalue">value_to_cvalue</a></span> <span class="id">vs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#create_undef_temps">create_undef_temps</a></span> <span class="id">ys</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_var">match_var</a></span> (<span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">xs</span>) <span class="id">vs</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.vempty">vempty</a></span>) <span class="id">le</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id">xs</span> ++ <span class="id">ys</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_var">match_var</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">xs</span> <span class="kwd">as</span> [|(<span class="id">x</span>, <span class="id">ty</span>)]; <span class="id">destruct</span> <span class="id">vs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hso</span> <span class="id">Nodup</span> <span class="id">Nos</span> <span class="id">Noo</span> <span class="id">Nos</span>' <span class="id">Noo</span>' <span class="id">Hlengths</span>; <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl</span>; <span class="id">econstructor</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_value">match_value</a></span>, <span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ys</span> <span class="kwd">as</span> [|(<span class="id">y</span>, <span class="id">t</span>)]; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">y</span> &lt;&gt; <span class="id">s</span>) <span class="kwd">by</span> (<span class="id">intro</span>; <span class="id">subst</span>; <span class="id">apply</span> <span class="id">Nos</span>'; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_eq">InMembers_eq</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">y</span> &lt;&gt; <span class="id">o</span>) <span class="kwd">by</span> (<span class="id">intro</span>; <span class="id">subst</span>; <span class="id">apply</span> <span class="id">Noo</span>'; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_eq">InMembers_eq</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gempty">Env.gempty</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 (<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gss">PTree.gss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NotInMembers_cons">NotInMembers_cons</a></span> <span class="kwd">in</span> <span class="id">Nos</span>'; <span class="id">destruct</span> <span class="id">Nos</span>' <span class="kwd">as</span> [<span class="id">Nos</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NotInMembers_cons">NotInMembers_cons</a></span> <span class="kwd">in</span> <span class="id">Noo</span>'; <span class="id">destruct</span> <span class="id">Noo</span>' <span class="kwd">as</span> [<span class="id">Noo</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHys</span> <span class="id">Nos</span>' <span class="id">Noo</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_impl_In">Forall_impl_In</a></span>; <span class="id">eauto</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">y</span>' <span class="id">Hin</span> <span class="id">Hmatch</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">y</span>' &lt;&gt; <span class="id">s</span>) <span class="kwd">by</span> (<span class="id">intro</span>; <span class="id">subst</span>; <span class="id">apply</span> <span class="id">Nos</span>'; <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">y</span>' &lt;&gt; <span class="id">o</span>) <span class="kwd">by</span> (<span class="id">intro</span>; <span class="id">subst</span>; <span class="id">apply</span> <span class="id">Noo</span>'; <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#ident_eqb">ident_eqb</a></span> <span class="id">y</span>' <span class="id">y</span>) <span class="id">eqn</span>: <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#ident_eqb_eq">ident_eqb_eq</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="id">subst</span> <span class="id">y</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gss">PTree.gss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gempty">Env.gempty</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#ident_eqb_neq">ident_eqb_neq</a></span> <span class="kwd">in</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hlengths</span>; <span class="id">inv</span> <span class="id">Nodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">IHxs</span> <span class="kwd">with</span> (<span class="id">s</span>:=<span class="id">s</span>) (<span class="id">ts</span>:=<span class="id">ts</span>) (<span class="id">o</span>:=<span class="id">o</span>) (<span class="id">to</span>:=<span class="id">to</span>) (<span class="id">sptr</span>:=<span class="id">sptr</span>) (<span class="id">optr</span>:=<span class="id">optr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">le</span>' &amp; <span class="id">Bind</span> &amp; ?); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NotInMembers_cons">NotInMembers_cons</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NotInMembers_cons">NotInMembers_cons</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">assert</span> (<span class="id">x</span> &lt;&gt; <span class="id">s</span>) <span class="kwd">by</span> (<span class="id">intro</span>; <span class="id">subst</span>; <span class="id">apply</span> <span class="id">Nos</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_eq">InMembers_eq</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">x</span> &lt;&gt; <span class="id">o</span>) <span class="kwd">by</span> (<span class="id">intro</span>; <span class="id">subst</span>; <span class="id">apply</span> <span class="id">Noo</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_eq">InMembers_eq</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#value_to_cvalue">value_to_cvalue</a></span> <span class="id">v</span>) <span class="id">le</span>'); <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">simpl</span> <span class="id">map</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CompCertLib.html#bind_parameter_temps_comm">bind_parameter_temps_comm</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CompCertLib.html#bind_parameter_temps_cons">bind_parameter_temps_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">intros</span> [|[|]]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_comm_cons">app_comm_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gss">PTree.gss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_value">match_value</a></span>; <span class="id">simpl</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.find_gsss">Env.find_gsss</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_impl_In">Forall_impl_In</a></span>; <span class="id">eauto</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span>' <span class="id">Hin</span> <span class="id">MV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#ident_eq_dec">ident_eq_dec</a></span> <span class="id">x</span>' <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">subst</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gss">PTree.gss</a></span>; <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_value">match_value</a></span>; <span class="id">simpl</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.find_gsss">Env.find_gsss</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Common.Common.html#or_default_with">or_default_with</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">E</span>; <span class="id">setoid_rewrite</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">MV</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_value">match_value</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.find_gsso">Env.find_gsso</a></span>; <span class="id">auto</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Remark</span> <span class="id"><a name="bind_parameter_temps_exists_noout">bind_parameter_temps_exists_noout</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">s</span> <span class="id">ts</span> <span class="id">ys</span> <span class="id">vs</span> <span class="id">sptr</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">s</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">s</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">xs</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id">vs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">le</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#bind_parameter_temps">bind_parameter_temps</a></span> ((<span class="id">s</span>, <span class="id">ts</span>) :: <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sptr</span> :: <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#value_to_cvalue">value_to_cvalue</a></span> <span class="id">vs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#create_undef_temps">create_undef_temps</a></span> <span class="id">ys</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_var">match_var</a></span> (<span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">xs</span>) <span class="id">vs</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.vempty">vempty</a></span>) <span class="id">le</span>') (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id">xs</span> ++ <span class="id">ys</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_var">match_var</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">xs</span> <span class="kwd">as</span> [|(<span class="id">x</span>, <span class="id">ty</span>)]; <span class="id">destruct</span> <span class="id">vs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Nodup</span> <span class="id">Nos</span> <span class="id">Nos</span>' <span class="id">Hlengths</span>; <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl</span>; <span class="id">econstructor</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_value">match_value</a></span>, <span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ys</span> <span class="kwd">as</span> [|(<span class="id">y</span>, <span class="id">t</span>)]; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">y</span> &lt;&gt; <span class="id">s</span>) <span class="kwd">by</span> (<span class="id">intro</span>; <span class="id">subst</span>; <span class="id">apply</span> <span class="id">Nos</span>'; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_eq">InMembers_eq</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gempty">Env.gempty</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gss">PTree.gss</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NotInMembers_cons">NotInMembers_cons</a></span> <span class="kwd">in</span> <span class="id">Nos</span>'; <span class="id">destruct</span> <span class="id">Nos</span>' <span class="kwd">as</span> [<span class="id">Nos</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHys</span> <span class="id">Nos</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_impl_In">Forall_impl_In</a></span>; <span class="id">eauto</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">y</span>' <span class="id">Hin</span> <span class="id">Hmatch</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">y</span>' &lt;&gt; <span class="id">s</span>) <span class="kwd">by</span> (<span class="id">intro</span>; <span class="id">subst</span>; <span class="id">apply</span> <span class="id">Nos</span>'; <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#ident_eqb">ident_eqb</a></span> <span class="id">y</span>' <span class="id">y</span>) <span class="id">eqn</span>: <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#ident_eqb_eq">ident_eqb_eq</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="id">subst</span> <span class="id">y</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gss">PTree.gss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gempty">Env.gempty</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#ident_eqb_neq">ident_eqb_neq</a></span> <span class="kwd">in</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hlengths</span>; <span class="id">inv</span> <span class="id">Nodup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">IHxs</span> <span class="kwd">with</span> (<span class="id">s</span>:=<span class="id">s</span>) (<span class="id">ts</span>:=<span class="id">ts</span>) (<span class="id">sptr</span>:=<span class="id">sptr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">le</span>' &amp; <span class="id">Bind</span> &amp; ?); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NotInMembers_cons">NotInMembers_cons</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">assert</span> (<span class="id">x</span> &lt;&gt; <span class="id">s</span>) <span class="kwd">by</span> (<span class="id">intro</span>; <span class="id">subst</span>; <span class="id">apply</span> <span class="id">Nos</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_eq">InMembers_eq</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#value_to_cvalue">value_to_cvalue</a></span> <span class="id">v</span>) <span class="id">le</span>'); <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">simpl</span> <span class="id">map</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CompCertLib.html#bind_parameter_temps_comm_noout">bind_parameter_temps_comm_noout</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CompCertLib.html#bind_parameter_temps_cons">bind_parameter_temps_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">intros</span> [|]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_comm_cons">app_comm_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gss">PTree.gss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_value">match_value</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.find_gsss">Env.find_gsss</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_impl_In">Forall_impl_In</a></span>; <span class="id">eauto</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span>' <span class="id">Hin</span> <span class="id">MV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#ident_eq_dec">ident_eq_dec</a></span> <span class="id">x</span>' <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">subst</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gss">PTree.gss</a></span>; <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_value">match_value</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.find_gsss">Env.find_gsss</a></span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Common.Common.html#or_default_with">or_default_with</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">E</span>; <span class="id">setoid_rewrite</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">MV</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_value">match_value</a></span>; <span class="id">simpl</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.find_gsso">Env.find_gsso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Remark</span> <span class="id"><a name="alloc_mem_vars">alloc_mem_vars</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ge</span> <span class="id">vars</span> <span class="id">e</span> <span class="id">m</span> <span class="id">e</span>' <span class="id">m</span>' <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">gcenv</span> := <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#genv_cenv">Clight.genv_cenv</a></span> <span class="id">ge</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">xt</span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id">gcenv</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">xt</span>) &lt;= <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>) <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#alloc_variables">alloc_variables</a></span> <span class="id">ge</span> <span class="id">e</span> <span class="id">m</span> <span class="id">vars</span> <span class="id">e</span>' <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span>' |= <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepall">sepall</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#range_inst_env">range_inst_env</a></span> <span class="id">gcenv</span> <span class="id">e</span>') (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#var_names">var_names</a></span> <span class="id">vars</span>) ** <span class="id">P</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">vars</span> <span class="kwd">as</span> [|(<span class="id">y</span>, <span class="id">t</span>)];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hrep</span> <span class="id">Nodup</span> <span class="id">Forall</span> <span class="id">Alloc</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Alloc</span>; <span class="id">subst</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepemp_left">sepemp_left</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Nodup</span>; <span class="id">inv</span> <span class="id">Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#range_inst_env">range_inst_env</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Common.CompCertLib.html#alloc_implies">alloc_implies</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap">sep_swap</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHvars</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#alloc_rule">alloc_rule</a></span>; <span class="id">eauto</span>; <span class="id">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="alloc_result">alloc_result</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ge</span> <span class="id">f</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vars</span> := <span class="id"><a href="Velus.ObcToClight.Generation.html#instance_methods">instance_methods</a></span> <span class="id">f</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">gcenv</span> := <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#genv_cenv">Clight.genv_cenv</a></span> <span class="id">ge</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#composite_env_consistent">composite_env_consistent</a></span> <span class="id">ge</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">xt</span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id">ge</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">xt</span>) &lt;= <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> /\ <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#wf_struct">wf_struct</a></span> <span class="id">gcenv</span> <span class="id">xt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_vars">make_out_vars</a></span> <span class="id">vars</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_vars">make_out_vars</a></span> <span class="id">vars</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">e</span>' <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#alloc_variables">alloc_variables</a></span> <span class="id">ge</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#empty_env">empty_env</a></span> <span class="id">m</span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_vars">make_out_vars</a></span> <span class="id">vars</span>) <span class="id">e</span>' <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#prefix_out_env">prefix_out_env</a></span> <span class="id">e</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep">subrep</a></span> <span class="id">gcenv</span> <span class="id">f</span> <span class="id">e</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep">subrep</a></span> <span class="id">gcenv</span> <span class="id">f</span> <span class="id">e</span>' -* <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_range">subrep_range</a></span> <span class="id">gcenv</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">P</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Consistent</span> <span class="id">Hforall</span> <span class="id">Nodup</span> <span class="id">Hrep</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">Forall_Forall</span>' <span class="kwd">in</span> <span class="id">Hforall</span>; <span class="id">destruct</span> <span class="id">Hforall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Common.CompCertLib.html#alloc_exists">alloc_exists</a></span> <span class="id">ge</span> <span class="id">_</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#empty_env">empty_env</a></span> <span class="id">m</span> <span class="id">Nodup</span>) <span class="kwd">as</span> (<span class="id">e</span>' &amp; <span class="id">m</span>' &amp; <span class="id">Alloc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#alloc_mem_vars">alloc_mem_vars</a></span> <span class="kwd">in</span> <span class="id">Hrep</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">Alloc</span> <span class="kwd">as</span> <span class="id">Perm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CompCertLib.html#alloc_permutation">alloc_permutation</a></span> <span class="kwd">in</span> <span class="id">Perm</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">e</span>', <span class="id">m</span>'; <span class="id">split</span>; [<span class="id">auto</span>|<span class="id">split</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> ??? <span class="id">Hget</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements_correct">PTree.elements_correct</a></span> <span class="kwd">in</span> <span class="id">Hget</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map">in_map</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="Velus.Common.CompCertLib.html#drop_block">drop_block</a></span>) <span class="kwd">in</span> <span class="id">Hget</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_sym">Permutation.Permutation_sym</a></span> <span class="kwd">in</span> <span class="id">Perm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Perm</span> <span class="kwd">in</span> <span class="id">Hget</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_vars">make_out_vars</a></span> <span class="kwd">in</span> <span class="id">Hget</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hget</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hget</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hget</span> <span class="kwd">as</span> (((<span class="id">o</span>, <span class="id">f</span>'), <span class="id">c</span>) &amp; <span class="id">Eq</span> &amp; <span class="id">Hget</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Eq</span>. <span class="id">now</span> <span class="kwd">exists</span> <span class="id">f</span>', <span class="id">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">pose</span> <span class="id">proof</span> <span class="id">Perm</span> <span class="kwd">as</span> <span class="id">Perm_fst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CompCertLib.html#Permutation_fst">Permutation_fst</a></span> <span class="kwd">in</span> <span class="id">Perm_fst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CompCertLib.html#map_fst_drop_block">map_fst_drop_block</a></span> <span class="kwd">in</span> <span class="id">Perm_fst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Perm_fst</span> <span class="kwd">in</span> <span class="id">Hrep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_range_eqv">subrep_range_eqv</a></span> <span class="kwd">in</span> <span class="id">Hrep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#subrep_eqv">subrep_eqv</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#range_wand_equiv">range_wand_equiv</a></span> <span class="kwd">in</span> <span class="id">Hrep</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">Hrep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Permutation_Forall">Permutation_Forall</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CompCertLib.html#alloc_NoDupMembers">alloc_NoDupMembers</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span>; <span class="id">simpl</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">Nodup</span> <span class="id">Alloc</span> <span class="id">Perm</span> <span class="id">Perm_fst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_vars">make_out_vars</a></span> <span class="id">vars</span>); <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">intros</span> * <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">'Hoare triple' for function entry, depending on the number  *</div>
<div class="doc">of outputs (and inputs, consequently):                      *</div>
<div class="doc">  0 and 1: no 'out' pointer parameter, we only need         *</div>
<div class="doc">           staterep for the sub-state, and we get           *</div>
<div class="doc">           match_states in the callee                       *</div>
<div class="doc">  1 &lt; n  : 'out' pointer parameter, we need both            *</div>
<div class="doc">           staterep for the sub-state and fieldsrep for the *</div>
<div class="doc">           output structure, we get match_states in the     *</div>
<div class="doc">           callee                                           *</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="FunctionEntry.main_node">main_node</a></span>  : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="FunctionEntry.prog">prog</a></span>       : <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.program">program</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="FunctionEntry.tprog">tprog</a></span>      : <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#program">Clight.program</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="FunctionEntry.do_sync">do_sync</a></span>    : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="FunctionEntry.all_public">all_public</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id"><a name="FunctionEntry.tge">tge</a></span>              := <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#globalenv">Clight.globalenv</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.tprog">tprog</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id"><a name="FunctionEntry.gcenv">gcenv</a></span>            := <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#genv_cenv">Clight.genv_cenv</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.tge">tge</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id"><a name="FunctionEntry.TRANSL">TRANSL</a></span> : <span class="id"><a href="Velus.ObcToClight.Generation.html#translate">translate</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.do_sync">do_sync</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.all_public">all_public</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.main_node">main_node</a></span>) <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.prog">prog</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.tprog">tprog</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="FunctionEntry.WT">WT</a></span>     : <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.wt_program">wt_program</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.prog">prog</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="function_entry_match_states">function_entry_match_states</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cid</span> <span class="id">c</span> <span class="id">prog</span>' <span class="id">fid</span> <span class="id">f</span> <span class="id">fd</span> <span class="id">me</span> <span class="id">vs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vs</span>' := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#value_to_cvalue">value_to_cvalue</a></span> <span class="id">vs</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#method_spec">method_spec</a></span> <span class="id">c</span> <span class="id">f</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.prog">prog</a></span> <span class="id">fd</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class">find_class</a></span> <span class="id">cid</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.prog">prog</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span>, <span class="id">prog</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_method">find_method</a></span> <span class="id">fid</span> <span class="id">c</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_methods">c_methods</a></span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">f</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Interface.html#ComTyp.wt_memory">wt_memory</a></span> <span class="id">me</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.prog">prog</a></span> <span class="id">c</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_mems">c_mems</a></span>) <span class="id">c</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_objs">c_objs</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">v</span> <span class="id">xt</span> =&gt; <span class="id"><a href="Velus.ObcToClight.Interface.html#Op.wt_value">wt_value</a></span> <span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">xt</span>)) <span class="id">vs</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">f</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#case_out">case_out</a></span> <span class="id">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">m</span> <span class="id">sb</span> <span class="id">sofs</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#bounded_struct_of_class">bounded_struct_of_class</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.gcenv">gcenv</a></span> <span class="id">c</span> <span class="id">sofs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.gcenv">gcenv</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.prog">prog</a></span> <span class="id">cid</span> <span class="id">me</span> <span class="id">sb</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">sofs</span>) ** <span class="id">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">e_f</span> <span class="id">le_f</span> <span class="id">m_f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#function_entry2">function_entry2</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.tge">tge</a></span> <span class="id">fd</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sb</span> <span class="id">sofs</span> :: <span class="id">vs</span>') <span class="id">m</span> <span class="id">e_f</span> <span class="id">le_f</span> <span class="id">m_f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m_f</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_states">match_states</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.gcenv">gcenv</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.prog">prog</a></span> <span class="id">c</span> <span class="id">f</span> (<span class="id">me</span>, <span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span>)) <span class="id">vs</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.vempty">vempty</a></span>) (<span class="id">e_f</span>, <span class="id">le_f</span>) <span class="id">sb</span> <span class="id">sofs</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">P</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">_</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">sb</span> <span class="id">sofs</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#bounded_struct_of_class">bounded_struct_of_class</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.gcenv">gcenv</a></span> <span class="id">c</span> <span class="id">sofs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.gcenv">gcenv</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.prog">prog</a></span> <span class="id">cid</span> <span class="id">me</span> <span class="id">sb</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">sofs</span>) ** <span class="id">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">e_f</span> <span class="id">le_f</span> <span class="id">m_f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#function_entry2">function_entry2</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.tge">tge</a></span> <span class="id">fd</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sb</span> <span class="id">sofs</span> :: <span class="id">vs</span>') <span class="id">m</span> <span class="id">e_f</span> <span class="id">le_f</span> <span class="id">m_f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m_f</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_states">match_states</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.gcenv">gcenv</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.prog">prog</a></span> <span class="id">c</span> <span class="id">f</span> (<span class="id">me</span>, <span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span>)) <span class="id">vs</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.vempty">vempty</a></span>) (<span class="id">e_f</span>, <span class="id">le_f</span>) <span class="id">sb</span> <span class="id">sofs</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">P</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">sb</span> <span class="id">sofs</span> <span class="id">instb</span> <span class="id">instco</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#bounded_struct_of_class">bounded_struct_of_class</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.gcenv">gcenv</a></span> <span class="id">c</span> <span class="id">sofs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.gcenv">gcenv</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.prog">prog</a></span> <span class="id">cid</span> <span class="id">me</span> <span class="id">sb</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">sofs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.gcenv">gcenv</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.vempty">vempty</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">instco</span>) <span class="id">instb</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.gcenv">gcenv</a></span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix_fun">prefix_fun</a></span> <span class="id">fid</span> <span class="id">cid</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">instco</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">e_f</span> <span class="id">le_f</span> <span class="id">m_f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#function_entry2">function_entry2</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.tge">tge</a></span> <span class="id">fd</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sb</span> <span class="id">sofs</span> :: <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#var_ptr">var_ptr</a></span> <span class="id">instb</span> :: <span class="id">vs</span>') <span class="id">m</span> <span class="id">e_f</span> <span class="id">le_f</span> <span class="id">m_f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m_f</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_states">match_states</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.gcenv">gcenv</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.prog">prog</a></span> <span class="id">c</span> <span class="id">f</span> (<span class="id">me</span>, <span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span>)) <span class="id">vs</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.vempty">vempty</a></span>) (<span class="id">e_f</span>, <span class="id">le_f</span>) <span class="id">sb</span> <span class="id">sofs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">instb</span>, <span class="id">instco</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">P</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</span></div>
<div class="proofscript" id="proof58">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Spec</span> <span class="id">Findcl</span> <span class="id">Findmth</span> <span class="id">WTmem</span> <span class="id">WTvs</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_vars">make_out_vars</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#instance_methods">instance_methods</a></span> <span class="id">f</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#NoDupMembers_make_out_vars">NoDupMembers_make_out_vars</a></span>; <span class="id">eauto</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonTyping.html#wt_program_find_unit">wt_program_find_unit</a></span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">xt</span> =&gt; <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.tge">tge</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">xt</span>) &lt;= <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> /\ <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#wf_struct">wf_struct</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.gcenv">gcenv</a></span> <span class="id">xt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_vars">make_out_vars</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#instance_methods">instance_methods</a></span> <span class="id">f</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#instance_methods_caract">instance_methods_caract</a></span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.ObcToClight.Generation.html#translate_param">translate_param</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">f</span>)) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">vs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">symmetry</span>; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.wt_state">wt_state</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.prog">prog</a></span> <span class="id">me</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.vempty">vempty</a></span> <span class="id">c</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.meth_vars">meth_vars</a></span> <span class="id">f</span>)) <span class="kwd">by</span> (<span class="id">split</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">typing</span> <span class="id">obctyping</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">f</span>))) <span class="kwd">by</span> (<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_nodupin">m_nodupin</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">y</span> <span class="id">xt</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">y</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">xt</span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.meth_vars">meth_vars</a></span> <span class="id">f</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">f</span>)) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span> <span class="id">f</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_same">Forall2_same</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="id">intros</span> (<span class="id">x</span>, <span class="id">t</span>) <span class="id">Hin</span>; <span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#in_app">in_app</a></span>; <span class="id">auto</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#method_spec">method_spec</a></span>, <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#case_out">case_out</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">gcenv</span> <span class="id">tge</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_list</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id">f</span>) <span class="kwd">as</span> (<span class="id">a</span>,<span class="id">ta</span>) (?,?) ? : <span class="id">Hout</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Spec</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Spec</span> <span class="kwd">as</span> (<span class="id">P_f</span> &amp;?&amp;?&amp;?&amp; <span class="id">T_f</span> &amp;?&amp;?&amp;?&amp;?); <span class="id">intros</span> * ? <span class="id">Hmem</span>; <span class="id">try</span> <span class="id">intros</span> <span class="id">Hinstco</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;no&nbsp;output&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;get&nbsp;the&nbsp;allocated&nbsp;environment&nbsp;and&nbsp;memory&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#alloc_result">alloc_result</a></span> <span class="kwd">as</span> (<span class="id">e_f</span> &amp; <span class="id">m_f</span> &amp;?&amp;?&amp;?); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">clight</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;get&nbsp;the&nbsp;temporaries&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#bind_parameter_temps_exists_noout">bind_parameter_temps_exists_noout</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.ObcToClight.Generation.html#translate_param">translate_param</a></span> <span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.self">self</a></span>) (<span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst_p">type_of_inst_p</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_name">c_name</a></span> <span class="id">c</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_temps">make_out_temps</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#instance_methods_temp">instance_methods_temp</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.rev_prog">rev_prog</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.prog">prog</a></span>) <span class="id">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_temps">make_out_temps</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#extcalls_temp">extcalls_temp</a></span> <span class="id">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.ObcToClight.Generation.html#translate_param">translate_param</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_vars">m_vars</a></span> <span class="id">f</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vs</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sb</span> <span class="id">sofs</span>)) <span class="kwd">as</span> (<span class="id">le_f</span> &amp; <span class="id">Bind</span> &amp; <span class="id">Vars</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">clight</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">le_f</span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.self">self</a></span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sb</span> <span class="id">sofs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CompCertLib.html#bind_parameter_temps_implies">bind_parameter_temps_implies</a></span> <span class="kwd">in</span> <span class="id">Bind</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">clight</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;-<span class="id">P_f</span> <span class="kwd">in</span> <span class="id">Bind</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">e_f</span>, <span class="id">le_f</span>, <span class="id">m_f</span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>; <span class="id">auto</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">T_f</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_states_conj">match_states_conj</a></span>; <span class="id">intuition</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_nodupvars">m_nodupvars</a></span> <span class="kwd">with</span> <span class="id">obctyping</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class_name">find_class_name</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap">sep_swap</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep_nil">outputrep_nil</a></span>, &lt;-<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepemp_left">sepemp_left</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap">sep_swap</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap23">sep_swap23</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap34">sep_swap34</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap23">sep_swap23</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap">sep_swap</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_pure">sep_pure</a></span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#translate_param_fst">translate_param_fst</a></span> <span class="kwd">in</span> <span class="id">Vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 3 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_app">Forall_app</a></span> <span class="kwd">in</span> <span class="id">Vars</span>; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_app">Forall_app</a></span>; <span class="id">tauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;one&nbsp;output&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">assert</span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.self">self</a></span> &lt;&gt; <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intro</span> <span class="id">contra</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_good_out">m_good_out</a></span> <span class="id">f</span>) <span class="kwd">as</span> <span class="id">Good</span>. <span class="id">rewrite</span> <span class="id">Hout</span> <span class="kwd">in</span> <span class="id">Good</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.self">self</a></span>, <span class="id">ta</span>) [(<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.self">self</a></span>, <span class="id">ta</span>)]) <span class="kwd">as</span> <span class="id">Hin</span> <span class="kwd">by</span> (<span class="id">left</span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Good</span>, <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#AtomOrGensym_inv">AtomOrGensym_inv</a></span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">ident</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;get&nbsp;the&nbsp;allocated&nbsp;environment&nbsp;and&nbsp;memory&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#alloc_result">alloc_result</a></span> <span class="kwd">as</span> (<span class="id">e_f</span> &amp; <span class="id">m_f</span> &amp;?&amp;?&amp;?); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">clight</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;get&nbsp;the&nbsp;temporaries&nbsp;(+&nbsp;the&nbsp;local&nbsp;return&nbsp;temporary)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#bind_parameter_temps_exists_noout">bind_parameter_temps_exists_noout</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.ObcToClight.Generation.html#translate_param">translate_param</a></span> <span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.self">self</a></span>) (<span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst_p">type_of_inst_p</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_name">c_name</a></span> <span class="id">c</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">a</span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#translate_type">translate_type</a></span> <span class="id">ta</span>) ::<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_temps">make_out_temps</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#instance_methods_temp">instance_methods_temp</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.rev_prog">rev_prog</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.prog">prog</a></span>) <span class="id">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_temps">make_out_temps</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#extcalls_temp">extcalls_temp</a></span> <span class="id">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.ObcToClight.Generation.html#translate_param">translate_param</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_vars">m_vars</a></span> <span class="id">f</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vs</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sb</span> <span class="id">sofs</span>)) <span class="kwd">as</span> (<span class="id">le_f</span> &amp; <span class="id">Bind</span> &amp; <span class="id">Vars</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">with</span> <span class="id">clight</span>; <span class="id">try</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NotInMembers_cons">NotInMembers_cons</a></span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">clight</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">le_f</span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.self">self</a></span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sb</span> <span class="id">sofs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CompCertLib.html#bind_parameter_temps_implies">bind_parameter_temps_implies</a></span> <span class="kwd">in</span> <span class="id">Bind</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">clight</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;-<span class="id">P_f</span> <span class="kwd">in</span> <span class="id">Bind</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">e_f</span>, <span class="id">le_f</span>, <span class="id">m_f</span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>; <span class="id">auto</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">T_f</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_states_conj">match_states_conj</a></span>; <span class="id">intuition</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_nodupvars">m_nodupvars</a></span> <span class="kwd">with</span> <span class="id">obctyping</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class_name">find_class_name</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap">sep_swap</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep_singleton">outputrep_singleton</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap">sep_swap</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap23">sep_swap23</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap34">sep_swap34</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap23">sep_swap23</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap">sep_swap</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_cons">map_cons</a></span>, 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#translate_param_fst">translate_param_fst</a></span> <span class="kwd">in</span> <span class="id">Vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_app">Forall_app</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall_cons2">Forall_cons2</a></span>, 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_app">Forall_app</a></span> <span class="kwd">in</span> <span class="id">Vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_pure">sep_pure</a></span>; <span class="id">split</span>; [<span class="id">split</span>|]; <span class="id">auto</span>; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_app">Forall_app</a></span>; <span class="id">tauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;multiple&nbsp;outputs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">assert</span> (1 &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id">f</span>))%<span class="id">nat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">rewrite</span> <span class="id">Hout</span>; <span class="id">simpl</span>; <span class="id">lia</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.self">self</a></span> &lt;&gt; <span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.out">out</a></span>) <span class="kwd">as</span> <span class="id">Hnso</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">apply</span> <span class="id">prefix_injective</span>'; <span class="id">right</span>; <span class="id">prove_str_to_pos_neq</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;get&nbsp;the&nbsp;allocated&nbsp;environment&nbsp;and&nbsp;memory&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#alloc_result">alloc_result</a></span> <span class="kwd">as</span> (<span class="id">e_f</span> &amp; <span class="id">m_f</span> &amp;?&amp;?&amp;?); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">clight</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;get&nbsp;the&nbsp;temporaries&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#bind_parameter_temps_exists">bind_parameter_temps_exists</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.ObcToClight.Generation.html#translate_param">translate_param</a></span> <span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_in">m_in</a></span>)) (<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.self">self</a></span>) (<span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst_p">type_of_inst_p</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_name">c_name</a></span> <span class="id">c</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.out">out</a></span>) (<span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst_p">type_of_inst_p</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix_fun">prefix_fun</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_name">m_name</a></span> <span class="id">f</span>) (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.c_name">c_name</a></span> <span class="id">c</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_temps">make_out_temps</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#instance_methods_temp">instance_methods_temp</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.rev_prog">rev_prog</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry.prog">prog</a></span>) <span class="id">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id"><a href="Velus.ObcToClight.Generation.html#make_out_temps">make_out_temps</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#extcalls_temp">extcalls_temp</a></span> <span class="id">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.ObcToClight.Generation.html#translate_param">translate_param</a></span> <span class="id">f</span>.(<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_vars">m_vars</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vs</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sb</span> <span class="id">sofs</span>) (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#var_ptr">var_ptr</a></span> <span class="id">instb</span>)) <span class="kwd">as</span> (<span class="id">le_f</span> &amp; <span class="id">Bind</span> &amp; <span class="id">Vars</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">clight</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">le_f</span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.self">self</a></span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sb</span> <span class="id">sofs</span>) /\ <span class="id">le_f</span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.obc2c">obc2c</a></span> <span class="id"><a href="Velus.Ident.html#Ids.out">out</a></span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#var_ptr">var_ptr</a></span> <span class="id">instb</span>)) <span class="kwd">as</span> (?&amp;?)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CompCertLib.html#bind_parameter_temps_implies_two">bind_parameter_temps_implies_two</a></span> <span class="kwd">in</span> <span class="id">Bind</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">clight</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;-<span class="id">P_f</span> <span class="kwd">in</span> <span class="id">Bind</span>; <span class="id">setoid_rewrite</span> &lt;-<span class="id">T_f</span> <span class="kwd">in</span> <span class="id">Bind</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">e_f</span>, <span class="id">le_f</span>, <span class="id">m_f</span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>; <span class="id">auto</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#match_states_conj">match_states_conj</a></span>; <span class="id">intuition</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_nodupvars">m_nodupvars</a></span> <span class="kwd">with</span> <span class="id">obctyping</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class_name">find_class_name</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap">sep_swap</a></span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#outputrep_notnil">outputrep_notnil</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_class_name">find_class_name</a></span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.find_method_name">find_method_name</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">instb</span>, <span class="id">instco</span>; <span class="id">intuition</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap23">sep_swap23</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap">sep_swap</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap34">sep_swap34</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap23">sep_swap23</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap34">sep_swap34</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap45">sep_swap45</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap34">sep_swap34</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap23">sep_swap23</a></span>, <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_swap">sep_swap</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_pure">sep_pure</a></span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#translate_param_fst">translate_param_fst</a></span> <span class="kwd">in</span> <span class="id">Vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 3 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_app">Forall_app</a></span> <span class="kwd">in</span> <span class="id">Vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_app">Forall_app</a></span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_imp">sep_imp</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">apply</span> <span class="id">sep_imp</span>'; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep_nodup">fieldsrep_nodup</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#output_match">output_match</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CompCertLib.html#mk_members_names">mk_members_names</a></span>, <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#translate_param_fst">translate_param_fst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_weaken">NoDup_app_weaken</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation.Permutation_app_comm</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#NoDup_swap">NoDup_swap</a></span>, &lt;-2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>, <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_nodupvars">m_nodupvars</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#FunctionEntry">FunctionEntry</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="MainProgram">MainProgram</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="MainProgram.main_node">main_node</a></span>  : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="MainProgram.prog">prog</a></span>       : <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.program">program</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="MainProgram.tprog">tprog</a></span>      : <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#program">Clight.program</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="MainProgram.do_sync">do_sync</a></span>    : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="MainProgram.all_public">all_public</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id"><a name="MainProgram.tge">tge</a></span>              := <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#globalenv">Clight.globalenv</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.tprog">tprog</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id"><a name="MainProgram.gcenv">gcenv</a></span>            := <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#genv_cenv">Clight.genv_cenv</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.tge">tge</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id"><a name="MainProgram.TRANSL">TRANSL</a></span> : <span class="id"><a href="Velus.ObcToClight.Generation.html#translate">translate</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.do_sync">do_sync</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.all_public">all_public</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.main_node">main_node</a></span>) <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.prog">prog</a></span> = <span class="id"><a href="../../CompCert/doc/html/compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.tprog">tprog</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="MainProgram.WT">WT</a></span>     : <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Typ.wt_program">wt_program</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.prog">prog</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id"><a name="MainProgram.out_step">out_step</a></span>   := <span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.out">out</a></span> <span class="id"><a href="Velus.Ident.html#Ids.step">step</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id"><a name="MainProgram.t_out_step">t_out_step</a></span> := <span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst">type_of_inst</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix_fun">prefix_fun</a></span> <span class="id"><a href="Velus.Ident.html#Ids.step">step</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.main_node">main_node</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id"><a name="MainProgram.main_step">main_step</a></span> := <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#main_step">main_step</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.TRANSL">TRANSL</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id"><a name="MainProgram.main_f">main_f</a></span>    := <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#main_f">main_f</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.TRANSL">TRANSL</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="main_with_output_structure">main_with_output_structure</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1 &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.main_step">main_step</a></span>))%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> |= <span class="id">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">m</span>' <span class="id">step_b</span> <span class="id">step_co</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#alloc_variables">alloc_variables</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.tge">tge</a></span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#empty_env">empty_env</a></span> <span class="id">m</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#fn_vars">fn_vars</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.main_f">main_f</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="../../CompCert/doc/html/compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.out_step">out_step</a></span> (<span class="id">step_b</span>, <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.t_out_step">t_out_step</a></span>) <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Clight.html#empty_env">empty_env</a></span>) <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.gcenv">gcenv</a></span> ! (<span class="id"><a href="Velus.Ident.html#Ids.prefix_fun">prefix_fun</a></span> <span class="id"><a href="Velus.Ident.html#Ids.step">step</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.main_node">main_node</a></span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">step_co</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep">fieldsrep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.gcenv">gcenv</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.vempty">vempty</a></span> <span class="id">step_co</span>.(<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_members">co_members</a></span>) <span class="id">step_b</span> ** <span class="id">P</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof59')">Proof.</span></div>
<div class="proofscript" id="proof59">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Len</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">main_step</span> <span class="id">main_f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#case_out">case_out</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_list</span> (<span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Syn.m_out">m_out</a></span> (<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#main_step">GenerationProperties.main_step</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.TRANSL">TRANSL</a></span>)) <span class="kwd">as</span> (?,?) (?,?) ? : <span class="id">Out</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> (<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Len</span>; <span class="id">lia</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;get&nbsp;the&nbsp;allocated&nbsp;memory&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id">m</span> 0 (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.tge">tge</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst">type_of_inst</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix_fun">prefix_fun</a></span> <span class="id"><a href="Velus.Ident.html#Ids.step">step</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.main_node">main_node</a></span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">m</span>', <span class="id">step_b</span>) <span class="id">eqn</span>: <span class="id">AllocStep</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;get&nbsp;the&nbsp;out&nbsp;struct&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#find_main_class">find_main_class</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.TRANSL">TRANSL</a></span>) <span class="kwd">as</span> <span class="id">Find_main</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#find_main_step">find_main_step</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.TRANSL">TRANSL</a></span>) <span class="kwd">as</span> <span class="id">Find_step</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">Out</span> <span class="kwd">in</span> <span class="id">Len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#global_out_struct">global_out_struct</a></span> <span class="kwd">as</span> (<span class="id">step_co</span> &amp; <span class="id">Hsco</span> &amp; ? &amp; <span class="id">Hms</span> &amp; ? &amp; ? &amp; ?); <span class="id">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">m</span>', <span class="id">step_b</span>, <span class="id">step_co</span>; <span class="id">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> (<span class="id">econstructor</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">assert</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.tge">tge</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst">type_of_inst</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix_fun">prefix_fun</a></span> <span class="id"><a href="Velus.Ident.html#Ids.step">step</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.main_node">main_node</a></span>)) &lt;= <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.modulus">Ptrofs.modulus</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">simpl</span>; <span class="id">setoid_rewrite</span> <span class="id">Hsco</span>; <span class="id">transitivity</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#alloc_rule">alloc_rule</a></span> <span class="kwd">in</span> <span class="id">AllocStep</span>; <span class="id">eauto</span>; <span class="id">try</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_imp">sep_imp</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">setoid_rewrite</span> <span class="id">Hsco</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#fieldsrep_empty">fieldsrep_empty</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#Consistent">Consistent</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hms</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hin</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> ((?&amp;?)&amp; <span class="id">E</span>' &amp; <span class="id">Hin</span>); <span class="id">inv</span> <span class="id">E</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> ((?&amp;?)&amp; <span class="id">E</span>' &amp;?); <span class="id">inversion</span> <span class="id">E</span>'; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">clight</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="init_mem">init_mem</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">m</span> <span class="id">sb</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="../../CompCert/doc/html/compcert.common.Globalenvs.html#Genv.init_mem">Genv.init_mem</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.tprog">tprog</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="../../CompCert/doc/html/compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.tge">tge</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix_glob">prefix_glob</a></span> (<span class="id"><a href="Velus.Ident.html#Ids.prefix">prefix</a></span> <span class="id"><a href="Velus.Ident.html#Ids.self">self</a></span> <span class="id"><a href="Velus.Ident.html#Ids.main_id">main_id</a></span>)) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sb</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m</span> |= <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#staterep">staterep</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.gcenv">gcenv</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.prog">prog</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.main_node">main_node</a></span> <span class="id"><a href="Velus.ObcToClight.Interface.html#Obc.Sem.mempty">mempty</a></span> <span class="id">sb</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof60')">Proof.</span></div>
<div class="proofscript" id="proof60">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Globalenvs.html#Genv.init_mem_exists">Genv.init_mem_exists</a></span> <span class="kwd">with</span> (<span class="id">p</span>:=<span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.tprog">tprog</a></span>) <span class="kwd">as</span> (<span class="id">m</span>' &amp; <span class="id">Initmem</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#well_initialized">well_initialized</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.TRANSL">TRANSL</a></span> <span class="kwd">as</span> <span class="id">Trans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv_trans</span> <span class="id">Trans</span> <span class="kwd">as</span> <span class="id">Eexterns</span> <span class="id">En</span> <span class="id">Estep</span> <span class="id">Ereset</span> <span class="id">Eenums</span> <span class="kwd">with</span> <span class="id">structs</span> <span class="id">funs</span> <span class="id">E</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">m</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#find_self">find_self</a></span> <span class="kwd">as</span> (<span class="id">sb</span> &amp; <span class="id">find_step</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">sb</span>; <span class="id">split</span>; [|<span class="id">split</span>]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.tprog">tprog</a></span>.(<span class="id"><a href="../../CompCert/doc/html/compcert.common.AST.html#prog_defs">AST.prog_defs</a></span>)) <span class="kwd">as</span> <span class="id">Nodup</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>, <span class="id"><a href="Velus.Common.CompCertLib.html#NoDup_norepet">NoDup_norepet</a></span>; <span class="id">eapply</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#prog_defs_norepet">prog_defs_norepet</a></span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#init_grange">init_grange</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Nodup</span> <span class="id">Initmem</span>) <span class="kwd">as</span> <span class="id">Hgrange</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">make_program</span>' <span class="kwd">in</span> <span class="id">Trans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">build_composite_env</span>' (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">structs</span>)) <span class="kwd">as</span> [(<span class="id">ce</span>, ?)|]; <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#check_size_env">check_size_env</a></span> <span class="id">ce</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">structs</span>)) <span class="id">eqn</span>: <span class="id">Check_size</span>; <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.ObcToClight.Generation.html#translate_class">translate_class</a></span> <span class="kwd">in</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#split_map">split_map</a></span> <span class="kwd">in</span> <span class="id">E</span>; <span class="id">destruct</span> <span class="id">E</span> <span class="kwd">as</span> [? <span class="id">Funs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Trans</span> <span class="kwd">as</span> [<span class="id">Htprog</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">Htprog</span> <span class="kwd">in</span> <span class="id">Hgrange</span> <span class="kwd">at</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hgrange</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">find_step</span> <span class="kwd">in</span> <span class="id">Hgrange</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_0_r_reverse">Zplus_0_r_reverse</a></span> <span class="kwd">in</span> <span class="id">Hgrange</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_left">Zmax_left</a></span> <span class="kwd">in</span> <span class="id">Hgrange</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">destruct</span> (<span class="id">ce</span> ! <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.main_node">main_node</a></span>); <span class="id">try</span> <span class="id">lia</span>; <span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#co_sizeof_pos">co_sizeof_pos</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">Hgrange</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#sepemp_right">sepemp_right</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#sep_imp">sep_imp</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.ObcToClight.MoreSeparation.html#pure_sepwand">pure_sepwand</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.common.Globalenvs.html#Genv.perm_globvar">Genv.perm_globvar</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">transitivity</span> (<span class="id"><a href="../../CompCert/doc/html/compcert.common.Separation.html#range_w">range_w</a></span> <span class="id">sb</span> 0 (<span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.gcenv">gcenv</a></span> (<span class="id"><a href="Velus.ObcToClight.Generation.html#type_of_inst">type_of_inst</a></span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram.main_node">main_node</a></span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">gcenv</span> <span class="id">tge</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;-<span class="id">Htprog</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#range_staterep">range_staterep</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#Consistent">Consistent</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#make_members_co">make_members_co</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">intro</span> <span class="id">En</span>'; <span class="id">rewrite</span> <span class="id">En</span>' <span class="kwd">in</span> <span class="id">En</span>; <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">edestruct</span> <span class="id"><a href="Velus.ObcToClight.GenerationProperties.html#make_members_co">make_members_co</a></span> <span class="kwd">as</span> (<span class="id">co</span> &amp; <span class="id">Find_main</span> &amp; ? &amp; ? &amp; ? &amp; ? &amp; ?); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">gcenv</span> <span class="id">tge</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">Htprog</span> <span class="kwd">in</span> <span class="id">Find_main</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Find_main</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Find_main</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">transitivity</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>; <span class="id">auto</span>; <span class="id">unfold</span> <span class="id"><a href="../../CompCert/doc/html/compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.ObcToClight.SepInvariant.html#MainProgram">MainProgram</a></span>.<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">match_states_wt_state</span> <span class="id">bounded_struct_of_class_ge0</span> : <span class="id">clight</span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
