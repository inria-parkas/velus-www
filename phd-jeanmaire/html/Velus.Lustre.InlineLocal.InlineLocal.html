
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module InlineLocal</title>
<meta name="description" content="Documentation of Coq module InlineLocal" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module InlineLocal</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#ListNotations">List.ListNotations</a></span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.CommonTyping.html">CommonTyping</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Environment.html">Environment</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Operators.html">Operators</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Clocks.html">Clocks</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Fresh.html">Fresh</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.StaticEnv.html">StaticEnv</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.LSyntax.html">Lustre.LSyntax</a></span>.<br/>
<br/>
<h1> Remove Local Blocks </h1>
<br/>
<span class="kwd">Module</span> <span class="kwd">Type</span> <span class="id"><a name="INLINELOCAL">INLINELOCAL</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ids</span> : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Op</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Cks</span> : <span class="id"><a href="Velus.Clocks.html#CLOCKS">CLOCKS</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Senv</span> : <span class="id"><a href="Velus.Lustre.StaticEnv.html#STATICENV">STATICENV</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Syn</span> : <span class="id"><a href="Velus.Lustre.LSyntax.html#LSYNTAX">LSYNTAX</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv">Senv</a></span>).<br/>
<br/>
<h2> Rename some variables </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="INLINELOCAL.rename">rename</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="INLINELOCAL.rename.sub">sub</a></span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="INLINELOCAL.rename_var">rename_var</a></span> (<span class="id">x</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename.sub">sub</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="INLINELOCAL.rename_clock">rename_clock</a></span> (<span class="id">ck</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks.clock">clock</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ck</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks.Cbase">Cbase</a></span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks.Cbase">Cbase</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks.Con">Con</a></span> <span class="id">ck</span>' <span class="id">x</span> <span class="id">t</span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks.Con">Con</a></span> (<span class="id">rename_clock</span> <span class="id">ck</span>') (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">x</span>) <span class="id">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="INLINELOCAL.rename_nclock">rename_nclock</a></span> (<span class="id">nck</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks.nclock">nclock</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clock">rename_clock</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">nck</span>), <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">nck</span>)).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="INLINELOCAL.rename_ann">rename_ann</a></span> {<span class="id">A</span>} (<span class="id">ann</span> : (<span class="id">A</span> * <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks.clock">clock</a></span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ann</span>, <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clock">rename_clock</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">ann</span>)).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="INLINELOCAL.rename_exp">rename_exp</a></span> (<span class="id">e</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.exp">exp</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Econst">Econst</a></span> <span class="id">_</span> | <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Eenum">Eenum</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Evar">Evar</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.ann">ann</a></span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Evar">Evar</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_ann">rename_ann</a></span> <span class="id">ann</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Elast">Elast</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.ann">ann</a></span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Elast">Elast</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_ann">rename_ann</a></span> <span class="id">ann</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Eunop">Eunop</a></span> <span class="id">op</span> <span class="id">e1</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.ann">ann</a></span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Eunop">Eunop</a></span> <span class="id">op</span> (<span class="id">rename_exp</span> <span class="id">e1</span>) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_ann">rename_ann</a></span> <span class="id">ann</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Ebinop">Ebinop</a></span> <span class="id">op</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.ann">ann</a></span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Ebinop">Ebinop</a></span> <span class="id">op</span> (<span class="id">rename_exp</span> <span class="id">e1</span>) (<span class="id">rename_exp</span> <span class="id">e2</span>) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_ann">rename_ann</a></span> <span class="id">ann</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Eextcall">Eextcall</a></span> <span class="id">f</span> <span class="id">es</span> (<span class="id">tyout</span>, <span class="id">ck</span>) =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Eextcall">Eextcall</a></span> <span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">rename_exp</span> <span class="id">es</span>) (<span class="id">tyout</span>, <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clock">rename_clock</a></span> <span class="id">ck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Efby">Efby</a></span> <span class="id">e0s</span> <span class="id">e1s</span> <span class="id">anns</span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Efby">Efby</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">rename_exp</span> <span class="id">e0s</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">rename_exp</span> <span class="id">e1s</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_ann">rename_ann</a></span> <span class="id">anns</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Earrow">Earrow</a></span> <span class="id">e0s</span> <span class="id">e1s</span> <span class="id">anns</span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Earrow">Earrow</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">rename_exp</span> <span class="id">e0s</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">rename_exp</span> <span class="id">e1s</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_ann">rename_ann</a></span> <span class="id">anns</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Ewhen">Ewhen</a></span> <span class="id">es</span> (<span class="id">x</span>, <span class="id">tx</span>) <span class="id">t</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.ann">ann</a></span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Ewhen">Ewhen</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">rename_exp</span> <span class="id">es</span>) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">x</span>, <span class="id">tx</span>) <span class="id">t</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_ann">rename_ann</a></span> <span class="id">ann</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Emerge">Emerge</a></span> (<span class="id">x</span>, <span class="id">ty</span>) <span class="id">es</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.ann">ann</a></span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Emerge">Emerge</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">x</span>, <span class="id">ty</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; (<span class="id">i</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">rename_exp</span> <span class="id">es</span>)) <span class="id">es</span>) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_ann">rename_ann</a></span> <span class="id">ann</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Ecase">Ecase</a></span> <span class="id">e</span> <span class="id">es</span> <span class="id">d</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.ann">ann</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Ecase">Ecase</a></span> (<span class="id">rename_exp</span> <span class="id">e</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; (<span class="id">i</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">rename_exp</span> <span class="id">es</span>)) <span class="id">es</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">rename_exp</span>) <span class="id">d</span>) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_ann">rename_ann</a></span> <span class="id">ann</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Eapp">Eapp</a></span> <span class="id">f</span> <span class="id">es</span> <span class="id">er</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.ann">ann</a></span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Eapp">Eapp</a></span> <span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">rename_exp</span> <span class="id">es</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">rename_exp</span> <span class="id">er</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_ann">rename_ann</a></span> <span class="id">ann</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="INLINELOCAL.rename_equation">rename_equation</a></span> '(<span class="id">xs</span>, <span class="id">es</span>) : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.equation">equation</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">xs</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_exp">rename_exp</a></span> <span class="id">es</span>).<br/>
<br/>
<h3> Properties </h3>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.rename_ann_clock">rename_ann_clock</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> (<span class="id">ann</span> : (<span class="id">A</span> * <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks.clock">clock</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_ann">rename_ann</a></span> <span class="id">ann</span>) = <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clock">rename_clock</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">ann</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
 <span class="id">reflexivity</span>. Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="INLINELOCAL.map_rename_ann_clock">map_rename_ann_clock</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> (<span class="id">anns</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id">A</span> * <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks.clock">clock</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_ann">rename_ann</a></span> <span class="id">anns</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clock">rename_clock</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">anns</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">anns</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.map_rename_ann_type">map_rename_ann_type</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> (<span class="id">anns</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id">A</span> * <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks.clock">clock</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_ann">rename_ann</a></span> <span class="id">anns</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">anns</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">anns</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename">rename</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="INLINELOCAL.rename_clockof">rename_clockof</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="INLINELOCAL.rename_clockof.sub">sub</a></span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.rename_exp_nclockof">rename_exp_nclockof</a></span> : <span class="kwd">forall</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.nclockof">nclockof</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_exp">rename_exp</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clockof.sub">sub</a></span> <span class="id">e</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_nclock">rename_nclock</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clockof.sub">sub</a></span>) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.nclockof">nclockof</a></span> <span class="id">e</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">e</span>; <span class="id">destruct_conjs</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">rewrite</span> ? <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="INLINELOCAL.rename_exp_nclocksof">rename_exp_nclocksof</a></span> : <span class="kwd">forall</span> <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.nclocksof">nclocksof</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_exp">rename_exp</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clockof.sub">sub</a></span>) <span class="id">es</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_nclock">rename_nclock</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clockof.sub">sub</a></span>) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.nclocksof">nclocksof</a></span> <span class="id">es</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">es</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.nclocksof">nclocksof</a></span>. <span class="id">rewrite</span> 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat_map">concat_map</a></span>, 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>; <span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_exp_nclockof">rename_exp_nclockof</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="INLINELOCAL.rename_exp_clockof">rename_exp_clockof</a></span> : <span class="kwd">forall</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.clockof">clockof</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_exp">rename_exp</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clockof.sub">sub</a></span> <span class="id">e</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clock">rename_clock</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clockof.sub">sub</a></span>) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.clockof">clockof</a></span> <span class="id">e</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.clockof_nclockof">clockof_nclockof</a></span>, <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_exp_nclockof">rename_exp_nclockof</a></span>, 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="INLINELOCAL.rename_exp_clocksof">rename_exp_clocksof</a></span> : <span class="kwd">forall</span> <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.clocksof">clocksof</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_exp">rename_exp</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clockof.sub">sub</a></span>) <span class="id">es</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clock">rename_clock</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clockof.sub">sub</a></span>) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">es</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.clocksof">clocksof</a></span>. <span class="id">rewrite</span> 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat_map">concat_map</a></span>, 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>; <span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_exp_clockof">rename_exp_clockof</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clockof">rename_clockof</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="INLINELOCAL.rename_typeof">rename_typeof</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="INLINELOCAL.rename_typeof.bck">bck</a></span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks.clock">clock</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="INLINELOCAL.rename_typeof.sub">sub</a></span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.rename_exp_typeof">rename_exp_typeof</a></span> : <span class="kwd">forall</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.typeof">typeof</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_exp">rename_exp</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_typeof.sub">sub</a></span> <span class="id">e</span>) = <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.typeof">typeof</a></span> <span class="id">e</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">e</span>; <span class="id">destruct_conjs</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">rewrite</span> ? <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="INLINELOCAL.rename_exp_typesof">rename_exp_typesof</a></span> : <span class="kwd">forall</span> <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.typesof">typesof</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_exp">rename_exp</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_typeof.sub">sub</a></span>) <span class="id">es</span>) = <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.typesof">typesof</a></span> <span class="id">es</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">es</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.typesof">typesof</a></span> . <span class="id">rewrite</span> 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>; <span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_exp_typeof">rename_exp_typeof</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_typeof">rename_typeof</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="INLINELOCAL.rename_empty">rename_empty</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.rename_var_empty">rename_var_empty</a></span> : <span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> (<span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id">_</span>) <span class="id">x</span> = <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gempty">Env.gempty</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="INLINELOCAL.rename_vars_empty">rename_vars_empty</a></span> : <span class="kwd">forall</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> (<span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id">_</span>)) <span class="id">xs</span> = <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">xs</span>; <span class="id">simpl</span>; <span class="id">f_equal</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var_empty">rename_var_empty</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_empty">rename_empty</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.rename_var_IsLast">rename_var_IsLast</a></span> <span class="id">sub</span> Γ Γ' : <span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">sub</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.IsLast">IsLast</a></span> Γ' <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">sub</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.IsLast">IsLast</a></span> Γ' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.IsLast">IsLast</a></span> Γ' (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">sub</span> <span class="id">x</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Sub</span> <span class="id">NSub</span> <span class="id">In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hfind</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> More properties </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.not_in_union_rename2">not_in_union_rename2</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">sub</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> (<span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> <span class="id">ys</span> <span class="id">zs</span> <span class="id">sub</span>) <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">sub</span> <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hnin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">sub</span>)) <span class="id">eqn</span>:<span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">Env.find_adds</span>'<span class="id">_In</span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> [<span class="id">Hfind</span>|<span class="id">Hfind</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_combine_l">in_combine_l</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">Env.find_adds</span>'<span class="id">_nIn</span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> (?&amp;<span class="id">Hfind1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hfind1</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="INLINELOCAL.not_in_union_map_rename2">not_in_union_map_rename2</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">sub</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; ~<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">ys</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> (<span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> <span class="id">ys</span> <span class="id">zs</span> <span class="id">sub</span>)) <span class="id">xs</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">sub</span>) <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">xs</span>; <span class="id">intros</span> * <span class="id">Hf</span>; <span class="id">inv</span> <span class="id">Hf</span>; <span class="id">simpl</span>; <span class="id">f_equal</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.not_in_union_rename2">not_in_union_rename2</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.disjoint_union_rename_var">disjoint_union_rename_var</a></span> : <span class="kwd">forall</span> (<span class="id">sub1</span>: <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) <span class="id">xs</span> <span class="id">ys</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> <span class="id">sub1</span> -&gt; ~<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">sub1</span> -&gt; ~<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">y</span> <span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> (<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">xs</span> <span class="id">ys</span>)) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">sub1</span> <span class="id">x</span>) = <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> (<span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">sub1</span>) <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hnin1</span> <span class="id">Hnin2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)) <span class="id">eqn</span>:<span class="id">Hfind</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">sub1</span>) <span class="id">eqn</span>:<span class="id">Hfind1</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">Hnin2</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hfind1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">i0</span> <span class="id">_</span>) <span class="kwd">with</span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">symmetry</span>. <span class="id">apply</span> <span class="id">Env.find_adds</span>'<span class="id">_nIn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gempty">Env.gempty</a></span>. <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">Hnin2</span>. <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_In_combine">InMembers_In_combine</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Env.gsso</span>' <span class="kwd">in</span> <span class="id">Hfind</span>. <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ?. <span class="id">eapply</span> <span class="id">Hnin1</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_In_combine">InMembers_In_combine</a></span>. <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">unfold</span> <span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">Env.find_gsss</span>'<span class="id">_irrelevant</span>; <span class="id">eauto</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Env.find_adds</span>'<span class="id">_In</span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> [<span class="id">Hfind</span>|<span class="id">Hfind</span>]; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">Env.find_adds</span>'<span class="id">_nIn</span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> (<span class="id">Hfind1</span>&amp;<span class="id">Hfind2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hfind2</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">_</span>) <span class="kwd">with</span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">symmetry</span>. <span class="id">apply</span> <span class="id">Env.find_adds</span>'<span class="id">_nIn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gempty">Env.gempty</a></span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="INLINELOCAL.disjoint_union_rename_in_clock">disjoint_union_rename_in_clock</a></span> : <span class="kwd">forall</span> (<span class="id">sub1</span>: <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) <span class="id">xs</span> <span class="id">ys</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> <span class="id">sub1</span> -&gt; ~<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="Velus.Environment.html#Env.MapsTo">Env.MapsTo</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">sub1</span> -&gt; ~<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">y</span> <span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clock">rename_clock</a></span> (<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">xs</span> <span class="id">ys</span>)) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clock">rename_clock</a></span> <span class="id">sub1</span> <span class="id">ck</span>) = <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clock">rename_clock</a></span> (<span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">sub1</span>) <span class="id">ck</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hsub1</span> <span class="id">Hsub2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ck</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.disjoint_union_rename_var">disjoint_union_rename_var</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> Inlining of local blocks </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="id"><a name="INLINELOCAL.Fresh">Fresh</a></span> := <span class="id"><a href="Velus.Fresh.html#Fresh">Fresh.Fresh</a></span>(<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids">Ids</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Fresh">Fresh</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Fresh.Notations">Notations</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Fresh.Facts">Facts</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Fresh.Tactics">Tactics</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Record</span> <span class="id"><a name="INLINELOCAL.reuse_st">reuse_st</a></span> := {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="INLINELOCAL.fresh_st">fresh_st</a></span>: <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.fresh_st">fresh_st</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.local">local</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="INLINELOCAL.used">used</a></span>: <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="INLINELOCAL.Reuse">Reuse</a></span> <span class="id">A</span> := <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_st">reuse_st</a></span> -&gt; (<span class="id">A</span> * <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_st">reuse_st</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="INLINELOCAL.reuse_ident">reuse_ident</a></span> (<span class="id">x</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">st</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Common.Common.html#PS.mem">PS.mem</a></span> <span class="id">x</span> <span class="id">st</span>.(<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.used">used</a></span>) <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">y</span>, <span class="id">st</span>') := <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.fresh_ident">fresh_ident</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">st</span>.(<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.fresh_st">fresh_st</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">y</span>, {| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.fresh_st">fresh_st</a></span> := <span class="id">st</span>'; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.used">used</a></span> := <span class="id">st</span>.(<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.used">used</a></span>) |})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span>, {| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.fresh_st">fresh_st</a></span> := <span class="id">st</span>.(<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.fresh_st">fresh_st</a></span>); <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.used">used</a></span> := <span class="id"><a href="Velus.Common.Common.html#PS.add">PS.add</a></span> <span class="id">x</span> <span class="id">st</span>.(<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.used">used</a></span>) |}).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="INLINELOCAL.ret">ret</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="INLINELOCAL.ret">ret</a></span> (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret.A">A</a></span>) : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret.A">A</a></span> := <span class="kwd">fun</span> <span class="id">st</span> =&gt; (<span class="id">x</span>, <span class="id">st</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.ret_spec">ret_spec</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">st</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret">ret</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a</span>, <span class="id">st</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">a</span> <span class="id">st</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret">ret</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="INLINELOCAL.bind">bind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="INLINELOCAL.bind">bind</a></span> (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind.A">A</a></span>) (<span class="id">k</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind.B">B</a></span>) : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind.B">B</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">st</span> =&gt; <span class="kwd">let</span> '(<span class="id">a</span>, <span class="id">st</span>') := <span class="id">x</span> <span class="id">st</span> <span class="kwd">in</span> <span class="id">k</span> <span class="id">a</span> <span class="id">st</span>'.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.bind_spec">bind_spec</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind.A">A</a></span>) (<span class="id">k</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind.B">B</a></span>) <span class="id">st</span> <span class="id">a</span>' <span class="id">st</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind">bind</a></span> <span class="id">x</span> <span class="id">k</span>) <span class="id">st</span> = (<span class="id">a</span>', <span class="id">st</span>'') &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">a</span>, <span class="kwd">exists</span> <span class="id">st</span>', (<span class="id">x</span> <span class="id">st</span> = (<span class="id">a</span>, <span class="id">st</span>') /\ <span class="id">k</span> <span class="id">a</span> <span class="id">st</span>' = (<span class="id">a</span>', <span class="id">st</span>'')).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">k</span> <span class="id">st</span> <span class="id">a</span>' <span class="id">st</span>''. <span class="id">split</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind">bind</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">x</span> <span class="id">st</span>) <span class="kwd">as</span> [<span class="id">a</span> <span class="id">st</span>']. <span class="kwd">exists</span> <span class="id">a</span>. <span class="kwd">exists</span> <span class="id">st</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">a</span> [<span class="id">st</span>' [<span class="id">H1</span> <span class="id">H2</span>]]]. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind">bind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H1</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind">bind</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="INLINELOCAL.bind2">bind2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A1</span> <span class="id">A2</span> <span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="INLINELOCAL.bind2">bind2</a></span> (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2.A1">A1</a></span> * <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2.A2">A2</a></span>)) (<span class="id">k</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2.A1">A1</a></span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2.A2">A2</a></span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2.B">B</a></span>) : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2.B">B</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">st</span> =&gt; <span class="kwd">let</span> '((<span class="id">a1</span>, <span class="id">a2</span>), <span class="id">st</span>') := <span class="id">x</span> <span class="id">st</span> <span class="kwd">in</span> <span class="id">k</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">st</span>'.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.bind2_spec">bind2_spec</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2.A1">A1</a></span> * <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2.A2">A2</a></span>)) (<span class="id">k</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2.A1">A1</a></span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2.A2">A2</a></span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2.B">B</a></span>) <span class="id">st</span> <span class="id">a</span>' <span class="id">st</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2">bind2</a></span> <span class="id">x</span> <span class="id">k</span>) <span class="id">st</span> = (<span class="id">a</span>', <span class="id">st</span>'') &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">a1</span>, <span class="kwd">exists</span> <span class="id">a2</span>, <span class="kwd">exists</span> <span class="id">st</span>', (<span class="id">x</span> <span class="id">st</span> = ((<span class="id">a1</span>, <span class="id">a2</span>), <span class="id">st</span>') /\ <span class="id">k</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">st</span>' = (<span class="id">a</span>', <span class="id">st</span>'')).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">k</span> <span class="id">st</span> <span class="id">a</span>' <span class="id">st</span>''. <span class="id">split</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2">bind2</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">x</span> <span class="id">st</span>) <span class="kwd">as</span> [[<span class="id">a1</span> <span class="id">a2</span>] <span class="id">st</span>']. <span class="kwd">exists</span> <span class="id">a1</span>. <span class="kwd">exists</span> <span class="id">a2</span>. <span class="kwd">exists</span> <span class="id">st</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">a1</span> [<span class="id">a2</span> [<span class="id">st</span>' [<span class="id">H1</span> <span class="id">H2</span>]]]]. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2">bind2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H1</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2">bind2</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="INLINELOCAL.st_In">st_In</a></span> <span class="id">x</span> (<span class="id">st</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_st">reuse_st</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_ids">st_ids</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.fresh_st">fresh_st</a></span> <span class="id">st</span>)) \/ <span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.used">used</a></span> <span class="id">st</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="INLINELOCAL.st_valid">st_valid</a></span> (<span class="id">st</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_st">reuse_st</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#PS.For_all">PS.For_all</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span>) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.used">used</a></span> <span class="id">st</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="INLINELOCAL.st_follows">st_follows</a></span> (<span class="id">st1</span> <span class="id">st2</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_st">reuse_st</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.fresh_st">fresh_st</a></span> <span class="id">st1</span>) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.fresh_st">fresh_st</a></span> <span class="id">st2</span>) /\ <span class="id"><a href="Velus.Common.Common.html#PS.Subset">PS.Subset</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.used">used</a></span> <span class="id">st1</span>) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.used">used</a></span> <span class="id">st2</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="INLINELOCAL.st_follows_Reflexive">st_follows_Reflexive</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Reflexive">Reflexive</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
 <span class="id">split</span>; <span class="id">reflexivity</span>. Qed.</div>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="INLINELOCAL.st_follows_Transitive">st_follows_Transitive</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Transitive">Transitive</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
 <span class="id">intros</span> ??? (?&amp;?) (?&amp;?). <span class="id">split</span>; <span class="id">etransitivity</span>; <span class="id">eauto</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.st_follows_In">st_follows_In</a></span> : <span class="kwd">forall</span> <span class="id">st1</span> <span class="id">st2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st1</span> <span class="id">st2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_In">st_In</a></span> <span class="id">x</span> <span class="id">st1</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_In">st_In</a></span> <span class="id">x</span> <span class="id">st2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * (<span class="id">F1</span>&amp;<span class="id">F2</span>) ? [<span class="id">In</span>|<span class="id">In</span>]; [<span class="id">left</span>|<span class="id">right</span>]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#incl_map">incl_map</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows_incl">st_follows_incl</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="id">Declare</span> <span class="kwd">Scope</span> <span class="id">reuse_monad_scope</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "'<span class="id">do</span>' <span class="id">X</span> &lt;- <span class="id">A</span> ; <span class="id">B</span>" :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind">bind</a></span> <span class="id">A</span> (<span class="kwd">fun</span> <span class="id">X</span> =&gt; <span class="id">B</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">at</span> <span class="id">level</span> 200, <span class="id">X</span> <span class="id">name</span>, <span class="id">A</span> <span class="kwd">at</span> <span class="id">level</span> 100, <span class="id">B</span> <span class="kwd">at</span> <span class="id">level</span> 200): <span class="id">reuse_monad_scope</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "'<span class="id">do</span>' ( <span class="id">X</span> , <span class="id">Y</span> ) &lt;- <span class="id">A</span> ; <span class="id">B</span>" :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2">bind2</a></span> <span class="id">A</span> (<span class="kwd">fun</span> <span class="id">X</span> <span class="id">Y</span> =&gt; <span class="id">B</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">at</span> <span class="id">level</span> 200, <span class="id">X</span> <span class="id">name</span>, <span class="id">Y</span> <span class="id">name</span>, <span class="id">A</span> <span class="kwd">at</span> <span class="id">level</span> 100, <span class="id">B</span> <span class="kwd">at</span> <span class="id">level</span> 200): <span class="id">reuse_monad_scope</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">reuse_monad_scope</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">monadInv</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id">context</span> <span class="id">c</span> [<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret">ret</a></span> <span class="id">_</span> <span class="id">_</span>] |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret_spec">ret_spec</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : (<span class="id">_</span>, <span class="id">_</span>) = (<span class="id">_</span>, <span class="id">_</span>) |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind">bind</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = (<span class="id">_</span>, <span class="id">_</span>) |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind_spec">bind_spec</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [? [? [? ?]]]; <span class="id">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2">bind2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = (<span class="id">_</span>, <span class="id">_</span>) |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2_spec">bind2_spec</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [? [? [? [? ?]]]]; <span class="id">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span> <span class="id">c</span> [<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret">ret</a></span> <span class="id">_</span> <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret_spec">ret_spec</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind">bind</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = (<span class="id">_</span>, <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind_spec">bind_spec</a></span>; <span class="id">repeat</span> <span class="id">esplit</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2">bind2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = (<span class="id">_</span>, <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.bind2_spec">bind2_spec</a></span>; <span class="id">repeat</span> <span class="id">esplit</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="INLINELOCAL.mmap">mmap</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="INLINELOCAL.mmap.k">k</a></span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap.B">B</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="INLINELOCAL.mmap">mmap</a></span> <span class="id">a</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">a</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret">ret</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#hd">hd</a></span>::<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#tl">tl</a></span> =&gt; <span class="id">do</span> <span class="id">a1</span> &lt;- <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap.k">k</a></span> <span class="id">hd</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">a1s</span> &lt;- <span class="id">mmap</span> <span class="id">tl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret">ret</a></span> (<span class="id">a1</span>::<span class="id">a1s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.mmap_values">mmap_values</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">st</span> <span class="id">a1s</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1s</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">a1</span> =&gt; <span class="kwd">exists</span> <span class="id">st</span>'', <span class="kwd">exists</span> <span class="id">st</span>''', <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap.k">k</a></span> <span class="id">a</span> <span class="id">st</span>'' = (<span class="id">a1</span>, <span class="id">st</span>''')) <span class="id">a</span> <span class="id">a1s</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">a</span>; <span class="id">intros</span> <span class="id">st</span> <span class="id">a1s</span> <span class="id">st</span>' <span class="id">Hfold</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">IHa</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.mmap_st_valid">mmap_st_valid</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">a1s</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1s</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="kwd">forall</span> <span class="id">a1</span> <span class="id">st</span> <span class="id">st</span>', <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap.k">k</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1</span>, <span class="id">st</span>') -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span>') <span class="id">a</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span>'.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">a</span>; <span class="id">intros</span> * <span class="id">Hmap</span> <span class="id">F</span> <span class="id">Val</span>; <span class="id">inv</span> <span class="id">F</span>; <span class="id">repeat</span> <span class="id">monadInv</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.mmap_st_follows">mmap_st_follows</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">a1s</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1s</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="kwd">forall</span> <span class="id">a1</span> <span class="id">st</span> <span class="id">st</span>', <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap.k">k</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1</span>, <span class="id">st</span>') -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st</span>') <span class="id">a</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st</span>'.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">a</span>; <span class="id">intros</span> * <span class="id">Hmap</span> <span class="id">F</span>; <span class="id">inv</span> <span class="id">F</span>; <span class="id">repeat</span> <span class="id">monadInv</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">etransitivity</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.mmap_values_follows">mmap_values_follows</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">st</span> <span class="id">a1s</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span> <span class="id">a1</span> <span class="id">st</span> <span class="id">st</span>', <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap.k">k</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1</span>, <span class="id">st</span>') -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1s</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">a1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">st</span>'' <span class="id">st</span>''',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st</span>''<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span>''' <span class="id">st</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap.k">k</a></span> <span class="id">a</span> <span class="id">st</span>'' = (<span class="id">a1</span>, <span class="id">st</span>''')) <span class="id">a</span> <span class="id">a1s</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">a</span>; <span class="id">intros</span> * <span class="id">Follows</span> <span class="id">Hfold</span>; <span class="id">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">split</span>; [|<span class="id">split</span>]. 3:<span class="id">eauto</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_st_follows">mmap_st_follows</a></span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id">IHa</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">split</span>; [|<span class="id">split</span>]. 3:<span class="id">eauto</span>. 2:<span class="id">eauto</span>. <span class="id">etransitivity</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id">mmap_values</span>' : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">st</span> <span class="id">a1s</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="kwd">forall</span> <span class="id">a1</span> <span class="id">st</span> <span class="id">st</span>', <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap.k">k</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1</span>, <span class="id">st</span>') -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span>') <span class="id">a</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span> <span class="id">a1</span> <span class="id">st</span> <span class="id">st</span>', <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap.k">k</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1</span>, <span class="id">st</span>') -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1s</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">a1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">st</span>'' <span class="id">st</span>''',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span>''<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st</span>''<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span>''' <span class="id">st</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap.k">k</a></span> <span class="id">a</span> <span class="id">st</span>'' = (<span class="id">a1</span>, <span class="id">st</span>''')) <span class="id">a</span> <span class="id">a1s</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">a</span>; <span class="id">intros</span> * <span class="id">Valid</span> <span class="id">Follows</span> <span class="id">Hfold</span> <span class="id">V</span>; <span class="id">inv</span> <span class="id">Valid</span>; <span class="id">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">split</span>; [|<span class="id">split</span>; [|<span class="id">split</span>]]. 1,4:<span class="id">eauto</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_st_follows">mmap_st_follows</a></span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id">IHa</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">split</span>; [|<span class="id">split</span>; [|<span class="id">split</span>]]. 1,4:<span class="id">eauto</span>. 2:<span class="id">eauto</span>. <span class="id">etransitivity</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="INLINELOCAL.mmap2">mmap2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">A1</span> <span class="id">A2</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="INLINELOCAL.mmap2.k">k</a></span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2.A1">A1</a></span> * <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2.A2">A2</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="INLINELOCAL.mmap2">mmap2</a></span> (<span class="id">a</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2.A">A</a></span>) : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2.A1">A1</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2.A2">A2</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">a</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret">ret</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#hd">hd</a></span>::<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#tl">tl</a></span> =&gt; <span class="id">do</span> (<span class="id">a1</span>, <span class="id">a2</span>) &lt;- <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2.k">k</a></span> <span class="id">hd</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> (<span class="id">a1s</span>, <span class="id">a2s</span>) &lt;- <span class="id">mmap2</span> <span class="id">tl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret">ret</a></span> (<span class="id">a1</span>::<span class="id">a1s</span>, <span class="id">a2</span>::<span class="id">a2s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.mmap2_values">mmap2_values</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">st</span> <span class="id">a1s</span> <span class="id">a2s</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2">mmap2</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1s</span>, <span class="id">a2s</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#Forall3">Forall3</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">a1</span> <span class="id">a2</span> =&gt; <span class="kwd">exists</span> <span class="id">st</span>'', <span class="kwd">exists</span> <span class="id">st</span>''', <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2.k">k</a></span> <span class="id">a</span> <span class="id">st</span>'' = (<span class="id">a1</span>, <span class="id">a2</span>, <span class="id">st</span>''')) <span class="id">a</span> <span class="id">a1s</span> <span class="id">a2s</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">a</span>; <span class="id">intros</span> <span class="id">st</span> <span class="id">a1s</span> <span class="id">a2s</span> <span class="id">st</span>' <span class="id">Hfold</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">IHa</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.mmap2_st_valid">mmap2_st_valid</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">a1s</span> <span class="id">a2s</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2">mmap2</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1s</span>, <span class="id">a2s</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="kwd">forall</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">st</span> <span class="id">st</span>', <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2.k">k</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1</span>, <span class="id">a2</span>, <span class="id">st</span>') -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span>') <span class="id">a</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span>'.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">a</span>; <span class="id">intros</span> <span class="id">a1s</span> <span class="id">a2s</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">Hmap</span> <span class="id">F</span>; <span class="id">inv</span> <span class="id">F</span>; <span class="id">repeat</span> <span class="id">monadInv</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.mmap2_st_follows">mmap2_st_follows</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">a1s</span> <span class="id">a2s</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2">mmap2</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1s</span>, <span class="id">a2s</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="kwd">forall</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">st</span> <span class="id">st</span>', <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2.k">k</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1</span>, <span class="id">a2</span>, <span class="id">st</span>') -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st</span>') <span class="id">a</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st</span>'.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">a</span>; <span class="id">intros</span> <span class="id">a1s</span> <span class="id">a2s</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">Hmap</span> <span class="id">F</span>; <span class="id">inv</span> <span class="id">F</span>; <span class="id">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">etransitivity</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.mmap2_values_follows">mmap2_values_follows</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">st</span> <span class="id">a1s</span> <span class="id">a2s</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">st</span> <span class="id">st</span>', <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2.k">k</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1</span>, <span class="id">a2</span>, <span class="id">st</span>') -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2">mmap2</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1s</span>, <span class="id">a2s</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#Forall3">Forall3</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">a1</span> <span class="id">a2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">st</span>'' <span class="id">st</span>''',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st</span>''<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span>''' <span class="id">st</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2.k">k</a></span> <span class="id">a</span> <span class="id">st</span>'' = (<span class="id">a1</span>, <span class="id">a2</span>, <span class="id">st</span>''')) <span class="id">a</span> <span class="id">a1s</span> <span class="id">a2s</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">a</span>; <span class="id">intros</span> * <span class="id">Follows</span> <span class="id">Hfold</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">split</span>; [|<span class="id">split</span>]. 3:<span class="id">eauto</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_st_follows">mmap2_st_follows</a></span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id">IHa</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_impl_In">Forall3_impl_In</a></span>; [|<span class="id">eauto</span>]. <span class="id">intros</span>; <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">split</span>; [|<span class="id">split</span>]. 3:<span class="id">eauto</span>. 2:<span class="id">eauto</span>. <span class="id">etransitivity</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id">mmap2_values</span>' : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">st</span> <span class="id">a1s</span> <span class="id">a2s</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="kwd">forall</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">st</span> <span class="id">st</span>', <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2.k">k</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1</span>, <span class="id">a2</span>, <span class="id">st</span>') -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span>') <span class="id">a</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">st</span> <span class="id">st</span>', <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2.k">k</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1</span>, <span class="id">a2</span>, <span class="id">st</span>') -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2">mmap2</a></span> <span class="id">a</span> <span class="id">st</span> = (<span class="id">a1s</span>, <span class="id">a2s</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#Forall3">Forall3</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">a1</span> <span class="id">a2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">st</span>'' <span class="id">st</span>''',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span>''<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st</span>''<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span>''' <span class="id">st</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2.k">k</a></span> <span class="id">a</span> <span class="id">st</span>'' = (<span class="id">a1</span>, <span class="id">a2</span>, <span class="id">st</span>''')) <span class="id">a</span> <span class="id">a1s</span> <span class="id">a2s</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">a</span>; <span class="id">intros</span> * <span class="id">Valid</span> <span class="id">Follows</span> <span class="id">Hfold</span> <span class="id">V</span>; <span class="id">inv</span> <span class="id">Valid</span>; <span class="id">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">split</span>; [|<span class="id">split</span>; [|<span class="id">split</span>]]. 1,4:<span class="id">eauto</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_st_follows">mmap2_st_follows</a></span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id">IHa</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_impl_In">Forall3_impl_In</a></span>; [|<span class="id">eauto</span>]. <span class="id">intros</span>; <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">split</span>; [|<span class="id">split</span>; [|<span class="id">split</span>]]. 1,4:<span class="id">eauto</span>. 2:<span class="id">eauto</span>. <span class="id">etransitivity</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2">mmap2</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">sub</span> (<span class="id">blk</span> : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block">block</a></span>) : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.decl">decl</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block">block</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">blk</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Beq">Beq</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret">ret</a></span> ([], [<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Beq">Beq</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_equation">rename_equation</a></span> <span class="id">sub</span> <span class="id">eq</span>)])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Blast">Blast</a></span> <span class="id">x</span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret">ret</a></span> ([], [<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Blast">Blast</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">sub</span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_exp">rename_exp</a></span> <span class="id">sub</span> <span class="id">e</span>)])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Breset">Breset</a></span> <span class="id">blks</span> <span class="id">er</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> (<span class="id">locs</span>, <span class="id">blks</span>') &lt;- <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2">mmap2</a></span> (<span class="id">inlinelocal_block</span> <span class="id">sub</span>) <span class="id">blks</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret">ret</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">locs</span>, [<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Breset">Breset</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">blks</span>') (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_exp">rename_exp</a></span> <span class="id">sub</span> <span class="id">er</span>)])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Blocal">Blocal</a></span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xs</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">newlocs</span> &lt;- <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="id">xs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sub</span>' := <span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> <span class="id">xs</span> <span class="id">newlocs</span> <span class="id">sub</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">locs</span>' := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">ty</span>, <span class="id">ck</span>, <span class="id">cx</span>, <span class="id">clx</span>)) =&gt; (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">sub</span>' <span class="id">x</span>, (<span class="id">ty</span>, (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_clock">rename_clock</a></span> <span class="id">sub</span>' <span class="id">ck</span>), <span class="id">cx</span>, <span class="id">clx</span>))) <span class="id">locs</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> (<span class="id">locs1</span>, <span class="id">blks</span>') &lt;- <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2">mmap2</a></span> (<span class="id">inlinelocal_block</span> <span class="id">sub</span>') <span class="id">blks</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret">ret</a></span> (<span class="id">locs</span>'++<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">locs1</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">blks</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt;  <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.ret">ret</a></span> ([], [<span class="id">blk</span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<h2> Wellformedness properties </h2>
<br/>
<h3> VarsDefinedComp </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html">Permutation</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.mmap_vars_perm">mmap_vars_perm</a></span> : <span class="kwd">forall</span> (<span class="id">f</span> : <span class="id">_</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block">block</a></span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.decl">decl</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block">block</a></span>)) <span class="id">blks</span> <span class="id">sub</span> <span class="id">locs</span>' <span class="id">blks</span>' <span class="id">xs</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">blk</span> =&gt; <span class="kwd">forall</span> <span class="id">sub</span> <span class="id">locs</span>' <span class="id">blks</span>' <span class="id">xs</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.noswitch_block">noswitch_block</a></span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.VarsDefinedComp">VarsDefinedComp</a></span> <span class="id">blk</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals">NoDupLocals</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">sub</span>) ++ <span class="id">xs</span>) <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">sub</span> <span class="id">blk</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">ys</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.VarsDefinedComp">VarsDefinedComp</a></span> <span class="id">blks</span>' <span class="id">ys</span> /\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">ys</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">sub</span>) <span class="id">xs</span> ++ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span>')) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.noswitch_block">noswitch_block</a></span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.VarsDefinedComp">VarsDefinedComp</a></span> <span class="id">blks</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals">NoDupLocals</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">sub</span>) ++ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">xs</span>)) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2">mmap2</a></span> (<span class="id">f</span> <span class="id">sub</span>) <span class="id">blks</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">ys</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.VarsDefinedComp">VarsDefinedComp</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">blks</span>') <span class="id">ys</span> /\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">ys</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">sub</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">xs</span>) ++ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">locs</span>')).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blks</span>; <span class="id">intros</span> * <span class="id">Hf</span> <span class="id">Hns</span> <span class="id">Hvars</span> <span class="id">Hnd</span> <span class="id">Hnorm</span>; <span class="id">inv</span> <span class="id">Hf</span>; <span class="id">inv</span> <span class="id">Hns</span>; <span class="id">inv</span> <span class="id">Hvars</span>; <span class="id">inv</span> <span class="id">Hnd</span>; <span class="id">repeat</span> <span class="id">monadInv</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="kwd">exists</span> []. <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">ys1</span>&amp;<span class="id">Hvars1</span>&amp;<span class="id">Hperm1</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>; [|<span class="id">eauto</span>]; <span class="id">solve_incl_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHblks</span> <span class="kwd">in</span> <span class="id">H2</span> <span class="kwd">as</span> (<span class="id">ys2</span>&amp;<span class="id">Hvars2</span>&amp;<span class="id">Hperm2</span>); <span class="id">eauto</span>. <span class="id">clear</span> <span class="id">IHblks</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">simpl_Forall</span>; <span class="id">intros</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>; [|<span class="id">eauto</span>]; <span class="id">solve_incl_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">ys1</span> ++ <span class="id">ys2</span>). <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_app">Forall2_app</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat_app">concat_app</a></span>, <span class="id">Hperm1</span>, <span class="id">Hperm2</span>. <span class="id">solve_Permutation_app</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.inlinelocal_block_vars_perm">inlinelocal_block_vars_perm</a></span> : <span class="kwd">forall</span> <span class="id">blk</span> <span class="id">sub</span> <span class="id">locs</span>' <span class="id">blks</span>' <span class="id">xs</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.noswitch_block">noswitch_block</a></span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.VarsDefinedComp">VarsDefinedComp</a></span> <span class="id">blk</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals">NoDupLocals</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">sub</span>) ++ <span class="id">xs</span>) <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">sub</span> <span class="id">blk</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">ys</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.VarsDefinedComp">VarsDefinedComp</a></span> <span class="id">blks</span>' <span class="id">ys</span> /\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">ys</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">sub</span>) <span class="id">xs</span> ++ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span>').<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">Hns</span> <span class="id">Hvars</span> <span class="id">Hnd</span> <span class="id">Hdl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hns</span>; <span class="id">inv</span> <span class="id">Hvars</span>; <span class="id">inv</span> <span class="id">Hnd</span>; <span class="id">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;equation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">esplit</span>; <span class="id">simpl</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.VarsDefinedComp">VarsDefinedComp</a></span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;last&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">repeat</span> (<span class="id">econstructor</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_vars_perm">mmap_vars_perm</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">ys1</span>&amp;<span class="id">Hvars1</span>&amp;<span class="id">Hperm1</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.VarsDefinedComp">VarsDefinedComp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_scope</span>. <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">rename</span> <span class="id">it</span> <span class="id">into</span> <span class="id">Hperm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2">mmap2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_vars_perm">mmap_vars_perm</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (<span class="id">ys1</span>&amp;<span class="id">Hvars1</span>&amp;<span class="id">Hperm1</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>, <span class="id">Hperm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_app">incl_app</a></span>; <span class="id">try</span> <span class="id">solve</span> [<span class="id">solve_incl_app</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ? <span class="id">Hin</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Environment.html#Env.elements_complete">Env.elements_complete</a></span>, <span class="id">Env.find_adds</span>'<span class="id">_In</span> <span class="kwd">in</span> <span class="id">Hin0</span> <span class="kwd">as</span> [<span class="id">Hfind</span>|<span class="id">Hfind</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_combine_l">in_combine_l</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Environment.html#Env.elements_correct">Env.elements_correct</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#or_introl">or_introl</a></span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hperm</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> <span class="id">Hperm1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">eauto</span>. <span class="id">rewrite</span> <span class="id">Hperm1</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.not_in_union_map_rename2">not_in_union_map_rename2</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span> <span class="kwd">with</span> (<span class="id">l</span>:=<span class="id">locs</span>). <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.decl">decl</a></span>. <span class="id">intros</span>; <span class="id">destruct_conjs</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>. <span class="id">intros</span> <span class="id">In</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> <span class="id">In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H11</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h3> LastsDefined </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.mmap_lasts_perm">mmap_lasts_perm</a></span> : <span class="kwd">forall</span> (<span class="id">f</span> : <span class="id">_</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block">block</a></span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.Reuse">Reuse</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.decl">decl</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block">block</a></span>)) <span class="id">blks</span> <span class="id">sub</span> <span class="id">locs</span>' <span class="id">blks</span>' <span class="id">xs</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">blk</span> =&gt; <span class="kwd">forall</span> <span class="id">sub</span> <span class="id">locs</span>' <span class="id">blks</span>' <span class="id">xs</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.noswitch_block">noswitch_block</a></span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.LastsDefined">LastsDefined</a></span> <span class="id">blk</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals">NoDupLocals</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">sub</span>) ++ <span class="id">xs</span>) <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">sub</span> <span class="id">blk</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">ys</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.LastsDefined">LastsDefined</a></span> <span class="id">blks</span>' <span class="id">ys</span> /\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">ys</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">sub</span>) <span class="id">xs</span> ++ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.lasts_of_decls">lasts_of_decls</a></span> <span class="id">locs</span>')) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.noswitch_block">noswitch_block</a></span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.LastsDefined">LastsDefined</a></span> <span class="id">blks</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals">NoDupLocals</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">sub</span>) ++ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">xs</span>)) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2">mmap2</a></span> (<span class="id">f</span> <span class="id">sub</span>) <span class="id">blks</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">ys</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.LastsDefined">LastsDefined</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">blks</span>') <span class="id">ys</span> /\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">ys</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">sub</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">xs</span>) ++ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.lasts_of_decls">lasts_of_decls</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">locs</span>')).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blks</span>; <span class="id">intros</span> * <span class="id">Hf</span> <span class="id">Hns</span> <span class="id">Hlasts</span> <span class="id">Hnd</span> <span class="id">Hnorm</span>; <span class="id">inv</span> <span class="id">Hf</span>; <span class="id">inv</span> <span class="id">Hns</span>; <span class="id">inv</span> <span class="id">Hlasts</span>; <span class="id">inv</span> <span class="id">Hnd</span>; <span class="id">repeat</span> <span class="id">monadInv</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="kwd">exists</span> []. <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">ys1</span>&amp;<span class="id">Hlasts1</span>&amp;<span class="id">Hperm1</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>; [|<span class="id">eauto</span>]; <span class="id">solve_incl_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHblks</span> <span class="kwd">in</span> <span class="id">H2</span> <span class="kwd">as</span> (<span class="id">ys2</span>&amp;<span class="id">Hlasts2</span>&amp;<span class="id">Hperm2</span>); <span class="id">eauto</span>. <span class="id">clear</span> <span class="id">IHblks</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">simpl_Forall</span>; <span class="id">intros</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>; [|<span class="id">eauto</span>]; <span class="id">solve_incl_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">ys1</span> ++ <span class="id">ys2</span>). <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_app">Forall2_app</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat_app">concat_app</a></span>, <span class="id">Hperm1</span>, <span class="id">Hperm2</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.lasts_of_decls">lasts_of_decls</a></span>. <span class="id">solve_Permutation_app</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.inlinelocal_block_lasts_perm">inlinelocal_block_lasts_perm</a></span> : <span class="kwd">forall</span> <span class="id">blk</span> <span class="id">sub</span> <span class="id">locs</span>' <span class="id">blks</span>' <span class="id">xs</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.noswitch_block">noswitch_block</a></span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.LastsDefined">LastsDefined</a></span> <span class="id">blk</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals">NoDupLocals</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Environment.html#Env.elements">Env.elements</a></span> <span class="id">sub</span>) ++ <span class="id">xs</span>) <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">sub</span> <span class="id">blk</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">ys</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.LastsDefined">LastsDefined</a></span> <span class="id">blks</span>' <span class="id">ys</span> /\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">ys</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> <span class="id">sub</span>) <span class="id">xs</span> ++ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.lasts_of_decls">lasts_of_decls</a></span> <span class="id">locs</span>').<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">Hns</span> <span class="id">Hlasts</span> <span class="id">Hnd</span> <span class="id">Hdl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hns</span>; <span class="id">inv</span> <span class="id">Hlasts</span>; <span class="id">inv</span> <span class="id">Hnd</span>; <span class="id">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;equation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">esplit</span>; <span class="id">simpl</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.LastsDefined">LastsDefined</a></span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;last&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> (<span class="id">econstructor</span>; <span class="id">eauto</span>); <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_lasts_perm">mmap_lasts_perm</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">ys1</span>&amp;<span class="id">Hlasts1</span>&amp;<span class="id">Hperm1</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.LastsDefined">LastsDefined</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_scope</span>. <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">rename</span> <span class="id">it</span> <span class="id">into</span> <span class="id">Hperm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2">mmap2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_lasts_perm">mmap_lasts_perm</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (<span class="id">ys1</span>&amp;<span class="id">Hlasts1</span>&amp;<span class="id">Hperm1</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>, <span class="id">Hperm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_app">incl_app</a></span>; <span class="id">try</span> <span class="id">solve</span> [<span class="id">solve_incl_app</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ? <span class="id">Hin</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Environment.html#Env.elements_complete">Env.elements_complete</a></span>, <span class="id">Env.find_adds</span>'<span class="id">_In</span> <span class="kwd">in</span> <span class="id">Hin0</span> <span class="kwd">as</span> [<span class="id">Hfind</span>|<span class="id">Hfind</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_combine_l">in_combine_l</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Environment.html#Env.elements_correct">Env.elements_correct</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#or_introl">or_introl</a></span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_appr">incl_appr</a></span>, <span class="id">incl_appr</span>', <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.lasts_of_decls_incl">lasts_of_decls_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">eauto</span>. <span class="id">rewrite</span> <span class="id">Hperm1</span>, <span class="id">Hperm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.lasts_of_decls">lasts_of_decls</a></span>. <span class="id">rewrite</span> ? <span class="id"><a href="Velus.Common.CommonList.html#map_filter_app">map_filter_app</a></span>, ? <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, &lt;- ? <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.not_in_union_map_rename2">not_in_union_map_rename2</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#map_map_filter">map_map_filter</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#map_filter_map">map_filter_map</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#map_filter_ext">map_filter_ext</a></span> <span class="kwd">with</span> (<span class="id">xs</span>:=<span class="id">locs</span>). <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.decl">decl</a></span>. <span class="id">intros</span>; <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">o</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>. <span class="id">intros</span> <span class="id">In</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> <span class="id">In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H11</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h3> st_valid </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.reuse_ident_st_valid">reuse_ident_st_valid</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="id">x</span> <span class="id">st</span> = (<span class="id">y</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">At</span> <span class="id">Reu</span> <span class="id">V</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">EQ</span>; <span class="id">inv_equalities</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonPS.html#PS_For_all_add">PS_For_all_add</a></span>. <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="INLINELOCAL.reuse_idents_st_valid">reuse_idents_st_valid</a></span> : <span class="kwd">forall</span> <span class="id">locs</span> <span class="id">locs</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span>) <span class="id">locs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="id">locs</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">At</span> <span class="id">Map</span> <span class="id">V</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_st_valid">mmap_st_valid</a></span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_valid">reuse_ident_st_valid</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.inlinelocal_block_st_valid">inlinelocal_block_st_valid</a></span> : <span class="kwd">forall</span> <span class="id">blk</span> <span class="id">sub</span> <span class="id">locs</span>' <span class="id">blks</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.GoodLocals">GoodLocals</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">sub</span> <span class="id">blk</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">Good</span> <span class="id">Il</span> <span class="id">V</span>; <span class="id">inv</span> <span class="id">Good</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">monadInv</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_st_valid">mmap2_st_valid</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_st_valid">mmap2_st_valid</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_idents_st_valid">reuse_idents_st_valid</a></span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h3> st_follows </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.reuse_ident_st_follows">reuse_ident_st_follows</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="id">x</span> <span class="id">st</span> = (<span class="id">y</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Reu</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">EQ</span>; <span class="id">inv_equalities</span>; <span class="id">split</span>; <span class="id">try</span> <span class="id">reflexivity</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.fresh_ident_st_follows">fresh_ident_st_follows</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> ??; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.Common.html#PSF.add_2">PSF.add_2</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.inlinelocal_block_st_follows">inlinelocal_block_st_follows</a></span> : <span class="kwd">forall</span> <span class="id">blk</span> <span class="id">sub</span> <span class="id">locs</span>' <span class="id">blks</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">sub</span> <span class="id">blk</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">Il</span>; <span class="id">repeat</span> <span class="id">monadInv</span>; <span class="id">try</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_st_follows">mmap2_st_follows</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_st_follows">mmap_st_follows</a></span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_follows">reuse_ident_st_follows</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_st_follows">mmap2_st_follows</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h3> GoodLocals </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.inlinelocal_block_GoodLocals">inlinelocal_block_GoodLocals</a></span> : <span class="kwd">forall</span> <span class="id">blk</span> <span class="id">sub</span> <span class="id">blks</span>' <span class="id">locs</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.noswitch_block">noswitch_block</a></span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">sub</span> <span class="id">blk</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.GoodLocals">GoodLocals</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.local_prefs">local_prefs</a></span>) <span class="id">blks</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">Hns</span> <span class="id">Hdl</span>; <span class="id">inv</span> <span class="id">Hns</span>; <span class="id">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;equation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;last&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_concat">Forall_concat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_values">mmap2_values</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall3_ignore12">Forall3_ignore12</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_concat">Forall_concat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_values">mmap2_values</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall3_ignore12">Forall3_ignore12</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.reuse_idents_find">reuse_idents_find</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> (<span class="id">locs</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id">A</span>)) <span class="id">locs</span>' <span class="id">st</span> <span class="id">st</span>' <span class="id">sub</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">locs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span>) <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">locs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="id">x</span> <span class="id">st</span> = (<span class="id">y</span>, <span class="id">st</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span>) <span class="id">locs</span>' <span class="id">sub</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">ND</span> <span class="id">Reuse</span> <span class="id">In</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> <span class="id">In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_values">mmap_values</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall2">Forall2_forall2</a></span> <span class="kwd">in</span> <span class="id">Reuse</span> <span class="kwd">as</span> (<span class="id">Len</span>&amp;<span class="id">Nth</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In_nth">In_nth</a></span> <span class="kwd">with</span> (<span class="id">d</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span>) <span class="kwd">in</span> <span class="id">In</span> <span class="kwd">as</span> (?&amp;<span class="id">N</span>&amp;<span class="id">NthLocs</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.In_find_adds">Env.In_find_adds</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">erewrite</span> &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine_nth">combine_nth</a></span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_In">nth_In</a></span> <span class="kwd">with</span> (<span class="id">d</span>:=(<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span>)). <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine_length">combine_length</a></span>, &lt;-<span class="id">Len</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.min_id">Nat.min_id</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Nth</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">N</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>) <span class="kwd">as</span> (?&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.reuse_idents_find_follows">reuse_idents_find_follows</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> (<span class="id">locs</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id">A</span>)) <span class="id">locs</span>' <span class="id">st</span> <span class="id">st</span>' <span class="id">x</span> <span class="id">sub</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">locs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span>) <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">locs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">st1</span> <span class="id">st1</span>' <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st1</span>' <span class="id">st</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="id">x</span> <span class="id">st1</span> = (<span class="id">y</span>, <span class="id">st1</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span>) <span class="id">locs</span>' <span class="id">sub</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">ND</span> <span class="id">Reuse</span> <span class="id">In</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> <span class="id">In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_values_follows">mmap_values_follows</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall2">Forall2_forall2</a></span> <span class="kwd">in</span> <span class="id">Reuse</span> <span class="kwd">as</span> (<span class="id">Len</span>&amp;<span class="id">Nth</span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_follows">reuse_ident_st_follows</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In_nth">In_nth</a></span> <span class="kwd">with</span> (<span class="id">d</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span>) <span class="kwd">in</span> <span class="id">In</span> <span class="kwd">as</span> (?&amp;<span class="id">N</span>&amp;<span class="id">NthLocs</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.In_find_adds">Env.In_find_adds</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">erewrite</span> &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine_nth">combine_nth</a></span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_In">nth_In</a></span> <span class="kwd">with</span> (<span class="id">d</span>:=(<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span>)). <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine_length">combine_length</a></span>, &lt;-<span class="id">Len</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.min_id">Nat.min_id</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Nth</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">N</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>) <span class="kwd">as</span> (?&amp;?&amp;?&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">reuse_idents_find</span>' {<span class="id">A</span>} : <span class="kwd">forall</span> (<span class="id">locs</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id">A</span>)) <span class="id">locs</span>' <span class="id">st</span> <span class="id">st</span>' <span class="id">x</span> <span class="id">sub</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">locs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span>) <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">locs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">st1</span> <span class="id">st1</span>' <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st</span> <span class="id">st1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows">st_follows</a></span> <span class="id">st1</span>' <span class="id">st</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="id">x</span> <span class="id">st1</span> = (<span class="id">y</span>, <span class="id">st1</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span>) <span class="id">locs</span>' <span class="id">sub</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">ND</span> <span class="id">At</span> <span class="id">Reuse</span> <span class="id">V</span> <span class="id">In</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> <span class="id">In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">mmap_values</span>', <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall2">Forall2_forall2</a></span> <span class="kwd">in</span> <span class="id">Reuse</span> <span class="kwd">as</span> (<span class="id">Len</span>&amp;<span class="id">Nth</span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_follows">reuse_ident_st_follows</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">clear</span> <span class="id">In</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_valid">reuse_ident_st_valid</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In_nth">In_nth</a></span> <span class="kwd">with</span> (<span class="id">d</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span>) <span class="kwd">in</span> <span class="id">In</span> <span class="kwd">as</span> (?&amp;<span class="id">N</span>&amp;<span class="id">NthLocs</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.In_find_adds">Env.In_find_adds</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">erewrite</span> &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine_nth">combine_nth</a></span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_In">nth_In</a></span> <span class="kwd">with</span> (<span class="id">d</span>:=(<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span>)). <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine_length">combine_length</a></span>, &lt;-<span class="id">Len</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.min_id">Nat.min_id</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Nth</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">N</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>) <span class="kwd">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">eauto</span> 6.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.inlinelocal_block_AtomOrGensym">inlinelocal_block_AtomOrGensym</a></span> : <span class="kwd">forall</span> <span class="id">blk</span> Γ <span class="id">sub</span> <span class="id">blks</span>' <span class="id">locs</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals">NoDupLocals</a></span> Γ <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.GoodLocals">GoodLocals</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">sub</span> <span class="id">blk</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.local_prefs">local_prefs</a></span> <span class="id">x</span>) <span class="id">locs</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">ND</span> <span class="id">Good</span> <span class="id">Hdl</span>; <span class="id">inv</span> <span class="id">ND</span>; <span class="id">inv</span> <span class="id">Good</span>; <span class="id">repeat</span> <span class="id">monadInv</span>; <span class="id">try</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_concat">Forall_concat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_values">mmap2_values</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall3_ignore13">Forall3_ignore13</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_idents_find">reuse_idents_find</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp;<span class="id">Reu</span>&amp;<span class="id">Find</span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span>. <span class="id">erewrite</span> <span class="id">Find</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="kwd">in</span> <span class="id">Reu</span>. <span class="id">cases_eqn</span> <span class="id">EQ</span>; <span class="id">inv_equalities</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.fresh_ident_prefixed">fresh_ident_prefixed</a></span> <span class="kwd">in</span> <span class="id">EQ0</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.Common.html#PSF.add_1">PSF.add_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.AtomOrGensym_add">AtomOrGensym_add</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_concat">Forall_concat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_values">mmap2_values</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall3_ignore13">Forall3_ignore13</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h3> NoDupLocals </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.inlinelocal_block_NoDupLocals">inlinelocal_block_NoDupLocals</a></span> <span class="id">xs</span> : <span class="kwd">forall</span> <span class="id">blk</span> <span class="id">sub</span> <span class="id">locs</span>' <span class="id">blks</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.noswitch_block">noswitch_block</a></span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">sub</span> <span class="id">blk</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals">NoDupLocals</a></span> <span class="id">xs</span>) <span class="id">blks</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">Hns</span> <span class="id">Hdl</span>; <span class="id">inv</span> <span class="id">Hns</span>; <span class="id">repeat</span> <span class="id">monadInv</span>; <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_values">mmap2_values</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall3_ignore12">Forall3_ignore12</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_concat">Forall_concat</a></span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="id">eauto</span>. <span class="id">now</span> <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_values">mmap2_values</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall3_ignore12">Forall3_ignore12</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_concat">Forall_concat</a></span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">eauto</span>. <span class="id">now</span> <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.local_not_in_switch_prefs">local_not_in_switch_prefs</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.local">local</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span>, <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.auto_prefs">auto_prefs</a></span>, <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.last_prefs">last_prefs</a></span>, <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.elab_prefs">elab_prefs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> ? <span class="id"><a href="Velus.Common.Common.html#PS.add_spec">PS.add_spec</a></span>, <span class="id"><a href="Velus.Common.Common.html#PSF.singleton_iff">PSF.singleton_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.gensym_prefs_NoDup">gensym_prefs_NoDup</a></span> <span class="kwd">as</span> <span class="id">Hnd</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.gensym_prefs">gensym_prefs</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup_cons_iff">NoDup_cons_iff</a></span> <span class="kwd">in</span> <span class="id">Hnd</span>. <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">Eq</span>. <span class="id">repeat</span> <span class="id">take</span> (<span class="id">_</span> \/ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [<span class="id">Eq</span>|<span class="id">Eq</span>]; <span class="id">eauto</span> 8 <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.reuse_ident_In">reuse_ident_In</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="id">x</span> <span class="id">st</span> = (<span class="id">y</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.used">used</a></span> <span class="id">st</span>').<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Reu</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Reu</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.Common.html#PSF.add_1">PSF.add_1</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="INLINELOCAL.reuse_idents_In">reuse_idents_In</a></span> : <span class="kwd">forall</span> <span class="id">locs</span> <span class="id">locs</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="id">locs</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.used">used</a></span> <span class="id">st</span>')) <span class="id">locs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Reu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_values_follows">mmap_values_follows</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore2">Forall2_ignore2</a></span> <span class="kwd">in</span> <span class="id">Reu</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_follows">reuse_ident_st_follows</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H2</span>, <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_In">reuse_ident_In</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.reuse_ident_st_In">reuse_ident_st_In</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="id">x</span> <span class="id">st</span> = (<span class="id">y</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_In">st_In</a></span> <span class="id">y</span> <span class="id">st</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Reu</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">EQ</span>; <span class="id">inv_equalities</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.fresh_ident_Inids">fresh_ident_Inids</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>. <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.Common.html#PSF.add_1">PSF.add_1</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="INLINELOCAL.reuse_idents_st_In">reuse_idents_st_In</a></span> : <span class="kwd">forall</span> <span class="id">locs</span> <span class="id">locs</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="id">locs</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_In">st_In</a></span> <span class="id">x</span> <span class="id">st</span>') <span class="id">locs</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Reu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_values_follows">mmap_values_follows</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore1">Forall2_ignore1</a></span> <span class="kwd">in</span> <span class="id">Reu</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_follows">reuse_ident_st_follows</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_In">reuse_ident_st_In</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows_In">st_follows_In</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.inlinelocal_block_st_In">inlinelocal_block_st_In</a></span> : <span class="kwd">forall</span> <span class="id">blk</span> Γ <span class="id">sub</span> <span class="id">blks</span>' <span class="id">locs</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals">NoDupLocals</a></span> Γ <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">sub</span> <span class="id">blk</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_In">st_In</a></span> <span class="id">x</span> <span class="id">st</span>') <span class="id">locs</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">ND</span> <span class="id">IL</span>; <span class="id">inv</span> <span class="id">ND</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">monadInv</span>; <span class="id">try</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_values_follows">mmap2_values_follows</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall3_ignore13">Forall3_ignore13</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_st_follows">inlinelocal_block_st_follows</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_concat">Forall_concat</a></span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows_In">st_follows_In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_idents_find_follows">reuse_idents_find_follows</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp;<span class="id">F1</span>&amp;<span class="id">F2</span>&amp;<span class="id">Reu</span>&amp;<span class="id">Find</span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span>. <span class="id">erewrite</span> <span class="id">Find</span>; <span class="id">eauto</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_In">reuse_ident_st_In</a></span> <span class="kwd">in</span> <span class="id">Reu</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows_In">st_follows_In</a></span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="id">eauto</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_st_follows">mmap2_st_follows</a></span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_st_follows">inlinelocal_block_st_follows</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_values_follows">mmap2_values_follows</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall3_ignore13">Forall3_ignore13</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_st_follows">inlinelocal_block_st_follows</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_concat">Forall_concat</a></span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>. <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows_In">st_follows_In</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.reuse_ident_st_nIn">reuse_ident_st_nIn</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="id">x</span> <span class="id">st</span> = (<span class="id">y</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_In">st_In</a></span> <span class="id">y</span> <span class="id">st</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">At1</span> <span class="id">At2</span> <span class="id">Reu</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">EQ</span>; <span class="id">inv_equalities</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> [<span class="id">In</span>|<span class="id">In</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.fresh_ident_nIn">fresh_ident_nIn</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id">At2</span> <span class="kwd">in</span> <span class="id">In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid_AtomOrGensym_nIn">st_valid_AtomOrGensym_nIn</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.local_not_in_switch_prefs">local_not_in_switch_prefs</a></span>, <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.fresh_ident_Inids">fresh_ident_Inids</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#PSE.mem_4">PSE.mem_4</a></span> <span class="kwd">in</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">EQ</span>. <span class="id">destruct</span> <span class="id">EQ</span> <span class="kwd">as</span> [<span class="id">In</span>|<span class="id">In</span>]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid_AtomOrGensym_nIn">st_valid_AtomOrGensym_nIn</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.local_not_in_switch_prefs">local_not_in_switch_prefs</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="INLINELOCAL.reuse_idents_st_nIn">reuse_idents_st_nIn</a></span> : <span class="kwd">forall</span> <span class="id">locs</span> <span class="id">locs</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span>) <span class="id">locs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="id">locs</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; ~<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_In">st_In</a></span> <span class="id">y</span> <span class="id">st</span>) <span class="id">locs</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">F</span> <span class="id">V</span> <span class="id">Map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">mmap_values</span>', <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore1">Forall2_ignore1</a></span> <span class="kwd">in</span> <span class="id">Map</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_follows">reuse_ident_st_follows</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_valid">reuse_ident_st_valid</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_nIn">reuse_ident_st_nIn</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows_In">st_follows_In</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.inlinelocal_block_st_nIn">inlinelocal_block_st_nIn</a></span> : <span class="kwd">forall</span> <span class="id">blk</span> Γ <span class="id">sub</span> <span class="id">blks</span>' <span class="id">locs</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals">NoDupLocals</a></span> Γ <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.GoodLocals">GoodLocals</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">sub</span> <span class="id">blk</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">_</span>) =&gt; ~ (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_In">st_In</a></span> <span class="id">x</span> <span class="id">st</span>)) <span class="id">locs</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">ND</span> <span class="id">Good</span> <span class="id">V</span> <span class="id">IL</span>; <span class="id">inv</span> <span class="id">ND</span>; <span class="id">inv</span> <span class="id">Good</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">monadInv</span>; <span class="id">try</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">mmap2_values</span>', <span class="id"><a href="Velus.Common.CommonList.html#Forall3_ignore13">Forall3_ignore13</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_st_follows">inlinelocal_block_st_follows</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_st_valid">inlinelocal_block_st_valid</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_concat">Forall_concat</a></span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows_In">st_follows_In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>. <span class="id">intros</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">reuse_idents_find</span>' <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp;<span class="id">V1</span>&amp;<span class="id">F1</span>&amp;<span class="id">F2</span>&amp;<span class="id">Reu</span>&amp;<span class="id">Find</span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span>. <span class="id">erewrite</span> <span class="id">Find</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_nIn">reuse_ident_st_nIn</a></span> <span class="kwd">in</span> <span class="id">Reu</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">Reu</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows_In">st_follows_In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id">mmap2_values</span>', <span class="id"><a href="Velus.Common.CommonList.html#Forall3_ignore13">Forall3_ignore13</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_st_follows">inlinelocal_block_st_follows</a></span>, <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_idents_st_valid">reuse_idents_st_valid</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_st_valid">inlinelocal_block_st_valid</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_concat">Forall_concat</a></span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>. <span class="id">contradict</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows_In">st_follows_In</a></span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="id">eauto</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_st_follows">mmap_st_follows</a></span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_follows">reuse_ident_st_follows</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="INLINELOCAL.inlinelocal_blocks_st_nIn">inlinelocal_blocks_st_nIn</a></span> : <span class="kwd">forall</span> <span class="id">blks</span> Γ <span class="id">sub</span> <span class="id">blks</span>' <span class="id">locs</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals">NoDupLocals</a></span> Γ) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.GoodLocals">GoodLocals</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span>) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2">mmap2</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">sub</span>) <span class="id">blks</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">_</span>) =&gt; ~ (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_In">st_In</a></span> <span class="id">x</span> <span class="id">st</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">locs</span>').<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">ND</span> <span class="id">Good</span> <span class="id">V</span> <span class="id">IL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">mmap2_values</span>', <span class="id"><a href="Velus.Common.CommonList.html#Forall3_ignore13">Forall3_ignore13</a></span> <span class="kwd">in</span> <span class="id">IL</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_st_follows">inlinelocal_block_st_follows</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_st_valid">inlinelocal_block_st_valid</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_concat">Forall_concat</a></span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_st_nIn">inlinelocal_block_st_nIn</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_follows_In">st_follows_In</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="INLINELOCAL.inlinelocal_block_nIn">inlinelocal_block_nIn</a></span> : <span class="kwd">forall</span> <span class="id">blk</span> <span class="id">sub</span> <span class="id">xs</span> <span class="id">locs</span>' <span class="id">blks</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#PS.In">PS.In</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.used">used</a></span> <span class="id">st</span>)) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals">NoDupLocals</a></span> <span class="id">xs</span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.GoodLocals">GoodLocals</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">sub</span> <span class="id">blk</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">_</span>) =&gt; ~<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">xs</span>) <span class="id">locs</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</span></div>
<div class="proofscript" id="proof58">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">In</span> <span class="id">ND</span> <span class="id">Good</span> <span class="id">Il</span> <span class="id">V</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_st_nIn">inlinelocal_block_st_nIn</a></span> <span class="kwd">in</span> <span class="id">Il</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="id">contradict</span> <span class="id">Il</span>. <span class="id">simpl_Forall</span>. <span class="id">right</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.mmap_inlinelocal_block_NoDupMembers">mmap_inlinelocal_block_NoDupMembers</a></span> : <span class="kwd">forall</span> <span class="id">blks</span> Γ <span class="id">sub</span> <span class="id">locs</span>' <span class="id">blks</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">blk</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> Γ <span class="id">sub</span> <span class="id">locs</span>' <span class="id">blks</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals">NoDupLocals</a></span> Γ <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.GoodLocals">GoodLocals</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">sub</span> <span class="id">blk</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">locs</span>') <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals">NoDupLocals</a></span> Γ) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.GoodLocals">GoodLocals</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span>) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2">mmap2</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">sub</span>) <span class="id">blks</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">locs</span>').<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof59')">Proof.</span></div>
<div class="proofscript" id="proof59">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blks</span>; <span class="id">intros</span> * <span class="id">F</span> <span class="id">ND</span> <span class="id">Good</span> <span class="id">V</span> <span class="id">IL</span>; <span class="id">inv</span> <span class="id">F</span>; <span class="id">inv</span> <span class="id">ND</span>; <span class="id">inv</span> <span class="id">Good</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">monadInv</span>; <span class="id">simpl</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_app">NoDupMembers_app</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_st_valid">inlinelocal_block_st_valid</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">In1</span> <span class="id">In2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_blocks_st_nIn">inlinelocal_blocks_st_nIn</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_st_valid">inlinelocal_block_st_valid</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_st_In">inlinelocal_block_st_In</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_In</span>. <span class="id">simpl_Forall</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.reuse_idents_rename">reuse_idents_rename</a></span> {<span class="id">A</span>} <span class="id">sub</span> : <span class="kwd">forall</span> (<span class="id">locs</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id">A</span>)) <span class="id">locs</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">locs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span>) <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span> (<span class="id"><a href="Velus.Environment.html#Env.adds">Env.adds</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span>) <span class="id">locs</span>' <span class="id">sub</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span>) = <span class="id">locs</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof60')">Proof.</span></div>
<div class="proofscript" id="proof60">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">ND</span> <span class="id">Map</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_eq">Forall2_eq</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall2">Forall2_forall2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Map</span>':=<span class="id">Map</span>). <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_values">mmap_values</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall2">Forall2_forall2</a></span> <span class="kwd">in</span> <span class="id">Map</span> <span class="kwd">as</span> (<span class="id">Len</span>&amp;<span class="id">F2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>. <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">N</span> <span class="id">Nth1</span> <span class="id">Nth2</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">map_nth</span>' <span class="kwd">with</span> (<span class="id">d</span>':=<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_var">rename_var</a></span>. <span class="id">setoid_rewrite</span> <span class="id">Env.In_find_adds</span>'. <span class="id">simpl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_NoDupMembers_combine">NoDup_NoDupMembers_combine</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine_nth">combine_nth</a></span>; <span class="id">eauto</span>. <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_In">nth_In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine_length">combine_length</a></span>, &lt;-<span class="id">Len</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.min_id">Nat.min_id</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.reuse_idents_NoDup">reuse_idents_NoDup</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> (<span class="id">locs</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id">A</span>)) <span class="id">locs</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span>) <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> <span class="id">locs</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof61')">Proof.</span></div>
<div class="proofscript" id="proof61">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">locs</span>; <span class="id">intros</span> * <span class="id">At</span> <span class="id">V</span> <span class="id">Reu</span>; <span class="id">inv</span> <span class="id">At</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">monadInv</span>; <span class="id">constructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_valid">reuse_ident_st_valid</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> <span class="id">In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_In">reuse_ident_st_In</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">StIn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_idents_st_nIn">reuse_idents_st_nIn</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> <span class="id">StIns</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_st_valid">reuse_ident_st_valid</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.inlinelocal_block_NoDupMembers">inlinelocal_block_NoDupMembers</a></span> : <span class="kwd">forall</span> <span class="id">blk</span> Γ <span class="id">sub</span> <span class="id">locs</span>' <span class="id">blks</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals">NoDupLocals</a></span> Γ <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.GoodLocals">GoodLocals</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.st_valid">st_valid</a></span> <span class="id">st</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">sub</span> <span class="id">blk</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">locs</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof62')">Proof.</span></div>
<div class="proofscript" id="proof62">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">ND</span> <span class="id">Good</span> <span class="id">V</span> <span class="id">IL</span>; <span class="id">inv</span> <span class="id">ND</span>; <span class="id">inv</span> <span class="id">Good</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">monadInv</span>; <span class="id">try</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_inlinelocal_block_NoDupMembers">mmap_inlinelocal_block_NoDupMembers</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_app">NoDupMembers_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>, &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_idents_rename">reuse_idents_rename</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">intros</span>; <span class="id">destruct_conjs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_idents_NoDup">reuse_idents_NoDup</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_inlinelocal_block_NoDupMembers">mmap_inlinelocal_block_NoDupMembers</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_idents_st_valid">reuse_idents_st_valid</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> * <span class="id">In1</span> <span class="id">In2</span>. <span class="id">erewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>, &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_idents_rename">reuse_idents_rename</a></span> <span class="kwd">in</span> <span class="id">In1</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">intros</span>; <span class="id">destruct_conjs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_blocks_st_nIn">inlinelocal_blocks_st_nIn</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_idents_st_valid">reuse_idents_st_valid</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_idents_st_In">reuse_idents_st_In</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_In</span>. <span class="id">simpl_Forall</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h3> No local block </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.inlinelocal_block_nolocal">inlinelocal_block_nolocal</a></span> : <span class="kwd">forall</span> <span class="id">blk</span> <span class="id">sub</span> <span class="id">locs</span>' <span class="id">blks</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.noswitch_block">noswitch_block</a></span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">sub</span> <span class="id">blk</span> <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">blks</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.nolocal_block">nolocal_block</a></span> <span class="id">blks</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof63')">Proof.</span></div>
<div class="proofscript" id="proof63">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">Hns</span> <span class="id">Hdl</span>; <span class="id">inv</span> <span class="id">Hns</span>; <span class="id">repeat</span> <span class="id">monadInv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;equation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;last&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_values">mmap2_values</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall3_ignore12">Forall3_ignore12</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_concat">Forall_concat</a></span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="id">eauto</span>. <span class="id">now</span> <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap2_values">mmap2_values</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall3_ignore12">Forall3_ignore12</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_concat">Forall_concat</a></span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">eauto</span>. <span class="id">now</span> <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> Transformation of node and program </h2>
<br/>
&nbsp;&nbsp;<span class="id">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="INLINELOCAL.inlinelocal_node">inlinelocal_node</a></span> (<span class="id">n</span>: @<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.node">node</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.noswitch">noswitch</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span>) : @<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.node">node</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.nolocal">nolocal</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.local_prefs">local_prefs</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">res</span> := <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> (<span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_block">n_block</a></span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.fresh_st">fresh_st</a></span> := <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.init_st">init_st</a></span>; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.used">used</a></span> := <span class="id"><a href="Velus.Common.Common.html#PSP.of_list">PSP.of_list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) |} <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_name">n_name</a></span> := (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_name">n_name</a></span> <span class="id">n</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_hasstate">n_hasstate</a></span> := (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_hasstate">n_hasstate</a></span> <span class="id">n</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_in">n_in</a></span> := (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_in">n_in</a></span> <span class="id">n</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_out">n_out</a></span> := (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_out">n_out</a></span> <span class="id">n</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_block">n_block</a></span> := <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Blocal">Blocal</a></span> (<span class="kwd">Scope</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">res</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">res</span>)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_ingt0">n_ingt0</a></span> := (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_ingt0">n_ingt0</a></span> <span class="id">n</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_outgt0">n_outgt0</a></span> := (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_outgt0">n_outgt0</a></span> <span class="id">n</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof64')">Next Obligation.</span></div>
<div class="proofscript" id="proof64">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_syn">n_syn</a></span> <span class="id">n</span>) <span class="kwd">as</span> <span class="id">Hns</span>. <span class="id">inversion_clear</span> <span class="id">Hns</span> <span class="kwd">as</span> [?? <span class="id">Hns1</span> (?&amp;<span class="id">Hvars</span>&amp;<span class="id">Hperm</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_nodup">n_nodup</a></span> <span class="id">n</span>) <span class="kwd">as</span> (<span class="id">_</span>&amp;<span class="id">Hndup</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_map_inv">Permutation_map_inv</a></span> <span class="kwd">in</span> <span class="id">Hperm</span> <span class="kwd">as</span> (?&amp;?&amp;<span class="id">Hperm</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">esplit</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">as</span> ((?&amp;?)&amp;?) <span class="id">eqn</span>:<span class="id">Hdl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_vars_perm">inlinelocal_block_vars_perm</a></span> <span class="kwd">in</span> <span class="id">Hvars</span> <span class="kwd">as</span> (?&amp;?&amp;<span class="id">Hperm</span>'); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_vars_empty">rename_vars_empty</a></span> <span class="kwd">in</span> <span class="id">Hperm</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.elements_empty">Env.Props.P.elements_empty</a></span>, &lt;-<span class="id">Hperm</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>; [|<span class="id">eauto</span>]. <span class="id">solve_incl_app</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.noswitch_VarsDefinedComp_VarsDefined">noswitch_VarsDefinedComp_VarsDefined</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="id">constructor</span>. <span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_nolocal">inlinelocal_block_nolocal</a></span> <span class="kwd">in</span> <span class="id">Hdl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.nolocal_noswitch">nolocal_noswitch</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 4 <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hperm</span>', &lt;-<span class="id">Hperm</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof65')">Next Obligation.</span></div>
<div class="proofscript" id="proof65">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_syn">n_syn</a></span> <span class="id">n</span>) <span class="kwd">as</span> <span class="id">Hsyn</span>. <span class="id">inversion_clear</span> <span class="id">Hsyn</span> <span class="kwd">as</span> [?? <span class="id">Hns1</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_lastd">n_lastd</a></span> <span class="id">n</span>) <span class="kwd">as</span> (?&amp;<span class="id">Last</span>&amp;<span class="id">Perm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_nodup">n_nodup</a></span> <span class="id">n</span>) <span class="kwd">as</span> (<span class="id">_</span>&amp;<span class="id">Hndup</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">esplit</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">as</span> ((?&amp;?)&amp;?) <span class="id">eqn</span>:<span class="id">Hdl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_lasts_perm">inlinelocal_block_lasts_perm</a></span> <span class="kwd">in</span> <span class="id">Hdl</span> <span class="kwd">as</span> (?&amp;?&amp;<span class="id">Hperm</span>'); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_vars_empty">rename_vars_empty</a></span> <span class="kwd">in</span> <span class="id">Hperm</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.elements_empty">Env.Props.P.elements_empty</a></span>; <span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id">Perm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>; [|<span class="id">eauto</span>]. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_appr">incl_appr</a></span>, <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.lasts_of_decls_incl">lasts_of_decls_incl</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">constructor</span>. <span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof66')">Next Obligation.</span></div>
<div class="proofscript" id="proof66">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_good">n_good</a></span> <span class="id">n</span>) <span class="kwd">as</span> (<span class="id">Hgood1</span>&amp;<span class="id">Hgood2</span>&amp;<span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_nodup">n_nodup</a></span> <span class="id">n</span>) <span class="kwd">as</span> (<span class="id">Hnd1</span>&amp;<span class="id">Hnd2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_syn">n_syn</a></span> <span class="id">n</span>) <span class="kwd">as</span> <span class="id">Hsyn</span>. <span class="id">inversion_clear</span> <span class="id">Hsyn</span> <span class="kwd">as</span> [?? <span class="id">Hns1</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">as</span> ((?&amp;?)&amp;<span class="id">st</span>') <span class="id">eqn</span>:<span class="id">Hdl</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">auto</span>. <span class="id">do</span> 2 <span class="id">constructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_NoDupLocals">inlinelocal_block_NoDupLocals</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_NoDupMembers">inlinelocal_block_NoDupMembers</a></span> <span class="kwd">in</span> <span class="id">Hdl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ? <span class="id">In</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#In_of_list">In_of_list</a></span> <span class="kwd">in</span> <span class="id">In</span>. <span class="id">now</span> <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">In1</span> <span class="id">In2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_nIn">inlinelocal_block_nIn</a></span> <span class="kwd">in</span> <span class="id">Hdl</span>. 3-5:<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">simpl_Forall</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#In_of_list">In_of_list</a></span>. <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">intros</span> ? <span class="id">In</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#In_of_list">In_of_list</a></span> <span class="kwd">in</span> <span class="id">In</span>. <span class="id">now</span> <span class="id">simpl_Forall</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_In</span>. <span class="id">simpl_Forall</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof67')">Next Obligation.</span></div>
<div class="proofscript" id="proof67">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_good">n_good</a></span> <span class="id">n</span>) <span class="kwd">as</span> (<span class="id">Hgood1</span>&amp;<span class="id">Hgood2</span>&amp;<span class="id">Hatom</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_nodup">n_nodup</a></span> <span class="id">n</span>) <span class="kwd">as</span> (<span class="id">Hnd1</span>&amp;<span class="id">Hnd2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">as</span> ((?&amp;?)&amp;?) <span class="id">eqn</span>:<span class="id">Hdl</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_syn">n_syn</a></span> <span class="id">n</span>) <span class="kwd">as</span> <span class="id">Hsyn</span>. <span class="id">inversion_clear</span> <span class="id">Hsyn</span> <span class="kwd">as</span> [?? <span class="id">Hns1</span> <span class="id">Hns2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">split</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Forall_AtomOrGensym_add">Forall_AtomOrGensym_add</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_AtomOrGensym">inlinelocal_block_AtomOrGensym</a></span> <span class="kwd">in</span> <span class="id">Hdl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_GoodLocals">inlinelocal_block_GoodLocals</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof68')">Next Obligation.</span></div>
<div class="proofscript" id="proof68">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_syn">n_syn</a></span> <span class="id">n</span>) <span class="kwd">as</span> <span class="id">Hsyn</span>. <span class="id">inversion_clear</span> <span class="id">Hsyn</span> <span class="kwd">as</span> [?? <span class="id">Hns1</span> (?&amp;<span class="id">Hvars</span>&amp;<span class="id">Hperm</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.n_nodup">n_nodup</a></span> <span class="id">n</span>) <span class="kwd">as</span> (<span class="id">_</span>&amp;<span class="id">Hndup</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block">inlinelocal_block</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">as</span> ((?&amp;?)&amp;?) <span class="id">eqn</span>:<span class="id">Hdl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_nolocal">inlinelocal_block_nolocal</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_block_vars_perm">inlinelocal_block_vars_perm</a></span> <span class="kwd">in</span> <span class="id">Hvars</span> <span class="kwd">as</span> (?&amp;?&amp;<span class="id">Hperm</span>'); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.rename_vars_empty">rename_vars_empty</a></span> <span class="kwd">in</span> <span class="id">Hperm</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.elements_empty">Env.Props.P.elements_empty</a></span>, <span class="id">Hperm</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>; [|<span class="id">eauto</span>]. <span class="id">solve_incl_app</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">econstructor</span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 4 <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="id">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="INLINELOCAL.inlinelocal_node_transform_unit">inlinelocal_node_transform_unit</a></span>: <span class="id"><a href="Velus.Common.CommonProgram.html#TransformUnit">TransformUnit</a></span> (@<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.node">node</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.noswitch">noswitch</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span>) <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.node">node</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id"><a href="Velus.Common.CommonProgram.html#transform_unit">transform_unit</a></span> := <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_node">inlinelocal_node</a></span> }.<br/>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="id">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="INLINELOCAL.inlinelocal_global_without_units">inlinelocal_global_without_units</a></span> : <span class="id"><a href="Velus.Common.CommonProgram.html#TransformProgramWithoutUnits">TransformProgramWithoutUnits</a></span> (@<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.noswitch">noswitch</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span>) (@<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.nolocal">nolocal</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.local_prefs">local_prefs</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id"><a href="Velus.Common.CommonProgram.html#transform_program_without_units">transform_program_without_units</a></span> := <span class="kwd">fun</span> <span class="id">g</span> =&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.Global">Global</a></span> <span class="id">g</span>.(<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.types">types</a></span>) <span class="id">g</span>.(<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.externs">externs</a></span>) [] }.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="INLINELOCAL.inlinelocal_global">inlinelocal_global</a></span> : @<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.noswitch">noswitch</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.switch_prefs">switch_prefs</a></span> -&gt; @<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.nolocal">nolocal</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.local_prefs">local_prefs</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonProgram.html#transform_units">transform_units</a></span>.<br/>
<br/>
<h3> Equality of interfaces </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.inlinelocal_global_iface_eq">inlinelocal_global_iface_eq</a></span> : <span class="kwd">forall</span> <span class="id">G</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.global_iface_eq">global_iface_eq</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_global">inlinelocal_global</a></span> <span class="id">G</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</span></div>
<div class="proofscript" id="proof69">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">f</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.find_node">find_node</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Common.CommonProgram.html#find_unit">find_unit</a></span> <span class="id">f</span> <span class="id">G</span>) <span class="kwd">as</span> [(?&amp;?)|] <span class="id">eqn</span>:<span class="id">Hfind</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonProgram.html#find_unit_transform_units_forward">find_unit_transform_units_forward</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id"><a href="Velus.Common.CommonProgram.html#find_unit">find_unit</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.inlinelocal_global">inlinelocal_global</a></span> <span class="id">G</span>)) <span class="kwd">as</span> [(?&amp;?)|] <span class="id">eqn</span>:<span class="id">Hfind</span>'; <span class="id">simpl</span>; <span class="id">try</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonProgram.html#find_unit_transform_units_backward">find_unit_transform_units_backward</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>' <span class="kwd">as</span> (?&amp;?&amp;?&amp;?); <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="INLINELOCAL.senv_of_anns">senv_of_anns</a></span> (<span class="id">locs</span>' : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn.ann">ann</a></span>)) : <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.static_env">static_env</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">ty</span>, <span class="id">ck</span>)) =&gt; (<span class="id">x</span>, (<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.Build_annotation">Build_annotation</a></span> <span class="id">ty</span> <span class="id">ck</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>))) <span class="id">locs</span>'.<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.senv_of_anns">senv_of_anns</a></span> : <span class="id">list</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.senv_of_anns_app">senv_of_anns_app</a></span> : <span class="kwd">forall</span> <span class="id">locs1</span> <span class="id">locs2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.senv_of_anns">senv_of_anns</a></span> (<span class="id">locs1</span> ++ <span class="id">locs2</span>) = <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.senv_of_anns">senv_of_anns</a></span> <span class="id">locs1</span> ++ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.senv_of_anns">senv_of_anns</a></span> <span class="id">locs2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof70')">Proof.</span></div>
<div class="proofscript" id="proof70">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.senv_of_anns_concat_incl">senv_of_anns_concat_incl</a></span> Γ : <span class="kwd">forall</span> <span class="id">locs</span> <span class="id">locs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">locs</span> <span class="id">locs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (Γ ++ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.senv_of_anns">senv_of_anns</a></span> <span class="id">locs</span>) (Γ ++ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.senv_of_anns">senv_of_anns</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">locs</span>')).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</span></div>
<div class="proofscript" id="proof71">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id">incl_appr</span>', <span class="id"><a href="Velus.Common.CommonList.html#incl_map">incl_map</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#incl_concat">incl_concat</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">senv_of_anns_concat_incl</span> : <span class="id">senv</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.senv_of_decls_concat_incl">senv_of_decls_concat_incl</a></span> Γ : <span class="kwd">forall</span> <span class="id">locs</span> <span class="id">locs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">locs</span> <span class="id">locs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (Γ ++ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">locs</span>) (Γ ++ <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">locs</span>')).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof72')">Proof.</span></div>
<div class="proofscript" id="proof72">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id">incl_appr</span>', <span class="id"><a href="Velus.Common.CommonList.html#incl_map">incl_map</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#incl_concat">incl_concat</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">senv_of_decls_concat_incl</span> : <span class="id">senv</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.reuse_ident_gensym">reuse_ident_gensym</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="id">x</span> <span class="id">st</span> = (<span class="id">y</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">y</span> = <span class="id">x</span> \/ <span class="kwd">exists</span> <span class="id">n</span> <span class="id">hint</span>, <span class="id">y</span> = <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.gensym">gensym</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.local">local</a></span> <span class="id">hint</span> <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</span></div>
<div class="proofscript" id="proof73">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Reu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> <span class="kwd">in</span> *. <span class="id">cases_eqn</span> <span class="id">EQ</span>; <span class="id">inv_equalities</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.fresh_ident_prefixed">Fresh.Ker.fresh_ident_prefixed</a></span> <span class="kwd">in</span> <span class="id">EQ0</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="INLINELOCAL.reuse_idents_gensym">reuse_idents_gensym</a></span> {<span class="id">A</span>} : <span class="kwd">forall</span> (<span class="id">locs</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id">A</span>)) <span class="id">locs</span>' <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap">mmap</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident">reuse_ident</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">locs</span>) <span class="id">st</span> = (<span class="id">locs</span>', <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">locs</span> \/ <span class="kwd">exists</span> <span class="id">n</span> <span class="id">hint</span>, <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.gensym">gensym</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids.local">local</a></span> <span class="id">hint</span> <span class="id">n</span>) <span class="id">locs</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</span></div>
<div class="proofscript" id="proof74">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.mmap_values">mmap_values</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore1">Forall2_ignore1</a></span> <span class="kwd">in</span> <span class="id">Map</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL.reuse_ident_gensym">reuse_ident_gensym</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> [|]; <span class="id">subst</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>. <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.IsLast_sub1">IsLast_sub1</a></span> : <span class="kwd">forall</span> <span class="id">vars1</span> <span class="id">vars2</span> <span class="id">vars3</span> <span class="id">sub</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">vars1</span> -&gt; ~<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">vars2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> <span class="id">sub</span> &lt;-&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">vars2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">sub</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.IsLast">IsLast</a></span> <span class="id">vars2</span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.IsLast">IsLast</a></span> <span class="id">vars3</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">sub</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.IsLast">IsLast</a></span> (<span class="id">vars1</span> ++ <span class="id">vars2</span>) <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.IsLast">IsLast</a></span> (<span class="id">vars1</span> ++ <span class="id">vars3</span>) <span class="id">y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</span></div>
<div class="proofscript" id="proof75">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hnd</span> <span class="id">Hsubin</span> <span class="id">Hsub</span> * <span class="id">Hfind</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.IsLast_app">IsLast_app</a></span> <span class="kwd">in</span> *. <span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="id">inv</span> <span class="id">Hin</span>. <span class="id">eapply</span> <span class="id">Hnd</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Hsubin</span>. <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="INLINELOCAL.IsLast_sub2">IsLast_sub2</a></span> : <span class="kwd">forall</span> <span class="id">vars1</span> <span class="id">vars2</span> <span class="id">vars3</span> <span class="id">sub</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> <span class="id">sub</span> &lt;-&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">vars2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">sub</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.IsLast">IsLast</a></span> <span class="id">vars2</span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.IsLast">IsLast</a></span> <span class="id">vars3</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">sub</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.IsLast">IsLast</a></span> (<span class="id">vars1</span> ++ <span class="id">vars2</span>) <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.IsLast">IsLast</a></span> (<span class="id">vars1</span> ++ <span class="id">vars3</span>) <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</span></div>
<div class="proofscript" id="proof76">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hsubin</span> <span class="id">Hsub</span> * <span class="id">Hfind</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv.IsLast_app">IsLast_app</a></span> <span class="kwd">in</span> *. <span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="id">inv</span> <span class="id">Hin</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>, <span class="id">Hsubin</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL">INLINELOCAL</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="InlineLocalFun">InlineLocalFun</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Ids</span> : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Op</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Cks</span> : <span class="id"><a href="Velus.Clocks.html#CLOCKS">CLOCKS</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Senv</span> : <span class="id"><a href="Velus.Lustre.StaticEnv.html#STATICENV">STATICENV</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Syn</span> : <span class="id"><a href="Velus.Lustre.LSyntax.html#LSYNTAX">LSYNTAX</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv">Senv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;: <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL">INLINELOCAL</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn">Syn</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Include</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#INLINELOCAL">INLINELOCAL</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#Syn">Syn</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.InlineLocal.InlineLocal.html#InlineLocalFun">InlineLocalFun</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
