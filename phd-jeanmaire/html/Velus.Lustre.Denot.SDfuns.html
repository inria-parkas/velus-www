
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module SDfuns</title>
<meta name="description" content="Documentation of Coq module SDfuns" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module SDfuns</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.PArith.BinPos.html">BinPos</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#ListNotations">ListNotations</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.CommonTactics.html">CommonTactics</a></span> <span class="id"><a href="Velus.Common.Common.html">Common.Common</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.html">Lustre.Denot.Cpo</a></span>.<br/>
<br/>
<h1> Streams operations for the Lustre synchronous semantics </h1>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="error">error</a></span> :=<br/>
| <span class="id"><a name="error_Ty">error_Ty</a></span>  <br/>
| <span class="id"><a name="error_Cl">error_Cl</a></span>  <br/>
| <span class="id"><a name="error_Op">error_Op</a></span>  <br/>
.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="sampl">sampl</a></span> (<span class="id">A</span> : <span class="kwd">Type</span>) : <span class="kwd">Type</span> :=<br/>
| <span class="id"><a name="abs">abs</a></span><br/>
| <span class="id"><a name="pres">pres</a></span> (<span class="id">a</span>: <span class="id">A</span>)<br/>
| <span class="id"><a name="err">err</a></span>  (<span class="id">e</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error">error</a></span>).<br/>
<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>  {<span class="id">A</span>}.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> {<span class="id">A</span>} <span class="id">a</span>.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span>  {<span class="id">A</span>} <span class="id">e</span>.<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Hint</span> <span class="id">Rewrite</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#ford_fcont_shift_simpl">ford_fcont_shift_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#curry_Curry">curry_Curry</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Curry_simpl">Curry_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2_simpl">fcont_comp2_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp3_simpl">fcont_comp3_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_comp4_simpl">fcont_comp4_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND_simpl">SND_simpl</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Snd_simpl">Snd_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST_simpl">FST_simpl</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fst_simpl">Fst_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span><br/>
&nbsp;&nbsp;: <span class="id">localdb</span>.<br/>
<br/>
<br/>
<h3> Repeated absences </h3>
<span class="kwd">Section</span> <span class="id"><a name="Abs">Abs</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">I</span> : <span class="kwd">Type</span>}.<br/>
<br/>
<div class="doc">infinity of absences </div>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="abss">abss</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Abs.A">A</a></span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="abs_env">abs_env</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Abs.I">I</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Abs.A">A</a></span>) := <span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abss">abss</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="abs_abs_abs">abs_abs_abs</a></span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span> <span class="kwd">at</span> 1 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="all_cons_abs_env">all_cons_abs_env</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_cons">all_cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_DS_const">is_cons_DS_const</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="abs_env_inf">abs_env_inf</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_inf">DS_const_inf</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="rem_abs_env">rem_abs_env</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span>) == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs_env">abs_env</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abss">abss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_eq">REM_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Abs">Abs</a></span>.<br/>
<br/>
<br/>
<h3> abstract_clock as defined in VÃ©lus, considering errors as absences </h3>
<span class="kwd">Section</span> <span class="id"><a name="Abstract_clock">Abstract_clock</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">I</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="AC">AC</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Abstract_clock.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> | <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="kwd">end</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="AC_cons">AC_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">u</span> <span class="id">U</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">u</span> <span class="id">U</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="kwd">match</span> <span class="id">u</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">U</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">u</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="AC_is_cons">AC_is_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">U</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">U</span>) &lt;-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">U</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_map">is_cons_map</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="first_AC">first_AC</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">s</span>) == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_map">first_map</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="rem_AC">rem_AC</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">s</span>) == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_map">rem_map</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="AC_app">AC_app</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">xs</span> <span class="id">ys</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> <span class="id">ys</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_map">app_map</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">equivalent of <span class="bracket"><span class="id">clocks_of</span></span> </div>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="bss">bss</a></span> (<span class="id">ins</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Abstract_clock.I">I</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Abstract_clock.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ins</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#CTE">CTE</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">x</span> :: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> <span class="id">_</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">x</span> :: <span class="id">ins</span> =&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#orb">orb</a></span> @2<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> <span class="id">_</span> <span class="id">x</span>)) (<span class="id">bss</span> <span class="id">ins</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bss_cons">bss_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">l</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> (<span class="id">x</span> :: <span class="id">l</span>) <span class="id">env</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#orb">orb</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> (<span class="id">env</span> <span class="id">x</span>)) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">l</span> <span class="id">env</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">l</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">env</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_comm">zip_comm</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_const">zip_const</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#orb_comm">Bool.orb_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 3 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_comp">map_comp</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bss_cons2">bss_cons2</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">l</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> (<span class="id">x</span> :: <span class="id">y</span> :: <span class="id">l</span>) <span class="id">env</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#orb">orb</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> (<span class="id">env</span> <span class="id">x</span>)) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> (<span class="id">y</span> :: <span class="id">l</span>) <span class="id">env</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bss_inf">bss_inf</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> <span class="id">env</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">l</span> <span class="id">env</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="kwd">as</span> [|?[]]; <span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">Hinf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_inf">DS_const_inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_inf">map_inf</a></span>, <span class="id">Hinf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_inf">zip_inf</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_inf">map_inf</a></span>, <span class="id">Hinf</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bss_inf_dom">bss_inf_dom</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">env</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">l</span> <span class="id">env</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="kwd">as</span> [|?[]]; <span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">Hinf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_inf">DS_const_inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_inf">map_inf</a></span>, <span class="id">Hinf</span>; <span class="id">now</span> <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hinf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_inf">zip_inf</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_inf">map_inf</a></span>, <span class="id">Hinf</span>; <span class="id">now</span> <span class="id">left</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bss_switch_env">bss_switch_env</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">env</span> <span class="id">env</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">l</span> -&gt; <span class="id">env</span> <span class="id">x</span> == <span class="id">env</span>' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">l</span> <span class="id">env</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">l</span> <span class="id">env</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="kwd">as</span> [|<span class="id">x</span> []]; <span class="id">intros</span> * <span class="id">Heq</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl</span>; <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">Heq</span> <span class="id">x</span>); <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl</span>; <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">Heq</span> <span class="id">x</span>), <span class="id">IHl</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="rem_bss">rem_bss</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">l</span> <span class="id">env</span>) == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss">bss</a></span> <span class="id">l</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">env</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#bss_cons">bss_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_zip">rem_zip</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#rem_AC">rem_AC</a></span>, <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Abstract_clock">Abstract_clock</a></span>.<br/>
<br/>
<br/>
<h3> unop and binop are in a separate section to ease their usage by other
    primitives </h3>
<span class="kwd">Section</span> <span class="id"><a name="Sunop_binop">Sunop_binop</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">D</span> : <span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="sunop">sunop</a></span> (<span class="id">uop</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Sunop_binop.A">A</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Sunop_binop.B">B</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Sunop_binop.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Sunop_binop.B">B</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">uop</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Op">error_Op</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="sunop_eq">sunop_eq</a></span> : <span class="kwd">forall</span> <span class="id">uop</span> <span class="id">u</span> <span class="id">U</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sunop">sunop</a></span> <span class="id">uop</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">u</span> <span class="id">U</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="kwd">match</span> <span class="id">u</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">u</span> =&gt; <span class="kwd">match</span> <span class="id">uop</span> <span class="id">u</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Op">error_Op</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sunop">sunop</a></span> <span class="id">uop</span> <span class="id">U</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sunop">sunop</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">u</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="sbinop">sbinop</a></span> (<span class="id">bop</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Sunop_binop.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Sunop_binop.B">B</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Sunop_binop.D">D</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Sunop_binop.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Sunop_binop.B">B</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Sunop_binop.D">D</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="kwd">fun</span> <span class="id">va</span> <span class="id">vb</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">va</span>, <span class="id">vb</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">a</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">bop</span> <span class="id">a</span> <span class="id">b</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Op">error_Op</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="sbinop_eq">sbinop_eq</a></span> : <span class="kwd">forall</span> <span class="id">bop</span> <span class="id">u</span> <span class="id">U</span> <span class="id">v</span> <span class="id">V</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop">sbinop</a></span> <span class="id">bop</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">u</span> <span class="id">U</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">v</span> <span class="id">V</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="kwd">match</span> <span class="id">u</span>, <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">a</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">bop</span> <span class="id">a</span> <span class="id">b</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Op">error_Op</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop">sbinop</a></span> <span class="id">bop</span> <span class="id">U</span> <span class="id">V</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop">sbinop</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_sbinop">is_cons_sbinop</a></span> : <span class="kwd">forall</span> <span class="id">bop</span> <span class="id">U</span> <span class="id">V</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">U</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">V</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop">sbinop</a></span> <span class="id">bop</span> <span class="id">U</span> <span class="id">V</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * []; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop">sbinop</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_zip">is_cons_zip</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="sbinop_is_cons">sbinop_is_cons</a></span> : <span class="kwd">forall</span> <span class="id">bop</span> <span class="id">U</span> <span class="id">V</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop">sbinop</a></span> <span class="id">bop</span> <span class="id">U</span> <span class="id">V</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">U</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">V</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sbinop">sbinop</a></span>; <span class="id">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Sunop_binop">Sunop_binop</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="SStream_functions">SStream_functions</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>}.<br/>
<br/>
<div class="doc">Rythm of constants if given by the base clock as an argument </div>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="sconst">sconst</a></span> (<span class="id">v</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="kwd">fun</span> <span class="id">c</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> =&gt; <span class="kwd">if</span> <span class="id">c</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="sconst_cons">sconst_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">b</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst">sconst</a></span> <span class="id">c</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">b</span> <span class="id">bs</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="kwd">if</span> <span class="id">b</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">c</span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst">sconst</a></span> <span class="id">c</span> <span class="id">bs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="AC_sconst">AC_sconst</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst">sconst</a></span> <span class="id">c</span> <span class="id">bs</span>) == <span class="id">bs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#AC">AC</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sconst">sconst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_comp">map_comp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">_</span> <span class="id">V</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;3: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">now</span> <span class="id">intros</span> ????? &lt;- &lt;-. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> <span class="id">Hu</span>. <span class="id">rewrite</span> <span class="id">Hu</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [<span class="id">Hc</span>|<span class="id">Hc</span>]. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> (?&amp;?&amp;<span class="id">Hv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id">Hv</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>; <span class="id">destruct</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_map">rem_map</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">fby1 is defined by means of two mutually recursive functions, see
      <span class="bracket"><span class="id">fby1APf_eq</span></span> and <span class="bracket"><span class="id">fby1f_eq</span></span> above for explanation
      That is why we keep an option in fby1, even if it is always called
      with (Some _).
   </div>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="fby1sf">fby1sf</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>. <span class="id">intro</span> <span class="id">ov</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">_</span> (<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">fby1</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_ford_shift">fcont_ford_shift</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>))) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">xs</span> := (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ys</span>' := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> <span class="kwd">match</span> <span class="id">ov</span>, <span class="id">y</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_ford_shift">fcont_ford_shift</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">fby1</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>) @3<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> <span class="id">_</span>) <span class="id">xs</span> <span class="id">ys</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">y</span>) @<span class="id">_</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>) @<span class="id">_</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>. <span class="id">intro</span> <span class="id">ov</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">_</span> (<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">fby1AP</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_ford_shift">fcont_ford_shift</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>))) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ys</span> := (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">xs</span>' := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> <span class="kwd">match</span> <span class="id">ov</span>, <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>) @<span class="id">_</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_ford_shift">fcont_ford_shift</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">fby1AP</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> @3<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> <span class="id">_</span>) <span class="id">xs</span>' <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> @<span class="id">_</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_ford_shift">fcont_ford_shift</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">fby1AP</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>) @3<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> <span class="id">_</span>) <span class="id">xs</span>' <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id">x</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">x</span>) @<span class="id">_</span> <span class="id">xs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>) @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>) @<span class="id">_</span> <span class="id">xs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;Defined.
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fby1APf_eq">fby1APf_eq</a></span> : <span class="kwd">forall</span> <span class="id">F</span> <span class="id">ov</span> <span class="id">xs</span> <span class="id">y</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1sf">fby1sf</a></span> <span class="id">F</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id">ov</span> <span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">y</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">match</span> <span class="id">ov</span>, <span class="id">y</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id">F</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>) <span class="id">xs</span> <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">y</span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1sf">fby1sf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#ford_fcont_shift_simpl">ford_fcont_shift_simpl</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#curry_Curry">curry_Curry</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Curry_simpl">Curry_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2_simpl">fcont_comp2_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND_simpl">SND_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Snd_simpl">Snd_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">_</span>); <span class="id">rewrite</span>  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ov</span>,<span class="id">y</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fby1f_eq">fby1f_eq</a></span> : <span class="kwd">forall</span> <span class="id">F</span> <span class="id">ov</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1sf">fby1sf</a></span> <span class="id">F</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">ov</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>) <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">match</span> <span class="id">ov</span>, <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>) (<span class="id">F</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">xs</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id">F</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>) <span class="id">xs</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">x</span>) <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>) <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1sf">fby1sf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#ford_fcont_shift_simpl">ford_fcont_shift_simpl</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#curry_Curry">curry_Curry</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Curry_simpl">Curry_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2_simpl">fcont_comp2_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST_simpl">FST_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fst_simpl">Fst_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND_simpl">SND_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Snd_simpl">Snd_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">_</span>); <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ov</span>,<span class="id">x</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="fby1s">fby1s</a></span> : (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1sf">fby1sf</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="fby1AP">fby1AP</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1s">fby1s</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="fby1">fby1</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1s">fby1s</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fby1AP_eq">fby1AP_eq</a></span> : <span class="kwd">forall</span> <span class="id">ov</span> <span class="id">xs</span> <span class="id">y</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP">fby1AP</a></span> <span class="id">ov</span> <span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">y</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">match</span> <span class="id">ov</span>,<span class="id">y</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1">fby1</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>) <span class="id">xs</span> <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">y</span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP">fby1AP</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1s">fby1s</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Heq</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1sf">fby1sf</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> <span class="id">Heq</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>)) <span class="kwd">as</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1APf_eq">fby1APf_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1">fby1</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1s">fby1s</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fby1_eq">fby1_eq</a></span> : <span class="kwd">forall</span> <span class="id">ov</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1">fby1</a></span> <span class="id">ov</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>) <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">match</span> <span class="id">ov</span>, <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP">fby1AP</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>) <span class="id">xs</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP">fby1AP</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">xs</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">x</span>) <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>) <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1">fby1</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1s">fby1s</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Heq</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1sf">fby1sf</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> <span class="id">Heq</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1f_eq">fby1f_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP">fby1AP</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1s">fby1s</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fby1AP_cons">fby1AP_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ov</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP">fby1AP</a></span> <span class="id">ov</span> <span class="id">xs</span> <span class="id">ys</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">ys</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP">fby1AP</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1s">fby1s</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id">ov</span>) <span class="kwd">in</span> <span class="id">Hc</span>. <span class="comment">(*&nbsp;WTF&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_is_cons">DScase_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fby1_cons">fby1_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ov</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1">fby1</a></span> <span class="id">ov</span> <span class="id">xs</span> <span class="id">ys</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1">fby1</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1s">fby1s</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id">ov</span>) <span class="kwd">in</span> <span class="id">Hc</span>. <span class="comment">(*&nbsp;WTF&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_is_cons">DScase_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fby1_bot1">fby1_bot1</a></span> : <span class="kwd">forall</span> <span class="id">o</span> <span class="id">ys</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1">fby1</a></span> <span class="id">o</span> 0 <span class="id">ys</span> == 0.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">o</span> <span class="id">ys</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1">fby1</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1s">fby1s</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id">o</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DScase_bot_eq">DScase_bot_eq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Opaque</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1s">fby1s</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="fbysf">fbysf</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id">_</span> <span class="id">_</span> @2<span class="id">_</span> <span class="id">_</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">_</span> (<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">fby</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_ford_shift">fcont_ford_shift</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>))) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">xs</span> := (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ys</span>' := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> <span class="kwd">match</span> <span class="id">y</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; (<span class="id">fby</span> @3<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> <span class="id">_</span>) <span class="id">xs</span> <span class="id">ys</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">y</span>) @<span class="id">_</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>) @<span class="id">_</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">_</span> (<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">fbyA</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#fcont_ford_shift">fcont_ford_shift</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>))) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">ys</span> := (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">xs</span>' := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> @<span class="id">_</span> ((<span class="id">fbyA</span> @3<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> <span class="id">_</span>) <span class="id">xs</span>' <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>) @<span class="id">_</span> ((<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP">fby1AP</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> @2<span class="id">_</span> <span class="id">xs</span>') <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id">x</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">x</span>) @<span class="id">_</span> <span class="id">xs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;Defined.
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fbyAf_eq">fbyAf_eq</a></span> : <span class="kwd">forall</span> <span class="id">F</span> <span class="id">xs</span> <span class="id">y</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbysf">fbysf</a></span> <span class="id">F</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">y</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">match</span> <span class="id">y</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id">F</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">xs</span> <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">y</span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbysf">fbysf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#ford_fcont_shift_simpl">ford_fcont_shift_simpl</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#curry_Curry">curry_Curry</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Curry_simpl">Curry_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2_simpl">fcont_comp2_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND_simpl">SND_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Snd_simpl">Snd_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">_</span>); <span class="id">rewrite</span>  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">y</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fbyf_eq">fbyf_eq</a></span> : <span class="kwd">forall</span> <span class="id">F</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbysf">fbysf</a></span> <span class="id">F</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>) <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id">F</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id">xs</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP">fby1AP</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">xs</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">x</span>) <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbysf">fbysf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#ford_fcont_shift_simpl">ford_fcont_shift_simpl</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#curry_Curry">curry_Curry</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Curry_simpl">Curry_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2_simpl">fcont_comp2_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#ford_fcont_shift_simpl">ford_fcont_shift_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND_simpl">SND_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Snd_simpl">Snd_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">_</span>); <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="fbys">fbys</a></span> : (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">O</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbysf">fbysf</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fbysF_eq">fbysF_eq</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbys">fbys</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>) <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbys">fbys</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id">xs</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP">fby1AP</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">xs</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">x</span>) <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbys">fbys</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Heq</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbysf">fbysf</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_eq_elim">fcont_eq_elim</a></span> <span class="kwd">in</span> <span class="id">Heq</span> <span class="kwd">as</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbyf_eq">fbyf_eq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fbysT_eq">fbysT_eq</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">y</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbys">fbys</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">y</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">match</span> <span class="id">y</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbys">fbys</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">xs</span> <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">y</span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbys">fbys</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Heq</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbysf">fbysf</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_eq_elim">fcont_eq_elim</a></span> <span class="kwd">in</span> <span class="id">Heq</span> <span class="kwd">as</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbyAf_eq">fbyAf_eq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="fbyA">fbyA</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbys">fbys</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="fby">fby</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbys">fbys</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fbyA_eq">fbyA_eq</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">y</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbyA">fbyA</a></span> <span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">y</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">match</span> <span class="id">y</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby">fby</a></span> <span class="id">xs</span> <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">y</span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbyA">fbyA</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbys">fbys</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Heq</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbysf">fbysf</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> <span class="id">Heq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbyAf_eq">fbyAf_eq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fby_eq">fby_eq</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby">fby</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>) <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbyA">fbyA</a></span> <span class="id">xs</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby1AP">fby1AP</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">xs</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">x</span>) <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby">fby</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbys">fbys</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Heq</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbysf">fbysf</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> <span class="id">Heq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbyf_eq">fbyf_eq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fbyA_cons">fbyA_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbyA">fbyA</a></span> <span class="id">xs</span> <span class="id">ys</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">ys</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbyA">fbyA</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbys">fbys</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_is_cons">DScase_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fby_cons">fby_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby">fby</a></span> <span class="id">xs</span> <span class="id">ys</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby">fby</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbys">fbys</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="kwd">in</span> <span class="id">Hc</span>. <span class="comment">(*&nbsp;WTF&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_is_cons">DScase_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_fby">is_cons_fby</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">xs</span> <span class="id">ys</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby">fby</a></span> <span class="id">xs</span> <span class="id">ys</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hx</span> <span class="kwd">as</span> (?&amp;?&amp;-&gt;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby_eq">fby_eq</a></span>; <span class="id">cases</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fbyA_bot">fbyA_bot</a></span> : <span class="kwd">forall</span> <span class="id">xs</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbyA">fbyA</a></span> <span class="id">xs</span> 0 == 0.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbyA">fbyA</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbys">fbys</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DScase_bot_eq">DScase_bot_eq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fby_bot">fby_bot</a></span> : <span class="kwd">forall</span> <span class="id">ys</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby">fby</a></span> 0 <span class="id">ys</span> == 0.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fby">fby</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbys">fbys</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_eq_elim">ford_eq_elim</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DScase_bot_eq">DScase_bot_eq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Opaque</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fbys">fbys</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="SStream_functions.When_Case">When_Case</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="SStream_functions.When_Case.enumtag">enumtag</a></span> : <span class="kwd">Type</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="SStream_functions.When_Case.tag_of_val">tag_of_val</a></span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.B">B</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="SStream_functions.When_Case.tag_eqb">tag_eqb</a></span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="SStream_functions.When_Case.tag_eqb_eq">tag_eqb_eq</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_eqb">tag_eqb</a></span> <span class="id">t1</span> <span class="id">t2</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> &lt;-&gt; <span class="id">t1</span> = <span class="id">t2</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tag_eqb_refl">tag_eqb_refl</a></span> : <span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_eqb">tag_eqb</a></span> <span class="id">t</span> <span class="id">t</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
 <span class="id">intro</span>; <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_eqb_eq">tag_eqb_eq</a></span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tag_eqb_neq">tag_eqb_neq</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_eqb">tag_eqb</a></span> <span class="id">t1</span> <span class="id">t2</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> &lt;-&gt; <span class="id">t1</span> &lt;&gt; <span class="id">t2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_eqb">tag_eqb</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">firstorder</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">firstorder</span>; <span class="id">intros</span> <span class="id">HHH</span>%<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_eqb_eq">tag_eqb_eq</a></span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="swhen">swhen</a></span> (<span class="id">k</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.B">B</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">c</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">x</span>, <span class="id">c</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">c</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_of_val">tag_of_val</a></span> <span class="id">c</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Ty">error_Ty</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">t</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_eqb">tag_eqb</a></span> <span class="id">k</span> <span class="id">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span>, <span class="id">_</span> | <span class="id">_</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="swhen_eq">swhen_eq</a></span> : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">c</span> <span class="id">C</span> <span class="id">x</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#swhen">swhen</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">C</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="kwd">match</span> <span class="id">x</span>, <span class="id">c</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">c</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_of_val">tag_of_val</a></span> <span class="id">c</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Ty">error_Ty</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">t</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_eqb">tag_eqb</a></span> <span class="id">k</span> <span class="id">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span>, <span class="id">_</span> | <span class="id">_</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#swhen">swhen</a></span> <span class="id">k</span> <span class="id">X</span> <span class="id">C</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#swhen">swhen</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="swhen_cons">swhen_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">xs</span> <span class="id">cs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#swhen">swhen</a></span> <span class="id">k</span> <span class="id">xs</span> <span class="id">cs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">cs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#swhen">swhen</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">Le cas du merge/case est plus dÃ©licat car il opÃ¨re sur une liste
      (nprod) de flots. On utilise pour Ã§a <span class="bracket"><span class="id">nprod_Foldi</span></span>, qui effectue
      un fold_right sur la liste combinÃ©e des flots et des informations
      de tag. (quel flot correspond Ã  quel tag ?).
   </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="is_tag">is_tag</a></span> (<span class="id">i</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span>) (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.B">B</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Ty">error_Ty</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_eqb">tag_eqb</a></span> <span class="id">i</span> <span class="id">j</span>)) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_of_val">tag_of_val</a></span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="defcon">defcon</a></span> (<span class="id">c</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.B">B</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">c</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Ty">error_Ty</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="fmerge">fmerge</a></span> (<span class="id">j</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span>) (<span class="id">c</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.B">B</a></span>) (<span class="id">x</span> <span class="id">a</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#is_tag">is_tag</a></span> <span class="id">j</span> <span class="id">c</span>, <span class="id">a</span>, <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Ty">error_Ty</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>, <span class="id">a</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="smerge">smerge</a></span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.B">B</a></span>) -<span class="id">C</span>-&gt; @<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_Foldi">nprod_Foldi</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon">defcon</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>; <span class="id">intro</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge">fmerge</a></span> <span class="id">j</span>)).<br/>
&nbsp;&nbsp;Defined.
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="smerge_eq">smerge_eq</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">C</span> <span class="id">np</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#smerge">smerge</a></span> <span class="id">l</span> <span class="id">C</span> <span class="id">np</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_Foldi">nprod_Foldi</a></span> <span class="id">l</span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge">fmerge</a></span> <span class="id">j</span>) <span class="id">C</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon">defcon</a></span> <span class="id">C</span>) <span class="id">np</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="smerge_is_cons">smerge_is_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">C</span> <span class="id">np</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#smerge">smerge</a></span> <span class="id">l</span> <span class="id">C</span> <span class="id">np</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">C</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">_</span>) <span class="id">np</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="kwd">as</span> [|? []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#smerge_eq">smerge_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Foldi_cons">Foldi_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (?&amp; <span class="id">Hc</span> &amp;?) % <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_is_cons">zip3_is_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#smerge_eq">smerge_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Foldi_cons">Foldi_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (?&amp;? &amp; <span class="id">Hc</span>) % <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_is_cons">zip3_is_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">IHl</span> <span class="id">C</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_tl">nprod_tl</a></span> <span class="id">np</span>)) <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> []; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 (<span class="id">split</span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_smerge">is_cons_smerge</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">cs</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">_</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#smerge">smerge</a></span> <span class="id">l</span> <span class="id">cs</span> <span class="id">xs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#smerge_eq">smerge_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_Foldi">forall_nprod_Foldi</a></span> <span class="kwd">in</span> <span class="id">Hx</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_DS_const">is_cons_DS_const</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_zip3">is_cons_zip3</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="rem_smerge">rem_smerge</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">C</span> <span class="id">np</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#smerge">smerge</a></span> <span class="id">l</span> <span class="id">C</span> <span class="id">np</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#smerge">smerge</a></span> <span class="id">l</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">C</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift">lift</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> <span class="id">_</span>) <span class="id">np</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#smerge_eq">smerge_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Foldi_nil">Foldi_nil</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_map">rem_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#smerge_eq">smerge_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Foldi_cons">Foldi_cons</a></span>, &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#smerge_eq">smerge_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_zip3">rem_zip3</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_hd">lift_hd</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_tl">lift_tl</a></span>, <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="smerge_cons">smerge_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">np</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">Hc</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">_</span>) <span class="id">np</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#smerge">smerge</a></span> <span class="id">l</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">cs</span>) <span class="id">np</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>,<span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge">fmerge</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon">defcon</a></span> <span class="id">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hds">nprod_hds</a></span> <span class="id">np</span> <span class="id">Hc</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#smerge">smerge</a></span> <span class="id">l</span> <span class="id">cs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift">lift</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> <span class="id">_</span>) <span class="id">np</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_rem_eq">first_rem_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#smerge_eq">smerge_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Foldi_fold_right">Foldi_fold_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">dependent</span> <span class="id">np</span>; <span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_map">first_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_bot">map_bot</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_zip3">first_zip3</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, (<span class="id">IHl</span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_tl">forall_nprod_tl</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hc</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd">nprod_hd</a></span> <span class="id">np</span>)) <span class="kwd">as</span> (<span class="id">x</span> &amp;?&amp; <span class="id">Heq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_hd">forall_nprod_hd</a></span> <span class="kwd">in</span> <span class="id">Hc</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">_</span>) <span class="kwd">as</span> <span class="id">y</span> <span class="id">eqn</span>:<span class="id">Hy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">x</span> = <span class="id">y</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#uncons">uncons</a></span> <span class="id">_</span>) <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hd</span>); <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp_eqCon">decomp_eqCon</a></span> <span class="kwd">in</span> <span class="id">Hd</span>; <span class="id">rewrite</span> <span class="id">Hd</span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Heq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Heq</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_cons">zip3_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_bot1">zip3_bot1</a></span> <span class="kwd">at</span> 1; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#rem_smerge">rem_smerge</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">CaractÃ©risation de <span class="bracket"><span class="id">fmerge</span></span> itÃ©rÃ© sur la tÃªtes des flots </div>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="SStream_functions.When_Case.fmerge_spec">fmerge_spec</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fmerge_abs">fmerge_abs</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span> * <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>,<span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge">fmerge</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon">defcon</a></span> <span class="id">c</span>) <span class="id">l</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> /\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) <span class="id">l</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="kwd">as</span> [|[]]; <span class="id">simpl</span>; <span class="id">intros</span> <span class="id">c</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">c</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hf</span>; <span class="id">auto</span>; <span class="id">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge">fmerge</a></span> <span class="kwd">at</span> 1 <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span> <span class="kwd">as</span> [|<span class="id">k</span>|]; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hf</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">HH</span>, <span class="id">s</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHl</span> <span class="kwd">in</span> <span class="id">HH</span> <span class="kwd">as</span> []; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_of_val">tag_of_val</a></span> <span class="id">_</span>); <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_eqb">tag_eqb</a></span> <span class="id">_</span> <span class="id">_</span>), (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">as</span> [| |[]] <span class="id">eqn</span>:<span class="id">HH</span>, <span class="id">s</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHl</span> <span class="kwd">in</span> <span class="id">HH</span> <span class="kwd">as</span> []; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fmerge_pres_abs">fmerge_pres_abs</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span> * <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) <span class="id">i</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">c</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">i</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge">fmerge</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon">defcon</a></span> <span class="id">c</span>) <span class="id">l</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Ty">error_Ty</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) <span class="id">l</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="kwd">as</span> [|[]]; <span class="id">simpl</span>; <span class="id">intros</span> <span class="id">i</span> <span class="id">Hf</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge">fmerge</a></span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#is_tag">is_tag</a></span> <span class="id">e</span> <span class="id">_</span>) <span class="kwd">as</span> [|[]|]; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">as</span> [| |[]] <span class="id">eqn</span>:<span class="id">HH</span>, <span class="id">s</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">constructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fmerge_pres">fmerge_pres</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span> * <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) <span class="id">c</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge">fmerge</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon">defcon</a></span> <span class="id">c</span>) <span class="id">l</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">vc</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">vc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_of_val">tag_of_val</a></span> <span class="id">vc</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id">j</span> = <span class="id">i</span> /\ <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>) <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id">j</span> &lt;&gt; <span class="id">i</span> -&gt; <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) <span class="id">l</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="kwd">as</span> [|[<span class="id">i</span> <span class="id">s</span>]]; <span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">c</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hf</span>; <span class="id">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge">fmerge</a></span> <span class="kwd">at</span> 1 <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span> <span class="kwd">as</span> [|<span class="id">k</span>|]; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hf</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">HH</span>, <span class="id">s</span>; <span class="id">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_of_val">tag_of_val</a></span> <span class="id">k</span>) <span class="kwd">as</span> [<span class="id">t</span>|] <span class="id">eqn</span>:<span class="id">Hk</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">k</span>, <span class="id">t</span>; <span class="id">do</span> 2 <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_eqb">tag_eqb</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;on&nbsp;y&nbsp;est&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_eqb_eq">tag_eqb_eq</a></span> <span class="kwd">in</span> <span class="id">Ht</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">as</span> [| |[]] <span class="id">eqn</span>:<span class="id">HH</span>, <span class="id">s</span>; <span class="id">inversion</span> <span class="id">Hf</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">constructor</span>; <span class="id">auto</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge_pres_abs">fmerge_pres_abs</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span> <span class="kwd">in</span> <span class="id">HH</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> []; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;c'est&nbsp;pour&nbsp;plus&nbsp;tard&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">s</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHl</span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> (<span class="id">vc</span> &amp; <span class="id">k</span>' &amp; <span class="id">Hk</span>' &amp; <span class="id">Ht</span>' &amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Hk</span>'; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hk</span> <span class="kwd">in</span> *; <span class="id">inversion</span> <span class="id">Ht</span>'; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fmerge_abs_ok">fmerge_abs_ok</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span>) (<span class="id">ss</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">c</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) <span class="id">ss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge">fmerge</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon">defcon</a></span> <span class="id">c</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">ss</span>) = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span>; <span class="id">intros</span> * <span class="id">Heq</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ss</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Heq</span>; <span class="id">subst</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">IHl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fmerge_pres_ok">fmerge_pres_ok</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span>) (<span class="id">ss</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) <span class="id">vt</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">c</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">vt</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_of_val">tag_of_val</a></span> <span class="id">vt</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">i</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">j</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id">j</span> = <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id">j</span> &lt;&gt; <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) <span class="id">l</span> <span class="id">ss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">i</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">v</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge">fmerge</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon">defcon</a></span> <span class="id">c</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">ss</span>) = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hv</span> <span class="id">Nd</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;il&nbsp;faut&nbsp;renforcer&nbsp;un&nbsp;peu&nbsp;l'invariant&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">enough</span> ((<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">i</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">v</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge">fmerge</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon">defcon</a></span> <span class="id">c</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">ss</span>) = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (~ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">i</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge">fmerge</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon">defcon</a></span> <span class="id">c</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">ss</span>) = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Ty">error_Ty</a></span>)); [ <span class="id">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">dependent</span> <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span> <span class="id">c</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span>; <span class="id">simpl</span>; <span class="id">intros</span>; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ss</span> <span class="kwd">as</span> [| <span class="id">s</span> <span class="id">ss</span>]; <span class="id">inversion_clear</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Nd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">IHl</span> <span class="kwd">as</span> [<span class="id">Hin</span> <span class="id">Hnin</span>]; <span class="id">eauto</span>; <span class="id">clear</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fmerge">fmerge</a></span> <span class="kwd">at</span> 1 3; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> [| <span class="id">Ini</span>]; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">s</span>; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#tag_eqb_refl">tag_eqb_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hnin</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">s</span>; <span class="id">subst</span>; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#tag_eqb_neq">tag_eqb_neq</a></span> <span class="id">a</span> <span class="id">i</span>)); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intro</span> <span class="id">Nin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#tag_eqb_neq">tag_eqb_neq</a></span> <span class="id">a</span> <span class="id">i</span>)); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">s</span>; <span class="id">subst</span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.fmerge_spec">fmerge_spec</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Opaque</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#smerge">smerge</a></span>.<br/>
<br/>
<div class="doc">Le scase ressemble au smerge mais vÃ©rifie que tous les flots sont
      sur la mÃªme horloge que la condition cf. fcase.
      On peut gÃ©rer le cas par dÃ©faut (lorsqu'une branche est volontairement
      omise) en modifiant la valeur initiale de l'accumulateur du foldi :
      sans branche par dÃ©faut, on initialise Ã  <span class="bracket"><span class="id">abs</span>/<span class="id">error_Ty</span></span> comme dans smerge,
      et sinon on part de la valeur par dÃ©faut, aprÃ¨s l'avoir synchronisÃ©e
      avec la condition cf. <span class="bracket"><span class="id">defcon2</span></span>.
   </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="fcase">fcase</a></span> (<span class="id">j</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span>) (<span class="id">c</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.B">B</a></span>) (<span class="id">x</span> <span class="id">a</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#is_tag">is_tag</a></span> <span class="id">j</span> <span class="id">c</span>, <span class="id">a</span>, <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Ty">error_Ty</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>, <span class="id">a</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id">a</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="scase">scase</a></span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.B">B</a></span>) -<span class="id">C</span>-&gt; @<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_Foldi">nprod_Foldi</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon">defcon</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>; <span class="id">intro</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="id">j</span>)).<br/>
&nbsp;&nbsp;Defined.
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="scase_eq">scase_eq</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">C</span> <span class="id">np</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase">scase</a></span> <span class="id">l</span> <span class="id">C</span> <span class="id">np</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_Foldi">nprod_Foldi</a></span> <span class="id">l</span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="id">j</span>) <span class="id">C</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon">defcon</a></span> <span class="id">C</span>) <span class="id">np</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="defcon2">defcon2</a></span> (<span class="id">c</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.B">B</a></span>) (<span class="id">v</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">c</span>, <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Cl">error_Cl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="scase_def_">scase_def_</a></span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.B">B</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>) -<span class="id">C</span>-&gt; @<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_Foldi">nprod_Foldi</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#uncurry">uncurry</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon2">defcon2</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>; <span class="id">intro</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="id">j</span>) @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;Defined.
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="scase_def__eq">scase_def__eq</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">cs</span> <span class="id">ds</span> <span class="id">np</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def_">scase_def_</a></span> <span class="id">l</span> <span class="id">cs</span> <span class="id">ds</span> <span class="id">np</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_Foldi">nprod_Foldi</a></span> <span class="id">l</span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="id">j</span>) <span class="id">cs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon2">defcon2</a></span> <span class="id">cs</span> <span class="id">ds</span>) <span class="id">np</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="scase_def">scase_def</a></span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.B">B</a></span>) -<span class="id">C</span>-&gt; @<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod">nprod</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def_">scase_def_</a></span> <span class="id">l</span> @3<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd">nprod_hd</a></span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_tl">nprod_tl</a></span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;Defined.
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="scase_def_eq">scase_def_eq</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">cs</span> <span class="id">ds</span> <span class="id">np</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def">scase_def</a></span> <span class="id">l</span> <span class="id">cs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_cons">nprod_cons</a></span> <span class="id">ds</span> <span class="id">np</span>) = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def_">scase_def_</a></span> <span class="id">l</span> <span class="id">cs</span> <span class="id">ds</span> <span class="id">np</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def">scase_def</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">localdb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">l</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="scase_is_cons">scase_is_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">C</span> <span class="id">np</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase">scase</a></span> <span class="id">l</span> <span class="id">C</span> <span class="id">np</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">C</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">_</span>) <span class="id">np</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="kwd">as</span> [|? []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_eq">scase_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Foldi_cons">Foldi_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (?&amp; <span class="id">Hc</span> &amp;?) % <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_is_cons">zip3_is_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_eq">scase_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Foldi_cons">Foldi_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (?&amp;? &amp; <span class="id">Hc</span>) % <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_is_cons">zip3_is_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">IHl</span> <span class="id">C</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_tl">nprod_tl</a></span> <span class="id">np</span>)) <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> []; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 (<span class="id">split</span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_scase">is_cons_scase</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">cs</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">_</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase">scase</a></span> <span class="id">l</span> <span class="id">cs</span> <span class="id">xs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</span></div>
<div class="proofscript" id="proof58">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_eq">scase_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_Foldi">forall_nprod_Foldi</a></span> <span class="kwd">in</span> <span class="id">Hx</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_zip3">is_cons_zip3</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="rem_scase">rem_scase</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">C</span> <span class="id">np</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase">scase</a></span> <span class="id">l</span> <span class="id">C</span> <span class="id">np</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase">scase</a></span> <span class="id">l</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">C</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift">lift</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> <span class="id">_</span>) <span class="id">np</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof59')">Proof.</span></div>
<div class="proofscript" id="proof59">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_eq">scase_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Foldi_nil">Foldi_nil</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_map">rem_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_eq">scase_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Foldi_cons">Foldi_cons</a></span>, &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_eq">scase_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_zip3">rem_zip3</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_hd">lift_hd</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_tl">lift_tl</a></span>, <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="scase_cons">scase_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">np</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">Hc</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">_</span>) <span class="id">np</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase">scase</a></span> <span class="id">l</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">cs</span>) <span class="id">np</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>,<span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon">defcon</a></span> <span class="id">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hds">nprod_hds</a></span> <span class="id">np</span> <span class="id">Hc</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase">scase</a></span> <span class="id">l</span> <span class="id">cs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift">lift</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> <span class="id">_</span>) <span class="id">np</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof60')">Proof.</span></div>
<div class="proofscript" id="proof60">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_rem_eq">first_rem_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_eq">scase_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Foldi_fold_right">Foldi_fold_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">dependent</span> <span class="id">np</span>; <span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_map">first_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_bot">map_bot</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_zip3">first_zip3</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, (<span class="id">IHl</span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_tl">forall_nprod_tl</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hc</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd">nprod_hd</a></span> <span class="id">np</span>)) <span class="kwd">as</span> (<span class="id">x</span> &amp;?&amp; <span class="id">Heq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_hd">forall_nprod_hd</a></span> <span class="kwd">in</span> <span class="id">Hc</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">_</span>) <span class="kwd">as</span> <span class="id">y</span> <span class="id">eqn</span>:<span class="id">Hy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">x</span> = <span class="id">y</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#uncons">uncons</a></span> <span class="id">_</span>) <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hd</span>); <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp_eqCon">decomp_eqCon</a></span> <span class="kwd">in</span> <span class="id">Hd</span>; <span class="id">rewrite</span> <span class="id">Hd</span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Heq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Heq</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_cons">zip3_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_bot1">zip3_bot1</a></span> <span class="kwd">at</span> 1; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#rem_scase">rem_scase</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="scase_def__is_cons">scase_def__is_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">cs</span> <span class="id">ds</span> <span class="id">np</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def_">scase_def_</a></span> <span class="id">l</span> <span class="id">cs</span> <span class="id">ds</span> <span class="id">np</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">cs</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">ds</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">_</span>) <span class="id">np</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof61')">Proof.</span></div>
<div class="proofscript" id="proof61">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="kwd">as</span> [|? []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def__eq">scase_def__eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Foldi_cons">Foldi_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (?&amp; <span class="id">Hc</span> &amp; <span class="id">HH</span>) % <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_is_cons">zip3_is_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Foldi_nil">Foldi_nil</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def__eq">scase_def__eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Foldi_cons">Foldi_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (?&amp;? &amp; <span class="id">Hc</span>) % <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_is_cons">zip3_is_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">IHl</span> <span class="id">cs</span> <span class="id">ds</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_tl">nprod_tl</a></span> <span class="id">np</span>)) <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 (<span class="id">split</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#hd_tl_forall">hd_tl_forall</a></span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="scase_def_is_cons">scase_def_is_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">cs</span> <span class="id">dnp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def">scase_def</a></span> <span class="id">l</span> <span class="id">cs</span> <span class="id">dnp</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">cs</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">_</span>) <span class="id">dnp</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof62')">Proof.</span></div>
<div class="proofscript" id="proof62">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd_tl">nprod_hd_tl</a></span> <span class="id">dnp</span>), <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def_eq">scase_def_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * ? <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def__is_cons">scase_def__is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> (?&amp;?&amp;?);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_cons">forall_nprod_cons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_scase_def_">is_cons_scase_def_</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">cs</span> <span class="id">ds</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">ds</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">_</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def_">scase_def_</a></span> <span class="id">l</span> <span class="id">cs</span> <span class="id">ds</span> <span class="id">xs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof63')">Proof.</span></div>
<div class="proofscript" id="proof63">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span> <span class="id">Hd</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def__eq">scase_def__eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_Foldi">forall_nprod_Foldi</a></span> <span class="kwd">in</span> <span class="id">Hx</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_zip">is_cons_zip</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_zip3">is_cons_zip3</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_scase_def">is_cons_scase_def</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">cs</span> <span class="id">dxs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">_</span>) <span class="id">dxs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def">scase_def</a></span> <span class="id">l</span> <span class="id">cs</span> <span class="id">dxs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof64')">Proof.</span></div>
<div class="proofscript" id="proof64">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span> <span class="id">Hdx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd_tl">nprod_hd_tl</a></span> <span class="id">dxs</span>), <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def_eq">scase_def_eq</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_cons_iff">forall_nprod_cons_iff</a></span> <span class="kwd">in</span> <span class="id">Hdx</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#is_cons_scase_def_">is_cons_scase_def_</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="rem_scase_def_">rem_scase_def_</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">cs</span> <span class="id">ds</span> <span class="id">np</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def_">scase_def_</a></span> <span class="id">l</span> <span class="id">cs</span> <span class="id">ds</span> <span class="id">np</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def_">scase_def_</a></span> <span class="id">l</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">cs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">ds</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift">lift</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> <span class="id">_</span>) <span class="id">np</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof65')">Proof.</span></div>
<div class="proofscript" id="proof65">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def__eq">scase_def__eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Foldi_nil">Foldi_nil</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_zip">rem_zip</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def__eq">scase_def__eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Foldi_cons">Foldi_cons</a></span>, &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def__eq">scase_def__eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_zip3">rem_zip3</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_hd">lift_hd</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_tl">lift_tl</a></span>, <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="rem_scase_def">rem_scase_def</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">cs</span> <span class="id">dnp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def">scase_def</a></span> <span class="id">l</span> <span class="id">cs</span> <span class="id">dnp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def">scase_def</a></span> <span class="id">l</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">cs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift">lift</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> <span class="id">_</span>) <span class="id">dnp</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof66')">Proof.</span></div>
<div class="proofscript" id="proof66">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd_tl">nprod_hd_tl</a></span> <span class="id">dnp</span>), <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def_eq">scase_def_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#rem_scase_def_">rem_scase_def_</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift_cons">lift_cons</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def_eq">scase_def_eq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="scase_def__cons">scase_def__cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">d</span> <span class="id">ds</span> <span class="id">np</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">Hc</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod">forall_nprod</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">_</span>) <span class="id">np</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def_">scase_def_</a></span> <span class="id">l</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> <span class="id">cs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">d</span> <span class="id">ds</span>) <span class="id">np</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>,<span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon2">defcon2</a></span> <span class="id">c</span> <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hds">nprod_hds</a></span> <span class="id">np</span> <span class="id">Hc</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def_">scase_def_</a></span> <span class="id">l</span> <span class="id">cs</span> <span class="id">ds</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#lift">lift</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> <span class="id">_</span>) <span class="id">np</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof67')">Proof.</span></div>
<div class="proofscript" id="proof67">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_rem_eq">first_rem_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase_def__eq">scase_def__eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#Foldi_fold_right">Foldi_fold_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">dependent</span> <span class="id">np</span>; <span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_zip">first_zip</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_bot1">zip_bot1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_zip3">first_zip3</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, (<span class="id">IHl</span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_tl">forall_nprod_tl</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hc</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#nprod_hd">nprod_hd</a></span> <span class="id">np</span>)) <span class="kwd">as</span> (<span class="id">x</span> &amp;?&amp; <span class="id">Heq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Nprod.html#forall_nprod_hd">forall_nprod_hd</a></span> <span class="kwd">in</span> <span class="id">Hc</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">_</span>) <span class="kwd">as</span> <span class="id">y</span> <span class="id">eqn</span>:<span class="id">Hy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">x</span> = <span class="id">y</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#uncons">uncons</a></span> <span class="id">_</span>) <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hd</span>); <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp_eqCon">decomp_eqCon</a></span> <span class="kwd">in</span> <span class="id">Hd</span>; <span class="id">rewrite</span> <span class="id">Hd</span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Heq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Heq</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_cons">zip3_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_bot1">zip3_bot1</a></span> <span class="kwd">at</span> 1; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#rem_scase_def_">rem_scase_def_</a></span>, 3 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">CaractÃ©risation de <span class="bracket"><span class="id">fcase</span></span> itÃ©rÃ© sur la tÃªtes des flots </div>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="SStream_functions.When_Case.fcase_spec">fcase_spec</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fcase_abs">fcase_abs</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span> * <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) <span class="id">c</span> <span class="id">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>,<span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">x</span>) <span class="id">a</span> <span class="id">l</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> /\ <span class="id">a</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> /\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) <span class="id">l</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof68')">Proof.</span></div>
<div class="proofscript" id="proof68">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="kwd">as</span> [|[][|<span class="id">l</span>]]; <span class="id">simpl</span>; <span class="id">intros</span> <span class="id">c</span> <span class="id">a</span> <span class="id">Hnil</span> <span class="id">Hf</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="kwd">at</span> 1, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#is_tag">is_tag</a></span>, <span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">subst</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="kwd">at</span> 1, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#is_tag">is_tag</a></span>, <span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">subst</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">IHl</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="id">now</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fcase_pres_abs">fcase_pres_abs</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span> * <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) <span class="id">i</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">c</span> := <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">i</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon">defcon</a></span> <span class="id">c</span>) <span class="id">l</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Ty">error_Ty</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#is_tag">is_tag</a></span> <span class="id">j</span> <span class="id">c</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> /\ <span class="kwd">exists</span> <span class="id">v</span>, <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>) <span class="id">l</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</span></div>
<div class="proofscript" id="proof69">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="kwd">as</span> [|[]]; <span class="id">simpl</span>; <span class="id">intros</span> <span class="id">i</span> <span class="id">Hf</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#is_tag">is_tag</a></span>, <span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHl</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span> <span class="kwd">in</span> <span class="id">HH1</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> []; <span class="id">cases</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fcase_pres">fcase_pres</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span> * <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) <span class="id">c</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon">defcon</a></span> <span class="id">c</span>) <span class="id">l</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">vc</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">vc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_of_val">tag_of_val</a></span> <span class="id">vc</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists">List.Exists</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id">j</span> = <span class="id">i</span> /\ <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>) <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">List.Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="kwd">exists</span> <span class="id">v</span>, <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>) <span class="id">l</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof70')">Proof.</span></div>
<div class="proofscript" id="proof70">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="kwd">as</span> [|[<span class="id">i</span> <span class="id">s</span>]]; <span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">c</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hf</span>; <span class="id">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="kwd">at</span> 1 <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#is_tag">is_tag</a></span>, <span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">try</span> <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_eqb">tag_eqb</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_eqb_eq">tag_eqb_eq</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">IHl</span> <span class="kwd">in</span> <span class="id">HH1</span> <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hinv</span> &amp; <span class="id">Hv</span> &amp;?&amp;?); <span class="id">inv</span> <span class="id">Hinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hv</span> <span class="kwd">in</span> *; <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">repeat</span> <span class="id">split</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase_pres_abs">fcase_pres_abs</a></span> <span class="kwd">in</span> <span class="id">HH1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">repeat</span> <span class="id">split</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="id">eauto</span>; <span class="id">now</span> <span class="id">intros</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">IHl</span> <span class="kwd">in</span> <span class="id">HH1</span> <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hinv</span> &amp;?&amp;?&amp;?); <span class="id">inv</span> <span class="id">Hinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">repeat</span> <span class="id">split</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fcase_pres2">fcase_pres2</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span> * <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) <span class="id">c</span> <span class="id">d</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="id">j</span> <span class="id">c</span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#defcon2">defcon2</a></span> <span class="id">c</span> <span class="id">d</span>) <span class="id">l</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">vc</span> <span class="id">vd</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">vc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_of_val">tag_of_val</a></span> <span class="id">vc</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">d</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">vd</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">List.Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="kwd">exists</span> <span class="id">v</span>, <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>) <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists">List.Exists</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id">j</span> = <span class="id">i</span> /\ <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>) <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">List.Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id">j</span> &lt;&gt; <span class="id">i</span>) <span class="id">l</span> /\ <span class="id">vd</span> = <span class="id">v</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</span></div>
<div class="proofscript" id="proof71">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="kwd">as</span> [|[<span class="id">i</span> <span class="id">s1</span>][|[<span class="id">j</span> <span class="id">s2</span>]]]; <span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">Nnil</span> <span class="id">Hf</span>. <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">clear</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#is_tag">is_tag</a></span>, <span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">subst</span>; <span class="id">inv</span> <span class="id">Hf</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">cases</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_eqb_eq">tag_eqb_eq</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">subst</span>; <span class="id">eauto</span> 13.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#tag_eqb_neq">tag_eqb_neq</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">subst</span>; <span class="id">eauto</span> 13.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="kwd">at</span> 1, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#is_tag">is_tag</a></span>, <span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">subst</span>; <span class="id">try</span> <span class="id">congruence</span>; <span class="id">inv</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Ã©crasÃ©&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_eqb_eq">tag_eqb_eq</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHl</span> <span class="kwd">in</span> <span class="id">HH1</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?); <span class="id">subst</span>; <span class="id">try</span> <span class="id">congruence</span>; <span class="id">eauto</span> 13.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;error_Ty,&nbsp;impossible&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">HH1</span>; <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="kwd">at</span> 1 <span class="kwd">in</span> <span class="id">HH1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">subst</span>; <span class="id">inv</span> <span class="id">HH1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">cases</span>; <span class="id">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">induction</span> <span class="id">l</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">cases</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="kwd">at</span> 1, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#is_tag">is_tag</a></span>, <span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> <span class="kwd">in</span> <span class="id">HH2</span>; <span class="id">cases</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;plus&nbsp;tard&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#tag_eqb_neq">tag_eqb_neq</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHl</span> <span class="kwd">in</span> <span class="id">HH1</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp; <span class="id">FE</span>); <span class="id">subst</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">FE</span> <span class="kwd">as</span> [|[]]; <span class="id">subst</span>; <span class="id">eauto</span> 12.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">esplit</span>; <span class="id">eauto</span>; <span class="id">right</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fcase_pres_ok">fcase_pres_ok</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span>) (<span class="id">ss</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) <span class="id">vt</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_of_val">tag_of_val</a></span> <span class="id">vt</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">i</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) <span class="id">ss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">ss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">i</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">v</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="id">j</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">vt</span>) <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Ty">error_Ty</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">ss</span>) = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof72')">Proof.</span></div>
<div class="proofscript" id="proof72">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hv</span> <span class="id">Hf</span> <span class="id">Hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">enough</span> ((<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">i</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">v</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span>  <span class="id">j</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">vt</span>) <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Ty">error_Ty</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">ss</span>) = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ ((<span class="kwd">exists</span> <span class="id">v</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="id">j</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">vt</span>) <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Ty">error_Ty</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">ss</span>) = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="id">j</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">vt</span>) <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Ty">error_Ty</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">ss</span>) = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#err">err</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#error_Ty">error_Ty</a></span>))); [ <span class="id">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">dependent</span> <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="kwd">as</span> [|<span class="id">j</span> <span class="id">l</span>]; <span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">Hf</span> <span class="id">Hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">split</span>; <span class="id">eauto</span>; <span class="id">tauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ss</span> <span class="kwd">as</span> [|[] <span class="id">ss</span>]; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">Hf</span>; <span class="id">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHl</span> <span class="id">ss</span>) <span class="kwd">as</span> [<span class="id">Hfin</span> <span class="id">Hfnin</span>]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="kwd">at</span> 1; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hv</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [|<span class="id">Hin</span>]; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#tag_eqb_refl">tag_eqb_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hfnin</span> <span class="kwd">as</span> [[]|]; <span class="id">cases</span>; <span class="id">try</span> <span class="id">congruence</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">Hfin</span> <span class="kwd">as</span> (?&amp; -&gt;); <span class="id">cases</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="kwd">at</span> 1 3, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#is_tag">is_tag</a></span>, <span class="id"><a href="Velus.Common.Common.html#or_default">or_default</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hfnin</span> <span class="kwd">as</span> [[? -&gt;]| -&gt;]; <span class="id">cases_eqn</span> <span class="id">HH</span>; <span class="id">subst</span>; <span class="id">eauto</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fcase_def_pres_ok">fcase_def_pres_ok</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span>) (<span class="id">ss</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)) <span class="id">vt</span> <span class="id">vd</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.tag_of_val">tag_of_val</a></span> <span class="id">vt</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">i</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) <span class="id">ss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">v</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="id">j</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">vt</span>) <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">vd</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">ss</span>) = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#pres">pres</a></span> <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</span></div>
<div class="proofscript" id="proof73">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span>; <span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">Ht</span> <span class="id">Hf</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ss</span> <span class="kwd">as</span> [|[] <span class="id">ss</span>]; <span class="id">inv</span> <span class="id">Hf</span>; <span class="id">try</span> <span class="id">tauto</span>; <span class="id">simpl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="kwd">at</span> 1; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Ht</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">IHl</span> <span class="kwd">as</span> (?&amp; -&gt;); <span class="id">cases</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fcase_abs_ok">fcase_abs_ok</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.enumtag">enumtag</a></span>) (<span class="id">ss</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.A">A</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>) <span class="id">ss</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> '(<span class="id">j</span>, <span class="id">x</span>) =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#fcase">fcase</a></span> <span class="id">j</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> <span class="id">x</span>) <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span> <span class="id">ss</span>) = <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#abs">abs</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</span></div>
<div class="proofscript" id="proof74">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span>; <span class="id">intros</span> * <span class="id">Heq</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ss</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Heq</span>; <span class="id">subst</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">IHl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case.fcase_spec">fcase_spec</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Opaque</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#scase">scase</a></span>.<br/>
<br/>
<div class="doc">In this section we use the same function to denote the merge and
      case operators. Notably, we do not try to detect all errors (wrong clocks,
      error in sub-expressions, etc.).
      It gives a nice definition with functional environments but is is very
      unlikely to work well in proofs of SDtoRel.
question lÃ©gitime : pourquoi on ne ferait pas comme Ã§a ?
      c'est pÃ©nible pour les raisonnements plus tard (pas d'inversion possible)
      mais c'est plus simple Ã  exprimer ici, et le rÃ©sultat final devrait Ãªtre
      le mÃªme : si bien cadencÃ©, alors on a la sÃ©mantique relationnelle.
      Le fait que sbinop/swhen produise des erreurs parce qu'il n'y a pas le
      choix justifie-t-il la production d'erreurs dans le merge/case ?
      -&gt; "pour faire pareil" n'est sans doute pas un bon argument
   </div>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions.When_Case">When_Case</a></span>.<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SStream_functions">SStream_functions</a></span>.<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Sreset">Sreset</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">I</span> <span class="id">A</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="SI">SI</a></span> := <span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Sreset.I">I</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sampl">sampl</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Sreset.A">A</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="sresetf_aux">sresetf_aux</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span>) -<span class="id">C</span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 4 <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">_</span> (<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">reset</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">f</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">R</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">X</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">Y</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> <span class="id">_</span> @2<span class="id">_</span> <span class="id">_</span>) <span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>; <span class="id">intro</span> <span class="id">r</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span> (<span class="id">_</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">r</span> <span class="id">eqn</span>:?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> <span class="id">_</span> <span class="id">x</span> @<span class="id">_</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> <span class="id">_</span> <span class="id">_</span> @5<span class="id">_</span> <span class="id">reset</span>) <span class="id">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> <span class="id">_</span> @<span class="id">_</span> <span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> <span class="id">_</span> <span class="id">_</span> @2<span class="id">_</span> <span class="id">f</span>) <span class="id">X</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP">APP</a></span> <span class="id">_</span> @2<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> <span class="id">_</span> <span class="id">x</span> @<span class="id">_</span> <span class="id">Y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> <span class="id">_</span> <span class="id">x</span> @<span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> <span class="id">_</span> <span class="id">_</span> @5<span class="id">_</span> <span class="id">reset</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> <span class="id">_</span> @<span class="id">_</span> <span class="id">R</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> @<span class="id">_</span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> @<span class="id">_</span> <span class="id">Y</span>)))).<br/>
&nbsp;&nbsp;Defined.
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="sresetf_aux_eq">sresetf_aux_eq</a></span> : <span class="kwd">forall</span> <span class="id">F</span> <span class="id">f</span> <span class="id">r</span> <span class="id">R</span> <span class="id">X</span> <span class="id">Y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sresetf_aux">sresetf_aux</a></span> <span class="id">F</span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">r</span> <span class="id">R</span>) <span class="id">X</span> <span class="id">Y</span> ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">F</span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">R</span>) <span class="id">X</span> (<span class="id">f</span> <span class="id">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">Y</span> (<span class="id">F</span> <span class="id">f</span> <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">Y</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</span></div>
<div class="proofscript" id="proof75">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sresetf_aux">sresetf_aux</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 4 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#curry_Curry">curry_Curry</a></span>, 4 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Curry_simpl">Curry_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR_simpl">Dprodi_DISTR_simpl</a></span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_fam">DS_fam</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2_simpl">fcont_comp2_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#ford_fcont_shift_simpl">ford_fcont_shift_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST_simpl">FST_simpl</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Fst_simpl">Fst_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND_simpl">SND_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Snd_simpl">Snd_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">_</span>); <span class="id">simpl</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases</span>; <span class="id">cbn</span>; <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_sresetf_aux">is_cons_sresetf_aux</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">f</span> <span class="id">R</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sresetf_aux">sresetf_aux</a></span> <span class="id">F</span> <span class="id">f</span> <span class="id">R</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">R</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</span></div>
<div class="proofscript" id="proof76">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sresetf_aux">sresetf_aux</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_is_cons">DScase_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="sreset_aux">sreset_aux</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sresetf_aux">sresetf_aux</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="sreset_aux_eq">sreset_aux_eq</a></span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">r</span> <span class="id">R</span> <span class="id">X</span> <span class="id">Y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux">sreset_aux</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">r</span> <span class="id">R</span>) <span class="id">X</span> <span class="id">Y</span> ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux">sreset_aux</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">R</span>) <span class="id">X</span> (<span class="id">f</span> <span class="id">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">Y</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux">sreset_aux</a></span> <span class="id">f</span> <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">Y</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</span></div>
<div class="proofscript" id="proof77">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Heq</span>:=<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sresetf_aux">sresetf_aux</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sresetf_aux_eq">sresetf_aux_eq</a></span>, &lt;- <span class="id">Heq</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="sreset_aux_bot">sreset_aux_bot</a></span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">X</span> <span class="id">Y</span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux">sreset_aux</a></span> <span class="id">f</span> 0 <span class="id">X</span> <span class="id">Y</span> == 0.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof78')">Proof.</span></div>
<div class="proofscript" id="proof78">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux">sreset_aux</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DScase_bot_eq">DScase_bot_eq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_sreset_aux">is_cons_sreset_aux</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">R</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux">sreset_aux</a></span> <span class="id">f</span> <span class="id">R</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">R</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof79')">Proof.</span></div>
<div class="proofscript" id="proof79">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux">sreset_aux</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_is_cons">DScase_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="take_sreset_aux_false">take_sreset_aux_false</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">f</span> <span class="id">R</span> (<span class="id">X</span> <span class="id">Y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">R</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux">sreset_aux</a></span> <span class="id">f</span> <span class="id">R</span> <span class="id">X</span> <span class="id">Y</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> <span class="id">Y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof80')">Proof.</span></div>
<div class="proofscript" id="proof80">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span> * <span class="id">Heq</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)), <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">R</span>) <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">R</span>' &amp; <span class="id">Hr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Heq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hr</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux_eq">sreset_aux_eq</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Heq</span> <span class="kwd">as</span> []; <span class="id">subst</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_eq">take_env_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)), <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_app_env">app_app_env</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- (<span class="id">IHn</span> <span class="id">f</span> <span class="id">R</span>' (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>)) <span class="kwd">at</span> 2; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_rem_take_env">app_rem_take_env</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="sreset">sreset</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#SI">SI</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">_</span> (<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dprod">Dprod</a></span> ?<span class="id">pl</span> ?<span class="id">pr</span>) <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">f</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">R</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">pl</span> <span class="id">pr</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">X</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">pl</span> <span class="id">pr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> ((<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux">sreset_aux</a></span> @4<span class="id">_</span> <span class="id">f</span>) <span class="id">R</span> <span class="id">X</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#AP">AP</a></span> <span class="id">_</span> <span class="id">_</span> @2<span class="id">_</span> <span class="id">f</span>) <span class="id">X</span>)).<br/>
&nbsp;&nbsp;Defined.
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="sreset_eq">sreset_eq</a></span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">R</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset">sreset</a></span> <span class="id">f</span> <span class="id">R</span> <span class="id">X</span> == <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset_aux">sreset_aux</a></span> <span class="id">f</span> <span class="id">R</span> <span class="id">X</span> (<span class="id">f</span> <span class="id">X</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof81')">Proof.</span></div>
<div class="proofscript" id="proof81">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset">sreset</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">localdb</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#Sreset">Sreset</a></span>.<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Opaque</span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sresetf_aux">sresetf_aux</a></span> <span class="id"><a href="Velus.Lustre.Denot.SDfuns.html#sreset">sreset</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
