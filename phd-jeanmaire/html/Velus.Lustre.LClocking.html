
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module LClocking</title>
<meta name="description" content="Documentation of Coq module LClocking" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module LClocking</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.CommonProgram.html">CommonProgram</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.CommonTyping.html">CommonTyping</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Environment.html">Environment</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Operators.html">Operators</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Clocks.html">Clocks</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.FunctionalEnvironment.html">FunctionalEnvironment</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.StaticEnv.html">Lustre.StaticEnv</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.LSyntax.html">Lustre.LSyntax</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#ListNotations">List.ListNotations</a></span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html">Permutation</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Program.Basics.html">Program.Basics</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Program.Wf.html">Program.Wf</a></span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">program_scope</span>.<br/>
<br/>
<h1> Lustre clocking </h1>
<br/>
<br/>
<span class="kwd">Module</span> <span class="kwd">Type</span> <span class="id"><a name="LCLOCKING">LCLOCKING</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ids</span>   : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Op</span>    : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Cks</span>   : <span class="id"><a href="Velus.Clocks.html#CLOCKS">CLOCKS</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Senv</span>  : <span class="id"><a href="Velus.Lustre.StaticEnv.html#STATICENV">STATICENV</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Syn</span>   : <span class="id"><a href="Velus.Lustre.LSyntax.html#LSYNTAX">LSYNTAX</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Senv">Senv</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.ident_map">ident_map</a></span> := <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.WellInstantiated">WellInstantiated</a></span> (<span class="id">bck</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) (<span class="id">sub</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ident_map">ident_map</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xc</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) (<span class="id">nc</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.nclock">nclock</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sub</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">xc</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">nc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.instck">instck</a></span> <span class="id">bck</span> <span class="id">sub</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">xc</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">nc</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="LCLOCKING.WellClocked">WellClocked</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">PSyn</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.decl">decl</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.block">block</a></span> -&gt; <span class="kwd">Prop</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">prefs</span> : <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="LCLOCKING.WellClocked.G">G</a></span> : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellClocked.PSyn">PSyn</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellClocked.prefs">prefs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> Γ : <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.static_env">static_env</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCLOCKING.wc_exp">wc_exp</a></span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.exp">exp</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Econst">wc_Econst</a></span>: <span class="kwd">forall</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Econst">Econst</a></span> <span class="id">c</span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Eenum">wc_Eenum</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Eenum">Eenum</a></span> <span class="id">x</span> <span class="id">ty</span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Evar">wc_Evar</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Evar">Evar</a></span> <span class="id">x</span> (<span class="id">ty</span>, <span class="id">ck</span>))<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Elast">wc_Elast</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Elast">Elast</a></span> <span class="id">x</span> (<span class="id">ty</span>, <span class="id">ck</span>))<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Eunop">wc_Eunop</a></span>: <span class="kwd">forall</span> <span class="id">op</span> <span class="id">e</span> <span class="id">ty</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = [<span class="id">ck</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Eunop">Eunop</a></span> <span class="id">op</span> <span class="id">e</span> (<span class="id">ty</span>, <span class="id">ck</span>))<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Ebinop">wc_Ebinop</a></span>: <span class="kwd">forall</span> <span class="id">op</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">ty</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> <span class="id">e1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> <span class="id">e2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e1</span> = [<span class="id">ck</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e2</span> = [<span class="id">ck</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Ebinop">Ebinop</a></span> <span class="id">op</span> <span class="id">e1</span> <span class="id">e2</span> (<span class="id">ty</span>, <span class="id">ck</span>))<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Eextcall">wc_Eextcall</a></span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">es</span> <span class="id">tyout</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">wc_exp</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id">ck</span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Eextcall">Eextcall</a></span> <span class="id">f</span> <span class="id">es</span> (<span class="id">tyout</span>, <span class="id">ck</span>))<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Efby">wc_Efby</a></span>: <span class="kwd">forall</span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">anns</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">wc_exp</span> <span class="id">e0s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">wc_exp</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">anns</span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">e0s</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">anns</span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Efby">Efby</a></span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">anns</span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Earrow">wc_Earrow</a></span>: <span class="kwd">forall</span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">anns</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">wc_exp</span> <span class="id">e0s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">wc_exp</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">anns</span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">e0s</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">anns</span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Earrow">Earrow</a></span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">anns</span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Ewhen">wc_Ewhen</a></span>: <span class="kwd">forall</span> <span class="id">es</span> <span class="id">x</span> <span class="id">tx</span> <span class="id">ty</span> <span class="id">b</span> <span class="id">tys</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">wc_exp</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id">ck</span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tys</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Ewhen">Ewhen</a></span> <span class="id">es</span> (<span class="id">x</span>, <span class="id">tx</span>) <span class="id">b</span> (<span class="id">tys</span>, (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Con">Con</a></span> <span class="id">ck</span> <span class="id">x</span> (<span class="id">ty</span>, <span class="id">b</span>))))<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Emerge">wc_Emerge</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">tx</span> <span class="id">es</span> <span class="id">tys</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">es</span> &lt;&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">wc_exp</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>)) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">es</span>) =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Con">Con</a></span> <span class="id">ck</span> <span class="id">x</span> (<span class="id">tx</span>, <span class="id">i</span>))) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span>)) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tys</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>))) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Emerge">Emerge</a></span> (<span class="id">x</span>, <span class="id">tx</span>) <span class="id">es</span> (<span class="id">tys</span>, <span class="id">ck</span>))<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Ecase">wc_Ecase</a></span>: <span class="kwd">forall</span> <span class="id">e</span> <span class="id">es</span> <span class="id">d</span> <span class="id">tys</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = [<span class="id">ck</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">es</span> &lt;&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">wc_exp</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>)) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id">ck</span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>))) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tys</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>))) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">d0</span>, <span class="id">d</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d0</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">wc_exp</span> <span class="id">d0</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">d0</span>, <span class="id">d</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d0</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id">ck</span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">d0</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">d0</span>, <span class="id">d</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d0</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tys</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">d0</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Ecase">Ecase</a></span> <span class="id">e</span> <span class="id">es</span> <span class="id">d</span> (<span class="id">tys</span>, <span class="id">ck</span>))<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Eapp">wc_Eapp</a></span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">es</span> <span class="id">er</span> <span class="id">anns</span> <span class="id">n</span> <span class="id">bck</span> <span class="id">sub</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">wc_exp</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">wc_exp</span> <span class="id">er</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellClocked.G">G</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span> <span class="id">sub</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>)) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclocksof">nclocksof</a></span> <span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span> <span class="id">sub</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">ck</span>) =&gt; (<span class="id">ck</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)) <span class="id">anns</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">exists</span> <span class="id">ck</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = [<span class="id">ck</span>]) <span class="id">er</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_exp</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Eapp">Eapp</a></span> <span class="id">f</span> <span class="id">es</span> <span class="id">er</span> <span class="id">anns</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCLOCKING.wc_equation">wc_equation</a></span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.equation">equation</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_EqApp">wc_EqApp</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">f</span> <span class="id">es</span> <span class="id">er</span> <span class="id">anns</span> <span class="id">n</span> <span class="id">bck</span> <span class="id">sub</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">er</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellClocked.G">G</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span> <span class="id">sub</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>)) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclocksof">nclocksof</a></span> <span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#Forall3">Forall3</a></span> (<span class="kwd">fun</span> <span class="id">xck</span> <span class="id">ck2</span> <span class="id">x2</span> =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">xck</span> (<span class="id">ck2</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x2</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">anns</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">exists</span> <span class="id">ck</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = [<span class="id">ck</span>]) <span class="id">er</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ) <span class="id">xs</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">anns</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_equation</span> (<span class="id">xs</span>, [<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Eapp">Eapp</a></span> <span class="id">f</span> <span class="id">es</span> <span class="id">er</span> <span class="id">anns</span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Eq">wc_Eq</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ) <span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_equation</span> (<span class="id">xs</span>, <span class="id">es</span>).<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellClocked">WellClocked</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCLOCKING.wc_scope">wc_scope</a></span> {<span class="id">A</span>} (<span class="id">P_wc</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.static_env">static_env</a></span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) : <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.static_env">static_env</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.scope">scope</a></span> <span class="id">A</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Scope">wc_Scope</a></span> : <span class="kwd">forall</span> Γ <span class="id">locs</span> <span class="id">blks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> Γ' := Γ ++ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">locs</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span> Γ')) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">_</span>)) =&gt; <span class="id">ck</span>) <span class="id">locs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_wc</span> Γ' <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_scope</span> <span class="id">P_wc</span> <span class="id">G</span> Γ (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCLOCKING.wc_branch">wc_branch</a></span> {<span class="id">A</span>} (<span class="id">P_wc</span> : <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) : <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.branch">branch</a></span> <span class="id">A</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Branch">wc_Branch</a></span> : <span class="kwd">forall</span> <span class="id">caus</span> <span class="id">blks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_wc</span> <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_branch</span> <span class="id">P_wc</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Branch">Branch</a></span> <span class="id">caus</span> <span class="id">blks</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCLOCKING.wc_block">wc_block</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) : <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.static_env">static_env</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.block">block</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Beq">wc_Beq</a></span> : <span class="kwd">forall</span> Γ <span class="id">eq</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_equation">wc_equation</a></span> <span class="id">G</span> Γ <span class="id">eq</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_block</span> <span class="id">G</span> Γ (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Beq">Beq</a></span> <span class="id">eq</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Blast">wc_Blast</a></span>: <span class="kwd">forall</span> Γ <span class="id">x</span> <span class="id">e</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">G</span> Γ <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = [<span class="id">ck</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_block</span> <span class="id">G</span> Γ (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Blast">Blast</a></span> <span class="id">x</span> <span class="id">e</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Breset">wc_Breset</a></span> : <span class="kwd">forall</span> Γ <span class="id">blocks</span> <span class="id">er</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id">wc_block</span> <span class="id">G</span> Γ) <span class="id">blocks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">G</span> Γ <span class="id">er</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">er</span> = [<span class="id">ck</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_block</span> <span class="id">G</span> Γ (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Breset">Breset</a></span> <span class="id">blocks</span> <span class="id">er</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Bswitch">wc_Bswitch</a></span> : <span class="kwd">forall</span> Γ Γ' <span class="id">ec</span> <span class="id">branches</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">G</span> Γ <span class="id">ec</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">ec</span> = [<span class="id">ck</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">branches</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>', <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ' <span class="id">x</span> <span class="id">ck</span>' -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span> /\ <span class="id">ck</span>' = <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ' <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">blks</span> =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_branch">wc_branch</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id">wc_block</span> <span class="id">G</span> Γ')) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">blks</span>)) <span class="id">branches</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_block</span> <span class="id">G</span> Γ (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Bswitch">Bswitch</a></span> <span class="id">ec</span> <span class="id">branches</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Bauto">wc_Bauto</a></span> : <span class="kwd">forall</span> Γ Γ' <span class="id">type</span> <span class="id">ini</span> <span class="id">oth</span> <span class="id">states</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span> Γ) <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">states</span> &lt;&gt; [] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>', <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ' <span class="id">x</span> <span class="id">ck</span>' -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span> /\ <span class="id">ck</span>' = <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ' <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">G</span> Γ' <span class="id">e</span> /\ <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = [<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>]) <span class="id">ini</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">blks</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_branch">wc_branch</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">blks</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, (<span class="id">t</span>, <span class="id">_</span>)) =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">G</span> Γ' <span class="id">e</span> /\ <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = [<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>]) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">blks</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_scope">wc_scope</a></span> (<span class="kwd">fun</span> Γ' <span class="id">blks</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id">wc_block</span> <span class="id">G</span> Γ') (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">blks</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, (<span class="id">t</span>, <span class="id">_</span>)) =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">G</span> Γ' <span class="id">e</span> /\ <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = [<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>]) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">blks</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">G</span> Γ' (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">blks</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">blks</span>)) <span class="id">states</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_block</span> <span class="id">G</span> Γ (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Bauto">Bauto</a></span> <span class="id">type</span> <span class="id">ck</span> (<span class="id">ini</span>, <span class="id">oth</span>) <span class="id">states</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Blocal">wc_Blocal</a></span> : <span class="kwd">forall</span> Γ <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_scope">wc_scope</a></span> (<span class="kwd">fun</span> Γ' =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id">wc_block</span> <span class="id">G</span> Γ')) <span class="id">G</span> Γ <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_block</span> <span class="id">G</span> Γ (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Blocal">Blocal</a></span> <span class="id">s</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCLOCKING.wc_node">wc_node</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.node">node</a></span> <span class="id">PSyn</span> <span class="id">prefs</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.wc_Node">wc_Node</a></span> : <span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>) ++ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_block">wc_block</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.senv_of_ins">senv_of_ins</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>) ++ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span>)) <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_block">n_block</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wc_node</span> <span class="id">G</span> <span class="id">n</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.wc_global">wc_global</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonTyping.html#wt_program">wt_program</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_node">wc_node</a></span>.<br/>
<br/>
<h2> Basic properties of clocking </h2>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id"><a href="Velus.Lustre.LClocking.html#wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#wc_equation">wc_equation</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#wc_block">wc_block</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#wc_node">wc_node</a></span> : <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_global">wc_global</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> : <span class="id">lclocking</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">inv_exp</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">inv_scope</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_scope">wc_scope</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_conjs</span>; <span class="id">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">inv_branch</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_branch">wc_branch</a></span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_conjs</span>; <span class="id">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">inv_block</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_block">wc_block</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_global_NoDup">wc_global_NoDup</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">g</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_global">wc_global</a></span> <span class="id">g</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_name">n_name</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nodes">nodes</a></span> <span class="id">g</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Wc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonTyping.html#wt_program_NoDup">wt_program_NoDup</a></span> <span class="kwd">in</span> <span class="id">Wc</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_find_node">wc_find_node</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">f</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">G</span>', <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_node">wc_node</a></span> <span class="id">G</span>' <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">G</span> <span class="id">f</span> <span class="id">n</span>' <span class="id">Hwc</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonTactics.html#option_map_inv">option_map_inv</a></span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> ((?&amp;?)&amp;(?&amp;?)); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonTyping.html#wt_program_find_unit">wt_program_find_unit</a></span> <span class="kwd">in</span> <span class="id">Hwc</span> <span class="kwd">as</span> (?&amp;?); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_global_cons">wc_global_cons</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tys</span> (<span class="id">nd</span> : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.node">node</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">nds</span> <span class="id">exts</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_global">wc_global</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Global">Global</a></span> <span class="id">tys</span> <span class="id">exts</span> (<span class="id">nd</span> :: <span class="id">nds</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_global">wc_global</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Global">Global</a></span> <span class="id">tys</span> <span class="id">exts</span> <span class="id">nds</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> 1; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_global_uncons">wc_global_uncons</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tys</span> (<span class="id">nd</span> : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.node">node</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">nds</span> <span class="id">exts</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_global">wc_global</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Global">Global</a></span> <span class="id">tys</span> <span class="id">exts</span> (<span class="id">nd</span> :: <span class="id">nds</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_node">wc_node</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Global">Global</a></span> <span class="id">tys</span> <span class="id">exts</span> <span class="id">nds</span>) <span class="id">nd</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Wc</span>. <span class="id">now</span> <span class="id">inversion</span> <span class="id">Wc</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="LCLOCKING.wc_exp_Proper">wc_exp_Proper</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (@<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.exp">exp</a></span> ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">G</span> <span class="id">G</span>' <span class="id">HG</span> <span class="id">env</span>' <span class="id">env</span> <span class="id">Henv</span> ?? <span class="id">He</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intro</span> <span class="id">H</span>; <span class="id">induction</span> <span class="id">y</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.exp_ind2">exp_ind2</a></span>; <span class="id">inv</span> <span class="id">H</span>; <span class="id">econstructor</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> <span class="id">env</span>' <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Henv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> <span class="id">env</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">now</span> <span class="id">rewrite</span> &lt;-<span class="id">Henv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> <span class="id">env</span>' <span class="id">_</span> =&gt; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Henv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> <span class="id">env</span> <span class="id">_</span> =&gt; <span class="id">now</span> <span class="id">rewrite</span> &lt;-<span class="id">Henv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock_incl">wc_clock_incl</a></span>; [|<span class="id">eauto</span>]; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span>; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Henv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">intros</span> * <span class="id">Heq</span>; <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">take</span> (<span class="kwd">forall</span> (<span class="id">d1</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.exp">exp</a></span>), <span class="id">_</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">_</span>) <span class="id">and</span> <span class="id">specialize</span> (<span class="id">it</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="LCLOCKING.wc_equation_Proper">wc_equation_Proper</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (@<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.equation">equation</a></span> ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_equation">wc_equation</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof6')">Proof with</span></div>
<div class="proofscript" id="proof6">
 <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">G1</span> <span class="id">G2</span> <span class="id">HG</span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">Henv</span> <span class="id">eq1</span> <span class="id">eq2</span> <span class="id">Heq</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">eq2</span> <span class="kwd">as</span> (<span class="id">xs</span> &amp; <span class="id">es</span>). <span class="id">split</span>; <span class="id">intros</span> []; <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1-10:<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> *; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1-10:(<span class="id">rewrite</span> <span class="id">Henv</span> <span class="kwd">in</span> * || <span class="id">rewrite</span> &lt;-<span class="id">Henv</span> <span class="kwd">in</span> * || <span class="id">idtac</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1-4:<span class="id">simpl_Forall</span>; (<span class="id">setoid_rewrite</span> <span class="id">Henv</span> || <span class="id">setoid_rewrite</span> &lt;-<span class="id">Henv</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="LCLOCKING.wc_block_Proper">wc_block_Proper</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (@<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.block">block</a></span> ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_block">wc_block</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof7')">Proof with</span></div>
<div class="proofscript" id="proof7">
 <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">G1</span> <span class="id">G2</span> <span class="id">HG</span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">Henv</span> <span class="id">d1</span> <span class="id">d2</span> <span class="id">Heq</span>; <span class="id">subst</span>. <span class="id">revert</span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">Henv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">d2</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">split</span>; <span class="id">intros</span> * <span class="id">Hwc</span>; <span class="id">inv</span> <span class="id">Hwc</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">all</span>:<span class="id">try</span> <span class="id">instantiate</span> (2:=Γ'); <span class="id">try</span> <span class="id">instantiate</span> (1:=Γ'). <span class="id">all</span>:<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">try</span> <span class="id">rewrite</span> &lt;-<span class="id">Henv</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">try</span> <span class="id">rewrite</span> <span class="id">Henv</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">simpl_Forall</span>; <span class="id">eauto</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">try</span> <span class="id">rewrite</span> &lt;-<span class="id">H</span>; <span class="id">try</span> <span class="id">rewrite</span> <span class="id">H</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span>; <span class="id">try</span> (<span class="id">rewrite</span> &lt;-<span class="id">Henv</span> || <span class="id">rewrite</span> <span class="id">Henv</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">inv</span> <span class="id">H2</span>; <span class="id">econstructor</span>; <span class="id">eauto</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">try</span> <span class="id">rewrite</span> &lt;-<span class="id">H</span>; <span class="id">try</span> <span class="id">rewrite</span> <span class="id">H</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span>; (<span class="id">rewrite</span> <span class="id">Henv</span>||<span class="id">rewrite</span> &lt;-<span class="id">Henv</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="LCLOCKING.wc_block_pointwise_Proper">wc_block_pointwise_Proper</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (@<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html#pointwise_relation">pointwise_relation</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_block">wc_block</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof8')">Proof with</span></div>
<div class="proofscript" id="proof8">
 <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">G1</span> <span class="id">G2</span> <span class="id">HG</span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">Henv</span> <span class="id">d</span>; <span class="id">subst</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Henv</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_env_Is_free_in_clock_In">wc_env_Is_free_in_clock_In</a></span> : <span class="kwd">forall</span> <span class="id">vars</span> <span class="id">x</span> <span class="id">id</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">x</span>, <span class="id">ck</span>) <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Is_free_in_clock">Is_free_in_clock</a></span> <span class="id">id</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">id</span> <span class="id">vars</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hwenv</span> <span class="id">Hin</span> <span class="id">Hfree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="kwd">in</span> <span class="id">Hwenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hin</span>; <span class="id">eauto</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">Hfree</span>; <span class="id">inv</span> <span class="id">Hin</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">wc_env_has_Cbase</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vars</span> <span class="id">x</span> <span class="id">xck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">x</span>, <span class="id">xck</span>) <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">y</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">y</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) <span class="id">vars</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">vars</span> <span class="id">x</span> <span class="id">xck</span> <span class="id">WC</span> <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x</span> <span class="id">Ix</span>. <span class="id">induction</span> <span class="id">xck</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">WC</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WC</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_env_has_Cbase">wc_env_has_Cbase</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vars</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">y</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">y</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) <span class="id">vars</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hwc</span> <span class="id">Hl</span>. <span class="id">destruct</span> <span class="id">vars</span>. <span class="id">now</span> <span class="id">inv</span> <span class="id">Hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">p</span>. <span class="id">eapply</span> <span class="id">wc_env_has_Cbase</span>'; <span class="id">eauto</span>. <span class="id">now</span> <span class="id">left</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.WellInstantiated_parent">WellInstantiated_parent</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">cks</span> <span class="id">lck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span> <span class="id">sub</span>) <span class="id">cks</span> <span class="id">lck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">ck</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ck</span> = <span class="id">bck</span> \/ <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock_parent">clock_parent</a></span> <span class="id">bck</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ck</span>)) <span class="id">lck</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>. <span class="id">intros</span> * <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Common.CommonList.html#Forall2_in_right">Forall2_in_right</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span> <span class="id">Hin</span>) <span class="kwd">as</span> (?&amp;?&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.instck_parent">instck_parent</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.WellInstantiated_bck">WellInstantiated_bck</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vars</span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">lck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span> <span class="id">sub</span>) <span class="id">vars</span> <span class="id">lck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">bck</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.stripname">stripname</a></span> <span class="id">lck</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Henv</span> <span class="id">Hlen</span> <span class="id">Wi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_env_has_Cbase">wc_env_has_Cbase</a></span> <span class="kwd">in</span> <span class="id">Henv</span> <span class="kwd">as</span> [<span class="id">x</span> <span class="id">Hin</span>]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Common.CommonList.html#Forall2_in_left">Forall2_in_left</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Wi</span> <span class="id">Hin</span>) <span class="kwd">as</span> (<span class="id">nc</span> &amp;?&amp;?&amp; <span class="id">He</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>. <span class="kwd">exists</span> <span class="id">nc</span>. <span class="id">destruct</span> <span class="id">nc</span>. <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">inv</span> <span class="id">He</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">Adding variables to the environment preserves clocking </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="LCLOCKING.incl">incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">PSyn</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.decl">decl</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.block">block</a></span> -&gt; <span class="kwd">Prop</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">prefs</span> : <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="LCLOCKING.incl.G">G</a></span> : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.incl.PSyn">PSyn</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.incl.prefs">prefs</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_exp_incl">wc_exp_incl</a></span> : <span class="kwd">forall</span> Γ Γ' <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ' <span class="id">x</span> <span class="id">ck</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.incl.G">G</a></span> Γ <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.incl.G">G</a></span> Γ' <span class="id">e</span> .<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof14')">Proof with</span></div>
<div class="proofscript" id="proof14">
 <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.exp_ind2">exp_ind2</a></span>; <span class="id">intros</span> <span class="id">Hincl1</span> <span class="id">Hincl2</span> <span class="id">Hwc</span>; <span class="id">inv</span> <span class="id">Hwc</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">econstructor</span>; <span class="id">simpl_Forall</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> ? <span class="id">Hin</span>; <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H11</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>). <span class="id">simpl_Forall</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_equation_incl">wc_equation_incl</a></span> : <span class="kwd">forall</span> Γ Γ' <span class="id">eq</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ' <span class="id">x</span> <span class="id">ck</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_equation">wc_equation</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.incl.G">G</a></span> Γ <span class="id">eq</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_equation">wc_equation</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.incl.G">G</a></span> Γ' <span class="id">eq</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof15')">Proof with</span></div>
<div class="proofscript" id="proof15">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ?? [<span class="id">xs</span> <span class="id">es</span>] <span class="id">Hincl1</span> <span class="id">Hincl2</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwc</span>; <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1-5:<span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp_incl">wc_exp_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_scope_incl">wc_scope_incl</a></span> {<span class="id">A</span>} <span class="id">P_wc</span> : <span class="kwd">forall</span> Γ Γ' <span class="id">locs</span> (<span class="id">blks</span>: <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ' <span class="id">x</span> <span class="id">ck</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_scope">wc_scope</a></span> <span class="id">P_wc</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.incl.G">G</a></span> Γ (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ Γ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ' <span class="id">x</span> <span class="id">ck</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_wc</span> Γ <span class="id">blks</span> -&gt; <span class="id">P_wc</span> Γ' <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_scope">wc_scope</a></span> <span class="id">P_wc</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.incl.G">G</a></span> Γ' (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Incl1</span> <span class="id">Incl2</span> <span class="id">Wt</span> <span class="id">Hind</span>; <span class="id">inv</span> <span class="id">Wt</span>; <span class="id">subst</span> Γ'0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock_incl">wc_clock_incl</a></span>; <span class="id">eauto</span>. <span class="id">simpl_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ? <span class="id">Hin</span>. <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> *. <span class="id">destruct</span> <span class="id">Hin</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">simpl_In</span>. <span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ' <span class="id">i2</span> <span class="id">a0</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.clo">clo</a></span>)) <span class="kwd">by</span> <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>; <span class="id">solve_In</span>. <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id">Hind</span>; [| |<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">repeat</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock_app">HasClock_app</a></span>. <span class="id">intros</span> * [|]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">repeat</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast_app">IsLast_app</a></span>. <span class="id">intros</span> * [|]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_block_incl">wc_block_incl</a></span> : <span class="kwd">forall</span> <span class="id">d</span> Γ Γ',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ' <span class="id">x</span> <span class="id">ck</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ' <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_block">wc_block</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.incl.G">G</a></span> Γ <span class="id">d</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_block">wc_block</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.incl.G">G</a></span> Γ' <span class="id">d</span> .<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">d</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">Incl1</span> <span class="id">Incl2</span> <span class="id">Wt</span>; <span class="id">inv</span> <span class="id">Wt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>. <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_equation_incl">wc_equation_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp_incl">wc_exp_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp_incl">wc_exp_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_Bswitch">wc_Bswitch</a></span> <span class="kwd">with</span> (Γ':=Γ'0); <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp_incl">wc_exp_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">edestruct</span> <span class="id">H5</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_Bauto">wc_Bauto</a></span> <span class="kwd">with</span> (Γ':=Γ'0); <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp_incl">wc_exp_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock_incl">wc_clock_incl</a></span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ??; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">i0</span> <span class="id">a0</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.clo">clo</a></span>)) <span class="kwd">as</span> <span class="id">Hck</span> <span class="kwd">by</span> (<span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Incl1</span> <span class="kwd">in</span> <span class="id">Hck</span>. <span class="id">inv</span> <span class="id">Hck</span>. <span class="id">solve_In</span>. <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span>. <span class="id">edestruct</span> <span class="id">H7</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_scope_incl">wc_scope_incl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.incl">incl</a></span>.<br/>
<br/>
<h2> Validation </h2>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="LCLOCKING.ValidateExpression">ValidateExpression</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">PSyn</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.decl">decl</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.block">block</a></span> -&gt; <span class="kwd">Prop</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">prefs</span> : <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="LCLOCKING.ValidateExpression.G">G</a></span> : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.PSyn">PSyn</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.prefs">prefs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="LCLOCKING.ValidateExpression.venv">venv</a></span> <span class="id"><a name="LCLOCKING.ValidateExpression.venvl">venvl</a></span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="LCLOCKING.ValidateExpression.env">env</a></span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.static_env">static_env</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCLOCKING.ValidateExpression.Henv">Henv</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.venv">venv</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ck</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span> <span class="id">x</span> <span class="id">ck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCLOCKING.ValidateExpression.Henvl">Henvl</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.venvl">venvl</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ck</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span> <span class="id">x</span> <span class="id">ck</span> /\ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span> <span class="id">x</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">option_monad_scope</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.check_var">check_var</a></span> (<span class="id">x</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id">ck</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.venv">venv</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xc</span> =&gt; <span class="id">ck</span> ==<span class="id">b</span> <span class="id">xc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.check_last">check_last</a></span> (<span class="id">x</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id">ck</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.venvl">venvl</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xc</span> =&gt; <span class="id">ck</span> ==<span class="id">b</span> <span class="id">xc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.check_paired_clocks">check_paired_clocks</a></span> (<span class="id">nc1</span> <span class="id">nc2</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) (<span class="id">tc</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.ann">ann</a></span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">tc</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id">t</span>, <span class="id">c</span>) =&gt; (<span class="id">nc1</span> ==<span class="id">b</span> <span class="id">c</span>) &amp;&amp; (<span class="id">nc2</span> ==<span class="id">b</span> <span class="id">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.check_merge_clocks">check_merge_clocks</a></span> {<span class="id">A</span>} (<span class="id">x</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id">tx</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Op.type">type</a></span>) (<span class="id">ck</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) (<span class="id">ncs</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>)) (<span class="id">n</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">tys</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">ncs</span>) =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="kwd">fun</span> <span class="id">ck</span>' =&gt; <span class="id">ck</span>' ==<span class="id">b</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Con">Con</a></span> <span class="id">ck</span> <span class="id">x</span> (<span class="id">tx</span>, <span class="id">i</span>))) <span class="id">ncs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">ncs</span> ==<span class="id">b</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tys</span>)) <span class="id">ncs</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.check_case_clocks">check_case_clocks</a></span> {<span class="id">A</span>} (<span class="id">ck</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) (<span class="id">ncs</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>)) (<span class="id">tys</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="kwd">fun</span> <span class="id">ncs</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="kwd">fun</span> <span class="id">ck</span>' =&gt; <span class="id">ck</span>' ==<span class="id">b</span> <span class="id">ck</span>) <span class="id">ncs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">ncs</span> ==<span class="id">b</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tys</span>)) <span class="id">ncs</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.add_isub">add_isub</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sub</span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">nin</span> : (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * (<span class="id"><a href="Velus.Lustre.LClocking.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">nc</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.nclock">nclock</a></span>) : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">nc</span>, <span class="id">nin</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span>, (<span class="id">x</span>, (<span class="id">xt</span>, <span class="id">xc</span>, <span class="id">xcaus</span>)) =&gt; <span class="id"><a href="Velus.Environment.html#Env.add">Env.add</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">sub</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id">_</span> =&gt; <span class="id">sub</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.add_osub">add_osub</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sub</span>  : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">nout</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.decl">decl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">tnc</span>  : <span class="id"><a href="Velus.Lustre.LClocking.html#Op.type">type</a></span> * <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.nclock">nclock</a></span>) : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">x</span>, (<span class="id">ty</span>, <span class="id">ck</span>, <span class="id">cx</span>, <span class="id">_</span>)) := <span class="id">nout</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_isub">add_isub</a></span> <span class="id">sub</span> (<span class="id">x</span>, (<span class="id">ty</span>, <span class="id">ck</span>, <span class="id">cx</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">tnc</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="LCLOCKING.ValidateExpression.CheckInst">CheckInst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variables</span> (<span class="id"><a name="LCLOCKING.ValidateExpression.CheckInst.bck">bck</a></span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) (<span class="id"><a name="LCLOCKING.ValidateExpression.CheckInst.sub">sub</a></span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="LCLOCKING.check_inst">check_inst</a></span> (<span class="id">ick</span> <span class="id">ck</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ick</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span> =&gt; (<span class="id">ck</span> ==<span class="id">b</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.CheckInst.bck">bck</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Con">Con</a></span> <span class="id">ick</span>' <span class="id">x</span> <span class="id">xb</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ck</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.CheckInst.sub">sub</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Con">Con</a></span> <span class="id">ck</span>' <span class="id">y</span> <span class="id">yb</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sx</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">yb</span> ==<span class="id">b</span> <span class="id">xb</span>) &amp;&amp; (<span class="id">y</span> ==<span class="id">b</span> <span class="id">sx</span>) &amp;&amp; (<span class="id">check_inst</span> <span class="id">ick</span>' <span class="id">ck</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.CheckInst">CheckInst</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="LCLOCKING.find_base_clock">find_base_clock</a></span> (<span class="id">ick</span> <span class="id">ck</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ick</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ck</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Con">Con</a></span> <span class="id">ick</span>' <span class="id">_</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ck</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Con">Con</a></span> <span class="id">ck</span>' <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">find_base_clock</span> <span class="id">ick</span>' <span class="id">ck</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.check_reset">check_reset</a></span> (<span class="id">ckr</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>)) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="kwd">fun</span> <span class="id">cks</span> =&gt; <span class="kwd">match</span> <span class="id">cks</span> <span class="kwd">with</span> [<span class="id">ck</span>] =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> | <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="kwd">end</span>) <span class="id">ckr</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.nclockof_clockof">nclockof_clockof</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclockof">nclockof</a></span> <span class="id">e</span> = <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ys</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = <span class="id">ys</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">e</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">NC</span> <span class="id">Hys</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof_nclockof">clockof_nclockof</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="LCLOCKING.check_exp">check_exp</a></span> (<span class="id">e</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.exp">exp</a></span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Econst">Econst</a></span> <span class="id">c</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> [<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>]<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Eenum">Eenum</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> [<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>]<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Evar">Evar</a></span> <span class="id">x</span> (<span class="id">xt</span>, <span class="id">xc</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_var">check_var</a></span> <span class="id">x</span> <span class="id">xc</span>) <span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> [<span class="id">xc</span>] <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Elast">Elast</a></span> <span class="id">x</span> (<span class="id">xt</span>, <span class="id">xc</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_last">check_last</a></span> <span class="id">x</span> <span class="id">xc</span>) <span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> [<span class="id">xc</span>] <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Eunop">Eunop</a></span> <span class="id">op</span> <span class="id">e</span> (<span class="id">xt</span>, <span class="id">xc</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">nce</span> &lt;- <span class="id"><a href="Velus.Common.CommonList.html#assert_singleton">assert_singleton</a></span> (<span class="id">check_exp</span> <span class="id">e</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">xc</span> ==<span class="id">b</span> <span class="id">nce</span> <span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> [<span class="id">xc</span>] <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Ebinop">Ebinop</a></span> <span class="id">op</span> <span class="id">e1</span> <span class="id">e2</span> (<span class="id">xt</span>, <span class="id">xc</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">nc1</span> &lt;- <span class="id"><a href="Velus.Common.CommonList.html#assert_singleton">assert_singleton</a></span> (<span class="id">check_exp</span> <span class="id">e1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">nc2</span> &lt;- <span class="id"><a href="Velus.Common.CommonList.html#assert_singleton">assert_singleton</a></span> (<span class="id">check_exp</span> <span class="id">e2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id">xc</span> ==<span class="id">b</span> <span class="id">nc1</span>) &amp;&amp; (<span class="id">xc</span> ==<span class="id">b</span> <span class="id">nc2</span>) <span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> [<span class="id">xc</span>] <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Eextcall">Eextcall</a></span> <span class="id">f</span> <span class="id">es</span> (<span class="id">_</span>, <span class="id">ck</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">ncs</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">check_exp</span> <span class="id">es</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="kwd">fun</span> <span class="id">ck</span>' =&gt; <span class="id">ck</span>' ==<span class="id">b</span> <span class="id">ck</span>) <span class="id">ncs</span> &amp;&amp; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#is_nil">is_nil</a></span> <span class="id">ncs</span>) <span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> [<span class="id">ck</span>] <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Efby">Efby</a></span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">anns</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">nc0s</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">check_exp</span> <span class="id">e0s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">ncs</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">check_exp</span> <span class="id">es</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Common.CommonList.html#forall3b">forall3b</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_paired_clocks">check_paired_clocks</a></span> <span class="id">nc0s</span> <span class="id">ncs</span> <span class="id">anns</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">anns</span>) <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Earrow">Earrow</a></span> <span class="id">e0s</span> <span class="id">es</span> <span class="id">anns</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">nc0s</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">check_exp</span> <span class="id">e0s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">ncs</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">check_exp</span> <span class="id">es</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Common.CommonList.html#forall3b">forall3b</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_paired_clocks">check_paired_clocks</a></span> <span class="id">nc0s</span> <span class="id">ncs</span> <span class="id">anns</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">anns</span>) <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Ewhen">Ewhen</a></span> <span class="id">es</span> (<span class="id">x</span>, <span class="id">_</span>) <span class="id">b</span> (<span class="id">tys</span>, <span class="id">nc</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">nc</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Con">Con</a></span> <span class="id">xc</span> <span class="id">y</span> (<span class="id">_</span>, <span class="id">yb</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">nces</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">check_exp</span> <span class="id">es</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id">x</span> ==<span class="id">b</span> <span class="id">y</span>) &amp;&amp; (<span class="id">b</span> ==<span class="id">b</span> <span class="id">yb</span>) &amp;&amp; (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_var">check_var</a></span> <span class="id">x</span> <span class="id">xc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; (<span class="id"><a href="Velus.Common.CommonList.html#forall2b">forall2b</a></span> (<span class="kwd">fun</span> <span class="id">c</span> <span class="id">_</span> =&gt; <span class="id">xc</span> ==<span class="id">b</span> <span class="id">c</span>) <span class="id">nces</span> <span class="id">tys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">nc</span>) <span class="id">tys</span>) <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Emerge">Emerge</a></span> (<span class="id">x</span>, <span class="id">tx</span>) <span class="id">es</span> (<span class="id">tys</span>, <span class="id">ck</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">ncs</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#omap">omap</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">check_exp</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>))) <span class="id">es</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_var">check_var</a></span> <span class="id">x</span> <span class="id">ck</span> &amp;&amp; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_merge_clocks">check_merge_clocks</a></span> <span class="id">x</span> <span class="id">tx</span> <span class="id">ck</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">es</span>) <span class="id">ncs</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">es</span>) <span class="id">tys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#is_nil">is_nil</a></span> <span class="id">es</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">ck</span>) <span class="id">tys</span>) <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Ecase">Ecase</a></span> <span class="id">e</span> <span class="id">brs</span> <span class="id">d</span> (<span class="id">tys</span>, <span class="id">ck</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">nds</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#or_default_with">or_default_with</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> []) (<span class="kwd">fun</span> <span class="id">d</span> =&gt; <span class="id">do</span> <span class="id">nds</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">check_exp</span> <span class="id">d</span>); <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> [<span class="id">nds</span>]) <span class="id">d</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">ncs</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#omap">omap</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">check_exp</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>))) <span class="id">brs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">ce</span> &lt;- <span class="id"><a href="Velus.Common.CommonList.html#assert_singleton">assert_singleton</a></span> (<span class="id">check_exp</span> <span class="id">e</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id">ce</span> ==<span class="id">b</span> <span class="id">ck</span>) &amp;&amp; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_case_clocks">check_case_clocks</a></span> <span class="id">ck</span> (<span class="id">nds</span>++<span class="id">ncs</span>) <span class="id">tys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#is_nil">is_nil</a></span> <span class="id">brs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">ck</span>) <span class="id">tys</span>) <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Eapp">Eapp</a></span> <span class="id">f</span> <span class="id">es</span> <span class="id">er</span> <span class="id">anns</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">n</span> &lt;- <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.G">G</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">check_exp</span> <span class="id">es</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">nr</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#omap">omap</a></span> <span class="id">check_exp</span> <span class="id">er</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">nin0</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>)) =&gt; <span class="id">ck</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#hd_error">hd_error</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">nces</span> := <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclocksof">nclocksof</a></span> <span class="id">es</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">nces0</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#hd_error">hd_error</a></span> <span class="id">nces</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">bck</span> &lt;- <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.find_base_clock">find_base_clock</a></span> <span class="id">nin0</span> <span class="id">nces0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">nanns</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">ty</span>, <span class="id">ck</span>) =&gt; (<span class="id">ty</span>, (<span class="id">ck</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>))) <span class="id">anns</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">isub</span> := <span class="id"><a href="Velus.Common.CommonList.html#fold_left2">fold_left2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_isub">add_isub</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>) <span class="id">nces</span> (<span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sub</span> := <span class="id"><a href="Velus.Common.CommonList.html#fold_left2">fold_left2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_osub">add_osub</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span>) <span class="id">nanns</span> <span class="id">isub</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id"><a href="Velus.Common.CommonList.html#forall2b">forall2b</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>)) '(<span class="id">ck</span>', <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_inst">check_inst</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">ck</span> <span class="id">ck</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>) <span class="id">nces</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; (<span class="id"><a href="Velus.Common.CommonList.html#forall2b">forall2b</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">_</span>)) '(<span class="id">_</span>, (<span class="id">ck</span>', <span class="id">_</span>)) =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_inst">check_inst</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">ck</span> <span class="id">ck</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span>) <span class="id">nanns</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_reset">check_reset</a></span> <span class="id">nr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">anns</span>) <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.check_equation">check_equation</a></span> (<span class="id">eq</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.equation">equation</a></span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">xs</span>, <span class="id">es</span>) := <span class="id">eq</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">es</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Eapp">Eapp</a></span> <span class="id">f</span> <span class="id">es</span> <span class="id">er</span> <span class="id">anns</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">do</span> <span class="id">n</span> &lt;- <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.G">G</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">_</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id">es</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">nr</span> &lt;- <span class="id"><a href="Velus.Common.Common.html#omap">omap</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id">er</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">nin0</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>)) =&gt; <span class="id">ck</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#hd_error">hd_error</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">nces</span> := <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclocksof">nclocksof</a></span> <span class="id">es</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">nces0</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#hd_error">hd_error</a></span> <span class="id">nces</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">bck</span> &lt;- <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.find_base_clock">find_base_clock</a></span> <span class="id">nin0</span> <span class="id">nces0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">nanns</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '((<span class="id">ty</span>, <span class="id">ck</span>), <span class="id">x</span>) =&gt; (<span class="id">ty</span>, (<span class="id">ck</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span>))) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">anns</span> <span class="id">xs</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">isub</span> := <span class="id"><a href="Velus.Common.CommonList.html#fold_left2">fold_left2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_isub">add_isub</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>) <span class="id">nces</span> (<span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sub</span> := <span class="id"><a href="Velus.Common.CommonList.html#fold_left2">fold_left2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_osub">add_osub</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span>) <span class="id">nanns</span> <span class="id">isub</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id"><a href="Velus.Common.CommonList.html#forall2b">forall2b</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>)) '(<span class="id">ck</span>', <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_inst">check_inst</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">ck</span> <span class="id">ck</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>) <span class="id">nces</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">xs</span> ==<span class="id">b</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">anns</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; (<span class="id"><a href="Velus.Common.CommonList.html#forall2b">forall2b</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">_</span>)) '(<span class="id">_</span>, <span class="id">ck</span>') =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_inst">check_inst</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">ck</span> <span class="id">ck</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span>) <span class="id">anns</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_reset">check_reset</a></span> <span class="id">nr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">anns</span>) <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ncks</span> =&gt; <span class="id"><a href="Velus.Common.CommonList.html#forall2b">forall2b</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_var">check_var</a></span> <span class="id">xs</span> <span class="id">ncks</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="kwd">match</span> <span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id">es</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ncks</span> =&gt; <span class="id"><a href="Velus.Common.CommonList.html#forall2b">forall2b</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_var">check_var</a></span> <span class="id">xs</span> <span class="id">ncks</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.check_var_correct">check_var_correct</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_var">check_var</a></span> <span class="id">x</span> <span class="id">ck</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span> <span class="id">x</span> <span class="id">ck</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">HH</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_var">check_var</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">Heq</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">HH</span>. <span class="id">inv</span> <span class="id">HH</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCLOCKING.check_vars_correct">check_vars_correct</a></span>: <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">cks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#forall2b">forall2b</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_var">check_var</a></span> <span class="id">xs</span> <span class="id">cks</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span>) <span class="id">xs</span> <span class="id">cks</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#forall2b_Forall2">forall2b_Forall2</a></span> <span class="kwd">in</span> <span class="id">Hf2</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_var_correct">check_var_correct</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.check_last_correct">check_last_correct</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_last">check_last</a></span> <span class="id">x</span> <span class="id">ck</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span> <span class="id">x</span> <span class="id">ck</span> /\ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span> <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">HH</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_last">check_last</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">Heq</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">HH</span>. <span class="id">inv</span> <span class="id">HH</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.check_paired_clocks_correct">check_paired_clocks_correct</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cks1</span> <span class="id">cks2</span> <span class="id">anns</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#forall3b">forall3b</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_paired_clocks">check_paired_clocks</a></span> <span class="id">cks1</span> <span class="id">cks2</span> <span class="id">anns</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cks1</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">anns</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">cks2</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">anns</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#forall3b_Forall3">forall3b_Forall3</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> 1 <span class="kwd">as</span> [|<span class="id">ck1</span> <span class="id">ck2</span> (<span class="id">ty</span>, <span class="id">ck</span>) <span class="id">cks1</span> <span class="id">cks2</span> <span class="id">anns</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">IH1</span> <span class="id">IH2</span> (<span class="id">Hcks1</span> &amp; <span class="id">Hcks2</span>)];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">IH1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">IH1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">IH1</span> <span class="kwd">as</span> (<span class="id">Hck1</span> &amp; <span class="id">Hck2</span>). <span class="id">inv</span> <span class="id">Hck1</span>; <span class="id">inv</span> <span class="id">Hck2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.check_merge_clocks_correct">check_merge_clocks_correct</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">x</span> <span class="id">tx</span> <span class="id">ck</span> <span class="id">ncs</span> <span class="id">n</span> (<span class="id">tys</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_merge_clocks">check_merge_clocks</a></span> <span class="id">x</span> <span class="id">tx</span> <span class="id">ck</span> <span class="id">ncs</span> <span class="id">n</span> <span class="id">tys</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">i</span>, <span class="id">ncs</span>) =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">ck</span>' =&gt; (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Con">Con</a></span> <span class="id">ck</span> <span class="id">x</span> (<span class="id">tx</span>, <span class="id">i</span>)) = <span class="id">ck</span>') <span class="id">ncs</span>) <span class="id">ncs</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">ncs</span>) =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">ncs</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tys</span>) <span class="id">ncs</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">CM</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_merge_clocks">check_merge_clocks</a></span> <span class="kwd">in</span> <span class="id">CM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span> <span class="kwd">in</span> <span class="id">CM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; (<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eauto</span>]); <span class="id">intros</span> (?&amp;?) <span class="id">CM</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span> <span class="kwd">in</span> <span class="id">CM</span>'; <span class="id">destruct</span> <span class="id">CM</span>' <span class="kwd">as</span> (<span class="id">CM1</span>&amp;<span class="id">CM2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eauto</span>]. <span class="id">intros</span> ? <span class="id">Heq</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">inv</span> <span class="id">Heq</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">CM2</span>; <span class="id">inv</span> <span class="id">CM2</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.check_case_clocks_correct">check_case_clocks_correct</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">ck</span> <span class="id">ncs</span> (<span class="id">tys</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_case_clocks">check_case_clocks</a></span> <span class="id">ck</span> <span class="id">ncs</span> <span class="id">tys</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">ck</span>' =&gt; <span class="id">ck</span> = <span class="id">ck</span>')) <span class="id">ncs</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">ncs</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">ncs</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tys</span>) <span class="id">ncs</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">CM</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_case_clocks">check_case_clocks</a></span> <span class="kwd">in</span> <span class="id">CM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span> <span class="kwd">in</span> <span class="id">CM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">CM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span> <span class="kwd">in</span> <span class="id">CM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eauto</span>]; <span class="id">intros</span> ? (?&amp;<span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eauto</span>]; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">inv</span> <span class="id">H0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eauto</span>]; <span class="id">intros</span> ? (<span class="id">_</span>&amp;<span class="id">Hlen</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Hlen</span>; <span class="id">inv</span> <span class="id">Hlen</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">oconcat_map_check_exp</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">f</span>} <span class="id">es</span> <span class="id">cks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">e</span> <span class="id">cks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">e</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">e</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.G">G</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span> <span class="id">e</span> /\ <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = <span class="id">cks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">f</span> <span class="id">es</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.G">G</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span>) <span class="id">es</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span> = <span class="id">cks</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">es</span> <span class="kwd">as</span> [|<span class="id">e</span> <span class="id">es</span> <span class="id">IH</span>]; <span class="id">intros</span> <span class="id">cks</span> <span class="id">WTf</span> <span class="id">CE</span>. <span class="id">now</span> <span class="id">inv</span> <span class="id">CE</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">CE</span>. <span class="id">destruct</span> (<span class="id">f</span> <span class="id">e</span>) <span class="id">eqn</span>:<span class="id">Ce</span>; [|<span class="id">now</span> <span class="id">omonadInv</span> <span class="id">CE</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">f</span> <span class="id">es</span>)) <span class="kwd">as</span> [<span class="id">ces</span>|]; [|<span class="id">now</span> <span class="id">omonadInv</span> <span class="id">CE</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">omonadInv</span> <span class="id">CE</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">WTf</span> <span class="kwd">in</span> <span class="id">Ce</span> <span class="kwd">as</span> (<span class="id">Ce1</span> &amp; -&gt;); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IH</span> <span class="id">ces</span>) <span class="kwd">as</span> (? &amp; -&gt;); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Ies</span> <span class="id">Fe</span>. <span class="id">apply</span> <span class="id">WTf</span> <span class="kwd">in</span> <span class="id">Fe</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">omap_concat_map_check_exp</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">f</span>} (<span class="id">ess</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Op.enumtag">enumtag</a></span> * <span class="id">_</span>)) <span class="id">ncks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">es</span> <span class="id">e</span> <span class="id">ncks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">es</span> <span class="id">ess</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">e</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">e</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ncks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.G">G</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span> <span class="id">e</span> /\ <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = <span class="id">ncks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#omap">omap</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>))) <span class="id">ess</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ncks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">es</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.G">G</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>)) <span class="id">ess</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">es</span> <span class="id">ncks</span> =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>) = <span class="id">ncks</span>) <span class="id">ess</span> <span class="id">ncks</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ess</span> <span class="kwd">as</span> [|<span class="id">es</span> <span class="id">ess</span> <span class="id">IH</span>]; <span class="id">intros</span> <span class="id">ncks</span> <span class="id">WTf</span> <span class="id">CE</span>. <span class="id">now</span> <span class="id">inv</span> <span class="id">CE</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">CE</span>. <span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">es</span>))) <span class="id">eqn</span>:<span class="id">Ce</span>; [|<span class="id">now</span> <span class="id">omonadInv</span> <span class="id">CE</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">oconcat_map_check_exp</span>' <span class="kwd">in</span> <span class="id">Ce</span> <span class="kwd">as</span> (?&amp;?); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#omap">omap</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">as</span> [<span class="id">tes</span>|]; [|<span class="id">now</span> <span class="id">omonadInv</span> <span class="id">CE</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">omonadInv</span> <span class="id">CE</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IH</span> <span class="id">tes</span>) <span class="kwd">as</span> (? &amp; ?); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_cons">in_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">omap_check_exp</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">f</span>} <span class="id">es</span> <span class="id">cks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">e</span> <span class="id">cks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">e</span> <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">e</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.G">G</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span> <span class="id">e</span> /\ <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = <span class="id">cks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#omap">omap</a></span> <span class="id">f</span> <span class="id">es</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.G">G</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span>) <span class="id">es</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">e</span> <span class="id">ck</span> =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = <span class="id">ck</span>) <span class="id">es</span> <span class="id">cks</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">es</span> <span class="kwd">as</span> [|<span class="id">e</span> <span class="id">es</span> <span class="id">IH</span>]; <span class="id">intros</span> <span class="id">cks</span> <span class="id">WTf</span> <span class="id">CE</span>. <span class="id">now</span> <span class="id">inv</span> <span class="id">CE</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">CE</span>. <span class="id">destruct</span> (<span class="id">f</span> <span class="id">e</span>) <span class="id">eqn</span>:<span class="id">Ce</span>; [|<span class="id">now</span> <span class="id">omonadInv</span> <span class="id">CE</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#omap">omap</a></span> <span class="id">f</span> <span class="id">es</span>) <span class="kwd">as</span> [<span class="id">ces</span>|]; [|<span class="id">now</span> <span class="id">omonadInv</span> <span class="id">CE</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">omonadInv</span> <span class="id">CE</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">WTf</span> <span class="kwd">in</span> <span class="id">Ce</span> <span class="kwd">as</span> (<span class="id">Ce1</span> &amp; <span class="id">Ce2</span>); <span class="id">auto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IH</span> <span class="id">ces</span>) <span class="kwd">as</span> (? &amp; ?); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Ies</span> <span class="id">Fe</span>. <span class="id">apply</span> <span class="id">WTf</span> <span class="kwd">in</span> <span class="id">Fe</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.find_add_isub">find_add_isub</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sub</span> <span class="id">x</span> <span class="id">tc</span> <span class="id">ck</span> <span class="id">nm</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> <span class="id">sub</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_isub">add_isub</a></span> <span class="id">sub</span> (<span class="id">x</span>, <span class="id">tc</span>) (<span class="id">ck</span>, <span class="id">nm</span>)) = <span class="id">nm</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_isub">add_isub</a></span>; <span class="id">simpl</span>. <span class="id">intros</span> <span class="id">sub</span> <span class="id">x</span> ((<span class="id">ty</span>, <span class="id">ck</span>), ?) ? <span class="id">nm</span> <span class="id">NI</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">nm</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gss">Env.gss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.not_find_in_iff">Env.Props.P.F.not_find_in_iff</a></span> <span class="kwd">in</span> <span class="id">NI</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.fold_left2_add_osub_skip">fold_left2_add_osub_skip</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">anns</span> <span class="id">sub</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Common.CommonList.html#fold_left2">fold_left2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_osub">add_osub</a></span> <span class="id">xs</span> <span class="id">anns</span> <span class="id">sub</span>) = <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">sub</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">xs</span> <span class="kwd">as</span> [|(<span class="id">y</span>, (((<span class="id">yt</span>, <span class="id">yc</span>), <span class="id">ycaus</span>), <span class="id">yl</span>)) <span class="id">xs</span> <span class="id">IH</span>]; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">anns</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl</span>; <span class="id">intros</span> <span class="id">anns</span> <span class="id">sub</span> <span class="id">NIx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Decidable.html#not_or">Decidable.not_or</a></span> <span class="kwd">in</span> <span class="id">NIx</span> <span class="kwd">as</span> (<span class="id">Nx</span> &amp; <span class="id">NIx</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">anns</span> <span class="kwd">as</span> [|(<span class="id">ty</span>, (<span class="id">ck</span>, <span class="id">n</span>)) <span class="id">anns</span>]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">IH</span> <span class="id">_</span> <span class="id">_</span> <span class="id">NIx</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_osub">add_osub</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_isub">add_isub</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">n</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gso">Env.gso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.fold_left2_add_isub_skip">fold_left2_add_isub_skip</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">ncs</span> <span class="id">sub</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Common.CommonList.html#fold_left2">fold_left2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_isub">add_isub</a></span> <span class="id">xs</span> <span class="id">ncs</span> <span class="id">sub</span>) = <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">sub</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">xs</span> <span class="kwd">as</span> [|(<span class="id">y</span>, ((<span class="id">yt</span>, <span class="id">yc</span>), <span class="id">ycaus</span>)) <span class="id">xs</span> <span class="id">IH</span>]; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">ncs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl</span>; <span class="id">intros</span> <span class="id">ncs</span> <span class="id">sub</span> <span class="id">NIx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Decidable.html#not_or">Decidable.not_or</a></span> <span class="kwd">in</span> <span class="id">NIx</span> <span class="kwd">as</span> (<span class="id">Nx</span> &amp; <span class="id">NIx</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ncs</span> <span class="kwd">as</span> [|(<span class="id">ck</span>, <span class="id">n</span>) <span class="id">anns</span>]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">IH</span> <span class="id">_</span> <span class="id">_</span> <span class="id">NIx</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_isub">add_isub</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">n</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gso">Env.gso</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.fold_left2_add_isub">fold_left2_add_isub</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">xt</span> <span class="id">xc</span> <span class="id">ck</span> <span class="id">nm</span> <span class="id">xs</span> <span class="id">ncs</span> <span class="id">sub</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> ((<span class="id">x</span>, (<span class="id">xt</span>, <span class="id">xc</span>)), (<span class="id">ck</span>, <span class="id">nm</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">xs</span> <span class="id">ncs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> <span class="id">sub</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Common.CommonList.html#fold_left2">fold_left2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_isub">add_isub</a></span> <span class="id">xs</span> <span class="id">ncs</span> <span class="id">sub</span>) = <span class="id">nm</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">xs</span> <span class="kwd">as</span> [|(<span class="id">y</span>, ((<span class="id">yt</span>, <span class="id">yc</span>), <span class="id">ycaus</span>)) <span class="id">xs</span> <span class="id">IH</span>]. <span class="id">now</span> <span class="id">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">ncs</span> <span class="id">sub</span> <span class="id">Ix</span> <span class="id">ND</span> <span class="id">NI</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ncs</span> <span class="kwd">as</span> [|(<span class="id">ck</span>', <span class="id">nm</span>') <span class="id">ncs</span>]. <span class="id">now</span> <span class="id">inversion</span> <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Ix</span> <span class="kwd">as</span> [<span class="id">Ix</span>|<span class="id">Ix</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Ix</span>. <span class="id">inv</span> <span class="id">ND</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.fold_left2_add_isub_skip">fold_left2_add_isub_skip</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.find_add_isub">find_add_isub</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ((<span class="id">y</span>, ((?, ?), ?)) &amp; <span class="id">Fy</span> &amp; <span class="id">Iy</span>). <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (~<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span> <span class="kwd">with</span> (1:=<span class="id">Iy</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">ND</span>. <span class="id">eapply</span> <span class="id">IH</span> <span class="kwd">in</span> <span class="id">Ix</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_combine_l">in_combine_l</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span> <span class="kwd">in</span> <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (~<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">_</span> <span class="id">xs</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_neq">InMembers_neq</a></span> <span class="kwd">with</span> (2:=<span class="id">it</span>) <span class="kwd">in</span> <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_isub">add_isub</a></span>; <span class="id">simpl</span>. <span class="id">destruct</span> <span class="id">nm</span>'; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.add_in_iff">Env.Props.P.F.add_in_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">not_or</span>'; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.fold_left2_add_osub">fold_left2_add_osub</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">xt</span> <span class="id">xc</span> <span class="id">ty</span> <span class="id">ck</span> <span class="id">nm</span> <span class="id">xs</span> <span class="id">ans</span> <span class="id">sub</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> ((<span class="id">x</span>, (<span class="id">xt</span>, <span class="id">xc</span>)), (<span class="id">ty</span>, (<span class="id">ck</span>, <span class="id">nm</span>))) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">xs</span> <span class="id">ans</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Environment.html#Env.In">Env.In</a></span> <span class="id">x</span> <span class="id">sub</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Common.CommonList.html#fold_left2">fold_left2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_osub">add_osub</a></span> <span class="id">xs</span> <span class="id">ans</span> <span class="id">sub</span>) = <span class="id">nm</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">xs</span> <span class="kwd">as</span> [|(<span class="id">y</span>, (((<span class="id">yt</span>, <span class="id">yc</span>), <span class="id">ycaus</span>), <span class="id">yl</span>)) <span class="id">xs</span> <span class="id">IH</span>]. <span class="id">now</span> <span class="id">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">ncs</span> <span class="id">sub</span> <span class="id">Ix</span> <span class="id">ND</span> <span class="id">NI</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ncs</span> <span class="kwd">as</span> [|(<span class="id">ck</span>', <span class="id">nm</span>') <span class="id">ncs</span>]. <span class="id">now</span> <span class="id">inversion</span> <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Ix</span> <span class="kwd">as</span> [<span class="id">Ix</span>|<span class="id">Ix</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Ix</span>. <span class="id">inv</span> <span class="id">ND</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.fold_left2_add_osub_skip">fold_left2_add_osub_skip</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.find_add_isub">find_add_isub</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ((<span class="id">y</span>, ((?, ?), ?)) &amp; <span class="id">Fy</span> &amp; <span class="id">Iy</span>). <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (~<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span> <span class="kwd">with</span> (1:=<span class="id">Iy</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">ND</span>. <span class="id">eapply</span> <span class="id">IH</span> <span class="kwd">in</span> <span class="id">Ix</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_combine_l">in_combine_l</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span> <span class="kwd">in</span> <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (~<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">_</span> <span class="id">xs</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_neq">InMembers_neq</a></span> <span class="kwd">with</span> (2:=<span class="id">it</span>) <span class="kwd">in</span> <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_osub">add_osub</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_isub">add_isub</a></span>; <span class="id">simpl</span>. <span class="id">destruct</span> <span class="id">nm</span>'; <span class="id">auto</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">o</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.add_in_iff">Env.Props.P.F.add_in_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">not_or</span>'; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.check_inst_correct">check_inst_correct</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">bck</span> <span class="id">xc</span> <span class="id">ck</span> <span class="id">sub</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_inst">check_inst</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">xc</span> <span class="id">ck</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.instck">instck</a></span> <span class="id">bck</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">sub</span>) <span class="id">xc</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ck</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">xc</span> <span class="kwd">as</span> [|<span class="id">xc</span>' ? <span class="id">x</span> <span class="id">b</span>]; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span>; <span class="id">inversion</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ck</span>. <span class="id">now</span> <span class="id">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">sub</span> <span class="id">Fx</span>. <span class="id">cases_eqn</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">repeat</span> <span class="id">take</span> (<span class="id">_</span> &amp;&amp; <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#andb_prop">andb_prop</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">repeat</span> <span class="id">take</span> ((<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">and</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">inv</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">erewrite</span> <span class="id">IHxc</span> <span class="kwd">in</span> <span class="id">Heq0</span>; [|<span class="id">eauto</span>]; <span class="id">inv</span> <span class="id">Heq0</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.check_reset_correct">check_reset_correct</a></span>: <span class="kwd">forall</span> <span class="id">cks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_reset">check_reset</a></span> <span class="id">cks</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">cks</span> =&gt; <span class="kwd">exists</span> <span class="id">ck</span>, <span class="id">cks</span> = [<span class="id">ck</span>]) <span class="id">cks</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Che</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span> <span class="kwd">in</span> <span class="id">Che</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eauto</span>]. <span class="id">intros</span> ? <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">a</span> <span class="kwd">as</span> [|? [|??]]; <span class="id">try</span> <span class="id">congruence</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Local</span> <span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id"><a href="Velus.Lustre.LClocking.html#wc_exp">wc_exp</a></span> : <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.check_exp_correct">check_exp_correct</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">ncks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id">e</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ncks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.G">G</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = <span class="id">ncks</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof35')">Proof with</span></div>
<div class="proofscript" id="proof35">
 <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.exp_ind2">exp_ind2</a></span>; <span class="id">simpl</span>; <span class="id">intros</span> <span class="id">ncks</span> <span class="id">CE</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">progress</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">a</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.ann">ann</a></span> |- <span class="id">_</span> =&gt; <span class="id">destruct</span> <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">a</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.lann">lann</a></span> |- <span class="id">_</span> =&gt; <span class="id">destruct</span> <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">nc</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.nclock">nclock</a></span> |- <span class="id">_</span> =&gt; <span class="id">destruct</span> <span class="id">nc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">p</span>:(<span class="id">_</span> * <span class="id">_</span>) |- <span class="id">_</span> =&gt; <span class="id">destruct</span> <span class="id">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.Common.html#obind">obind</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">omonadInv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">_</span> &amp;&amp; <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> |- <span class="id">_</span> =&gt; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (? &amp; ?)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: ((<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) |- <span class="id">_</span> =&gt; <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:(<span class="kwd">if</span> ?<span class="id">c</span> <span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">C</span> := <span class="id">fresh</span> "<span class="id">C0</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span> <span class="id">eqn</span>:<span class="id">C</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_var">check_var</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> |- <span class="id">_</span> =&gt; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_var_correct">check_var_correct</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_last">check_last</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> |- <span class="id">_</span> =&gt; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_last_correct">check_last_correct</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;?); <span class="id">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.CommonList.html#assert_singleton">assert_singleton</a></span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#assert_singleton_spec">assert_singleton_spec</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.Common.html#obind">obind</a></span> ?<span class="id">v</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">OE</span>:=<span class="id">fresh</span> "<span class="id">OE0</span>" <span class="kwd">in</span> <span class="id">destruct</span> <span class="id">v</span> <span class="id">eqn</span>:<span class="id">OE</span>; [<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H</span>|<span class="id">now</span> <span class="id">omonadInv</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:(<span class="kwd">match</span> ?<span class="id">o</span> <span class="kwd">with</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="id">_</span> | <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="kwd">end</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">o</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:(<span class="kwd">match</span> ?<span class="id">o</span> <span class="kwd">with</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> | <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id">_</span> <span class="kwd">end</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">o</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:(<span class="kwd">match</span> ?<span class="id">o</span> <span class="kwd">with</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="kwd">if</span> <span class="id">_</span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span> | <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id">_</span> <span class="kwd">end</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">o</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:(<span class="kwd">match</span> ?<span class="id">c</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> | <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.CommonList.html#forall3b">forall3b</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_paired_clocks">check_paired_clocks</a></span> ?<span class="id">cks1</span> ?<span class="id">cks2</span> ?<span class="id">anns</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_paired_clocks_correct">check_paired_clocks_correct</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (? &amp; ?)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:(?<span class="id">xs</span> &lt;&gt;<span class="id">b</span> 0) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#nequiv_decb_true">nequiv_decb_true</a></span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (0 &lt; <span class="id">xs</span>) <span class="kwd">by</span> (<span class="id">destruct</span> <span class="id">l</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="id">exfalso</span>; <span class="id">apply</span> <span class="id">H</span>|<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.lt_0_succ">PeanoNat.Nat.lt_0_succ</a></span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.Common.html#obind2">obind2</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#assert_singleton">assert_singleton</a></span> ?<span class="id">ce</span>) <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Common.CommonList.html#assert_singleton">assert_singleton</a></span> <span class="id">ce</span>) <span class="kwd">as</span> [(<span class="id">ck</span>, <span class="id">n</span>)|] <span class="id">eqn</span>:<span class="id">AS</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">discriminate</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="id">eauto</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Eunop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHe</span> <span class="kwd">in</span> <span class="id">OE0</span> <span class="kwd">as</span> (? &amp; ?)...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Ebinop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHe1</span> <span class="kwd">in</span> <span class="id">OE0</span> <span class="kwd">as</span> (? &amp; ?); <span class="id">apply</span> <span class="id">IHe2</span> <span class="kwd">in</span> <span class="id">OE1</span> <span class="kwd">as</span> (? &amp; ?)...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Eextcall&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> :<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.exp">exp</a></span> =&gt; <span class="id">_</span>) <span class="id">_</span>) <span class="id">and</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">oconcat_map_check_exp</span>' <span class="kwd">in</span> <span class="id">OE0</span> <span class="kwd">as</span> (? &amp; ?); <span class="id">auto</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>... <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">and</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#negb_true_iff">Bool.negb_true_iff</a></span>, &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#not_true_iff_false">Bool.not_true_iff_false</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">it</span>. <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#is_nil_spec">is_nil_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Efby&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> :<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.exp">exp</a></span> =&gt; <span class="id">_</span>) <span class="id">_</span>) <span class="id">and</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">oconcat_map_check_exp</span>' <span class="kwd">in</span> <span class="id">OE0</span> <span class="kwd">as</span> (? &amp; ?); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">oconcat_map_check_exp</span>' <span class="kwd">in</span> <span class="id">OE1</span> <span class="kwd">as</span> (? &amp; ?); <span class="id">auto</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Earrow&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">e</span> :<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.exp">exp</a></span> =&gt; <span class="id">_</span>) <span class="id">_</span>) <span class="id">and</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">oconcat_map_check_exp</span>' <span class="kwd">in</span> <span class="id">OE0</span> <span class="kwd">as</span> (? &amp; ?); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">oconcat_map_check_exp</span>' <span class="kwd">in</span> <span class="id">OE1</span> <span class="kwd">as</span> (? &amp; ?); <span class="id">auto</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Ewhen&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">_</span> <span class="id">es</span>) <span class="id">and</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id">_</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">oconcat_map_check_exp</span>' <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (? &amp; ?); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Common.CommonList.html#forall2b">forall2b</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">and</span> <span class="id">rename</span> <span class="id">it</span> <span class="id">into</span> <span class="id">FA2</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#forall2b_Forall2">forall2b_Forall2</a></span> <span class="kwd">in</span> <span class="id">FA2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>; <span class="id">simpl</span>; <span class="id">repeat</span> <span class="id">split</span>; <span class="id">auto</span>. <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">FA2</span>) <span class="kwd">as</span> <span class="id">Hlen</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore2">Forall2_ignore2</a></span> <span class="kwd">in</span> <span class="id">FA2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_impl_In">Forall_impl_In</a></span> <span class="kwd">with</span> (2:=<span class="id">FA2</span>). <span class="id">intros</span> ? ? (? &amp; <span class="id">HH</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">HH</span>; <span class="id">inv</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Emerge&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">_</span> <span class="id">es</span>) <span class="id">and</span> (<span class="id">repeat</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">it</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Common.Common.html#omap">omap</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">omap_concat_map_check_exp</span>' <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (<span class="id">Hwc</span> &amp; <span class="id">Heq</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_merge_clocks">check_merge_clocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_merge_clocks_correct">check_merge_clocks_correct</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (<span class="id">Hf1</span> &amp; <span class="id">Hf2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Forall2_combine</span>'' <span class="kwd">in</span> <span class="id">Hf1</span>. <span class="id">eapply</span> <span class="id">Forall2_combine</span>'' <span class="kwd">in</span> <span class="id">Hf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2,3:(<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">eauto</span>. <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">contradict</span> <span class="id">H1</span>; <span class="id">subst</span>; <span class="id">simpl</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span> <span class="kwd">in</span> <span class="id">Hf1</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_Forall2">Forall2_Forall2</a></span> <span class="kwd">in</span> <span class="id">Hf1</span>; [|<span class="id">eapply</span> <span class="id">Heq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore2">Forall2_ignore2</a></span> <span class="kwd">in</span> <span class="id">Hf1</span>. <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eauto</span>]. <span class="id">intros</span> (?&amp;?) (?&amp;<span class="id">_</span>&amp;<span class="id">Hck</span>&amp;?); <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span> <span class="kwd">in</span> <span class="id">Hf2</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_Forall2">Forall2_Forall2</a></span> <span class="kwd">in</span> <span class="id">Hf2</span>; [|<span class="id">eapply</span> <span class="id">Heq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore2">Forall2_ignore2</a></span> <span class="kwd">in</span> <span class="id">Hf2</span>. <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eauto</span>]. <span class="id">intros</span> (?&amp;?) (?&amp;<span class="id">_</span>&amp;<span class="id">Hlen</span>&amp;?); <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hlen</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Ecase&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> (<span class="id">repeat</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">it</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Common.Common.html#omap">omap</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">omap_concat_map_check_exp</span>' <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (<span class="id">Hwces</span> &amp; <span class="id">Hckes</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;take&nbsp;(oconcat&nbsp;(map&nbsp;check_exp&nbsp;_)&nbsp;=&nbsp;Some&nbsp;_)&nbsp;and&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;oconcat_map_check_exp'&nbsp;in&nbsp;it&nbsp;as&nbsp;(?&nbsp;&amp;&nbsp;?);&nbsp;eauto.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_case_clocks">check_case_clocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_case_clocks_correct">check_case_clocks_correct</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (<span class="id">Hf1</span> &amp; <span class="id">Hf2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_app">Forall_app</a></span> <span class="kwd">in</span> <span class="id">Hf1</span> <span class="kwd">as</span> (<span class="id">Hd1</span>&amp;<span class="id">Hes1</span>). <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_app">Forall_app</a></span> <span class="kwd">in</span> <span class="id">Hf2</span> <span class="kwd">as</span> (<span class="id">Hd2</span>&amp;<span class="id">Hes2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;eapply&nbsp;forallb_Forall&nbsp;in&nbsp;H3.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHe</span> <span class="kwd">in</span> <span class="id">OE2</span> <span class="kwd">as</span> (? &amp; <span class="id">Hcke</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">eauto</span>. <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">contradict</span> <span class="id">H2</span>; <span class="id">subst</span>; <span class="id">simpl</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore2">Forall2_ignore2</a></span> <span class="kwd">in</span> <span class="id">Hckes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eapply</span> <span class="id">Hckes</span>]; <span class="id">intros</span> (?&amp;?) (?&amp;?&amp;<span class="id">Hck</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hes1</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore2">Forall2_ignore2</a></span> <span class="kwd">in</span> <span class="id">Hckes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eapply</span> <span class="id">Hckes</span>]; <span class="id">intros</span> (?&amp;?) (?&amp;?&amp;<span class="id">Hck</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hes2</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span>; <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">_</span> <span class="id">_</span>)) <span class="id">eqn</span>:<span class="id">OE1</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">omonadInv</span> <span class="id">OE0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id">_</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">oconcat_map_check_exp</span>' <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (? &amp; ?); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span>; <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">_</span> <span class="id">_</span>)) <span class="id">eqn</span>:<span class="id">OE1</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">omonadInv</span> <span class="id">OE0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id">_</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">oconcat_map_check_exp</span>' <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (? &amp; ?); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">intros</span>; <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span>. <span class="id">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">Hd1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span>; <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">_</span> <span class="id">_</span>)) <span class="id">eqn</span>:<span class="id">OE1</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">omonadInv</span> <span class="id">OE0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id">_</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">oconcat_map_check_exp</span>' <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (? &amp; ?); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">intros</span>; <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_singl">Forall_singl</a></span> <span class="kwd">in</span> <span class="id">Hd2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Eapp&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id">_</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">oconcat_map_check_exp</span>' <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (? &amp; ?); <span class="id">auto</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="Velus.Common.CommonList.html#forall2b">forall2b</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#forall2b_Forall2">forall2b_Forall2</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.find_base_clock">find_base_clock</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ?<span class="id">c</span> |- <span class="id">_</span> =&gt; <span class="id">rename</span> <span class="id">c</span> <span class="id">into</span> <span class="id">bck</span> <span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Common.CommonList.html#fold_left2">fold_left2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_osub">add_osub</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">ty</span>, <span class="id">ck0</span>) =&gt; (<span class="id">ty</span>, (<span class="id">ck0</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>))) <span class="id">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonList.html#fold_left2">fold_left2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_isub">add_isub</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclocksof">nclocksof</a></span> <span class="id">es</span>) (<span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id">_</span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>)) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclocksof">nclocksof</a></span> <span class="id">es</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall">Forall2_forall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">_</span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclocksof">nclocksof</a></span> <span class="id">es</span>)) <span class="id">and</span> <span class="id">rename</span> <span class="id">it</span> <span class="id">into</span> <span class="id">FA2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [|<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">with</span> (1:=<span class="id">FA2</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">x</span>, ((<span class="id">xt</span>, <span class="id">xc</span>), <span class="id">xcaus</span>)) (<span class="id">ck</span>, <span class="id">nm</span>) <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_In">Forall2_In</a></span> <span class="kwd">with</span> (1:=<span class="id">Ix</span>), <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_inst_correct">check_inst_correct</a></span> <span class="kwd">in</span> <span class="id">FA2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_nodup">n_nodup</a></span>) <span class="kwd">as</span> (<span class="id">ND</span>&amp;<span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.fold_left2_add_osub_skip">fold_left2_add_osub_skip</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.fold_left2_add_isub">fold_left2_add_isub</a></span> <span class="kwd">with</span> (1:=<span class="id">Ix</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span> <span class="kwd">in</span> <span class="id">ND</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.empty_in_iff">Env.Props.P.F.empty_in_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_combine_l">in_combine_l</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span> <span class="kwd">in</span> <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_In">NoDup_app_In</a></span>; <span class="id">eauto</span>. <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Common.CommonList.html#fold_left2">fold_left2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_osub">add_osub</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">ty</span>, <span class="id">ck0</span>) =&gt; (<span class="id">ty</span>, (<span class="id">ck0</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>))) <span class="id">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonList.html#fold_left2">fold_left2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_isub">add_isub</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclocksof">nclocksof</a></span> <span class="id">es</span>) (<span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">ty</span>, <span class="id">ck0</span>) =&gt; (<span class="id">ck0</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)) <span class="id">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall">Forall2_forall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">_</span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span>) <span class="id">_</span>) <span class="id">and</span> <span class="id">rename</span> <span class="id">it</span> <span class="id">into</span> <span class="id">FA2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. 2:{ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">FA2</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span> <span class="kwd">in</span> *; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">x</span>, (((<span class="id">xt</span>, <span class="id">xc</span>), <span class="id">xcaus</span>), <span class="id">xl</span>)) (<span class="id">ck</span>, <span class="id">nm</span>) <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#combine_map_snd">combine_map_snd</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Ix</span> <span class="kwd">as</span> (((<span class="id">y</span> &amp; ((<span class="id">yt</span> &amp; <span class="id">yc</span>) &amp; <span class="id">ycaus</span>)), (<span class="id">yc</span>' &amp; <span class="id">ynm</span>)) &amp; <span class="id">EE</span> &amp; <span class="id">Ix</span>); <span class="id">inv</span> <span class="id">EE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_2">Forall2_map_2</a></span> <span class="kwd">in</span> <span class="id">FA2</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_In">Forall2_In</a></span> <span class="kwd">in</span> <span class="id">Ix</span>; [|<span class="id">eauto</span>]; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_inst_correct">check_inst_correct</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_nodup">n_nodup</a></span>) <span class="kwd">as</span> (<span class="id">ND</span>&amp;<span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.fold_left2_add_osub">fold_left2_add_osub</a></span> ; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_r">NoDup_app_r</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span> <span class="kwd">in</span> <span class="id">ND</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#combine_map_snd">combine_map_snd</a></span>. <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>; <span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">eauto</span>; <span class="id">simpl</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.not_find_in_iff">Env.Props.P.F.not_find_in_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.fold_left2_add_isub_skip">fold_left2_add_isub_skip</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Environment.html#Env.gempty">Env.gempty</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_combine_l">in_combine_l</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span> <span class="kwd">in</span> <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ?. <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_In">NoDup_app_In</a></span>; <span class="id">eauto</span>. <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">omap_check_exp</span>' <span class="kwd">in</span> <span class="id">OE2</span> <span class="kwd">as</span> (? &amp; ?); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_reset_correct">check_reset_correct</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Forall2_ignore1</span>' <span class="kwd">in</span> <span class="id">H2</span>. 2:<span class="id">symmetry</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_Forall2">Forall2_Forall2</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore2">Forall2_ignore2</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eauto</span>]. <span class="id">intros</span> ? (?&amp;?&amp;?&amp;?); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCLOCKING.omap_check_exp">omap_check_exp</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">es</span> <span class="id">ncks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#omap">omap</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id">es</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ncks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.G">G</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span>) <span class="id">es</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">e</span> <span class="id">ck</span> =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = <span class="id">ck</span>) <span class="id">es</span> <span class="id">ncks</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">omap_check_exp</span>'; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp_correct">check_exp_correct</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCLOCKING.oconcat_map_check_exp">oconcat_map_check_exp</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">es</span> <span class="id">ncks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id">es</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ncks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.G">G</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span>) <span class="id">es</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span> = <span class="id">ncks</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">oconcat_map_check_exp</span>'; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp_correct">check_exp_correct</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.check_equation_correct">check_equation_correct</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">eq</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_equation">check_equation</a></span> <span class="id">eq</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_equation">wc_equation</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.G">G</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span> <span class="id">eq</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">eq</span> <span class="id">CE</span>. <span class="id">destruct</span> <span class="id">eq</span> <span class="kwd">as</span> (<span class="id">xs</span>, <span class="id">es</span>); <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">CE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">CE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">take</span> (<span class="id"><a href="Velus.Common.CommonList.html#forall2b">forall2b</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_vars_correct">check_vars_correct</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">try</span> (<span class="id">take</span> (<span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">_</span> <span class="id">_</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.oconcat_map_check_exp">oconcat_map_check_exp</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (<span class="id">WC</span> &amp; <span class="id">NC</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>; <span class="id">rewrite</span> <span class="id">NC</span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">progress</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">a</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.ann">ann</a></span> |- <span class="id">_</span> =&gt; <span class="id">destruct</span> <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">a</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.lann">lann</a></span> |- <span class="id">_</span> =&gt; <span class="id">destruct</span> <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">nc</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.nclock">nclock</a></span> |- <span class="id">_</span> =&gt; <span class="id">destruct</span> <span class="id">nc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">p</span>:(<span class="id">_</span> * <span class="id">_</span>) |- <span class="id">_</span> =&gt; <span class="id">destruct</span> <span class="id">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.Common.html#obind">obind</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">omonadInv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">_</span> &amp;&amp; <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> |- <span class="id">_</span> =&gt; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (? &amp; ?)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: ((<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) |- <span class="id">_</span> =&gt; <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:(<span class="kwd">if</span> ?<span class="id">c</span> <span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">C</span> := <span class="id">fresh</span> "<span class="id">C0</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">c</span> <span class="id">eqn</span>:<span class="id">C</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_var">check_var</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> |- <span class="id">_</span> =&gt; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_var_correct">check_var_correct</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.CommonList.html#assert_singleton">assert_singleton</a></span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#assert_singleton_spec">assert_singleton_spec</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.Common.html#obind">obind</a></span> ?<span class="id">v</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">OE</span>:=<span class="id">fresh</span> "<span class="id">OE0</span>" <span class="kwd">in</span> <span class="id">destruct</span> <span class="id">v</span> <span class="id">eqn</span>:<span class="id">OE</span>; [<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H</span>|<span class="id">now</span> <span class="id">omonadInv</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.CommonList.html#forall3b">forall3b</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_paired_clocks">check_paired_clocks</a></span> ?<span class="id">cks1</span> ?<span class="id">cks2</span> ?<span class="id">anns</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_paired_clocks_correct">check_paired_clocks_correct</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (? &amp; ?)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:(?<span class="id">xs</span> &lt;&gt;<span class="id">b</span> 0) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#nequiv_decb_true">nequiv_decb_true</a></span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (0 &lt; <span class="id">xs</span>) <span class="kwd">by</span> (<span class="id">destruct</span> <span class="id">l</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="id">exfalso</span>; <span class="id">apply</span> <span class="id">H</span>|<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.lt_0_succ">PeanoNat.Nat.lt_0_succ</a></span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Common.Common.html#obind2">obind2</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#assert_singleton">assert_singleton</a></span> ?<span class="id">ce</span>) <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Common.CommonList.html#assert_singleton">assert_singleton</a></span> <span class="id">ce</span>) <span class="kwd">as</span> [(<span class="id">ck</span>, <span class="id">n</span>)|] <span class="id">eqn</span>:<span class="id">AS</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">discriminate</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;app&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Common.Common.html#oconcat">oconcat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id">_</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.oconcat_map_check_exp">oconcat_map_check_exp</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (? &amp; ?); <span class="id">auto</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Common.Common.html#omap">omap</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.omap_check_exp">omap_check_exp</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (?&amp;?); <span class="id">auto</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">take</span> (<span class="id"><a href="Velus.Common.CommonList.html#forall2b">forall2b</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#forall2b_Forall2">forall2b_Forall2</a></span> <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.find_base_clock">find_base_clock</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ?<span class="id">c</span> |- <span class="id">_</span> =&gt; <span class="id">rename</span> <span class="id">c</span> <span class="id">into</span> <span class="id">bck</span> <span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Common.CommonList.html#fold_left2">fold_left2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_osub">add_osub</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">ty</span>, <span class="id">ck0</span>, <span class="id">x0</span>) =&gt; (<span class="id">ty</span>, (<span class="id">ck0</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x0</span>))) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l2</span> <span class="id">xs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonList.html#fold_left2">fold_left2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_isub">add_isub</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclocksof">nclocksof</a></span> <span class="id">l0</span>) (<span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id">_</span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>)) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclocksof">nclocksof</a></span> <span class="id">l0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall">Forall2_forall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">_</span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclocksof">nclocksof</a></span> <span class="id">l0</span>)) <span class="id">and</span> <span class="id">rename</span> <span class="id">it</span> <span class="id">into</span> <span class="id">FA2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [|<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">with</span> (1:=<span class="id">FA2</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">x</span>, ((<span class="id">xt</span>, <span class="id">xc</span>), <span class="id">xcaus</span>)) (<span class="id">ck</span>, <span class="id">nm</span>) <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_In">Forall2_In</a></span> <span class="kwd">with</span> (1:=<span class="id">Ix</span>), <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_inst_correct">check_inst_correct</a></span> <span class="kwd">in</span> <span class="id">FA2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_nodup">n_nodup</a></span>) <span class="kwd">as</span> (<span class="id">ND</span>&amp;<span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.fold_left2_add_osub_skip">fold_left2_add_osub_skip</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.fold_left2_add_isub">fold_left2_add_isub</a></span> <span class="kwd">with</span> (1:=<span class="id">Ix</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_l">NoDup_app_l</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.empty_in_iff">Env.Props.P.F.empty_in_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_combine_l">in_combine_l</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span> <span class="kwd">in</span> <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_In">NoDup_app_In</a></span>; <span class="id">eauto</span>. <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Common.CommonList.html#Forall3">Forall3</a></span> (<span class="kwd">fun</span> <span class="id">xck</span> <span class="id">ck2</span> <span class="id">x2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Common.CommonList.html#fold_left2">fold_left2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_osub">add_osub</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">ty</span>, <span class="id">ck0</span>, <span class="id">x0</span>) =&gt; (<span class="id">ty</span>, (<span class="id">ck0</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x0</span>))) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l2</span> <span class="id">xs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonList.html#fold_left2">fold_left2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.add_isub">add_isub</a></span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclocksof">nclocksof</a></span> <span class="id">l0</span>) (<span class="id"><a href="Velus.Environment.html#Env.empty">Env.empty</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xck</span> (<span class="id">ck2</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">l2</span>) <span class="id">xs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_combine2">Forall3_combine2</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_map_1">Forall2_map_1</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_forall">Forall2_forall</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">_</span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span>) <span class="id">_</span>) <span class="id">and</span> <span class="id">rename</span> <span class="id">it</span> <span class="id">into</span> <span class="id">FA2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. 2:{ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">FA2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#combine_length">combine_length</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id">H4</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.min_id">Nat.min_id</a></span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">x</span>, ((<span class="id">xt</span>, <span class="id">xc</span>), <span class="id">xcaus</span>)) (<span class="id">ck</span>, <span class="id">nm</span>) <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#combine_map_fst">combine_map_fst</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#combine_map_snd">combine_map_snd</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Ix</span> <span class="kwd">as</span> (((<span class="id">y</span> &amp; (((<span class="id">yt</span> &amp; <span class="id">yc</span>) &amp; <span class="id">ycaus</span>) &amp; <span class="id">yl</span>)), ((? &amp; <span class="id">yc</span>') &amp; <span class="id">ynm</span>)) &amp; <span class="id">EE</span> &amp; <span class="id">Ix</span>); <span class="id">inv</span> <span class="id">EE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_In">Forall2_In</a></span> <span class="kwd">in</span> <span class="id">FA2</span>; [|<span class="id">eauto</span>]; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#In_combine_nth_error">In_combine_nth_error</a></span> <span class="kwd">in</span> <span class="id">Ix</span> <span class="kwd">as</span> (?&amp;?&amp;<span class="id">Hnth2</span>). <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#combine_nth_error">combine_nth_error</a></span> <span class="kwd">in</span> <span class="id">Hnth2</span> <span class="kwd">as</span> (<span class="id">Hnth2</span>&amp;<span class="id">Hnth3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#In_combine_nth_error">In_combine_nth_error</a></span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_inst_correct">check_inst_correct</a></span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">n</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_nodup">n_nodup</a></span>) <span class="kwd">as</span> (<span class="id">ND</span>&amp;<span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.fold_left2_add_osub">fold_left2_add_osub</a></span> ; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_r">NoDup_app_r</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#combine_map_snd">combine_map_snd</a></span>. <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>; <span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">eauto</span>; <span class="id">simpl</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.not_find_in_iff">Env.Props.P.F.not_find_in_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.fold_left2_add_isub_skip">fold_left2_add_isub_skip</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Environment.html#Env.gempty">Env.gempty</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_combine_l">in_combine_l</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span> <span class="kwd">in</span> <span class="id">Ix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ?. <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDup_app_In">NoDup_app_In</a></span>; <span class="id">eauto</span>. <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_reset_correct">check_reset_correct</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Forall2_ignore1</span>' <span class="kwd">in</span> <span class="id">H0</span>. 2:<span class="id">symmetry</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_Forall2">Forall2_Forall2</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore2">Forall2_ignore2</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="id">subst</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="LCLOCKING.check_clock">check_clock</a></span> (<span class="id">ck</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ck</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Con">Con</a></span> <span class="id">ck</span>' <span class="id">x</span> <span class="id">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_var">check_var</a></span> <span class="id">x</span> <span class="id">ck</span>' &amp;&amp; <span class="id">check_clock</span> <span class="id">ck</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.check_clock_correct">check_clock_correct</a></span> : <span class="kwd">forall</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_clock">check_clock</a></span> <span class="id">ck</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression.env">env</a></span>) <span class="id">ck</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ck</span>; <span class="id">intros</span> <span class="id">Hcheck</span>; <span class="id">simpl</span>; <span class="id">auto</span> <span class="kwd">with</span> <span class="id">clocks</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">Hcheck</span> <span class="kwd">as</span> [<span class="id">Hc1</span> <span class="id">Hc2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_var_correct">check_var_correct</a></span> <span class="kwd">in</span> <span class="id">Hc1</span>; <span class="id">auto</span>. <span class="id">inv</span> <span class="id">Hc1</span>. <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateExpression">ValidateExpression</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="LCLOCKING.ValidateBlock">ValidateBlock</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">PSyn</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.decl">decl</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.block">block</a></span> -&gt; <span class="kwd">Prop</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">prefs</span> : <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="LCLOCKING.ValidateBlock.G">G</a></span> : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateBlock.PSyn">PSyn</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateBlock.prefs">prefs</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.check_base_exp">check_base_exp</a></span> <span class="id">venv</span> <span class="id">venvl</span> <span class="id">e</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateBlock.G">G</a></span> <span class="id">venv</span> <span class="id">venvl</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> [<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>] =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.check_base_exp_correct">check_base_exp_correct</a></span> <span class="id">venv</span> <span class="id">venvl</span> <span class="id">env</span> : <span class="kwd">forall</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">venv</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> <span class="id">env</span> <span class="id">x</span> <span class="id">ty</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">venvl</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> <span class="id">env</span> <span class="id">x</span> <span class="id">ty</span> /\ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> <span class="id">env</span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_base_exp">check_base_exp</a></span> <span class="id">venv</span> <span class="id">venvl</span> <span class="id">e</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateBlock.G">G</a></span> <span class="id">env</span> <span class="id">e</span> /\ <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = [<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>].<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Henv</span> <span class="id">Henvl</span> <span class="id">Hc</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_base_exp">check_base_exp</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">Hc</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp_correct">check_exp_correct</a></span> <span class="kwd">in</span> <span class="id">Hc0</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.check_scope">check_scope</a></span> {<span class="id">A</span>} (<span class="id">f_check</span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span> -&gt; <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span> -&gt; <span class="id">A</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">venv</span> <span class="id">venvl</span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.scope">scope</a></span> <span class="id">A</span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span> := <span class="id">s</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">venv</span>' := <span class="id">Env.adds</span>' (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">locs</span>) <span class="id">venv</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">venvl</span>' := <span class="id">Env.adds</span>' (<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">o</span>)) =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">o</span>) <span class="id">locs</span>) <span class="id">venvl</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_clock">check_clock</a></span> <span class="id">venv</span>') (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">_</span>)) =&gt; <span class="id">ck</span>) <span class="id">locs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <span class="id">f_check</span> <span class="id">venv</span>' <span class="id">venvl</span>' <span class="id">blks</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="LCLOCKING.check_block">check_block</a></span> (<span class="id">venv</span> <span class="id">venvl</span> : <span class="id"><a href="Velus.Environment.html#Env.t">Env.t</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) (<span class="id">blk</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.block">block</a></span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">blk</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Beq">Beq</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_equation">check_equation</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateBlock.G">G</a></span> <span class="id">venv</span> <span class="id">venvl</span> <span class="id">eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Blast">Blast</a></span> <span class="id">x</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateBlock.G">G</a></span> <span class="id">venv</span> <span class="id">venvl</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> [<span class="id">ck</span>] =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_last">check_last</a></span> <span class="id">venvl</span> <span class="id">x</span> <span class="id">ck</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Breset">Breset</a></span> <span class="id">blocks</span> <span class="id">er</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="id">check_block</span> <span class="id">venv</span> <span class="id">venvl</span>) <span class="id">blocks</span> &amp;&amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateBlock.G">G</a></span> <span class="id">venv</span> <span class="id">venvl</span> <span class="id">er</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> [<span class="id">ck</span>] =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Bswitch">Bswitch</a></span> <span class="id">ec</span> <span class="id">branches</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#is_nil">is_nil</a></span> <span class="id">branches</span>) &amp;&amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp">check_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateBlock.G">G</a></span> <span class="id">venv</span> <span class="id">venvl</span> <span class="id">ec</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> [<span class="id">ck</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">venv</span>' := <span class="id"><a href="Velus.Environment.html#Env.map">Env.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) (<span class="id"><a href="Velus.Environment.html#Env.Props.P.filter">Env.Props.P.filter</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">ck</span>' =&gt; (<span class="id">ck</span>' ==<span class="id">b</span> <span class="id">ck</span>)) <span class="id">venv</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">venvl</span>' := <span class="id"><a href="Velus.Environment.html#Env.map">Env.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) (<span class="id"><a href="Velus.Environment.html#Env.Props.P.filter">Env.Props.P.filter</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">ck</span>' =&gt; (<span class="id">ck</span>' ==<span class="id">b</span> <span class="id">ck</span>)) <span class="id">venvl</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Branch">Branch</a></span> <span class="id">_</span> <span class="id">blks</span>) =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="id">check_block</span> <span class="id">venv</span>' <span class="id">venvl</span>') <span class="id">blks</span>) <span class="id">branches</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Bauto">Bauto</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Op.type">type</a></span> <span class="id">ck</span> (<span class="id">ini</span>, <span class="id">oth</span>) <span class="id">states</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">venv</span>' := <span class="id"><a href="Velus.Environment.html#Env.map">Env.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) (<span class="id"><a href="Velus.Environment.html#Env.Props.P.filter">Env.Props.P.filter</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">ck</span>' =&gt; (<span class="id">ck</span>' ==<span class="id">b</span> <span class="id">ck</span>)) <span class="id">venv</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">venvl</span>' := <span class="id"><a href="Velus.Environment.html#Env.map">Env.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) (<span class="id"><a href="Velus.Environment.html#Env.Props.P.filter">Env.Props.P.filter</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">ck</span>' =&gt; (<span class="id">ck</span>' ==<span class="id">b</span> <span class="id">ck</span>)) <span class="id">venvl</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_clock">check_clock</a></span> <span class="id">venv</span> <span class="id">ck</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_base_exp">check_base_exp</a></span> <span class="id">venv</span>' <span class="id">venvl</span>' <span class="id">e</span>) <span class="id">ini</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#is_nil">is_nil</a></span> <span class="id">states</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Branch">Branch</a></span> <span class="id">_</span> (<span class="id">unl</span>, <span class="id">blks</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_base_exp">check_base_exp</a></span> <span class="id">venv</span>' <span class="id">venvl</span>' <span class="id">e</span>) <span class="id">unl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_scope">check_scope</a></span> (<span class="kwd">fun</span> <span class="id">venv</span>' <span class="id">venvl</span>' '(<span class="id">blks</span>, <span class="id">trans</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="id">check_block</span> <span class="id">venv</span>' <span class="id">venvl</span>') <span class="id">blks</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_base_exp">check_base_exp</a></span> <span class="id">venv</span>' <span class="id">venvl</span>' <span class="id">e</span>) <span class="id">trans</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">venv</span>' <span class="id">venvl</span>' <span class="id">blks</span>) <span class="id">states</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Blocal">Blocal</a></span> <span class="id">s</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_scope">check_scope</a></span> (<span class="kwd">fun</span> <span class="id">venv</span>' <span class="id">venvl</span>' =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="id">check_block</span> <span class="id">venv</span>' <span class="id">venvl</span>')) <span class="id">venv</span> <span class="id">venvl</span> <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.check_scope_correct">check_scope_correct</a></span> {<span class="id">A</span>} <span class="id">f_check</span> (<span class="id">P_nd</span> : <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">P_wc</span> : <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="kwd">Prop</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">venv</span> <span class="id">venvl</span> <span class="id">env</span> <span class="id">locs</span> (<span class="id">blks</span>: <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">venv</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> <span class="id">env</span> <span class="id">x</span> <span class="id">ty</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">venvl</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> <span class="id">env</span> <span class="id">x</span> <span class="id">ty</span> /\ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> <span class="id">env</span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">venv</span> <span class="id">venvl</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">env</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_nd</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">env</span>) <span class="id">blks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">venv</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> <span class="id">env</span> <span class="id">x</span> <span class="id">ty</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">venvl</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> <span class="id">env</span> <span class="id">x</span> <span class="id">ty</span> /\ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> <span class="id">env</span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_check</span> <span class="id">venv</span> <span class="id">venvl</span> <span class="id">blks</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P_wc</span> <span class="id">env</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">env</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.NoDupScope">NoDupScope</a></span> <span class="id">P_nd</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">env</span>) (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_scope">check_scope</a></span> <span class="id">f_check</span> <span class="id">venv</span> <span class="id">venvl</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_scope">wc_scope</a></span> <span class="id">P_wc</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateBlock.G">G</a></span> <span class="id">env</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Henv</span> <span class="id">Henvl</span> <span class="id">Hp</span> <span class="id">Hnd1</span> <span class="id">Hnd2</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id">Env.adds</span>' (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">locs</span>) <span class="id">venv</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> (<span class="id">env</span> ++ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">locs</span>) <span class="id">x</span> <span class="id">ty</span>) <span class="kwd">as</span> <span class="id">Henv</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span> * <span class="id">Hfind</span>. <span class="id">apply</span> <span class="id">Env.find_adds</span>'<span class="id">_In</span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> [<span class="id">Hfind</span>|<span class="id">Hfind</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl_In</span>. <span class="id">right</span>. <span class="id">econstructor</span>. <span class="id">solve_In</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">Henv</span> <span class="kwd">in</span> <span class="id">Hfind</span>. <span class="id">inv</span> <span class="id">Hfind</span>. <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id">Env.adds</span>' (<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">o</span>)) =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">o</span>) <span class="id">locs</span>) <span class="id">venvl</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> (<span class="id">env</span> ++ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">locs</span>) <span class="id">x</span> <span class="id">ty</span> /\ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> (<span class="id">env</span> ++ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">locs</span>) <span class="id">x</span>) <span class="kwd">as</span> <span class="id">Henvl</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span> * <span class="id">Hfind</span>. <span class="id">apply</span> <span class="id">Env.find_adds</span>'<span class="id">_In</span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> [<span class="id">Hfind</span>|<span class="id">Hfind</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">right</span>; <span class="id">econstructor</span>. 1,3:<span class="id">solve_In</span>. <span class="id">reflexivity</span>. <span class="id">simpl</span>. <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">Henvl</span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> (<span class="id">Hhas</span>&amp;<span class="id">His</span>). <span class="id">inv</span> <span class="id">Hhas</span>. <span class="id">inv</span> <span class="id">His</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">Hc</span>. <span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> (<span class="id">CC</span>&amp;<span class="id">CB</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span> <span class="kwd">in</span> <span class="id">CC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_clock_correct">check_clock_correct</a></span> <span class="kwd">in</span> <span class="id">CC</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hnd2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Hp</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.NoDupScope_NoDupMembers">NoDupScope_NoDupMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.check_block_correct">check_block_correct</a></span>: <span class="kwd">forall</span> <span class="id">blk</span> <span class="id">venv</span> <span class="id">venvl</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">venv</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> <span class="id">env</span> <span class="id">x</span> <span class="id">ty</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ty</span>, <span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> <span class="id">venvl</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> <span class="id">env</span> <span class="id">x</span> <span class="id">ty</span> /\ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> <span class="id">env</span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">env</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.NoDupLocals">NoDupLocals</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">env</span>) <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_block">check_block</a></span> <span class="id">venv</span> <span class="id">venvl</span> <span class="id">blk</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_block">wc_block</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateBlock.G">G</a></span> <span class="id">env</span> <span class="id">blk</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Opaque</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_scope">check_scope</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">Henv</span> <span class="id">Henvl</span> <span class="id">Hnd1</span> <span class="id">Hnd2</span> <span class="id">CE</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">Hnd2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;equation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_equation_correct">check_equation_correct</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;last&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp_correct">check_exp_correct</a></span> <span class="kwd">in</span> <span class="id">EQ</span> <span class="kwd">as</span> (<span class="id">Hwc1</span>&amp;<span class="id">Hwc2</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_last_correct">check_last_correct</a></span> <span class="kwd">in</span> <span class="id">CE</span> <span class="kwd">as</span> (<span class="id">Ty</span>&amp;<span class="id">L</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">CE</span> <span class="kwd">as</span> (<span class="id">CDs</span>&amp;<span class="id">CE</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">CEr</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp_correct">check_exp_correct</a></span> <span class="kwd">in</span> <span class="id">CEr</span> <span class="kwd">as</span> (?&amp;<span class="id">Hnck</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span> <span class="kwd">in</span> <span class="id">CDs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> *; <span class="id">intros</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;switch&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">CE</span> <span class="kwd">as</span> (<span class="id">CNnil</span>&amp;<span class="id">CE</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">CE</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_exp_correct">check_exp_correct</a></span> <span class="kwd">in</span> <span class="id">CE0</span> <span class="kwd">as</span> (?&amp;<span class="id">Hck</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Environment.html#Env.Props.P.filter">Env.Props.P.filter</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">as</span> <span class="id">venv</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_Bswitch">wc_Bswitch</a></span> <span class="kwd">with</span> (Γ':=<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">e</span>) =&gt; <span class="kwd">if</span> <span class="id">e</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.clo">clo</a></span>) ==<span class="id">b</span> <span class="id">c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.ann_with_clock">ann_with_clock</a></span> <span class="id">e</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">contradict</span> <span class="id">CNnil</span>; <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> * <span class="id">Hhas</span>. <span class="id">inv</span> <span class="id">Hhas</span>. <span class="id">simpl_In</span>. <span class="id">cases_eqn</span> <span class="id">Heq</span>; <span class="id">inv</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="id">inv</span> <span class="id">Heq</span>. <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. <span class="id">econstructor</span>; <span class="id">eauto</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> * <span class="id">Hil</span>. <span class="id">inv</span> <span class="id">Hil</span>. <span class="id">simpl_In</span>. <span class="id">cases</span>; <span class="id">inv</span> <span class="id">Hf</span>. <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span> <span class="kwd">in</span> <span class="id">CE</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.NoDupBranch">NoDupBranch</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span> <span class="kwd">in</span> <span class="id">CE</span>. <span class="id">simpl_Forall</span>. <span class="id">eapply</span> <span class="id">H</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;destruct&nbsp;s.&nbsp;eapply&nbsp;check_scope_correct&nbsp;with&nbsp;(P_nd:=fun&nbsp;Γ&nbsp;=&gt;&nbsp;Forall&nbsp;(NoDupLocals&nbsp;Γ)).&nbsp;6:eauto.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:(<span class="id">subst</span>; <span class="id">intros</span> * <span class="id">Hfind</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.map_o">Env.Props.P.F.map_o</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="id">inv_equalities</span>; <span class="id">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.filter_iff">Env.Props.P.filter_iff</a></span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> (<span class="id">Hfind</span>&amp;<span class="id">Heq</span>); [|<span class="id">intros</span> ??????; <span class="id">subst</span>; <span class="id">reflexivity</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="id">inv</span> <span class="id">Heq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id">Henv</span> <span class="kwd">in</span> <span class="id">Hfind</span>. <span class="id">inv</span> <span class="id">Hfind</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_In</span>; <span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span>. 1,2:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id">Henvl</span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> (<span class="id">Hhas</span>&amp;<span class="id">His</span>). <span class="id">inv</span> <span class="id">Hhas</span>. <span class="id">inv</span> <span class="id">His</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_det">NoDupMembers_det</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">eauto</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">econstructor</span>; <span class="id">solve_In</span>; <span class="id">simpl</span>; <span class="id">try</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span>. 1-3:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_map_filter">NoDupMembers_map_filter</a></span>; <span class="id">auto</span>. <span class="id">intros</span>; <span class="id">destruct_conjs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ??. <span class="id">solve_In</span>. <span class="id">destruct</span> (<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>); <span class="id">inv</span> <span class="id">Hf</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;automaton&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">CE</span>. <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span> <span class="kwd">in</span> <span class="id">CE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">CE</span> <span class="kwd">as</span> (((<span class="id">CC</span>&amp;<span class="id">CE</span>)&amp;<span class="id">CNnil</span>)&amp;<span class="id">CB</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> (<span class="id">x</span> : <span class="id"><a href="Velus.Environment.html#Env.key">Env.key</a></span>) (<span class="id">ty</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Environment.html#Env.map">Env.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) (<span class="id"><a href="Velus.Environment.html#Env.Props.P.filter">Env.Props.P.filter</a></span> (<span class="kwd">fun</span> (<span class="id">_</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.FSets.FMapPositive.html#PositiveMap.key">FMapPositive.PositiveMap.key</a></span>) (<span class="id">ck</span>' : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) =&gt; <span class="id">ck</span>' ==<span class="id">b</span> <span class="id">ck</span>) <span class="id">venv</span>)) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x0</span>, <span class="id">e2</span>) =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.clo">clo</a></span> <span class="id">e2</span> ==<span class="id">b</span> <span class="id">ck</span> <span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">x0</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.ann_with_clock">ann_with_clock</a></span> <span class="id">e2</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id">env</span>) <span class="id">x</span> <span class="id">ty</span>) <span class="kwd">as</span> <span class="id">Henv</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">intros</span> * <span class="id">Hfind</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.map_o">Env.Props.P.F.map_o</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="id">inv_equalities</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.filter_iff">Env.Props.P.filter_iff</a></span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> (<span class="id">Hfind</span>&amp;<span class="id">Heq</span>); [|<span class="id">intros</span> ??????; <span class="id">subst</span>; <span class="id">reflexivity</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="id">inv</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Henv</span> <span class="kwd">in</span> <span class="id">Hfind</span>. <span class="id">inv</span> <span class="id">Hfind</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_In</span>; <span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span>. 1,2:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> (<span class="id">x</span> : <span class="id"><a href="Velus.Environment.html#Env.key">Env.key</a></span>) (<span class="id">ty</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Environment.html#Env.map">Env.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) (<span class="id"><a href="Velus.Environment.html#Env.Props.P.filter">Env.Props.P.filter</a></span> (<span class="kwd">fun</span> (<span class="id">_</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.FSets.FMapPositive.html#PositiveMap.key">FMapPositive.PositiveMap.key</a></span>) (<span class="id">ck</span>' : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) =&gt; <span class="id">ck</span>' ==<span class="id">b</span> <span class="id">ck</span>) <span class="id">venvl</span>)) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x0</span>, <span class="id">e2</span>) =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.clo">clo</a></span> <span class="id">e2</span> ==<span class="id">b</span> <span class="id">ck</span> <span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">x0</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.ann_with_clock">ann_with_clock</a></span> <span class="id">e2</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id">env</span>) <span class="id">x</span> <span class="id">ty</span> /\ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x0</span>, <span class="id">e2</span>) =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.clo">clo</a></span> <span class="id">e2</span> ==<span class="id">b</span> <span class="id">ck</span> <span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">x0</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.ann_with_clock">ann_with_clock</a></span> <span class="id">e2</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id">env</span>) <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="kwd">as</span> <span class="id">Henvl</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span>; <span class="id">intros</span> * <span class="id">Hfind</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.F.map_o">Env.Props.P.F.map_o</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="id">inv_equalities</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Environment.html#Env.Props.P.filter_iff">Env.Props.P.filter_iff</a></span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> (<span class="id">Hfind</span>&amp;<span class="id">Heq</span>); [|<span class="id">intros</span> ??????; <span class="id">subst</span>; <span class="id">reflexivity</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="id">inv</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Henvl</span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> (<span class="id">Hhas</span>&amp;<span class="id">His</span>). <span class="id">inv</span> <span class="id">Hhas</span>. <span class="id">inv</span> <span class="id">His</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_det">NoDupMembers_det</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">econstructor</span>; <span class="id">solve_In</span>; <span class="id">simpl</span>; <span class="id">try</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span>. 1-3:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_Bauto">wc_Bauto</a></span> <span class="kwd">with</span> (Γ':=<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">e</span>) =&gt; <span class="kwd">if</span> <span class="id">e</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.clo">clo</a></span>) ==<span class="id">b</span> <span class="id">ck</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.ann_with_clock">ann_with_clock</a></span> <span class="id">e</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_clock_correct">check_clock_correct</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">contradict</span> <span class="id">CNnil</span>; <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> * <span class="id">Hhas</span>. <span class="id">inv</span> <span class="id">Hhas</span>. <span class="id">simpl_In</span>. <span class="id">cases_eqn</span> <span class="id">Heq</span>; <span class="id">inv</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_equiv">equiv_decb_equiv</a></span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="id">inv</span> <span class="id">Heq</span>. <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. <span class="id">econstructor</span>; <span class="id">eauto</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> * <span class="id">Hil</span>. <span class="id">inv</span> <span class="id">Hil</span>. <span class="id">simpl_In</span>. <span class="id">cases</span>; <span class="id">inv</span> <span class="id">Hf</span>. <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_base_exp_correct">check_base_exp_correct</a></span> <span class="kwd">in</span> <span class="id">CE</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.NoDupBranch">NoDupBranch</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>. <span class="id">destruct_conjs</span>; <span class="id">destruct</span> <span class="id">s</span>; <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">CB</span> <span class="kwd">as</span> (<span class="id">CL</span>&amp;<span class="id">CS</span>). <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span> <span class="kwd">in</span> <span class="id">CL</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_base_exp_correct">check_base_exp_correct</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_scope_correct">check_scope_correct</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_map_filter">NoDupMembers_map_filter</a></span>; <span class="id">auto</span>. <span class="id">intros</span>; <span class="id">destruct_conjs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases</span>; <span class="id">simpl</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.NoDupScope_incl">NoDupScope_incl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hincl</span> ?; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.NoDupLocals_incl">NoDupLocals_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> ??. <span class="id">solve_In</span>. <span class="id">destruct</span> (<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>); <span class="id">inv</span> <span class="id">Hf</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * ???? <span class="id">Hc</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span>, 2 <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span> <span class="kwd">in</span> <span class="id">Hc</span>. <span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> (?&amp;<span class="id">CT</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_base_exp_correct">check_base_exp_correct</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_scope_correct">check_scope_correct</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * ???? <span class="id">Hc</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span> <span class="kwd">in</span> <span class="id">Hc</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateBlock">ValidateBlock</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="LCLOCKING.ValidateGlobal">ValidateGlobal</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.check_env">check_env</a></span> (<span class="id">env</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>)) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_clock">check_clock</a></span> (<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> <span class="id">env</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">env</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.check_node">check_node</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) (<span class="id">n</span> : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.node">node</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ins</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">outs</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">_</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span> <span class="id">n</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">insouts</span> := <span class="id">ins</span>++<span class="id">outs</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">venv</span> := <span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> <span class="id">insouts</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">venvl</span> := <span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">o</span>)) =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; (<span class="id">x</span>, <span class="id">ck</span>)) <span class="id">o</span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_env">check_env</a></span> <span class="id">ins</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_env">check_env</a></span> <span class="id">insouts</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_block">check_block</a></span> <span class="id">G</span> <span class="id">venv</span> <span class="id">venvl</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_block">n_block</a></span> <span class="id">n</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.check_global">check_global</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.Common.html#check_nodup">check_nodup</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_name">n_name</a></span> <span class="id">G</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nodes">nodes</a></span>)) &amp;&amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fix</span> <span class="id">aux</span> <span class="id">nds</span> := <span class="kwd">match</span> <span class="id">nds</span>  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#hd">hd</a></span>::<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#tl">tl</a></span> =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_node">check_node</a></span> (<span class="id"><a href="Velus.Common.CommonProgram.html#update">update</a></span> <span class="id">G</span> <span class="id">tl</span>) <span class="id">hd</span> &amp;&amp; <span class="id">aux</span> <span class="id">tl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) <span class="id">G</span>.(<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nodes">nodes</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.check_env_correct">check_env_correct</a></span> : <span class="kwd">forall</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_env">check_env</a></span> <span class="id">env</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">env</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">env</span> <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_env">check_env</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#forallb_Forall">forallb_Forall</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span> <span class="kwd">in</span> <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="id">eauto</span>; <span class="id">intros</span> ? <span class="id">Hc</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_clock_correct">check_clock_correct</a></span> <span class="kwd">with</span> (<span class="id">env</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">ck</span>) =&gt; (<span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.Build_annotation">Build_annotation</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#OpAux.bool_velus_type">bool_velus_type</a></span> <span class="id">ck</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)) <span class="id">env</span>) <span class="kwd">in</span> <span class="id">Hc</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock_incl">wc_clock_incl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> ??. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span> <span class="kwd">in</span> *. <span class="id">simpl_In</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> ?? <span class="id">Hfind</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Environment.html#Env.from_list_find_In">Env.from_list_find_In</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">solve_In</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.check_node_correct">check_node_correct</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_node">check_node</a></span> <span class="id">G</span> <span class="id">n</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_node">wc_node</a></span> <span class="id">G</span> <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_node">check_node</a></span> <span class="kwd">in</span> <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">Hcheck</span>. <span class="id">destruct</span> <span class="id">Hcheck</span> <span class="kwd">as</span> ((<span class="id">Hc1</span>&amp;<span class="id">Hc2</span>)&amp;<span class="id">Hc3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x0</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>)) =&gt; (<span class="id">x0</span>, <span class="id">ck</span>)) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x0</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">_</span>)) =&gt; (<span class="id">x0</span>, <span class="id">ck</span>)) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span> <span class="id">n</span>))) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) <span class="id">x</span> <span class="id">ck</span>) <span class="kwd">as</span> <span class="id">Henv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span> * <span class="id">Find</span>. <span class="id">clear</span> - <span class="id">Find</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Environment.html#Env.from_list_find_In">Env.from_list_find_In</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">Find</span> <span class="kwd">as</span> [<span class="id">In</span>|<span class="id">In</span>]; <span class="id">simpl_In</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">left</span>|<span class="id">right</span>]; <span class="id">econstructor</span>; <span class="id">solve_In</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Environment.html#Env.find">Env.find</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Environment.html#Env.from_list">Env.from_list</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x0</span>, (<span class="id">_</span>, <span class="id">ck</span>, <span class="id">_</span>, <span class="id">o</span>)) =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; (<span class="id">x0</span>, <span class="id">ck</span>)) <span class="id">o</span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span> <span class="id">n</span>))) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) <span class="id">x</span> <span class="id">ck</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.senv_of_ins">senv_of_ins</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_in">n_in</a></span> <span class="id">n</span>) ++ <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.senv_of_decls">senv_of_decls</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span> <span class="id">n</span>)) <span class="id">x</span>) <span class="kwd">as</span> <span class="id">Henvl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span> * <span class="id">Find</span>. <span class="id">clear</span> - <span class="id">Find</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Environment.html#Env.from_list_find_In">Env.from_list_find_In</a></span> <span class="kwd">in</span> <span class="id">Find</span>; <span class="id">simpl_In</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">right</span>; <span class="id">econstructor</span>; <span class="id">solve_In</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1-2:<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_env_correct">check_env_correct</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_block_correct">check_block_correct</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.node_NoDupMembers">node_NoDupMembers</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.node_NoDupLocals">node_NoDupLocals</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.check_global_correct">check_global_correct</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_global">check_global</a></span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_global">wc_global</a></span> <span class="id">G</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">G</span> <span class="id">Hcheck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">Hcheck</span>; <span class="id">destruct</span> <span class="id">Hcheck</span> <span class="kwd">as</span> [<span class="id">Hndup</span> <span class="id">Hcheck</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.Common.html#check_nodup_correct">check_nodup_correct</a></span> <span class="kwd">in</span> <span class="id">Hndup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_global">wc_global</a></span>, <span class="id"><a href="Velus.Common.CommonTyping.html#wt_program">wt_program</a></span>, <span class="id"><a href="Velus.Common.CommonProgram.html#units">units</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nodes">nodes</a></span> <span class="id">G</span>); <span class="id">constructor</span>; <span class="id">inv</span> <span class="id">Hndup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1-2:<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hcheck</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">Bool.andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">Hcheck</span> <span class="kwd">as</span> [<span class="id">Hc1</span> <span class="id">Hc2</span>]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.check_node_correct">check_node_correct</a></span> <span class="kwd">in</span> <span class="id">Hc1</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Environment.html#Env.elements_from_list_incl">Env.elements_from_list_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>. <span class="id">intros</span> ? <span class="id">Hin</span> <span class="id">contra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H1</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>. <span class="kwd">exists</span> <span class="id">x</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.ValidateGlobal">ValidateGlobal</a></span>.<br/>
<br/>
<h3> Some additional properties related to remove_member </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.remove_member">remove_member</a></span> {<span class="id">B</span>} := @<span class="id"><a href="Velus.Common.CommonList.html#remove_member">remove_member</a></span> <span class="id">_</span> <span class="id">B</span> <span class="id"><a href="Velus.Common.Common.html#EqDec_instance_0">Common.EqDec_instance_0</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_clock_nfreein_remove">wc_clock_nfreein_remove</a></span> : <span class="kwd">forall</span> <span class="id">vars</span> <span class="id">id</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Is_free_in_clock">Is_free_in_clock</a></span> <span class="id">id</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> <span class="id">vars</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.remove_member">remove_member</a></span> <span class="id">id</span> <span class="id">vars</span>) <span class="id">ck</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">vars</span> <span class="id">id</span> <span class="id">ck</span> <span class="id">Hnfree</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">Hwc</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">IHHwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">Hfree</span>'. <span class="id">apply</span> <span class="id">Hnfree</span>; <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">clear</span> <span class="id">IHHwc</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#remove_member_neq_In">remove_member_neq_In</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">contra</span>; <span class="id">subst</span>. <span class="id">apply</span> <span class="id">Hnfree</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_env_nfreein_remove">wc_env_nfreein_remove</a></span> : <span class="kwd">forall</span> <span class="id">id</span> <span class="id">vars</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">ck</span>) =&gt; ~<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Is_free_in_clock">Is_free_in_clock</a></span> <span class="id">id</span> <span class="id">ck</span>) <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.remove_member">remove_member</a></span> <span class="id">id</span> <span class="id">vars</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">id</span> <span class="id">vars</span> <span class="id">Hndup</span> <span class="id">Hwc</span> <span class="id">Hfree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_Forall">Forall_Forall</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_incl">Forall_incl</a></span>. 2:<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#remove_member_incl">remove_member_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">id</span>' <span class="id">ck</span>'] <span class="id">H</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">H1</span> <span class="id">H2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_clock_nfreein_remove">wc_clock_nfreein_remove</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">simpl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">wc_clock_nfreein_remove</span>' : <span class="kwd">forall</span> <span class="id">vars</span> <span class="id">id</span> <span class="id">ck</span> <span class="id">ck</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Is_free_in_clock">Is_free_in_clock</a></span> <span class="id">id</span> <span class="id">ck</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> ((<span class="id">id</span>, <span class="id">ck</span>)::<span class="id">vars</span>) <span class="id">ck</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> <span class="id">vars</span> <span class="id">ck</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">vars</span> <span class="id">id</span> <span class="id">ck</span> <span class="id">ck</span>' <span class="id">Hnfree</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">Hwc</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">IHHwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">Hfree</span>'. <span class="id">apply</span> <span class="id">Hnfree</span>; <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">clear</span> <span class="id">IHHwc</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Hnfree</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.clock_parent_In">clock_parent_In</a></span> : <span class="kwd">forall</span> <span class="id">vars</span> <span class="id">ck</span> <span class="id">ck</span>' <span class="id">id</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> <span class="id">vars</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock_parent">clock_parent</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Con">Con</a></span> <span class="id">ck</span>' <span class="id">id</span> <span class="id">b</span>) <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">id</span>, <span class="id">ck</span>') <span class="id">vars</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ck</span>; <span class="id">intros</span> * <span class="id">Hwc</span> <span class="id">Hparent</span>; <span class="id">inv</span> <span class="id">Hwc</span>; <span class="id">inv</span> <span class="id">Hparent</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">The clock of a var cant depend on its var </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_nfree_in_clock">wc_nfree_in_clock</a></span> : <span class="kwd">forall</span> <span class="id">vars</span> <span class="id">ck</span> <span class="id">id</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">id</span>, <span class="id">ck</span>) <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> <span class="id">vars</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Is_free_in_clock">Is_free_in_clock</a></span> <span class="id">id</span> <span class="id">ck</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">vars</span> <span class="id">ck</span> <span class="id">id</span> <span class="id">Hndup</span> <span class="id">Hin</span> <span class="id">Hwc</span> <span class="id">contra</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Is_free_in_clock_self_or_parent">Is_free_in_clock_self_or_parent</a></span> <span class="kwd">in</span> <span class="id">contra</span> <span class="kwd">as</span> [<span class="id">ck</span>' [<span class="id">b</span> [<span class="id">H</span>|<span class="id">H</span>]]]; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_det">NoDupMembers_det</a></span> <span class="kwd">in</span> <span class="id">Hndup</span>. 2:<span class="id">eapply</span> <span class="id">H3</span>. 2:<span class="id">eapply</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock_not_in_clock">clock_not_in_clock</a></span> <span class="kwd">in</span> <span class="id">Hndup</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">id</span>, <span class="id">ck</span>') <span class="id">vars</span>) <span class="kwd">as</span> <span class="id">Hin</span>' <span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.clock_parent_In">clock_parent_In</a></span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">clock_parent_parent</span>' <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock_parent_no_loops">clock_parent_no_loops</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_det">NoDupMembers_det</a></span> <span class="kwd">in</span> <span class="id">Hndup</span>. 2:<span class="id">eapply</span> <span class="id">Hin</span>. 2:<span class="id">eapply</span> <span class="id">Hin</span>'. <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h3> A clock dependency order </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCLOCKING.dep_ordered_clocks">dep_ordered_clocks</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.dep_ord_clock_nil">dep_ord_clock_nil</a></span> : <span class="id">dep_ordered_clocks</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.dep_ord_clock_cons">dep_ord_clock_cons</a></span> : <span class="kwd">forall</span> <span class="id">ck</span> <span class="id">id</span> <span class="id">ncks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dep_ordered_clocks</span> <span class="id">ncks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Is_free_in_clock">Is_free_in_clock</a></span> <span class="id">id</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">ncks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dep_ordered_clocks</span> ((<span class="id">id</span>, <span class="id">ck</span>)::<span class="id">ncks</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="id">Program</span> <span class="kwd">Fixpoint</span> <span class="id"><a name="LCLOCKING.wc_env_dep_ordered">wc_env_dep_ordered</a></span> (<span class="id">vars</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>)) {<span class="id">measure</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">vars</span>)} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">vars</span>', <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">vars</span> <span class="id">vars</span>' /\ <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_clocks">dep_ordered_clocks</a></span> <span class="id">vars</span>' := <span class="id">_</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof51')">Next Obligation.</span></div>
<div class="proofscript" id="proof51">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rename</span> <span class="id">H</span> <span class="id">into</span> <span class="id">Hndup</span>. <span class="id">rename</span> <span class="id">H0</span> <span class="id">into</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">exists_child_clock</span>' <span class="id">vars</span> <span class="id">Hndup</span> <span class="id">Hwc</span>) <span class="kwd">as</span> [?|[<span class="id">id</span> [<span class="id">ck</span> [<span class="id">Hin</span> <span class="id">Hfree</span>]]]]; <span class="id">subst</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="kwd">exists</span> []. <span class="id">split</span>; <span class="id">auto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.remove_member">remove_member</a></span> <span class="id">id</span> <span class="id">vars</span>) <span class="kwd">as</span> <span class="id">vars</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">vars</span>') <span class="kwd">as</span> <span class="id">Hndup</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#remove_member_NoDupMembers">remove_member_NoDupMembers</a></span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">vars</span>') <span class="kwd">as</span> <span class="id">Hwc</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_env_nfreein_remove">wc_env_nfreein_remove</a></span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">vars</span>' &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">vars</span>) <span class="kwd">as</span> <span class="id">Hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Heqvars</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="Velus.Common.CommonList.html#remove_member_Perm">remove_member_Perm</a></span> <span class="id"><a href="Velus.Common.Common.html#EqDec_instance_0">Common.EqDec_instance_0</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hndup</span> <span class="id">Hin</span>) <span class="kwd">as</span> <span class="id">Hperm</span>. <span class="id">symmetry</span> <span class="kwd">in</span> <span class="id">Hperm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_length">Permutation_length</a></span> <span class="kwd">in</span> <span class="id">Hperm</span>. <span class="id">rewrite</span> <span class="id">Hperm</span>; <span class="id">simpl</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.lt_succ_diag_r">PeanoNat.Nat.lt_succ_diag_r</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">wc_env_dep_ordered</span> <span class="id">_</span> <span class="id">Hlen</span> <span class="id">Hndup</span>' <span class="id">Hwc</span>') <span class="kwd">as</span> [<span class="id">vars</span>'' [<span class="id">Hperm</span> <span class="id">Hdep</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> ((<span class="id">id</span>, <span class="id">ck</span>)::<span class="id">vars</span>''). <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> &lt;- <span class="id">Hperm</span>, <span class="id">Heqvars</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#remove_member_Perm">remove_member_Perm</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>. <span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_Exists_neg">Forall_Exists_neg</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>, &lt;- <span class="id">Hperm</span>, <span class="id">Heqvars</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_incl">Forall_incl</a></span>. 2:<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#remove_member_incl">remove_member_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">id</span>' <span class="id">ck</span>'] <span class="id">H</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.wc_clock_dep_ordered_remove">wc_clock_dep_ordered_remove</a></span> : <span class="kwd">forall</span> <span class="id">id</span> <span class="id">ck</span> <span class="id">x</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> (<span class="id">x</span>::<span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">id</span>, <span class="id">ck</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_clocks">dep_ordered_clocks</a></span> (<span class="id">x</span>::<span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> (<span class="id">x</span>::<span class="id">xs</span>) <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> <span class="id">xs</span> <span class="id">ck</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">id</span> <span class="id">ck</span> [<span class="id">id</span>' <span class="id">ck</span>'] <span class="id">xs</span> <span class="id">Hndup</span> <span class="id">Hin</span> <span class="id">Hdep</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_clock_nfreein_remove">wc_clock_nfreein_remove</a></span> <span class="kwd">with</span> (<span class="id">id</span>:=<span class="id">id</span>') <span class="kwd">in</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="Velus.Common.Common.html#EqDec_instance_0">Common.EqDec_instance_0</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hndup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.remove_member">remove_member</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#remove_member_nIn_idem">remove_member_nIn_idem</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hdep</span>. <span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_Exists_neg">Forall_Exists_neg</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H3</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>. <span class="kwd">exists</span> (<span class="id">id</span>, <span class="id">ck</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCLOCKING.wc_env_dep_ordered_remove">wc_env_dep_ordered_remove</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> (<span class="id">x</span>::<span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_clocks">dep_ordered_clocks</a></span> (<span class="id">x</span>::<span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> (<span class="id">x</span>::<span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof53')">Proof with</span></div>
<div class="proofscript" id="proof53">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">id</span>' <span class="id">ck</span>'] <span class="id">xs</span> <span class="id">Hndup</span> <span class="id">Hdep</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_impl_In">Forall_impl_In</a></span>; [| <span class="id">eauto</span>]. <span class="id">intros</span> [<span class="id">id</span> <span class="id">ck</span>] <span class="id">Hin</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_clock_dep_ordered_remove">wc_clock_dep_ordered_remove</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>...<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h3> Another equivalent clock dependency order </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.only_depends_on">only_depends_on</a></span> (<span class="id">vars</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id">ck</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Is_free_in_clock">Is_free_in_clock</a></span> <span class="id">id</span> <span class="id">ck</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">id</span> <span class="id">vars</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.only_depends_on_Con">only_depends_on_Con</a></span> : <span class="kwd">forall</span> <span class="id">vars</span> <span class="id">ck</span> <span class="id">id</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on">only_depends_on</a></span> <span class="id">vars</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Con">Con</a></span> <span class="id">ck</span> <span class="id">id</span> <span class="id">b</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on">only_depends_on</a></span> <span class="id">vars</span> <span class="id">ck</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">vars</span> <span class="id">ck</span> <span class="id">id</span> <span class="id">b</span> <span class="id">Hon</span> <span class="id">id</span>' <span class="id">Hisfree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Hon</span>. <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.only_depends_on_incl">only_depends_on_incl</a></span> : <span class="kwd">forall</span> <span class="id">vars</span> <span class="id">vars</span>' <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id">vars</span> <span class="id">vars</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on">only_depends_on</a></span> <span class="id">vars</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on">only_depends_on</a></span> <span class="id">vars</span>' <span class="id">ck</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">vars</span> <span class="id">vars</span>' <span class="id">ck</span> <span class="id">Hincl</span> <span class="id">Honly</span> <span class="id">id</span> <span class="id">Hfree</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_clock_only_depends_on">wc_clock_only_depends_on</a></span> : <span class="kwd">forall</span> <span class="id">vars</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> <span class="id">vars</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on">only_depends_on</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">vars</span>) <span class="id">ck</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">vars</span> <span class="id">ck</span> <span class="id">Hwc</span> <span class="id">id</span> <span class="id">Hisfree</span>; <span class="id">induction</span> <span class="id">Hwc</span>; <span class="id">inv</span> <span class="id">Hisfree</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>. <span class="kwd">exists</span> (<span class="id">x</span>, <span class="id">ck</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="LCLOCKING.dep_ordered_on">dep_ordered_on</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.dep_ordered_nil">dep_ordered_nil</a></span> : <span class="id">dep_ordered_on</span> []<br/>
&nbsp;&nbsp;| <span class="id"><a name="LCLOCKING.dep_ordered_cons">dep_ordered_cons</a></span> : <span class="kwd">forall</span> <span class="id">nck</span> <span class="id">ncks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dep_ordered_on</span> <span class="id">ncks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on">only_depends_on</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ncks</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">nck</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dep_ordered_on</span> (<span class="id">nck</span>::<span class="id">ncks</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.dep_ordered_on_InMembers">dep_ordered_on_InMembers</a></span> : <span class="kwd">forall</span> <span class="id">ncks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_on">dep_ordered_on</a></span> <span class="id">ncks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">ck</span> =&gt; <span class="kwd">forall</span> <span class="id">id</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Is_free_in_clock">Is_free_in_clock</a></span> <span class="id">id</span> <span class="id">ck</span> -&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">id</span> <span class="id">ncks</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">ncks</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">ncks</span> <span class="id">Hdep</span>. <span class="id">induction</span> <span class="id">Hdep</span>; <span class="id">simpl</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> <span class="id">id</span> <span class="id">Hfree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">nck</span> <span class="kwd">as</span> [<span class="id">id</span>' <span class="id">ck</span>']; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">Hfree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">id</span> <span class="id">ck</span>] <span class="id">Hin</span> <span class="id">id</span>' <span class="id">Hisfree</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">nck</span> <span class="kwd">as</span> [<span class="id">id</span>'' <span class="id">ck</span>''].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Hin</span> <span class="kwd">in</span> <span class="id">Hisfree</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.dep_ordered_dep_ordered_on">dep_ordered_dep_ordered_on</a></span> : <span class="kwd">forall</span> <span class="id">ncks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">ncks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">ncks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_clocks">dep_ordered_clocks</a></span> <span class="id">ncks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_on">dep_ordered_on</a></span> <span class="id">ncks</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof58')">Proof with</span></div>
<div class="proofscript" id="proof58">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ncks</span>; <span class="id">intros</span> <span class="id">Hndup</span> <span class="id">Hwc</span> <span class="id">Hdep</span>; [<span class="id">constructor</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hndup</span>. <span class="id">inv</span> <span class="id">Hdep</span>. <span class="id">constructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">IHncks</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_env_dep_ordered_remove">wc_env_dep_ordered_remove</a></span> <span class="kwd">with</span> (<span class="id">x</span>:=(<span class="id">a0</span>, <span class="id">b</span>)) <span class="kwd">in</span> <span class="id">Hwc</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">constructor</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hwc</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_clock_only_depends_on">wc_clock_only_depends_on</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock_no_loops_remove">wc_clock_no_loops_remove</a></span>...<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.dep_ordered_on_dep_ordered">dep_ordered_on_dep_ordered</a></span> : <span class="kwd">forall</span> <span class="id">ncks</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">ncks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">ncks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_on">dep_ordered_on</a></span> <span class="id">ncks</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_clocks">dep_ordered_clocks</a></span> <span class="id">ncks</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof59')">Proof with</span></div>
<div class="proofscript" id="proof59">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ncks</span> <span class="kwd">as</span> [|[<span class="id">id</span> <span class="id">ck</span>]]; <span class="id">intros</span> <span class="id">Hndup</span> <span class="id">Hwc</span> <span class="id">Hdep</span>; [<span class="id">constructor</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hndup</span>':=<span class="id">Hndup</span>). <span class="id">inv</span> <span class="id">Hndup</span>'; <span class="id">inv</span> <span class="id">Hdep</span>. <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">IHncks</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_env_nfreein_remove">wc_env_nfreein_remove</a></span> <span class="kwd">with</span> (<span class="id">id</span>:=<span class="id">id</span>) <span class="kwd">in</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">destruct</span> <span class="id"><a href="Velus.Common.Common.html#EqDec_instance_0">Common.EqDec_instance_0</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.remove_member">remove_member</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#remove_member_nIn_idem">remove_member_nIn_idem</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_nfree_in_clock">wc_nfree_in_clock</a></span> <span class="kwd">in</span> <span class="id">Hndup</span>... 1:<span class="id">constructor</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwc</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_on_InMembers">dep_ordered_on_InMembers</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="id">eauto</span>. <span class="id">intros</span> [? ?] ? <span class="id">contra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">contra</span>. <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_on_InMembers">dep_ordered_on_InMembers</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_Exists_neg">Forall_Exists_neg</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">a</span> <span class="id">H</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">contra</span>. <span class="id">apply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">contra</span>. <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCLOCKING.dep_ordered_iff">dep_ordered_iff</a></span> : <span class="kwd">forall</span> <span class="id">vars</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_clocks">dep_ordered_clocks</a></span> <span class="id">vars</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_on">dep_ordered_on</a></span> <span class="id">vars</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof60')">Proof with</span></div>
<div class="proofscript" id="proof60">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_dep_ordered_on">dep_ordered_dep_ordered_on</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_on_dep_ordered">dep_ordered_on_dep_ordered</a></span>...<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCLOCKING.wc_env_dep_ordered_on_remove">wc_env_dep_ordered_on_remove</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> (<span class="id">x</span>::<span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_on">dep_ordered_on</a></span> (<span class="id">x</span>::<span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> (<span class="id">x</span>::<span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof61')">Proof with</span></div>
<div class="proofscript" id="proof61">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">Hndup</span> <span class="id">Hdep</span> <span class="id">Hwenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_on_dep_ordered">dep_ordered_on_dep_ordered</a></span> <span class="kwd">in</span> <span class="id">Hdep</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_env_dep_ordered_remove">wc_env_dep_ordered_remove</a></span>...<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCLOCKING.wc_env_dep_ordered_on">wc_env_dep_ordered_on</a></span> : <span class="kwd">forall</span> <span class="id">vars</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">vars</span>', <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">vars</span> <span class="id">vars</span>' /\ <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_on">dep_ordered_on</a></span> <span class="id">vars</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof62')">Proof.</span></div>
<div class="proofscript" id="proof62">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">vars</span> <span class="id">Hndup</span> <span class="id">Hwenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_env_dep_ordered">wc_env_dep_ordered</a></span> <span class="id">vars</span> <span class="id">Hndup</span> <span class="id">Hwenv</span>) <span class="kwd">as</span> [<span class="id">vars</span>' [<span class="id">Hperm</span> <span class="id">Hdep</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">vars</span>'. <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_dep_ordered_on">dep_ordered_dep_ordered_on</a></span> <span class="kwd">in</span> <span class="id">Hdep</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;- <span class="id">Hperm</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;- <span class="id">Hperm</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="LCLOCKING.only_depends_on_Proper">only_depends_on_Proper</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation.Permutation</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span> ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on">only_depends_on</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof63')">Proof.</span></div>
<div class="proofscript" id="proof63">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">vars</span> <span class="id">vars</span>' <span class="id">Hperm</span> <span class="id">ck</span> <span class="id">ck</span>' ?; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on">only_depends_on</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intros</span>; [<span class="id">rewrite</span> &lt;- <span class="id">Hperm</span>|<span class="id">rewrite</span> <span class="id">Hperm</span>]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h3> Additional properties about WellInstantiated </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.anon_streams">anon_streams</a></span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.nclock">nclock</a></span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">ck</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span>) =&gt; <span class="kwd">match</span> <span class="id">id</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">id</span>, <span class="id">ck</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) <span class="id">l</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.WellInstantiated_sub_fsts">WellInstantiated_sub_fsts</a></span> : <span class="kwd">forall</span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">ins</span> <span class="id">outs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span> <span class="id">sub</span>) <span class="id">ins</span> <span class="id">outs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> <span class="id">sub</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ins</span>) = (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.anon_streams">anon_streams</a></span> <span class="id">outs</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof64')">Proof.</span></div>
<div class="proofscript" id="proof64">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">Hinst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">Hinst</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">Hsub</span> <span class="id">_</span>]; <span class="id">destruct</span> <span class="id">y</span> <span class="kwd">as</span> [<span class="id">ck</span> <span class="id">id</span>]; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">sub</span>; <span class="id">simpl</span>; [<span class="id">f_equal</span>|]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.instck_only_depends_on">instck_only_depends_on</a></span> : <span class="kwd">forall</span> <span class="id">vars</span> <span class="id">bck</span> <span class="id">bckvars</span> <span class="id">sub</span> <span class="id">ck</span> <span class="id">ck</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on">only_depends_on</a></span> <span class="id">bckvars</span> <span class="id">bck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on">only_depends_on</a></span> <span class="id">vars</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.instck">instck</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">ck</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ck</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on">only_depends_on</a></span> (<span class="id">bckvars</span>++<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> <span class="id">sub</span> <span class="id">vars</span>) <span class="id">ck</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof65')">Proof with</span></div>
<div class="proofscript" id="proof65">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ck</span>; <span class="id">intros</span> <span class="id">ck</span>' <span class="id">Hbck</span> <span class="id">Hdep</span> <span class="id">Hinst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hinst</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on_incl">only_depends_on_incl</a></span>; <span class="id">eauto</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_appl">incl_appl</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_refl">incl_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.instck">instck</a></span> <span class="id">eqn</span>:<span class="id">Hinst</span>'; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">sub</span> <span class="id">eqn</span>:<span class="id">Hsub</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hinst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on_Con">only_depends_on_Con</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hdep</span>) <span class="kwd">as</span> <span class="id">Hdep</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHck</span> <span class="id">_</span> <span class="id">Hbck</span> <span class="id">Hdep</span>' <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">id</span> <span class="id">Hfree</span>. <span class="id">inv</span> <span class="id">Hfree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">Hdep</span> <span class="id">i</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.FreeCon1">FreeCon1</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>; <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#map_filter_In">map_filter_In</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">IHck</span>...<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h3> wc_exp implies wc_clock </h3>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="LCLOCKING.preserving_sub">preserving_sub</a></span> <span class="id">bck</span> (<span class="id">sub</span> : <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) (<span class="id">vars</span> <span class="id">vars</span>' : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>)) <span class="id">dom</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="kwd">forall</span> <span class="id">i</span>' <span class="id">ck</span> <span class="id">ck</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sub</span> <span class="id">i</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">i</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.instck">instck</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">ck</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ck</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">i</span>, <span class="id">ck</span>) <span class="id">vars</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">i</span>', <span class="id">ck</span>') <span class="id">vars</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="id">dom</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.preserving_sub_incl1">preserving_sub_incl1</a></span> : <span class="kwd">forall</span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">vars1</span> <span class="id">vars1</span>' <span class="id">vars2</span> <span class="id">dom</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id">vars1</span>' <span class="id">vars1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">vars1</span> <span class="id">vars2</span> <span class="id">dom</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">vars1</span>' <span class="id">vars2</span> <span class="id">dom</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof66')">Proof.</span></div>
<div class="proofscript" id="proof66">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">vars1</span> <span class="id">vars1</span>' <span class="id">vars2</span> <span class="id">dom</span> <span class="id">Hincl</span> <span class="id">Hpre</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.preserving_sub_incl2">preserving_sub_incl2</a></span> : <span class="kwd">forall</span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">vars1</span> <span class="id">vars2</span> <span class="id">vars2</span>' <span class="id">dom</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id">vars2</span> <span class="id">vars2</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">vars1</span> <span class="id">vars2</span> <span class="id">dom</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">vars1</span> <span class="id">vars2</span>' <span class="id">dom</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof67')">Proof.</span></div>
<div class="proofscript" id="proof67">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">vars1</span> <span class="id">vars2</span> <span class="id">vars2</span>' <span class="id">dom</span> <span class="id">Hincl</span> <span class="id">Hpre</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.preserving_sub_incl3">preserving_sub_incl3</a></span> : <span class="kwd">forall</span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">vars</span> <span class="id">vars</span>' <span class="id">dom</span> <span class="id">dom</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id">dom</span> <span class="id">dom</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">vars</span> <span class="id">vars</span>' <span class="id">dom</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">vars</span> <span class="id">vars</span>' <span class="id">dom</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof68')">Proof.</span></div>
<div class="proofscript" id="proof68">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">vars</span> <span class="id">vars</span>' <span class="id">dom</span> <span class="id">dom</span>' <span class="id">Hincl</span> <span class="id">Hpre</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_incl">Forall_incl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="LCLOCKING.preserving_sub_Proper">preserving_sub_Proper</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span> ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> (<span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span> * <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</span></div>
<div class="proofscript" id="proof69">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">bck</span> <span class="id">bck</span>' ? <span class="id">sub</span> <span class="id">sub</span>' ?; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">vars1</span> <span class="id">vars1</span>' <span class="id">Hperm1</span> <span class="id">vars2</span> <span class="id">vars2</span>' <span class="id">Hperm2</span> <span class="id">dom</span> <span class="id">dom</span>' <span class="id">Hperm3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intro</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub_incl1">preserving_sub_incl1</a></span> <span class="kwd">in</span> <span class="id">H</span>. 2:<span class="id">rewrite</span> <span class="id">Hperm1</span>. 4:<span class="id">rewrite</span> &lt;- <span class="id">Hperm1</span>. 2,4:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub_incl2">preserving_sub_incl2</a></span> <span class="kwd">in</span> <span class="id">H</span>. 2:<span class="id">rewrite</span> <span class="id">Hperm2</span>. 4:<span class="id">rewrite</span> &lt;- <span class="id">Hperm2</span>. 2,4:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub_incl3">preserving_sub_incl3</a></span> <span class="kwd">in</span> <span class="id">H</span>. 2:<span class="id">rewrite</span> <span class="id">Hperm3</span>. 4:<span class="id">rewrite</span> &lt;- <span class="id">Hperm3</span>. 2,4:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="LCLOCKING.frees_in_clock">frees_in_clock</a></span> (<span class="id">ck</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.clock">clock</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ck</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span> =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Con">Con</a></span> <span class="id">ck</span>' <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">_</span> =&gt; <span class="id">id</span>::(<span class="id">frees_in_clock</span> <span class="id">ck</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.Is_free_in_frees_in_clock">Is_free_in_frees_in_clock</a></span> : <span class="kwd">forall</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">id</span> =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Is_free_in_clock">Is_free_in_clock</a></span> <span class="id">id</span> <span class="id">ck</span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.frees_in_clock">frees_in_clock</a></span> <span class="id">ck</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof70')">Proof with</span></div>
<div class="proofscript" id="proof70">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ck</span>; <span class="id">simpl</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">a</span> <span class="id">H</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">constructor</span>...<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.only_depends_on_frees_in_clock">only_depends_on_frees_in_clock</a></span> : <span class="kwd">forall</span> <span class="id">vars</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on">only_depends_on</a></span> <span class="id">vars</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.frees_in_clock">frees_in_clock</a></span> <span class="id">ck</span>) <span class="id">vars</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</span></div>
<div class="proofscript" id="proof71">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ck</span>; <span class="id">intros</span> <span class="id">Hdep</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">incl_nil</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_cons">incl_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">Hdep</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.FreeCon1">FreeCon1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id">IHck</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on_Con">only_depends_on_Con</a></span>, <span class="id">Hdep</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.instck_wc_clock">instck_wc_clock</a></span> : <span class="kwd">forall</span> <span class="id">vars</span> <span class="id">vars</span>' <span class="id">bck</span> <span class="id">sub</span> <span class="id">ck</span> <span class="id">ck</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> <span class="id">vars</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> <span class="id">vars</span>' <span class="id">bck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">vars</span> <span class="id">vars</span>' (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.frees_in_clock">frees_in_clock</a></span> <span class="id">ck</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.instck">instck</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">ck</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ck</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> <span class="id">vars</span>' <span class="id">ck</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof72')">Proof with</span></div>
<div class="proofscript" id="proof72">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">vars</span> <span class="id">vars</span>' <span class="id">bck</span> <span class="id">sub</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ck</span>; <span class="id">intros</span> <span class="id">ck</span>' <span class="id">Hwc</span> <span class="id">Hwcb</span> <span class="id">Hpre</span> <span class="id">Hinst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hinst</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.instck">instck</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">ck</span>) <span class="id">eqn</span>:<span class="id">Hinst</span>'; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">vars</span> <span class="id">vars</span>' (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.frees_in_clock">frees_in_clock</a></span> <span class="id">ck</span>)) <span class="kwd">as</span> <span class="id">Hpre</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub_incl3">preserving_sub_incl3</a></span>; <span class="id">eauto</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_tl">incl_tl</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_refl">incl_refl</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHck</span> <span class="id">_</span> <span class="id">H1</span> <span class="id">Hwcb</span> <span class="id">Hpre</span>' <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span> <span class="kwd">in</span> <span class="id">Hpre</span>; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hpre</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">sub</span> <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">Hsub</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hinst</span>. <span class="id">constructor</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Hpre</span>... <span class="id">left</span>...<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.WellInstantiated_wc_clock">WellInstantiated_wc_clock</a></span> : <span class="kwd">forall</span> <span class="id">vars</span> <span class="id">vars</span>' <span class="id">sub</span> <span class="id">bck</span> <span class="id">id</span> <span class="id">ck</span> <span class="id">ck</span>' <span class="id">name</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> <span class="id">vars</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> <span class="id">vars</span>' <span class="id">bck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">vars</span> <span class="id">vars</span>' (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.frees_in_clock">frees_in_clock</a></span> <span class="id">ck</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span> <span class="id">sub</span> (<span class="id">id</span>, <span class="id">ck</span>) (<span class="id">ck</span>', <span class="id">name</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> <span class="id">vars</span>' <span class="id">ck</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</span></div>
<div class="proofscript" id="proof73">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">vars</span> <span class="id">vars</span>' <span class="id">sub</span> <span class="id">bck</span> <span class="id">id</span> <span class="id">ck</span> <span class="id">ck</span>' <span class="id">name</span> <span class="id">Hwc</span> <span class="id">Hwcb</span> <span class="id">Hpre</span> <span class="id">Hinst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hinst</span> <span class="kwd">as</span> [<span class="id">Hsub</span> <span class="id">Hinst</span>]; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.instck_wc_clock">instck_wc_clock</a></span> <span class="kwd">in</span> <span class="id">Hinst</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">WellInstantiated_wc_clocks</span>' : <span class="kwd">forall</span> <span class="id">vars</span>' <span class="id">bck</span> <span class="id">sub</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.dep_ordered_on">dep_ordered_on</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> <span class="id">vars</span>' <span class="id">bck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span> <span class="id">sub</span>) <span class="id">xs</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span> <span class="id">bck</span> <span class="id">sub</span> <span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.anon_streams">anon_streams</a></span> <span class="id">ys</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">xs</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> (<span class="id">vars</span>'++<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.anon_streams">anon_streams</a></span> <span class="id">ys</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ys</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof74')">Proof with</span></div>
<div class="proofscript" id="proof74">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">vars</span>' <span class="id">bck</span> <span class="id">sub</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">Hndup</span> <span class="id">Hdep</span> <span class="id">Hbck</span> <span class="id">Hwc</span> <span class="id">Hwinst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">Hwinst</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">l</span>) <span class="kwd">as</span> <span class="id">Hwc</span>' <span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_env_dep_ordered_on_remove">wc_env_dep_ordered_on_remove</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hdep</span>. <span class="id">inv</span> <span class="id">Hdep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hndup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHHwinst</span> <span class="id">H5</span> <span class="id">H2</span> <span class="id">Hwc</span>') <span class="kwd">as</span> [<span class="id">Hpres</span>' <span class="id">Hwc</span>''].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub">preserving_sub</a></span> <span class="id">bck</span> <span class="id">sub</span> ((<span class="id">a</span>, <span class="id">b</span>)::<span class="id">l</span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.anon_streams">anon_streams</a></span> (<span class="id">y</span>::<span class="id">l</span>')) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> ((<span class="id">a</span>, <span class="id">b</span>)::<span class="id">l</span>))) <span class="kwd">as</span> <span class="id">Hpres</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">constructor</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> <span class="id">id</span>' <span class="id">ck</span> <span class="id">ck</span>' <span class="id">Hsub</span> <span class="id">Hinst</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hin</span>. 2:(<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">congruence</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">destruct</span> <span class="id">y</span> <span class="kwd">as</span> [<span class="id">ck</span>'' ?]. <span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [? <span class="id">Hinst</span>']; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hsub</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">f_equal</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">id</span>' <span class="id">Hin</span> <span class="id">id</span>'' <span class="id">ck</span>' <span class="id">ck</span>'' <span class="id">Hsub</span> <span class="id">Hinst</span> <span class="id">Hin</span>'; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin</span>' <span class="kwd">as</span> [<span class="id">Heq</span>|<span class="id">Hin</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">y</span> <span class="kwd">as</span> [? ?]; <span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">Hsub</span>' <span class="id">Hinst</span>']; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hsub</span> <span class="kwd">in</span> <span class="id">Hsub</span>'. <span class="id">rewrite</span> <span class="id">Hinst</span> <span class="kwd">in</span> <span class="id">Hinst</span>'. <span class="id">inv</span> <span class="id">Hinst</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">Hin</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hsub</span> <span class="id">Hinst</span> <span class="id">Hin</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">y</span> <span class="kwd">as</span> [? [?|]]...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>... }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">simpl</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">y</span> <span class="kwd">as</span> [<span class="id">ck</span> [<span class="id">id</span>|]]; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated_wc_clock">WellInstantiated_wc_clock</a></span> <span class="kwd">in</span> <span class="id">H</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">inv</span> <span class="id">Hwc</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock_incl">wc_clock_incl</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_appl">incl_appl</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_refl">incl_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub_incl3">preserving_sub_incl3</a></span>. 1:<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_tl">incl_tl</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on_frees_in_clock">only_depends_on_frees_in_clock</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub_incl2">preserving_sub_incl2</a></span>... <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_appr">incl_appr</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_refl">incl_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated_wc_clock">WellInstantiated_wc_clock</a></span> <span class="kwd">in</span> <span class="id">H</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">inv</span> <span class="id">Hwc</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock_incl">wc_clock_incl</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_appl">incl_appl</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_refl">incl_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub_incl3">preserving_sub_incl3</a></span>. 1:<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_tl">incl_tl</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.only_depends_on_frees_in_clock">only_depends_on_frees_in_clock</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.preserving_sub_incl2">preserving_sub_incl2</a></span>... <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_appr">incl_appr</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_refl">incl_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock_incl">wc_clock_incl</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">incl_appr</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">y</span> <span class="kwd">as</span> [<span class="id">ck</span> [<span class="id">id</span>|]]; [<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_tl">incl_tl</a></span>|]; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_refl">incl_refl</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCLOCKING.WellInstantiated_wc_clocks">WellInstantiated_wc_clocks</a></span> : <span class="kwd">forall</span> <span class="id">vars</span>' <span class="id">bck</span> <span class="id">sub</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> <span class="id">vars</span>' <span class="id">bck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span> <span class="id">sub</span>) <span class="id">xs</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> (<span class="id">vars</span>'++<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.anon_streams">anon_streams</a></span> <span class="id">ys</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ys</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof75')">Proof with</span></div>
<div class="proofscript" id="proof75">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">vars</span>' <span class="id">bck</span> <span class="id">sub</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">Hndup</span> <span class="id">Hwc</span> <span class="id">Hwenv</span> <span class="id">Hwellinst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_env_dep_ordered_on">wc_env_dep_ordered_on</a></span> <span class="id">_</span> <span class="id">Hndup</span> <span class="id">Hwenv</span>) <span class="kwd">as</span> [<span class="id">xs</span>' [<span class="id">Hperm1</span> <span class="id">Hdep1</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> <span class="id">xs</span>') <span class="kwd">as</span> <span class="id">Hndup</span>'' <span class="kwd">by</span> (<span class="id">rewrite</span> &lt;- <span class="id">Hperm1</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_Permutation_1">Forall2_Permutation_1</a></span> <span class="kwd">in</span> <span class="id">Hwellinst</span> <span class="kwd">as</span> [<span class="id">ys</span>' [<span class="id">Hperm2</span> <span class="id">Hwellinst</span>]]...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">WellInstantiated_wc_clocks</span>' <span class="kwd">in</span> <span class="id">Hwellinst</span> <span class="kwd">as</span> (<span class="id">_</span>&amp;?);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span> <span class="kwd">in</span> *...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>. 2:<span class="id">rewrite</span> <span class="id">Hperm2</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.anon_streams">anon_streams</a></span>. <span class="id">rewrite</span> <span class="id">Hperm2</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;- <span class="id">Hperm1</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_exp_nclockof_In">wc_exp_nclockof_In</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) Γ <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">G</span> Γ <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">ck</span>, <span class="id">o</span>) =&gt; <span class="id"><a href="Velus.Common.CommonList.html#LiftO">LiftO</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span>) <span class="id">o</span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclockof">nclockof</a></span> <span class="id">e</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</span></div>
<div class="proofscript" id="proof76">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.exp_ind2">exp_ind2</a></span>; <span class="id">intros</span> * <span class="id">Hwc</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwc</span>; <span class="id">simpl</span>; <span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1-6:<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>; <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCLOCKING.wc_exps_nclocksof_In">wc_exps_nclocksof_In</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) Γ <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">G</span> Γ) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">ck</span>, <span class="id">o</span>) =&gt; <span class="id"><a href="Velus.Common.CommonList.html#LiftO">LiftO</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span>) <span class="id">o</span>) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclocksof">nclocksof</a></span> <span class="id">es</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</span></div>
<div class="proofscript" id="proof77">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclocksof">nclocksof</a></span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_concat">Forall_concat</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> (<span class="id">take</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp_nclockof_In">wc_exp_nclockof_In</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_exp_clockof">wc_exp_clockof</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) Γ <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span> Γ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">G</span> Γ <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span> Γ)) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof78')">Proof with</span></div>
<div class="proofscript" id="proof78">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Local</span> <span class="kwd">Ltac</span> <span class="id">Forall_clocksof</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> ?<span class="id">es</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span>) <span class="kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">es</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> (<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span>; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span>; <span class="id">auto</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_concat">Forall_concat</a></span>; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> *; <span class="id">intros</span> ? <span class="id">Hin</span>; <span class="id">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">HG</span> <span class="id">Henv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.exp_ind2">exp_ind2</a></span>; <span class="id">intros</span> <span class="id">Hwc</span>; <span class="id">inv</span> <span class="id">Hwc</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.stripname">stripname</a></span>; <span class="id">simpl</span>; <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;var&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span> <span class="kwd">in</span> <span class="id">Henv</span>; <span class="id">simpl_Forall</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;last&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span> <span class="kwd">in</span> <span class="id">Henv</span>; <span class="id">simpl_Forall</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;unop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHe</span> <span class="kwd">in</span> <span class="id">H1</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;binop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHe1</span> <span class="kwd">in</span> <span class="id">H3</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">H3</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;external&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span>) <span class="id">eqn</span>:<span class="id">Hck</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists">Exists</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="kwd">exists</span> <span class="id">l</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = <span class="id">c</span>::<span class="id">l</span>) <span class="id">es</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">clear</span> - <span class="id">Hck</span>. <span class="id">induction</span> <span class="id">es</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> <span class="id">a</span>) <span class="id">eqn</span>:<span class="id">Hck</span>'; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hck</span>. <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Exists</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">specialize</span> (<span class="id">H</span> <span class="id">H3</span>). <span class="id">now</span> <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;fby&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_eq">Forall2_eq</a></span> <span class="kwd">in</span> <span class="id">H6</span>, <span class="id">H7</span>. <span class="id">rewrite</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall_clocksof</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;arrow&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_eq">Forall2_eq</a></span> <span class="kwd">in</span> <span class="id">H6</span>, <span class="id">H7</span>. <span class="id">rewrite</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall_clocksof</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;when&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">tys</span>; [<span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>. <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="id">intros</span> ? <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>... 2:<span class="id">inv</span> <span class="id">H4</span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span> Γ)) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span>)) <span class="kwd">as</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">Forall_clocksof</span>... }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_Forall">Forall_Forall</a></span> <span class="kwd">in</span> <span class="id">H6</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span>); <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>. <span class="id">destruct</span> <span class="id">H1</span>; <span class="id">subst</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;merge&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">es</span> <span class="kwd">as</span> [|(?&amp;?)]; [<span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>; <span class="id">exfalso</span>; <span class="id">auto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H5</span>. <span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span> Γ)) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">l</span>)) <span class="kwd">as</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">Forall_clocksof</span>... }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_Forall">Forall_Forall</a></span> <span class="kwd">in</span> <span class="id">H5</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H7</span>. <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="id">destruct</span> <span class="id">tys</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>; <span class="id">try</span> <span class="id">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>. <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="id">intros</span> ? <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">inv</span> <span class="id">H5</span>. <span class="id">destruct</span> <span class="id">H12</span>; <span class="id">subst</span>... <span class="id">inv</span> <span class="id">H</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHe</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>. <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="id">intros</span> ? <span class="id">_</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">inv</span> <span class="id">H5</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;app&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span> Γ)) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span>)) <span class="kwd">as</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">Forall_clocksof</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_find_node">wc_find_node</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> [<span class="id">G</span>' <span class="id">Hwcnode</span>]...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span> Γ) <span class="id">bck</span>) <span class="kwd">as</span> <span class="id">Hbck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated_bck">WellInstantiated_bck</a></span> <span class="kwd">in</span> <span class="id">H8</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof_nclocksof">clocksof_nclocksof</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>. <span class="id">apply</span> <span class="id">Hwc</span> <span class="kwd">in</span> <span class="id">H8</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">inv</span> <span class="id">Hwcnode</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_ingt0">n_ingt0</a></span>... }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_app">Forall2_app</a></span> <span class="id">H8</span> <span class="id">H9</span>) <span class="kwd">as</span> <span class="id">Hinst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated_wc_clocks">WellInstantiated_wc_clocks</a></span> <span class="kwd">in</span> <span class="id">Hinst</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_app">Forall_app</a></span> <span class="kwd">in</span> <span class="id">Hinst</span>. <span class="id">destruct</span> <span class="id">Hinst</span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">Hinst</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span> <span class="kwd">in</span> <span class="id">Hinst</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_map">Forall_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> (?&amp;?) ?; <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock_incl">wc_clock_incl</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.anon_streams">anon_streams</a></span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#map_filter_app">map_filter_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>. <span class="id">repeat</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_app">incl_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_refl">incl_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exps_nclocksof_In">wc_exps_nclocksof_In</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ? <span class="id">Hmap</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">eauto</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">o</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>; <span class="id">try</span> <span class="id">congruence</span>. <span class="id">inv</span> <span class="id">Hf</span>. <span class="id">inv</span> <span class="id">H5</span>; <span class="id">solve_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">intros</span> ? <span class="id">Hmap</span>. <span class="id">simpl_In</span>. <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span> <span class="kwd">with</span> (<span class="id">l</span>:=<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_out">n_out</a></span> <span class="id">n</span>). <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.n_nodup">n_nodup</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">intros</span>; <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.decl">decl</a></span> <span class="kwd">in</span> *; <span class="id">destruct_conjs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">inv</span> <span class="id">Hwcnode</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCLOCKING.wc_exp_clocksof">wc_exp_clocksof</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) Γ <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_env">wc_env</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span> Γ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">G</span> Γ) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span> Γ)) (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> <span class="id">es</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof79')">Proof with</span></div>
<div class="proofscript" id="proof79">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">HwG</span> <span class="id">Henv</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nclocksof">nclocksof</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map_concat_map">flat_map_concat_map</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_concat">Forall_concat</a></span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp_clockof">wc_exp_clockof</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_clock_is_free_in">wc_clock_is_free_in</a></span> : <span class="kwd">forall</span> <span class="id">vars</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> <span class="id">vars</span> <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Is_free_in_clock">Is_free_in_clock</a></span> <span class="id">x</span> <span class="id">ck</span> -&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">vars</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof80')">Proof.</span></div>
<div class="proofscript" id="proof80">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hwc</span> ? <span class="id">Hfree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">Hwc</span>; <span class="id">inv</span> <span class="id">Hfree</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="LCLOCKING.interface_incl">interface_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">PSyn1</span> <span class="id">PSyn2</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.decl">decl</a></span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.block">block</a></span> -&gt; <span class="kwd">Prop</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">prefs1</span> <span class="id">prefs2</span> : <span class="id"><a href="Velus.Common.Common.html#PS.t">PS.t</a></span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="LCLOCKING.interface_incl.G1">G1</a></span> : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.PSyn1">PSyn1</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.prefs1">prefs1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="LCLOCKING.interface_incl.G2">G2</a></span> : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.PSyn2">PSyn2</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.prefs2">prefs2</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="LCLOCKING.interface_incl.Heq">Heq</a></span> : <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global_iface_incl">global_iface_incl</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.G1">G1</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.G2">G2</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id"><a href="Velus.Lustre.LClocking.html#wc_exp">wc_exp</a></span> : <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.iface_incl_wc_exp">iface_incl_wc_exp</a></span> : <span class="kwd">forall</span> Γ <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.G1">G1</a></span> Γ <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.G2">G2</a></span> Γ <span class="id">e</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof81')">Proof with</span></div>
<div class="proofscript" id="proof81">
 <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.exp_ind2">exp_ind2</a></span>; <span class="id">intros</span> <span class="id">Hwc</span>; <span class="id">inv</span> <span class="id">Hwc</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1-6:<span class="id">econstructor</span>; <span class="id">try</span> (<span class="id">destruct</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.Heq">Heq</a></span>; <span class="id">erewrite</span> &lt;-<span class="id">equiv_program_enums</span>)...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">simpl_Forall</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> ??; <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">specialize</span> (<span class="id">H11</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> *...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;app&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.Heq">Heq</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:=<span class="id">sub</span>). <span class="id">instantiate</span> (1:=<span class="id">bck</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">erewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>, &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, &lt;-? <span class="id">H4</span>, &lt;-? <span class="id">H7</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>; <span class="id">eauto</span>. 1,3:<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">instantiate</span> (1:=<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">ty</span>, <span class="id">ck</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">intros</span>; <span class="id">destruct_conjs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.iface_incl_wc_equation">iface_incl_wc_equation</a></span> : <span class="kwd">forall</span> Γ <span class="id">equ</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_equation">wc_equation</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.G1">G1</a></span> Γ <span class="id">equ</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_equation">wc_equation</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.G2">G2</a></span> Γ <span class="id">equ</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof82')">Proof with</span></div>
<div class="proofscript" id="proof82">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ? [<span class="id">xs</span> <span class="id">es</span>] <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">econstructor</span>; <span class="id">eauto</span>; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> *; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.iface_incl_wc_exp">iface_incl_wc_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;app&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.Heq">Heq</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.iface_incl_wc_exp">iface_incl_wc_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:=<span class="id">sub</span>). <span class="id">instantiate</span> (1:=<span class="id">bck</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">erewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>, &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>, &lt;-? <span class="id">H8</span>, &lt;-? <span class="id">H9</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>; <span class="id">eauto</span>. 1,3:<span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_map_1">Forall3_map_1</a></span> <span class="kwd">in</span> *; <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_impl_In">Forall3_impl_In</a></span>; [|<span class="id">eauto</span>]; <span class="id">intros</span>; <span class="id">destruct_conjs</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">instantiate</span> (1:=<span class="kwd">fun</span> '(<span class="id">x</span>, (<span class="id">ty</span>, <span class="id">ck</span>)) =&gt; (<span class="id">x</span>, <span class="id">ck</span>)); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">intros</span>; <span class="id">destruct_conjs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.iface_incl_wc_scope">iface_incl_wc_scope</a></span> {<span class="id">A</span>} (<span class="id">P_wc1</span> <span class="id">P_wc2</span>: <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="kwd">Prop</span>) : <span class="kwd">forall</span> Γ <span class="id">locs</span> (<span class="id">blks</span> : <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ, <span class="id">P_wc1</span> Γ <span class="id">blks</span> -&gt; <span class="id">P_wc2</span> Γ <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_scope">wc_scope</a></span> <span class="id">P_wc1</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.G1">G1</a></span> Γ (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_scope">wc_scope</a></span> <span class="id">P_wc2</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.G2">G2</a></span> Γ (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof83')">Proof.</span></div>
<div class="proofscript" id="proof83">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hp</span> <span class="id">Hwc</span>. <span class="id">inv</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.iface_incl_wc_block">iface_incl_wc_block</a></span> : <span class="kwd">forall</span> <span class="id">d</span> Γ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_block">wc_block</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.G1">G1</a></span> Γ <span class="id">d</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_block">wc_block</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl.G2">G2</a></span> Γ <span class="id">d</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof84')">Proof.</span></div>
<div class="proofscript" id="proof84">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">d</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">Hwc</span>; <span class="id">inv</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.iface_incl_wc_equation">iface_incl_wc_equation</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.iface_incl_wc_exp">iface_incl_wc_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.iface_incl_wc_exp">iface_incl_wc_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.iface_incl_wc_exp">iface_incl_wc_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_branch">wc_branch</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.iface_incl_wc_exp">iface_incl_wc_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_branch">wc_branch</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>; <span class="id">destruct_conjs</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">s</span>; <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.iface_incl_wc_exp">iface_incl_wc_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.iface_incl_wc_scope">iface_incl_wc_scope</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ? (?&amp;?); <span class="id">split</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.iface_incl_wc_exp">iface_incl_wc_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.iface_incl_wc_scope">iface_incl_wc_scope</a></span>; <span class="id">eauto</span>. <span class="id">intros</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.interface_incl">interface_incl</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.iface_incl_wc_node">iface_incl_wc_node</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G1</span> <span class="id">G2</span> : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) : <span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global_iface_incl">global_iface_incl</a></span> <span class="id">G1</span> <span class="id">G2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_node">wc_node</a></span> <span class="id">G1</span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_node">wc_node</a></span> <span class="id">G2</span> <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof85')">Proof.</span></div>
<div class="proofscript" id="proof85">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hincl</span> <span class="id">Wcn</span>. <span class="id">inv</span> <span class="id">Wcn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.iface_incl_wc_block">iface_incl_wc_block</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">iface_incl_wc_exp</span> <span class="id">iface_incl_wc_equation</span> <span class="id">iface_incl_wc_block</span> : <span class="id">lclocking</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_global_node">wc_global_node</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">f</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.find_node">find_node</a></span> <span class="id">f</span> <span class="id">G</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_node">wc_node</a></span> <span class="id">G</span> <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof86')">Proof.</span></div>
<div class="proofscript" id="proof86">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">G</span> <span class="kwd">as</span> [<span class="id">tys</span> <span class="id">exts</span> <span class="id">nds</span>]; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">nds</span> <span class="kwd">as</span> [|<span class="id">nd</span> <span class="id">nds</span>]; <span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">Wcg</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.find_node_cons">find_node_cons</a></span> <span class="kwd">in</span> <span class="id">Hfind</span> <span class="kwd">as</span> [[]|[]]; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">clear</span> <span class="id">IHnds</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Wcg</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.iface_incl_wc_node">iface_incl_wc_node</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">auto</span>; <span class="id">try</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">try</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="kwd">exists</span> <span class="id">n0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.find_node_other">find_node_other</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.find_node_Exists">find_node_Exists</a></span> <span class="id">f</span> {| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.types">types</a></span> := <span class="id">tys</span>; <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.externs">externs</a></span> := <span class="id">exts</span>; <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nodes">nodes</a></span> := <span class="id">nds</span> |}) <span class="kwd">as</span> (<span class="id">Hex</span>&amp;<span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists_exists">Exists_exists</a></span> <span class="kwd">in</span> <span class="id">Hex</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="id">subst</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">IHnds</span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_global_cons">wc_global_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Wcg</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.iface_incl_wc_node">iface_incl_wc_node</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">auto</span>; <span class="id">try</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">try</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="kwd">exists</span> <span class="id">n0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.find_node_other">find_node_other</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.find_node_Exists">find_node_Exists</a></span> <span class="id">f0</span> {| <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.types">types</a></span> := <span class="id">tys</span>; <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.externs">externs</a></span> := <span class="id">exts</span>; <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.nodes">nodes</a></span> := <span class="id">nds</span> |}) <span class="kwd">as</span> (<span class="id">Hex</span>&amp;<span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Exists_exists">Exists_exists</a></span> <span class="kwd">in</span> <span class="id">Hex</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="id">subst</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h2> wc implies wl </h2>
<br/>
&nbsp;&nbsp;<span class="id">Local</span> <span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id"><a href="Velus.Lustre.LClocking.html#wl_exp">wl_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#wl_block">wl_block</a></span> : <span class="id">lclocking</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.wc_exp_wl_exp">wc_exp_wl_exp</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) Γ <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">G</span> Γ <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wl_exp">wl_exp</a></span> <span class="id">G</span> <span class="id">e</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof87')">Proof with</span></div>
<div class="proofscript" id="proof87">
 <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.exp_ind2">exp_ind2</a></span>; <span class="id">intro</span> <span class="id">Hwt</span>; <span class="id">inv</span> <span class="id">Hwt</span>; <span class="id">econstructor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span> [<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.numstreams">numstreams</a></span> <span class="id">_</span>] =&gt; <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.length_clockof_numstreams">length_clockof_numstreams</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> ?<span class="id">e</span> = <span class="id">_</span> |- <span class="id">context</span> [<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clockof">clockof</a></span> ?<span class="id">e</span>] =&gt; <span class="id">rewrite</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> ?<span class="id">e</span> = <span class="id">_</span> |- <span class="id">context</span> [<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof">clocksof</a></span> ?<span class="id">e</span>] =&gt; <span class="id">rewrite</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span> [<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.annots">annots</a></span> ?<span class="id">es</span>)] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, &lt;-<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof_annots">clocksof_annots</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span> [<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">_</span> <span class="id">_</span>)] =&gt; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">context</span> [<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">_</span> <span class="id">_</span>)] |- <span class="id">_</span> =&gt; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="kwd">forall</span> <span class="id">_</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> -&gt; <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">simpl_Forall</span>; <span class="id">intros</span>; <span class="id">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="id">simpl</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">contradict</span> <span class="id">H5</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.clocksof_annots">clocksof_annots</a></span>, <span class="id">H5</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.length_nclocksof_annots">length_nclocksof_annots</a></span>, &lt;-<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.length_clocksof_annots">length_clocksof_annots</a></span> <span class="kwd">in</span> <span class="id">H8</span>...<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">wc_exp_wl_exp</span> : <span class="id">lclocking</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCLOCKING.Forall_wc_exp_wl_exp">Forall_wc_exp_wl_exp</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) Γ <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">G</span> Γ) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wl_exp">wl_exp</a></span> <span class="id">G</span>) <span class="id">es</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof88')">Proof.</span></div>
<div class="proofscript" id="proof88">
 <span class="id">intros</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>. Qed.</div>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Forall_wc_exp_wl_exp</span> : <span class="id">lclocking</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.wc_equation_wl_equation">wc_equation_wl_equation</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) Γ <span class="id">equ</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_equation">wc_equation</a></span> <span class="id">G</span> Γ <span class="id">equ</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wl_equation">wl_equation</a></span> <span class="id">G</span> <span class="id">equ</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof89')">Proof with</span></div>
<div class="proofscript" id="proof89">
 <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ?? [<span class="id">xs</span> <span class="id">es</span>] <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Heq</span>; <span class="id">econstructor</span>; <span class="id">simpl</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">econstructor</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eauto</span>]. <span class="id">intros</span> ? (?&amp;<span class="id">Ck</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.length_clockof_numstreams">length_clockof_numstreams</a></span>, <span class="id">Ck</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.length_nclocksof_annots">length_nclocksof_annots</a></span> <span class="kwd">in</span> <span class="id">H4</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall3_length">Forall3_length</a></span> <span class="kwd">in</span> <span class="id">H5</span> <span class="kwd">as</span> (<span class="id">Hlen1</span>&amp;<span class="id">Hlen2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span> <span class="kwd">in</span> <span class="id">Hlen1</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">H7</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_length">Forall2_length</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.length_clocksof_annots">length_clocksof_annots</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">wc_equation_wl_equation</span> : <span class="id">lclocking</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.wc_scope_wl_scope">wc_scope_wl_scope</a></span> {<span class="id">A</span>} (<span class="id">P_wc</span>: <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">P_wl</span>: <span class="id">_</span> -&gt; <span class="kwd">Prop</span>) {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">locs</span> (<span class="id">blks</span>: <span class="id">A</span>) Γ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ, <span class="id">P_wc</span> Γ <span class="id">blks</span> -&gt; <span class="id">P_wl</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_scope">wc_scope</a></span> <span class="id">P_wc</span> <span class="id">G</span> Γ (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wl_scope">wl_scope</a></span> <span class="id">P_wl</span> <span class="id">G</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof90')">Proof.</span></div>
<div class="proofscript" id="proof90">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hp</span> <span class="id">Hwc</span>. <span class="id">inv</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.wc_block_wl_block">wc_block_wl_block</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">d</span> Γ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_block">wc_block</a></span> <span class="id">G</span> Γ <span class="id">d</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wl_block">wl_block</a></span> <span class="id">G</span> <span class="id">d</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof91')">Proof.</span></div>
<div class="proofscript" id="proof91">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">d</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">Wc</span>; <span class="id">inv</span> <span class="id">Wc</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">econstructor</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.length_clockof_numstreams">length_clockof_numstreams</a></span>, <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.length_clockof_numstreams">length_clockof_numstreams</a></span>, <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.length_clockof_numstreams">length_clockof_numstreams</a></span>, <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_branch">wc_branch</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">split</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>. <span class="id">now</span> <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.length_clockof_numstreams">length_clockof_numstreams</a></span>, <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_branch">wc_branch</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>; <span class="id">destruct_conjs</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">s</span>; <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">split</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>. <span class="id">now</span> <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.length_clockof_numstreams">length_clockof_numstreams</a></span>, <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_scope_wl_scope">wc_scope_wl_scope</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * (?&amp;?); <span class="id">split</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>. <span class="id">now</span> <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.length_clockof_numstreams">length_clockof_numstreams</a></span>, <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_scope_wl_scope">wc_scope_wl_scope</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">wc_block_wl_block</span> : <span class="id">lclocking</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.wc_node_wl_node">wc_node_wl_node</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_node">wc_node</a></span> <span class="id">G</span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wl_node">wl_node</a></span> <span class="id">G</span> <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof92')">Proof with</span></div>
<div class="proofscript" id="proof92">
 <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">G</span> <span class="id">n</span> <span class="id">Wcn</span>. <span class="id">inv</span> <span class="id">Wcn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>...<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">wc_node_wl_node</span> : <span class="id">lclocking</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.wc_global_wl_global">wc_global_wl_global</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wl_global">wl_global</a></span> <span class="id">G</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof93')">Proof with</span></div>
<div class="proofscript" id="proof93">
 <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">G</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_global">wc_global</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wl_global">wl_global</a></span>, <span class="id"><a href="Velus.Common.CommonTyping.html#wt_program">wt_program</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">Hwt</span>; <span class="id">constructor</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H</span>...<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">wc_global_wl_global</span> : <span class="id">lclocking</span>.<br/>
<br/>
<h2> wc implies wx </h2>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id"><a href="Velus.Lustre.LClocking.html#wx_exp">wx_exp</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#wl_block">wl_block</a></span> : <span class="id">lclocking</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_clock_wx_clock">wc_clock_wx_clock</a></span> : <span class="kwd">forall</span> <span class="id">vars</span> <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.wc_clock">wc_clock</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.idck">idck</a></span> <span class="id">vars</span>) <span class="id">ck</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wx_clock">wx_clock</a></span> <span class="id">vars</span> <span class="id">ck</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof94')">Proof.</span></div>
<div class="proofscript" id="proof94">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ck</span>; <span class="id">intros</span> * <span class="id">Hwc</span>; <span class="id">inv</span> <span class="id">Hwc</span>; <span class="id">constructor</span>; <span class="id">eauto</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.wc_exp_wx_exp">wc_exp_wx_exp</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) : <span class="kwd">forall</span> Γ <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">G</span> Γ <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wx_exp">wx_exp</a></span> Γ <span class="id">e</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof95')">Proof with</span></div>
<div class="proofscript" id="proof95">
 <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">e</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.exp_ind2">exp_ind2</a></span>; <span class="id">intros</span> <span class="id">Hwt</span>; <span class="id">inv</span> <span class="id">Hwt</span>; <span class="id">econstructor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="kwd">forall</span> <span class="id">_</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> -&gt; <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">simpl_Forall</span>; <span class="id">intros</span>; <span class="id">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">wc_clock_wx_clock</span> <span class="id">wc_exp_wx_exp</span> : <span class="id">lclocking</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="LCLOCKING.Forall_wc_exp_wx_exp">Forall_wc_exp_wx_exp</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) : <span class="kwd">forall</span> Γ <span class="id">es</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp">wc_exp</a></span> <span class="id">G</span> Γ) <span class="id">es</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wx_exp">wx_exp</a></span> Γ) <span class="id">es</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof96')">Proof.</span></div>
<div class="proofscript" id="proof96">
 <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> *; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>. Qed.</div>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">Forall_wc_exp_wx_exp</span> : <span class="id">lclocking</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.wc_equation_wx_equation">wc_equation_wx_equation</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) : <span class="kwd">forall</span> Γ <span class="id">equ</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_equation">wc_equation</a></span> <span class="id">G</span> Γ <span class="id">equ</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wx_equation">wx_equation</a></span> Γ <span class="id">equ</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof97')">Proof with</span></div>
<div class="proofscript" id="proof97">
 <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ? [<span class="id">xs</span> <span class="id">es</span>] <span class="id">Heq</span>. <span class="id">inv</span> <span class="id">Heq</span>; <span class="id">repeat</span> <span class="id">constructor</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore2">Forall2_ignore2</a></span> <span class="kwd">in</span> <span class="id">H7</span>. <span class="id">simpl_Forall</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_ignore2">Forall2_ignore2</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">simpl_Forall</span>...<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">wc_equation_wx_equation</span> : <span class="id">lclocking</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.wc_scope_wx_scope">wc_scope_wx_scope</a></span> {<span class="id">A</span>} (<span class="id">P_wc</span>: <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">P_wx</span>: <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="kwd">Prop</span>) {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">locs</span> (<span class="id">blks</span>: <span class="id">A</span>) Γ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ, <span class="id">P_wc</span> Γ <span class="id">blks</span> -&gt; <span class="id">P_wx</span> Γ <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_scope">wc_scope</a></span> <span class="id">P_wc</span> <span class="id">G</span> Γ (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wx_scope">wx_scope</a></span> <span class="id">P_wx</span> Γ (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof98')">Proof.</span></div>
<div class="proofscript" id="proof98">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hp</span> <span class="id">Hwc</span>. <span class="id">inv</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.wc_block_wx_block">wc_block_wx_block</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) : <span class="kwd">forall</span> <span class="id">blk</span> Γ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_block">wc_block</a></span> <span class="id">G</span> Γ <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wx_block">wx_block</a></span> Γ <span class="id">blk</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof99')">Proof.</span></div>
<div class="proofscript" id="proof99">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">Wc</span>; <span class="id">inv</span> <span class="id">Wc</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">econstructor</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_branch">wc_branch</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wx_block_incl">wx_block_incl</a></span>; [| |<span class="id">eauto</span>]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hv</span>. <span class="id">inv</span> <span class="id">Hv</span>. <span class="id">simpl_In</span>. <span class="id">edestruct</span> <span class="id">H5</span> <span class="kwd">as</span> (?&amp;?); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wx_exp_incl">wx_exp_incl</a></span>; [| |<span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ? <span class="id">Hv</span>. <span class="id">inv</span> <span class="id">Hv</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">H7</span> <span class="kwd">as</span> (<span class="id">Has</span>&amp;<span class="id">_</span>). <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Has</span>. <span class="id">constructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#In_InMembers">In_InMembers</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_branch">wc_branch</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">inv</span> <span class="id">it</span>; <span class="id">destruct_conjs</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">s</span>; <span class="id">destruct_conjs</span>. <span class="id">split</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wx_exp_incl">wx_exp_incl</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp_wx_exp">wc_exp_wx_exp</a></span>. 3:<span class="id">eauto</span>. <span class="id">all</span>:<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hv</span>; <span class="id">inv</span> <span class="id">Hv</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">H7</span> <span class="kwd">as</span> (<span class="id">Hck</span>&amp;<span class="id">_</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wx_scope_incl">wx_scope_incl</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_scope_wx_scope">wc_scope_wx_scope</a></span>. 5:<span class="id">eauto</span>. <span class="id">all</span>:<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">intros</span> * <span class="id">Hv</span>; <span class="id">inv</span> <span class="id">Hv</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">H7</span> <span class="kwd">as</span> (<span class="id">Hck</span>&amp;<span class="id">_</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">intros</span> * ?? (?&amp;?); <span class="id">split</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wx_block_incl">wx_block_incl</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wx_exp_incl">wx_exp_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">intros</span> * (?&amp;?); <span class="id">split</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_exp_wx_exp">wc_exp_wx_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_scope_wx_scope">wc_scope_wx_scope</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">wc_block_wx_block</span> : <span class="id">lclocking</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.wc_node_wx_node">wc_node_wx_node</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_node">wc_node</a></span> <span class="id">G</span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wx_node">wx_node</a></span> <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof100')">Proof with</span></div>
<div class="proofscript" id="proof100">
 <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">G</span> <span class="id">n</span> <span class="id">Wc</span>. <span class="id">inv</span> <span class="id">Wc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>...<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">wc_node_wx_node</span> : <span class="id">lclocking</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="LCLOCKING.wc_global_wx_global">wc_global_wx_global</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} : <span class="kwd">forall</span> (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wx_global">wx_global</a></span> <span class="id">G</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof101')">Proof with</span></div>
<div class="proofscript" id="proof101">
 <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">G</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_global">wc_global</a></span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.wx_global">wx_global</a></span>, <span class="id"><a href="Velus.Common.CommonTyping.html#wt_program">wt_program</a></span>, <span class="id"><a href="Velus.Common.CommonProgram.html#units">units</a></span> <span class="kwd">in</span> *; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">Hwc</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H</span>...<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">wc_global_wx_global</span> : <span class="id">lclocking</span>.<br/>
<br/>
<div class="doc">Additional properties </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_block_Is_defined_in">wc_block_Is_defined_in</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) : <span class="kwd">forall</span> <span class="id">blk</span> Γ <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_block">wc_block</a></span> <span class="id">G</span> Γ <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Is_defined_in">Is_defined_in</a></span> <span class="id">x</span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#var_last_ident">var_last_ident</a></span> <span class="id">x</span>) Γ.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof102')">Proof.</span></div>
<div class="proofscript" id="proof102">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hck</span> <span class="id">Hdef</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Is_defined_in_wx_In">Is_defined_in_wx_In</a></span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.wc_scope_Is_defined_in">wc_scope_Is_defined_in</a></span> {<span class="id">A</span>} <span class="id">P_wc</span> <span class="id">P_def</span> {<span class="id">PSyn</span> <span class="id">prefs</span>} (<span class="id">G</span>: @<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) : <span class="kwd">forall</span> Γ <span class="id">locs</span> (<span class="id">blks</span>: <span class="id">A</span>) <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.wc_scope">wc_scope</a></span> <span class="id">P_wc</span> <span class="id">G</span> Γ (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Syn.Is_defined_in_scope">Is_defined_in_scope</a></span> <span class="id">P_def</span> <span class="id">x</span> (<span class="kwd">Scope</span> <span class="id">locs</span> <span class="id">blks</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> Γ, <span class="id">P_wc</span> Γ <span class="id">blks</span> -&gt; <span class="id">P_def</span> <span class="id">blks</span> -&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#var_last_ident">var_last_ident</a></span> <span class="id">x</span>) Γ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#var_last_ident">var_last_ident</a></span> <span class="id">x</span>) Γ.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof103')">Proof.</span></div>
<div class="proofscript" id="proof103">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hck</span> <span class="id">Hdef</span> <span class="id">Hind</span>; <span class="id">inv</span> <span class="id">Hck</span>; <span class="id">subst</span> Γ'; <span class="id">inv</span> <span class="id">Hdef</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Hind</span>, <span class="id"><a href="Velus.Common.CommonList.html#InMembers_app">InMembers_app</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> [|]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="id">apply</span> <span class="id">H5</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.InMembers_senv_of_decls">InMembers_senv_of_decls</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<h3> Change unifying substitution </h3>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.instck_refines">instck_refines</a></span> : <span class="kwd">forall</span> <span class="id">bck</span> <span class="id">sub1</span> <span class="id">sub2</span> <span class="id">ck</span> <span class="id">ck</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">sub1</span> <span class="id">x</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span> -&gt; <span class="id">sub2</span> <span class="id">x</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.instck">instck</a></span> <span class="id">bck</span> <span class="id">sub1</span> <span class="id">ck</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ck</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Cks.instck">instck</a></span> <span class="id">bck</span> <span class="id">sub2</span> <span class="id">ck</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ck</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof104')">Proof.</span></div>
<div class="proofscript" id="proof104">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hsub</span>. <span class="id">revert</span> <span class="id">ck</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ck</span>; <span class="id">intros</span> * <span class="id">Hinst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cases_eqn</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">Hinst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHck</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>). <span class="id">inv</span> <span class="id">IHck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Hsub</span> <span class="kwd">in</span> <span class="id">Heq0</span>. <span class="id">rewrite</span> <span class="id">Heq0</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="id">inv</span> <span class="id">Heq2</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">Hsub</span> <span class="kwd">in</span> <span class="id">Heq0</span>. <span class="id">rewrite</span> <span class="id">Heq0</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="id">inv</span> <span class="id">Heq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">IHck</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>). <span class="id">inv</span> <span class="id">IHck</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.WellInstantiated_refines1">WellInstantiated_refines1</a></span> : <span class="kwd">forall</span> <span class="id">bck</span> <span class="id">sub1</span> <span class="id">sub2</span> <span class="id">x</span> <span class="id">ck1</span> <span class="id">ck2</span> <span class="id">o</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">sub1</span> <span class="id">x</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span> -&gt; <span class="id">sub2</span> <span class="id">x</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sub2</span> <span class="id">x</span> = <span class="id">o</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span> <span class="id">sub1</span> (<span class="id">x</span>, <span class="id">ck1</span>) (<span class="id">ck2</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span> <span class="id">sub2</span> (<span class="id">x</span>, <span class="id">ck1</span>) (<span class="id">ck2</span>, <span class="id">o</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof105')">Proof.</span></div>
<div class="proofscript" id="proof105">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hsub1</span> <span class="id">Hsub2</span> (<span class="id">Hs</span>&amp;<span class="id">Hinst</span>); <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.instck_refines">instck_refines</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.WellInstantiated_refines2">WellInstantiated_refines2</a></span> : <span class="kwd">forall</span> <span class="id">bck</span> <span class="id">sub1</span> <span class="id">sub2</span> <span class="id">x</span> <span class="id">ck1</span> <span class="id">ck2</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">sub1</span> <span class="id">x</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span> -&gt; <span class="id">sub2</span> <span class="id">x</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span> <span class="id">sub1</span> (<span class="id">x</span>, <span class="id">ck1</span>) (<span class="id">ck2</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.WellInstantiated">WellInstantiated</a></span> <span class="id">bck</span> <span class="id">sub2</span> (<span class="id">x</span>, <span class="id">ck1</span>) (<span class="id">ck2</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof106')">Proof.</span></div>
<div class="proofscript" id="proof106">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hsub1</span> (<span class="id">Hs</span>&amp;<span class="id">Hinst</span>); <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING.instck_refines">instck_refines</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">Additional helper lemmas </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.map_filter_clo_HasClock1">map_filter_clo_HasClock1</a></span> : <span class="kwd">forall</span> Γ Γ' <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>', <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ' <span class="id">x</span> <span class="id">ck</span>' -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span> /\ <span class="id">ck</span>' = <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ' <span class="id">x</span> <span class="id">ck</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x2</span>, <span class="id">ann0</span>) =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.clo">clo</a></span> <span class="id">ann0</span> ==<span class="id">b</span> <span class="id">ck</span> <span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">x2</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.ann_with_clock">ann_with_clock</a></span> <span class="id">ann0</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) Γ)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> <span class="id">ck</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof107')">Proof.</span></div>
<div class="proofscript" id="proof107">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Cks</span> * <span class="id">Ck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">Cks</span> <span class="kwd">as</span> (<span class="id">Ck</span>'&amp;?); <span class="id">eauto</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Ck</span>'. <span class="id">econstructor</span>. <span class="id">solve_In</span>. <span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span>. <span class="id">eauto</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="LCLOCKING.map_filter_clo_IsLast1">map_filter_clo_IsLast1</a></span> : <span class="kwd">forall</span> Γ Γ' <span class="id">ck</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers">NoDupMembers</a></span> Γ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>', <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ' <span class="id">x</span> <span class="id">ck</span>' -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span> /\ <span class="id">ck</span>' = <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ' <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> Γ' <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.LClocking.html#Senv.IsLast">IsLast</a></span> (<span class="id"><a href="Velus.Common.CommonList.html#map_filter">map_filter</a></span> (<span class="kwd">fun</span> '(<span class="id">x2</span>, <span class="id">ann0</span>) =&gt; <span class="kwd">if</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.clo">clo</a></span> <span class="id">ann0</span> ==<span class="id">b</span> <span class="id">ck</span> <span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">x2</span>, <span class="id"><a href="Velus.Lustre.LClocking.html#Senv.ann_with_clock">ann_with_clock</a></span> <span class="id">ann0</span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks.Cbase">Cbase</a></span>) <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) Γ) <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof108')">Proof.</span></div>
<div class="proofscript" id="proof108">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">ND</span> <span class="id">Cks</span> <span class="id">Ls</span> * <span class="id">L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Ls</span> <span class="id">_</span> <span class="id">L</span>). <span class="id">inv</span> <span class="id">L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">Cks</span> <span class="kwd">as</span> (<span class="id">Ck</span>'&amp;?); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Ls</span>. <span class="id">inv</span> <span class="id">Ck</span>'. <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#NoDupMembers_det">NoDupMembers_det</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">eauto</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">solve_In</span>. <span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span>. <span class="id">eauto</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING">LCLOCKING</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="LClockingFun">LClockingFun</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Ids</span>   : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Op</span>    : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Cks</span>   : <span class="id"><a href="Velus.Clocks.html#CLOCKS">CLOCKS</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Senv</span>  : <span class="id"><a href="Velus.Lustre.StaticEnv.html#STATICENV">STATICENV</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Syn</span>   : <span class="id"><a href="Velus.Lustre.LSyntax.html#LSYNTAX">LSYNTAX</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Senv">Senv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;: <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING">LCLOCKING</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn">Syn</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Include</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING">LCLOCKING</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html#Syn">Syn</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.LClocking.html#LClockingFun">LClockingFun</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
