
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module CACorrectness</title>
<meta name="description" content="Documentation of Coq module CACorrectness" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module CACorrectness</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#ListNotations">List.ListNotations</a></span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Setoids.Setoid.html">Setoid</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.Common.html">Common</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Operators.html">Operators</a></span> <span class="id"><a href="Velus.Environment.html">Environment</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.FunctionalEnvironment.html">FunctionalEnvironment</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Clocks.html">Clocks</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.CoindStreams.html">CoindStreams</a></span> <span class="id"><a href="Velus.IndexedStreams.html">IndexedStreams</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.CoindIndexed.html">CoindIndexed</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.StaticEnv.html">StaticEnv</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.LSyntax.html">Lustre.LSyntax</a></span> <span class="id"><a href="Velus.Lustre.LOrdered.html">Lustre.LOrdered</a></span> <span class="id"><a href="Velus.Lustre.LTyping.html">Lustre.LTyping</a></span> <span class="id"><a href="Velus.Lustre.LClocking.html">Lustre.LClocking</a></span> <span class="id"><a href="Velus.Lustre.LSemantics.html">Lustre.LSemantics</a></span> <span class="id"><a href="Velus.Lustre.LClockedSemantics.html">Lustre.LClockedSemantics</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.CompAuto.CompAuto.html">Lustre.CompAuto.CompAuto</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CAClocking.html">Lustre.CompAuto.CAClocking</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.SubClock.SCCorrectness.html">Lustre.SubClock.SCCorrectness</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="kwd">Type</span> <span class="id"><a name="CACORRECTNESS">CACORRECTNESS</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ids</span> : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Op</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Cks</span> : <span class="id"><a href="Velus.Clocks.html#CLOCKS">CLOCKS</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">CStr</span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS">COINDSTREAMS</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Senv</span> : <span class="id"><a href="Velus.Lustre.StaticEnv.html#STATICENV">STATICENV</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Syn</span> : <span class="id"><a href="Velus.Lustre.LSyntax.html#LSYNTAX">LSYNTAX</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ty</span> : <span class="id"><a href="Velus.Lustre.LTyping.html#LTYPING">LTYPING</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Cl</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING">LCLOCKING</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Ord</span> : <span class="id"><a href="Velus.Lustre.LOrdered.html#LORDERED">LORDERED</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">Sem</span> : <span class="id"><a href="Velus.Lustre.LSemantics.html#LSEMANTICS">LSEMANTICS</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ord">Ord</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr">CStr</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">LCS</span> : <span class="id"><a href="Velus.Lustre.LClockedSemantics.html#LCLOCKEDSEMANTICS">LCLOCKEDSEMANTICS</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cl">Cl</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ord">Ord</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr">CStr</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem">Sem</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">Import</span> <span class="id">CA</span>  : <span class="id"><a href="Velus.Lustre.CompAuto.CompAuto.html#COMPAUTO">COMPAUTO</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn">Syn</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="kwd">Import</span> <span class="id"><a name="CACORRECTNESS.SCC">SCC</a></span> := <span class="id"><a href="Velus.Lustre.SubClock.SCCorrectness.html#SCCorrectnessFun">SCCorrectnessFun</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr">CStr</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cl">Cl</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ord">Ord</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem">Sem</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS">LCS</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.SC">SC</a></span>. <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.SC">SC</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.Fresh">Fresh</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.Fresh.Notations">Notations</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.Fresh.Facts">Facts</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.Fresh.Tactics">Tactics</a></span>.<br/>
&nbsp;&nbsp;<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">fresh_monad_scope</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="CACORRECTNESS.stres_proj1">stres_proj1</a></span> := <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_st">stres_st</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="CACORRECTNESS.stres_proj2">stres_proj2</a></span> (<span class="id">stres</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.synchronous">synchronous</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>))) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#map">Streams.map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">_</span>, <span class="id">b</span>) =&gt; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op.Venum">Venum</a></span> (<span class="kwd">if</span> (<span class="id">b</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.true_tag">OpAux.true_tag</a></span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.false_tag">OpAux.false_tag</a></span>)) <span class="kwd">end</span>) <span class="id">stres</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span> ==&gt; @<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">stres_proj2_EqSt</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="id">constructor</span>; <span class="id">simpl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CACORRECTNESS.ac_stres_proj1">ac_stres_proj1</a></span> : <span class="kwd">forall</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.abstract_clock">abstract_clock</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">xs</span>) ≡ <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.abstract_clock">abstract_clock</a></span> <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="id">intros</span>. <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.ac_nth">ac_nth</a></span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">xs</span> # <span class="id">n</span>) <span class="kwd">as</span> [|(?&amp;?)]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CACORRECTNESS.ac_stres_proj2">ac_stres_proj2</a></span> : <span class="kwd">forall</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.abstract_clock">abstract_clock</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">xs</span>) ≡ <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.abstract_clock">abstract_clock</a></span> <span class="id">xs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="id">intros</span>. <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.ac_nth">ac_nth</a></span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">xs</span> # <span class="id">n</span>) <span class="kwd">as</span> [|(?&amp;?)]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CACORRECTNESS.stres_proj1_const">stres_proj1_const</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">x</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.const_stres">const_stres</a></span> <span class="id">bs</span> (<span class="id">x</span>, <span class="id">r</span>)) ≡ <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.enum">enum</a></span> <span class="id">bs</span> <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="id">intros</span>. <span class="id">repeat</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">enum_nth</span>'. <span class="id">destruct</span> (<span class="id">bs</span> # <span class="id">n</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CACORRECTNESS.stres_proj2_const">stres_proj2_const</a></span> : <span class="kwd">forall</span> <span class="id">bs</span> <span class="id">x</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.const_stres">const_stres</a></span> <span class="id">bs</span> (<span class="id">x</span>, <span class="id">r</span>)) ≡ <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.enum">enum</a></span> <span class="id">bs</span> (<span class="kwd">if</span> <span class="id">r</span> <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.true_tag">true_tag</a></span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.false_tag">false_tag</a></span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="id">intros</span>. <span class="id">repeat</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">enum_nth</span>'. <span class="id">destruct</span> (<span class="id">bs</span> # <span class="id">n</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CACORRECTNESS.stres_proj1_fselect">stres_proj1_fselect</a></span> : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect">fselect</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">xs</span>) ≡ <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselectv">fselectv</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">stres</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">xs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> *. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselectv">fselectv</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect">fselect</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="id">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.mask_nth">mask_nth</a></span>, 2 <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhen_nth">fwhen_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>), (<span class="id">stres</span> # <span class="id">n</span>) <span class="kwd">as</span> [|(?&amp;?)]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CACORRECTNESS.stres_proj2_fselect">stres_proj2_fselect</a></span> : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect">fselect</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">xs</span>) ≡ <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselectv">fselectv</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">stres</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">xs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> *. <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselectv">fselectv</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect">fselect</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="id">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.mask_nth">mask_nth</a></span>, 2 <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhen_nth">fwhen_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">_</span> =? <span class="id">_</span>), (<span class="id">stres</span> # <span class="id">n</span>) <span class="kwd">as</span> [|(?&amp;?)]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html">Permutation</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="CACORRECTNESS.sem_node">sem_node</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="CACORRECTNESS.sem_node.G1">G1</a></span> : @<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.complete">complete</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids.elab_prefs">elab_prefs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="CACORRECTNESS.sem_node.G2">G2</a></span> : @<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.global">global</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.noauto">noauto</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids.auto_prefs">auto_prefs</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="CACORRECTNESS.sem_node.HwcG">HwcG</a></span> : <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cl.wc_global">wc_global</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="CACORRECTNESS.sem_node.Href">Href</a></span> : <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.global_sem_refines">global_sem_refines</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G2">G2</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">auto_block_simpl_Forall</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_Forall</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Hmap</span>: <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.Fresh.mmap2">mmap2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = (?<span class="id">blks</span>', <span class="id">_</span>, <span class="id">_</span>), <span class="id">Hin</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">_</span> ?<span class="id">blks</span>' |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.Fresh.mmap2_values">mmap2_values</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#Forall3_ignore13">Forall3_ignore13</a></span> <span class="kwd">in</span> <span class="id">Hmap</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>; <span class="id">simpl_Forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="id">repeat</span> <span class="id">inv_bind</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CACORRECTNESS.case_first_of1">case_first_of1</a></span> : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">r</span> <span class="id">bs</span> <span class="id">vs</span> <span class="id">bs</span>' <span class="id">stres</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.bools_of">bools_of</a></span> <span class="id">vs</span> <span class="id">bs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.abstract_clock">abstract_clock</a></span> <span class="id">vs</span> ≡ <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.abstract_clock">abstract_clock</a></span> <span class="id">stres</span> ≡ <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.case">case</a></span> <span class="id">vs</span> [(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.true_tag">true_tag</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.enum">enum</a></span> <span class="id">bs</span> <span class="id">e</span>); (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.false_tag">false_tag</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">stres</span>)] <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.first_of">first_of</a></span> (<span class="id">e</span>, <span class="id">r</span>) <span class="id">bs</span>' <span class="id">stres</span>)).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hbools</span> <span class="id">Hac1</span> <span class="id">Hac2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.case_spec">case_spec</a></span>; <span class="id">intros</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hac1</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.ac_nth">ac_nth</a></span> <span class="kwd">in</span> <span class="id">Hac1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hac2</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.ac_nth">ac_nth</a></span> <span class="kwd">in</span> <span class="id">Hac2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.bools_of_nth">bools_of_nth</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hbools</span> <span class="kwd">as</span> [(<span class="id">Hv</span>&amp;<span class="id">Hb</span>)|[(<span class="id">Hv</span>&amp;<span class="id">Hb</span>)|(<span class="id">Hv</span>&amp;<span class="id">Hb</span>)]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">right</span>;<span class="id">left</span>|<span class="id">right</span>;<span class="id">left</span>|<span class="id">left</span>]; <span class="id">setoid_rewrite</span> <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hac1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">stres</span> # <span class="id">n</span>) <span class="kwd">as</span> [|(?&amp;?)] <span class="id">eqn</span>:<span class="id">Hst</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">do</span> 2 <span class="id">esplit</span>. <span class="id">repeat</span> (<span class="id">split</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id">enum_nth</span>', &lt;-<span class="id">Hac1</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id">Hst</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>. <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">enum_nth</span>', &lt;-<span class="id">Hac1</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.first_of_nth">first_of_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hb</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">do</span> 2 <span class="id">esplit</span>. <span class="id">repeat</span> (<span class="id">split</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id">enum_nth</span>', &lt;-<span class="id">Hac1</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id">Hst</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>; <span class="id">left</span>. <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id">Hst</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.first_of_nth">first_of_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hb</span>, <span class="id">Hst</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id">enum_nth</span>', &lt;-<span class="id">Hac1</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id">Hst</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.first_of_nth">first_of_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hb</span>. <span class="id">rewrite</span> <span class="id">Hst</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CACORRECTNESS.case_first_of2">case_first_of2</a></span> : <span class="kwd">forall</span> <span class="id">e</span> <span class="id">r</span> <span class="id">bs</span> <span class="id">vs</span> <span class="id">bs</span>' <span class="id">stres</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.bools_of">bools_of</a></span> <span class="id">vs</span> <span class="id">bs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.abstract_clock">abstract_clock</a></span> <span class="id">vs</span> ≡ <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.abstract_clock">abstract_clock</a></span> <span class="id">stres</span> ≡ <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.case">case</a></span> <span class="id">vs</span> [(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.true_tag">true_tag</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.enum">enum</a></span> <span class="id">bs</span> (<span class="kwd">if</span> (<span class="id">r</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.true_tag">true_tag</a></span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.false_tag">false_tag</a></span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.false_tag">false_tag</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">stres</span>)] <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.first_of">first_of</a></span> (<span class="id">e</span>, <span class="id">r</span>) <span class="id">bs</span>' <span class="id">stres</span>)).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hbools</span> <span class="id">Hac1</span> <span class="id">Hac2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.case_spec">case_spec</a></span>; <span class="id">intros</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hac1</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.ac_nth">ac_nth</a></span> <span class="kwd">in</span> <span class="id">Hac1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hac2</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.ac_nth">ac_nth</a></span> <span class="kwd">in</span> <span class="id">Hac2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.bools_of_nth">bools_of_nth</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hbools</span> <span class="kwd">as</span> [(<span class="id">Hv</span>&amp;<span class="id">Hb</span>)|[(<span class="id">Hv</span>&amp;<span class="id">Hb</span>)|(<span class="id">Hv</span>&amp;<span class="id">Hb</span>)]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">right</span>;<span class="id">left</span>|<span class="id">right</span>;<span class="id">left</span>|<span class="id">left</span>]; <span class="id">setoid_rewrite</span> <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hac1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">stres</span> # <span class="id">n</span>) <span class="kwd">as</span> [|(?&amp;?)] <span class="id">eqn</span>:<span class="id">Hst</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">do</span> 2 <span class="id">esplit</span>. <span class="id">repeat</span> (<span class="id">split</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id">enum_nth</span>', &lt;-<span class="id">Hac1</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id">Hst</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>. <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">enum_nth</span>', &lt;-<span class="id">Hac1</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.first_of_nth">first_of_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hb</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">do</span> 2 <span class="id">esplit</span>. <span class="id">repeat</span> (<span class="id">split</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id">enum_nth</span>', &lt;-<span class="id">Hac1</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id">Hst</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>; <span class="id">left</span>. <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id">Hst</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.first_of_nth">first_of_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hb</span>, <span class="id">Hst</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id">enum_nth</span>', &lt;-<span class="id">Hac1</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id">Hst</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.first_of_nth">first_of_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hb</span>. <span class="id">rewrite</span> <span class="id">Hst</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CACORRECTNESS.init_state_exp_sem">init_state_exp_sem</a></span> Γ : <span class="kwd">forall</span> <span class="id">Hi</span> <span class="id">bs</span> <span class="id">tx</span> <span class="id">ck</span> <span class="id">bs</span>' <span class="id">trans</span> <span class="id">oth</span> <span class="id">stres0</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cl.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span> Γ <span class="id">e</span> /\ <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = [<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks.Cbase">Cbase</a></span>]) <span class="id">trans</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_clock">sem_clock</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.var_history">var_history</a></span> <span class="id">Hi</span>) <span class="id">bs</span> <span class="id">ck</span> <span class="id">bs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars">sc_vars</a></span> Γ <span class="id">Hi</span> <span class="id">bs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_ck">sem_transitions_ck</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span> <span class="id">Hi</span> <span class="id">bs</span>' (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">t</span>) =&gt; (<span class="id">e</span>, (<span class="id">t</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>))) <span class="id">trans</span>) (<span class="id">oth</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">stres0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_exp_ck">sem_exp_ck</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G2">G2</a></span> <span class="id">Hi</span> <span class="id">bs</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.init_state_exp">init_state_exp</a></span> <span class="id">tx</span> <span class="id">ck</span> <span class="id">trans</span> <span class="id">oth</span>) [<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">stres0</span>].<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">trans</span> <span class="kwd">as</span> [|(?&amp;?)]; <span class="id">intros</span> * <span class="id">Hwc</span> <span class="id">Hck</span> <span class="id">Hsc</span> <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">Hwc</span>; <span class="id">inv</span> <span class="id">Hsem</span>; <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id">H0</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1_const">stres_proj1_const</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.add_whens_enum_sem">add_whens_enum_sem</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.subclock_exp_sem">subclock_exp_sem</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">intros</span> * <span class="id">Hfind</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Environment.html#Env.gempty">Env.gempty</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="id">inv</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.add_whens_enum_sem">add_whens_enum_sem</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>. 2,3:<span class="id">simpl</span>; <span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>. <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H13</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.case_first_of1">case_first_of1</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_exp">sc_exp</a></span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.clockof">clockof</a></span> <span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="id">simpl_Forall</span>. <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_transitions">sc_transitions</a></span> <span class="kwd">in</span> <span class="id">H12</span>; <span class="id">eauto</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CACORRECTNESS.trans_exp_sem">trans_exp_sem</a></span> Γ : <span class="kwd">forall</span> <span class="id">Hi</span> <span class="id">bs</span> <span class="id">tx</span>   <span class="id">trans</span> <span class="id">oth</span> <span class="id">stres</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cl.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span> Γ <span class="id">e</span> /\ <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = [<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks.Cbase">Cbase</a></span>]) <span class="id">trans</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars">sc_vars</a></span> Γ <span class="id">Hi</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_ck">sem_transitions_ck</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span> <span class="id">Hi</span> <span class="id">bs</span> <span class="id">trans</span> (<span class="id">oth</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">stres</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">vss</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_exp_ck">sem_exp_ck</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G2">G2</a></span> <span class="id">Hi</span> <span class="id">bs</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.trans_exp">trans_exp</a></span> <span class="id">tx</span> <span class="id">trans</span> <span class="id">oth</span>) <span class="id">vss</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">vss</span> = [<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">stres</span>; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">stres</span>].<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">trans</span> <span class="kwd">as</span> [|(?&amp;?)]; <span class="id">intros</span> * <span class="id">Hwc</span> <span class="id">Hsc</span> <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">Hwc</span>; <span class="id">inv</span> <span class="id">Hsem</span>; <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="kwd">exists</span> [[<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">stres</span>]; [<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">stres</span>]]. <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; [|<span class="id">constructor</span>]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1_const">stres_proj1_const</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">H0</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="id">intro</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id">H0</span>, <span class="id">enum_nth</span>'. <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">bs</span> # <span class="id">n</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">assert</span> (<span class="id">Htrans</span>:=<span class="id">H11</span>). <span class="id">eapply</span> <span class="id">IHtrans</span> <span class="kwd">in</span> <span class="id">H11</span> <span class="kwd">as</span> (?&amp;<span class="id">Hsem</span>&amp;<span class="id">Hconcat</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>. <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. 1:<span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_ref_sem_exp">sem_ref_sem_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3:<span class="id">simpl</span>; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econstructor</span>. 1,2:<span class="id">econstructor</span>; <span class="id">eauto</span>. 2:<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">constructor</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2,3:<span class="id">simpl</span>. 3:<span class="id">do</span> 3 (<span class="id">constructor</span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">rewrite</span> <span class="id">Hconcat</span>. <span class="id">do</span> 3 (<span class="id">constructor</span>; <span class="id">auto</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_exp">sc_exp</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.clockof">clockof</a></span> <span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">simpl_Forall</span>. <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_transitions">sc_transitions</a></span> <span class="kwd">in</span> <span class="id">Htrans</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id">H12</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.case_first_of1">case_first_of1</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id">H12</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.case_first_of2">case_first_of2</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CACORRECTNESS.sem_transitions_init_noreset">sem_transitions_init_noreset</a></span> Γ : <span class="kwd">forall</span> <span class="id">ck</span> <span class="id">ini</span> <span class="id">oth</span> <span class="id">Hi</span> <span class="id">bs</span> <span class="id">bs</span>' <span class="id">stres</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cl.wc_exp">wc_exp</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span> Γ <span class="id">e</span> /\ <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.clockof">clockof</a></span> <span class="id">e</span> = [<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks.Cbase">Cbase</a></span>]) <span class="id">ini</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_clock">sem_clock</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.var_history">var_history</a></span> <span class="id">Hi</span>) <span class="id">bs</span> <span class="id">ck</span> <span class="id">bs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars">sc_vars</a></span> Γ <span class="id">Hi</span> <span class="id">bs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_ck">sem_transitions_ck</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span> <span class="id">Hi</span> <span class="id">bs</span>' (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">t</span>) =&gt; (<span class="id">e</span>, (<span class="id">t</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>))) <span class="id">ini</span>) (<span class="id">oth</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">stres</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">stres</span> ≡ <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.enum">enum</a></span> <span class="id">bs</span>' <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.false_tag">false_tag</a></span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">ini</span> <span class="kwd">as</span> [|(?&amp;?)]; <span class="id">intros</span> * <span class="id">Hwc</span> <span class="id">Hck</span> <span class="id">Hsc</span> <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">Hwc</span>; <span class="id">inv</span> <span class="id">Hsem</span>; <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="id">intros</span> <span class="id">n</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id">H0</span>, <span class="id">enum_nth</span>'. <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">bs</span>' # <span class="id">n</span>); <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#ntheq_eqst">ntheq_eqst</a></span>; <span class="id">intros</span> <span class="id">n</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.abstract_clock">abstract_clock</a></span> <span class="id">vs</span> ≡ <span class="id">bs</span>') <span class="kwd">as</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_exp">sc_exp</a></span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="id">eauto</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.clockof">clockof</a></span> <span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H4</span>. <span class="id">now</span> <span class="id">symmetry</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">rewrite</span> <span class="id">H13</span>, <span class="id">enum_nth</span>', <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.first_of_nth">first_of_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHini</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">H12</span> <span class="kwd">as</span> <span class="id">Hind</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span> <span class="kwd">in</span> <span class="id">Hind</span>. <span class="id">rewrite</span> <span class="id">enum_nth</span>' <span class="kwd">in</span> <span class="id">Hind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hac</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.ac_nth">ac_nth</a></span> <span class="kwd">in</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">bs</span>' # <span class="id">n</span>) <span class="id">eqn</span>:<span class="id">Hb</span>', (<span class="id">bs</span>'0 # <span class="id">n</span>) <span class="id">eqn</span>:<span class="id">Hb</span>, (<span class="id">stres1</span> # <span class="id">n</span>) <span class="kwd">as</span> [|(?&amp;?)] <span class="id">eqn</span>:<span class="id">Hst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.bools_of_nth">bools_of_nth</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">H11</span> <span class="kwd">as</span> [(<span class="id">Hv</span>&amp;?)|[(?&amp;?)|(?&amp;?)]]; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hac</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CACORRECTNESS.fby1_stres_proj1">fby1_stres_proj1</a></span> : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">e</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby1">fby1</a></span> (<span class="id">e</span>, <span class="id">b</span>) <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby1">fby1</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op.Venum">Venum</a></span> <span class="id">e</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">ys</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">zs</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_st">stres_st</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="id">intros</span> * <span class="id">Hfby</span>; <span class="id">inv</span> <span class="id">Hfby</span>; <span class="id">simpl</span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#map_Cons">map_Cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">w</span>, <span class="id">s</span>. <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CACORRECTNESS.fby_stres_proj1">fby_stres_proj1</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">ys</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">zs</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_st">stres_st</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="id">intros</span> * <span class="id">Hfby</span>; <span class="id">inv</span> <span class="id">Hfby</span>; <span class="id">simpl</span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#map_Cons">map_Cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">x</span>, <span class="id">y</span>. <span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.fby1_stres_proj1">fby1_stres_proj1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CACORRECTNESS.fby1_stres_proj2">fby1_stres_proj2</a></span> : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">e</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby1">fby1</a></span> (<span class="id">e</span>, <span class="id">b</span>) <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby1">fby1</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op.Venum">Venum</a></span> (<span class="kwd">if</span> (<span class="id">b</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) <span class="kwd">then</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.true_tag">true_tag</a></span> <span class="kwd">else</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.false_tag">false_tag</a></span>)) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">ys</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">zs</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="id">intros</span> * <span class="id">Hfby</span>; <span class="id">inv</span> <span class="id">Hfby</span>; <span class="id">simpl</span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#map_Cons">map_Cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">w</span>, <span class="id">s</span>. <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CACORRECTNESS.fby_stres_proj2">fby_stres_proj2</a></span> : <span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">ys</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">zs</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">CoFix</span>; <span class="id">intros</span> * <span class="id">Hfby</span>; <span class="id">inv</span> <span class="id">Hfby</span>; <span class="id">simpl</span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonStreams.html#map_Cons">map_Cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">x</span>, <span class="id">y</span>. <span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.fby1_stres_proj2">fby1_stres_proj2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Opaque</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict">FEnv.restrict</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CACORRECTNESS.bools_of_stres_proj2">bools_of_stres_proj2</a></span> : <span class="kwd">forall</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.bools_of">bools_of</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_res">stres_res</a></span> <span class="id">xs</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.bools_of_nth">bools_of_nth</a></span>; <span class="id">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">xs</span> # <span class="id">n</span>) <span class="kwd">as</span> [|(?&amp;?)]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">b</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fact</span> <span class="id"><a name="CACORRECTNESS.bools_of_fwhen">bools_of_fwhen</a></span> <span class="id">e</span> : <span class="kwd">forall</span> <span class="id">sc</span> <span class="id">xs</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.bools_of">bools_of</a></span> <span class="id">xs</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.bools_of">bools_of</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhenv">fwhenv</a></span> <span class="id">e</span> <span class="id">xs</span> <span class="id">sc</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhenb">fwhenb</a></span> <span class="id">e</span> <span class="id">bs</span> <span class="id">sc</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hbools</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.bools_of_nth">bools_of_nth</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">n</span>. <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhenv_nth">fwhenv_nth</a></span>. <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhenb_nth">fwhenb_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hbools</span> <span class="id">n</span>) <span class="kwd">as</span> [(<span class="id">Hx</span>&amp;<span class="id">Hb</span>)|[(<span class="id">Hx</span>&amp;<span class="id">Hb</span>)|(<span class="id">Hx</span>&amp;<span class="id">Hb</span>)]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">_</span> ==<span class="id">b</span> <span class="id">_</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CACORRECTNESS.fselect_mask_fwhen_hist">fselect_mask_fwhen_hist</a></span> : <span class="kwd">forall</span> (<span class="id">Hi</span>: <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.history">history</a></span>) <span class="id">e</span> <span class="id">k</span> <span class="id">stres</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.Equiv">FEnv.Equiv</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> (<span class="id">A</span>:=<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.svalue">svalue</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect_hist">fselect_hist</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">Hi</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.mask_hist">CStr.mask_hist</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhenb">fwhenb</a></span> <span class="id">e</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_res">stres_res</a></span> <span class="id">stres</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_st">stres_st</a></span> <span class="id">stres</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhen_hist">fwhen_hist</a></span> <span class="id">e</span> <span class="id">Hi</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_st">stres_st</a></span> <span class="id">stres</span>))).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect_hist">fselect_hist</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.mask_hist">CStr.mask_hist</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhen_hist">fwhen_hist</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map_map">FEnv.map_map</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonStreams.html#EqStrel_Reflexive">EqStrel_Reflexive</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map_Equiv">FEnv.map_Equiv</a></span>. 2:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Heq</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="CACORRECTNESS.default_ann">default_ann</a></span> : <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.annotation">annotation</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.Build_annotation">Build_annotation</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.bool_velus_type">OpAux.bool_velus_type</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks.Cbase">Cbase</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">inv_branch</span> := (<span class="id">Syn.inv_branch</span> || <span class="id">Ty.inv_branch</span> || <span class="id">Cl.inv_branch</span> || <span class="id">Sem.inv_branch</span> || <span class="id">LCS.inv_branch</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">inv_scope</span> := (<span class="id">Syn.inv_scope</span> || <span class="id">Ty.inv_scope</span> || <span class="id">Cl.inv_scope</span> || <span class="id">Sem.inv_scope</span> || <span class="id">LCS.inv_scope</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Local</span> <span class="kwd">Ltac</span> <span class="id">sem_new_vars</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>; <span class="id">eapply</span> <span class="id">sem_var_union3</span>', <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_var_of_list">sem_var_of_list</a></span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_NoDupMembers">fst_NoDupMembers</a></span>; <span class="id">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CACORRECTNESS.sc_vars_fselect">sc_vars_fselect</a></span> <span class="id">ck</span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> : <span class="kwd">forall</span> Γ Γ' <span class="id">Hi</span> <span class="id">bs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_clock">sem_clock</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.var_history">var_history</a></span> <span class="id">Hi</span>) <span class="id">bs</span> <span class="id">ck</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.abstract_clock">abstract_clock</a></span> <span class="id">sc</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>', <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.HasClock">HasClock</a></span> Γ' <span class="id">x</span> <span class="id">ck</span>' -&gt; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.HasClock">HasClock</a></span> Γ <span class="id">x</span> <span class="id">ck</span> /\ <span class="id">ck</span>' = <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks.Cbase">Cbase</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsLast">IsLast</a></span> Γ' <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsLast">IsLast</a></span> Γ <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars">sc_vars</a></span> Γ <span class="id">Hi</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars">sc_vars</a></span> Γ' (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect_hist">fselect_hist</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> <span class="id">Hi</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselectb">fselectb</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">sc</span> <span class="id">bs</span>).<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hsemck</span> <span class="id">Hcks</span> <span class="id">Hlasts</span> (<span class="id">Hsc1</span>&amp;<span class="id">Hsc2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hck</span> <span class="id">Hv</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_var_fselect_inv">sem_var_fselect_inv</a></span> <span class="kwd">in</span> <span class="id">Hv</span> <span class="kwd">as</span> (?&amp;<span class="id">Hv</span>&amp;<span class="id">Hsel</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hsel</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.ac_fselect">ac_fselect</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">Hcks</span> <span class="kwd">as</span> (?&amp;?); <span class="id">eauto</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Hsc1</span> <span class="kwd">in</span> <span class="id">Hv</span> <span class="kwd">as</span> <span class="id">Hsck</span>; <span class="id">eauto</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_clock_det">sem_clock_det</a></span> <span class="kwd">in</span> <span class="id">Hsck</span>; [|<span class="id">eapply</span> <span class="id">Hsemck</span>]. <span class="id">rewrite</span> &lt;-<span class="id">Hsck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_clock_select">sem_clock_select</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hck</span> <span class="id">Hlast</span> <span class="id">Hv</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_var_fselect_inv">sem_var_fselect_inv</a></span> <span class="kwd">in</span> <span class="id">Hv</span> <span class="kwd">as</span> (?&amp;<span class="id">Hv</span>&amp;<span class="id">Hsel</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hsel</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.ac_fselect">ac_fselect</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">Hcks</span> <span class="kwd">as</span> (?&amp;?); <span class="id">eauto</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Hsc2</span> <span class="kwd">in</span> <span class="id">Hv</span> <span class="kwd">as</span> <span class="id">Hsck</span>; <span class="id">eauto</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_clock_det">sem_clock_det</a></span> <span class="kwd">in</span> <span class="id">Hsck</span>; [|<span class="id">eapply</span> <span class="id">Hsemck</span>]. <span class="id">rewrite</span> &lt;-<span class="id">Hsck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_clock_select">sem_clock_select</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CACORRECTNESS.sem_transitions_wt_state">sem_transitions_wt_state</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span> <span class="id">A</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) (<span class="id">states</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> ((<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) * <span class="id">A</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Hi</span> <span class="id">bs</span> <span class="id">trans</span> <span class="id">default</span> <span class="id">stres</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation.Permutation</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">states</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">states</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, (<span class="id">t</span>, <span class="id">_</span>)) =&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">t</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">states</span>)) <span class="id">trans</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">default</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">states</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_ck">sem_transitions_ck</a></span> <span class="id">G</span> <span class="id">Hi</span> <span class="id">bs</span> <span class="id">trans</span> <span class="id">default</span> <span class="id">stres</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonStreams.html#SForall">SForall</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id">e</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">states</span> | <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="kwd">end</span>) <span class="id">stres</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">trans</span>; <span class="id">intros</span> * <span class="id">Hperm</span> <span class="id">Hwt1</span> <span class="id">Hwt2</span> <span class="id">Hsem</span>; <span class="id">inv</span> <span class="id">Hwt1</span>; <span class="id">inv</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_ind">eq_ind</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e0</span>, <span class="id">_</span>) =&gt; <span class="id">_</span> <span class="kwd">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">symmetry</span>; <span class="id">apply</span> <span class="id">H0</span>. <span class="id">destruct</span> (<span class="id">bs</span> # <span class="id">n</span>); <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">default0</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span> <span class="kwd">in</span> <span class="id">Hwt2</span>; <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">IHtrans</span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.first_of_nth">first_of_nth</a></span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_ind">eq_ind</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e0</span>, <span class="id">_</span>) =&gt; <span class="id">_</span> <span class="kwd">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">symmetry</span>; <span class="id">apply</span> <span class="id">H11</span>. <span class="id">destruct</span> (<span class="id">bs</span>' # <span class="id">n</span>); <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>, <span class="id">Hperm</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="CACORRECTNESS.sem_automaton_wt_state1">sem_automaton_wt_state1</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span> <span class="id">A</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) (<span class="id">states</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> ((<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) * <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.branch">branch</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.transition">transition</a></span> * <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.scope">scope</a></span> (<span class="id">A</span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.transition">transition</a></span>)))) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Hi</span> <span class="id">bs</span> <span class="id">bs</span>' <span class="id">ini</span> <span class="id">oth</span> <span class="id">stres0</span> <span class="id">stres1</span> <span class="id">stres</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation.Permutation</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">states</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">states</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id">t</span>) =&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">t</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">states</span>)) <span class="id">ini</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">oth</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">states</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.Branch">Branch</a></span> <span class="id">_</span> (<span class="id">_</span>, <span class="kwd">Scope</span> <span class="id">_</span> (<span class="id">_</span>, <span class="id">trans</span>))) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, (<span class="id">t</span>, <span class="id">_</span>)) =&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">t</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">states</span>)) <span class="id">trans</span>) <span class="id">states</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_ck">sem_transitions_ck</a></span> <span class="id">G</span> <span class="id">Hi</span> <span class="id">bs</span>' (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, <span class="id">t</span>) =&gt; (<span class="id">e</span>, (<span class="id">t</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>))) <span class="id">ini</span>) (<span class="id">oth</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">stres0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> <span class="id">stres0</span> <span class="id">stres1</span> <span class="id">stres</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '((<span class="id">sel</span>, <span class="id">_</span>), <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.Branch">Branch</a></span> <span class="id">_</span> (<span class="id">_</span>, <span class="kwd">Scope</span> <span class="id">_</span> (<span class="id">_</span>, <span class="id">trans</span>))) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span>, <span class="kwd">exists</span> <span class="id">Hik</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">let</span> <span class="id">bik</span> := <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselectb">fselectb</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">bs</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_ck">sem_transitions_ck</a></span> <span class="id">G</span> <span class="id">Hik</span> <span class="id">bik</span> <span class="id">trans</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sel</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect">fselect</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">stres1</span>))) <span class="id">states</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonStreams.html#SForall">SForall</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id">e</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">states</span> | <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="kwd">end</span>) <span class="id">stres</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hperm</span> <span class="id">Hwtini</span> <span class="id">Hwtoth</span> <span class="id">Hwtst</span> <span class="id">Hsemini</span> <span class="id">Hfby</span> <span class="id">Hsemst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_transitions_wt_state">sem_transitions_wt_state</a></span> <span class="kwd">in</span> <span class="id">Hsemini</span> <span class="kwd">as</span> <span class="id">Hwt0</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">state</span> =&gt; <span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Common.CommonStreams.html#SForall">SForall</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id">e</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">states</span> | <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect">fselect</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">state</span>)) <span class="id">k</span> <span class="id">stres</span> <span class="id">stres1</span>)) <span class="id">states</span>) <span class="kwd">as</span> <span class="id">Hwt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">simpl_Forall</span>. <span class="id">destruct</span> <span class="id">b</span> <span class="kwd">as</span> [?(?&amp;[?(?&amp;?)])]. <span class="id">specialize</span> (<span class="id">Hsemst</span> <span class="id">k</span>); <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_transitions_wt_state">sem_transitions_wt_state</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">Hperm</span>; <span class="id">auto</span>. <span class="id">solve_In</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">Hperm</span> <span class="id">Hwt0</span> <span class="id">Hwt1</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span>; <span class="id">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Wf_nat.html#lt_wf_ind">Wf_nat.lt_wf_ind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Wf_nat.html#lt_wf_ind">Wf_nat.lt_wf_ind</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">n</span>' <span class="id">Hrec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby_SForall">fby_SForall</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hlt</span>. <span class="id">specialize</span> (<span class="id">Hrec</span> <span class="id">_</span> <span class="id">Hlt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">stres</span> # <span class="id">m</span>) <span class="kwd">as</span> [|(?&amp;?)] <span class="id">eqn</span>:<span class="id">Hres</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.ac_fby2">ac_fby2</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">m</span>) <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.ac_nth">ac_nth</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>. <span class="id">rewrite</span> <span class="id">Hres</span> <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">stres1</span> # <span class="id">m</span>) <span class="id">eqn</span>:<span class="id">Hres1</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_ind">eq_ind</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e0</span>, <span class="id">_</span>) =&gt; <span class="id">_</span> <span class="kwd">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">symmetry</span>; <span class="id">apply</span> <span class="id">Hres1</span>. <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_ind">eq_ind</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e0</span>, <span class="id">_</span>) =&gt; <span class="id">_</span> <span class="kwd">end</span>) <span class="kwd">in</span> <span class="id">Hrec</span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">e</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">states</span>))) <span class="kwd">as</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hperm</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span>. <span class="id">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_In</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hwt1</span> ((<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.count">count</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhenb">fwhenb</a></span> <span class="id">e</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_res">stres_res</a></span> <span class="id">stres</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_st">stres_st</a></span> <span class="id">stres</span>))) # <span class="id">m</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">m</span>) <span class="kwd">in</span> <span class="id">Hwt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect">fselect</a></span> <span class="kwd">in</span> <span class="id">Hwt1</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.mask_nth">mask_nth</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhen_nth">fwhen_nth</a></span> <span class="kwd">in</span> <span class="id">Hwt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_st">stres_st</a></span> <span class="kwd">in</span> <span class="id">Hwt1</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>, <span class="id">Hres</span>, <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span> <span class="kwd">in</span> <span class="id">Hwt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="CACORRECTNESS.sem_automaton_wt_state2">sem_automaton_wt_state2</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span> <span class="id">A</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) (<span class="id">states</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> ((<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) * <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.branch">branch</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.transition">transition</a></span> * <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.scope">scope</a></span> (<span class="id">A</span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.transition">transition</a></span>)))) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">bs</span> <span class="id">bs</span>' <span class="id">ini</span> <span class="id">stres1</span> <span class="id">stres</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation.Permutation</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">states</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">states</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">ini</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">states</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.Branch">Branch</a></span> <span class="id">_</span> (<span class="id">trans</span>, <span class="id">_</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, (<span class="id">t</span>, <span class="id">_</span>)) =&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">t</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">states</span>)) <span class="id">trans</span>) <span class="id">states</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.const_stres">const_stres</a></span> <span class="id">bs</span>' (<span class="id">ini</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)) <span class="id">stres1</span> <span class="id">stres</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '((<span class="id">sel</span>, <span class="id">_</span>), <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.Branch">Branch</a></span> <span class="id">_</span> (<span class="id">trans</span>, <span class="id">_</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span>, <span class="kwd">exists</span> <span class="id">Hik</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">let</span> <span class="id">bik</span> := <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselectb">fselectb</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">bs</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_ck">sem_transitions_ck</a></span> <span class="id">G</span> <span class="id">Hik</span> <span class="id">bik</span> <span class="id">trans</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sel</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect">fselect</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">stres1</span>))) <span class="id">states</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonStreams.html#SForall">SForall</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id">e</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">states</span> | <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="kwd">end</span>) <span class="id">stres</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hperm</span> <span class="id">Hwtoth</span> <span class="id">Hwtst</span> <span class="id">Hfby</span> <span class="id">Hsemst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Common.CommonStreams.html#SForall">SForall</a></span> (<span class="kwd">fun</span> <span class="id">s</span> : <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.synchronous">synchronous</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) =&gt; <span class="kwd">match</span> <span class="id">s</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id">e</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">states</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.const_stres">const_stres</a></span> <span class="id">bs</span>' (<span class="id">ini</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>))) <span class="kwd">as</span> <span class="id">Hwt0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span>. <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.const_stres">const_stres</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">destruct</span> (<span class="id">bs</span>' # <span class="id">n</span>); <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span> <span class="kwd">in</span> <span class="id">Hwtoth</span>. <span class="id">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">state</span> =&gt; <span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Common.CommonStreams.html#SForall">SForall</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id">e</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">states</span> | <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect">fselect</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">state</span>)) <span class="id">k</span> <span class="id">stres</span> <span class="id">stres1</span>)) <span class="id">states</span>) <span class="kwd">as</span> <span class="id">Hwt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">simpl_Forall</span>. <span class="id">destruct</span> <span class="id">b</span> <span class="kwd">as</span> [?(?&amp;[?(?&amp;?)])]. <span class="id">specialize</span> (<span class="id">Hsemst</span> <span class="id">k</span>); <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_transitions_wt_state">sem_transitions_wt_state</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">Hperm</span>; <span class="id">auto</span>. <span class="id">solve_In</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">Hperm</span> <span class="id">Hwt0</span> <span class="id">Hwt1</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span>; <span class="id">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Wf_nat.html#lt_wf_ind">Wf_nat.lt_wf_ind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Wf_nat.html#lt_wf_ind">Wf_nat.lt_wf_ind</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">n</span>' <span class="id">Hrec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby_SForall">fby_SForall</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hlt</span>. <span class="id">specialize</span> (<span class="id">Hrec</span> <span class="id">_</span> <span class="id">Hlt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">stres</span> # <span class="id">m</span>) <span class="kwd">as</span> [|(?&amp;?)] <span class="id">eqn</span>:<span class="id">Hres</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.ac_fby2">ac_fby2</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">m</span>) <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.ac_nth">ac_nth</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>. <span class="id">rewrite</span> <span class="id">Hres</span> <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">stres1</span> # <span class="id">m</span>) <span class="id">eqn</span>:<span class="id">Hres1</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">n0</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">states</span>))) <span class="kwd">as</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hperm</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span>. <span class="id">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_In</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hwt1</span> ((<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.count">count</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhenb">fwhenb</a></span> <span class="id">n0</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_res">stres_res</a></span> <span class="id">stres</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_st">stres_st</a></span> <span class="id">stres</span>))) # <span class="id">m</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">m</span>) <span class="kwd">in</span> <span class="id">Hwt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect">fselect</a></span> <span class="kwd">in</span> <span class="id">Hwt1</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.mask_nth">mask_nth</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhen_nth">fwhen_nth</a></span> <span class="kwd">in</span> <span class="id">Hwt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_ind">eq_ind</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e0</span>, <span class="id">_</span>) =&gt; <span class="id">_</span> <span class="kwd">end</span>) <span class="kwd">in</span> <span class="id">Hwt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_st">stres_st</a></span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">setoid_rewrite</span> <span class="id">Hres</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span>. <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="CACORRECTNESS.sem_automaton_wt_state3">sem_automaton_wt_state3</a></span> {<span class="id">PSyn</span> <span class="id">prefs</span> <span class="id">A</span>} (<span class="id">G</span> : @<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.global">global</a></span> <span class="id">PSyn</span> <span class="id">prefs</span>) (<span class="id">states</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> ((<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op.enumtag">enumtag</a></span> * <span class="id"><a href="Velus.Common.Common.html#ident">ident</a></span>) * <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.branch">branch</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.transition">transition</a></span> * <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.scope">scope</a></span> (<span class="id">A</span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.transition">transition</a></span>)))) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">bs</span> <span class="id">bs</span>' <span class="id">ini</span> <span class="id">stres1</span> <span class="id">stres</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation.Permutation</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">states</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">states</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">ini</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">Datatypes.length</a></span> <span class="id">states</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">_</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.Branch">Branch</a></span> <span class="id">_</span> (<span class="id">trans</span>, <span class="id">_</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '(<span class="id">e</span>, (<span class="id">t</span>, <span class="id">_</span>)) =&gt; <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">t</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">states</span>)) <span class="id">trans</span>) <span class="id">states</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.const_stres">const_stres</a></span> <span class="id">bs</span>' (<span class="id">ini</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)) <span class="id">stres1</span> <span class="id">stres</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> '((<span class="id">sel</span>, <span class="id">_</span>), <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.Branch">Branch</a></span> <span class="id">_</span> (<span class="id">trans</span>, <span class="id">_</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span>, <span class="kwd">exists</span> <span class="id">Hik</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">let</span> <span class="id">bik</span> := <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselectb">fselectb</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">bs</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_ck">sem_transitions_ck</a></span> <span class="id">G</span> <span class="id">Hik</span> <span class="id">bik</span> <span class="id">trans</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sel</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect">fselect</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> <span class="id">sel</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">stres1</span>))) <span class="id">states</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Common.CommonStreams.html#SForall">SForall</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id">e</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">states</span> | <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="kwd">end</span>) <span class="id">stres1</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hperm</span> <span class="id">Hwtoth</span> <span class="id">Hwtst</span> <span class="id">Hfby</span> <span class="id">Hsemst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Common.CommonStreams.html#SForall">SForall</a></span> (<span class="kwd">fun</span> <span class="id">s</span> : <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.synchronous">synchronous</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) =&gt; <span class="kwd">match</span> <span class="id">s</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id">e</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">states</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.const_stres">const_stres</a></span> <span class="id">bs</span>' (<span class="id">ini</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>))) <span class="kwd">as</span> <span class="id">Hwt0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span>. <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.const_stres">const_stres</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">destruct</span> (<span class="id">bs</span>' # <span class="id">n</span>); <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span> <span class="kwd">in</span> <span class="id">Hwtoth</span>. <span class="id">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">state</span> =&gt; <span class="kwd">forall</span> <span class="id">k</span>, <span class="id"><a href="Velus.Common.CommonStreams.html#SForall">SForall</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id">e</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">states</span> | <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect">fselect</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">state</span>)) <span class="id">k</span> <span class="id">stres</span> <span class="id">stres1</span>)) <span class="id">states</span>) <span class="kwd">as</span> <span class="id">Hwt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">simpl_Forall</span>. <span class="id">destruct</span> <span class="id">b</span> <span class="kwd">as</span> [?(?&amp;[?(?&amp;?)])]; <span class="id">destruct_conjs</span>. <span class="id">specialize</span> (<span class="id">Hsemst</span> <span class="id">k</span>); <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_transitions_wt_state">sem_transitions_wt_state</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">Hperm</span>; <span class="id">auto</span>. <span class="id">solve_In</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_automaton_wt_state2">sem_automaton_wt_state2</a></span> <span class="kwd">in</span> <span class="id">Hfby</span> <span class="kwd">as</span> <span class="id">Hwt2</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span>; <span class="id">intros</span> <span class="id">n</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hwt2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.ac_fby2">ac_fby2</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#eqst_ntheq">eqst_ntheq</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hfby</span>. <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.ac_nth">ac_nth</a></span> <span class="kwd">in</span> <span class="id">Hfby</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">stres1</span> # <span class="id">n</span>) <span class="id">eqn</span>:<span class="id">Hstres1</span>, (<span class="id">stres</span> # <span class="id">n</span>) <span class="id">eqn</span>:<span class="id">Hstres</span>; <span class="id">auto</span>; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">v0</span>, <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">n0</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">states</span>))) <span class="kwd">as</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hperm</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span>. <span class="id">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_In</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hwt1</span> ((<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.count">count</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhenb">fwhenb</a></span> <span class="id">n0</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_res">stres_res</a></span> <span class="id">stres</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_st">stres_st</a></span> <span class="id">stres</span>))) # <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">Hwt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect">fselect</a></span> <span class="kwd">in</span> <span class="id">Hwt1</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.mask_nth">mask_nth</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb_refl">Nat.eqb_refl</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhen_nth">fwhen_nth</a></span> <span class="kwd">in</span> <span class="id">Hwt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_ind">eq_ind</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e0</span>, <span class="id">_</span>) =&gt; <span class="id">_</span> <span class="kwd">end</span>) <span class="kwd">in</span> <span class="id">Hwt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_st">stres_st</a></span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">setoid_rewrite</span> <span class="id">Hstres</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.Common.html#equiv_decb_refl">equiv_decb_refl</a></span>. <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hstres1</span> <span class="kwd">in</span> <span class="id">Hwt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CACORRECTNESS.auto_block_sem">auto_block_sem</a></span> : <span class="kwd">forall</span> <span class="id">blk</span> Γ<span class="id">ty</span> Γ<span class="id">ck</span> <span class="id">Hi</span> <span class="id">bs</span> <span class="id">blk</span>' <span class="id">tys</span> <span class="id">st</span> <span class="id">st</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar">IsVar</a></span> Γ<span class="id">ty</span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids.AtomOrGensym">AtomOrGensym</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids.elab_prefs">elab_prefs</a></span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar">IsVar</a></span> Γ<span class="id">ck</span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar">IsVar</a></span> Γ<span class="id">ty</span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsLast">IsLast</a></span> Γ<span class="id">ck</span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsLast">IsLast</a></span> Γ<span class="id">ty</span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.NoDupLocals">NoDupLocals</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ<span class="id">ty</span>) <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.GoodLocals">GoodLocals</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids.elab_prefs">elab_prefs</a></span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ty.wt_block">wt_block</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span> Γ<span class="id">ty</span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cl.wc_block">wc_block</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span> Γ<span class="id">ck</span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.dom_ub">dom_ub</a></span> <span class="id">Hi</span> Γ<span class="id">ty</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars">sc_vars</a></span> Γ<span class="id">ck</span> <span class="id">Hi</span> <span class="id">bs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_block_ck">sem_block_ck</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span> <span class="id">Hi</span> <span class="id">bs</span> <span class="id">blk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.auto_block">auto_block</a></span> <span class="id">blk</span> <span class="id">st</span> = (<span class="id">blk</span>', <span class="id">tys</span>, <span class="id">st</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_block_ck">sem_block_ck</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G2">G2</a></span> <span class="id">Hi</span> <span class="id">bs</span> <span class="id">blk</span>'.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">blk</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.block_ind2">block_ind2</a></span>; <span class="id">intros</span> * <span class="id">Hat</span> <span class="id">Hincl</span> <span class="id">Hincll</span> <span class="id">Hnd</span> <span class="id">Hgood</span> <span class="id">Hwt</span> <span class="id">Hwc</span> <span class="id">Hdom</span> <span class="id">Hsc</span> <span class="id">Hsem</span> <span class="id">Haut</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hnd</span>; <span class="id">inv</span> <span class="id">Hgood</span>; <span class="id">inv</span> <span class="id">Hwt</span>; <span class="id">inv</span> <span class="id">Hwc</span>; <span class="id">inv</span> <span class="id">Hsem</span>; <span class="id">repeat</span> <span class="id">inv_bind</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;equation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_ref_sem_equation">sem_ref_sem_equation</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;last&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_ref_sem_exp">sem_ref_sem_exp</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;reset&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_ref_sem_exp">sem_ref_sem_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">k</span>. <span class="id">specialize</span> (<span class="id">H15</span> <span class="id">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto_block_simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_mask">sc_vars_mask</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.dom_ub_map">dom_ub_map</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;switch&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_ref_sem_exp">sem_ref_sem_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto_block_simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_branch</span>. <span class="id">repeat</span> <span class="id">inv_bind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_clock">sem_clock</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.var_history">var_history</a></span> <span class="id">Hi</span>) <span class="id">bs</span> <span class="id">ck</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.abstract_clock">abstract_clock</a></span> <span class="id">sc</span>)) <span class="kwd">as</span> <span class="id">Hsemck</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_exp">sc_exp</a></span> <span class="kwd">in</span> <span class="id">H14</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.clockof">clockof</a></span> <span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">rewrite</span> <span class="id">it</span> <span class="kwd">in</span> <span class="id">H14</span>; <span class="id">simpl_Forall</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto_block_simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H</span> <span class="kwd">with</span> (Γ<span class="id">ck</span>:=Γ'); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> ? <span class="id">Hin</span>. <span class="id">inv</span> <span class="id">Hin</span>. <span class="id">simpl_In</span>. <span class="id">edestruct</span> <span class="id">H13</span> <span class="kwd">as</span> (<span class="id">Hck</span>&amp;<span class="id">_</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.dom_ub_refines">dom_ub_refines</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_when">sc_vars_when</a></span>; <span class="id">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;automaton&nbsp;(weak)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">id</span> =&gt; ~<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar">IsVar</a></span> Γ<span class="id">ty</span> <span class="id">id</span>) [<span class="id">x1</span>;<span class="id">x3</span>;<span class="id">x5</span>;<span class="id">x7</span>]) <span class="kwd">as</span> <span class="id">Hnin1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">simpl_Forall</span>; <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">intros</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Hat</span> <span class="kwd">in</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> (<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.fresh_ident">CA.fresh_ident</a></span> <span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.Fresh.fresh_ident_prefixed">fresh_ident_prefixed</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="id">subst</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [|[|[|[|]]]]; <span class="id">subst</span>; <span class="id">try</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.Fresh.Facts.contradict_AtomOrGensym">contradict_AtomOrGensym</a></span> <span class="kwd">in</span> <span class="id">Hv</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.auto_not_in_elab_prefs">auto_not_in_elab_prefs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">id</span> =&gt; ~ <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.In">FEnv.In</a></span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">id</span>) <span class="id">Hi</span>) [<span class="id">x1</span>;<span class="id">x3</span>;<span class="id">x5</span>;<span class="id">x7</span>]) <span class="kwd">as</span> <span class="id">Hnin2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">simpl_Forall</span>; <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">intros</span> <span class="id">Henvin</span>. <span class="id">eapply</span> <span class="id">Hdom</span> <span class="kwd">in</span> <span class="id">Henvin</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [|[|[|[|]]]]; <span class="id">subst</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> [<span class="id">x1</span>;<span class="id">x3</span>;<span class="id">x5</span>;<span class="id">x7</span>]) <span class="kwd">as</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.fresh_idents_NoDup">fresh_idents_NoDup</a></span>; <span class="id">eauto</span> 7 <span class="kwd">with</span> <span class="id">fresh</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> [<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x1</span>;<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x3</span>;<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x5</span>;<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x7</span>]) <span class="kwd">as</span> <span class="id">Hndv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.FinFun.html#Injective_map_NoDup">FinFun.Injective_map_NoDup</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span>) <span class="kwd">in</span> <span class="id">Hnd</span>; <span class="id">auto</span>. <span class="id">intros</span> ?? <span class="id">Eq</span>; <span class="id">now</span> <span class="id">inv</span> <span class="id">Eq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list">FEnv.of_list</a></span> [(<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x1</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">stres</span>); (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x3</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">stres1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x5</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">stres</span>); (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x7</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">stres1</span>)]) <span class="kwd">as</span> <span class="id">Hi</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) <span class="id">Hi</span> (<span class="id">Hi</span> + <span class="id">Hi</span>')) <span class="kwd">as</span> <span class="id">Href</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span>. <span class="id">intros</span> ?? <span class="id">Hfind</span>. <span class="id">do</span> 2 <span class="id">esplit</span>; [<span class="id">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union2">FEnv.union2</a></span>; <span class="id">auto</span>. <span class="id">destruct</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list">FEnv.of_list</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">contra</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list_find_In">FEnv.of_list_find_In</a></span> <span class="kwd">in</span> <span class="id">contra</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.In">FEnv.In</a></span> <span class="id">x11</span> <span class="id">Hi</span>) <span class="kwd">as</span> <span class="id">Hin</span> <span class="kwd">by</span> (<span class="id">econstructor</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">contra</span> <span class="kwd">as</span> [<span class="id">Heq</span>|[<span class="id">Heq</span>|[<span class="id">Heq</span>|[<span class="id">Heq</span>|[]]]]]; <span class="id">inv</span> <span class="id">Heq</span>; <span class="id">congruence</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.abstract_clock">abstract_clock</a></span> <span class="id">stres</span> ≡ <span class="id">bs</span>') <span class="kwd">as</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_ck">sem_transitions_ck</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_transitions">sc_transitions</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">eauto</span>. 3:<span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.ac_fby1">ac_fby1</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">now</span> <span class="id">rewrite</span> &lt;-<span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_subclock">sc_vars_subclock</a></span>; <span class="id">eauto</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar">IsVar</a></span> Γ' <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar">IsVar</a></span> Γ<span class="id">ck</span> <span class="id">x</span>) <span class="kwd">as</span> <span class="id">Hincl2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">take</span> (<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.HasClock">HasClock</a></span> Γ' <span class="id">_</span> <span class="id">_</span> -&gt; <span class="id">_</span>) <span class="id">and</span> <span class="id">clear</span> - <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ? <span class="id">Hv</span>. <span class="id">inv</span> <span class="id">Hv</span>. <span class="id">simpl_In</span>. <span class="id">edestruct</span> <span class="id">it</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.  }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ') (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ<span class="id">ck</span>)) <span class="kwd">as</span> <span class="id">Hinclfst</span> <span class="kwd">by</span> (<span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_incl_fst">IsVar_incl_fst</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.Sscope">Sscope</a></span> <span class="kwd">with</span> (<span class="id">Hi</span>':=<span class="id">Hi</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">subst</span>. <span class="id">split</span>; <span class="id">intros</span> *; <span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list_In">FEnv.of_list_In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_senv_of_decls">IsVar_senv_of_decls</a></span>, 2 <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intros</span> [<span class="id">Eq</span>|[<span class="id">Eq</span>|[<span class="id">Eq</span>|[<span class="id">Eq</span>|<span class="id">Eq</span>]]]]; <span class="id">inv</span> <span class="id">Eq</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">split</span>; [<span class="id">intros</span> <span class="id">Hin</span>|<span class="id">intros</span> <span class="id">Hlast</span>; <span class="id">inv</span> <span class="id">Hlast</span>]; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Eq</span>|[<span class="id">Eq</span>|[<span class="id">Eq</span>|[<span class="id">Eq</span>|<span class="id">Eq</span>]]]]; <span class="id">inv</span> <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H21</span> <span class="kwd">as</span> [<span class="id">Eq</span>|[<span class="id">Eq</span>|[<span class="id">Eq</span>|[<span class="id">Eq</span>|<span class="id">Eq</span>]]]]; <span class="id">inv</span> <span class="id">Eq</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">split</span>; <span class="id">intros</span> * <span class="id">Hcka</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">intros</span> <span class="id">Hla</span>. <span class="id">inv</span> <span class="id">Hla</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|<span class="id">He</span>]]]]; <span class="id">inv</span> <span class="id">He</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">intros</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sem_var_union</span>' <span class="kwd">in</span> <span class="id">Hv</span> <span class="kwd">as</span> [(<span class="id">Hnin</span>&amp;<span class="id">_</span>)|<span class="id">Hv</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="id">exfalso</span>. <span class="id">apply</span> <span class="id">Hnin</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list_In">FEnv.of_list_In</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hcka</span>; <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">take</span> (<span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|<span class="id">He</span>]]]]; <span class="id">inv</span> <span class="id">He</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">ck0</span> = <span class="id">ck</span>); [|<span class="id">subst</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">Hcka</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|<span class="id">He</span>]]]]; <span class="id">inv</span> <span class="id">He</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>. <span class="id">apply</span> <span class="id">sem_var_of_list</span>' <span class="kwd">in</span> <span class="id">Hv</span> <span class="kwd">as</span> (?&amp;<span class="id">Heq</span>&amp;<span class="id">Hin</span>). <span class="id">rewrite</span> <span class="id">Heq</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|<span class="id">He</span>]]]]; <span class="id">inv</span> <span class="id">He</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1-4:(<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.sem_clock_refines">sem_clock_refines</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.var_history_refines">var_history_refines</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.ac_stres_proj1">ac_stres_proj1</a></span>; <span class="id">try</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.ac_stres_proj2">ac_stres_proj2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">rewrite</span> <span class="id">Hac</span>; <span class="id">auto</span>; <span class="id">simpl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.ac_fby2">ac_fby2</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">rewrite</span> <span class="id">it</span>, <span class="id">Hac</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*{ <span class="id">econstructor</span>. <span class="id">repeat</span> <span class="id">constructor</span>. 2:<span class="id">simpl</span>; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>; <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3,4,6,7:<span class="id">sem_new_vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_exp_refines">sem_exp_refines</a></span>; [<span class="id">eauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.init_state_exp_sem">init_state_exp_sem</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_subclock">sc_vars_subclock</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.add_whens_enum_sem">add_whens_enum_sem</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.sem_clock_refines">sem_clock_refines</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.var_history_refines">var_history_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.fby_stres_proj1">fby_stres_proj1</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_ck">sem_transitions_ck</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_transitions_init_noreset">sem_transitions_init_noreset</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_subclock">sc_vars_subclock</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;-<span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.fby_stres_proj2">fby_stres_proj2</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*{ <span class="id">econstructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">constructor</span>. <span class="id">sem_new_vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_ck">sem_transitions_ck</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_automaton_wt_state1">sem_automaton_wt_state1</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span>; <span class="id">intros</span> <span class="id">n</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">destruct</span> (<span class="id">stres</span> # <span class="id">n</span>) <span class="kwd">as</span> [|(?&amp;?)] <span class="id">eqn</span>:<span class="id">Hst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_ind">eq_ind</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id">e</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">states</span> <span class="kwd">end</span>) <span class="kwd">in</span> <span class="id">it</span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>. <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> &lt;-<span class="id">H10</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>. <span class="id">repeat</span> <span class="id">inv_branch</span>. <span class="id">repeat</span> <span class="id">inv_scope</span>. <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>. <span class="id">repeat</span> <span class="id">inv_branch</span>. <span class="id">repeat</span> <span class="id">inv_scope</span>. <span class="id">intros</span>. <span class="id">specialize</span> (<span class="id">H25</span> <span class="id">k</span>); <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_branch</span>. <span class="id">repeat</span> <span class="id">inv_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplit</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">auto_block_simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="id">simpl</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.when_hist_restrict_ac">when_hist_restrict_ac</a></span> <span class="kwd">with</span> (<span class="id">xs</span>:=<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x1</span>::<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x3</span>::<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x5</span>::<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x7</span>::<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv">vars_of_senv</a></span> Γ').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_st">stres_st</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span>. <span class="id">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">cases_eqn</span> <span class="id">Heq</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hin</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_var_union">sem_var_union</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">repeat</span> <span class="id">rewrite</span> &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#or_assoc">or_assoc</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>], <span class="id">Hsem</span> <span class="kwd">as</span> [<span class="id">Hsem</span>|<span class="id">Hsem</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.sem_var_In">sem_var_In</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [[[|]|]|]; <span class="id">subst</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">sem_var_of_list</span>' <span class="kwd">in</span> <span class="id">Hsem</span> <span class="kwd">as</span> (?&amp;<span class="id">Heq1</span>&amp;[<span class="id">Heq</span>|[<span class="id">Heq</span>|[<span class="id">Heq</span>|[<span class="id">Heq</span>|<span class="id">Heq</span>]]]]); <span class="id">inv</span> <span class="id">Heq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Heq1</span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.ac_stres_proj1">ac_stres_proj1</a></span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.ac_stres_proj2">ac_stres_proj2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.ac_fby2">ac_fby2</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.ac_fby2">ac_fby2</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.ac_stres_proj1">ac_stres_proj1</a></span>, <span class="id">Hac</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_clock_det">sem_clock_det</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x11</span>; [<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Var">vars_of_senv_Var</a></span> <span class="kwd">in</span> <span class="id">Hin</span>|<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Last">vars_of_senv_Last</a></span> <span class="kwd">in</span> <span class="id">Hin</span>]; <span class="id">inv</span> <span class="id">Hin</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">edestruct</span> <span class="id">H17</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">eapply</span> <span class="id">Hsc</span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar">IsVar</a></span> Γ<span class="id">ty</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#var_last_ident">var_last_ident</a></span> <span class="id">x11</span>)) <span class="kwd">as</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id">Hincl</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_fst">IsVar_fst</a></span>, <span class="id">Hinclfst</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_fst">IsVar_fst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x11</span>; [<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Var">vars_of_senv_Var</a></span> <span class="kwd">in</span> <span class="id">Hin</span>|<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Last">vars_of_senv_Last</a></span> <span class="kwd">in</span> <span class="id">Hin</span>]; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sem_var_of_list</span>' <span class="kwd">in</span> <span class="id">Hsem</span> <span class="kwd">as</span> (?&amp;<span class="id">_</span>&amp;[<span class="id">Heq</span>|[<span class="id">Heq</span>|[<span class="id">Heq</span>|[<span class="id">Heq</span>|<span class="id">Heq</span>]]]]); <span class="id">inv</span> <span class="id">Heq</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_branch</span>. <span class="id">repeat</span> <span class="id">inv_bind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econstructor</span>; <span class="id">simpl</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.sem_var_restrict">sem_var_restrict</a></span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_var_fwhen">sem_var_fwhen</a></span>. <span class="id">sem_new_vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.bools_of_fwhen">bools_of_fwhen</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.bools_of_stres_proj2">bools_of_stres_proj2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">k</span>. <span class="id">specialize</span> (<span class="id">H25</span> <span class="id">k</span>); <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.select_hist">select_hist</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">rename</span> <span class="id">it</span> <span class="id">into</span> <span class="id">Hsel</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hsel</span>':=<span class="id">Hsel</span>). <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.select_hist_fselect_hist">select_hist_fselect_hist</a></span> <span class="kwd">in</span> <span class="id">Hsel</span>'. <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_branch</span>. <span class="id">destruct</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_scope_ck">sem_scope_ck</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_scope_refines2">sem_scope_refines2</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_scope_restrict2">sem_scope_restrict2</a></span> <span class="kwd">in</span> <span class="id">it</span>. 3,4:<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="id">intros</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">H17</span> <span class="kwd">as</span> (?&amp;<span class="id">Hbase</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>. <span class="id">rewrite</span> <span class="id">Hbase</span>; <span class="id">constructor</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_scope</span>. <span class="id">repeat</span> <span class="id">inv_bind</span>. <span class="id">subst</span> Γ'0 Γ'1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;assert&nbsp;(forall&nbsp;x,&nbsp;~&nbsp;IsLast&nbsp;(senv_of_decls&nbsp;l)&nbsp;x)&nbsp;as&nbsp;Hnolast2.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;{&nbsp;intros&nbsp;*&nbsp;Hlast.&nbsp;inv&nbsp;Hlast.&nbsp;simpl_In.&nbsp;simpl_Forall.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;subst;&nbsp;simpl&nbsp;in&nbsp;*;&nbsp;congruence.&nbsp;}&nbsp;*)</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;assert&nbsp;(forall&nbsp;x,&nbsp;~&nbsp;IsLast&nbsp;Γ'&nbsp;x)&nbsp;as&nbsp;Hnl2'&nbsp;by&nbsp;(intros&nbsp;??;&nbsp;eapply&nbsp;Hnl2;&nbsp;eauto).&nbsp;*)</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> ((<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.mask_hist">CStr.mask_hist</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhenb">fwhenb</a></span> <span class="id">e</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_res">stres_res</a></span> <span class="id">stres</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">stres</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict">FEnv.restrict</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhen_hist">fwhen_hist</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hi</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list">FEnv.of_list</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x1</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">stres</span>); (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x3</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">stres1</span>); (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x5</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">stres</span>); (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x7</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">stres1</span>)])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">stres</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x1</span> :: <span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x3</span> :: <span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x5</span> :: <span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x7</span> :: <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv">vars_of_senv</a></span> Γ')) + <span class="id">Hi</span>')) <span class="kwd">as</span> <span class="id">Hi</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.maskb">maskb</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">as</span> <span class="id">bs</span>''.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.restrict">restrict</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect_hist">fselect_hist</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">Hi</span>) Γ' + <span class="id">Hi</span>') <span class="id">Hi</span>'') <span class="kwd">as</span> <span class="id">Href1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span> ?? <span class="id">Hf</span>. <span class="id">subst</span>. <span class="id">apply</span> <span class="id">FEnv.union4</span>' <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> [<span class="id">Hf</span>|(<span class="id">Hf</span>&amp;<span class="id">Hnf</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id">FEnv.union3</span>'. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_find_inv">FEnv.restrict_find_inv</a></span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> (<span class="id">Hin</span>&amp;<span class="id">Hf</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; [<span class="id">reflexivity</span>|]; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union2">FEnv.union2</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_find">FEnv.restrict_find</a></span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union2">FEnv.union2</a></span>; <span class="id">eauto</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list_None">FEnv.of_list_None</a></span>. <span class="id">intros</span> <span class="id">Him</span>. <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|<span class="id">He</span>]]]]; <span class="id">inv</span> <span class="id">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">take</span> (<span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.find_In">FEnv.find_In</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars">sc_vars</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">l</span>) <span class="id">Hi</span>'' <span class="id">bs</span>'') <span class="kwd">as</span> <span class="id">Hsc1</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span>. <span class="id">intros</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_refines">sc_vars_refines</a></span>; <span class="id">simpl</span>. 1,4:<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hinm</span> <span class="id">_</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.dom">dom</a></span> <span class="id">Hi</span>' <span class="id">_</span>) <span class="id">and</span> <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_In">FEnv.union_In</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#or_intror">or_intror</a></span>, <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hinm</span> <span class="id">_</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.dom">dom</a></span> <span class="id">Hi</span>' <span class="id">_</span>) <span class="id">and</span> <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_In">FEnv.union_In</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#or_intror">or_intror</a></span>, <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars">sc_vars</a></span> (Γ' ++ <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">l</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.restrict">restrict</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect_hist">fselect_hist</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">stres</span> <span class="id">Hi</span>) Γ' + <span class="id">Hi</span>') <span class="id">bs</span>'') <span class="kwd">as</span> <span class="id">Hsc2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.local_hist_sc_vars">local_hist_sc_vars</a></span> <span class="kwd">with</span> (Γ:=Γ'); <span class="id">subst</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_refl">List.incl_refl</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.restrict_dom_ub">restrict_dom_ub</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hinm</span> <span class="id">Hin</span>. <span class="id">take</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">_</span> -&gt; ~<span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id">it</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_incl_fst">IsVar_incl_fst</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_fst">IsVar_fst</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_restrict">sc_vars_restrict</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_refines">sc_vars_refines</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sc_vars_fselect">sc_vars_fselect</a></span>; <span class="id">eauto</span>; <span class="id">try</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>. <span class="id">simpl_In</span>. <span class="id">take</span> (<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.HasClock">HasClock</a></span> Γ' <span class="id">_</span> <span class="id">_</span> -&gt; <span class="id">_</span>) <span class="id">and</span> <span class="id">edestruct</span> <span class="id">it</span> <span class="kwd">as</span> (?&amp;<span class="id">Hck</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hck</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> [<span class="id">x1</span>; <span class="id">x3</span>; <span class="id">x5</span>; <span class="id">x7</span>] -&gt; ~<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">l</span>) <span class="kwd">as</span> <span class="id">Hdisj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span> * <span class="id">Hin1</span> <span class="id">Hin2</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_In">InMembers_In</a></span> <span class="kwd">in</span> <span class="id">Hin2</span>; <span class="id">destruct_conjs</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> (<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.fresh_ident">CA.fresh_ident</a></span> <span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.Fresh.fresh_ident_prefixed">fresh_ident_prefixed</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="id">subst</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin1</span> <span class="kwd">as</span> [|[|[|[|]]]]; <span class="id">eauto</span>; <span class="id">subst</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.Fresh.Facts.contradict_AtomOrGensym">contradict_AtomOrGensym</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.auto_not_in_elab_prefs">auto_not_in_elab_prefs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars">sc_vars</a></span> (Γ' ++ <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">l</span>) <span class="id">Hi</span>'' <span class="id">bs</span>'') <span class="kwd">as</span> <span class="id">Hsc2</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span>. <span class="id">intros</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_refines">sc_vars_refines</a></span>; <span class="id">simpl</span>. 1,4:<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hinm</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (~<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x12</span> [<span class="id">x1</span>;<span class="id">x3</span>;<span class="id">x5</span>;<span class="id">x7</span>]) <span class="kwd">as</span> <span class="id">Hnin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span> <span class="id">contra</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_app">IsVar_app</a></span> <span class="kwd">in</span> <span class="id">Hinm</span> <span class="kwd">as</span> [<span class="id">Hinm</span>|<span class="id">Hinm</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">contra</span> <span class="kwd">as</span> [|[|[|[|]]]]; <span class="id">subst</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">Hdisj</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_senv_of_decls">IsVar_senv_of_decls</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.restrict">restrict</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_In">FEnv.union_In</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_In">FEnv.restrict_In</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Var">vars_of_senv_Var</a></span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map_in_iff">FEnv.map_in_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_In">FEnv.union_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|]; <span class="id">auto</span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map_in_iff">FEnv.map_in_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_In">FEnv.restrict_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map_in_iff">FEnv.map_in_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_In">FEnv.union_In</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list_In">FEnv.of_list_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> ([|<span class="id">Hin2</span>]&amp;<span class="id">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">In</span>|[<span class="id">In</span>|[<span class="id">In</span>|[<span class="id">In</span>|<span class="id">In</span>]]]]; <span class="id">try</span> <span class="id">inv</span> <span class="id">In</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1-4:<span class="id">exfalso</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">split</span>; <span class="id">auto</span>. <span class="id">clear</span> - <span class="id">In</span>. <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Var">vars_of_senv_Var</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> <span class="id">Hin2</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hin2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin2</span> <span class="kwd">as</span> [<span class="id">In</span>|[<span class="id">In</span>|[<span class="id">In</span>|[<span class="id">In</span>|<span class="id">In</span>]]]]; <span class="id">try</span> <span class="id">inv</span> <span class="id">In</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hinm</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.restrict">restrict</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_In">FEnv.union_In</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_In">FEnv.restrict_In</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Last">vars_of_senv_Last</a></span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map_in_iff">FEnv.map_in_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_In">FEnv.union_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|]; <span class="id">auto</span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map_in_iff">FEnv.map_in_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_In">FEnv.restrict_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map_in_iff">FEnv.map_in_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_In">FEnv.union_In</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list_In">FEnv.of_list_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> ([|<span class="id">Hin2</span>]&amp;<span class="id">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">In</span>|[<span class="id">In</span>|[<span class="id">In</span>|[<span class="id">In</span>|<span class="id">In</span>]]]]; <span class="id">try</span> <span class="id">inv</span> <span class="id">In</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">split</span>; <span class="id">auto</span>. <span class="id">clear</span> - <span class="id">In</span>. <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Last">vars_of_senv_Last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> <span class="id">Hin2</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hin2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin2</span> <span class="kwd">as</span> [<span class="id">In</span>|[<span class="id">In</span>|[<span class="id">In</span>|[<span class="id">In</span>|<span class="id">In</span>]]]]; <span class="id">try</span> <span class="id">inv</span> <span class="id">In</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.Sscope">Sscope</a></span> <span class="kwd">with</span> (<span class="id">Hi</span>':=<span class="id">Hi</span>'). 3:<span class="id">constructor</span>. <span class="id">all</span>:<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">subst</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*{ <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_ck">sem_transitions_ck</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_refines">sem_transitions_refines</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_restrict">sem_transitions_restrict</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (Γ:=((<span class="id">x1</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.default_ann">default_ann</a></span>)::(<span class="id">x3</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.default_ann">default_ann</a></span>)::(<span class="id">x5</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.default_ann">default_ann</a></span>)::(<span class="id">x7</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.default_ann">default_ann</a></span>)::Γ' ++ <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">l</span>)) <span class="kwd">in</span> <span class="id">it</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">simpl_Forall</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.wx_exp_incl">wx_exp_incl</a></span>. 3:<span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">intros</span> * <span class="id">Hv</span>; <span class="id">inv</span> <span class="id">Hv</span>; <span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_cons">InMembers_cons</a></span> <span class="kwd">with</span> <span class="id">datatypes</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.trans_exp_sem">trans_exp_sem</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (<span class="id">ss</span>&amp;<span class="id">Htranssem</span>&amp;<span class="id">Hconcat</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">constructor</span>. <span class="id">econstructor</span>. 2:<span class="id">rewrite</span> <span class="id">Hconcat</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="id">eauto</span>]; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_exp_refines">sem_exp_refines</a></span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_refines">FEnv.restrict_refines</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonStreams.html#EqStrel_Reflexive">EqStrel_Reflexive</a></span>, <span class="id"><a href="Velus.Common.CommonStreams.html#EqStrel_Transitive">EqStrel_Transitive</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> [<span class="id">x1</span>;<span class="id">x3</span>;<span class="id">x5</span>;<span class="id">x7</span>] -&gt; ~<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.In">FEnv.In</a></span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x</span>) <span class="id">Hi</span>') <span class="kwd">as</span> <span class="id">Hdisj</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span> * <span class="id">Hin</span> <span class="id">Hinenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Hdisj</span>; <span class="id">eauto</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.dom">dom</a></span> <span class="id">Hi</span>' <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_senv_of_decls">IsVar_senv_of_decls</a></span>, <span class="id">it</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">subst</span>; [<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1_fselect">stres_proj1_fselect</a></span>|<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2_fselect">stres_proj2_fselect</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:(<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_var_union2">sem_var_union2</a></span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_var_mask">sem_var_mask</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.sem_var_restrict">sem_var_restrict</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_var_fwhen">sem_var_fwhen</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>; <span class="id">sem_new_vars</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_restrict">sc_vars_restrict</a></span>; <span class="id">eauto</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">intros</span> ??; <span class="id">simpl</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">simpl_app</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall_app">Forall_app</a></span>; <span class="id">split</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">edestruct</span> <span class="id">H17</span> <span class="kwd">as</span> (?&amp;<span class="id">Hbase</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>. <span class="id">rewrite</span> <span class="id">Hbase</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks.wc_clock_incl">wc_clock_incl</a></span>; [|<span class="id">eauto</span>]. <span class="id">repeat</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_tl">incl_tl</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">subst</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*{ <span class="id">auto_block_simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_block_refines">sem_block_refines</a></span>, <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (Γ<span class="id">ck</span>:=Γ'++<span class="id">_</span>) (Γ<span class="id">ty</span>:=Γ<span class="id">ty</span>++<span class="id">_</span>) (<span class="id">Hi</span>:=(<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict">FEnv.restrict</a></span> <span class="id">_</span> <span class="id">_</span>)); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8:{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_block_restrict">sem_block_restrict</a></span>. 3:<span class="id">eauto</span>. <span class="id">all</span>:<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks.wc_env">wc_env</a></span>. <span class="id">simpl_Forall</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="id">simpl_In</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">H17</span> <span class="kwd">as</span> (<span class="id">_</span>&amp;<span class="id">Hbase</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>. <span class="id">rewrite</span> <span class="id">Hbase</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <span class="id">all</span>:<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">etransitivity</span>; <span class="id">eauto</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_refines">FEnv.restrict_refines</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonStreams.html#EqStrel_Reflexive">EqStrel_Reflexive</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hv</span>. <span class="id">inv</span> <span class="id">Hv</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_app">InMembers_app</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_In">InMembers_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">Hat</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_In</span>. <span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hv</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_app">IsVar_app</a></span> <span class="kwd">in</span> *. <span class="id">destruct</span> <span class="id">Hv</span> <span class="kwd">as</span> [<span class="id">Hv</span>|]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> *; <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsLast_app">IsLast_app</a></span>; <span class="id">intros</span> [|]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">dom_ub_incl</span>', <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.restrict_dom_ub">restrict_dom_ub</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> *; <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_app">IsVar_app</a></span>; <span class="id">intros</span> [|]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> *; <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsLast_app">IsLast_app</a></span>; <span class="id">intros</span> [|]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_restrict">sc_vars_restrict</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="id">simpl_In</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">H17</span> <span class="kwd">as</span> (<span class="id">_</span>&amp;<span class="id">Hbase</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>. <span class="id">rewrite</span> <span class="id">Hbase</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;automaton&nbsp;(strong)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">id</span> =&gt; ~<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar">IsVar</a></span> Γ<span class="id">ty</span> <span class="id">id</span>) [<span class="id">x1</span>;<span class="id">x3</span>;<span class="id">x5</span>;<span class="id">x7</span>]) <span class="kwd">as</span> <span class="id">Hnin1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">simpl_Forall</span>; <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">intros</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Hat</span> <span class="kwd">in</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> (<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.fresh_ident">CA.fresh_ident</a></span> <span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.Fresh.fresh_ident_prefixed">fresh_ident_prefixed</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="id">subst</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [|[|[|[|]]]]; <span class="id">subst</span>; <span class="id">try</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.Fresh.Facts.contradict_AtomOrGensym">contradict_AtomOrGensym</a></span> <span class="kwd">in</span> <span class="id">Hv</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.auto_not_in_elab_prefs">auto_not_in_elab_prefs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">id</span> =&gt; ~ <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.In">FEnv.In</a></span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">id</span>) <span class="id">Hi</span>) [<span class="id">x1</span>;<span class="id">x3</span>;<span class="id">x5</span>;<span class="id">x7</span>]) <span class="kwd">as</span> <span class="id">Hnin2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">simpl_Forall</span>; <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">intros</span> <span class="id">Henvin</span>. <span class="id">eapply</span> <span class="id">Hdom</span> <span class="kwd">in</span> <span class="id">Henvin</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [|[|[|[|]]]]; <span class="id">subst</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> [<span class="id">x1</span>;<span class="id">x3</span>;<span class="id">x5</span>;<span class="id">x7</span>]) <span class="kwd">as</span> <span class="id">Hnd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.fresh_idents_NoDup">fresh_idents_NoDup</a></span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> [<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x1</span>;<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x3</span>;<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x5</span>;<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x7</span>]) <span class="kwd">as</span> <span class="id">Hndv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.FinFun.html#Injective_map_NoDup">FinFun.Injective_map_NoDup</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span>) <span class="kwd">in</span> <span class="id">Hnd</span>; <span class="id">auto</span>. <span class="id">intros</span> ?? <span class="id">Eq</span>; <span class="id">now</span> <span class="id">inv</span> <span class="id">Eq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list">FEnv.of_list</a></span> [(<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x1</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">stres</span>); (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x3</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">stres1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x5</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">stres</span>); (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x7</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">stres1</span>)]) <span class="kwd">as</span> <span class="id">Hi</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) <span class="id">Hi</span> (<span class="id">Hi</span> + <span class="id">Hi</span>')) <span class="kwd">as</span> <span class="id">Href</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span>. <span class="id">intros</span> ?? <span class="id">Hfind</span>. <span class="id">do</span> 2 <span class="id">esplit</span>; [<span class="id">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union2">FEnv.union2</a></span>; <span class="id">auto</span>. <span class="id">destruct</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list">FEnv.of_list</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">contra</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list_find_In">FEnv.of_list_find_In</a></span> <span class="kwd">in</span> <span class="id">contra</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.In">FEnv.In</a></span> <span class="id">x11</span> <span class="id">Hi</span>) <span class="kwd">as</span> <span class="id">Hin</span> <span class="kwd">by</span> (<span class="id">econstructor</span>; <span class="id">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">contra</span> <span class="kwd">as</span> [<span class="id">Heq</span>|[<span class="id">Heq</span>|[<span class="id">Heq</span>|[<span class="id">Heq</span>|[]]]]]; <span class="id">inv</span> <span class="id">Heq</span>; <span class="id">congruence</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.abstract_clock">abstract_clock</a></span> <span class="id">stres</span> ≡ <span class="id">bs</span>') <span class="kwd">as</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.ac_fby1">ac_fby1</a></span> <span class="kwd">in</span> <span class="id">it</span>. <span class="id">rewrite</span> &lt;-<span class="id">it</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.const_stres_ac">const_stres_ac</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.abstract_clock">abstract_clock</a></span> <span class="id">stres1</span> ≡ <span class="id">bs</span>') <span class="kwd">as</span> <span class="id">Hac1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.ac_fby2">ac_fby2</a></span> <span class="kwd">in</span> <span class="id">it</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id">it</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar">IsVar</a></span> Γ' <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar">IsVar</a></span> Γ<span class="id">ck</span> <span class="id">x</span>) <span class="kwd">as</span> <span class="id">Hincl2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">take</span> (<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.HasClock">HasClock</a></span> Γ' <span class="id">_</span> <span class="id">_</span> -&gt; <span class="id">_</span>) <span class="id">and</span> <span class="id">clear</span> - <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ? <span class="id">Hv</span>. <span class="id">inv</span> <span class="id">Hv</span>. <span class="id">simpl_In</span>. <span class="id">edestruct</span> <span class="id">it</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.  }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ') (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> Γ<span class="id">ck</span>)) <span class="kwd">as</span> <span class="id">Hinclfst</span> <span class="kwd">by</span> (<span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_incl_fst">IsVar_incl_fst</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.Sscope">Sscope</a></span> <span class="kwd">with</span> (<span class="id">Hi</span>':=<span class="id">Hi</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">subst</span>. <span class="id">split</span>; <span class="id">intros</span> *; <span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list_In">FEnv.of_list_In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_senv_of_decls">IsVar_senv_of_decls</a></span>, 2 <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intros</span> [<span class="id">Eq</span>|[<span class="id">Eq</span>|[<span class="id">Eq</span>|[<span class="id">Eq</span>|<span class="id">Eq</span>]]]]; <span class="id">inv</span> <span class="id">Eq</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">split</span>; [<span class="id">intros</span> <span class="id">Hin</span>|<span class="id">intros</span> <span class="id">Hlast</span>; <span class="id">inv</span> <span class="id">Hlast</span>]; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Eq</span>|[<span class="id">Eq</span>|[<span class="id">Eq</span>|[<span class="id">Eq</span>|<span class="id">Eq</span>]]]]; <span class="id">inv</span> <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H24</span> <span class="kwd">as</span> [<span class="id">Eq</span>|[<span class="id">Eq</span>|[<span class="id">Eq</span>|[<span class="id">Eq</span>|<span class="id">Eq</span>]]]]; <span class="id">inv</span> <span class="id">Eq</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">split</span>; <span class="id">intros</span> * <span class="id">Hcka</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">intros</span> <span class="id">Hla</span>. <span class="id">inv</span> <span class="id">Hla</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|<span class="id">He</span>]]]]; <span class="id">inv</span> <span class="id">He</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">intros</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sem_var_union</span>' <span class="kwd">in</span> <span class="id">Hv</span> <span class="kwd">as</span> [(<span class="id">Hnin</span>&amp;<span class="id">_</span>)|<span class="id">Hv</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="id">exfalso</span>. <span class="id">apply</span> <span class="id">Hnin</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list_In">FEnv.of_list_In</a></span>, <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hcka</span>; <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">take</span> (<span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|<span class="id">He</span>]]]]; <span class="id">inv</span> <span class="id">He</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">ck0</span> = <span class="id">ck</span>); [|<span class="id">subst</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">Hcka</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|<span class="id">He</span>]]]]; <span class="id">inv</span> <span class="id">He</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>. <span class="id">apply</span> <span class="id">sem_var_of_list</span>' <span class="kwd">in</span> <span class="id">Hv</span> <span class="kwd">as</span> (?&amp;<span class="id">Heq</span>&amp;<span class="id">Hin</span>). <span class="id">rewrite</span> <span class="id">Heq</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|<span class="id">He</span>]]]]; <span class="id">inv</span> <span class="id">He</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1-4:(<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.sem_clock_refines">sem_clock_refines</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.var_history_refines">var_history_refines</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.ac_stres_proj1">ac_stres_proj1</a></span>; <span class="id">try</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.ac_stres_proj2">ac_stres_proj2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">rewrite</span> <span class="id">Hac</span>; <span class="id">auto</span>; <span class="id">simpl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.ac_fby2">ac_fby2</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">rewrite</span> <span class="id">it</span>, <span class="id">Hac</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*{ <span class="id">econstructor</span>. <span class="id">repeat</span> <span class="id">constructor</span>. 2:<span class="id">simpl</span>; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>; <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3,4,6,7:<span class="id">sem_new_vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.add_whens_enum_sem">add_whens_enum_sem</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.sem_clock_refines">sem_clock_refines</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.var_history_refines">var_history_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.add_whens_enum_sem">add_whens_enum_sem</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.sem_clock_refines">sem_clock_refines</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.var_history_refines">var_history_refines</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.fby_stres_proj1">fby_stres_proj1</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1_const">stres_proj1_const</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.fby_stres_proj2">fby_stres_proj2</a></span> <span class="kwd">in</span> <span class="id">it</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2_const">stres_proj2_const</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*{ <span class="id">econstructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">constructor</span>. <span class="id">sem_new_vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_automaton_wt_state2">sem_automaton_wt_state2</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span>; <span class="id">intros</span> <span class="id">n</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">destruct</span> (<span class="id">stres</span> # <span class="id">n</span>) <span class="kwd">as</span> [|(?&amp;?)] <span class="id">eqn</span>:<span class="id">Hst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_ind">eq_ind</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id">e</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">states</span> <span class="kwd">end</span>) <span class="kwd">in</span> <span class="id">it</span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>. <span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> &lt;-<span class="id">H9</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>; <span class="id">repeat</span> <span class="id">inv_branch</span>. <span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>; <span class="id">repeat</span> <span class="id">inv_branch</span>. <span class="id">intros</span>. <span class="id">specialize</span> (<span class="id">H22</span> <span class="id">k</span>); <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_branch</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplit</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="id">simpl</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.when_hist_restrict_ac">when_hist_restrict_ac</a></span> <span class="kwd">with</span> (<span class="id">xs</span>:=<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x1</span>::<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x3</span>::<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x5</span>::<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x7</span>::<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv">vars_of_senv</a></span> Γ').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_st">stres_st</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span>. <span class="id">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">cases_eqn</span> <span class="id">Heq</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hin</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_var_union">sem_var_union</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">repeat</span> <span class="id">rewrite</span> &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#or_assoc">or_assoc</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>], <span class="id">Hsem</span> <span class="kwd">as</span> [<span class="id">Hsem</span>|<span class="id">Hsem</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.sem_var_In">sem_var_In</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [[[|]|]|]; <span class="id">subst</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">sem_var_of_list</span>' <span class="kwd">in</span> <span class="id">Hsem</span> <span class="kwd">as</span> (?&amp;<span class="id">Heq1</span>&amp;[<span class="id">Heq</span>|[<span class="id">Heq</span>|[<span class="id">Heq</span>|[<span class="id">Heq</span>|<span class="id">Heq</span>]]]]); <span class="id">inv</span> <span class="id">Heq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Heq1</span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.ac_stres_proj1">ac_stres_proj1</a></span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.ac_stres_proj2">ac_stres_proj2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.ac_fby2">ac_fby2</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.ac_fby2">ac_fby2</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.ac_stres_proj1">ac_stres_proj1</a></span>, <span class="id">Hac</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_clock_det">sem_clock_det</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x11</span>; [<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Var">vars_of_senv_Var</a></span> <span class="kwd">in</span> <span class="id">Hin</span>|<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Last">vars_of_senv_Last</a></span> <span class="kwd">in</span> <span class="id">Hin</span>]; <span class="id">inv</span> <span class="id">Hin</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">edestruct</span> <span class="id">H16</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">eapply</span> <span class="id">Hsc</span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar">IsVar</a></span> Γ<span class="id">ty</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#var_last_ident">var_last_ident</a></span> <span class="id">x11</span>)) <span class="kwd">as</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id">Hincl</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_fst">IsVar_fst</a></span>, <span class="id">Hinclfst</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_fst">IsVar_fst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x11</span>; [<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Var">vars_of_senv_Var</a></span> <span class="kwd">in</span> <span class="id">Hin</span>|<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Last">vars_of_senv_Last</a></span> <span class="kwd">in</span> <span class="id">Hin</span>]; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sem_var_of_list</span>' <span class="kwd">in</span> <span class="id">Hsem</span> <span class="kwd">as</span> (?&amp;<span class="id">_</span>&amp;[<span class="id">Heq</span>|[<span class="id">Heq</span>|[<span class="id">Heq</span>|[<span class="id">Heq</span>|<span class="id">Heq</span>]]]]); <span class="id">inv</span> <span class="id">Heq</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_branch</span>. <span class="id">repeat</span> <span class="id">inv_bind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econstructor</span>; <span class="id">simpl</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.sem_var_restrict">sem_var_restrict</a></span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_var_fwhen">sem_var_fwhen</a></span>. <span class="id">sem_new_vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.bools_of_fwhen">bools_of_fwhen</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.bools_of_stres_proj2">bools_of_stres_proj2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">k</span>. <span class="id">specialize</span> (<span class="id">H22</span> <span class="id">k</span>); <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.select_hist">select_hist</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">rename</span> <span class="id">it</span> <span class="id">into</span> <span class="id">Hsel</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hsel</span>':=<span class="id">Hsel</span>). <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.select_hist_fselect_hist">select_hist_fselect_hist</a></span> <span class="kwd">in</span> <span class="id">Hsel</span>'. <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_branch</span>. <span class="id">destruct</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*{ <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_ck">sem_transitions_ck</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_refines">sem_transitions_refines</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_transitions_restrict">sem_transitions_restrict</a></span> <span class="kwd">with</span> (Γ:=((<span class="id">x1</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.default_ann">default_ann</a></span>)::(<span class="id">x3</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.default_ann">default_ann</a></span>)::(<span class="id">x5</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.default_ann">default_ann</a></span>)::(<span class="id">x7</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.default_ann">default_ann</a></span>)::Γ')) <span class="kwd">in</span> <span class="id">it</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">simpl_Forall</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.wx_exp_incl">wx_exp_incl</a></span>. 3:<span class="id">eauto</span> <span class="kwd">with</span> <span class="id">lclocking</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">intros</span> * <span class="id">Hv</span>; <span class="id">inv</span> <span class="id">Hv</span>; <span class="id">econstructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_cons">InMembers_cons</a></span> <span class="kwd">with</span> <span class="id">datatypes</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_equation_ck_morph">sem_equation_ck_morph</a></span>. 2,3:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="id">instantiate</span> (1:=(<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict">FEnv.restrict</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">setoid_rewrite</span> &lt;-<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_map">FEnv.restrict_map</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonStreams.html#EqStrel_Reflexive">EqStrel_Reflexive</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_Equiv">FEnv.restrict_Equiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;-<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.fselect_mask_fwhen_hist">fselect_mask_fwhen_hist</a></span>. <span class="id">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.trans_exp_sem">trans_exp_sem</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (<span class="id">ss</span>&amp;<span class="id">Htranssem</span>&amp;<span class="id">Hconcat</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">constructor</span>. <span class="id">econstructor</span>. 2:<span class="id">rewrite</span> <span class="id">Hconcat</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Common.CommonList.html#Forall2_impl_In">Forall2_impl_In</a></span>; [|<span class="id">eauto</span>]; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_exp_refines">sem_exp_refines</a></span>; <span class="id">eauto</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.restrict">restrict</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">FEnv.restrict_refines</span>', <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines_map">FEnv.refines_map</a></span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Heq</span>; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">repeat</span> <span class="id">constructor</span>; <span class="id">subst</span>; [<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1_fselect">stres_proj1_fselect</a></span>|<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2_fselect">stres_proj2_fselect</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.sem_var_restrict">sem_var_restrict</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_var_fselect">sem_var_fselect</a></span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">sem_new_vars</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_restrict">sc_vars_restrict</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> ??; <span class="id">simpl</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>; <span class="id">simpl_In</span>; <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">H16</span> <span class="kwd">as</span> (?&amp;<span class="id">Hbase</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>. <span class="id">rewrite</span> <span class="id">Hbase</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_morph">sc_vars_morph</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sc_vars_fselect">sc_vars_fselect</a></span>; <span class="id">eauto</span>. 2:<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">now</span> <span class="id">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*{ <span class="id">econstructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">constructor</span>. <span class="id">sem_new_vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.fby">fby</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_automaton_wt_state3">sem_automaton_wt_state3</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span>; <span class="id">intros</span> <span class="id">n</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span> <span class="kwd">with</span> (<span class="id">n</span>:=<span class="id">n</span>) <span class="kwd">in</span> <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">destruct</span> (<span class="id">stres1</span> # <span class="id">n</span>) <span class="kwd">as</span> [|(?&amp;?)] <span class="id">eqn</span>:<span class="id">Hst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_ind">eq_ind</a></span> <span class="kwd">with</span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.absent">absent</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux.present">present</a></span> (<span class="id">e</span>, <span class="id">_</span>) =&gt; <span class="id">e</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">states</span> <span class="kwd">end</span>) <span class="kwd">in</span> <span class="id">it</span>; [|<span class="id">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>. <span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> &lt;-<span class="id">H9</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>. <span class="id">repeat</span> <span class="id">inv_branch</span>. <span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>. <span class="id">repeat</span> <span class="id">inv_branch</span>. <span class="id">intros</span>. <span class="id">specialize</span> (<span class="id">H22</span> <span class="id">k</span>); <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_branch</span>; <span class="id">repeat</span> <span class="id">inv_scope</span>. <span class="id">subst</span> Γ'0 Γ'1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplit</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">auto_block_simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="id">simpl</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.when_hist_restrict_ac">when_hist_restrict_ac</a></span> <span class="kwd">with</span> (<span class="id">xs</span>:=<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x1</span>::<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x3</span>::<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x5</span>::<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x7</span>::<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv">vars_of_senv</a></span> Γ').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:{ <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_st">stres_st</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonStreams.html#SForall_forall">SForall_forall</a></span>. <span class="id">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth_map">Str_nth_map</a></span>. <span class="id">cases_eqn</span> <span class="id">Heq</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hin</span> <span class="id">Hsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_var_union">sem_var_union</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">repeat</span> <span class="id">rewrite</span> &lt;-<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#or_assoc">or_assoc</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>], <span class="id">Hsem</span> <span class="kwd">as</span> [<span class="id">Hsem</span>|<span class="id">Hsem</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.sem_var_In">sem_var_In</a></span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [[[|]|]|]; <span class="id">subst</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">sem_var_of_list</span>' <span class="kwd">in</span> <span class="id">Hsem</span> <span class="kwd">as</span> (?&amp;<span class="id">Heq1</span>&amp;[<span class="id">Heq</span>|[<span class="id">Heq</span>|[<span class="id">Heq</span>|[<span class="id">Heq</span>|<span class="id">Heq</span>]]]]); <span class="id">inv</span> <span class="id">Heq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Heq1</span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.ac_stres_proj1">ac_stres_proj1</a></span>; <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.ac_stres_proj2">ac_stres_proj2</a></span>; <span class="id">try</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hac</span>, &lt;-<span class="id">Hac1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hac</span>, &lt;-<span class="id">Hac1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.ac_stres_proj1">ac_stres_proj1</a></span>, <span class="id">Hac1</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_clock_det">sem_clock_det</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x11</span>; [<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Var">vars_of_senv_Var</a></span> <span class="kwd">in</span> <span class="id">Hin</span>|<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Last">vars_of_senv_Last</a></span> <span class="kwd">in</span> <span class="id">Hin</span>]; <span class="id">inv</span> <span class="id">Hin</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">edestruct</span> <span class="id">H16</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2:<span class="id">eapply</span> <span class="id">Hsc</span> <span class="kwd">in</span> <span class="id">Hsem</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar">IsVar</a></span> Γ<span class="id">ty</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#var_last_ident">var_last_ident</a></span> <span class="id">x11</span>)) <span class="kwd">as</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id">Hincl</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_fst">IsVar_fst</a></span>, <span class="id">Hinclfst</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_fst">IsVar_fst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x11</span>; [<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Var">vars_of_senv_Var</a></span> <span class="kwd">in</span> <span class="id">Hin</span>|<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Last">vars_of_senv_Last</a></span> <span class="kwd">in</span> <span class="id">Hin</span>]; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sem_var_of_list</span>' <span class="kwd">in</span> <span class="id">Hsem</span> <span class="kwd">as</span> (?&amp;<span class="id">_</span>&amp;[<span class="id">Heq</span>|[<span class="id">Heq</span>|[<span class="id">Heq</span>|[<span class="id">Heq</span>|<span class="id">Heq</span>]]]]); <span class="id">inv</span> <span class="id">Heq</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_branch</span>. <span class="id">repeat</span> <span class="id">inv_bind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econstructor</span>; <span class="id">simpl</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.sem_var_restrict">sem_var_restrict</a></span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.sem_var_fwhen">sem_var_fwhen</a></span>. <span class="id">sem_new_vars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.bools_of_fwhen">bools_of_fwhen</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.bools_of_stres_proj2">bools_of_stres_proj2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">k</span>. <span class="id">specialize</span> (<span class="id">H23</span> <span class="id">k</span>); <span class="id">destruct_conjs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.select_hist">select_hist</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">rename</span> <span class="id">it</span> <span class="id">into</span> <span class="id">Hsel</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hsel</span>':=<span class="id">Hsel</span>). <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.select_hist_fselect_hist">select_hist_fselect_hist</a></span> <span class="kwd">in</span> <span class="id">Hsel</span>'. <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_branch</span>. <span class="id">destruct</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_scope_ck">sem_scope_ck</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_scope_refines3">sem_scope_refines3</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_scope_restrict3">sem_scope_restrict3</a></span> <span class="kwd">in</span> <span class="id">it</span>. 3,4:<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>; <span class="id">intros</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">H16</span> <span class="kwd">as</span> (?&amp;<span class="id">Hbase</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>. <span class="id">rewrite</span> <span class="id">Hbase</span>; <span class="id">constructor</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_scope</span>. <span class="id">repeat</span> <span class="id">inv_bind</span>. <span class="id">subst</span> Γ'0 Γ'1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">constructor</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> ((<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.mask_hist">CStr.mask_hist</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhenb">fwhenb</a></span> <span class="id">e</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.stres_res">stres_res</a></span> <span class="id">stres1</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">stres1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict">FEnv.restrict</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fwhen_hist">fwhen_hist</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hi</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list">FEnv.of_list</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x1</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">stres</span>); (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x3</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">stres1</span>); (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x5</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">stres</span>); (<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x7</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj2">stres_proj2</a></span> <span class="id">stres1</span>)])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.stres_proj1">stres_proj1</a></span> <span class="id">stres1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x1</span>::<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x3</span>::<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x5</span>::<span class="id"><a href="Velus.FunctionalEnvironment.html#Var">Var</a></span> <span class="id">x7</span>::<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv">vars_of_senv</a></span> Γ')) + <span class="id">Hi</span>')) <span class="kwd">as</span> <span class="id">Hi</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.maskb">maskb</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">as</span> <span class="id">bs</span>''.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.refines">FEnv.refines</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.Streams.html#EqSt">EqSt</a></span> <span class="id">_</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.restrict">restrict</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect_hist">fselect_hist</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">stres1</span> <span class="id">Hi</span>) Γ' + <span class="id">Hi</span>') <span class="id">Hi</span>'') <span class="kwd">as</span> <span class="id">Href1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span> ?? <span class="id">Hf</span>. <span class="id">subst</span>. <span class="id">apply</span> <span class="id">FEnv.union4</span>' <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> [<span class="id">Hf</span>|(<span class="id">Hf</span>&amp;<span class="id">Hnf</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id">FEnv.union3</span>'. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_find_inv">FEnv.restrict_find_inv</a></span> <span class="kwd">in</span> <span class="id">Hf</span> <span class="kwd">as</span> (<span class="id">Hin</span>&amp;<span class="id">Hf</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_fenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">esplit</span>; <span class="id">try</span> <span class="id">reflexivity</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union2">FEnv.union2</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_find">FEnv.restrict_find</a></span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union2">FEnv.union2</a></span>; <span class="id">eauto</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list_None">FEnv.of_list_None</a></span>. <span class="id">intros</span> <span class="id">Him</span>. <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">take</span> (<span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> [<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|[<span class="id">He</span>|<span class="id">He</span>]]]]; <span class="id">inv</span> <span class="id">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<span class="id">take</span> (<span class="id">_</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.find_In">FEnv.find_In</a></span> <span class="kwd">in</span> <span class="id">it</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars">sc_vars</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">l0</span>) <span class="id">Hi</span>'' <span class="id">bs</span>'') <span class="kwd">as</span> <span class="id">Hsc1</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span>. <span class="id">intros</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_refines">sc_vars_refines</a></span>; <span class="id">simpl</span>. 1,4:<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hinm</span> <span class="id">_</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.dom">dom</a></span> <span class="id">Hi</span>' <span class="id">_</span>) <span class="id">and</span> <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_In">FEnv.union_In</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#or_intror">or_intror</a></span>, <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hinm</span> <span class="id">_</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.dom">dom</a></span> <span class="id">Hi</span>' <span class="id">_</span>) <span class="id">and</span> <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_In">FEnv.union_In</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#or_intror">or_intror</a></span>, <span class="id">it</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars">sc_vars</a></span> (Γ' ++ <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">l0</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.restrict">restrict</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr.fselect_hist">fselect_hist</a></span> <span class="id">e</span> <span class="id">k</span> <span class="id">stres1</span> <span class="id">Hi</span>) Γ' + <span class="id">Hi</span>') <span class="id">bs</span>'') <span class="kwd">as</span> <span class="id">Hsc2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.local_hist_sc_vars">local_hist_sc_vars</a></span> <span class="kwd">with</span> (Γ:=Γ'); <span class="id">subst</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl_refl">List.incl_refl</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.restrict_dom_ub">restrict_dom_ub</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hinm</span> <span class="id">Hin</span>. <span class="id">take</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">_</span> -&gt; ~<span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id">it</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_incl_fst">IsVar_incl_fst</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_fst">IsVar_fst</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_restrict">sc_vars_restrict</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_refines">sc_vars_refines</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sc_vars_fselect">sc_vars_fselect</a></span>; <span class="id">eauto</span>; <span class="id">try</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>. <span class="id">simpl_In</span>. <span class="id">take</span> (<span class="kwd">forall</span> <span class="id">x</span> <span class="id">ck</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.HasClock">HasClock</a></span> Γ' <span class="id">_</span> <span class="id">_</span> -&gt; <span class="id">_</span>) <span class="id">and</span> <span class="id">edestruct</span> <span class="id">it</span> <span class="kwd">as</span> (?&amp;<span class="id">Hck</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hck</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hac1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> [<span class="id">x1</span>; <span class="id">x3</span>; <span class="id">x5</span>; <span class="id">x7</span>] -&gt; ~<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">x</span> <span class="id">l0</span>) <span class="kwd">as</span> <span class="id">Hdisj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span> * <span class="id">Hin1</span> <span class="id">Hin2</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_In">InMembers_In</a></span> <span class="kwd">in</span> <span class="id">Hin2</span>; <span class="id">destruct_conjs</span>. <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> (<span class="id">take</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.fresh_ident">CA.fresh_ident</a></span> <span class="id">_</span> = <span class="id">_</span>) <span class="id">and</span> <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.Fresh.fresh_ident_prefixed">fresh_ident_prefixed</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> (?&amp;?&amp;?); <span class="id">subst</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin1</span> <span class="kwd">as</span> [|[|[|[|]]]]; <span class="id">eauto</span>; <span class="id">subst</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.Fresh.Facts.contradict_AtomOrGensym">contradict_AtomOrGensym</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.auto_not_in_elab_prefs">auto_not_in_elab_prefs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars">sc_vars</a></span> (Γ' ++ <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">l0</span>) <span class="id">Hi</span>'' <span class="id">bs</span>'') <span class="kwd">as</span> <span class="id">Hsc2</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">subst</span>. <span class="id">intros</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_refines">sc_vars_refines</a></span>; <span class="id">simpl</span>. 1,4:<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hinm</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (~<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x11</span> [<span class="id">x1</span>;<span class="id">x3</span>;<span class="id">x5</span>;<span class="id">x7</span>]) <span class="kwd">as</span> <span class="id">Hnin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span> <span class="id">contra</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_app">IsVar_app</a></span> <span class="kwd">in</span> <span class="id">Hinm</span> <span class="kwd">as</span> [<span class="id">Hinm</span>|<span class="id">Hinm</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">contra</span> <span class="kwd">as</span> [|[|[|[|]]]]; <span class="id">subst</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">Hdisj</span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_senv_of_decls">IsVar_senv_of_decls</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.restrict">restrict</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_In">FEnv.union_In</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_In">FEnv.restrict_In</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Var">vars_of_senv_Var</a></span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map_in_iff">FEnv.map_in_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_In">FEnv.union_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|]; <span class="id">auto</span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map_in_iff">FEnv.map_in_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_In">FEnv.restrict_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map_in_iff">FEnv.map_in_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_In">FEnv.union_In</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list_In">FEnv.of_list_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> ([|<span class="id">Hin2</span>]&amp;<span class="id">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">In</span>|[<span class="id">In</span>|[<span class="id">In</span>|[<span class="id">In</span>|<span class="id">In</span>]]]]; <span class="id">try</span> <span class="id">inv</span> <span class="id">In</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1-4:<span class="id">exfalso</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">split</span>; <span class="id">auto</span>. <span class="id">clear</span> - <span class="id">In</span>. <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Var">vars_of_senv_Var</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> <span class="id">Hin2</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hin2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin2</span> <span class="kwd">as</span> [<span class="id">In</span>|[<span class="id">In</span>|[<span class="id">In</span>|[<span class="id">In</span>|<span class="id">In</span>]]]]; <span class="id">try</span> <span class="id">inv</span> <span class="id">In</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hinm</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.restrict">restrict</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_In">FEnv.union_In</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_In">FEnv.restrict_In</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Last">vars_of_senv_Last</a></span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map_in_iff">FEnv.map_in_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_In">FEnv.union_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|]; <span class="id">auto</span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map_in_iff">FEnv.map_in_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_In">FEnv.restrict_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span>. <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.map_in_iff">FEnv.map_in_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.union_In">FEnv.union_In</a></span>, <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.of_list_In">FEnv.of_list_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> ([|<span class="id">Hin2</span>]&amp;<span class="id">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">In</span>|[<span class="id">In</span>|[<span class="id">In</span>|[<span class="id">In</span>|<span class="id">In</span>]]]]; <span class="id">try</span> <span class="id">inv</span> <span class="id">In</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">split</span>; <span class="id">auto</span>. <span class="id">clear</span> - <span class="id">In</span>. <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.vars_of_senv_Last">vars_of_senv_Last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span> <span class="kwd">in</span> <span class="id">Hin2</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hin2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hin2</span> <span class="kwd">as</span> [<span class="id">In</span>|[<span class="id">In</span>|[<span class="id">In</span>|[<span class="id">In</span>|<span class="id">In</span>]]]]; <span class="id">try</span> <span class="id">inv</span> <span class="id">In</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">datatypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.Sscope">Sscope</a></span> <span class="kwd">with</span> (<span class="id">Hi</span>':=<span class="id">Hi</span>'); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">subst</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*{ <span class="id">auto_block_simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_block_refines">sem_block_refines</a></span>, <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (Γ<span class="id">ck</span>:=Γ'++<span class="id">_</span>) (Γ<span class="id">ty</span>:=Γ<span class="id">ty</span>++<span class="id">_</span>) (<span class="id">Hi</span>:=(<span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict">FEnv.restrict</a></span> <span class="id">_</span> <span class="id">_</span>)); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8:{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_block_restrict">sem_block_restrict</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks.wc_env">wc_env</a></span>. <span class="id">simpl_Forall</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="id">simpl_In</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">H16</span> <span class="kwd">as</span> (<span class="id">_</span>&amp;<span class="id">Hbase</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>. <span class="id">rewrite</span> <span class="id">Hbase</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <span class="id">all</span>:<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">etransitivity</span>; <span class="id">eauto</span>. <span class="id">eapply</span> <span class="id"><a href="Velus.FunctionalEnvironment.html#FEnv.restrict_refines">FEnv.restrict_refines</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Common.CommonStreams.html#EqStrel_Reflexive">EqStrel_Reflexive</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hv</span>. <span class="id">inv</span> <span class="id">Hv</span>. <span class="id">take</span> (<span class="id"><a href="Velus.Common.CommonList.html#InMembers">InMembers</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">and</span> <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_app">InMembers_app</a></span> <span class="kwd">in</span> <span class="id">it</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="id">apply</span> <span class="id"><a href="Velus.Common.CommonList.html#InMembers_In">InMembers_In</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> (?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">Hat</span>; <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_In</span>. <span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Hv</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_app">IsVar_app</a></span> <span class="kwd">in</span> *. <span class="id">destruct</span> <span class="id">Hv</span> <span class="kwd">as</span> [<span class="id">Hv</span>|]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> *; <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsLast_app">IsLast_app</a></span>; <span class="id">intros</span> [|]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">dom_ub_incl</span>', <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.restrict_dom_ub">restrict_dom_ub</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> *; <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_app">IsVar_app</a></span>; <span class="id">intros</span> [|]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> *; <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsLast_app">IsLast_app</a></span>; <span class="id">intros</span> [|]; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sc_vars_restrict">sc_vars_restrict</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl_Forall</span>; <span class="id">simpl_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">Hin</span>|<span class="id">Hin</span>]; <span class="id">simpl_In</span>; <span class="id">simpl_Forall</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">H16</span> <span class="kwd">as</span> (<span class="id">_</span>&amp;<span class="id">Hbase</span>); <span class="id">eauto</span> <span class="kwd">with</span> <span class="id">senv</span>. <span class="id">rewrite</span> <span class="id">Hbase</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">inv_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto_block_simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H</span> <span class="kwd">with</span> (Γ<span class="id">ty</span>:=Γ<span class="id">ty</span>++<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">locs</span>) (Γ<span class="id">ck</span>:=Γ<span class="id">ck</span>++<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.senv_of_decls">senv_of_decls</a></span> <span class="id">locs</span>); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> * <span class="id">Hv</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_app">IsVar_app</a></span> <span class="kwd">in</span> <span class="id">Hv</span> <span class="kwd">as</span> [<span class="id">Hv</span>|<span class="id">Hv</span>]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hv</span>. <span class="id">simpl_In</span>. <span class="id">simpl_Forall</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> * <span class="id">Hv</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_app">IsVar_app</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_app">IsVar_app</a></span> <span class="kwd">in</span> <span class="id">Hv</span> <span class="kwd">as</span> [<span class="id">Hv</span>|<span class="id">Hv</span>]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> * <span class="id">Hv</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsLast_app">IsLast_app</a></span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsLast_app">IsLast_app</a></span> <span class="kwd">in</span> <span class="id">Hv</span> <span class="kwd">as</span> [<span class="id">Hv</span>|<span class="id">Hv</span>]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.local_hist_dom_ub">local_hist_dom_ub</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.local_hist_sc_vars">local_hist_sc_vars</a></span> <span class="kwd">with</span> (Γ:=Γ<span class="id">ty</span>); <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_incl_fst">IsVar_incl_fst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> *. <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.IsVar_fst">IsVar_fst</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CACORRECTNESS.auto_node_sem">auto_node_sem</a></span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span> <span class="id">ins</span> <span class="id">outs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ty.wt_global">wt_global</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.Global">Global</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.types">types</a></span>) <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.externs">externs</a></span>) (<span class="id">n</span>::<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.nodes">nodes</a></span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cl.wc_global">wc_global</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.Global">Global</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.types">types</a></span>) <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.externs">externs</a></span>) (<span class="id">n</span>::<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.nodes">nodes</a></span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ord.Ordered_nodes">Ordered_nodes</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.Global">Global</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.types">types</a></span>) <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.externs">externs</a></span>) (<span class="id">n</span>::<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.nodes">nodes</a></span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ord.Ordered_nodes">Ordered_nodes</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.Global">Global</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G2">G2</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.types">types</a></span>) <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G2">G2</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.externs">externs</a></span>) ((<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.auto_node">auto_node</a></span> <span class="id">n</span>))::<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G2">G2</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.nodes">nodes</a></span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_node_ck">sem_node_ck</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.Global">Global</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.types">types</a></span>) <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.externs">externs</a></span>) (<span class="id">n</span>::<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.nodes">nodes</a></span>))) <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_node_ck">sem_node_ck</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.Global">Global</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G2">G2</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.types">types</a></span>) <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G2">G2</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.externs">externs</a></span>) ((<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.auto_node">auto_node</a></span> <span class="id">n</span>))::<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G2">G2</a></span>.(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.nodes">nodes</a></span>))) <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof26')">Proof with</span></div>
<div class="proofscript" id="proof26">
 <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * (<span class="id">_</span>&amp;<span class="id">Hwt</span>) <span class="id">Hwc</span> <span class="id">Hord1</span> <span class="id">Hord2</span> <span class="id">Hsem</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsem</span>; <span class="id">rename</span> <span class="id">H0</span> <span class="id">into</span> <span class="id">Hfind</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hfind</span>. <span class="id">destruct</span> (<span class="id"><a href="Velus.Common.Common.html#ident_eq_dec">ident_eq_dec</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.n_name">n_name</a></span> <span class="id">n</span>) <span class="id">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.find_node_now">find_node_now</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="id">eauto</span>. <span class="id">inv</span> <span class="id">Hfind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*The&nbsp;semantics&nbsp;of&nbsp;equations&nbsp;can&nbsp;be&nbsp;given&nbsp;according&nbsp;to&nbsp;G&nbsp;only&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (~<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ord.Is_node_in_block">Is_node_in_block</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.n_name">n_name</a></span> <span class="id">n0</span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.n_block">n_block</a></span> <span class="id">n0</span>)) <span class="kwd">as</span> <span class="id">Blk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">Hord1</span>. <span class="id">destruct</span> <span class="id">H6</span> <span class="kwd">as</span> (<span class="id">Hisin</span>&amp;<span class="id">_</span>). <span class="id">intro</span> <span class="id">contra</span>. <span class="id">eapply</span> <span class="id">Hisin</span> <span class="kwd">in</span> <span class="id">contra</span> <span class="kwd">as</span> [? <span class="id">_</span>]; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_block_ck_cons1">sem_block_ck_cons1</a></span> <span class="kwd">in</span> <span class="id">Blk</span>; <span class="id">eauto</span>. <span class="id">clear</span> <span class="id">H3</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.n_syn">n_syn</a></span> <span class="id">n0</span>) <span class="kwd">as</span> <span class="id">Hsyn</span>. <span class="id">inversion_clear</span> <span class="id">Hsyn</span> <span class="kwd">as</span> [?? <span class="id">Syn1</span> <span class="id">Syn2</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.n_nodup">n_nodup</a></span> <span class="id">n0</span>) <span class="kwd">as</span> (<span class="id">Hnd1</span>&amp;<span class="id">Hnd2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.n_good">n_good</a></span> <span class="id">n0</span>) <span class="kwd">as</span> (<span class="id">Hgood1</span>&amp;<span class="id">Hgood2</span>&amp;<span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">take</span> (<span class="id">_</span> /\ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> (<span class="id">Hwc</span>&amp;<span class="id">_</span>); <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hwc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hwt</span>. <span class="id">take</span> (<span class="id">_</span> /\ <span class="id">_</span>) <span class="id">and</span> <span class="id">destruct</span> <span class="id">it</span> <span class="kwd">as</span> (<span class="id">Hwt</span>&amp;<span class="id">_</span>); <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> (<span class="id">Hdom1</span>&amp;<span class="id">Hsc1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.find_node_now">find_node_now</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_block_ck_cons2">sem_block_ck_cons2</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ord.find_node_not_Is_node_in">find_node_not_Is_node_in</a></span> <span class="kwd">in</span> <span class="id">Hord2</span>. 2:<span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.find_node_now">find_node_now</a></span>; <span class="id">eauto</span>. <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">replace</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.Global">Global</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.types">types</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.externs">externs</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>) (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.nodes">nodes</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>)) <span class="kwd">with</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span> <span class="kwd">in</span> <span class="id">Blk</span> <span class="kwd">by</span> (<span class="id">destruct</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>; <span class="id">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.auto_block_sem">auto_block_sem</a></span> <span class="kwd">in</span> <span class="id">Blk</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem.dom_dom_ub">dom_dom_ub</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.node_NoDupLocals">node_NoDupLocals</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5:<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#surjective_pairing">surjective_pairing</a></span> <span class="kwd">with</span> (<span class="id">p</span>:=<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.auto_block">auto_block</a></span> <span class="id">_</span> <span class="id">_</span>), <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#surjective_pairing">surjective_pairing</a></span> <span class="kwd">with</span> (<span class="id">p</span>:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">_</span>); <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">destruct</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G2">G2</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">intros</span> * <span class="id">Hv</span>. <span class="id">inv</span> <span class="id">Hv</span>. <span class="id">rewrite</span> <span class="id"><a href="Velus.Common.CommonList.html#fst_InMembers">fst_InMembers</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.map_fst_senv_of_ins">map_fst_senv_of_ins</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv.map_fst_senv_of_decls">map_fst_senv_of_decls</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">simpl_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">Hwt</span>; <span class="id">subst</span> Γ; <span class="id">destruct</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">Hwc</span>; <span class="id">destruct</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.find_node_other">find_node_other</a></span> <span class="kwd">in</span> <span class="id">Hfind</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_node_ck_cons2">sem_node_ck_cons2</a></span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G2">G2</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.Href">Href</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node.G1">G1</a></span>; <span class="id">econstructor</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_block_ck_cons1">sem_block_ck_cons1</a></span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ord.find_node_later_not_Is_node_in">find_node_later_not_Is_node_in</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.sem_node">sem_node</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Module</span> <span class="id"><a name="CACORRECTNESS.Clocking">Clocking</a></span> := <span class="id"><a href="Velus.Lustre.CompAuto.CAClocking.html#CAClockingFun">CAClockingFun</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cl">Cl</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA">CA</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CACORRECTNESS.auto_global_refines">auto_global_refines</a></span> : <span class="kwd">forall</span> <span class="id">G</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ty.wt_global">wt_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cl.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.global_sem_refines">global_sem_refines</a></span> <span class="id">G</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.auto_global">auto_global</a></span> <span class="id">G</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof27')">Proof with</span></div>
<div class="proofscript" id="proof27">
 <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.wc_global_Ordered_nodes">wc_global_Ordered_nodes</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [] (<span class="id">Htypes</span>&amp;<span class="id">Hwt</span>). <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.auto_global">auto_global</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id">types0</span> ++ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#flat_map">flat_map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.auto_node">auto_node</a></span> <span class="id">nodes0</span>)). <span class="id">revert</span> <span class="id">types0</span> <span class="id">Htypes</span> <span class="id">Hwt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">nodes0</span>; <span class="id">intros</span> * <span class="id">Htypes</span> <span class="id">Hwt</span> * <span class="id">Hwc</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.global_sem_ref_nil">global_sem_ref_nil</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">assert</span> (<span class="id">Hwc</span>':=<span class="id">Hwc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.auto_global_wc">Clocking.auto_global_wc</a></span>, <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.wc_global_Ordered_nodes">wc_global_Ordered_nodes</a></span> <span class="kwd">in</span> <span class="id">Hwc</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.global_sem_refines">global_sem_refines</a></span> {| <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.types">types</a></span> := <span class="id">types0</span>; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.externs">externs</a></span> := <span class="id">externs0</span>; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.nodes">nodes</a></span> := <span class="id">nodes0</span>|}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.types">types</a></span> := <span class="id">l</span>; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.externs">externs</a></span> := <span class="id">externs0</span>; <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.nodes">nodes</a></span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.auto_node">auto_node</a></span> <span class="id">nodes0</span>) |}) <span class="kwd">as</span> <span class="id">Hind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">Hwt</span>. <span class="id">inv</span> <span class="id">Hwc</span>. <span class="id">eapply</span> <span class="id">IHnodes0</span>... }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.global_sem_ref_cons">global_sem_ref_cons</a></span> <span class="kwd">with</span> (<span class="id">f</span>:=<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.n_name">n_name</a></span> <span class="id">a</span>)...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ord.Ordered_nodes_change_types">Ordered_nodes_change_types</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">ins</span> <span class="id">outs</span> <span class="id">Hsem</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> <span class="id">l</span> <span class="kwd">with</span> ((<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.Global">Global</a></span> <span class="id">l</span> <span class="id">externs0</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.auto_node">auto_node</a></span> <span class="id">nodes0</span>))).(<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.types">types</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.auto_node_sem">auto_node_sem</a></span> <span class="kwd">with</span> (<span class="id">G1</span>:=<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn.Global">Global</a></span> <span class="id">types0</span> <span class="id">externs0</span> <span class="id">nodes0</span>)...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1-3:<span class="id">inv</span> <span class="id">Hwt</span>; <span class="id">inv</span> <span class="id">Hwc</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">destruct</span> <span class="id">H1</span>. <span class="id">constructor</span>... <span class="id">constructor</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ord.Ordered_nodes_change_types">Ordered_nodes_change_types</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id"><a name="CACORRECTNESS.auto_global_sem">auto_global_sem</a></span> : <span class="kwd">forall</span> <span class="id">G</span> <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ty.wt_global">wt_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cl.wc_global">wc_global</a></span> <span class="id">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_node_ck">sem_node_ck</a></span> <span class="id">G</span> <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LCS.sem_node_ck">sem_node_ck</a></span> (<span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA.auto_global">auto_global</a></span> <span class="id">G</span>) <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS.auto_global_refines">auto_global_refines</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">f</span> <span class="id">ins</span> <span class="id">outs</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS">CACORRECTNESS</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="CACorrectnessFun">CACorrectnessFun</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Ids</span> : <span class="id"><a href="Velus.Common.Common.html#IDS">IDS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Op</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS">OPERATORS</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">OpAux</span> : <span class="id"><a href="Velus.Operators.html#OPERATORS_AUX">OPERATORS_AUX</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Cks</span> : <span class="id"><a href="Velus.Clocks.html#CLOCKS">CLOCKS</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CStr</span> : <span class="id"><a href="Velus.CoindStreams.html#COINDSTREAMS">COINDSTREAMS</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Senv</span> : <span class="id"><a href="Velus.Lustre.StaticEnv.html#STATICENV">STATICENV</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Syn</span> : <span class="id"><a href="Velus.Lustre.LSyntax.html#LSYNTAX">LSYNTAX</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Ty</span> : <span class="id"><a href="Velus.Lustre.LTyping.html#LTYPING">LTYPING</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Clo</span> : <span class="id"><a href="Velus.Lustre.LClocking.html#LCLOCKING">LCLOCKING</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Lord</span> : <span class="id"><a href="Velus.Lustre.LOrdered.html#LORDERED">LORDERED</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Sem</span> : <span class="id"><a href="Velus.Lustre.LSemantics.html#LSEMANTICS">LSEMANTICS</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr">CStr</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LClockSem</span> : <span class="id"><a href="Velus.Lustre.LClockedSemantics.html#LCLOCKEDSEMANTICS">LCLOCKEDSEMANTICS</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Clo">Clo</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr">CStr</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem">Sem</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CA</span> : <span class="id"><a href="Velus.Lustre.CompAuto.CompAuto.html#COMPAUTO">COMPAUTO</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn">Syn</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;: <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS">CACORRECTNESS</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr">CStr</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ty">Ty</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Clo">Clo</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem">Sem</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LClockSem">LClockSem</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA">CA</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Include</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACORRECTNESS">CACORRECTNESS</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ids">Ids</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Op">Op</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#OpAux">OpAux</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Cks">Cks</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CStr">CStr</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Senv">Senv</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Syn">Syn</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Ty">Ty</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Clo">Clo</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Lord">Lord</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#Sem">Sem</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#LClockSem">LClockSem</a></span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CA">CA</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.CompAuto.CACorrectness.html#CACorrectnessFun">CACorrectnessFun</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
