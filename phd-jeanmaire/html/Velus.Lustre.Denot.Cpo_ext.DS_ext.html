
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module DS_ext</title>
<meta name="description" content="Documentation of Coq module DS_ext" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module DS_ext</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Common.CommonList.html">Common.CommonList</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Velus.Lustre.Denot.Cpo</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html">Cpo_streams_type</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html">Systems</a></span>.<br/>
<br/>
<span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#ListNotations">ListNotations</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html">Cpo_def_ext</a></span>.<br/>
<br/>
<h1> Extension of the Cpo library </h1>
<br/>
<h2> Cpo_streams_type.v </h2>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Rewrite</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS_simpl">CONS_simpl</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Cons_simpl">Cons_simpl</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM_simpl">REM_simpl</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter_eq_cons">filter_eq_cons</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_bot">rem_bot</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_bot">map_bot</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter_bot">filter_bot</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_eq_bot">first_eq_bot</a></span><br/>
&nbsp;&nbsp;: <span class="id">cpodb</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bot_not_cons">bot_not_cons</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> : <span class="id">D</span>) <span class="id">s</span>, 0 == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">s</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#not_is_consBot">not_is_consBot</a></span> <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Con_eq_simpl">Con_eq_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">s</span> <span class="id">t</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">b</span> <span class="id">t</span>-&gt; <span class="id">a</span> = <span class="id">b</span> /\ <span class="id">s</span> == <span class="id">t</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con_hd_simpl">Con_hd_simpl</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con_tl_simpl">Con_tl_simpl</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Con_le_simpl">Con_le_simpl</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">s</span> <span class="id">t</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>) &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">b</span> <span class="id">t</span> -&gt; <span class="id">a</span> = <span class="id">b</span> /\ <span class="id">s</span> &lt;= <span class="id">t</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon_hd">DSleCon_hd</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleCon_tl">DSleCon_tl</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_cons_elim">DSle_cons_elim</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> (<span class="id">x</span> :  <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) <span class="id">a</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) &lt;= <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">t</span>, <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">t</span> /\ <span class="id">s</span> &lt;= <span class="id">t</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hle</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_uncons">DSle_uncons</a></span> <span class="kwd">in</span> <span class="id">Hle</span> <span class="kwd">as</span> [? [ <span class="id">Hd</span>]].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp_eqCon">decomp_eqCon</a></span> <span class="kwd">in</span> <span class="id">Hd</span>; <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Con_le_le">Con_le_le</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">y</span> <span class="id">ys</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">x</span> <span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) &lt;= <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">y</span> <span class="id">ys</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) &lt;= <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> = <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Le1</span> <span class="id">Le2</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DSle_cons_elim">DSle_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Le1</span> <span class="kwd">as</span> (?&amp; <span class="id">Hx</span> &amp;?), <span class="id">Le2</span> <span class="kwd">as</span> (?&amp; <span class="id">Hy</span> &amp;?).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span> <span class="kwd">in</span> <span class="id">Hy</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hy</span> <span class="kwd">as</span> [].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_app">app_app</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> <span class="id">t</span> <span class="id">u</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">s</span> <span class="id">u</span>) <span class="id">t</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">s</span> <span class="id">t</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_app_first">app_app_first</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_app_first">first_app_first</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_app_first">app_app_first</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FILTER_filter">FILTER_filter</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">P</span> <span class="id">Pdec</span> (<span class="id">s</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FILTER">FILTER</a></span> <span class="id">P</span> <span class="id">Pdec</span> <span class="id">s</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span> <span class="id">P</span> <span class="id">Pdec</span> <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#FILTER_filter">FILTER_filter</a></span> : <span class="id">cpodb</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="MAP_map">MAP_map</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D1</span> <span class="id">D2</span> (<span class="id">F</span>:<span class="id">D1</span>-&gt;<span class="id">D2</span>) (<span class="id">s</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D1</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id">F</span> <span class="id">s</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">F</span> <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span> : <span class="id">cpodb</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScase_bot_eq">DScase_bot_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">D</span>' <span class="id">f</span>, @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">D</span> <span class="id">D</span>' <span class="id">f</span> 0 == 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
Qed.</div>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DScase_bot_eq">DScase_bot_eq</a></span> : <span class="id">cpodb</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScase_bot2_le">DScase_bot2_le</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">D</span>' (<span class="id">f</span> : <span class="id">D</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>') (<span class="id">Fbot</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">x</span>, <span class="id">f</span> <span class="id">a</span> <span class="id">x</span> == 0),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">f</span> <span class="id">x</span> &lt;= 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Fbot</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScaseEps">DScaseEps</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSleEps">DSleEps</a></span>, <span class="id">Cof</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Fbot</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DScase_bot2">DScase_bot2</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">D</span>' (<span class="id">f</span> : <span class="id">D</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -<span class="id">m</span>&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>') (<span class="id">Fbot</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">x</span>, <span class="id">f</span> <span class="id">a</span> <span class="id">x</span> == 0),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase">DScase</a></span> <span class="id">f</span> <span class="id">x</span> == 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DScase_bot2_le">DScase_bot2_le</a></span> <span class="kwd">in</span> <span class="id">Fbot</span>; <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cons_is_cons">cons_is_cons</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">x</span> <span class="id">t</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;<span class="id">now</span> <span class="id">intros</span> * -&gt;.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Epsdecomp">Epsdecomp</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">a</span> (<span class="id">s</span> <span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">a</span> <span class="id">s</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;<span class="id">destruct</span> 1 <span class="kwd">as</span> [[|<span class="id">k</span>] <span class="id">Hp</span>].<br/>
&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Hp</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="kwd">exists</span> <span class="id">k</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decomp_decomp">decomp_decomp</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>) <span class="id">x</span> <span class="id">x</span>' <span class="id">t</span> <span class="id">t</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">x</span> <span class="id">t</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">x</span>' <span class="id">t</span>' <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> = <span class="id">x</span>' /\ <span class="id">t</span> = <span class="id">t</span>'.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;<span class="id">clear</span>. <span class="id">intros</span> * [<span class="id">k</span> <span class="id">kth</span>].<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">dependent</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">k</span>; <span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">Hp</span> <span class="id">Hd</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decompCon_eq">decompCon_eq</a></span> <span class="kwd">in</span> <span class="id">Hd</span>. <span class="id">now</span> <span class="id">inversion</span> <span class="id">Hd</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">s</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Epsdecomp">Epsdecomp</a></span> <span class="kwd">in</span> <span class="id">Hd</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decompCon_eq">decompCon_eq</a></span> <span class="kwd">in</span> <span class="id">Hd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Hd</span>; <span class="id">subst</span>; <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<h3> DS_bisimulation with two obligations in one </h3>
<span class="kwd">Lemma</span> <span class="id"><a name="DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">R</span>: <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span> -&gt; <span class="kwd">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">y1</span> <span class="id">y2</span>, <span class="id">R</span> <span class="id">x1</span> <span class="id">y1</span> -&gt; <span class="id">x1</span>==<span class="id">x2</span> -&gt; <span class="id">y1</span>==<span class="id">y2</span> -&gt; <span class="id">R</span> <span class="id">x2</span> <span class="id">y2</span>)<br/>
&nbsp;&nbsp;&nbsp;-&gt; (<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span> \/ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">y</span>) -&gt; <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">y</span> /\ <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">y</span>))<br/>
&nbsp;&nbsp;&nbsp;-&gt; <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">x</span> == <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">IH</span> <span class="id">Hfr</span> <span class="id">x</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_bisimulation">DS_bisimulation</a></span> <span class="id">R</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span>; <span class="id">intros</span> ?? <span class="id">Hic</span> ?; <span class="id">now</span> <span class="id">apply</span> <span class="id">Hfr</span> <span class="kwd">in</span> <span class="id">Hic</span>.<br/>
Qed.</div>
<br/>
<h3> <span class="bracket"><span class="id">ds_eq</span></span>, a coinductive equivalence principle that is sometimes
    less cumbersome to use than <span class="bracket"><span class="id">DS_bsimulation_allin1</span></span> </h3>
<span class="kwd">Section</span> <span class="id"><a name="DS_eq">DS_eq</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> (<span class="id"><a name="DS_eq.D">D</a></span> : <span class="kwd">Type</span>).<br/>
<span class="kwd">CoInductive</span> <span class="id"><a name="ds_eq">ds_eq</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_eq.D">D</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_eq.D">D</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="De">De</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span> \/ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">y</span> /\ <span class="id">ds_eq</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">y</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ds_eq</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Oeq_ds_eq">Oeq_ds_eq</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">x</span> == <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ds_eq">ds_eq</a></span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#De">De</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ds_eq_Oeq">ds_eq_Oeq</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ds_eq">ds_eq</a></span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">x</span> == <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span> (<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ds_eq">ds_eq</a></span> <span class="id">x</span> <span class="id">y</span> /\ <span class="id">U</span> == <span class="id">x</span> /\ <span class="id">V</span> == <span class="id">y</span>).<br/>
&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">Eq</span> <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">x</span> &amp; <span class="id">y</span> &amp; <span class="id">Eq</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">y</span>); <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ds_eq_Oeq_iff">ds_eq_Oeq_iff</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ds_eq">ds_eq</a></span> <span class="id">x</span> <span class="id">y</span> &lt;-&gt; <span class="id">x</span> == <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;<span class="id">split</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ds_eq_Oeq">ds_eq_Oeq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Oeq_ds_eq">Oeq_ds_eq</a></span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Reflexive">Reflexive</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ds_eq">ds_eq</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;<span class="id">intro</span>; <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Oeq_ds_eq">Oeq_ds_eq</a></span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ds_eq">ds_eq</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_eq.D">D</a></span>) ==&gt; @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_eq.D">D</a></span>) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">DS_eq_morph</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Eq1</span> * <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intro</span> <span class="id">Heq</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ds_eq_Oeq_iff">ds_eq_Oeq_iff</a></span> <span class="kwd">in</span> *; <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_eq">DS_eq</a></span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">remember_ds</span>" <span class="id">uconstr</span>(<span class="id">s</span>) "<span class="kwd">as</span>" <span class="id">ident</span>(<span class="id">x</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Hx</span> := <span class="id">fresh</span> "<span class="id">H</span>"<span class="id">x</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">remember</span> <span class="id">s</span> <span class="kwd">as</span> <span class="id">x</span> <span class="id">eqn</span>:<span class="id">Hx</span>;<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_refl_eq">Oeq_refl_eq</a></span> <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">revert_all</span> :=<br/>
&nbsp;&nbsp;<span class="id">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">revert</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">coind_Oeq</span> <span class="id">H</span> :=<br/>
&nbsp;&nbsp;<span class="id">intros</span><br/>
&nbsp;&nbsp;; <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|- ?<span class="id">l</span> == ?<span class="id">r</span> =&gt; <span class="id">remember_ds</span> <span class="id">l</span> <span class="kwd">as</span> <span class="id">U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">remember_ds</span> <span class="id">r</span> <span class="kwd">as</span> <span class="id">V</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ds_eq_Oeq">ds_eq_Oeq</a></span><br/>
&nbsp;&nbsp;; <span class="id">revert_all</span>; <span class="kwd">cofix</span> <span class="id">H</span><br/>
&nbsp;&nbsp;; <span class="id">intros</span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="first_rem_eq">first_rem_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> (<span class="id">xs</span> <span class="id">ys</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">xs</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> == <span class="id">ys</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">V</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">V</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">intros</span> * [] &lt;- &lt;-.<br/>
&nbsp;&nbsp;<span class="id">clear</span>; <span class="id">intros</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">Hc</span> [<span class="id">Hf</span> <span class="id">Hr</span>]; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<h3> Simpler principle than DSle_rec_eq  </h3>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_rec_eq2">DSle_rec_eq2</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">R</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span> -&gt; <span class="kwd">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">y1</span> <span class="id">y2</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>, <span class="id">R</span> <span class="id">x1</span> <span class="id">y1</span> -&gt; <span class="id">x1</span>==<span class="id">x2</span> -&gt; <span class="id">y1</span>==<span class="id">y2</span> -&gt; <span class="id">R</span> <span class="id">x2</span> <span class="id">y2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span> -&gt; <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">y</span> /\ <span class="id">R</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_ord">DS_ord</a></span> <span class="id">D</span>, <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">x</span> &lt;= <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">R1</span> <span class="id">R2</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_rec_eq">DSle_rec_eq</a></span> <span class="kwd">with</span> <span class="id">R</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> ?? <span class="id">y</span>' <span class="id">Hr</span>'.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">R2</span> <span class="kwd">in</span> <span class="id">Hr</span>' <span class="kwd">as</span> (?&amp;?); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">y</span>'); <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons_elim">first_cons_elim</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp; -&gt; &amp;?).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
Qed.</div>
<br/>
<h3> The constant stream </h3>
<span class="kwd">CoFixpoint</span> <span class="id"><a name="DS_const">DS_const</a></span> {<span class="id">A</span>} (<span class="id">a</span> : <span class="id">A</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> (<span class="id">DS_const</span> <span class="id">a</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DS_const_eq">DS_const_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span>} (<span class="id">a</span> : <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id">a</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id">a</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_inv">DS_inv</a></span> <span class="kwd">at</span> 1.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_DS_const">is_cons_DS_const</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span>} (<span class="id">a</span> : <span class="id">A</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id">a</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DS_const_inf">DS_const_inf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span>} (<span class="id">a</span> : <span class="id">A</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id">a</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">rewrite</span> ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="first_DS_const">first_DS_const</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> (<span class="id">c</span> : <span class="id">D</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id">c</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">c</span> 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span> <span class="kwd">at</span> 1.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="map_DS_const">map_DS_const</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id">c</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> (<span class="id">f</span> <span class="id">c</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> (<span class="id">f</span> <span class="id">c</span>)).<br/>
&nbsp;&nbsp;3: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">now</span> <span class="id">intros</span> ????? &lt;- &lt;-. }<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>; [| <span class="id">split</span>]; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span> <span class="id">c</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span> (<span class="id">f</span> <span class="id">c</span>)), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">at</span> 1.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">A</span> <span class="id">B</span> : (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id">A</span> <span class="id">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.Morphisms.html#respectful">respectful</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>) ==&gt; @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>) ==&gt; @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">MAP_morph</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">f</span> <span class="id">g</span> <span class="id">Hfg</span> ?? -&gt;.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id">f</span> <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id">g</span> <span class="id">xs</span>).<br/>
&nbsp;&nbsp;3: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> ????(?&amp;?&amp;?&amp;?)??. <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">xs</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span>) <span class="kwd">as</span> <span class="id">Hcx</span>.<br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [?%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>|?%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>]; <span class="id">tauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hcx</span> <span class="kwd">as</span> (<span class="id">vx</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hx</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span> <span class="kwd">in</span> <span class="id">Hu</span>, <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span> <span class="kwd">in</span> <span class="id">Hu</span>, <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, <span class="id">Hfg</span>; <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="DSle_cons">DSle_cons</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">x</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) <span class="id">y</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">y</span> <span class="id">ys</span> -&gt; <span class="id">xs</span> &lt;= <span class="id">ys</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hle</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_decomp">DSle_decomp</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decompCon">decompCon</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">Hle</span>) <span class="kwd">as</span> (?&amp;<span class="id">H</span>&amp;?).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decompCon_eq">decompCon_eq</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">H</span>; <span class="id">subst</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_rem_app">app_rem_app</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">f</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>) (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> (<span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> <span class="id">y</span>))) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> (<span class="id">f</span> <span class="id">y</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id">V</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="kwd">exists</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> (<span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> <span class="id">y</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> (<span class="id">f</span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;3: <span class="id">right</span>; <span class="kwd">exists</span> <span class="id">x</span>, <span class="id">y</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> [<span class="id">Heq</span> | (<span class="id">x</span> &amp; <span class="id">y</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>)].<br/>
&nbsp;&nbsp;{ <span class="id">setoid_rewrite</span> <span class="id">Heq</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">x</span>) <span class="kwd">as</span> (<span class="id">vx</span> &amp; <span class="id">x</span>' &amp; <span class="id">Hx</span>).<br/>
&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>; [<span class="id">rewrite</span> &lt;- <span class="id">Hu</span>| <span class="id">rewrite</span> &lt;- <span class="id">Hv</span>]; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span> <span class="kwd">in</span> <span class="id">Hu</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span> <span class="kwd">in</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">setoid_rewrite</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_rem">app_rem</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">s</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span>) == <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_app_first">app_app_first</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_first_rem">app_first_rem</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_eq_impl">app_eq_impl</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">y1</span> <span class="id">y2</span> <span class="id">y3</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x1</span> <span class="id">x2</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">y1</span> <span class="id">y2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x2</span> == <span class="id">y2</span> -&gt; <span class="id">x3</span> == <span class="id">y3</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x1</span> <span class="id">x3</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">y1</span> <span class="id">y3</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Ha</span> <span class="id">Him</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">y1</span> <span class="id">y2</span> <span class="id">y3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x1</span> <span class="id">x2</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">y1</span> <span class="id">y2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="id">x2</span> == <span class="id">y2</span> -&gt; <span class="id">x3</span> == <span class="id">y3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x1</span> <span class="id">x3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">y1</span> <span class="id">y3</span>).<br/>
&nbsp;&nbsp;3:<span class="id">eauto</span> 12.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">x1</span> &amp; <span class="id">x2</span> &amp; <span class="id">x3</span> &amp; <span class="id">y1</span> &amp; <span class="id">y2</span> &amp; <span class="id">y3</span> &amp; <span class="id">Ha</span> &amp; <span class="id">Him</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">Hu</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_eq_compat">first_eq_compat</a></span> <span class="kwd">in</span> <span class="id">Ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_app_first">first_app_first</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>; <span class="id">rewrite</span> <span class="id">Ha</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_app">is_cons_app</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">y1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>; <span class="id">rewrite</span> &lt;- <span class="id">Ha</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_app">is_cons_app</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_eq_compat">rem_eq_compat</a></span> <span class="kwd">in</span> <span class="id">Ha</span> <span class="kwd">as</span> <span class="id">Har</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span> <span class="kwd">in</span> <span class="id">Har</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">x3</span>), 0, (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x3</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">y3</span>), 0, (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">y3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_first_rem">app_first_rem</a></span>, <span class="id">Him</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_app_app_rem">rem_app_app_rem</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>) <span class="id">y</span>)) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>) <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">U</span> == <span class="id">V</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ (<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>) <span class="id">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>) <span class="id">y</span>)).<br/>
&nbsp;&nbsp;3: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">x</span> &amp; <span class="id">y</span> &amp; [<span class="id">Huv</span>|[<span class="id">Hu</span> <span class="id">Hv</span>]]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">setoid_rewrite</span> <span class="id">Huv</span>. <span class="id">unshelve</span> <span class="id">eauto</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">x</span>) <span class="kwd">as</span> (<span class="id">vx</span> &amp; <span class="id">xs</span> &amp; <span class="id">Hx</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [<span class="id">Hc</span>|<span class="id">Hc</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id">Hu</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_is_cons">rem_is_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_is_cons">rem_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, &lt;- <span class="id">Hu</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hv</span>; <span class="id">unshelve</span> <span class="id">eauto</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="infinite_rem">infinite_rem</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Hi</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_infinite">rem_infinite</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">s</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Hi</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="infinite_app">infinite_app</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> (<span class="id">U</span> <span class="id">V</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">U</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">V</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">U</span> <span class="id">V</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span> <span class="id">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="infinite_le_eq">infinite_le_eq</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>), <span class="id">s</span> &lt;= <span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">s</span> -&gt; <span class="id">s</span> == <span class="id">t</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="id">U</span> &lt;= <span class="id">V</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">U</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> * [] &lt;- &lt;-; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">s</span> <span class="id">t</span> <span class="id">Hc</span> [<span class="id">Hle</span> <span class="id">Hinf</span>].<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hinf</span> <span class="kwd">as</span> [<span class="id">H</span> <span class="id">Hinf</span>].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hs</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hs</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DSle_cons_elim">DSle_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hle</span> <span class="kwd">as</span> (?&amp; <span class="id">Ht</span> &amp;?).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">Ht</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> *.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_rem">is_cons_rem</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span>) -&gt; <span class="kwd">exists</span> <span class="id">x</span> <span class="id">y</span> <span class="id">xs</span>, <span class="id">s</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">y</span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_is_cons">rem_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> <span class="id">Hc</span>'.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc</span>' <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hs</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> (<span class="id">y</span> &amp; <span class="id">xs</span> &amp; <span class="id">Hxs</span>').<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hxs</span>' <span class="kwd">in</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_eq_cons">rem_eq_cons</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">b</span>:<span class="id">D</span>) <span class="id">s</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">b</span> <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">a</span>, <span class="id">s</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">b</span> <span class="id">t</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hrs</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_rem">is_cons_rem</a></span> <span class="id">_</span> <span class="id">s</span>) <span class="kwd">as</span> (<span class="id">a</span>' &amp; <span class="id">b</span>' &amp; <span class="id">t</span>' &amp; <span class="id">Hs</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_eq_compat">rem_eq_compat</a></span> <span class="kwd">in</span> <span class="id">Hs</span> <span class="kwd">as</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, <span class="id">Hrs</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">HH</span> <span class="kwd">as</span> [? <span class="id">Ht</span>]; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">a</span>'. <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hs</span>, <span class="id">Ht</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="map_eq_cons_elim">map_eq_cons_elim</a></span> : <span class="kwd">forall</span> <span class="id">D</span> <span class="id">D</span>' (<span class="id">f</span> : <span class="id">D</span> -&gt; <span class="id">D</span>') <span class="id">a</span> <span class="id">s</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">b</span>, <span class="kwd">exists</span> <span class="id">t</span>, <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">b</span> <span class="id">t</span> /\ <span class="id">f</span> <span class="id">b</span> = <span class="id">a</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">t</span> == <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span>,<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="kwd">in</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="kwd">in</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id">f</span>) <span class="kwd">in</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_eq_cons_elim">DScase_eq_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hm</span> <span class="kwd">as</span> (<span class="id">b</span> &amp; <span class="id">t</span> &amp; <span class="id">Heq</span> &amp; <span class="id">Hmapf</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con_hd_simpl">Con_hd_simpl</a></span> <span class="kwd">in</span> <span class="id">Hmapf</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con_tl_simpl">Con_tl_simpl</a></span> <span class="kwd">in</span> <span class="id">Hmapf</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="map_comp">map_comp</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) (<span class="id">g</span> : <span class="id">B</span> -&gt; <span class="id">C</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">g</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">s</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; (<span class="id">g</span> (<span class="id">f</span> <span class="id">x</span>))) <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">s</span>, <span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">g</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">s</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; (<span class="id">g</span> (<span class="id">f</span> <span class="id">x</span>))) <span class="id">s</span>).<br/>
&nbsp;&nbsp;3: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> ???? (?&amp;?&amp;?) ??; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">X</span> <span class="id">Y</span> [<span class="id">Hcons</span>|<span class="id">Hcons</span>] (<span class="id">s1</span> &amp; <span class="id">HX</span> &amp; <span class="id">HY</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">split</span>; [| <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s1</span>)]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HX</span>,<span class="id">HY</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hcons</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hcons</span> <span class="kwd">as</span> (?&amp;?&amp;-&gt;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_map">rem_map</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">xs</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">xs</span>, <span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>)).<br/>
&nbsp;&nbsp;3: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> ???? (?&amp; -&gt; &amp; -&gt;) ??. <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (? &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">exists</span> <span class="id">a</span> <span class="id">b</span> <span class="id">xs</span>, <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">a</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">b</span> <span class="id">xs</span>)) <span class="kwd">as</span> (<span class="id">a</span> &amp; <span class="id">b</span> &amp; <span class="id">xs</span> &amp; <span class="id">Hx</span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [<span class="id">Hc</span> | <span class="id">Hc</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_rem">is_cons_rem</a></span> <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp; <span class="id">Hfx</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_eq_cons_elim">map_eq_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hfx</span> <span class="kwd">as</span> (?&amp;?&amp; ? &amp; ? &amp; <span class="id">Hf</span>'); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_eq_cons_elim">map_eq_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hf</span>' <span class="kwd">as</span> (?&amp; ? &amp; <span class="id">HH</span> &amp; ? &amp;?); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HH</span> <span class="kwd">in</span> *; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_rem">is_cons_rem</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>; [| <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">b</span> <span class="id">xs</span>)]; <span class="id">now</span> <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="first_map">first_map</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">s</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">s</span>, <span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">s</span>) /\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span>)).<br/>
&nbsp;&nbsp;3: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> * (?&amp;?&amp;?) ??. <span class="id">esplit</span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (?&amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">x</span>) <span class="kwd">as</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">Hc</span> % <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_is_cons">first_is_cons</a></span> % <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span> | <span class="id">Hc</span> % <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>]; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hx</span> <span class="kwd">as</span> (<span class="id">vx</span> &amp; <span class="id">xs</span> &amp; <span class="id">Hx</span>).<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>; [| <span class="kwd">exists</span> 0]; <span class="id">now</span> <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_map">app_map</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) (<span class="id">U</span> <span class="id">V</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">U</span> <span class="id">V</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">U</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">V</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id">V</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">X</span> <span class="id">Y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">X</span> <span class="id">Y</span>) /\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">Y</span>))).<br/>
&nbsp;&nbsp;3: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> [<span class="id">HH</span> | (<span class="id">X</span> &amp; <span class="id">Y</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>)].<br/>
&nbsp;&nbsp;{ <span class="id">setoid_rewrite</span> <span class="id">HH</span>. <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">X</span>) <span class="kwd">as</span> (<span class="id">vx</span> &amp; <span class="id">X</span>' &amp; <span class="id">Hx</span>).<br/>
&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Hv</span>. }<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="map_ext">map_ext</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">D</span>' (<span class="id">f</span> <span class="id">g</span> : <span class="id">D</span> -&gt; <span class="id">D</span>'),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">d</span>, <span class="id">f</span> <span class="id">d</span> = <span class="id">g</span> <span class="id">d</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">g</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hfg</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">x</span>, <span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">x</span> /\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">g</span> <span class="id">x</span>); <span class="id">eauto</span> 3.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">Hfg</span>; <span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">xs</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">xs</span>) <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hxs</span>).<br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [?%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>|?%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>]. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hxs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">split</span>;[|<span class="kwd">exists</span> <span class="id">xs</span>']; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, ?<span class="id">Hfg</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="map_inf">map_inf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hi</span>. <span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">xs</span>) <span class="kwd">as</span> <span class="id">fxs</span> <span class="id">eqn</span>:<span class="id">Hfxs</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_refl_eq">Oeq_refl_eq</a></span> <span class="kwd">in</span> <span class="id">Hfxs</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hi</span> <span class="id">Hfxs</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">xs</span> <span class="id">fxs</span>.<br/>
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hi</span>' := <span class="id">Hi</span>).<br/>
&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hfxs</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_map">is_cons_map</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Cof</span> <span class="kwd">with</span> (<span class="id">xs</span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hfxs</span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_map">rem_map</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inf_map">inf_map</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span> * <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Hf</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_map">rem_map</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cons_decomp">cons_decomp</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">x</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>) <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">t</span>', <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp">decomp</a></span> <span class="id">x</span> <span class="id">t</span>' <span class="id">s</span> /\ <span class="id">t</span> == <span class="id">t</span>'.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_eq_compat">is_cons_eq_compat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span> <span class="id">Hs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#isConCon">isConCon</a></span> <span class="id">_</span> <span class="id">_</span>)) <span class="kwd">as</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#uncons">uncons</a></span> <span class="id">Hc</span>) <span class="kwd">as</span> (?&amp;?&amp; <span class="id">Hd</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#decomp_eqCon">decomp_eqCon</a></span> <span class="kwd">in</span> <span class="id">Hd</span> <span class="kwd">as</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hs</span> <span class="kwd">as</span> []; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="isConP">isConP</a></span> {<span class="id">D</span>:<span class="kwd">Type</span>} (<span class="id">P</span> : <span class="id">D</span> -&gt; <span class="kwd">Prop</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DStr">DStr</a></span> <span class="id">D</span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="isConPEps">isConPEps</a></span> : <span class="kwd">forall</span> <span class="id">x</span>, <span class="id">isConP</span> <span class="id">P</span> <span class="id">x</span> -&gt; <span class="id">isConP</span> <span class="id">P</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">x</span>)<br/>
| <span class="id"><a name="isConPnP">isConPnP</a></span>: <span class="kwd">forall</span> <span class="id">a</span> <span class="id">s</span>, <span class="id">isConP</span> <span class="id">P</span> <span class="id">s</span> -&gt; ~ <span class="id">P</span> <span class="id">a</span> -&gt; <span class="id">isConP</span> <span class="id">P</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>)<br/>
| <span class="id"><a name="isConPP">isConPP</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">s</span>, <span class="id">P</span> <span class="id">a</span> -&gt; <span class="id">isConP</span> <span class="id">P</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> <span class="id">s</span>).<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#isConP">isConP</a></span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="isConP_pred">isConP_pred</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">P</span>:<span class="id">D</span>-&gt;<span class="kwd">Prop</span>) <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#isConP">isConP</a></span> <span class="id">P</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#pred">pred</a></span> <span class="id">x</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#isConP">isConP</a></span> <span class="id">P</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="isConP_le_compat">isConP_le_compat</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">P</span> : <span class="id">D</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> &lt;= <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#isConP">isConP</a></span> <span class="id">P</span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#isConP">isConP</a></span> <span class="id">P</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hle</span> <span class="id">Hic</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">dependent</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">Hic</span>; <span class="id">intros</span>; <span class="id">inversion_clear</span> <span class="id">Hle</span>; <span class="id">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">n</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">dependent</span> <span class="id">y</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#isConP_pred">isConP_pred</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="isConP_eq_compat">isConP_eq_compat</a></span> : <span class="kwd">forall</span> <span class="id">D</span> (<span class="id">P</span>:<span class="id">D</span>-&gt;<span class="kwd">Prop</span>) (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> == <span class="id">y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#isConP">isConP</a></span> <span class="id">P</span> <span class="id">x</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#isConP">isConP</a></span> <span class="id">P</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#isConP_le_compat">isConP_le_compat</a></span> <span class="kwd">with</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">D</span> <span class="id">P</span> : (@<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#isConP">isConP</a></span> <span class="id">D</span> <span class="id">P</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>)) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span> <span class="kwd">as</span> <span class="id">isConP_eq_iff</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span>; <span class="id">split</span>; <span class="id">intro</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#isConP_eq_compat">isConP_eq_compat</a></span> <span class="kwd">with</span> <span class="id">x</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#isConP_eq_compat">isConP_eq_compat</a></span> <span class="kwd">with</span> <span class="id">y</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_is_cons">filter_is_cons</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">D</span> : <span class="kwd">Type</span>) (<span class="id">P</span> : <span class="id">D</span> -&gt; <span class="kwd">Prop</span>) <span class="id">Pdec</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span> <span class="id">P</span> <span class="id">Pdec</span> <span class="id">xs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#isConP">isConP</a></span> <span class="id">P</span> <span class="id">xs</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
&nbsp;&nbsp;<span class="id">intros</span> ???.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FILTER">FILTER</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#FIXP_fixp">FIXP_fixp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fixp_ind">fixp_ind</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span> <span class="id">seq</span> <span class="id">Hseq</span> <span class="id">s</span> <span class="id">Hic</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hic</span> <span class="kwd">as</span> (<span class="id">a</span>&amp;<span class="id">ls</span>&amp;<span class="id">Hlub</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_lubCon_inv">DS_lubCon_inv</a></span> <span class="kwd">in</span> <span class="id">Hlub</span> <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">tlc</span> &amp; <span class="id">n</span> &amp; <span class="id">Hn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hn</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> (<span class="id">Hseq</span> <span class="id">n</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_eq_compat">is_cons_eq_compat</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">a</span> (<span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>)).<br/>
&nbsp;&nbsp;- <span class="id">intros</span> * <span class="id">H</span>; <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#not_is_consBot">not_is_consBot</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span> <span class="id">f</span> <span class="id">Hf</span> <span class="id">s</span> <span class="id">Hic</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_is_cons">DScase_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hic</span> <span class="kwd">as</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> (<span class="id">x</span>&amp;<span class="id">s</span>'&amp;<span class="id">Hxs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hxs</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cbn</span> <span class="kwd">in</span> <span class="id">Hic</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span> <span class="kwd">in</span> <span class="id">Hic</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">Pdec</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#isConPP">isConPP</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#isConPnP">isConPnP</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="map_filter">map_filter</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) (<span class="id">P</span> : <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) <span class="id">Pdec</span> (<span class="id">P</span>' : <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) <span class="id">P</span>'<span class="id">dec</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span>, <span class="id">P</span> <span class="id">a</span> &lt;-&gt; <span class="id">P</span>' (<span class="id">f</span> <span class="id">a</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span> <span class="id">P</span> <span class="id">Pdec</span> <span class="id">xs</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span> <span class="id">P</span>' <span class="id">P</span>'<span class="id">dec</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">HPP</span>' <span class="id">xs</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span> <span class="id">P</span> <span class="id">Pdec</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#filter">filter</a></span> <span class="id">P</span>' <span class="id">P</span>'<span class="id">dec</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">xs</span>)).<br/>
&nbsp;&nbsp;3: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> ????(?&amp;?&amp;?&amp;?)??. <span class="id">repeat</span> <span class="id">esplit</span>; <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">xs</span>. <span class="id">intros</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">Hic</span> (<span class="id">s</span> &amp; <span class="id">Hx</span> &amp; <span class="id">Hy</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hic</span> <span class="kwd">as</span> [<span class="id">Hic</span>|<span class="id">Hic</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>, <span class="id">Hy</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hx</span>; <span class="id">setoid_rewrite</span> <span class="id">Hy</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#filter_is_cons">filter_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hic</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hx</span> <span class="id">Hy</span>. <span class="id">revert</span> <span class="id">xs</span> <span class="id">ys</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">Hic</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#eqEps">eqEps</a></span> <span class="kwd">in</span> *. <span class="id">setoid_rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#eqEps">eqEps</a></span>. <span class="id">eapply</span> <span class="id">IHHic</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span> <span class="kwd">in</span> *|- ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">Pdec</span> <span class="id">a</span>) <span class="kwd">as</span> [<span class="id">Hp</span>|<span class="id">Hnp</span>], (<span class="id">P</span>'<span class="id">dec</span> (<span class="id">f</span> <span class="id">a</span>)) <span class="kwd">as</span> [<span class="id">Hp</span>'|<span class="id">Hnp</span>']; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">HPP</span>' <span class="id">Hnp</span> <span class="id">Hp</span>'; <span class="id">exfalso</span>; <span class="id">firstorder</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHHic</span> <span class="id">xs</span> <span class="id">ys</span>) <span class="kwd">as</span> (? &amp; <span class="id">x</span> &amp;?&amp;?); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [| <span class="kwd">exists</span> <span class="id">x</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span> <span class="kwd">in</span> *; <span class="id">destruct</span> (<span class="id">Pdec</span> <span class="id">a</span>), (<span class="id">P</span>'<span class="id">dec</span> (<span class="id">f</span> <span class="id">a</span>)); <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">split</span>; [|<span class="kwd">exists</span> <span class="id">s</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">Pdec</span> <span class="id">a</span>) <span class="kwd">as</span> [<span class="id">Hp</span>|<span class="id">Hnp</span>], (<span class="id">P</span>'<span class="id">dec</span> (<span class="id">f</span> <span class="id">a</span>)) <span class="kwd">as</span> [<span class="id">Hp</span>'|<span class="id">Hnp</span>']; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id">now</span> <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">clear</span> - <span class="id">HPP</span>' <span class="id">Hp</span> <span class="id">Hnp</span>'; <span class="id">exfalso</span>; <span class="id">firstorder</span> 0.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#filter_is_cons">filter_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hic</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hx</span> <span class="id">Hy</span>. <span class="id">revert</span> <span class="id">xs</span> <span class="id">ys</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">s</span>) <span class="kwd">as</span> <span class="id">sm</span>. <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_refl_eq">Oeq_refl_eq</a></span> <span class="kwd">in</span> <span class="id">Heqsm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Heqsm</span>. <span class="id">revert</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">Hic</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#eqEps">eqEps</a></span> <span class="kwd">in</span> *. <span class="id">setoid_rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#eqEps">eqEps</a></span>. <span class="id">eapply</span> <span class="id">IHHic</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_eq_cons_elim">map_eq_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Heqsm</span> <span class="kwd">as</span> (<span class="id">b</span> &amp;?&amp; <span class="id">Hs</span> &amp;?&amp; <span class="id">Hmap</span>); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHHic</span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span> <span class="id">Hmap</span>) <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_refl">Oeq_refl</a></span> <span class="id">_</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_refl">Oeq_refl</a></span> <span class="id">_</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (?&amp; <span class="id">y</span> &amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [|<span class="kwd">exists</span> <span class="id">y</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">Pdec</span> <span class="id">b</span>) <span class="kwd">as</span> [<span class="id">Hp</span>|<span class="id">Hnp</span>], (<span class="id">P</span>'<span class="id">dec</span> (<span class="id">f</span> <span class="id">b</span>)) <span class="kwd">as</span> [<span class="id">Hp</span>'|<span class="id">Hnp</span>']; <span class="id">try</span> <span class="id">tauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">HPP</span>' <span class="id">Hp</span> <span class="id">Hnp</span>'; <span class="id">exfalso</span>; <span class="id">firstorder</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#map_eq_cons_elim">map_eq_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Heqsm</span> <span class="kwd">as</span> (<span class="id">b</span> &amp; <span class="id">t</span>&amp; <span class="id">Hs</span> &amp;?&amp;?); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [| <span class="kwd">exists</span> <span class="id">t</span>]; <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">destruct</span> (<span class="id">Pdec</span> <span class="id">b</span>) <span class="kwd">as</span> [<span class="id">Hp</span>|<span class="id">Hnp</span>], (<span class="id">P</span>'<span class="id">dec</span> (<span class="id">f</span> <span class="id">b</span>)) <span class="kwd">as</span> [<span class="id">Hp</span>'|<span class="id">Hnp</span>']; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">clear</span> - <span class="id">HPP</span>' <span class="id">Hnp</span> <span class="id">Hp</span>'; <span class="id">exfalso</span>; <span class="id">firstorder</span> 0.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="infinite_decomp">infinite_decomp</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">s</span> -&gt; <span class="kwd">exists</span> <span class="id">x</span> <span class="id">t</span>, <span class="id">s</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">t</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">t</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
&nbsp;&nbsp;<span class="id">intros</span> * [<span class="id">Hc</span> <span class="id">Hinf</span>].<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">Hc</span> <span class="kwd">as</span> [<span class="id">s</span>|].<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">IHHc</span> <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">t</span> &amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Rem">Rem</a></span> <span class="kwd">in</span> <span class="id">Hinf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCase_simpl">DSCase_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScaseEps">DScaseEps</a></span> <span class="kwd">in</span> <span class="id">Hinf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite_morph">infinite_morph</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#eqEps">eqEps</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> <span class="id">x</span>,<span class="id">t</span>. <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">transitivity</span> <span class="id">s</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#eqEps">eqEps</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">Hinf</span>. <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="infinite_cons">infinite_cons</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">x</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">rewrite</span> ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cons_infinite">cons_infinite</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D</span> <span class="id">x</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
&nbsp;&nbsp;<span class="id">destruct</span> 1.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> *.<br/>
Qed.</div>
<br/>
<br/>
<h3> Take the prefix of length min(n,length(s)) from a stream s </h3>
<span class="kwd">Fixpoint</span> <span class="id"><a name="take">take</a></span> {<span class="id">A</span>} (<span class="id">n</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#CTE">CTE</a></span> <span class="id">_</span> <span class="id">_</span> 0<br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP">APP</a></span> <span class="id">_</span> @2<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> <span class="id">_</span>) (<span class="id">take</span> <span class="id">n</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_eq">take_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">n</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">s</span> = <span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">s</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</span></div>
<div class="proofscript" id="proof58">
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">n</span>; <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_bot">take_bot</a></span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">n</span>, @<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">A</span> <span class="id">n</span> 0 == 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof59')">Proof.</span></div>
<div class="proofscript" id="proof59">
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">n</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_1">take_1</a></span> : <span class="kwd">forall</span> <span class="id">A</span> (<span class="id">x</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> 1 <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof60')">Proof.</span></div>
<div class="proofscript" id="proof60">
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">A</span> <span class="id">n</span> : (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>) ==&gt; @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">take_morph</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof61')">Proof.</span></div>
<div class="proofscript" id="proof61">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">auto</span>; <span class="id">intros</span> ?? <span class="id">Heq</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Heq</span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">IHn</span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">y</span>)); <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_Oeq">take_Oeq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">xs</span> <span class="id">ys</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>), (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">xs</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">ys</span>) -&gt; <span class="id">xs</span> == <span class="id">ys</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof62')">Proof.</span></div>
<div class="proofscript" id="proof62">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">V</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span>; <span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_1">take_1</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">intro</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">U</span>) <span class="kwd">as</span> (<span class="id">u</span> &amp; <span class="id">U</span>' &amp; <span class="id">Hu</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_is_cons">first_is_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_1">take_1</a></span>, <span class="id">Ht</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_1">take_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_first">is_cons_first</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">V</span>) <span class="kwd">as</span> (<span class="id">v</span> &amp; <span class="id">V</span>' &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_is_cons">first_is_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_1">take_1</a></span>, &lt;- <span class="id">Ht</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_1">take_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_first">is_cons_first</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Ht</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)), <span class="id">Hu</span>, <span class="id">Hv</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Ht</span> <span class="kwd">as</span> [].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_is_cons">take_is_cons</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>) <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">s</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof63')">Proof.</span></div>
<div class="proofscript" id="proof63">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;- <span class="id">contradict</span> <span class="id">Hc</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#not_is_consBot">not_is_consBot</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_cons">take_cons</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">n</span> (<span class="id">x</span> : <span class="id">A</span>) <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>) = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof64')">Proof.</span></div>
<div class="proofscript" id="proof64">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_map">take_map</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> : <span class="id">A</span> -&gt;<span class="id">B</span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">xs</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof65')">Proof.</span></div>
<div class="proofscript" id="proof65">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_bot">map_bot</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)), <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_map">rem_map</a></span>, <span class="id">IHn</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_map">app_map</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_rem">take_rem</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">n</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">x</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">y</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof66')">Proof.</span></div>
<div class="proofscript" id="proof66">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">n</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))) <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_eq_compat">rem_eq_compat</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_app_rem">rem_app_app_rem</a></span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_Ole">take_Ole</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">n</span> (<span class="id">x</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">x</span> &lt;= <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof67')">Proof.</span></div>
<div class="proofscript" id="proof67">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dbot">Dbot</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">IHn</span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_app_first">app_app_first</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_n_Ole">take_n_Ole</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">xs</span> <span class="id">ys</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>), (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">xs</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">ys</span>) -&gt; <span class="id">xs</span> &lt;= <span class="id">ys</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof68')">Proof.</span></div>
<div class="proofscript" id="proof68">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSle_rec_eq">DSle_rec_eq</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">U</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">V</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span>; <span class="id">intros</span> ? <span class="id">U</span> <span class="id">V</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">Hu</span> 1) <span class="kwd">as</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 4 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DSle_cons_elim">DSle_cons_elim</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> (?&amp; <span class="id">Hc</span> &amp; <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">V</span>) <span class="kwd">as</span> (<span class="id">v</span> &amp; <span class="id">V</span>' &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>; <span class="id">rewrite</span> <span class="id">Hc</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">V</span>'.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hv</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> []; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hv</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">intro</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hu</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)), <span class="id">Hv</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_le_simpl">Con_le_simpl</a></span> <span class="kwd">in</span> <span class="id">Hu</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Definition and specification of <span class="bracket"><span class="id">nrem</span></span> : <span class="bracket"><span class="id">n</span></span> applications of <span class="bracket"><span class="id">rem</span></span>.
    It is useful to show the productivity of stream functions.
    A function <span class="bracket"><span class="id">f</span></span> of a stream <span class="bracket"><span class="id">xs</span></span> is producive/length-preserving if
    for all n, <span class="bracket"><span class="id">is_cons</span> (<span class="id">nrem</span> <span class="id">n</span> <span class="id">xs</span>)</span> implies <span class="bracket"><span class="id">is_cons</span> (<span class="id">n_rem</span> <span class="id">n</span> (<span class="id">f</span> <span class="id">xs</span>))</span>.
 </div>
<span class="kwd">Section</span> <span class="id"><a name="Nrem">Nrem</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> : <span class="kwd">Type</span>}.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="nrem">nrem</a></span> (<span class="id">n</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id">xs</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt; <span class="id">nrem</span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nrem_S">nrem_S</a></span> : <span class="kwd">forall</span> <span class="id">n</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">xs</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</span></div>
<div class="proofscript" id="proof69">
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
Qed.</div>
<br/>
<div class="doc">On prend True pour n = 0 afin de simplifier les cas de base dans
    les preuves d'InftyProof (voir <span class="bracket"><span class="id">exp_n</span></span> par exemple). </div>
<span class="kwd">Definition</span> <span class="id"><a name="is_ncons">is_ncons</a></span> (<span class="id">n</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nrem_inf">nrem_inf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>), (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> <span class="id">n</span> <span class="id">s</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof70')">Proof.</span></div>
<div class="proofscript" id="proof70">
&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span> * <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> (<span class="id">Hc</span> 1).<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">Cof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> []; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">Hc</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inf_nrem">inf_nrem</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>), <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">s</span> -&gt; <span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> <span class="id">n</span> <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</span></div>
<div class="proofscript" id="proof71">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hf</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">dependent</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span> <span class="kwd">as</span> [|[]]; <span class="id">intros</span>; <span class="id">inversion</span> <span class="id">Hf</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHn</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nrem_inf_iff">nrem_inf_iff</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>), (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> <span class="id">n</span> <span class="id">s</span>) &lt;-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof72')">Proof.</span></div>
<div class="proofscript" id="proof72">
&nbsp;&nbsp;<span class="id">split</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_inf">nrem_inf</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#inf_nrem">inf_nrem</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_consn_DS_const">is_consn_DS_const</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">c</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>) <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id">c</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</span></div>
<div class="proofscript" id="proof73">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_ncons_DS_const">is_ncons_DS_const</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">c</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>) <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id">c</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</span></div>
<div class="proofscript" id="proof74">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span> <span class="kwd">as</span> [|[]]; <span class="id">simpl</span>; <span class="id">auto</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nrem_rem">nrem_rem</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>) <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> <span class="id">s</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</span></div>
<div class="proofscript" id="proof75">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nrem_nrem">nrem_nrem</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">xs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n1</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n2</span> <span class="id">xs</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> (<span class="id">n1</span> + <span class="id">n2</span>) <span class="id">xs</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</span></div>
<div class="proofscript" id="proof76">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n1</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_rem">nrem_rem</a></span>, <span class="id">IHn1</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_rem">nrem_rem</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="infinite_nrem">infinite_nrem</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> <span class="id">s</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</span></div>
<div class="proofscript" id="proof77">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">H</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span>; <span class="id">revert</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">intros</span>; <span class="id">inversion</span> <span class="id">H</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_nrem_eq">take_nrem_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n1</span> <span class="id">n2</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n1</span> <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n1</span> <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n2</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n1</span> <span class="id">x</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n2</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n1</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> (<span class="id">n1</span> + <span class="id">n2</span>) <span class="id">x</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> (<span class="id">n1</span> + <span class="id">n2</span>) <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof78')">Proof.</span></div>
<div class="proofscript" id="proof78">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n1</span>; <span class="id">intros</span> * <span class="id">Ht1</span> <span class="id">Ht2</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Peano.html#plus_Sn_m">plus_Sn_m</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">_</span>)) <span class="kwd">in</span> <span class="id">Ht1</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_eq_impl">app_eq_impl</a></span> <span class="kwd">with</span> (1 := <span class="id">Ht1</span>); <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_ncons_S">is_ncons_S</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>) <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">s</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> <span class="id">n</span> <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof79')">Proof.</span></div>
<div class="proofscript" id="proof79">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span> <span class="kwd">as</span> [|[]]; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_rem">nrem_rem</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_ncons_SS">is_ncons_SS</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <span class="id">xs</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof80')">Proof.</span></div>
<div class="proofscript" id="proof80">
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">split</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_ncons_is_cons">is_ncons_is_cons</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>) <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">s</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof81')">Proof.</span></div>
<div class="proofscript" id="proof81">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_rem">nrem_rem</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intro</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id">IHn</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_is_cons">rem_is_cons</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_ncons_cons">is_ncons_cons</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">x</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> <span class="id">n</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof82')">Proof.</span></div>
<div class="proofscript" id="proof82">
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">Hc</span>; <span class="id">rewrite</span> ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nrem_eq_compat">nrem_eq_compat</a></span> : <span class="kwd">forall</span> <span class="id">n</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>), <span class="id">s</span>==<span class="id">t</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> <span class="id">s</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> <span class="id">t</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof83')">Proof.</span></div>
<div class="proofscript" id="proof83">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">n</span> : (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>)) ==&gt; (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>)) <span class="kwd">as</span> <span class="id">nrem_eq_compat_morph</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof84')">Proof.</span></div>
<div class="proofscript" id="proof84">
&nbsp;&nbsp;<span class="id">exact</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_eq_compat">nrem_eq_compat</a></span> <span class="id">n</span>).<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">n</span> : (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>)) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span> <span class="kwd">as</span> <span class="id">is_ncons_morph</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof85')">Proof.</span></div>
<div class="proofscript" id="proof85">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">n</span>; <span class="id">now</span> <span class="id">rewrite</span> ?<span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_ncons_elim">is_ncons_elim</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">x1</span> <span class="id">xs</span>', <span class="id">xs</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x1</span> <span class="id">xs</span>' /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> <span class="id">n</span> <span class="id">xs</span>'.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof86')">Proof.</span></div>
<div class="proofscript" id="proof86">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons_is_cons">is_ncons_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">HH</span> <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hx</span>).<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">x</span>, <span class="id">xs</span>'; <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hc</span>; <span class="id">rewrite</span> <span class="id">Hx</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_ncons_elim2">is_ncons_elim2</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">xs</span>', <span class="id">xs</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x1</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x2</span> <span class="id">xs</span>') /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x2</span> <span class="id">xs</span>') /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> <span class="id">n</span> <span class="id">xs</span>'.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof87')">Proof.</span></div>
<div class="proofscript" id="proof87">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons_elim">is_ncons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> (<span class="id">x1</span> &amp; <span class="id">xx</span> &amp; <span class="id">Hx</span> &amp; <span class="id">Hc</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons_elim">is_ncons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> <span class="id">HH</span>; <span class="id">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> (<span class="id">x2</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hx</span>' &amp; <span class="id">Hc</span>').<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>' <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">x1</span>,<span class="id">x2</span>,<span class="id">xs</span>'.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>, <span class="id">Hx</span>'; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nrem_infinite">nrem_infinite</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">xs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">xs</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof88')">Proof.</span></div>
<div class="proofscript" id="proof88">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">H</span>; <span class="id">inversion</span> <span class="id">H</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Nrem">Nrem</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nrem_map">nrem_map</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) <span class="id">n</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">xs</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> <span class="id">xs</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof89')">Proof.</span></div>
<div class="proofscript" id="proof89">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_map">rem_map</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_ncons_map">is_ncons_map</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) <span class="id">s</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> <span class="id">n</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">s</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof90')">Proof.</span></div>
<div class="proofscript" id="proof90">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">destruct</span> <span class="id">n</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_map">nrem_map</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_map">is_cons_map</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="Alt_inf">Alt_inf</a></span>.<br/>
<div class="doc">example of usage </div>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="Alt_inf.alt">alt</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Alt_inf.alt_inf">alt_inf</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Alt_inf.alt">alt</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof91')">Proof.</span></div>
<div class="proofscript" id="proof91">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_inf">nrem_inf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span> <span class="kwd">as</span> [|[]]; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Alt_inf.alt">alt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Alt_inf.alt">alt</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_map">nrem_map</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Alt_inf">Alt_inf</a></span>.<br/>
<br/>
<br/>
<h2> Lifting stream predicates &amp; functions to environment of streams </h2>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="ENV">ENV</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">I</span> : <span class="kwd">Type</span>}.<br/>
<span class="kwd">Context</span> {<span class="id">SI</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.I">I</a></span> -&gt; <span class="kwd">Type</span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="all_cons">all_cons</a></span> (<span class="id">env</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id">env</span> <span class="id">x</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="all_cons_eq_compat">all_cons_eq_compat</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">env</span> <span class="id">env</span>' : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_cons">all_cons</a></span> <span class="id">env</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env</span> == <span class="id">env</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_cons">all_cons</a></span> <span class="id">env</span>'.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof92')">Proof.</span></div>
<div class="proofscript" id="proof92">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_cons">all_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hi</span> <span class="id">Heq</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, &lt;- <span class="id">Heq</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_cons">all_cons</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.I">I</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span>) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">all_cons_morph</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof93')">Proof.</span></div>
<div class="proofscript" id="proof93">
&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intros</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_cons_eq_compat">all_cons_eq_compat</a></span>; <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="all_infinite">all_infinite</a></span> (<span class="id">env</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id">env</span> <span class="id">x</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="all_infinite_eq_compat">all_infinite_eq_compat</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">env</span> <span class="id">env</span>' : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> <span class="id">env</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env</span> == <span class="id">env</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> <span class="id">env</span>'.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof94')">Proof.</span></div>
<div class="proofscript" id="proof94">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hi</span> <span class="id">Heq</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, &lt;- <span class="id">Heq</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.I">I</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span>) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">all_inf_morph</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof95')">Proof.</span></div>
<div class="proofscript" id="proof95">
&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intros</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite_eq_compat">all_infinite_eq_compat</a></span>; <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="all_infinite_all_cons">all_infinite_all_cons</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> <span class="id">env</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_cons">all_cons</a></span> <span class="id">env</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof96')">Proof.</span></div>
<div class="proofscript" id="proof96">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">env</span> <span class="id">Inf</span> <span class="id">x</span>; <span class="id">specialize</span> (<span class="id">Inf</span> <span class="id">x</span>); <span class="id">now</span> <span class="id">inversion</span> <span class="id">Inf</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="all_infinite_le_eq">all_infinite_le_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">env</span>', <span class="id">env</span> &lt;= <span class="id">env</span>' -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> <span class="id">env</span> -&gt; <span class="id">env</span> == <span class="id">env</span>'.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof97')">Proof.</span></div>
<div class="proofscript" id="proof97">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hle</span> <span class="id">Inf</span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_le_eq">infinite_le_eq</a></span>; <span class="id">auto</span>; <span class="id">apply</span> <span class="id">Hle</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Infinité sur un domaine </div>
<span class="kwd">Definition</span> <span class="id"><a name="infinite_dom">infinite_dom</a></span> (<span class="id">env</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span>) (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.I">I</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">l</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id">env</span> <span class="id">x</span>).<br/>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span>) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">inf_dom_morph</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof98')">Proof.</span></div>
<div class="proofscript" id="proof98">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> ?? <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">setoid_rewrite</span> <span class="id">Eq</span>.<br/>
Qed.</div>
<br/>
<br/>
<div class="doc">Couper la tête d'un environnement </div>
<span class="kwd">Definition</span> <span class="id"><a name="REM_env">REM_env</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DMAPi">DMAPi</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#REM">REM</a></span> <span class="id">_</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="REM_env_eq">REM_env_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">i</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">env</span> <span class="id">i</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id">env</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof99')">Proof.</span></div>
<div class="proofscript" id="proof99">
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="REM_env_bot">REM_env_bot</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> 0 == 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof100')">Proof.</span></div>
<div class="proofscript" id="proof100">
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_eq_bot">rem_eq_bot</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="REM_env_inf">REM_env_inf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> <span class="id">env</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">env</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof101')">Proof.</span></div>
<div class="proofscript" id="proof101">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hinf</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_eq">REM_env_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hinf</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">inversion</span> <span class="id">Hinf</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="REM_env_inf_dom">REM_env_inf_dom</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">env</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">env</span>) <span class="id">l</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof102')">Proof.</span></div>
<div class="proofscript" id="proof102">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hinf</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_eq">REM_env_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hinf</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">destruct</span> <span class="id">Hinf</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_env_eq_compat">rem_env_eq_compat</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span>, <span class="id">X</span> == <span class="id">Y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">Y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof103')">Proof.</span></div>
<div class="proofscript" id="proof103">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_eq">REM_env_eq</a></span>, &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">REM_env</span></span> itéré </div>
<span class="kwd">Fixpoint</span> <span class="id"><a name="nrem_env">nrem_env</a></span> (<span class="id">n</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> @<span class="id">_</span> <span class="id">nrem_env</span> <span class="id">n</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nrem_env_0">nrem_env_0</a></span> : <span class="kwd">forall</span> <span class="id">X</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> 0 <span class="id">X</span> = <span class="id">X</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof104')">Proof.</span></div>
<div class="proofscript" id="proof104">
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nrem_rem_env">nrem_rem_env</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">X</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">k</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>) = <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">k</span> <span class="id">X</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof105')">Proof.</span></div>
<div class="proofscript" id="proof105">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">k</span>; <span class="id">auto</span>; <span class="id">intros</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">IHk</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nrem_env_eq">nrem_env_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">X</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span>) <span class="id">i</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">n</span> <span class="id">X</span> <span class="id">i</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> (<span class="id">X</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof106')">Proof.</span></div>
<div class="proofscript" id="proof106">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp_simpl">fcont_comp_simpl</a></span>, &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_rem_env">nrem_rem_env</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id">IHn</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nrem_env_inf">nrem_env_inf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">X</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> <span class="id">X</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">n</span> <span class="id">X</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof107')">Proof.</span></div>
<div class="proofscript" id="proof107">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">HH</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_inf">REM_env_inf</a></span>, <span class="id">IHn</span>, <span class="id">HH</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nrem_env_inf_dom">nrem_env_inf_dom</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">X</span>:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span>) <span class="id">l</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">X</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_env">nrem_env</a></span> <span class="id">n</span> <span class="id">X</span>) <span class="id">l</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof108')">Proof.</span></div>
<div class="proofscript" id="proof108">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">HH</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_inf_dom">REM_env_inf_dom</a></span>, <span class="id">IHn</span>, <span class="id">HH</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Prendre la tête dans env1, la queue dans env2 </div>
<span class="kwd">Definition</span> <span class="id"><a name="APP_env">APP_env</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#Dprodi_DISTR">Dprodi_DISTR</a></span>; <span class="id">intro</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> ((<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP">APP</a></span> <span class="id">_</span> @2<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> <span class="id">_</span> <span class="id">i</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span>)) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ">PROJ</a></span> <span class="id">_</span> <span class="id">i</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
Defined.
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="APP_env_eq">APP_env_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">i</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id">env1</span> <span class="id">i</span>) (<span class="id">env2</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof109')">Proof.</span></div>
<div class="proofscript" id="proof109">
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_rem_env">app_rem_env</a></span> : <span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">s</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">s</span>) == <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof110')">Proof.</span></div>
<div class="proofscript" id="proof110">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_eq">REM_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_rem">app_rem</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_app_env">rem_app_env</a></span> : <span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_cons">all_cons</a></span> <span class="id">X</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> <span class="id">Y</span>) == <span class="id">Y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof111')">Proof.</span></div>
<div class="proofscript" id="proof111">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_eq">REM_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_app_env_le">rem_app_env_le</a></span> : <span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> <span class="id">Y</span>) &lt;= <span class="id">Y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof112')">Proof.</span></div>
<div class="proofscript" id="proof112">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_eq">REM_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app_le">rem_app_le</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rem_app_app_rem_env">rem_app_app_rem_env</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>) <span class="id">Y</span>)) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>) <span class="id">Y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof113')">Proof.</span></div>
<div class="proofscript" id="proof113">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> ?<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_eq">REM_env_eq</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_app_rem">rem_app_app_rem</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_app_env">app_app_env</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">Z</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> <span class="id">Y</span>) <span class="id">Z</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> <span class="id">Z</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof114')">Proof.</span></div>
<div class="proofscript" id="proof114">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_app">app_app</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="APP_env_bot">APP_env_bot</a></span> : <span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> 0 <span class="id">s</span> == 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof115')">Proof.</span></div>
<div class="proofscript" id="proof115">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_eq_bot">app_eq_bot</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_env_cons">app_env_cons</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_cons">all_cons</a></span> <span class="id">X</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_cons">all_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> <span class="id">Y</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof116')">Proof.</span></div>
<div class="proofscript" id="proof116">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_app">is_cons_app</a></span>, <span class="id">Hc</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_env_inf">app_env_inf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_cons">all_cons</a></span> <span class="id">X</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> <span class="id">Y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#all_infinite">all_infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> <span class="id">Y</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof117')">Proof.</span></div>
<div class="proofscript" id="proof117">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hc</span> <span class="id">Hinf</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> (?&amp;?&amp; -&gt;).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_env_inf_dom">app_env_inf_dom</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">X</span> <span class="id">l</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> <span class="id">Y</span> <span class="id">l</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> <span class="id">Y</span>) <span class="id">l</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof118')">Proof.</span></div>
<div class="proofscript" id="proof118">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_dom">infinite_dom</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">H</span> ?? <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#infinite_app">infinite_app</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H</span>, <span class="id">Hin</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Couper les queues </div>
<span class="kwd">Definition</span> <span class="id"><a name="FIRST_env">FIRST_env</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span> := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#DMAPi">DMAPi</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#FIRST">FIRST</a></span> <span class="id">_</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FIRST_env_eq">FIRST_env_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">x</span>, (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#FIRST_env">FIRST_env</a></span> <span class="id">X</span>) <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id">X</span> <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof119')">Proof.</span></div>
<div class="proofscript" id="proof119">
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="first_env_eq_compat">first_env_eq_compat</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span>, <span class="id">X</span> == <span class="id">Y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#FIRST_env">FIRST_env</a></span> <span class="id">X</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#FIRST_env">FIRST_env</a></span> <span class="id">Y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof120')">Proof.</span></div>
<div class="proofscript" id="proof120">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#FIRST_env_eq">FIRST_env_eq</a></span>, &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#PROJ_simpl">PROJ_simpl</a></span>, <span class="id">Heq</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="first_app_env">first_app_env</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#FIRST_env">FIRST_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> <span class="id">Y</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#FIRST_env">FIRST_env</a></span> <span class="id">X</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof121')">Proof.</span></div>
<div class="proofscript" id="proof121">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#FIRST_env_eq">FIRST_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_app_first">first_app_first</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="app_app_first_env">app_app_first_env</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#FIRST_env">FIRST_env</a></span> <span class="id">X</span>) <span class="id">Y</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> <span class="id">Y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof122')">Proof.</span></div>
<div class="proofscript" id="proof122">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#FIRST_env_eq">FIRST_env_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_app_first">app_app_first</a></span>.<br/>
Qed.</div>
<br/>
<br/>
<div class="doc">Un prédicat co-inductif pour décrire l'égalité d'environnements.
    Plus facile à manipuler dans les preuves mais nécessite souvent
    une hypothèse <span class="bracket"><span class="id">all_infinite</span> <span class="id">X</span></span> </div>
<span class="kwd">Section</span> <span class="id"><a name="ENV.Env_eq">Env_eq</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">CoInductive</span> <span class="id"><a name="env_eq">env_eq</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Ee">Ee</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env_eq</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">Y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#FIRST_env">FIRST_env</a></span> <span class="id">X</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#FIRST_env">FIRST_env</a></span> <span class="id">Y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env_eq</span> <span class="id">X</span> <span class="id">Y</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Oeq_env_eq">Oeq_env_eq</a></span> : <span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span>, <span class="id">X</span> == <span class="id">Y</span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#env_eq">env_eq</a></span> <span class="id">X</span> <span class="id">Y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof123')">Proof.</span></div>
<div class="proofscript" id="proof123">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Ee">Ee</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">Cof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="env_eq_Oeq">env_eq_Oeq</a></span> : <span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#env_eq">env_eq</a></span> <span class="id">X</span> <span class="id">Y</span> -&gt; <span class="id">X</span> == <span class="id">Y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof124')">Proof.</span></div>
<div class="proofscript" id="proof124">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">X</span> <span class="id">Y</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#env_eq">env_eq</a></span> <span class="id">X</span> <span class="id">Y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">U</span> == <span class="id">X</span> <span class="id">i</span> /\ <span class="id">V</span> == <span class="id">Y</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;3: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">X</span> &amp; <span class="id">Y</span> &amp; <span class="id">Heq</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">Heq</span> <span class="kwd">as</span> [?? <span class="id">He</span> <span class="id">Hf</span> <span class="id">Eq1</span> <span class="id">Eq2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;rewrite&nbsp;Eq1,&nbsp;Eq2&nbsp;in&nbsp;Hf.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_elim">Oprodi_eq_elim</a></span> <span class="kwd">with</span> (<span class="id">i</span> := <span class="id">i</span>) <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>, &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#FIRST_env_eq">FIRST_env_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">Y</span>); <span class="id">split</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="env_eq_ok">env_eq_ok</a></span> : <span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span>, <span class="id">X</span> == <span class="id">Y</span> &lt;-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#env_eq">env_eq</a></span> <span class="id">X</span> <span class="id">Y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof125')">Proof.</span></div>
<div class="proofscript" id="proof125">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Oeq_env_eq">Oeq_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#env_eq_Oeq">env_eq_Oeq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#env_eq">env_eq</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span>) ==&gt; @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span>) ==&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#iff">iff</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">env_eq_morph</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof126')">Proof.</span></div>
<div class="proofscript" id="proof126">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Eq1</span> * <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intros</span> <span class="id">Heq</span>%<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#env_eq_ok">env_eq_ok</a></span>; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#env_eq_ok">env_eq_ok</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.Env_eq">Env_eq</a></span>.<br/>
<br/>
<br/>
<div class="doc">Extract a (min(n, length s))-prefix of all streams s </div>
<span class="kwd">Fixpoint</span> <span class="id"><a name="take_env">take_env</a></span> <span class="id">n</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.Cpo_def_ext.html#CTE">CTE</a></span> <span class="id">_</span> <span class="id">_</span> 0<br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt; (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> @2<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span> <span class="id">_</span>) (<span class="id">take_env</span> <span class="id">n</span> @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_env_eq">take_env_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">X</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> <span class="id">X</span> = <span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof127')">Proof.</span></div>
<div class="proofscript" id="proof127">
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">n</span>; <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Opaque</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_env_bot">take_env_bot</a></span> : <span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> (0:<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span>) == 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof128')">Proof.</span></div>
<div class="proofscript" id="proof128">
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">n</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_eq">take_env_eq</a></span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_bot">APP_env_bot</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_env_le">take_env_le</a></span> : <span class="kwd">forall</span> <span class="id">n</span> <span class="id">env</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> <span class="id">env</span> &lt;= <span class="id">env</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof129')">Proof.</span></div>
<div class="proofscript" id="proof129">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_eq">take_env_eq</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dbot">Dbot</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Ole_trans">Ole_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">env</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">env</span>)); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_rem_env">app_rem_env</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_env_proj">take_env_proj</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">X</span> <span class="id">x</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> <span class="id">X</span> <span class="id">x</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> (<span class="id">X</span> <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof130')">Proof.</span></div>
<div class="proofscript" id="proof130">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_eq">take_env_eq</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>, <span class="id">IHn</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_eq">REM_env_eq</a></span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="id">Add</span> <span class="id">Parametric</span> <span class="id">Morphism</span> <span class="id">n</span> : (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">signature</span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span>) ==&gt; @<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq">Oeq</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Systems.html#DS_prod">DS_prod</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV.SI">SI</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">take_env_morph</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof131')">Proof.</span></div>
<div class="proofscript" id="proof131">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span> * <span class="id">H</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_eq">take_env_eq</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_env_1">take_env_1</a></span> : <span class="kwd">forall</span> <span class="id">X</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> 1 <span class="id">X</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#FIRST_env">FIRST_env</a></span> <span class="id">X</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof132')">Proof.</span></div>
<div class="proofscript" id="proof132">
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_env_Oeq">take_env_Oeq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">X</span> <span class="id">Y</span>, (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> <span class="id">X</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> <span class="id">Y</span>) -&gt; <span class="id">X</span> == <span class="id">Y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof133')">Proof.</span></div>
<div class="proofscript" id="proof133">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_Oeq">take_Oeq</a></span>; <span class="id">intro</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Ht</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_elim">Oprodi_eq_elim</a></span> <span class="kwd">with</span> (<span class="id">i</span> := <span class="id">i</span>) <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_proj">take_env_proj</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="take_rem_env">take_rem_env</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">X</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> <span class="id">X</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">X</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof134')">Proof.</span></div>
<div class="proofscript" id="proof134">
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;- <span class="id">induction</span> <span class="id">n</span>; <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_eq">take_env_eq</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_eq">take_env_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_eq">take_env_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_app_rem_env">rem_app_app_rem_env</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_eq">take_env_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_app_env_le">rem_app_env_le</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">on peut éliminer <span class="bracket"><span class="id">REM_env</span> (<span class="id">APP_env</span> <span class="id">X</span> <span class="id">Y</span>)</span> s'il est sous un <span class="bracket"><span class="id">APP_env</span> <span class="id">X</span></span> </div>
<span class="kwd">Lemma</span> <span class="id"><a name="app_rem_take_env">app_rem_take_env</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">X</span> <span class="id">Y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env">REM_env</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> <span class="id">Y</span>))) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env">APP_env</a></span> <span class="id">X</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env">take_env</a></span> <span class="id">n</span> <span class="id">Y</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof135')">Proof.</span></div>
<div class="proofscript" id="proof135">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oprodi_eq_intro">Oprodi_eq_intro</a></span>; <span class="id">intro</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> ?<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#APP_env_eq">APP_env_eq</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#REM_env_eq">REM_env_eq</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_env_proj">take_env_proj</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id">V</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="kwd">exists</span> <span class="id">X</span> <span class="id">Y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">X</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">X</span> <span class="id">Y</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">X</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">Y</span>)).<br/>
&nbsp;&nbsp;3: <span class="id">right</span>; <span class="kwd">exists</span> (<span class="id">X</span> <span class="id">i</span>), (<span class="id">Y</span> <span class="id">i</span>); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> [<span class="id">Heq</span> | (<span class="id">X</span> &amp; <span class="id">Y</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>)].<br/>
&nbsp;&nbsp;{ <span class="id">setoid_rewrite</span> <span class="id">Heq</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">X</span>) <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">X</span>' &amp; <span class="id">Hx</span>).<br/>
&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span>; <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>; [<span class="id">rewrite</span> &lt;- <span class="id">Hu</span>| <span class="id">rewrite</span> &lt;- <span class="id">Hv</span>]; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span> <span class="kwd">in</span> <span class="id">Hu</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span> <span class="kwd">in</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">setoid_rewrite</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ENV">ENV</a></span>.<br/>
<br/>
<br/>
<h2> First definition of zip using three functions </h2>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<h2> ZIP primitive, combines elements of two streams </h2>
<span class="kwd">Section</span> <span class="id"><a name="Zip">Zip</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">D</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="Zip.bop">bop</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.B">B</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.D">D</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="zipf">zipf</a></span> : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.B">B</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.D">D</a></span>) -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.B">B</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.D">D</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.A">A</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.D">D</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>. <span class="id">intro</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp2">fcont_comp2</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE">DSCASE</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.B">B</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.D">D</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ford_fcont_shift">ford_fcont_shift</a></span>. <span class="id">intro</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp">fcont_comp</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#CONS">CONS</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.bop">bop</a></span> <span class="id">a</span> <span class="id">b</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#fcont_comp3">fcont_comp3</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#ID">ID</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span> @<span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FST">FST</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#SND">SND</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;Defined.
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zipf_eq">zipf_eq</a></span> : <span class="kwd">forall</span> <span class="id">f</span> <span class="id">u</span> <span class="id">U</span> <span class="id">v</span> <span class="id">V</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zipf">zipf</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">u</span> <span class="id">U</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">v</span> <span class="id">V</span>) = <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.bop">bop</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">f</span> <span class="id">U</span> <span class="id">V</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof136')">Proof.</span></div>
<div class="proofscript" id="proof136">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zipf">zipf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DSCASE_simpl">DSCASE_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> 2 <span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_cons">DScase_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="ZIP">ZIP</a></span> : (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.B">B</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.D">D</a></span>) := <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP">FIXP</a></span> <span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zipf">zipf</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zip_cons">zip_cons</a></span> : <span class="kwd">forall</span> <span class="id">u</span> <span class="id">U</span> <span class="id">v</span> <span class="id">V</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">u</span> <span class="id">U</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">v</span> <span class="id">V</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.bop">bop</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">U</span> <span class="id">V</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof137')">Proof.</span></div>
<div class="proofscript" id="proof137">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zipf_eq">zipf_eq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span> : <span class="id">cpodb</span>. <br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zipf_bot1">zipf_bot1</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">xs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zipf">zipf</a></span> <span class="id">f</span> 0 <span class="id">xs</span> == 0.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof138')">Proof.</span></div>
<div class="proofscript" id="proof138">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zipf">zipf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zipf_bot2">zipf_bot2</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">xs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zipf">zipf</a></span> <span class="id">f</span> <span class="id">xs</span> 0 == 0.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof139')">Proof.</span></div>
<div class="proofscript" id="proof139">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zipf">zipf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DScase_bot2">DScase_bot2</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DScase_bot_eq">DScase_bot_eq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zipf_is_cons">zipf_is_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zipf">zipf</a></span> <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">ys</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof140')">Proof.</span></div>
<div class="proofscript" id="proof140">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hic</span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_is_cons">DScase_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hic</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hic</span> <span class="kwd">as</span> (<span class="id">a</span>&amp;<span class="id">s</span>&amp;<span class="id">Hic</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_eq_cons_elim">DScase_eq_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hic</span> <span class="kwd">as</span> (<span class="id">b</span>&amp;<span class="id">s</span>'&amp;<span class="id">Hxs</span>&amp;<span class="id">Hic</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_eq_compat">is_cons_eq_compat</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DScase_is_cons">DScase_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hic</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zip_bot1">zip_bot1</a></span> : <span class="kwd">forall</span> <span class="id">xs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> 0 <span class="id">xs</span> == 0.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof141')">Proof.</span></div>
<div class="proofscript" id="proof141">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zipf_bot1">zipf_bot1</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zip_bot2">zip_bot2</a></span> : <span class="kwd">forall</span> <span class="id">xs</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">xs</span> 0 == 0.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof142')">Proof.</span></div>
<div class="proofscript" id="proof142">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zipf_bot2">zipf_bot2</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zip_is_cons">zip_is_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">xs</span> <span class="id">ys</span>) -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">ys</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof143')">Proof.</span></div>
<div class="proofscript" id="proof143">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hic</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#FIXP_eq">FIXP_eq</a></span> <span class="kwd">in</span> <span class="id">Hic</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zipf_is_cons">zipf_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hic</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_zip">is_cons_zip</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">xs</span> <span class="id">ys</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof144')">Proof.</span></div>
<div class="proofscript" id="proof144">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * [<span class="id">Cx</span> <span class="id">Cy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Cx</span> <span class="kwd">as</span> (?&amp;?&amp;-&gt;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Cy</span> <span class="kwd">as</span> (?&amp;?&amp;-&gt;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="rem_zip">rem_zip</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">xs</span> <span class="id">ys</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">ys</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof145')">Proof.</span></div>
<div class="proofscript" id="proof145">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">xs</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">ys</span>)); <span class="id">eauto</span> 4.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * (?&amp;?&amp;?&amp;?) <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">xs</span> &amp; <span class="id">ys</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">ys</span>) <span class="kwd">as</span> [<span class="id">Cx</span> <span class="id">Cy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [<span class="id">Hc</span>|<span class="id">Hc</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hu</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_is_cons">rem_is_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> []; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_is_cons">rem_is_cons</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Cx</span> <span class="kwd">as</span> (?&amp; <span class="id">xs</span>' &amp; <span class="id">Hx</span>), <span class="id">Cy</span> <span class="kwd">as</span> (?&amp; <span class="id">ys</span>' &amp; <span class="id">Hy</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>, <span class="id">Hy</span> <span class="kwd">in</span> *; <span class="id">clear</span> <span class="id">Hx</span> <span class="id">Hy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span>' /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">ys</span>') <span class="kwd">as</span> [<span class="id">Cx</span> <span class="id">Cy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [<span class="id">Hc</span>|<span class="id">Hc</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hu</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Cx</span> <span class="kwd">as</span> (?&amp; <span class="id">xs</span>'' &amp; <span class="id">Hx</span>), <span class="id">Cy</span> <span class="kwd">as</span> (?&amp; <span class="id">ys</span>'' &amp; <span class="id">Hy</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>, <span class="id">Hy</span>, <span class="id">Hu</span>, <span class="id">Hv</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">xs</span>', <span class="id">ys</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>, <span class="id">Hx</span>, <span class="id">Hy</span>; <span class="id">now</span> <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="nrem_zip">nrem_zip</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">xs</span> <span class="id">ys</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem">nrem</a></span> <span class="id">n</span> <span class="id">ys</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof146')">Proof.</span></div>
<div class="proofscript" id="proof146">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 3 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#nrem_S">nrem_S</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_zip">rem_zip</a></span>, <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="first_zip">first_zip</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">xs</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">ys</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof147')">Proof.</span></div>
<div class="proofscript" id="proof147">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">xs</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">ys</span>)); <span class="id">eauto</span> 4.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> * (?&amp;?&amp;?&amp;?) <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">xs</span> &amp; <span class="id">ys</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">ys</span>) <span class="kwd">as</span> [<span class="id">Cx</span> <span class="id">Cy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [<span class="id">Hc</span>|<span class="id">Hc</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hu</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_is_cons">first_is_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> []; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Cx</span> <span class="kwd">as</span> (?&amp; <span class="id">xs</span>' &amp; <span class="id">Hx</span>), <span class="id">Cy</span> <span class="kwd">as</span> (?&amp; <span class="id">ys</span>' &amp; <span class="id">Hy</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>, <span class="id">Hy</span> <span class="kwd">in</span> *; <span class="id">clear</span> <span class="id">Hx</span> <span class="id">Hy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_bot1">zip_bot1</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> 0,0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_eq_bot">first_eq_bot</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_bot1">zip_bot1</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zip_app">zip_app</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">xs1</span> <span class="id">xs2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.A">A</a></span>) (<span class="id">ys1</span> <span class="id">ys2</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.B">B</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">xs1</span> <span class="id">ys1</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">xs2</span> <span class="id">ys2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">xs1</span> <span class="id">xs2</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">ys1</span> <span class="id">ys2</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof148')">Proof.</span></div>
<div class="proofscript" id="proof148">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id">V</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">Y1</span> <span class="id">Y2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">X1</span> <span class="id">Y1</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">X2</span> <span class="id">Y2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">X1</span> <span class="id">X2</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">Y1</span> <span class="id">Y2</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;3: <span class="id">eauto</span> 12.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> [<span class="id">HH</span> | (<span class="id">X1</span> &amp; <span class="id">X2</span> &amp; <span class="id">Y1</span> &amp; <span class="id">Y2</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">setoid_rewrite</span> <span class="id">HH</span>. <span class="id">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">X1</span>) <span class="kwd">as</span> (<span class="id">vx1</span> &amp; <span class="id">X1</span>' &amp; <span class="id">Hx1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Hv</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">Y1</span>) <span class="kwd">as</span> (<span class="id">vy1</span> &amp; <span class="id">Y1</span>' &amp; <span class="id">Hy1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">destruct</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">Hv</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hx1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hy1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span>, 3 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zip_uncons">zip_uncons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">r</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">xs</span> <span class="id">ys</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">r</span> <span class="id">rs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">x</span> <span class="id">xs</span>' <span class="id">y</span> <span class="id">ys</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">ys</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">y</span> <span class="id">ys</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">rs</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">xs</span>' <span class="id">ys</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">r</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.bop">bop</a></span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof149')">Proof.</span></div>
<div class="proofscript" id="proof149">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">HZ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">ys</span>) <span class="kwd">as</span> [<span class="id">Hcx</span> <span class="id">Hcy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>; <span class="id">rewrite</span> <span class="id">HZ</span>; <span class="id">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hcx</span> <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hx</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hcy</span> <span class="kwd">as</span> (<span class="id">y</span> &amp; <span class="id">ys</span>' &amp; <span class="id">Hy</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>, <span class="id">Hy</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span> <span class="kwd">in</span> <span class="id">HZ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Con_eq_simpl">Con_eq_simpl</a></span> <span class="kwd">in</span> <span class="id">HZ</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="kwd">exists</span> <span class="id">x</span>,<span class="id">xs</span>',<span class="id">y</span>,<span class="id">ys</span>'.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zip_inf">zip_inf</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">U</span> <span class="id">V</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">U</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">V</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">U</span> <span class="id">V</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof150')">Proof.</span></div>
<div class="proofscript" id="proof150">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">InfU</span> <span class="id">InfV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">U</span> <span class="id">V</span>) <span class="kwd">as</span> <span class="id">t</span> <span class="id">eqn</span>:<span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Oeq_refl_eq">Oeq_refl_eq</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">InfU</span> <span class="id">InfV</span> <span class="id">Ht</span>. <span class="id">revert</span> <span class="id">t</span> <span class="id">U</span> <span class="id">V</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">InfU</span> <span class="kwd">as</span> [<span class="id">Cu</span>], <span class="id">InfV</span> <span class="kwd">as</span> [<span class="id">Cv</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Cu</span> <span class="kwd">as</span> (?&amp; <span class="id">U</span>' &amp; <span class="id">Hu</span>), <span class="id">Cv</span> <span class="kwd">as</span> (?&amp; <span class="id">V</span>' &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">Cof</span> <span class="kwd">with</span> (<span class="id">U</span> := <span class="id">U</span>') (<span class="id">V</span> := <span class="id">V</span>'); <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">Ht</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="inf_zip">inf_zip</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">s</span> <span class="id">t</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">s</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">t</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof151')">Proof.</span></div>
<div class="proofscript" id="proof151">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">revert</span> <span class="id">Hf</span>; <span class="id">revert</span> <span class="id">s</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="kwd">cofix</span> <span class="id">Cof</span>; <span class="id">intros</span> * <span class="id">Hf</span>; <span class="id">inversion_clear</span> <span class="id">Hf</span> <span class="kwd">as</span> [<span class="id">Hc</span> <span class="id">Hinf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> [(?&amp;?&amp; <span class="id">Hs</span>)%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> (?&amp;?&amp;<span class="id">Ht</span>)%<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_zip">rem_zip</a></span> <span class="kwd">in</span> <span class="id">Hinf</span>; <span class="id">constructor</span>; <span class="id">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#cons_is_cons">cons_is_cons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zip_const">zip_const</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">V</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id">a</span>) <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.bop">bop</a></span> <span class="id">a</span>) <span class="id">V</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof152')">Proof.</span></div>
<div class="proofscript" id="proof152">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id">a</span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.bop">bop</a></span> <span class="id">a</span>) <span class="id">xs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;3: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> ????(?&amp;?&amp;?&amp;?)??. <span class="id">repeat</span> <span class="id">esplit</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">clear</span>. <span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">xs</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span>) <span class="kwd">as</span> <span class="id">Hcx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [<span class="id">Hc</span>|<span class="id">Hc</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>; <span class="id">tauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hcx</span> <span class="kwd">as</span> (<span class="id">vx</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hx</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span> <span class="kwd">in</span> <span class="id">Hu</span>, <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span> <span class="kwd">in</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span> <span class="kwd">in</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> <span class="id">xs</span>'. <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zip_const2">zip_const2</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">U</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">U</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id">a</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="kwd">fun</span> <span class="id">u</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.bop">bop</a></span> <span class="id">u</span> <span class="id">a</span>) <span class="id">U</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof153')">Proof.</span></div>
<div class="proofscript" id="proof153">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">xs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#MAP">MAP</a></span> (<span class="kwd">fun</span> <span class="id">u</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip.bop">bop</a></span> <span class="id">u</span> <span class="id">a</span>) <span class="id">xs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;3: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> ????(?&amp;?&amp;?&amp;?)??. <span class="id">repeat</span> <span class="id">esplit</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">clear</span>. <span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">xs</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span>) <span class="kwd">as</span> <span class="id">Hcx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [<span class="id">Hc</span>|<span class="id">Hc</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>; <span class="id">tauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hcx</span> <span class="kwd">as</span> (<span class="id">vx</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hx</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span> <span class="kwd">in</span> <span class="id">Hu</span>, <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#MAP_map">MAP_map</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_eq_cons">map_eq_cons</a></span> <span class="kwd">in</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span> <span class="kwd">in</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> <span class="id">xs</span>'. <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="take_zip">take_zip</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">xs</span> <span class="id">ys</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">ys</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof154')">Proof.</span></div>
<div class="proofscript" id="proof154">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_bot1">zip_bot1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> 3 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_app">zip_app</a></span>, &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#APP_simpl">APP_simpl</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_zip">rem_zip</a></span>, <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zip_take_const">zip_take_const</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">xs</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id">c</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id">c</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof155')">Proof.</span></div>
<div class="proofscript" id="proof155">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_bot1">zip_bot1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_eq">take_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span> <span class="kwd">at</span> 3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span> <span class="id">_</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const">DS_const</a></span> <span class="id">c</span>)), &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_const_eq">DS_const_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;- 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_app">zip_app</a></span>, <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="is_ncons_zip">is_ncons_zip</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> <span class="id">n</span> <span class="id">xs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> <span class="id">n</span> <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons">is_ncons</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">xs</span> <span class="id">ys</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof156')">Proof.</span></div>
<div class="proofscript" id="proof156">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span> <span class="kwd">as</span> [|[]]; <span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">Cx</span> <span class="id">Cy</span>; <span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_zip">is_cons_zip</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons_is_cons">is_ncons_is_cons</a></span> <span class="kwd">in</span> <span class="id">Cx</span> <span class="kwd">as</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_rem">is_cons_rem</a></span> <span class="kwd">in</span> <span class="id">Hx</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp; <span class="id">Hx</span>); <span class="id">rewrite</span> <span class="id">Hx</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_ncons_is_cons">is_ncons_is_cons</a></span> <span class="kwd">in</span> <span class="id">Cy</span> <span class="kwd">as</span> <span class="id">Hy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_rem">is_cons_rem</a></span> <span class="kwd">in</span> <span class="id">Hy</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp; <span class="id">Hy</span>); <span class="id">rewrite</span> <span class="id">Hy</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHn</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip">Zip</a></span>.<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_bot1">zip_bot1</a></span> @<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_bot2">zip_bot2</a></span> : <span class="id">cpodb</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="zip_ext">zip_ext</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> (<span class="id">f</span> <span class="id">g</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> = <span class="id">g</span> <span class="id">a</span> <span class="id">b</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">g</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof157')">Proof.</span></div>
<div class="proofscript" id="proof157">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hfg</span> <span class="id">x</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span> /\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">g</span> <span class="id">x</span> <span class="id">y</span>); <span class="id">eauto</span> 4.<br/>
&nbsp;&nbsp;{ <span class="id">intros</span> * ? <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">clear</span> - <span class="id">Hfg</span>; <span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">xs</span> &amp; <span class="id">ys</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">xs</span>) <span class="kwd">as</span> (<span class="id">x</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hxs</span>).<br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [?%<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>|?%<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>]. }<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (@<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="id">_</span> <span class="id">ys</span>) <span class="kwd">as</span> (<span class="id">y</span> &amp; <span class="id">ys</span>' &amp; <span class="id">Hys</span>).<br/>
&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [?%<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>|?%<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>]. }<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hxs</span>, <span class="id">Hys</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">split</span>;[|<span class="kwd">exists</span> <span class="id">xs</span>', <span class="id">ys</span>']; <span class="id">now</span> <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first_cons">first_cons</a></span>, ?<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>, ?<span class="id">Hfg</span>.<br/>
Qed.</div>
<br/>
<br/>
<h2> Facts about zip, map  </h2>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="zip_map">zip_map</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> (<span class="id">op</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span>) <span class="id">B</span>' (<span class="id">f</span> : <span class="id">B</span>' -&gt; <span class="id">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">op</span> <span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">ys</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id">op</span> <span class="id">x</span> (<span class="id">f</span> <span class="id">y</span>)) <span class="id">xs</span> <span class="id">ys</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof158')">Proof.</span></div>
<div class="proofscript" id="proof158">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_bisimulation">DS_bisimulation</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">op</span> <span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id">op</span> <span class="id">x</span> (<span class="id">f</span> <span class="id">y</span>)) <span class="id">xs</span> <span class="id">ys</span>).<br/>
&nbsp;&nbsp;4: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span> ????(?&amp;?&amp;?&amp;?)??. <span class="id">repeat</span> <span class="id">esplit</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">clear</span> <span class="id">xs</span> <span class="id">ys</span>. <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Hcons</span> (<span class="id">xs</span> &amp; <span class="id">ys</span> &amp; <span class="id">Hx</span> &amp; <span class="id">Hy</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hcons</span> <span class="kwd">as</span> [<span class="id">Hcons</span>|<span class="id">Hcons</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>,<span class="id">Hy</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hcons</span> <span class="kwd">as</span> (<span class="id">Hc1</span> &amp; <span class="id">Hc2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc1</span> <span class="kwd">as</span> (?&amp;?&amp;-&gt;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc2</span> <span class="kwd">as</span> (?&amp;?&amp;-&gt;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;- <span class="id">clear</span> <span class="id">xs</span> <span class="id">ys</span>. <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Hcons</span> (<span class="id">xs</span> &amp; <span class="id">ys</span> &amp; <span class="id">Hx</span> &amp; <span class="id">Hy</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hcons</span> <span class="kwd">as</span> [<span class="id">Hcons</span>|<span class="id">Hcons</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">ys</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>,<span class="id">Hy</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hcons</span> <span class="kwd">as</span> (<span class="id">Hc1</span> &amp; <span class="id">Hc2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">try</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc1</span> <span class="kwd">as</span> (?&amp;?&amp;-&gt;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc2</span> <span class="kwd">as</span> (?&amp;?&amp;-&gt;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="map_zip">map_zip</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">D</span> (<span class="id">op</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span>) (<span class="id">f</span> : <span class="id">C</span> -&gt; <span class="id">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id">f</span> (<span class="id">op</span> <span class="id">x</span> <span class="id">y</span>)) <span class="id">xs</span> <span class="id">ys</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">op</span> <span class="id">xs</span> <span class="id">ys</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof159')">Proof.</span></div>
<div class="proofscript" id="proof159">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS_bisimulation">DS_bisimulation</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id">f</span> (<span class="id">op</span> <span class="id">x</span> <span class="id">y</span>)) <span class="id">xs</span> <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">op</span> <span class="id">xs</span> <span class="id">ys</span>)).<br/>
&nbsp;&nbsp;4: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span> ????(?&amp;?&amp;?&amp;?)??. <span class="id">repeat</span> <span class="id">esplit</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">clear</span> <span class="id">xs</span> <span class="id">ys</span>. <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Hcons</span> (<span class="id">xs</span> &amp; <span class="id">ys</span> &amp; <span class="id">Hx</span> &amp; <span class="id">Hy</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hcons</span> <span class="kwd">as</span> [<span class="id">Hcons</span>|<span class="id">Hcons</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>,<span class="id">Hy</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[| <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hcons</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hcons</span> <span class="kwd">as</span> (<span class="id">Hc1</span> &amp; <span class="id">Hc2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc1</span> <span class="kwd">as</span> (?&amp;?&amp;-&gt;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc2</span> <span class="kwd">as</span> (?&amp;?&amp;-&gt;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
&nbsp;&nbsp;- <span class="id">clear</span> <span class="id">xs</span> <span class="id">ys</span>. <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Hcons</span> (<span class="id">xs</span> &amp; <span class="id">ys</span> &amp; <span class="id">Hx</span> &amp; <span class="id">Hy</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hcons</span> <span class="kwd">as</span> [<span class="id">Hcons</span>|<span class="id">Hcons</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>), (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">ys</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>,<span class="id">Hy</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[| <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#map_is_cons">map_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hcons</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hcons</span> <span class="kwd">as</span> (<span class="id">Hc1</span> &amp; <span class="id">Hc2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc1</span> <span class="kwd">as</span> (?&amp;?&amp;-&gt;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc2</span> <span class="kwd">as</span> (?&amp;?&amp;-&gt;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="zip_comm">zip_comm</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="id">B</span>) <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">f</span> <span class="id">x</span> <span class="id">y</span> = <span class="id">f</span> <span class="id">y</span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">f</span> <span class="id">ys</span> <span class="id">xs</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof160')">Proof.</span></div>
<div class="proofscript" id="proof160">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Fcomm</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">xs</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">V</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">f</span> <span class="id">ys</span> <span class="id">xs</span>); <span class="id">eauto</span> 4.<br/>
&nbsp;&nbsp;- <span class="id">intros</span> * (?&amp;?&amp;?&amp;?) <span class="id">Eq1</span> <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">Eq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">clear</span> - <span class="id">Fcomm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">xs</span> &amp; <span class="id">ys</span> &amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">ys</span>) <span class="kwd">as</span> [<span class="id">Hcx</span> <span class="id">Hcy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span> <span class="kwd">in</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [<span class="id">Hc</span>|<span class="id">Hc</span>]; <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span> <span class="kwd">in</span> <span class="id">Hc</span>; <span class="id">tauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hcx</span> <span class="kwd">as</span> (<span class="id">vx</span> &amp; <span class="id">xs</span>' &amp; <span class="id">Hx</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hcy</span> <span class="kwd">as</span> (<span class="id">vy</span> &amp; <span class="id">ys</span>' &amp; <span class="id">Hy</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hx</span>, <span class="id">Hy</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> <span class="id">xs</span>',<span class="id">ys</span>'. <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="zip_zip">zip_zip</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">D1</span> <span class="id">D2</span> <span class="id">D3</span> <span class="id">D4</span> <span class="id">D5</span>,<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">f</span>:<span class="id">D1</span>-&gt;<span class="id">D4</span>-&gt;<span class="id">D5</span>) (<span class="id">g</span>:<span class="id">D2</span>-&gt;<span class="id">D3</span>-&gt;<span class="id">D4</span>) <span class="id">U</span> <span class="id">V</span> <span class="id">W</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">f</span> <span class="id">U</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">g</span> <span class="id">V</span> <span class="id">W</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="kwd">fun</span> <span class="id">h</span> <span class="id">w</span> =&gt; <span class="id">h</span> <span class="id">w</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="kwd">fun</span> <span class="id">z</span> =&gt; (<span class="id">f</span> <span class="id">x</span> (<span class="id">g</span> <span class="id">y</span> <span class="id">z</span>))) <span class="id">U</span> <span class="id">V</span>) <span class="id">W</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof161')">Proof.</span></div>
<div class="proofscript" id="proof161">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">R</span> <span class="id">L</span> =&gt; <span class="kwd">exists</span> <span class="id">U</span> <span class="id">V</span> <span class="id">W</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">R</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">f</span> <span class="id">U</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> <span class="id">g</span> <span class="id">V</span> <span class="id">W</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">L</span> ==  <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="kwd">fun</span> <span class="id">h</span> <span class="id">w</span> =&gt; <span class="id">h</span> <span class="id">w</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> =&gt; <span class="id">f</span> <span class="id">x</span> (<span class="id">g</span> <span class="id">y</span> <span class="id">z</span>)) <span class="id">U</span> <span class="id">V</span>) <span class="id">W</span>).<br/>
&nbsp;&nbsp;3: <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span> ????(?&amp;?&amp;?&amp;?) <span class="id">E1</span> <span class="id">E2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">E1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> &lt;- <span class="id">E2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">R</span> <span class="id">L</span> <span class="id">Hc</span> (<span class="id">U</span> &amp; <span class="id">V</span> &amp; <span class="id">W</span> &amp; <span class="id">Hr</span> &amp; <span class="id">Hl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hc</span> <span class="kwd">as</span> [<span class="id">Hc</span> | <span class="id">Hc</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> (<span class="id">r</span> &amp; <span class="id">rs</span> &amp; <span class="id">Hrs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hrs</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_uncons">zip_uncons</a></span> <span class="kwd">in</span> <span class="id">Hr</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp;?&amp; <span class="id">Hu</span> &amp; <span class="id">Hz</span> &amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_uncons">zip_uncons</a></span> <span class="kwd">in</span> <span class="id">Hz</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp;?&amp; <span class="id">Hv</span> &amp; <span class="id">Hw</span> &amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>, <span class="id">Hw</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hrs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> (<span class="id">f</span> <span class="id">x</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> 7.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons_elim">is_cons_elim</a></span> <span class="kwd">in</span> <span class="id">Hc</span> <span class="kwd">as</span> (<span class="id">l</span> &amp; <span class="id">ls</span> &amp; <span class="id">Hls</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hls</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Classes.RelationClasses.html#symmetry">symmetry</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_uncons">zip_uncons</a></span> <span class="kwd">in</span> <span class="id">Hl</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp;?&amp; <span class="id">Hz</span> &amp; <span class="id">Hw</span> &amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_uncons">zip_uncons</a></span> <span class="kwd">in</span> <span class="id">Hz</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp;?&amp; <span class="id">Hu</span> &amp; <span class="id">Hv</span> &amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hu</span>, <span class="id">Hv</span>, <span class="id">Hw</span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> 2 (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_cons">rem_cons</a></span> (<span class="id">f</span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">cpodb</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> 7.<br/>
Qed.</div>
<br/>
<br/>
<h2> ZIP3 synchronizes three streams </h2>
<span class="kwd">Section</span> <span class="id"><a name="Zip3">Zip3</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">D</span> : <span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="Zip3.op">op</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip3.A">A</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip3.B">B</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip3.C">C</a></span> -&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip3.D">D</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="ZIP3">ZIP3</a></span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip3.A">A</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip3.B">B</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip3.C">C</a></span> -<span class="id">C</span>-&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip3.D">D</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#curry">curry</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="kwd">fun</span> <span class="id">f</span> <span class="id">x</span> =&gt; <span class="id">f</span> <span class="id">x</span>) @<span class="id">_</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#uncurry">uncurry</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip3.op">op</a></span> <span class="id">x</span> <span class="id">y</span>))).<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zip3_eq">zip3_eq</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span> = <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="kwd">fun</span> <span class="id">f</span> <span class="id">x</span> =&gt; <span class="id">f</span> <span class="id">x</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP">ZIP</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip3.op">op</a></span> <span class="id">x</span> <span class="id">y</span>) <span class="id">xs</span> <span class="id">ys</span>) <span class="id">zs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof162')">Proof.</span></div>
<div class="proofscript" id="proof162">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zip3_cons">zip3_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">u</span> <span class="id">U</span> <span class="id">v</span> <span class="id">V</span> <span class="id">w</span> <span class="id">W</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">u</span> <span class="id">U</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">v</span> <span class="id">V</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">w</span> <span class="id">W</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip3.op">op</a></span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> <span class="id">U</span> <span class="id">V</span> <span class="id">W</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof163')">Proof.</span></div>
<div class="proofscript" id="proof163">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_eq">zip3_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_cons">zip_cons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="rem_zip3">rem_zip3</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">ys</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">zs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof164')">Proof.</span></div>
<div class="proofscript" id="proof164">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_eq">zip3_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#rem_zip">rem_zip</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="first_zip3">first_zip3</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;== <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">ys</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">zs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof165')">Proof.</span></div>
<div class="proofscript" id="proof165">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_eq">zip3_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#first_zip">first_zip</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zip3_is_cons">zip3_is_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">ys</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">zs</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof166')">Proof.</span></div>
<div class="proofscript" id="proof166">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_eq">zip3_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">intros</span> [<span class="id">Hc</span> % <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>] % <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_is_cons">zip_is_cons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="is_cons_zip3">is_cons_zip3</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">xs</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">ys</span> /\ <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> <span class="id">zs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#is_cons">is_cons</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof167')">Proof.</span></div>
<div class="proofscript" id="proof167">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> * (<span class="id">Cx</span> &amp; <span class="id">Cy</span> &amp; <span class="id">Cz</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_eq">zip3_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span> <span class="kwd">using</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#is_cons_zip">is_cons_zip</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="zip3_bot1">zip3_bot1</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> 0 <span class="id">ys</span> <span class="id">zs</span> == 0.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof168')">Proof.</span></div>
<div class="proofscript" id="proof168">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_eq">zip3_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip_bot1">zip_bot1</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="take_zip3">take_zip3</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#ZIP3">ZIP3</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">xs</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">ys</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take">take</a></span> <span class="id">n</span> <span class="id">zs</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof169')">Proof.</span></div>
<div class="proofscript" id="proof169">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#zip3_eq">zip3_eq</a></span>, 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#take_zip">take_zip</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Zip3">Zip3</a></span>.<br/>
<br/>
<br/>
<div class="doc">Une ancienne version de take, avec prédicat d'infinité </div>
<span class="kwd">Module</span> <span class="id"><a name="Inf_Take">Inf_Take</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">A</span> : <span class="kwd">Type</span>}.<br/>
<br/>
<h3> Take the prefix of length <span class="bracket"><span class="id">n</span></span> from an infinite stream </h3>
<span class="kwd">Fixpoint</span> <span class="id"><a name="Inf_Take.take">take</a></span> (<span class="id">n</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.A">A</a></span>) (<span class="id">si</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">s</span>) : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.A">A</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; 0<br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt; <span class="kwd">match</span> <span class="id">si</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#inf_intro">inf_intro</a></span> <span class="id">_</span> <span class="id">rsi</span> =&gt; <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">s</span> (<span class="id">take</span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">s</span>) <span class="id">rsi</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Inf_Take.take_1">take_1</a></span> : <span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.A">A</a></span>) (<span class="id">si</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">s</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> 1 <span class="id">s</span> <span class="id">si</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#first">first</a></span> <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof170')">Proof.</span></div>
<div class="proofscript" id="proof170">
&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">si</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_bot_right_first">app_bot_right_first</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Inf_Take.take_le">take_le</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">s</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.A">A</a></span>) (<span class="id">si</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">s</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> <span class="id">n</span> <span class="id">s</span> <span class="id">si</span> &lt;= <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">s</span> <span class="id">si</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof171')">Proof.</span></div>
<div class="proofscript" id="proof171">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_def.html#Dbot">Dbot</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">si</span>, <span class="id">si</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_mon_right">app_mon_right</a></span>, <span class="id">IHn</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Inf_Take._take_eq">_take_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.A">A</a></span>) <span class="id">xsi</span> <span class="id">ys</span> <span class="id">ysi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> == <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> <span class="id">n</span> <span class="id">xs</span> <span class="id">xsi</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> <span class="id">n</span> <span class="id">ys</span> <span class="id">ysi</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof172')">Proof.</span></div>
<div class="proofscript" id="proof172">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>; <span class="id">intros</span> * <span class="id">Heq</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">xsi</span>, <span class="id">ysi</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Heq</span>, <span class="id">IHn</span> <span class="kwd">at</span> 1; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Inf_Take.take_eq">take_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.A">A</a></span>) <span class="id">xsi</span> <span class="id">ys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> == <span class="id">ys</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">ysi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> <span class="id">n</span> <span class="id">xs</span> <span class="id">xsi</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> <span class="id">n</span> <span class="id">ys</span> <span class="id">ysi</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof173')">Proof.</span></div>
<div class="proofscript" id="proof173">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite_morph">infinite_morph</a></span> <span class="id">H</span>) <span class="id">xsi</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take._take_eq">_take_eq</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Inf_Take.take_cons">take_cons</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">x</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.A">A</a></span>) <span class="id">xsi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> <span class="id">xs</span>) <span class="id">xsi</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons">cons</a></span> <span class="id">x</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> <span class="id">n</span> <span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#cons_infinite">cons_infinite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">xsi</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof174')">Proof.</span></div>
<div class="proofscript" id="proof174">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">destruct</span> <span class="id">xsi</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_cons">app_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#cons_eq_compat">cons_eq_compat</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take._take_eq">_take_eq</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Inf_Take.take_app">take_app</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">xs</span> <span class="id">ys</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.A">A</a></span>) <span class="id">inf</span> <span class="id">inf2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">xs</span> <span class="id">ys</span>) <span class="id">inf</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app">app</a></span> <span class="id">xs</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> <span class="id">n</span> <span class="id">ys</span> <span class="id">inf2</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof175')">Proof.</span></div>
<div class="proofscript" id="proof175">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">destruct</span> <span class="id">inf</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#app_app">app_app</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_eq_compat">app_eq_compat</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take._take_eq">_take_eq</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#app_is_cons">app_is_cons</a></span>; <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Inf_Take.rem_take">rem_take</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.A">A</a></span>) <span class="id">inf</span> <span class="id">inf2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">xs</span> <span class="id">inf</span>) == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> <span class="id">n</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem">rem</a></span> <span class="id">xs</span>) <span class="id">inf2</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof176')">Proof.</span></div>
<div class="proofscript" id="proof176">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">destruct</span> <span class="id">inf</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#rem_app">rem_app</a></span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take._take_eq">_take_eq</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Inf_Take.n_eq">n_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> <span class="id">t</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.A">A</a></span>) (<span class="id">si</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">s</span>) (<span class="id">ti</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite">infinite</a></span> <span class="id">t</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> <span class="id">n</span> <span class="id">s</span> <span class="id">si</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> <span class="id">n</span> <span class="id">t</span> <span class="id">ti</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> == <span class="id">t</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof177')">Proof.</span></div>
<div class="proofscript" id="proof177">
&nbsp;&nbsp;<span class="id">intros</span> * <span class="id">Hn</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#DS_bisimulation_allin1">DS_bisimulation_allin1</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">R</span> := <span class="kwd">fun</span> <span class="id">U</span> <span class="id">V</span> =&gt; <span class="kwd">exists</span> <span class="id">Ui</span> <span class="id">Vi</span>, (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> <span class="id">n</span> <span class="id">U</span> <span class="id">Ui</span> == <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take">take</a></span> <span class="id">n</span> <span class="id">V</span> <span class="id">Vi</span>)).<br/>
&nbsp;&nbsp;3: <span class="id">esplit</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span> ???? (<span class="id">I1</span> &amp; <span class="id">I2</span> &amp; <span class="id">HUV</span>) <span class="id">HU</span> <span class="id">HV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take._take_eq">_take_eq</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite_morph">infinite_morph</a></span> <span class="id">HU</span>) <span class="id">I1</span>) <span class="id">HU</span>) <span class="kwd">in</span> <span class="id">HUV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">setoid_rewrite</span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take._take_eq">_take_eq</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> (<span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#infinite_morph">infinite_morph</a></span> <span class="id">HV</span>) <span class="id">I2</span>) <span class="id">HV</span>) <span class="kwd">in</span> <span class="id">HUV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">clear</span>. <span class="id">intros</span> <span class="id">U</span> <span class="id">V</span> <span class="id">Hc</span> (<span class="id">I1</span> &amp; <span class="id">I2</span> &amp; <span class="id">Hf</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">Hf</span> 1). <span class="id">now</span> <span class="id">rewrite</span> 2 <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.take_1">take_1</a></span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">I1</span> <span class="kwd">as</span> (?&amp; <span class="id">I1</span>), <span class="id">I2</span> <span class="kwd">as</span> (? &amp; <span class="id">I2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">I1</span>, <span class="id">I2</span>. <span class="id">setoid_rewrite</span> &lt;- <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take.rem_take">rem_take</a></span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Velus.Lustre.Denot.Cpo_ext.DS_ext.html#Inf_Take">Inf_Take</a></span>.<br/>
<br/>
<br/>
<h3> Extract the <span class="bracket"><span class="id">n</span></span> first elements (Con/Eps) of a stream </h3>
<span class="kwd">Fixpoint</span> <span class="id"><a name="take_list">take_list</a></span> {<span class="id">A</span>} (<span class="id">n</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">xs</span> : <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#DS">DS</a></span> <span class="id">A</span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; []<br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt;  <span class="kwd">match</span> <span class="id">xs</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Eps">Eps</a></span> <span class="id">xs</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> :: <span class="id">take_list</span> <span class="id">n</span> <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Velus.Lustre.Denot.Cpo.Cpo_streams_type.html#Con">Con</a></span> <span class="id">x</span> <span class="id">xs</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span> :: <span class="id">take_list</span> <span class="id">n</span> <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
