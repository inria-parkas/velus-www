<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta content="ie=edge" http-equiv="x-ua-compatible"/><link href="velus.css" rel="stylesheet"/><title>The Compiler</title><meta description="Outline of intermediate languages and transformations"/><link href="icons/apple-icon-512x512.png" rel="apple-touch-icon" sizes="512x512"/><link href="icons/apple-icon-196x196.png" rel="apple-touch-icon" sizes="196x196"/><link href="icons/apple-icon-180x180.png" rel="apple-touch-icon" sizes="180x180"/><link href="icons/apple-icon-172x172.png" rel="apple-touch-icon" sizes="172x172"/><link href="icons/apple-icon-167x167.png" rel="apple-touch-icon" sizes="167x167"/><link href="icons/apple-icon-152x152.png" rel="apple-touch-icon" sizes="152x152"/><link href="icons/apple-icon-144x144.png" rel="apple-touch-icon" sizes="144x144"/><link href="icons/apple-icon-120x120.png" rel="apple-touch-icon" sizes="120x120"/><link href="icons/apple-icon-114x114.png" rel="apple-touch-icon" sizes="114x114"/><link href="icons/apple-icon-100x100.png" rel="apple-touch-icon" sizes="100x100"/><link href="icons/apple-icon-88x88.png" rel="apple-touch-icon" sizes="88x88"/><link href="icons/apple-icon-87x87.png" rel="apple-touch-icon" sizes="87x87"/><link href="icons/apple-icon-80x80.png" rel="apple-touch-icon" sizes="80x80"/><link href="icons/apple-icon-76x76.png" rel="apple-touch-icon" sizes="76x76"/><link href="icons/apple-icon-72x72.png" rel="apple-touch-icon" sizes="72x72"/><link href="icons/apple-icon-60x60.png" rel="apple-touch-icon" sizes="60x60"/><link href="icons/apple-icon-58x58.png" rel="apple-touch-icon" sizes="58x58"/><link href="icons/apple-icon-57x57.png" rel="apple-touch-icon" sizes="57x57"/><link href="icons/apple-icon-55x55.png" rel="apple-touch-icon" sizes="55x55"/><link href="icons/apple-icon-50x50.png" rel="apple-touch-icon" sizes="50x50"/><link href="icons/apple-icon-48x48.png" rel="apple-touch-icon" sizes="48x48"/><link href="icons/apple-icon-40x40.png" rel="apple-touch-icon" sizes="40x40"/><link href="icons/apple-icon-29x29.png" rel="apple-touch-icon" sizes="29x29"/><link href="icons/apple-icon-20x20.png" rel="apple-touch-icon" sizes="20x20"/><link href="icons/icon-256x256.png" type="image/png" rel="icon" sizes="256x256"/><link href="icons/icon-128x128.png" type="image/png" rel="icon" sizes="128x128"/><link href="icons/icon-96x96.png" type="image/png" rel="icon" sizes="96x96"/><link href="icons/icon-64x64.png" type="image/png" rel="icon" sizes="64x64"/><link href="icons/icon-48x48.png" type="image/png" rel="icon" sizes="48x48"/><link href="icons/icon-32x32.png" type="image/png" rel="icon" sizes="32x32"/><link href="icons/icon-24x24.png" type="image/png" rel="icon" sizes="24x24"/><link href="icons/icon-16x16.png" type="image/png" rel="icon" sizes="16x16"/><link href="/icons/manifest.json" rel="manifest"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png"/><meta name="theme-color" content="#ffffff"/></head><body><div class="velus-all"><div class="velus-content" data-spy="scroll" data-target="#velus-side-bar"><div class="container-fluid"><div class="row"><div class="col-xl-4 col-lg-4 col-md-12 col-sm-12"><h1>Compiler Structure</h1><p>The Vélus compiler is implemented in a mix of <a href="https://coq.inria.fr">Coq</a>
and <a href="https://ocaml.org">OCaml</a>.
A program is parsed from a source file and successively transformed through
several intermediate languages.
The final transformation produces a <em>Clight</em> program for
<a href="https://compcert.inria.fr">CompCert</a> to compile into one of its supported
assembly languages.</p>
<p>The syntax and semantics of the intermediate languages are specified in Coq.
The transformations are specified as functional programs that manipulate
syntactic terms.
Each is accompanied by a correctness proof showing the preservation of
input/output traces in the semantic models.</p>
</div><div class="col-xl-8 col-lg-8 col-md-12 col-sm-12"><h2>Compilation Passes</h2><table class="compiler"><tr class="transform"><td class="comment-left"><div class="comment"></div></td><td class="arrow-left"></td><td class="arrow"><img title="downwards arrow" alt="↓" src="img/arrow-down.png"/></td><td class="arrow-right" colspan="3">parsing</td><td class="comment-right"><div class="comment"></div></td></tr><tr class="language"><td class="comment-left"><div class="comment">Source files are parsed into raw syntax trees that the <em>elaboration</em> pass annotates with types and clocks.</div></td><td class="name" colspan="3">Untyped Lustre</td><td class="transform-loop"></td><td class="transform-loop-label"></td><td class="comment-right"><div class="comment"></div></td></tr><tr class="transform"><td class="comment-left"><div class="comment"></div></td><td class="arrow-left"></td><td class="arrow"><img title="downwards arrow" alt="↓" src="img/arrow-down.png"/></td><td class="arrow-right" colspan="3">elaboration</td><td class="comment-right"><div class="comment"></div></td></tr><tr class="language"><td class="comment-left"><div class="comment"><em>Lustre</em> is a dataflow formalism with arbitrary nesting of nodes, fbys, merges, etcetera.</div></td><td class="name" colspan="3">Lustre</td><td class="transform-loop"><img title="looping arrow" alt="⤸" src="img/arrow-loop.png"/></td><td class="transform-loop-label">normalization (not yet implemented)</td><td class="comment-right"><div class="comment"></div></td></tr><tr class="transform"><td class="comment-left"><div class="comment"></div></td><td class="arrow-left"></td><td class="arrow"><img title="downwards arrow" alt="↓" src="img/arrow-down.png"/></td><td class="arrow-right" colspan="3">transcription</td><td class="comment-right"><div class="comment"></div></td></tr><tr class="language"><td class="comment-left"><div class="comment"><em>Normalized Lustre (NLustre)</em> is a dataflow formalism with three forms of equations: basic equations, fby equations, and node instances.</div></td><td class="name" colspan="3">NLustre</td><td class="transform-loop"></td><td class="transform-loop-label"></td><td class="comment-right"><div class="comment"></div></td></tr><tr class="transform"><td class="comment-left"><div class="comment"></div></td><td class="arrow-left"></td><td class="arrow"><img title="downwards arrow" alt="↓" src="img/arrow-down.png"/></td><td class="arrow-right" colspan="3">i-translation</td><td class="comment-right"><div class="comment"></div></td></tr><tr class="language"><td class="comment-left"><div class="comment"><em>Synchronous Transition Code (Stc)</em> is based on composing state transitions that constrain state and output values, relative to input values, at an instant.</div></td><td class="name" colspan="3">Stc</td><td class="transform-loop"><img title="looping arrow" alt="⤸" src="img/arrow-loop.png"/></td><td class="transform-loop-label">scheduling</td><td class="comment-right"><div class="comment"></div></td></tr><tr class="transform"><td class="comment-left"><div class="comment"></div></td><td class="arrow-left"></td><td class="arrow"><img title="downwards arrow" alt="↓" src="img/arrow-down.png"/></td><td class="arrow-right" colspan="3">s-translation</td><td class="comment-right"><div class="comment"></div></td></tr><tr class="language"><td class="comment-left"><div class="comment"><em>Object code (Obc)</em> is a simple imperative language with encapsulated state and a fixed execution order.</div></td><td class="name" colspan="3">Obc</td><td class="transform-loop"><img title="looping arrow" alt="⤸" src="img/arrow-loop.png"/></td><td class="transform-loop-label"><table><tbody><tr><td>fusion optimization</td></tr><tr><td>argument initialization</td></tr></tbody></table></td><td class="comment-right"><div class="comment"></div></td></tr><tr class="transform"><td class="comment-left"><div class="comment"></div></td><td class="arrow-left"></td><td class="arrow"><img title="downwards arrow" alt="↓" src="img/arrow-down.png"/></td><td class="arrow-right" colspan="3">generation</td><td class="comment-right"><div class="comment"></div></td></tr><tr class="language compcert"><td class="comment-left"><div class="comment"><p><strong>The CompCert verified C compiler</strong></p><p>The <em>generation</em> pass produces a <em>Clight</em> program for compilation by CompCert into assembly code.</p></div></td><td class="name" colspan="3">Clight</td><td class="transform-loop"></td><td class="transform-loop-label"></td><td class="comment-right"><div class="comment"></div></td></tr><tr class="transform compcert"><td class="comment-left"><div class="comment"></div></td><td class="arrow-left"></td><td class="arrow"><img title="dashed downwards arrow" alt="↓(dashed)" src="img/arrow-dashed-down.png"/></td><td class="arrow-right" colspan="3">compilation</td><td class="comment-right"><div class="comment"></div></td></tr><tr class="language compcert"><td class="comment-left"><div class="comment"></div></td><td class="name" colspan="3">Assembly</td><td class="transform-loop"></td><td class="transform-loop-label"></td><td class="comment-right"><div class="comment"></div></td></tr><tr class="transform compcert"><td class="comment-left"><div class="comment"></div></td><td class="arrow-left"></td><td class="arrow"><img title="downwards arrow" alt="↓" src="img/arrow-down.png"/></td><td class="arrow-right" colspan="3">printing</td><td class="comment-right"><div class="comment"></div></td></tr></table></div></div></div></div><div class="navbar navbar-expand-md fixed-top navbar-dark bg-primary velus-navbar"><a class="navbar-brand" href="index.html">Vélus</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsingNavbar" aria-expanded="false" aria-label="Toggle navigation">•••</button><div class="collapse navbar-collapse" id="collapsingNavbar"><ul class="navbar-nav mr-auto"><li class="nav-item active"><a class="nav-link" href="compiler.html">compiler</a></li><li class="nav-item"><a class="nav-link" href="publications.html">publications</a></li></ul></div></div><script crossorigin="anonymous" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script><script crossorigin="anonymous" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script><script crossorigin="anonymous" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script></div></body></html>